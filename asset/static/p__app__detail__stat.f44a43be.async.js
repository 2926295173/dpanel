"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7745],{16664:function(L,_,e){e.d(_,{Z:function(){return y}});var M=e(87462),c=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},s=j,a=e(84089),m=function(f,i){return c.createElement(a.Z,(0,M.Z)({},f,{ref:i,icon:s}))},p=c.forwardRef(m),y=p},51400:function(L,_,e){e.r(_),e.d(_,{default:function(){return ee}});var M=e(15009),c=e.n(M),j=e(99289),s=e.n(j),a=e(5574),m=e.n(a),p=e(19632),y=e.n(p),x=e(97857),f=e.n(x),i=e(67294),k=e(71833),v=function(){return v=Object.assign||function(o){for(var l,F=1,b=arguments.length;F<b;F++){l=arguments[F];for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&(o[r]=l[r])}return o},v.apply(this,arguments)},G=(0,i.forwardRef)(function(o,l){return i.createElement(k.P,v({},o,{chartType:"Area",ref:l}))}),Y=G,n=e(85893);function C(o){var l={theme:"academy",xField:o.xField,yField:o.yField,height:200,axis:{y:{line:!0,grid:{visable:!0}},x:{line:!0,grid:{visable:!0}}},data:o.data};return o.yDomain&&(l.scale={y:{domain:o.yDomain}}),o.colorField&&(l.colorField=o.colorField),(0,n.jsx)(Y,f()({},l))}function N(o){var l=o.reqFunction,F=o.interval,b=o.maxPolling,r=o.pollingStatus,E=(0,i.useRef)(null),W=0,U=function Z(){E.current=window.setTimeout(s()(c()().mark(function K(){var A;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(W++>=b)){d.next=3;break}return P(),d.abrupt("return");case 3:return d.prev=3,d.next=6,l();case 6:A=d.sent,Z(),d.next=14;break;case 10:d.prev=10,d.t0=d.catch(3),P(),console.error("\u8F6E\u8BE2\u53D1\u751F\u9519\u8BEF\uFF1A",d.t0);case 14:case"end":return d.stop()}},K,null,[[3,10]])})),F)},P=function(){console.log("end polling"),E.current&&window.clearTimeout(E.current)};return(0,i.useEffect)(function(){return console.log((r?"start":"waiting")+" polling, max "+b),r&&U(),P},[F,b,r]),{endPolling:P}}var J=N,z=e(84410),D=e(5251),R=e(12122),Q=e(16664),O=e(38345),V=e(54006),X=e(63490),w=new Date().toLocaleTimeString(),q={total:0,memory:[{date:w,usage:0,source:{usage:0,limit:0}}],cpu:[{date:w,usage:0}],network:[{usage:0,type:"rx",date:w,source:{usage:0}},{usage:0,type:"tx",date:w,source:{usage:0}}],io:[{usage:0,type:"read",date:w,source:{usage:0}},{usage:0,type:"write",date:w,source:{usage:0}}]};function ee(){var o=function(h,t){switch(t.type){case"update":var g=new Date(t.payload.read).toLocaleTimeString(),u=t.payload.cpu_stats.cpu_usage.total_usage-t.payload.precpu_stats.cpu_usage.total_usage,$=t.payload.cpu_stats.system_cpu_usage-t.payload.precpu_stats.system_cpu_usage,T=0,te=0;t.payload.blkio_stats.io_service_bytes_recursive||(t.payload.blkio_stats.io_service_bytes_recursive=[{value:0,op:"read",major:0,minor:0},{value:0,op:"write",major:0,minor:0}]),t.payload.blkio_stats.io_service_bytes_recursive.map(function(B){B.op=="read"&&(T=B.value),B.op=="write"&&(te=B.value)});var H={total:h.total+1,memory:[].concat(y()(h.memory),[{date:g,usage:Math.round(t.payload.memory_stats.usage/1024/1024),source:{usage:t.payload.memory_stats.usage,limit:t.payload.memory_stats.limit}}]),cpu:[].concat(y()(h.cpu),[{date:g,usage:u/$*t.payload.cpu_stats.online_cpus*100}]),io:[].concat(y()(h.io),[{date:g,usage:parseFloat((t.payload.blkio_stats.io_service_bytes_recursive[0].value/1024/1024).toFixed(2)),type:t.payload.blkio_stats.io_service_bytes_recursive[0].op,source:{usage:t.payload.blkio_stats.io_service_bytes_recursive[0].value}},{date:g,usage:parseFloat((t.payload.blkio_stats.io_service_bytes_recursive[1].value/1024/1024).toFixed(2)),type:t.payload.blkio_stats.io_service_bytes_recursive[1].op,source:{usage:t.payload.blkio_stats.io_service_bytes_recursive[1].value}}]),network:[]};return t.payload.networks&&(H.network=[].concat(y()(h.network),[{date:g,usage:parseFloat((t.payload.networks.eth0.rx_bytes/1024).toFixed(2)),type:"rx",source:{usage:t.payload.networks.eth0.rx_bytes}},{date:g,usage:parseFloat((t.payload.networks.eth0.tx_bytes/1024).toFixed(2)),type:"tx",source:{usage:t.payload.networks.eth0.tx_bytes}}])),H}},l=(0,V.useParams)(),F=(0,i.useReducer)(o,q),b=m()(F,2),r=b[0],E=b[1],W=(0,i.useState)([]),U=m()(W,2),P=U[0],Z=U[1],K=(0,i.useState)(),A=m()(K,2),S=A[0],d=A[1],ae=J({reqFunction:function(){var I=s()(c()().mark(function t(){var g,u;return c()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,z.i)({id:(g=l.id)!==null&&g!==void 0?g:""});case 2:u=T.sent,E({type:"update",payload:u});case 4:case"end":return T.stop()}},t)}));function h(){return I.apply(this,arguments)}return h}(),interval:3e3,maxPolling:999,pollingStatus:P.length!=0});return(0,i.useEffect)(function(){var I,h;(0,z.i)({id:(I=l.id)!==null&&I!==void 0?I:""}).then(function(t){return Z([0,Math.round(t.memory_stats.limit/1024/1024)]),!0}),(0,z.a)({id:(h=l.id)!==null&&h!==void 0?h:""}).then(function(t){var g={columns:[],data:[]};t.data.list.Titles.map(function(u){g.columns.push({title:u,label:u,dataIndex:u})}),t.data.list.Processes.map(function(u,$){g.data.push({UID:u[0],PID:u[1],PPID:u[2],C:u[3],STIME:u[4],TTY:u[5],TIME:u[6],CMD:u[7]})}),d(g)})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(O.Z,{direction:"row",wrap:!0,gutter:[20,20],children:[(0,n.jsx)(O.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"Memory usage: ".concat((0,D.FI)(r.memory[r.memory.length-1].source.usage)," / ").concat((0,D.FI)(r.memory[r.memory.length-1].source.limit)),headerBordered:!0,bordered:!0,children:(0,n.jsx)(C,{yField:"usage",xField:"date",data:r.memory,yDomain:P})}),(0,n.jsx)(O.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"Cpu usage: ".concat(r.cpu[r.cpu.length-1].usage.toFixed(2),"%"),headerBordered:!0,bordered:!0,children:(0,n.jsx)(C,{yField:"usage",xField:"date",data:r.cpu})}),(0,n.jsx)(O.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"I/O: ".concat((0,D.FI)(r.io[r.io.length-1].source.usage)," / ").concat((0,D.FI)(r.io[r.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,n.jsx)(C,{yField:"usage",xField:"date",colorField:"type",data:r.io})}),r.network&&r.network.length>0&&(0,n.jsx)(O.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"Network: ".concat((0,D.FI)(r.network[r.io.length-1].source.usage)," / ").concat((0,D.FI)(r.network[r.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,n.jsx)(C,{yField:"usage",xField:"date",colorField:"type",data:r.network})})]}),(0,n.jsx)(O.Z,{title:(0,n.jsx)(Q.Z,{}),subTitle:"Progress",children:(0,n.jsx)(X.Z,{scroll:{x:"max-content"},rowKey:"PID",columns:S==null?void 0:S.columns,dataSource:S==null?void 0:S.data,pagination:{pageSize:10}})})]})}},84410:function(L,_,e){e.d(_,{a:function(){return y},i:function(){return m}});var M=e(15009),c=e.n(M),j=e(99289),s=e.n(j),a=e(54006);function m(f){return p.apply(this,arguments)}function p(){return p=s()(c()().mark(function f(i){return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,a.request)("/api/app/container/get-stat-info",{method:"POST",data:i}));case 1:case"end":return v.stop()}},f)})),p.apply(this,arguments)}function y(f){return x.apply(this,arguments)}function x(){return x=s()(c()().mark(function f(i){return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,a.request)("/api/app/container/get-process-info",{method:"POST",data:i}));case 1:case"end":return v.stop()}},f)})),x.apply(this,arguments)}},5251:function(L,_,e){e.d(_,{FI:function(){return c},ZM:function(){return j}});function M(s){return s.trim()}function c(s){var a="";s<.1*1024?a=s.toFixed(2)+"B":s<.1*1024*1024?a=(s/1024).toFixed(2)+"KB":s<1*1024*1024*1024?a=(s/(1024*1024)).toFixed(2)+"MB":a=(s/(1024*1024*1024)).toFixed(2)+"GB";var m=a+"",p=m.indexOf("."),y=m.substr(p+1,2);return y=="00"?m.substring(0,p)+m.substr(p+3,2):a}function j(s){if(s){var a=new Date(s),m=a.getFullYear()+"-",p=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",y=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ",x=(a.getHours()<10?"0"+a.getHours():a.getHours())+":",f=(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":",i=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds();return m+p+y+x+f+i}}}}]);
