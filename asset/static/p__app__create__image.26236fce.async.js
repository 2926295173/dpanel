"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{44771:function(te,z,t){t.d(z,{Z:function(){return y}});var Y=t(34041),r=t(25449),q=t(62435),E=t(86074);function y(N){return(0,E.jsx)(r.Z,{name:"restart",initialValue:N.defaultValue?N.defaultValue:"on-failure",children:(0,E.jsx)(Y.Z,{options:[{value:"no",label:"\u4E0D\u91CD\u542F"},{value:"on-failure",label:"\u975E\u6B63\u5E38\u9000\u51FA\u65F6,\u6700\u591A5\u6B21 - on failure"},{value:"unless-stopped",label:"\u9000\u51FA\u540E\u91CD\u542F\uFF0C\u4E0D\u5305\u62EC\u624B\u52A8\u505C\u6B62\u7684 - unless stopped"},{value:"always",label:"\u603B\u662F\u9000\u51FA\u540E\u91CD\u542F - always"}]})})}},35880:function(te,z,t){var Y=t(62435),r=(0,Y.createContext)({});z.Z=r},33369:function(te,z,t){t.r(z),t.d(z,{default:function(){return Je}});var Y=t(15009),r=t.n(Y),q=t(99289),E=t.n(q),y=t(5574),N=t.n(y),W=t(6110),U=t(38345),V=t(97269),Q=t(2236),w=t(5966),M=t(97462),J=t(92398),m=t(62435),$=t(35880),X=t(62370),K=t(90639),I=t(78957),T=t(14726),g=t(85576),d=t(75891),D=t(96074),u=t(83062),G=t(3393),c=t(18148),ge=t(5251),se=t(64789),_e=t(75162),je=t(28307),e=t(86074);function Fe(_){var O=(0,m.useState)(!1),F=N()(O,2),b=F[0],C=F[1],B=(0,m.useRef)(),h=(0,m.useContext)($.Z),R=h.createFormRef,j=h.volumeListRef,p=h.createEnvRef,s=h.domainRef,n=(0,m.useRef)(),f=function(){var v=E()(r()().mark(function i(a){var o,k,A,P,L,S,l,Z,x,H,re;return r()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return C(!1),ae.next=3,(0,G.YU)({md5:a});case 3:P=ae.sent,_.redeploy||(Z=(L=R.current)===null||L===void 0?void 0:L.getFieldsValue(),(S=R.current)===null||S===void 0||S.resetFields(),(l=R.current)===null||l===void 0||l.setFieldsValue({siteName:Z.siteName,siteTitle:Z.siteTitle})),P.data.info.Config.Env&&P.data.info.Config.Env.map(function(de){var ie,Ee=de.split("=");(ie=p.current)===null||ie===void 0||ie.addEnvItem(Ee[0],Ee[1])}),(o=R.current)===null||o===void 0||o.setFieldValue("imageName",P.data.info.RepoTags[0]),(k=R.current)===null||k===void 0||k.setFieldValue("workDir",P.data.info.Config.WorkingDir),(A=s.current)===null||A===void 0||A.setExposePort(P.data.info.Config.ExposedPorts),P.data.info.Config.Volumes?(H=[],Object.keys(P.data.info.Config.Volumes).map(function(de,ie){H.push(de)}),(x=j.current)===null||x===void 0||x.setDefaultDestPath(H)):(re=j.current)===null||re===void 0||re.setDefaultDestPath([]);case 10:case"end":return ae.stop()}},i)}));return function(a){return v.apply(this,arguments)}}();return(0,m.useEffect)(function(){_.fromImageId&&f(_.fromImageId)},[_.fromImageId]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(I.Z.Compact,{children:[(0,e.jsx)(w.Z,{label:"\u955C\u50CF",tooltip:_.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",width:"lg",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0}),(0,e.jsx)(X.Z,{label:" ",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(T.ZP,{type:"primary",onClick:function(){return C(!0)},children:_.redeploy?"\u66F4\u65B0\u955C\u50CF":"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(g.Z,{open:b,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return C(!1)},children:(0,e.jsx)(K.Z,{columns:[{title:"Id",dataIndex:"Id",ellipsis:!0,search:!1,width:150},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",render:function(i,a,o,k){return(0,e.jsx)(d.Z.Text,{code:!0,copyable:!0,children:a.RepoTags[0]},a.RepoTags[0])}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(i,a,o,k){return(0,e.jsx)("div",{children:(0,ge.ZM)(a.Created*1e3)},a.Id)},sorter:function(i,a){return i.Created-a.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:"100px",render:function(i,a,o,k){return(0,e.jsxs)(I.Z,{split:(0,e.jsx)(D.Z,{type:"vertical"}),children:[(0,e.jsx)(T.ZP,{size:"small",onClick:E()(r()().mark(function A(){return r()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.abrupt("return",f(a.Id));case 1:case"end":return L.stop()}},A)})),type:"link",icon:(0,e.jsx)(u.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(se.Z,{})})},"addImage"),(0,e.jsx)(T.ZP,{size:"small",onClick:E()(r()().mark(function A(){var P;return r()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:a.RepoTags[0]&&((P=n.current)===null||P===void 0||P.setImageName(a.RepoTags[0]));case 1:case"end":return S.stop()}},A)})),type:"link",icon:(0,e.jsx)(u.Z,{title:"\u66F4\u65B0\u7248\u672C",children:(0,e.jsx)(_e.Z,{})})},"updateImage")]})}}],request:function(){var v=E()(r()().mark(function i(a,o,k){var A,P,L,S,l;return r()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return _.redeploy&&(P=(A=R.current)===null||A===void 0?void 0:A.getFieldValue("imageName"),a.tag=P?P.split(":")[0]:a.tag),x.next=3,(0,c.KG)({tag:a.tag});case 3:return L=x.sent,S=0,l=[],L.data.list&&(l=L.data.list.flatMap(function(H){return H.RepoTags.map(function(re){return{Key:S++,Id:H.Id,Created:H.Created,RepoTags:[re]}})})),x.abrupt("return",{data:l,success:!0,total:l.length});case 8:case"end":return x.stop()}},i)}));return function(i,a,o){return v.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(je.Z,{ref:n,onFinish:function(a){var o,k;(o=B.current)===null||o===void 0||o.setFieldValue("tag",a),(k=B.current)===null||k===void 0||k.submit()}},"remote")]},formRef:B,rowKey:"Key",pagination:{pageSize:5}})},"imageTableList")]})})]})})}var le=t(60335),Ce=t(24969),xe=t(27496),ne=t(24739),De=t(63434),ee=t(17186),ce=t(66309),Be=(0,m.forwardRef)(function(_,O){var F=(0,m.useState)(!1),b=N()(F,2),C=b[0],B=b[1],h=(0,m.useRef)(),R=function(s){var n=(0,m.useState)([]),f=N()(n,2),v=f[0],i=f[1];return(0,m.useEffect)(function(){(0,le.jV)({md5:s.name}).then(function(a){var o;return i((o=a.data.info.Config.Env)!==null&&o!==void 0?o:[]),!0})},[]),(0,e.jsxs)(U.Z,{bordered:!0,extra:s.action,style:{marginBottom:10},children:[(0,e.jsx)(U.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(w.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(w.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(De.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(U.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(I.Z,{direction:"vertical",children:v&&v.map(function(a,o){return(0,e.jsx)(d.Z.Text,{copyable:{icon:(0,e.jsx)(Ce.Z,{}),onCopy:function(){var A=a.split("=");_.onAddEnv(A[0],A[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:a},style:{width:300},children:a},o)})},"linkEnv")})]})},j=function(s){var n,f,v=!1,i=(n=(f=h.current)===null||f===void 0?void 0:f.getList())!==null&&n!==void 0?n:[];if(i.map(function(o){o.name==s.name&&(v=!0)}),!v){var a;(a=h.current)===null||a===void 0||a.add(s)}};return(0,m.useImperativeHandle)(O,function(){return{setDefaultLink:function(s){s&&s.map(function(n){n.name!=""&&j(n)})}}}),(0,e.jsxs)(U.Z,{title:"\u5173\u8054\u5BB9\u5668",headerBordered:!0,children:[(0,e.jsx)(ee.u,{name:"links",actionRef:h,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(s,n){return B(!0),!1}},copyIconProps:!1,min:0,itemRender:function(s,n){return(0,e.jsx)(R,{action:s.action,name:n.record.name})}}),(0,e.jsx)(g.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:1024,footer:!1,open:C,onCancel:function(){return B(!1)},children:(0,e.jsx)(K.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"names",render:function(s,n,f,v){return(0,e.jsx)(I.Z,{direction:"vertical",style:{textAlign:"left"},children:n==null?void 0:n.Names.map(function(i){return i})},n.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(s,n,f,v){return n!=null&&n.Ports?(0,e.jsx)(I.Z,{direction:"vertical",style:{textAlign:"left"},children:n==null?void 0:n.Ports.map(function(i,a){return(0,e.jsx)(ce.Z,{color:"#2db7f5",icon:i.PublicPort?(0,e.jsx)(xe.Z,{}):"",children:"".concat(i.PublicPort?i.IP+":"+i.PublicPort+"->":"").concat(i.PrivatePort,"/").concat(i.Type)},a)})},n.Id):(0,e.jsx)(e.Fragment,{})}},{title:"\u8FD0\u884C\u5BB9\u5668",search:!1,render:function(s,n,f,v){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(d.Z.Text,{ellipsis:{tooltip:n.Image},children:n.Image},n.Id)})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(s,n,f,v){return[(0,e.jsx)(T.ZP,{type:"link",onClick:function(){(0,le.jV)({md5:n.Id}).then(function(a){return j({name:a.data.info.Name,alise:a.data.info.Config.Hostname,volume:!1}),B(!1),!0})},children:(0,e.jsx)(se.Z,{})},n.Id)]}}],rowKey:"Id",request:function(){var p=E()(r()().mark(function s(n,f,v){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(o,k){(0,le.IE)({tag:n.names}).then(function(A){var P={data:A.data.list,success:!0,total:A.data.list.length};o(P)})}));case 1:case"end":return a.stop()}},s)}));return function(s,n,f){return p.apply(this,arguments)}}(),pagination:{pageSize:5}})})]})}),ye=Be,Pe=t(89035),we=t(20713),me="docker-image",Ie=(0,m.forwardRef)(function(_,O){var F=(0,m.useState)(me),b=N()(F,2),C=b[0],B=b[1],h=(0,m.useRef)(),R=(0,m.useState)(""),j=N()(R,2),p=j[0],s=j[1],n=function(){C!="code"?B("code"):B(me)};(0,m.useImperativeHandle)(O,function(){return{addEnvItem:function(a,o){var k,A=(k=h.current)===null||k===void 0?void 0:k.getList(),P=!1;if(A==null||A.map(function(S){if(S.name==a){P=!0;return}}),!P){var L;(L=h.current)===null||L===void 0||L.add({name:a,value:o})}}}});function f(i){try{for(var a,o,k=(a=(o=h.current)===null||o===void 0||(o=o.getList())===null||o===void 0?void 0:o.length)!==null&&a!==void 0?a:0,A=k;A>=0;A--){var P;(P=h.current)===null||P===void 0||P.remove(A)}var L=i.split(`
`),S=0;L.map(function(l){var Z,x=l.split("=");x.length==2&&((Z=h.current)===null||Z===void 0||Z.add({name:x[0],value:x[1]},S),S++)})}catch(l){}}function v(){if(h){var i,a=(i=h.current)===null||i===void 0?void 0:i.getList();if(a){var o=[];return a.map(function(k){o.push("".concat(k.name,"=").concat(k.value))}),o.join(`
`)}else return""}else return""}return(0,e.jsxs)(U.Z,{title:"\u73AF\u5883\u53D8\u91CF",headerBordered:!0,extra:(0,e.jsx)(u.Z,{title:"\u4EE3\u7801\u7F16\u8F91\u6A21\u5F0F",children:(0,e.jsx)(T.ZP,{icon:(0,e.jsx)(Pe.Z,{}),type:C=="code"?"primary":"default",onClick:n,children:"\u4EE3\u7801\u6A21\u5F0F"})}),children:[(0,e.jsx)(ee.u,{name:"environment",actionRef:h,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(w.Z,{width:"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),(0,e.jsx)(w.Z,{width:"md",name:"value",label:"\u53D8\u91CF\u503C",placeholder:"\u8F93\u5165\u53D8\u91CF\u503C\uFF0C\u53EF\u4EE5\u4E3A\u7A7A"})]})}),(0,e.jsx)(g.Z,{width:"800px",open:C=="code",onCancel:function(){return B("docker-image")},onOk:function(){f(p),B("docker-image")},children:(0,e.jsx)(we.ZP,{onChange:function(a){return s(a)},value:v(),height:"680px",theme:"light"})})]})}),be=Ie,Re=t(86615),Ae=t(64317),Te=(0,m.forwardRef)(function(_,O){var F=(0,m.useRef)();return(0,m.useImperativeHandle)(O,function(){return{setDefaultDestPath:function(C){var B,h,R=(B=(h=F.current)===null||h===void 0?void 0:h.getList())!==null&&B!==void 0?B:[];C.length!=0&&C.filter(function(j){return j!=""}).map(function(j){var p=!1;if(R.map(function(n){if(n.dest==j){p=!0;return}}),!p){var s;(s=F.current)===null||s===void 0||s.add({dest:j,permission:"write",inImage:!0,edit:!1})}})}}}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(U.Z,{title:"\u9ED8\u8BA4\u5B58\u50A8\uFF08Volume\uFF09",subTitle:"\u9ED8\u8BA4\u5B58\u50A8\u4E0E\u7AD9\u70B9\u6807\u8BC6\u4FDD\u6301\u4E00\u81F4",headerBordered:!0,children:(0,e.jsx)(ee.u,{name:"volumesDefault",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u76EE\u5F55\u5230\u9ED8\u8BA4\u5B58\u50A8"},actionRef:F,copyIconProps:!1,min:0,children:function(C,B,h){var R=h.getCurrentRowData();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(w.Z,{width:"lg",name:"dest",label:"\u5BB9\u5668\u5185\u8DEF\u5F84",required:!0,rules:[{required:!0}],disabled:R.inImage}),(0,e.jsx)(Re.Z.Group,{hidden:!0,name:"inImage",label:"\u955C\u50CF\u5185\u6302\u8F7D",valueEnum:{1:"\u662F",0:"\u5426"}})]})}})}),(0,e.jsx)(U.Z,{title:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u6216\u662F\u5B58\u50A8\u5377",subTitle:"\u6302\u8F7D\u53EF\u4EE5\u662F\u5BBF\u4E3B\u673A\u7684\u76EE\u5F55\u6216\u662F\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u5B58\u50A8\u5377\u540D\uFF08\u81EA\u52A8\u65B0\u5EFA\uFF09\u3002",headerBordered:!0,direction:"column",children:(0,e.jsx)(ee.u,{name:"volumes",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u6620\u5C04\u76EE\u5F55"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsxs)(I.Z.Compact,{children:[(0,e.jsx)(w.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u3001\u76EE\u5F55\u6216\u5B58\u50A8\u5377",name:"host",width:"md",required:!0,rules:[{required:!0}]}),(0,e.jsx)(Ae.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(w.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md",required:!0,rules:[{required:!0}]})]})})})]})}),Se=Te,Ze=t(2831),Oe=t(10418),pe=t(71338);function ke(){var _=(0,m.useState)(),O=N()(_,2),F=O[0],b=O[1];return(0,m.useEffect)(function(){(0,Ze.a)().then(function(C){return b(C.data.info)})},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(X.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:64,children:(0,e.jsx)(Oe.Z,{addonAfter:"MB",min:64})}),(0,e.jsx)(X.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(pe.Z,{step:.1,max:F==null?void 0:F.NCPU,marks:{0:"\u4E0D\u9650\u5236",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(X.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(pe.Z,{step:256,max:Math.round((F==null?void 0:F.MemTotal)/1024/1024),marks:{0:"\u4E0D\u9650\u5236",1024:"1G",2048:"2G",3072:"3G",4096:"2G"}})})]})}function Ne(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ee.u,{name:"label",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(w.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(w.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var oe=t(52688),Me=t(69677);function fe(_){var O=(0,m.useState)(""),F=N()(O,2),b=F[0],C=F[1],B=(0,m.useState)("default"),h=N()(B,2),R=h[0],j=h[1],p=function(f){return(0,e.jsx)(T.ZP,{type:R==f.type?"primary":"default",onClick:function(){return s(f.type)},children:f.text})},s=function(f){if(j(f),f=="default")C("");else{var v;C((v=_.value)!==null&&v!==void 0?v:"")}};return(0,m.useEffect)(function(){_.value&&(C(_.value),j("user"))},[_.value]),(0,e.jsx)(X.Z,{label:_.label,tooltip:_.tooltip,name:_.name,children:(0,e.jsxs)(I.Z.Compact,{children:[(0,e.jsx)(p,{text:"\u4F7F\u7528\u9ED8\u8BA4",type:"default"}),(0,e.jsx)(p,{text:"\u81EA\u5B9A\u4E49",type:"user"}),(0,e.jsx)(Me.Z,{disabled:R=="default",value:b,style:{width:"500px"},onChange:function(f){C(f.target.value)}})]})})}fe.defaultProps={};var ue=fe,Le=t(44771);function Ue(){var _,O,F,b,C,B,h,R,j=(0,m.useContext)($.Z),p=j.createFormRef,s=j.volumeListRef,n=j.domainRef,f=j.createEnvRef,v=j.createLinkRef;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Le.Z,{}),(0,e.jsx)(oe.Z,{name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(ue,{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",value:(_=(O=p.current)===null||O===void 0?void 0:O.getFieldValue("workDir"))!==null&&_!==void 0?_:""}),(0,e.jsx)(ue,{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237",name:"user",value:(F=(b=p.current)===null||b===void 0?void 0:b.getFieldValue("user"))!==null&&F!==void 0?F:""}),(0,e.jsx)(ue,{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command",value:(C=(B=p.current)===null||B===void 0?void 0:B.getFieldValue("command"))!==null&&C!==void 0?C:""}),(0,e.jsx)(ue,{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4",name:"entrypoint",value:(h=(R=p.current)===null||R===void 0?void 0:R.getFieldValue("entrypoint"))!==null&&h!==void 0?h:""})]})}var We=t(91845),he=t(62597),ve=t(54006),Ve=t(14946),$e=t(93246),Ke=t(31418),Ge=(0,m.forwardRef)(function(_,O){var F=(0,m.useState)(!1),b=N()(F,2),C=b[0],B=b[1],h=(0,m.useRef)(),R=Ke.Z.useApp();(0,m.useImperativeHandle)(O,function(){return{}});var j=function(s){var n,f,v=!1,i=(n=(f=h.current)===null||f===void 0?void 0:f.getList())!==null&&n!==void 0?n:[];if(i.map(function(o){o.name==s.name&&(v=!0)}),!v){var a;(a=h.current)===null||a===void 0||a.add(s)}};return(0,e.jsxs)(U.Z,{title:"\u5173\u8054\u7F51\u7EDC",headerBordered:!0,children:[(0,e.jsx)(ee.u,{name:"network",actionRef:h,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u7F51\u7EDC"},actionGuard:{beforeAddRow:function(s,n){return!_.siteName||_.siteName==""||typeof _.siteName=="undefined"?((0,$e.YZ)(R,"\u8BF7\u8F93\u5165\u7AD9\u70B9\u6807\u8BC6"),!1):(B(!0),!1)}},copyIconProps:!1,min:0,itemRender:function(s,n){return(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(w.Z,{label:"\u7F51\u7EDC\u540D\u79F0",name:"name",width:"md",disabled:!0,fieldProps:{value:n.record.name}}),(0,e.jsx)(X.Z,{label:"\u8BBF\u95EEHostname",name:"alise",children:(0,e.jsx)(d.Z.Text,{code:!0,copyable:!0,children:n.record.alise})}),(0,e.jsx)(X.Z,{label:" ",children:s.action})]})}}),(0,e.jsx)(g.Z,{title:"\u9009\u62E9\u7F51\u7EDC",width:1024,footer:!1,open:C,onCancel:function(){return B(!1)},children:(0,e.jsx)(K.Z,{rowKey:"Name",columns:[{title:"\u540D\u79F0",dataIndex:"Name",render:function(s,n,f,v,i){return n.Name=="none"||n.Name=="bridge"||n.Name=="host"?(0,e.jsxs)(e.Fragment,{children:[n.Name," ",(0,e.jsx)(ce.Z,{color:"blue",children:"System"})]}):(0,e.jsx)(e.Fragment,{children:s})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,dataIndex:"Driver",search:!1},{title:"IPAM Driver",ellipsis:!0,width:120,search:!1,dataIndex:["IPAM","Driver"]},{title:"IPV4 IPAM Subnet",ellipsis:!0,width:150,search:!1,dataIndex:["IPAM","Config",0,"Subnet"]},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(s,n,f,v,i){return[(0,e.jsx)(T.ZP,{type:"link",onClick:function(){var o;j({name:n.Name,alise:[((o=_.siteName)!==null&&o!==void 0?o:"")+".pod.dpanel.local"]}),B(!1)},children:(0,e.jsx)(se.Z,{})},n.Id)]}}],request:function(){var p=E()(r()().mark(function s(n,f,v){var i;return r()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,Ve.jR)({name:n.Name});case 2:return i=o.sent,o.abrupt("return",{data:i.data.list,success:!0,total:i.data.list.length});case 4:case"end":return o.stop()}},s)}));return function(s,n,f){return p.apply(this,arguments)}}(),pagination:{pageSize:10}})})]})}),He=Ge,ze=(0,m.forwardRef)(function(_,O){var F=(0,m.useState)(""),b=N()(F,2),C=b[0],B=b[1],h=(0,m.useRef)();return(0,m.useImperativeHandle)(O,function(){return{setExposePort:function(j){if(j){var p,s,n=(p=(s=h.current)===null||s===void 0?void 0:s.getList())!==null&&p!==void 0?p:[];Object.keys(j).map(function(f){var v=!1;if(n.map(function(a){a.dest==f&&(v=!0)}),!v){var i;(i=h.current)===null||i===void 0||i.add({host:"",dest:f})}})}},setHostname:function(j){B(j)}}}),(0,e.jsx)(U.Z,{title:"\u66B4\u9732\u7AEF\u53E3",tooltip:"\u8BBF\u95EE\u7AEF\u53E3\u7559\u7A7A\u65F6\u968F\u673A\u751F\u6210\u7AEF\u53E3\uFF0C\u5168\u90E8\u5220\u9664\u5219\u8868\u793A\u4E0D\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,extra:(0,e.jsxs)(I.Z,{children:[(0,e.jsx)(oe.Z,{name:"useHostNetwork",fieldProps:{checkedChildren:"\u7ED1\u5B9AHost",unCheckedChildren:"\u7ED1\u5B9AHost"}}),(0,e.jsx)(oe.Z,{name:"bindIpV6",fieldProps:{checkedChildren:"\u7ED1\u5B9AIpV6",unCheckedChildren:"\u7ED1\u5B9AIpV6"}})]}),children:(0,e.jsx)(M.Z,{name:["useHostNetwork","bindIpV6"],children:function(j){var p=j.useHostNetwork,s=j.bindIpV6;if(!p)return(0,e.jsx)(ee.u,{name:"ports",actionRef:h,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(w.Z,{width:"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u6DFB\u52A0\u8BBF\u95EE\u7AEF\u53E3\u6216\u662F\u521B\u5EFA\u5B8C\u6210\u540E\u5BF9\u5BB9\u5668\u7ED1\u5B9A\u57DF\u540D",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3\uFF0C\u7ED1\u5B9AIpV6\u5FC5\u586B",required:s,rules:[{required:s}]}),(0,e.jsx)(w.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3",required:!0,rules:[{required:!0}]})]})})}})})}),Ye=ze;function Je(){var _,O,F,b=(0,m.useContext)($.Z),C=b.createFormRef,B=b.volumeListRef,h=b.domainRef,R=b.createEnvRef,j=b.createLinkRef,p=(0,m.useState)(!1),s=N()(p,2),n=s[0],f=s[1],v=(0,ve.useSearchParams)(),i=N()(v,2),a=i[0],o=i[1],k=(0,ve.useNavigate)(),A=parseInt((_=a.get("id"))!==null&&_!==void 0?_:""),P=(O=a.get("md5"))!==null&&O!==void 0?O:"",L=(F=a.get("imageId"))!==null&&F!==void 0?F:"";return(0,m.useEffect)(function(){if(P||A)(0,he.iE)({md5:P,id:A}).then(function(l){var Z;f(!0),l.data.env.network&&l.data.env.network.map(function(x){return!x.alise&&x.name!="bridge"&&(x.alise=[l.data.siteName+".pod.dpanel.local"]),x}),l.data.env.ports&&l.data.env.ports.map(function(x){return x.host=="0"&&(x.host=""),x}),(Z=C.current)===null||Z===void 0||Z.setFieldsValue({siteTitle:l.data.siteTitle,siteName:l.data.siteName,imageName:l.data.env.imageName,privileged:l.data.env.privileged,bindIpV6:l.data.env.bindIpV6,useHostNetwork:l.data.env.useHostNetwork,workDir:l.data.env.workDir,user:l.data.env.user,command:l.data.env.command,entrypoint:l.data.env.entrypoint,shmsize:l.data.env.shmsize,cpus:l.data.env.cpus,memory:l.data.env.memory,environment:l.data.env.environment,label:l.data.env.label,volumesDefault:l.data.env.volumesDefault,volumes:l.data.env.volumes,ports:l.data.env.ports,links:l.data.env.links,network:l.data.env.network,restart:l.data.env.restart})});else{var S;f(!1),(S=C.current)===null||S===void 0||S.resetFields()}},[a]),(0,e.jsx)(W._z,{children:(0,e.jsx)(U.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(V.A,{submitter:{render:function(l,Z){return(0,e.jsx)(Q.S,{children:Z})}},formRef:C,onFinish:function(){var S=E()(r()().mark(function l(Z){return r()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return Z.md5=P,console.log(Z),H.next=4,(0,he.$G)(Z);case 4:return k("/app/list"),H.abrupt("return",!0);case 6:case"end":return H.stop()}},l)}));return function(l){return S.apply(this,arguments)}}(),children:[(0,e.jsxs)(U.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(w.Z,{name:"siteTitle",label:"\u7AD9\u70B9\u540D\u79F0",required:!0,rules:[{required:!0}],fieldProps:{onChange:function(l){var Z="";if(l.target.value&&!n){var x,H=(0,We.N9)(l.target.value.trim(),{toneType:"none",type:"array"});Z=H.join(""),(x=C.current)===null||x===void 0||x.setFieldValue("siteName",Z)}}},placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(w.Z,{name:"siteName",label:"\u7AD9\u70B9\u6807\u8BC6",tooltip:"\u7AD9\u70B9\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u7AD9\u70B9\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:n,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(Fe,{redeploy:n,fromImageId:L})]}),(0,e.jsx)(Ye,{ref:h}),(0,e.jsx)(ye,{onAddEnv:function(l,Z){var x;(x=R.current)===null||x===void 0||x.addEnvItem(l,Z)},ref:j}),(0,e.jsx)(M.Z,{name:["siteName"],children:function(l){var Z=l.siteName;return(0,e.jsx)(He,{siteName:Z})}}),(0,e.jsx)(be,{ref:R}),(0,e.jsx)(Se,{ref:B}),(0,e.jsx)(U.Z,{title:"\u9AD8\u7EA7\u914D\u7F6E",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,e.jsx)(J.Z,{items:[{label:"\u542F\u52A8\u9879",key:"run-command",children:(0,e.jsx)(Ue,{})},{label:"\u8D44\u6E90\u914D\u7F6E",key:"runtime",children:(0,e.jsx)(ke,{})},{label:"\u6807\u7B7E",key:"label",children:(0,e.jsx)(Ne,{})}]})})]},"form")})})}},62597:function(te,z,t){t.d(z,{$G:function(){return N},Ct:function(){return m},Tb:function(){return Q},cl:function(){return U},iE:function(){return M},lK:function(){return I},xb:function(){return X}});var Y=t(15009),r=t.n(Y),q=t(99289),E=t.n(q),y=t(54006);function N(g){return W.apply(this,arguments)}function W(){return W=E()(r()().mark(function g(d){return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,y.request)("/api/app/site/create-by-image",{method:"POST",data:d}));case 1:case"end":return u.stop()}},g)})),W.apply(this,arguments)}function U(g){return V.apply(this,arguments)}function V(){return V=E()(r()().mark(function g(d){return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,y.request)("/api/app/site/get-list",{method:"POST",data:d}));case 1:case"end":return u.stop()}},g)})),V.apply(this,arguments)}function Q(g){return w.apply(this,arguments)}function w(){return w=E()(r()().mark(function g(d){return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,y.request)("/api/app/log/run",{method:"POST",data:d});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},g)})),w.apply(this,arguments)}function M(g){return J.apply(this,arguments)}function J(){return J=E()(r()().mark(function g(d){return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,y.request)("/api/app/site/get-detail",{data:d,method:"POST"});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},g)})),J.apply(this,arguments)}function m(g){return $.apply(this,arguments)}function $(){return $=E()(r()().mark(function g(d){return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,y.request)("/api/app/container/delete",{method:"POST",data:d}));case 1:case"end":return u.stop()}},g)})),$.apply(this,arguments)}function X(g){return K.apply(this,arguments)}function K(){return K=E()(r()().mark(function g(d){return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,y.request)("/api/app/site/delete",{method:"POST",data:d}));case 1:case"end":return u.stop()}},g)})),K.apply(this,arguments)}function I(g){return T.apply(this,arguments)}function T(){return T=E()(r()().mark(function g(d){return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,y.request)("/api/app/site/update-title",{method:"POST",data:d});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},g)})),T.apply(this,arguments)}},2831:function(te,z,t){t.d(z,{a:function(){return N},d:function(){return U}});var Y=t(15009),r=t.n(Y),q=t(99289),E=t.n(q),y=t(54006);function N(){return W.apply(this,arguments)}function W(){return W=E()(r()().mark(function Q(){return r()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,(0,y.request)("/api/common/home/info",{method:"POST"});case 2:return M.abrupt("return",M.sent);case 3:case"end":return M.stop()}},Q)})),W.apply(this,arguments)}function U(){return V.apply(this,arguments)}function V(){return V=E()(r()().mark(function Q(){return r()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,(0,y.request)("/api/common/home/upgrade-script",{method:"POST"});case 2:return M.abrupt("return",M.sent);case 3:case"end":return M.stop()}},Q)})),V.apply(this,arguments)}},14946:function(te,z,t){t.d(z,{CI:function(){return Q},HY:function(){return I},IS:function(){return N},XY:function(){return m},_3:function(){return g},_x:function(){return M},jR:function(){return U},t9:function(){return X}});var Y=t(15009),r=t.n(Y),q=t(99289),E=t.n(q),y=t(54006);function N(D){return W.apply(this,arguments)}function W(){return W=E()(r()().mark(function D(u){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,y.request)("/api/app/network/get-detail",{method:"POST",data:u}));case 1:case"end":return c.stop()}},D)})),W.apply(this,arguments)}function U(D){return V.apply(this,arguments)}function V(){return V=E()(r()().mark(function D(u){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,y.request)("/api/app/network/get-list",{method:"POST",data:u}));case 1:case"end":return c.stop()}},D)})),V.apply(this,arguments)}function Q(){return w.apply(this,arguments)}function w(){return w=E()(r()().mark(function D(){return r()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,(0,y.request)("/api/app/network/prune",{method:"POST"});case 2:return G.abrupt("return",G.sent);case 3:case"end":return G.stop()}},D)})),w.apply(this,arguments)}function M(D){return J.apply(this,arguments)}function J(){return J=E()(r()().mark(function D(u){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,y.request)("/api/app/network/delete",{method:"POST",data:u});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},D)})),J.apply(this,arguments)}function m(D){return $.apply(this,arguments)}function $(){return $=E()(r()().mark(function D(u){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,y.request)("/api/app/network/create",{method:"POST",data:u});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},D)})),$.apply(this,arguments)}function X(D){return K.apply(this,arguments)}function K(){return K=E()(r()().mark(function D(u){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,y.request)("/api/app/network/disconnect",{method:"POST",data:u});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},D)})),K.apply(this,arguments)}function I(D){return T.apply(this,arguments)}function T(){return T=E()(r()().mark(function D(u){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,y.request)("/api/app/network/connect",{method:"POST",data:u});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},D)})),T.apply(this,arguments)}function g(D){return d.apply(this,arguments)}function d(){return d=E()(r()().mark(function D(u){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,y.request)("/api/app/network/get-container-list",{method:"POST",data:u}));case 1:case"end":return c.stop()}},D)})),d.apply(this,arguments)}},60335:function(te,z,t){t.d(z,{IE:function(){return U},IW:function(){return N},KK:function(){return m},LJ:function(){return X},eE:function(){return M},jV:function(){return Q}});var Y=t(15009),r=t.n(Y),q=t(99289),E=t.n(q),y=t(54006);function N(I){return W.apply(this,arguments)}function W(){return W=E()(r()().mark(function I(T){return r()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,y.request)("/api/app/container/status",{method:"POST",data:T}));case 1:case"end":return d.stop()}},I)})),W.apply(this,arguments)}function U(I){return V.apply(this,arguments)}function V(){return V=E()(r()().mark(function I(T){return r()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,y.request)("/api/app/container/get-list",{data:T,method:"POST"}));case 1:case"end":return d.stop()}},I)})),V.apply(this,arguments)}function Q(I){return w.apply(this,arguments)}function w(){return w=E()(r()().mark(function I(T){return r()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,y.request)("/api/app/container/get-detail",{data:T,method:"POST"}));case 1:case"end":return d.stop()}},I)})),w.apply(this,arguments)}function M(I){return J.apply(this,arguments)}function J(){return J=E()(r()().mark(function I(T){return r()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,y.request)("/api/app/container/update",{data:T,method:"POST"}));case 1:case"end":return d.stop()}},I)})),J.apply(this,arguments)}function m(){return $.apply(this,arguments)}function $(){return $=E()(r()().mark(function I(){return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,y.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return g.stop()}},I)})),$.apply(this,arguments)}function X(I){return K.apply(this,arguments)}function K(){return K=E()(r()().mark(function I(T){return r()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,y.request)("/api/app/container/export",{method:"POST",data:T,responseType:"blob"}));case 1:case"end":return d.stop()}},I)})),K.apply(this,arguments)}}}]);
