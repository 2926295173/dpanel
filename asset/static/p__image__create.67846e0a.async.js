"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7523],{75544:function(V,R,e){var C=e(5574),n=e.n(C),I=e(12323),s=e(78267),d=e.n(s),i=e(75458),j=e.n(i),p=e(67294),c=e(4244),g=e.n(c),m=e(24078),_=e(85893),P,v,a,T=(0,p.forwardRef)(function(r,o){var u,D=(0,p.useState)(!0),w=n()(D,2),X=w[0],Q=w[1];return(0,p.useEffect)(function(){return P=new c.Terminal(I.X),v=new i.SearchAddon,a=new s.FitAddon,window.addEventListener("resize",function(){r.showInModal||a.fit()}),r.style&&r.style.fontSize&&(P.options.fontSize=r.style.fontSize),P.loadAddon(a),P.loadAddon(v),P.open(document.getElementById(r.id?r.id:"terminal-container")),r.showInModal||a.fit(),function(){P.reset(),Q(!0)}},[]),(0,p.useImperativeHandle)(o,function(){return{write:function(E){X&&(a.fit(),Q(!1)),P.write(E)},clear:function(){P.clear()},getTerminal:function(){return P},findNext:function(E){v.findNext(E)},findPrev:function(E){v.findPrevious(E)},fit:function(){a.fit()},onData:function(E){return P.onData(E)}}}),(0,_.jsx)("div",{id:r.id?r.id:"terminal-container",style:{width:r.width?r.width:"100%",height:r.height?r.height:"500px",marginTop:(u=r.style)===null||u===void 0?void 0:u.marginTop}})});R.Z=T},94359:function(V,R,e){e.d(R,{Z:function(){return T}});var C=e(5574),n=e.n(C),I=e(3089),s=e(98165),d=e(18429),i=e(8751),j=e(66212),p=e(14313),c=e(30159),g=e(87740),m=e(50888),_=e(66309),P=e(83062),v=e(36146),a=e(85893);function T(r){var o,u,D=new v.Uo("components.containerStatus"),w=r.status.split("."),X=n()(w,2),Q=X[0],h=X[1],E="";E=D.format(r.status,(o=r.statusValue)!==null&&o!==void 0?o:{});var f=(0,a.jsx)(a.Fragment,{});return h=="0"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(I.Z,{}),color:"default",children:E})),h=="10"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(s.Z,{spin:!0}),color:"processing",children:E})),h=="20"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(d.Z,{}),color:"error",children:E})),h=="30"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(i.Z,{}),color:"success",children:E})),h=="new"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(j.Z,{}),children:E})),(h=="running"||h=="healthy"||h=="active"||h=="ready")&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(p.Z,{}),color:"success",children:E})),(h=="paused"||h=="pause"||h=="rollback_paused")&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(c.Z,{}),color:"warning",children:E})),(h=="waiting"||h=="starting"||h=="accepted")&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(g.Z,{}),children:E})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(h)&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(m.Z,{}),color:"processing",children:E})),(h=="error"||h=="down"||h=="failed")&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(d.Z,{}),color:"error",children:E})),["complete","completed","rollback_completed"].includes(h)&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(i.Z,{}),color:"success",children:E})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(h)&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(d.Z,{}),color:"warning",children:E})),(0,a.jsx)(P.Z,{placement:"top",title:(u=r.tip)!==null&&u!==void 0?u:"",children:f})}},27166:function(V,R,e){var C=e(97857),n=e.n(C),I=e(5574),s=e.n(I),d=e(13769),i=e.n(d),j=e(184),p=e(74330),c=e(67294),g=e(85893),m=["requestLoading"],_=(0,c.forwardRef)(function(P,v){var a,T=P.requestLoading,r=i()(P,m),o=(0,c.useState)(!1),u=s()(o,2),D=u[0],w=u[1];return(0,c.useImperativeHandle)(v,function(){return{loading:function(){w(!0)},finish:function(){w(!1)}}}),(0,g.jsx)(j.a,n()(n()({},r),{},{children:(0,g.jsx)(p.Z,{spinning:(a=P.requestLoading)!==null&&a!==void 0?a:D,size:"default",style:{marginTop:"30%"},children:P.children})}))});R.Z=_},81366:function(V,R,e){var C=e(97857),n=e.n(C),I=e(19632),s=e.n(I),d=e(5574),i=e.n(d),j=e(27254),p=e(42075),c=e(85418),g=e(25593),m=e(83622),_=e(67294),P=e(31112),v=e(85893),a={title:"/",path:"/"},T=(0,_.forwardRef)(function(r,o){var u=(0,_.useContext)(P.Z),D=u.showPath,w=u.redirectPath,X=(0,_.useState)([a]),Q=i()(X,2),h=Q[0],E=Q[1];(0,_.useImperativeHandle)(o,function(){return{addHistory:function(B,t){t=="/"?E([a]):E([].concat(s()(h),[{title:B,path:t}]))},initHistory:function(B,t){E([n()(n()({},a),{},{children:t})].concat(s()(B)))}}});var f=function(B){D?D(h[B].title,h[B].path):r.showPath&&r.showPath(h[B].title,h[B].path);var t=h.filter(function(_e,ce){return ce<=B});E(s()(t))};return(0,v.jsxs)(p.Z,{children:[(0,v.jsx)(p.Z.Compact,{children:h.map(function(y,B){return y.children?(0,v.jsxs)(c.Z.Button,{menu:{items:y.children.map(function(t,_e){return{key:_e,label:(0,v.jsx)(g.Z.Link,{onClick:function(){w(t)},children:t},_e)}})},type:"dashed",onClick:function(_e){f(B)},children:[(0,v.jsx)(j.Z,{})," ",y.title]},B):(0,v.jsx)(m.ZP,{icon:(0,v.jsx)(j.Z,{}),type:"dashed",onClick:function(){f(B)},children:y.title},B)})}),h.length>=2&&(0,v.jsx)(g.Z.Text,{copyable:{text:h[h.length-1].path}})]})});R.Z=T},31112:function(V,R,e){var C=e(67294),n=(0,C.createContext)({});R.Z=n},68536:function(V,R,e){e.d(R,{Z:function(){return m}});var C=e(24963),n=e(36146),I=e(93613),s=e(36693),d=e(2741),i=e(25593),j=e(42075),p=e(67294),c=e(85893),g=0;function m(_){var P=(0,p.useContext)(C.Z),v=P.message,a=new n.Uo("components.explorer");return _.isDir?(0,c.jsx)(i.Z.Link,{onClick:function(){_.onClick&&_.onClick()},children:(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(I.Z,{}),_.showName]})}):_.isLink?(0,c.jsx)(i.Z.Link,{onClick:function(){_.onClick&&_.onClick()},children:(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(s.Z,{}),_.showName]})}):(0,c.jsx)(i.Z.Text,{onClick:function(){if(g++,g==2){g=0,_.onClick&&_.onClick();return}setTimeout(function(){g==1&&v.info(a.format("fileNameMessageViewDetail")),g=0},400)},style:{cursor:"pointer"},children:(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(d.Z,{}),_.showName]})})}},80271:function(V,R,e){var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(5574),i=e.n(d),j=e(184),p=e(9773),c=e(83062),g=e(67294),m=e(68536),_=e(5251),P=e(81366),v=e(3616),a=e(36146),T=e(73813),r=e(85893),o=(0,g.forwardRef)(function(u,D){(0,g.useImperativeHandle)(D,function(){return{show:function(){}}});var w=(0,g.useState)(""),X=i()(w,2),Q=X[0],h=X[1],E=(0,g.useState)(!1),f=i()(E,2),y=f[0],B=f[1],t=(0,g.useRef)(),_e=(0,g.useRef)(),ce=function(Y,F){h(F)},re=new a.Uo("components.explorer"),me=new a.Uo("image");return(0,r.jsx)(j.a,{drawerProps:{width:v.R_},open:y,submitter:!1,title:me.format("fileTitle"),onOpenChange:function(Y){B(Y),h(Y?"/":"")},trigger:(0,r.jsx)(c.Z,{title:me.format("fileTitle"),children:u.trigger}),children:(0,r.jsx)(p.Z,{headerTitle:(0,r.jsx)(P.Z,{ref:_e,showPath:ce}),scroll:{x:"max-content"},search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},actionRef:t,request:s()(n()().mark(function J(){var Y;return n()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(Q!=""){q.next=2;break}return q.abrupt("return",{data:[],total:0,success:!0});case 2:return q.next=4,(0,T.cD)({md5:u.imageId,path:Q});case 4:return Y=q.sent,q.abrupt("return",{data:Y.data.info,total:Y.data.info.length,success:!0});case 6:case"end":return q.stop()}},J)})),columns:[{title:re.format("listName"),dataIndex:"showName",key:"name",render:function(pe,F,q,Oe,Pe){var pe,ee=F.name.replace(Q,"");return F.isDir?pe=(0,r.jsx)(m.Z,{isDir:!0,onClick:function(){return ce(ee,F.path)},showName:ee}):F.isSymlink?pe=(0,r.jsx)(m.Z,{isLink:!0,showName:ee}):pe=(0,r.jsx)(m.Z,{showName:ee}),pe}},{title:re.format("listModStr"),dataIndex:"modStr",key:"modStr"},{title:re.format("listUser"),dataIndex:"user"},{title:re.format("listGroup"),dataIndex:"group"},{title:re.format("listSize"),dataIndex:"size",key:"size",render:function(Y,F,q,Oe,Pe){return(0,_.FI)(F.size)}},{title:re.format("listModTime"),dataIndex:"modTime",key:"modTime",render:function(Y,F,q,Oe,Pe){return(0,_.NF)(F.modTime)},sorter:function(Y,F){return new Date(Y.modTime).getTime()-new Date(F.modTime).getTime()}}],cardProps:{ghost:!0}},"".concat(u.imageId,"-").concat(Q))})});R.Z=o},2205:function(V,R,e){e.d(R,{Z:function(){return g}});var C=e(97857),n=e.n(C),I=e(5574),s=e.n(I),d=e(75870),i=e(36146),j=e(34041),p=e(67294),c=e(85893);function g(m){var _=(0,p.useState)([]),P=s()(_,2),v=P[0],a=P[1],T=new i.Uo("components.selectRegistry");(0,p.useEffect)(function(){(0,d.Ot)().then(function(o){o&&a(o.data.list)})},[]);var r={};return m.multiple&&(r.mode="multiple"),m.top&&(r.placement="topLeft"),(0,c.jsx)(j.Z,n()({popupMatchSelectWidth:!m.width,style:m.width?{width:m.width}:{},onChange:function(u){if(u)if(Array.isArray(u)){var D=u.map(function(w){return v[w]});m.onChangeList&&m.onChangeList(D)}else m.onChange&&m.onChange(v[u])},placeholder:T.format("nameEmpty"),options:v.map(function(o,u){return{value:u,label:o.title+"("+o.serverAddress+")"}}),allowClear:!0},r))}},78451:function(V,R,e){e.d(R,{Z:function(){return I}});var C=e(67294),n=e(85893);function I(s){var d;return(0,n.jsx)("span",{style:{width:s.width?s.width:"auto",wordBreak:"break-word"},children:(d=s.content)!==null&&d!==void 0?d:s.children})}},51100:function(V,R,e){e.d(R,{Z:function(){return d}});var C=e(4813),n=e(91604),I=e(1677),s=e(85893);function d(i){return i.showDragger?(0,s.jsx)(n.Z,{max:i.max?i.max:1,title:i.title,label:i.label,required:i.required,rules:[{required:i.required}],fieldProps:{multiple:!!(i.max&&i.max>1),name:"file",accept:i.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(p){return new Promise(function(c){var g;(0,C._)({path:(g=p.response.data.path)!==null&&g!==void 0?g:""}).then(function(m){c(!0)})})},onChange:function(p){p.file.status=="done"&&i.onFinish&&i.onFinish(p.fileList)}},name:i.name}):(0,s.jsx)(I.Z,{max:i.max?i.max:1,title:i.title,label:i.label,required:i.required,rules:[{required:i.required}],fieldProps:{multiple:!!(i.max&&i.max>1),name:"file",accept:i.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(p){return new Promise(function(c){var g;(0,C._)({path:(g=p.response.data.path)!==null&&g!==void 0?g:""}).then(function(m){c(!0)})})},onChange:function(p){p.file.status=="done"&&i.onFinish&&i.onFinish(p.fileList)}},name:i.name})}},12323:function(V,R,e){e.d(R,{X:function(){return C},n:function(){return n}});var C={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},n=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},65913:function(V,R,e){var C=e(5574),n=e.n(C),I=e(74330),s=e(67294),d=e(85893),i=(0,s.forwardRef)(function(j,p){(0,s.useImperativeHandle)(p,function(){return{show:function(){_(!0)},destroy:function(){_(!1)}}});var c=(0,s.useState)(!1),g=n()(c,2),m=g[0],_=g[1];return(0,d.jsx)(I.Z,{spinning:m,size:"default",children:j.children})});R.Z=i},99430:function(V,R,e){e.r(R),e.d(R,{default:function(){return we}});var C=e(15009),n=e.n(C),I=e(97857),s=e.n(I),d=e(99289),i=e.n(d),j=e(74453),p=e(25593),c=e(42075),g=e(96074),m=e(83062),_=e(97841),P=e(94359),v=e(86548),a=e(87740),T=e(82061),r=e(80821),o=e(67294),u=e(5574),D=e.n(u),w=e(38345),X=e(82346),Q=e(75544),h=e(3616),E=e(36146),f=e(85265),y=e(74330),B=e(38703),t=e(85893),_e=(0,o.forwardRef)(function(G,fe){var b=(0,X.useModel)("subscriber"),te=(0,o.useRef)(),ne=(0,o.useState)(!1),L=D()(ne,2),O=L[0],N=L[1],se=(0,o.useState)(""),S=D()(se,2),U=S[0],Z=S[1],H=(0,o.useState)(0),W=D()(H,2),l=W[0],M=W[1];return(0,o.useImperativeHandle)(fe,function(){return{start:function(){for(var $=arguments.length,z=new Array($),K=0;K<$;K++)z[K]=arguments[K];var ae=z.join(":");N(!0),M(0),Z(ae),b.addDataHandler("image:"+ae,function(A){var le;if(A.data.includes("Step")){var ie=Array.from(A.data.matchAll(/Step\s+(\d+)\/(\d+)/g));if(ie.length>0){var de=ie[ie.length-1],he=parseInt(de[1],10),oe=parseInt(de[2],10);if(oe>0&&he>=1&&he<=oe){var ge=he/oe*100;M(Math.round(ge))}}}(le=te.current)===null||le===void 0||le.write(A.data)})},close:function(){var $;($=te.current)===null||$===void 0||$.clear(),N(!1)},show:function($){N(!0),setTimeout(function(){var z,K;(z=te.current)===null||z===void 0||z.clear(),(K=te.current)===null||K===void 0||K.write($)},500)}}}),(0,t.jsx)(f.Z,{width:h.ob,destroyOnHidden:!0,title:E.FD.format("listLog"),afterOpenChange:function($){if($){var z,K;(z=te.current)===null||z===void 0||z.clear(),(K=te.current)===null||K===void 0||K.fit()}},onClose:function(){b.progress.close("image:"+U),N(!1),M(0),Z(""),G.onFinish&&G.onFinish()},open:O,children:(0,t.jsx)(w.Z,{ghost:!0,children:(0,t.jsxs)(y.Z,{spinning:l==0,children:[(0,t.jsx)(B.Z,{strokeLinecap:"butt",percent:l,size:["100%",10],percentPosition:{align:"center",type:"inner"},format:function(){return null}}),(0,t.jsx)(Q.Z,{style:{fontSize:12},height:"85vh",ref:te})]})})})}),ce=_e,re=e(19632),me=e.n(re),J=e(91058),Y=e(11106),F=e(62370),q=e(12491);function Oe(G){var fe=new E.Uo("image");return(0,t.jsx)(F.Z,{shouldUpdate:!0,children:function(te){var ne=te.getFieldValue,L=te.setFieldValue;return[(0,t.jsx)(F.Z,{name:G.name,hidden:!0},"input"),(0,t.jsx)(q.Z,{title:fe.format("formBuildDockerfileContent"),onImport:function(N){return L(G.name,N),!0},onLoad:function(N){if(N.indexOf("FROM ")<0)throw new Error(E.FD.format("commonFileIncorrectFormat",{name:"Dockerfile"}));return!0}},"importFile"),(0,t.jsx)(Y.ZP,{value:ne("buildDockerfileContent"),onChange:function(N){L(G.name,N)},height:"600px",theme:"dark",style:{marginBottom:"20px"}},"codeMirror")]}})}var Pe=e(51100),pe=e(75870),ee=e(5966),je=e(24739),Ce=e(64317),ye=e(86615),Ie=e(97462),Te=e(90672),Ue=e(83622),We=e(27166),Ae=e(22390),Le=e(73813),Be=e(68297),xe=e(24963),Ze=(0,o.forwardRef)(function(G,fe){var b=new E.Uo("image"),te=(0,o.useContext)(xe.Z),ne=te.message,L=(0,o.useRef)(),O=(0,o.useRef)(),N=(0,o.useState)(!1),se=D()(N,2),S=se[0],U=se[1],Z=(0,o.useRef)();return(0,o.useImperativeHandle)(fe,function(){return{show:function(W){return i()(n()().mark(function l(){var M,k,$,z,K,ae,A,le,ie,de,he,oe,ge,x,ue,Re,ve,Ee,be;return n()().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return U(!0),(M=Z.current)===null||M===void 0||M.loading(),De.next=4,(0,_.Xr)({id:W}).finally(function(){var Me;(Me=Z.current)===null||Me===void 0||Me.finish()});case 4:x=De.sent,(k=x.data.detail.setting)!==null&&k!==void 0&&k.buildGit&&(Ee=x.data.detail.setting.buildGit,Ee.includes("#")?(be=(0,Ae.Z)(Ee,"#"),ue=Ee.slice(0,be),Re=Ee.slice(be+1)):ue=Ee,ue.includes("@")&&(ve=new URL(ue),ve&&(ue="".concat(ve.origin).concat(ve.pathname)))),($=O.current)===null||$===void 0||$.setFieldsValue({id:x.data.detail.id,title:x.data.detail.title,imageTag:(z=x.data.detail.setting)===null||z===void 0?void 0:z.tag,imageRegistry:(K=x.data.detail.setting)===null||K===void 0?void 0:K.registry,buildType:(ae=x.data.detail.setting)===null||ae===void 0?void 0:ae.buildType,buildDockerfileRoot:(A=x.data.detail.setting)===null||A===void 0?void 0:A.buildDockerfileRoot,buildDockerfileContent:(le=x.data.detail.setting)===null||le===void 0?void 0:le.buildDockerfileContent,buildDockerfileName:(ie=x.data.detail.setting)===null||ie===void 0?void 0:ie.buildDockerfileName,buildGit:ue,buildGitBranch:Re,buildGitUsername:(de=ve)===null||de===void 0?void 0:de.username,buildGitPassword:(he=ve)===null||he===void 0?void 0:he.password,buildArgs:(oe=x.data.detail.setting)===null||oe===void 0?void 0:oe.buildArgs,platform:(ge=x.data.detail.setting)===null||ge===void 0?void 0:ge.platform});case 7:case"end":return De.stop()}},l)}))()}}}),(0,t.jsx)(We.Z,{drawerProps:{width:h.R_},ref:Z,title:E.Ob.format("image.create"),open:S,onOpenChange:function(W){if(U(W),!W){var l;(l=O.current)===null||l===void 0||l.resetFields(),G.onFinish&&G.onFinish()}},trigger:(0,t.jsx)(Ue.ZP,{type:"primary",children:E.Ob.format("image.create")},"create"),onFinish:function(){var H=i()(n()().mark(function W(l){var M,k,$,z,K,ae,A,le,ie,de,he,oe;return n()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(k=(M=l.buildType)!==null&&M!==void 0?M:"dockerfile",k!="containerTar"){x.next=7;break}return x.next=4,(0,Le.Ck)({tag:l.imageTag,registry:l.imageRegistry,tar:($=l.containerTar[0].response.data.path)!==null&&$!==void 0?$:"",cmd:l.cmd,workDir:l.workDir,expose:l.expose?l.expose.split(`
`):[],env:l.env?l.env.split(`
`):[],volume:l.volume?l.volume.split(`
`):[]});case 4:return x.abrupt("return",!0);case 7:return ae={name:"",arch:""},Be.ii.map(function(ue){ue.name==l.platform&&(ae=ue)}),A={id:l.id?parseInt(l.id):0,tag:l.imageTag,title:l.title,registry:l.imageRegistry,buildDockerfileContent:l.buildDockerfileContent,buildDockerfileRoot:l.buildDockerfileRoot,buildDockerfileName:l.buildDockerfileName,buildZip:"",buildGit:l.buildGit,buildType:l.buildType,platform:{type:ae.name,arch:ae.arch},buildArgs:l.buildArgs},l.buildZip&&l.buildZip.length>0&&(A.buildZip=(le=l.buildZip[0].response.data.path)!==null&&le!==void 0?le:""),k=="git"&&(A.buildGit=A.buildGit+"#"+(l.buildGitBranch||"master"),l.buildDockerfileRoot&&l.buildDockerfileRoot!=""&&(A.buildGit="".concat(A.buildGit,":").concat(l.buildDockerfileRoot)),l.buildGitUsername&&l.buildGitPassword&&(ie="https://",A.buildGit.includes("http://")&&(ie="http://"),A.buildGit="".concat(A.buildGit.replace(ie,"".concat(ie).concat(l.buildGitUsername,":").concat(l.buildGitPassword,"@"))))),(z=L.current)===null||z===void 0||z.start("build",((K=A.id)!==null&&K!==void 0?K:0).toString()),x.prev=13,x.next=16,(0,_.l9)(A);case 16:return he=x.sent,ne.success(E.FD.format("finish")),x.next=20,new Promise(function(ue){setTimeout(function(){ue(!0)},1e3)});case 20:return(de=L.current)===null||de===void 0||de.close(),x.abrupt("return",!0);case 24:x.prev=24,x.t0=x.catch(13),(oe=L.current)===null||oe===void 0||oe.close();case 27:case"end":return x.stop()}},W,null,[[13,24]])}));return function(W){return H.apply(this,arguments)}}(),formRef:O,children:(0,t.jsxs)(w.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,t.jsxs)(w.Z,{ghost:!0,children:[(0,t.jsx)(F.Z,{name:"id",hidden:!0}),(0,t.jsx)(ee.Z,{width:"lg",label:b.format("formTitle"),name:"title"}),(0,t.jsxs)(je.UW,{children:[(0,t.jsx)(Ce.Z,{width:"lg",label:b.format("formImageRegistry"),tooltip:b.format("formImageRegistryTip"),name:"imageRegistry",request:i()(n()().mark(function H(){var W;return n()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,(0,pe.Ot)();case 2:return W=M.sent,M.abrupt("return",W.data.list.map(function(k){return{value:k.serverAddress,label:k.title+"("+k.serverAddress+")"}}));case 4:case"end":return M.stop()}},H)}))}),(0,t.jsx)(ee.Z,{rules:[{required:!0}],width:"lg",required:!0,tooltip:b.format("formImageTagTip"),placeholder:b.format("formImageTagEmpty"),label:b.format("formImageTag"),name:"imageTag"})]}),(0,t.jsx)(ye.Z.Group,{name:"buildType",initialValue:"dockerfile",label:b.format("formBuildType"),options:b.option("formBuildTypeOption",["dockerfile","zip","git","containerTar"]).map(function(H){return{label:(0,t.jsx)(m.Z,{title:b.format("formBuildTypeTipOption."+H.value),children:H.label}),value:H.value}})}),(0,t.jsx)(Ie.Z,{name:["buildType"],children:function(W){var l=W.buildType,M=[];return l=="containerTar"?M=[(0,t.jsx)(ee.Z,{tooltip:b.format("formWorkDirTip"),label:b.format("formWorkDir"),name:"workDir",placeholder:b.format("formWorkDirEmpty")},"workDir"),(0,t.jsx)(ee.Z,{required:!0,tooltip:b.format("formCmdTip"),rules:[{required:!0}],label:"CMD",name:"cmd"},"cmd"),(0,t.jsx)(Te.Z,{tooltip:b.format("formExposeTip"),label:b.format("formExpose"),name:"expose",placeholder:`80 
9000`},"expose"),(0,t.jsx)(Te.Z,{tooltip:b.format("formEnvTip"),label:b.format("formEnv"),name:"env",placeholder:`TEST_VALUE=123 
TEST_NO_VALUE=`},"env"),(0,t.jsx)(Te.Z,{tooltip:b.format("formVolumeTip"),label:b.format("formVolume"),name:"volume",placeholder:`/app 
/home`},"volume")]:(l=="zip"||l=="git")&&(M=[(0,t.jsxs)(je.UW,{children:[(0,t.jsx)(ee.Z,{width:"lg",name:"buildDockerfileRoot",label:b.format("formBuildDockerfileRoot"),fieldProps:{addonBefore:"/"},placeholder:b.format("formBuildDockerfileRootEmpty")},"buildDockerfileRoot"),(0,t.jsx)(ee.Z,{width:"lg",name:"buildDockerfileName",label:b.format("formBuildDockerfileName"),placeholder:b.format("formBuildDockerfileNameEmpty")},"dockerfileName")]},"buildRoot"),(0,t.jsx)(J.Z,{drawerProps:{ghost:!0},name:"buildArgs",showAddButton:!0,showCodeMode:!0,listLabel:b.format("formBuildArgs")},"env")]),l=="zip"&&(M=[].concat(me()(M),[(0,t.jsx)(Pe.Z,{required:!0,label:b.format("formBuildZip"),name:"buildZip",accept:".zip"},"buildZip")])),l=="containerTar"&&(M=[].concat(me()(M),[(0,t.jsx)(Pe.Z,{required:!0,label:b.format("formBuildContainerTar"),name:"containerTar",accept:".tar"},"containerTar")])),l=="git"&&(M=[].concat(me()(M),[(0,t.jsxs)(je.UW,{children:[(0,t.jsxs)(c.Z.Compact,{block:!0,children:[(0,t.jsx)(ee.Z,{width:"md",label:b.format("formBuildGitUsername"),name:"buildGitUsername",placeholder:b.format("formBuildGitUsernameEmpty")}),(0,t.jsx)(ee.Z,{width:"md",label:b.format("formBuildGitPassword"),name:"buildGitPassword"})]}),(0,t.jsxs)(c.Z.Compact,{block:!0,children:[(0,t.jsx)(ee.Z,{label:b.format("formBuildGitBranch"),width:"md",name:"buildGitBranch"}),(0,t.jsx)(ee.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],width:"lg",required:!0,placeholder:b.format("formBuildGitEmpty"),label:b.format("formBuildGit"),name:"buildGit"})]})]},"buildGit")])),l=="dockerfile"&&(M=[].concat(me()(M),[(0,t.jsx)(Oe,{name:"buildDockerfileContent"},"buildDockerfileContent")])),M}})]}),(0,t.jsx)(ce,{onFinish:function(){U(!1),G.onFinish&&G.onFinish()},ref:L})]})})}),Ke=Ze,Se=e(98510),$e=e(78914);function we(){var G=(0,o.useRef)(),fe=(0,o.useRef)(),b=(0,o.useRef)(),te=(0,o.useRef)();return(0,t.jsxs)(j._z,{header:{extra:[(0,t.jsx)(Ke,{ref:b,onFinish:function(){var L;!((L=G.current)===null||L===void 0)&&L.reloadAndRest&&G.current.reloadAndRest()}},"create")]},children:[(0,t.jsx)($e.Z,{ref:te}),(0,t.jsx)(Se.C,{actionRef:G,rowKey:"id",columns:[{title:E.FD.format("listTitle"),render:function(L,O,N,se){return O.title}},{title:E.FD.format("listImageName"),dataIndex:"tag",search:!1,render:function(L,O,N,se){var S,U,Z;return(0,t.jsx)(p.Z.Link,{type:!((S=O.setting)!==null&&S!==void 0&&S.imageId)||O.setting.imageId==""?"secondary":void 0,onClick:function(){var W,l,M;!((W=O.setting)===null||W===void 0)&&W.imageId&&((l=te.current)===null||l===void 0||l.show((M=O.setting)===null||M===void 0?void 0:M.imageId))},children:(U=(Z=O.setting)===null||Z===void 0?void 0:Z.tag)!==null&&U!==void 0?U:O.tag})}},{title:E.FD.format("listStatus"),width:150,ellipsis:!0,search:!1,render:function(L,O,N,se){var S;return(S=O.setting)!==null&&S!==void 0&&S.imageId||(O.status=0),[(0,t.jsx)("div",{children:(0,t.jsx)(P.Z,{status:"status.".concat(O.status)},O.id)},O.id)]}},{title:E.FD.format("listManage"),valueType:"option",key:"option",width:100,fixed:"right",render:function(L,O,N,se){return(0,t.jsxs)(c.Z,{split:(0,t.jsx)(g.Z,{type:"vertical"}),children:[(0,t.jsx)(p.Z.Link,{onClick:function(){var U;O.id&&((U=b.current)===null||U===void 0||U.show(O.id))},children:(0,t.jsx)(m.Z,{title:E.FD.format("listManageEdit"),children:(0,t.jsx)(v.Z,{})})},"rebuild"),(0,t.jsx)(p.Z.Link,{onClick:i()(n()().mark(function S(){var U,Z,H,W,l,M,k,$,z,K;return n()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return(U=fe.current)===null||U===void 0||U.start("build",((Z=O.id)!==null&&Z!==void 0?Z:0).toString()),A.prev=1,A.next=4,(0,_.l9)(s()(s()({id:O.id,title:O.title},O.setting),{},{buildDockerfileContent:((H=O.setting)===null||H===void 0?void 0:H.buildDockerfileContent)||((W=O.setting)===null||W===void 0?void 0:W.buildDockerfile),buildDockerfileRoot:((l=O.setting)===null||l===void 0?void 0:l.buildDockerfileRoot)||((M=O.setting)===null||M===void 0?void 0:M.buildRoot),buildType:((k=O.setting)===null||k===void 0?void 0:k.buildType)||O.buildType,tag:(($=O.setting)===null||$===void 0?void 0:$.tag)||O.tag}));case 4:return z=A.sent,A.abrupt("return",!0);case 8:A.prev=8,A.t0=A.catch(1),(K=fe.current)===null||K===void 0||K.close();case 11:case"end":return A.stop()}},S,null,[[1,8]])})),children:(0,t.jsx)(m.Z,{title:E.FD.format("listManageBuild"),children:(0,t.jsx)(a.Z,{})})},"logs")]})}}],request:function(){var ne=i()(n()().mark(function L(O,N,se){var S,U,Z;return n()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,(0,_.bJ)({page:(S=O.current)!==null&&S!==void 0?S:1,pageSize:(U=O.pageSize)!==null&&U!==void 0?U:10});case 2:return Z=W.sent,W.abrupt("return",{data:Z.data.list,success:!0,total:Z.data.list.length});case 4:case"end":return W.stop()}},L)}));return function(L,O,N){return ne.apply(this,arguments)}}(),quickToolbarRender:function(L){var O=L.selectedRows,N=L.finish,se=L.loading;return(0,t.jsx)(c.Z,{size:16,children:(0,t.jsx)(r.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,t.jsx)(T.Z,{})},confirmProps:{showCommonConfirm:!0},action:function(){return se(),(0,_.hf)({id:O.map(function(U){return U.id})}).finally(function(){N(!0)})},onSuccess:function(){var U,Z;return!((U=G.current)===null||U===void 0)&&U.reloadAndRest&&((Z=G.current)===null||Z===void 0||Z.reloadAndRest()),!0},onError:function(){var U,Z;return!((U=G.current)===null||U===void 0)&&U.reset&&((Z=G.current)===null||Z===void 0||Z.reset()),!0},children:E.FD.format("listManageDeleteBatch")})})}}),(0,t.jsx)(ce,{onFinish:function(){var L;!((L=G.current)===null||L===void 0)&&L.reloadAndRest&&G.current.reloadAndRest()},ref:fe})]})}},4813:function(V,R,e){e.d(R,{_:function(){return i}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346);function i(p){return j.apply(this,arguments)}function j(){return j=s()(n()().mark(function p(c){return n()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,d.request)("/api/common/attach/delete",{method:"POST",data:c});case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},p)})),j.apply(this,arguments)}},97841:function(V,R,e){e.d(R,{Xr:function(){return _},bJ:function(){return g},c5:function(){return v},hf:function(){return i},l9:function(){return p}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346);function i(T){return j.apply(this,arguments)}function j(){return j=s()(n()().mark(function T(r){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,d.request)("/api/app/image-build/delete",{method:"POST",data:r});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},T)})),j.apply(this,arguments)}function p(T){return c.apply(this,arguments)}function c(){return c=s()(n()().mark(function T(r){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,d.request)("/api/app/image-build/create",{method:"POST",data:r}));case 1:case"end":return u.stop()}},T)})),c.apply(this,arguments)}function g(T){return m.apply(this,arguments)}function m(){return m=s()(n()().mark(function T(r){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,d.request)("/api/app/image-build/get-list",{method:"POST",data:r}));case 1:case"end":return u.stop()}},T)})),m.apply(this,arguments)}function _(T){return P.apply(this,arguments)}function P(){return P=s()(n()().mark(function T(r){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,d.request)("/api/app/image-build/get-detail",{method:"POST",data:r});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},T)})),P.apply(this,arguments)}function v(){return a.apply(this,arguments)}function a(){return a=s()(n()().mark(function T(){return n()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,d.request)("/api/app/image-build/prune",{method:"POST"});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},T)})),a.apply(this,arguments)}},73813:function(V,R,e){e.d(R,{Ck:function(){return i},Fj:function(){return T},GH:function(){return p},KG:function(){return _},Rb:function(){return D},Xz:function(){return g},YU:function(){return o},ZQ:function(){return X},ao:function(){return v},cD:function(){return h}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346);function i(f){return j.apply(this,arguments)}function j(){return j=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/import-by-container-tar",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),j.apply(this,arguments)}function p(f){return c.apply(this,arguments)}function c(){return c=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/import-by-image-tar",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),c.apply(this,arguments)}function g(f){return m.apply(this,arguments)}function m(){return m=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.request)("/api/app/image/prune",{method:"POST"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},f)})),m.apply(this,arguments)}function _(f){return P.apply(this,arguments)}function P(){return P=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/get-list",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),P.apply(this,arguments)}function v(f){return a.apply(this,arguments)}function a(){return a=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.request)("/api/app/image/delete",{method:"POST",data:y});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},f)})),a.apply(this,arguments)}function T(f){return r.apply(this,arguments)}function r(){return r=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.request)("/api/app/image/update-title",{method:"POST",data:y});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},f)})),r.apply(this,arguments)}function o(f){return u.apply(this,arguments)}function u(){return u=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/get-detail",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),u.apply(this,arguments)}function D(f){return w.apply(this,arguments)}function w(){return w=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!y.enableExportToPath){t.next=2;break}return t.abrupt("return",(0,d.request)("/api/app/image/export",{method:"POST",data:y}));case 2:return t.abrupt("return",new Promise(function(_e,ce){var re,me=localStorage.getItem("token"),J=new URLSearchParams;J.append("token",me||""),y.md5&&y.md5.forEach(function(q){J.append("md5",q)}),J.append("enableExportToPath",String((re=y.enableExportToPath)!==null&&re!==void 0?re:!1));var Y="/api/app/image/export?".concat(J.toString()),F=document.createElement("iframe");F.style.display="none",F.src=Y,document.body.appendChild(F),_e({code:200,data:"success",error:""})}));case 3:case"end":return t.stop()}},f)})),w.apply(this,arguments)}function X(f){return Q.apply(this,arguments)}function Q(){return Q=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/check-upgrade",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),Q.apply(this,arguments)}function h(f){return E.apply(this,arguments)}function E(){return E=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/pro/image/get-rootfs",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),E.apply(this,arguments)}},75870:function(V,R,e){e.d(R,{Ot:function(){return i},ZH:function(){return p},ix:function(){return g},t1:function(){return _}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346);function i(v){return j.apply(this,arguments)}function j(){return j=s()(n()().mark(function v(a){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.request)("/api/common/registry/get-list",{method:"POST",data:a}));case 1:case"end":return r.stop()}},v)})),j.apply(this,arguments)}function p(v){return c.apply(this,arguments)}function c(){return c=s()(n()().mark(function v(a){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.request)("/api/common/registry/create",{method:"POST",data:a}));case 1:case"end":return r.stop()}},v)})),c.apply(this,arguments)}function g(v){return m.apply(this,arguments)}function m(){return m=s()(n()().mark(function v(a){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.request)("/api/common/registry/delete",{method:"POST",data:a}));case 1:case"end":return r.stop()}},v)})),m.apply(this,arguments)}function _(v){return P.apply(this,arguments)}function P(){return P=s()(n()().mark(function v(a){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.request)("/api/common/registry/get-detail",{method:"POST",data:a}));case 1:case"end":return r.stop()}},v)})),P.apply(this,arguments)}},68297:function(V,R,e){e.d(R,{Qd:function(){return c},Ze:function(){return j},aw:function(){return a},cV:function(){return m},fy:function(){return P},ii:function(){return i}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346),i=[{name:"amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"i386",arch:"386",search:[]},{name:"arm/v6",arch:"arm",search:[]},{name:"arm/v7",arch:"arm",search:[]},{name:"arm/v8",arch:"arm64",search:[]},{name:"ppc64le",arch:"ppc64le",search:[]},{name:"riscv64",arch:"riscv64",search:[]}];function j(r){return p.apply(this,arguments)}function p(){return p=s()(n()().mark(function r(o){return n()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,d.request)("/api/app/image/tag-sync",{method:"POST",data:o}));case 1:case"end":return D.stop()}},r)})),p.apply(this,arguments)}function c(r){return g.apply(this,arguments)}function g(){return g=s()(n()().mark(function r(o){return n()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,d.request)("/api/app/image/tag-add",{method:"POST",data:o}));case 1:case"end":return D.stop()}},r)})),g.apply(this,arguments)}function m(r){return _.apply(this,arguments)}function _(){return _=s()(n()().mark(function r(o){return n()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,d.request)("/api/app/image/tag-delete",{method:"POST",data:o}));case 1:case"end":return D.stop()}},r)})),_.apply(this,arguments)}function P(r){return v.apply(this,arguments)}function v(){return v=s()(n()().mark(function r(o){return n()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,d.request)("/api/app/image/tag-push-batch",{method:"POST",data:o}));case 1:case"end":return D.stop()}},r)})),v.apply(this,arguments)}function a(r){return T.apply(this,arguments)}function T(){return T=s()(n()().mark(function r(o){return n()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,d.request)("/api/pro/image/get-remote-tag",{method:"POST",data:o}));case 1:case"end":return D.stop()}},r)})),T.apply(this,arguments)}}}]);
