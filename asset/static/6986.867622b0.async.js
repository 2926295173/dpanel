"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6986],{99922:function(me,N,e){var $=e(97857),t=e.n($),z=e(15009),_=e.n(z),x=e(99289),Y=e.n(x),u=e(5574),M=e.n(u),d=e(67294),R=e(85265),re=e(42075),s=e(28036),b=e(49610),h=e(3616),v=e(93362),w=e(90581),E=e(5251),I=e(36146),p=e(85893),c=new I.Uo("components.appDetail.appDetailQuickConsole"),J=(0,d.forwardRef)(function(r,g){var U,L,ae=(0,d.useRef)(),W=(0,d.useRef)(),T=(0,d.useState)(!1),m=M()(T,2),A=m[0],F=m[1],o=(0,d.useState)(),i=M()(o,2),a=i[0],j=i[1];return(0,d.useImperativeHandle)(g,function(){return{show:function(k){return Y()(_()().mark(function pe(){var ve;return _()().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:j(k),F(!0),(ve=ae.current)===null||ve===void 0||ve.resetFields();case 3:case"end":return Ce.stop()}},pe)}))()}}}),(0,d.useEffect)(function(){return setTimeout(function(){var n;a&&((n=W.current)===null||n===void 0||n.start(a.url,{cmd:a&&a.cmd,workDir:a&&a.workDir}))},1e3),function(){var n;(n=W.current)===null||n===void 0||n.close()}},[a,A]),(0,p.jsxs)(R.Z,{forceRender:!0,width:h.FK,open:A,onClose:function(){return[F(!1)]},title:c.format("drawerTitle",{name:a==null?void 0:a.title}),children:[(0,p.jsxs)(re.Z,{style:{marginBottom:20},children:[(0,p.jsx)(v.Z,{trigger:(0,p.jsx)(s.ZP,{type:"primary",children:c.format("fileExplorerButton")}),type:"container",title:(0,E.fi)((U=a==null?void 0:a.title)!==null&&U!==void 0?U:"","/"),name:a&&a.url&&(L=a.url.split("/").pop())!==null&&L!==void 0?L:""}),(0,p.jsx)(w.Z,{onChangeShell:function(k){var pe;if(!a)return!1;(pe=W.current)===null||pe===void 0||pe.close(),k!=(a==null?void 0:a.cmd)&&j(t()(t()({},a),{cmd:k}))},onOpenNewWindow:function(k){return a?(k.workDir=a&&a.workDir?a.workDir:"","".concat(a.url,"?").concat(Object.keys(k).map(function(pe){return"".concat(pe,"=").concat(encodeURIComponent(k[pe]))}).join("&"))):""},onOpenNewWindowFinish:function(){var k;(k=W.current)===null||k===void 0||k.close(),F(!1)},onBatchCommandFinish:function(k){W.current&&W.current.run(k)}})]}),A&&(0,p.jsx)(b.Z,{height:"80vh",ref:W})]})});N.Z=J},93362:function(me,N,e){var $=e(97857),t=e.n($),z=e(15009),_=e.n(z),x=e(99289),Y=e.n(x),u=e(5574),M=e.n(u),d=e(67294),R=e(57221),re=e(85265),s=e(3616),b=e(5251),h=e(36146),v=e(28031),w=e(24963),E=e(85893),I=(0,d.forwardRef)(function(p,c){var J,r=(0,d.useState)(!1),g=M()(r,2),U=g[0],L=g[1],ae=(0,d.useState)(),W=M()(ae,2),T=W[0],m=W[1],A=(0,d.useRef)(),F=new h.Uo("components.appDetail.appDetailQuickFile"),o=(0,d.useContext)(w.Z),i=o.loading;return(0,d.useImperativeHandle)(c,function(){return{showContainer:function(j){m({name:(0,b.fi)(j,"/"),type:"container"}),L(!0)},showHost:function(j){m({name:j,type:"host"}),L(!0)},showVolume:function(j){return Y()(_()().mark(function n(){var k;return _()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return i.show(),ve.next=3,(0,v.Ak)("app",{name:j}).finally(function(){i.destroy()});case 3:k=ve.sent,m({name:k.data.containerName,type:"container",workDir:k.data.path}),L(!0);case 6:case"end":return ve.stop()}},n)}))()}}}),(0,E.jsxs)(E.Fragment,{children:[p.trigger?d.cloneElement(p.trigger,{onClick:function(){p.name&&p.type&&(m(p),L(!0))}}):null,(0,E.jsx)(re.Z,{width:s.R_,title:F.format("drawerTitle",{name:(J=p.title)!==null&&J!==void 0?J:T==null?void 0:T.name}),onClose:function(){var j;(j=A.current)===null||j===void 0||j.close(),L(!1),m(void 0)},open:U,children:U&&T&&(0,E.jsx)(R.Z,t()({ref:A},T))})]})});N.Z=I},80821:function(me,N,e){e.d(N,{Z:function(){return re}});var $=e(97857),t=e.n($),z=e(5574),_=e.n(z),x=e(24963),Y=e(86738),u=e(83062),M=e(28036),d=e(67294),R=e(85893);function re(s){var b=(0,d.useState)(!1),h=_()(b,2),v=h[0],w=h[1],E=(0,d.useContext)(x.Z),I=E.lang,p=E.message,c=function(){w(!0);var r=s.action();r instanceof Promise?r.then(function(g){if(w(!1),g){typeof s.onSuccess=="function"&&s.onSuccess(g);var U="";s.messageSuccess?typeof s.messageSuccess=="function"?U=s.messageSuccess(g):U=s.messageSuccess.indexOf("notification.")==0?I(s.messageSuccess):s.messageSuccess:U=I("notification.finish"),s.asynced?p.info(U):p.success(U)}}).catch(function(g){w(!1),typeof s.onError=="function"&&s.onError(g)}):w(!1)};return s.confirm?(0,R.jsx)(Y.Z,t()(t()({style:{width:500},title:s.confirmTitle?s.confirmTitle:I("notification.title.tip"),description:typeof s.confirm=="string"&&s.confirm.indexOf("notification.")==0?I(s.confirm):s.confirm,onConfirm:c,okText:"Yes",cancelText:"No",onOpenChange:s.confirmOnOpenChange},s.confirmProps),{},{children:(0,R.jsx)(u.Z,{title:s.tips,children:(0,R.jsx)(M.ZP,{block:s.block,disabled:s.disabled,icon:!s.children&&v?void 0:s.icon,loading:v,danger:s.danger,type:s.type,children:s.children})})})):(0,R.jsx)(u.Z,{title:s.tips,children:(0,R.jsx)(M.ZP,{block:s.block,style:s.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:s.disabled,icon:!s.children&&v?void 0:s.icon,loading:v,onClick:c,danger:s.danger,type:s.type,children:s.children})})}},90581:function(me,N,e){e.d(N,{Z:function(){return U}});var $=e(15009),t=e.n($),z=e(99289),_=e.n(z),x=e(5574),Y=e.n(x),u=e(3616),M=e(97269),d=e(38345),R=e(64317),re=e(37476),s=e(62370),b=e(97462),h=e(95089),v=e(42075),w=e(28036),E=e(83062),I=e(67294),p=e(58638),c=e(82346),J=e(69938),r=e(36146),g=e(85893);function U(L){var ae=(0,I.useState)(!1),W=Y()(ae,2),T=W[0],m=W[1],A=(0,I.useRef)(),F=new r.Uo("components.console");return(0,g.jsx)(M.A,{layout:"inline",submitter:!1,children:(0,g.jsx)(d.Z,{ghost:!0,children:(0,g.jsxs)(v.Z,{children:[(0,g.jsx)(R.Z,{label:" ",width:"sm",name:"entryCmd",placeholder:F.format("toolbarEntryCmdEmpty"),valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(i){L.onChangeShell&&L.onChangeShell(i)}}),(0,g.jsx)(re.Y,{modalProps:{width:u.ob,height:u.Ed},title:F.format("toolbarBatchCommandTitle"),name:"batchCommand",open:T,trigger:(0,g.jsx)(w.ZP,{children:F.format("toolbarBatchCommandTitle")}),formKey:"batchCommand",formRef:A,isKeyPressSubmit:!0,onFinish:function(){var o=_()(t()().mark(function i(a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:L.onBatchCommandFinish&&L.onBatchCommandFinish(a.shell.split(`
`)),m(!1);case 2:case"end":return n.stop()}},i)}));return function(i){return o.apply(this,arguments)}}(),onOpenChange:function(i){m(i),i&&A.current&&A.current.resetFields()},children:(0,g.jsx)(s.Z,{name:"shell",children:(0,g.jsx)(h.ZP,{theme:"dark",height:u.Ed})})}),(0,g.jsx)(b.Z,{name:["entryCmd"],children:function(i){var a=i.entryCmd;return(!a||a=="")&&(a="/bin/sh"),L.onOpenNewWindow&&(0,g.jsx)(c.Link,{onClick:function(){L.onOpenNewWindowFinish&&L.onOpenNewWindowFinish()},target:"_blank",to:L.onOpenNewWindow({cmd:a}),children:(0,g.jsx)(E.Z,{title:F.format("toolbarOpenInNewWindowTip"),children:(0,g.jsx)(w.ZP,{type:"dashed",icon:(0,g.jsx)(p.Z,{})})})})}}),(0,g.jsx)(J.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})}},49610:function(me,N,e){var $=e(5574),t=e.n($),z=e(67294),_=e(52626),x=e(78267),Y=e.n(x),u=e(12323),M=e(87662),d=e(4244),R=e.n(d),re=e(24078),s=e(85893),b,h,v,w,E=(0,z.forwardRef)(function(I,p){var c,J=(0,z.useState)(),r=t()(J,2),g=r[0],U=r[1],L=(0,z.useState)(""),ae=t()(L,2),W=ae[0],T=ae[1];(0,z.useImperativeHandle)(p,function(){return{start:function(F,o){m(),h.fit(),o.width=b.cols,o.height=b.rows;var i=o?Object.keys(o).filter(function(a){return o&&o[a]}).map(function(a){if(o&&o[a])return"".concat(a,"=").concat(o[a])}):[];v=new WebSocket((0,_.R)(F+"?"+i.join("&"))),v.addEventListener("message",function(a){var j=JSON.parse(a.data),n=j.type;if(n==F&&(b.write(j.data),j.data.indexOf("exec failed")!=-1)){m();return}}),w=b.onData(function(a){var j={content:{command:a},type:F};v&&v.send(JSON.stringify(j))}),T(F),U(o)},close:function(){m()},fit:function(){return h.fit(),{width:b.cols,height:b.rows}},run:function(F){g&&F&&F.forEach(function(o){var i={content:{command:o+`
`},type:W};v&&v.send(JSON.stringify(i))})}}}),(0,z.useEffect)(function(){return b=new d.Terminal(u.X),h=new x.FitAddon,b.loadAddon(h),b.open(document.getElementById("terminal-container-console")),h.fit(),(0,M.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(A){A.data&&A.data.fontSize&&Object.assign(b.options,A.data)}),function(){m()}},[]),(0,z.useEffect)(function(){window.addEventListener("resize",function(){h.fit();var A={size:{width:b.cols,height:b.rows},type:W};W&&v&&v.send(JSON.stringify(A))})},[W]);function m(){w&&(b.reset(),h.fit(),b.focus(),w.dispose()),v&&(v.close(),v=null)}return(0,s.jsx)("div",{style:{height:(c=I.height)!==null&&c!==void 0?c:"100vh"},id:"terminal-container-console"})});N.Z=E},81366:function(me,N,e){var $=e(97857),t=e.n($),z=e(19632),_=e.n(z),x=e(5574),Y=e.n(x),u=e(27254),M=e(42075),d=e(85418),R=e(25593),re=e(28036),s=e(67294),b=e(31112),h=e(85893),v={title:"ROOT",path:"/"},w=(0,s.forwardRef)(function(E,I){var p=(0,s.useContext)(b.Z),c=p.showPath,J=p.redirectPath,r=(0,s.useState)([v]),g=Y()(r,2),U=g[0],L=g[1];(0,s.useImperativeHandle)(I,function(){return{addHistory:function(T,m){m=="/"?L([v]):L([].concat(_()(U),[{title:T,path:m}]))},initHistory:function(T,m){L([t()(t()({},v),{},{children:m})].concat(_()(T)))}}});var ae=function(T){c?c(U[T].title,U[T].path):E.showPath&&E.showPath(U[T].title,U[T].path);var m=U.filter(function(A,F){return F<=T});L(_()(m))};return(0,h.jsxs)(M.Z,{children:[(0,h.jsx)(M.Z.Compact,{children:U.map(function(W,T){return W.children?(0,h.jsxs)(d.Z.Button,{menu:{items:W.children.map(function(m,A){return{key:A,label:(0,h.jsx)(R.Z.Link,{onClick:function(){J(m)},children:m},A)}})},type:"dashed",onClick:function(A){ae(T)},children:[(0,h.jsx)(u.Z,{})," ",W.title]},T):(0,h.jsx)(re.ZP,{icon:(0,h.jsx)(u.Z,{}),type:"dashed",onClick:function(){ae(T)},children:W.title},T)})}),U.length>=2&&(0,h.jsx)(R.Z.Text,{copyable:{text:U[U.length-1].path}})]})});N.Z=w},31112:function(me,N,e){var $=e(67294),t=(0,$.createContext)({});N.Z=t},57221:function(me,N,e){e.d(N,{Z:function(){return Ie}});var $=e(15009),t=e.n($),z=e(99289),_=e.n(z),x=e(5574),Y=e.n(x),u=e(67294),M=e(28031),d=e(78099),R=e(31112),re=e(51042),s=e(48689),b=e(42075),h=e(28036),v=e(80821),w=e(88484),E=e(37476),I=e(91604),p=e(97961),c=e(3616),J=e(36146),r=e(85893);function g(){var P=(0,u.useRef)(),H=(0,u.useContext)(R.Z),se=H.refresh,K=H.name,V=H.apiPrefix,_e=H.currentPath,ie=new J.Uo("components.explorer");return(0,r.jsx)(E.Y,{modalProps:{width:c.ob},formRef:P,trigger:(0,r.jsx)(h.ZP,{icon:(0,r.jsx)(w.Z,{}),children:ie.format("toolbarUploadButton")}),title:ie.format("toolbarUploadModalTitle"),onFinish:function(){var G=_()(t()().mark(function Q(ne){var ce,q;return t()().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return q=[],ne.importFileList&&ne.importFileList.map(function(Oe){q.push({name:Oe.name,path:Oe.response.data.path})}),(0,M.ZU)(V,{fileList:q,name:K,destPath:_e}),(ce=P.current)===null||ce===void 0||ce.resetFields(),se(),de.abrupt("return",!0);case 6:case"end":return de.stop()}},Q)}));return function(Q){return G.apply(this,arguments)}}(),children:(0,r.jsx)(I.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(Q){return new Promise(function(ne){var ce;(0,p._2)({path:(ce=Q.response.data.path)!==null&&ce!==void 0?ce:""}).then(function(q){ne(!0)})})}}})})}var U=e(23430),L=e(93162),ae=e(24963);function W(P){var H=(0,u.useContext)(R.Z),se=H.name,K=H.apiPrefix,V=(0,u.useContext)(ae.Z),_e=V.message,ie=new J.Uo("components.explorer");return(0,r.jsx)(v.Z,{action:function(){return!P.selectFileList||P.selectFileList.length==0?(_e.info(ie.format("commonMessageNoSelect")),!1):(0,M.xK)(K,{name:se,fileList:P.selectFileList})},onSuccess:function(Q){var ne=new Blob([Q],{type:"application/zip"});(0,L.saveAs)(ne,"export.zip")},icon:(0,r.jsx)(U.Z,{}),children:ie.format("toolbarExportButton")})}var T=e(38345),m=e(63434),A=e(24739),F=e(5966);function o(P){var H=(0,u.useContext)(ae.Z),se=H.notice,K=(0,u.useRef)(),V=(0,u.useContext)(R.Z),_e=V.refresh,ie=V.name,G=V.apiPrefix,Q=(0,u.useState)(!1),ne=Y()(Q,2),ce=ne[0],q=ne[1],f=new J.Uo("components.explorer"),de=function(D){var C=D.split(""),O=0,Z=0,te=0;return C[1]=="r"&&(O+=4),C[2]=="w"&&(O+=2),C[3]=="x"&&(O+=1),C[4]=="r"&&(Z+=4),C[5]=="w"&&(Z+=2),C[6]=="x"&&(Z+=1),C[7]=="r"&&(te+=4),C[8]=="w"&&(te+=2),C[9]=="x"&&(te+=1),"".concat(O).concat(Z).concat(te)},Oe=function(D){var C;if((C=K.current)===null||C===void 0||C.setFieldValue("permission",D),D.length>=1){var O;(O=K.current)===null||O===void 0||O.setFieldsValue({ownerRead:Number(D[0])&4,ownerWrite:Number(D[0])&2,ownerExec:Number(D[0])&1})}if(D.length>=2){var Z;(Z=K.current)===null||Z===void 0||Z.setFieldsValue({groupRead:Number(D[1])&4,groupWrite:Number(D[1])&2,groupExec:Number(D[1])&1})}if(D.length>=3){var te;(te=K.current)===null||te===void 0||te.setFieldsValue({everyoneRead:Number(D[2])&4,everyoneWrite:Number(D[2])&2,everyoneExec:Number(D[2])&1})}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.ZP,{onClick:_()(t()().mark(function fe(){var D;return t()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(!(!P.selectFileObject||P.selectFileObject.length==0)){O.next=7;break}return(D=K.current)===null||D===void 0||D.resetFields(),se.error(f.format("commonMessageNoSelect")),q(!1),O.abrupt("return",!1);case 7:q(!0);case 8:case"end":return O.stop()}},fe)})),children:f.format("toolbarPermissionButton")}),(0,r.jsxs)(E.Y,{modalProps:{forceRender:!0,width:c.ob},title:f.format("toolbarPermissionModalTitle"),layout:"horizontal",open:ce,onOpenChange:function(D){q(D),P.selectFileObject.length==1&&Oe(de(P.selectFileObject[0].modStr))},formRef:K,onValuesChange:function(D,C){if(D.permission)Oe(D.permission);else{var O=["-",C.ownerRead?"r":"-",C.ownerWrite?"w":"-",C.ownerExec?"x":"-",C.groupRead?"r":"-",C.groupWrite?"w":"-",C.groupExec?"x":"-",C.everyoneRead?"r":"-",C.everyoneWrite?"w":"-",C.everyoneExec?"x":"-"];Oe(de(O.join("")))}},onFinish:function(){var fe=_()(t()().mark(function D(C){var O,Z,te,S;return t()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return te=[],P.selectFileObject.map(function(y){te.push(y.path)}),B.next=4,(0,M.OQ)(G,{name:ie,fileList:te,mod:(O=C.permission)!==null&&O!==void 0?O:"600",hasChildren:(Z=C.hasChildren)!==null&&Z!==void 0?Z:!0,user:C.user});case 4:return S=B.sent,_e(),B.abrupt("return",!0);case 7:case"end":return B.stop()}},D)}));return function(D){return fe.apply(this,arguments)}}(),children:[(0,r.jsxs)(T.Z,{direction:"row",gutter:[20,10],children:[(0,r.jsxs)(T.Z,{bordered:!0,title:f.format("toolbarPermissionOwner"),headerBordered:!0,children:[(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionRead"),name:"ownerRead"}),(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionWrite"),name:"ownerWrite"}),(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionExec"),name:"ownerExec"})]}),(0,r.jsxs)(T.Z,{bordered:!0,title:f.format("toolbarPermissionGroup"),headerBordered:!0,children:[(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionRead"),name:"groupRead"}),(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionWrite"),name:"groupWrite"}),(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionExec"),name:"groupExec"})]}),(0,r.jsxs)(T.Z,{bordered:!0,title:f.format("toolbarPermissionEveryone"),headerBordered:!0,children:[(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionRead"),name:"everyoneRead"}),(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionWrite"),name:"everyoneWrite"}),(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionExec"),name:"everyoneExec"})]})]}),(0,r.jsx)(T.Z,{children:(0,r.jsxs)(A.UW,{children:[(0,r.jsx)(F.Z,{label:f.format("toolbarPermissionButton"),name:"permission",fieldProps:{maxLength:3},width:"xs"}),(0,r.jsxs)(b.Z.Compact,{children:[(0,r.jsx)(F.Z,{width:"sm",placeholder:f.format("toolbarPermissionOwnerEmpty"),label:f.format("toolbarPermissionOwner"),name:"user",fieldProps:{addonAfter:":"}}),(0,r.jsx)(F.Z,{width:"sm",placeholder:f.format("toolbarPermissionGroupEmpty"),name:"group"})]}),(0,r.jsx)(m.Z,{label:f.format("toolbarPermissionHasChildren"),name:"hasChildren",initialValue:!0})]})})]})]})}var i=e(27461);function a(P){var H=(0,u.useContext)(R.Z),se=H.currentPath,K=H.refresh,V=H.name,_e=H.apiPrefix,ie=(0,u.useContext)(ae.Z),G=ie.notice,Q=new J.Uo("components.explorer");return(0,r.jsx)(v.Z,{icon:(0,r.jsx)(i.Z,{}),action:_()(t()().mark(function ne(){return t()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(P.selectFileObject.length!=0){q.next=3;break}return G.error(Q.format(["commonMessageNoSelect","toolbarUnzipMessageAllowFileExt"])),q.abrupt("return",!1);case 3:return q.abrupt("return",(0,M.gb)(_e,{name:V,file:P.selectFileObject.map(function(f){return f.path}),path:se}));case 4:case"end":return q.stop()}},ne)})),onSuccess:function(){K()},children:Q.format("toolbarUnzipButton")})}function j(P){var H=useContext(FileExplorerContext),se=H.name,K=H.apiPrefix,V=useContext(AppContext),_e=V.message,ie=useRef(),G=new Lang("components.explorer");return _jsx(RequestButton,{confirm:_jsx(Space,{children:_jsx(ProForm,{layout:"inline",submitter:!1,formRef:ie,children:_jsx(ProFormText,{width:"md",label:G.format("toolbarExportHostHostPath"),name:"hostPath"})})}),action:function(){var ne;return!P.selectFileList||P.selectFileList.length==0?(_e.info(G.format("commonMessageNoSelect")),!1):exportFileList(K,{name:se,hostPath:(ne=ie.current)===null||ne===void 0?void 0:ne.getFieldValue("hostPath"),enableExportHost:!0,fileList:P.selectFileList})},icon:_jsx(ExportOutlined,{}),children:G.format("toolbarExportHostButton")})}function n(P){var H=(0,u.useContext)(R.Z),se=H.refresh,K=H.name,V=H.apiPrefix,_e=H.currentPath,ie=H.newFile,G=new J.Uo("components.explorer");return(0,r.jsxs)(b.Z,{size:16,wrap:!0,children:[(0,r.jsx)(W,{selectFileList:P.selectFileList}),!1,(0,r.jsx)(g,{}),(0,r.jsx)(o,{selectFileObject:P.selectFileObject}),(0,r.jsx)(a,{selectFileObject:P.selectFileObject}),(0,r.jsx)(h.ZP,{icon:(0,r.jsx)(re.Z,{}),onClick:function(){ie()},type:"primary",children:G.format("toolbarNewButton")}),(0,r.jsx)(v.Z,{danger:!0,type:"default",icon:(0,r.jsx)(s.Z,{}),action:function(){return(0,M.Yx)(V,{name:K,fileList:P.selectFileList})},onSuccess:function(){se()},confirm:"notification.confirm.title",children:G.format("toolbarDeleteButton")})]})}var k=e(81366),pe=e(97269),ve=e(86615),Re=e(97462),Ce=e(62370),Te=e(85576),ye=e(95089),be=e(5251),Ee=new J.Uo("components.explorer"),We=(0,u.forwardRef)(function(P,H){var se,K,V=(0,u.useContext)(ae.Z),_e=V.message,ie=V.notice,G=(0,u.useContext)(R.Z),Q=G.currentPath,ne=G.refresh,ce=G.name,q=G.apiPrefix,f=(0,u.useRef)(),de=(0,u.useState)(!1),Oe=Y()(de,2),fe=Oe[0],D=Oe[1];return(0,u.useImperativeHandle)(H,function(){return{newFile:function(){var O,Z;D(!0),(O=f.current)===null||O===void 0||O.resetFields(),(Z=f.current)===null||Z===void 0||Z.setFieldValue("type","newFile")},editFile:function(O,Z,te){return _()(t()().mark(function S(){var he,B,y,l,X;return t()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return(he=f.current)===null||he===void 0||he.resetFields(),_e.loading(Ee.format("editFileMessageLoading")),ee.next=4,(0,M.LK)(q,{name:ce,file:Z}).finally(function(){_e.destroy()});case 4:if(X=ee.sent,!(X.data.content==""&&te!="0")){ee.next=9;break}return _e.error(Ee.format("editFileMessageNotSupport")),D(!1),ee.abrupt("return");case 9:return(B=f.current)===null||B===void 0||B.setFieldValue("newValue",X.data.content),(y=f.current)===null||y===void 0||y.setFieldValue("newName",O),(l=f.current)===null||l===void 0||l.setFieldValue("type","editFile"),D(!0),ee.abrupt("return");case 14:case"end":return ee.stop()}},S)}))()}}}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(Te.Z,{width:c.ob,open:fe,onCancel:function(){var O;D(!1),(O=f.current)===null||O===void 0||O.resetFields()},footer:!1,forceRender:!0,children:(0,r.jsxs)(pe.A,{formRef:f,onFinish:function(){var C=_()(t()().mark(function O(Z){return t()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(Z.type!="newDir"){S.next=13;break}return S.prev=1,S.next=4,(0,M.i$)(q,{name:ce,destPath:"".concat(Q,"/").concat((0,be.fi)(Z.newPath,"/"))});case 4:return ne(),D(!1),S.abrupt("return",!0);case 9:S.prev=9,S.t0=S.catch(1);case 11:S.next=23;break;case 13:return S.prev=13,S.next=16,(0,M.C4)(q,{destPath:Q,file:Z.newName,content:Z.newValue,name:ce});case 16:return ne(),D(!1),S.abrupt("return",!0);case 21:S.prev=21,S.t1=S.catch(13);case 23:return S.abrupt("return",!1);case 24:case"end":return S.stop()}},O,null,[[1,9],[13,21]])}));return function(O){return C.apply(this,arguments)}}(),children:[(0,r.jsx)(ve.Z.Group,{name:"type",options:[{label:Ee.format("editFileTypeEditFile"),value:"editFile",disabled:((se=f.current)===null||se===void 0?void 0:se.getFieldValue("type"))!="editFile"},{label:Ee.format("editFileTypeNewFile"),value:"newFile"},{label:Ee.format("editFileTypeNewDir"),value:"newDir"}],disabled:((K=f.current)===null||K===void 0?void 0:K.getFieldValue("type"))=="editFile"}),(0,r.jsx)(Re.Z,{name:["type"],children:function(O){var Z=O.type;return Z!="newDir"?[(0,r.jsx)(F.Z,{label:Ee.format("editFileNewName"),tooltip:Ee.format("editFileNewNameTip"),name:"newName",fieldProps:{addonBefore:"".concat(Q,"/")},placeholder:Ee.format("editFileNewNameEmpty"),disabled:Z=="editFile"},"fileName"),(0,r.jsx)(Ce.Z,{label:Ee.format("editFileNewValue"),name:"newValue",children:(0,r.jsx)(ye.ZP,{theme:"dark",height:c.Ed,onChange:function(S){var he;(he=f.current)===null||he===void 0||he.setFieldValue("newValue",S)}})},"fileContent")]:(0,r.jsx)(F.Z,{name:"newPath",label:Ee.format("editFileNewPath"),placeholder:Ee.format("editFileNewPathEmpty")})}})]})})})}),Ue=We,Le=e(99922),xe=e(68536),Fe=e(83062),Be=e(66309),Ae=e(82346),Ke=null,Pe=new J.Uo("components.explorer"),we=(0,u.forwardRef)(function(P,H){(0,u.useImperativeHandle)(H,function(){return{close:function(){de([]),Q("")}}});var se=(0,u.useRef)(),K=(0,u.useRef)(),V=(0,u.useRef)(),_e=(0,u.useState)(""),ie=Y()(_e,2),G=ie[0],Q=ie[1],ne=(0,u.useRef)(),ce=(0,Ae.useSearchParams)(),q=Y()(ce,2),f=q[0],de=q[1],Oe=(0,u.useState)(),fe=Y()(Oe,2),D=fe[0],C=fe[1],O=(0,u.useContext)(ae.Z),Z=O.message,te=P.type=="host"?"common":"app";(0,u.useEffect)(function(){var B;Z.info(Pe.format("commonMessageCreateExplorerPlugin")),Q((B=P.workDir)!==null&&B!==void 0?B:"")},[]);function S(B,y){return he.apply(this,arguments)}function he(){return he=_()(t()().mark(function B(y,l){var X,le,ee;return t()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:(X=se.current)===null||X===void 0||X.addHistory(y,l),Q(l),V.current&&(le=V.current)!==null&&le!==void 0&&le.reloadAndRest&&((ee=V.current)===null||ee===void 0||ee.reloadAndRest()),l=="/"?de([]):(f.set("path",l),de(f));case 4:case"end":return ue.stop()}},B)})),he.apply(this,arguments)}return P&&(0,r.jsxs)(R.Z.Provider,{value:{apiPrefix:te,name:P.name,currentPath:G,showPath:S,redirectPath:function(y){var l;if(Q(y),V.current&&(l=V.current)!==null&&l!==void 0&&l.reloadAndRest){var X;(X=V.current)===null||X===void 0||X.reloadAndRest()}y=="/"?de([]):(f.set("path",y),de(f))},refresh:function(){var y;if(V&&typeof((y=V.current)===null||y===void 0?void 0:y.reloadAndRest)=="function"){var l;(l=V.current)===null||l===void 0||l.reloadAndRest()}},editFile:function(y,l,X){K.current&&K.current.editFile(y,l,X)},newFile:function(){K.current&&K.current.newFile()}},children:[(0,r.jsx)(d.Z,{scroll:{x:"max-content"},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},toolBarRender:function(){var y=[];return P.onConsole&&y.push((0,r.jsx)(h.ZP,{type:"dashed",onClick:function(){P.onConsole&&P.onConsole(G)},children:"Console"},"fileConsole")),[].concat(y)},tableAlertOptionRender:function(y){var l=y.selectedRowKeys,X=y.selectedRows,le=[];return X.map(function(ee){le.push(ee.path)}),[(0,r.jsx)(n,{selectFileList:le,selectFileObject:X,enableExportHost:P.type=="container"},"1")]},headerTitle:(0,r.jsx)(k.Z,{ref:se}),actionRef:V,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:_()(t()().mark(function B(){var y,l,X,le,ee;return t()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,(0,M.Wy)(te,{name:P.name,path:G});case 2:if(l=ue.sent,G==""&&l.data.currentPath!=""&&Q(l.data.currentPath),X=[],(y=se.current)===null||y===void 0||y.initHistory(l.data.currentPath.split("/").filter(function(oe){return oe!=""}).map(function(oe){return X.push(oe),{title:oe,path:"/".concat(X.join("/"))}}),l.data.rootDirs),le=D,le){ue.next=13;break}return ue.next=10,(0,M.lE)(te,{name:P.name});case 10:ee=ue.sent,C(ee.data),le=ee.data;case 13:return ue.abrupt("return",{data:l.data.list.map(function(oe){if(le){var je,Me;oe.group=(je=(Me=le.group.find(function(De){return De.gid==oe.group}))===null||Me===void 0?void 0:Me.name)!==null&&je!==void 0?je:oe.group}return oe}),success:!0,total:l.data.list.length});case 14:case"end":return ue.stop()}},B)})),columns:[{title:Pe.format("listName"),dataIndex:"name",key:"name",render:function(ge,l,X,le,ee){var ge;return l.isDir?ge=(0,r.jsx)(xe.Z,{isDir:!0,onClick:function(){return S(l.name,l.path)},showName:l.name}):l.isSymlink?ge=(0,r.jsx)(xe.Z,{isLink:!0,showName:"".concat(l.name," -> ").concat(l.linkName),onClick:_()(t()().mark(function ue(){var oe,je;return t()().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return De.next=2,(0,M.mR)(te,{name:P.name,path:l.path});case 2:oe=De.sent,oe.data.info.isDir?S(l.name,oe.data.info.target):(je=K.current)===null||je===void 0||je.editFile(oe.data.info.name,oe.data.info.target,l.size);case 4:case"end":return De.stop()}},ue)}))}):ge=(0,r.jsx)(xe.Z,{showName:l.name,onClick:function(){var oe;(oe=K.current)===null||oe===void 0||oe.editFile(l.name,l.path,l.size)}}),ge}},{title:Pe.format("listStatus"),key:"status",width:110,render:function(y,l,X,le,ee){return l.change>-1&&(0,r.jsx)(Fe.Z,{title:Pe.format("listStatus.".concat(l.change,".tip")),children:(0,r.jsx)(Be.Z,{color:Pe.format("listStatus.".concat(l.change,".color")),children:Pe.format("listStatus.".concat(l.change,".title"))})})}},{title:Pe.format("listModStr"),dataIndex:"modStr",key:"mod"},{title:Pe.format("listUser"),dataIndex:"user"},{title:Pe.format("listGroup"),dataIndex:"group"},{title:Pe.format("listSize"),dataIndex:"size",key:"size",render:function(y,l,X,le,ee){return(0,be.FI)(l.size)}},{title:Pe.format("listModTime"),dataIndex:"modTime",key:"modTime",sorter:function(y,l){return new Date(y.modTime).getTime()-new Date(l.modTime).getTime()},render:function(y,l,X,le,ee){return(0,be.NF)(l.modTime)}}],cardProps:{ghost:!0}}),(0,r.jsx)(Ue,{ref:K}),(0,r.jsx)(Le.Z,{ref:ne})]})}),Ie=we},68536:function(me,N,e){e.d(N,{Z:function(){return re}});var $=e(24963),t=e(36146),z=e(93613),_=e(36693),x=e(2741),Y=e(25593),u=e(42075),M=e(67294),d=e(85893),R=0;function re(s){var b=(0,M.useContext)($.Z),h=b.message,v=new t.Uo("components.explorer");return s.isDir?(0,d.jsx)(Y.Z.Link,{onClick:function(){s.onClick&&s.onClick()},children:(0,d.jsxs)(u.Z,{children:[(0,d.jsx)(z.Z,{}),s.showName]})}):s.isLink?(0,d.jsx)(Y.Z.Link,{onClick:function(){s.onClick&&s.onClick()},children:(0,d.jsxs)(u.Z,{children:[(0,d.jsx)(_.Z,{}),s.showName]})}):(0,d.jsx)(Y.Z.Text,{onClick:function(){if(R++,R==2){R=0,s.onClick&&s.onClick();return}setTimeout(function(){R==1&&h.info(v.format("fileNameMessageViewDetail")),R=0},400)},style:{cursor:"pointer"},children:(0,d.jsxs)(u.Z,{children:[(0,d.jsx)(x.Z,{}),s.showName]})})}},3616:function(me,N,e){e.d(N,{Ed:function(){return _},FK:function(){return t},R_:function(){return $},ob:function(){return z}});var $=window.innerWidth<=1024?"90vw":"65vw",t="90vw",z="60vw",_="50vh"},12323:function(me,N,e){e.d(N,{X:function(){return $},n:function(){return t}});var $={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},t=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},24963:function(me,N,e){var $=e(67294),t=(0,$.createContext)({});N.Z=t},28031:function(me,N,e){e.d(N,{Ak:function(){return A},C4:function(){return c},LK:function(){return I},OQ:function(){return U},Wy:function(){return Y},Yx:function(){return h},ZU:function(){return s},gb:function(){return w},i$:function(){return r},lE:function(){return ae},mR:function(){return T},xK:function(){return M}});var $=e(15009),t=e.n($),z=e(99289),_=e.n(z),x=e(82346);function Y(o,i){return u.apply(this,arguments)}function u(){return u=_()(t()().mark(function o(i,a){var j;return t()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return j="/api/".concat(i,"/explorer/get-path-list"),k.next=3,(0,x.request)(j,{data:a,method:"POST"});case 3:return k.abrupt("return",k.sent);case 4:case"end":return k.stop()}},o)})),u.apply(this,arguments)}function M(o,i){return d.apply(this,arguments)}function d(){return d=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/export"),{data:a,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),d.apply(this,arguments)}function R(o,i){return re.apply(this,arguments)}function re(){return re=_asyncToGenerator(_regeneratorRuntime().mark(function o(i,a){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a.enableExportHost=!0,n.next=3,request("/api/".concat(i,"/explorer/export"),{data:a,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),re.apply(this,arguments)}function s(o,i){return b.apply(this,arguments)}function b(){return b=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/import"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),b.apply(this,arguments)}function h(o,i){return v.apply(this,arguments)}function v(){return v=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/delete"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),v.apply(this,arguments)}function w(o,i){return E.apply(this,arguments)}function E(){return E=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/unzip"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),E.apply(this,arguments)}function I(o,i){return p.apply(this,arguments)}function p(){return p=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/get-content"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),p.apply(this,arguments)}function c(o,i){return J.apply(this,arguments)}function J(){return J=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/import-file-content"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),J.apply(this,arguments)}function r(o,i){return g.apply(this,arguments)}function g(){return g=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/mkdir"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),g.apply(this,arguments)}function U(o,i){return L.apply(this,arguments)}function L(){return L=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/chmod"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),L.apply(this,arguments)}function ae(o,i){return W.apply(this,arguments)}function W(){return W=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/get-user-list"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),W.apply(this,arguments)}function T(o,i){return m.apply(this,arguments)}function m(){return m=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/get-file-stat"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),m.apply(this,arguments)}function A(o,i){return F.apply(this,arguments)}function F(){return F=_()(t()().mark(function o(i,a){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(i,"/explorer/attach-volume"),{data:a,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},o)})),F.apply(this,arguments)}},97961:function(me,N,e){e.d(N,{GH:function(){return re},_2:function(){return b},fN:function(){return u},ii:function(){return Y},vC:function(){return d}});var $=e(15009),t=e.n($),z=e(99289),_=e.n(z),x=e(82346),Y=[{name:"amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"i386",arch:"386",search:[]},{name:"arm/v6",arch:"arm",search:[]},{name:"arm/v7",arch:"arm",search:[]},{name:"arm/v8",arch:"arm64",search:[]},{name:"ppc64le",arch:"ppc64le",search:[]},{name:"riscv64",arch:"riscv64",search:[]}];function u(E){return M.apply(this,arguments)}function M(){return M=_()(t()().mark(function E(I){return t()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,x.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:I}));case 1:case"end":return c.stop()}},E)})),M.apply(this,arguments)}function d(E){return R.apply(this,arguments)}function R(){return R=_()(t()().mark(function E(I){return t()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,x.request)("/api/app/image/import-by-container-tar",{method:"POST",data:I}));case 1:case"end":return c.stop()}},E)})),R.apply(this,arguments)}function re(E){return s.apply(this,arguments)}function s(){return s=_()(t()().mark(function E(I){return t()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,x.request)("/api/app/image/import-by-image-tar",{method:"POST",data:I}));case 1:case"end":return c.stop()}},E)})),s.apply(this,arguments)}function b(E){return h.apply(this,arguments)}function h(){return h=_()(t()().mark(function E(I){return t()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,x.request)("/api/common/attach/delete",{method:"POST",data:I});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},E)})),h.apply(this,arguments)}function v(){return w.apply(this,arguments)}function w(){return w=_asyncToGenerator(_regeneratorRuntime().mark(function E(){return _regeneratorRuntime().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",request("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return p.stop()}},E)})),w.apply(this,arguments)}}}]);
