"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1058],{91058:function($,M,n){var g=n(9783),_=n.n(g),T=n(19632),m=n.n(T),s=n(97857),i=n.n(s),w=n(5574),C=n.n(w),b=n(89035),f=n(64317),W=n(5966),S=n(38345),R=n(17186),d=n(24739),z=n(42075),p=n(83622),V=n(85576),E=n(67294),k=n(11106),h=n(12491),B=n(62597),P=n(79245),N=n(3616),j=n(36146),r=n(85893),o="docker-image",D=(0,E.forwardRef)(function(e,Q){var x=(0,E.useState)(o),K=C()(x,2),H=K[0],L=K[1],v=(0,E.useRef)(),J=(0,E.useState)(""),G=C()(J,2),X=G[0],Y=G[1],A=new j.Uo("components.appForm");(0,E.useImperativeHandle)(Q,function(){return{addEnvItem:function(a,l){var c,u=(c=v.current)===null||c===void 0?void 0:c.getList(),O=!1;if(u==null||u.map(function(I){if(I.name==a){O=!0;return}}),!O){var U;(U=v.current)===null||U===void 0||U.add({name:a,value:l})}},clear:function(){var a;(a=v.current)===null||a===void 0||(a=a.getList())===null||a===void 0||a.map(function(l,c){var u;(u=v.current)===null||u===void 0||u.remove(c)})}}});function ee(t){try{var a,l;t==""&&(t=ne());for(var c=(a=(l=v.current)===null||l===void 0||(l=l.getList())===null||l===void 0?void 0:l.length)!==null&&a!==void 0?a:0,u=c;u>=0;u--){var O;(O=v.current)===null||O===void 0||O.remove(u)}var U=t.split(`
`),I=0;U.map(function(F){var Z,y=F.split("=");y.length<2||((Z=v.current)===null||Z===void 0||Z.add({name:y[0],value:y.slice(1).join("=")},I),I++)})}catch(F){console.log(F)}}function re(){H!="code"?L("code"):L(o)}function ne(){if(v&&v.current&&v.current.getList){var t,a=(t=v.current)===null||t===void 0?void 0:t.getList();if(a){var l=[];return a.map(function(c){l.push("".concat(c.name,"=").concat(c.value))}),l.join(`
`)}else return""}else return""}function te(t){var a,l,c,u,O,U={},I={help:t&&t.label?t.label:"",name:"value",label:A.format("createEnvFormValue"),rules:[{required:e.requireValue?!0:(0,P.y)((a=t.rule)===null||a===void 0?void 0:a.kind,B.fp.EnvValueRuleRequired)}],disabled:e.showDisableValue||(0,P.y)((l=t.rule)===null||l===void 0?void 0:l.kind,B.fp.EnvValueRuleDisabled)};if((0,P.y)((c=t.rule)===null||c===void 0?void 0:c.kind,B.fp.EnvValueTypeSelect)){var F;return(0,r.jsx)(f.Z,i()(i()({fieldProps:U},I),{},{initialValue:t.value,width:e.showInDrawer?"sm":"md",options:((F=t.rule)===null||F===void 0?void 0:F.option)&&t.rule.option.map(function(y){return{label:y.name,value:y.value}})}))}else if((0,P.y)((u=t.rule)===null||u===void 0?void 0:u.kind,B.fp.EnvValueTypeSelectMultiple)){var Z;return(0,r.jsx)(f.Z,i()(i()({mode:"tags"},I),{},{fieldProps:U,convertValue:function(q){return Array.isArray(q)?q:q.split(",")},width:e.showInDrawer?"sm":"md",options:((Z=t.rule)===null||Z===void 0?void 0:Z.option)&&t.rule.option.map(function(y){return{label:y.name,value:y.value}})}))}else return(0,P.y)((O=t.rule)===null||O===void 0?void 0:O.kind,B.fp.EnvValueTypeNumber)?(0,r.jsx)(W.Z,i()(i()({fieldProps:U},I),{},{width:e.showInDrawer?"sm":"md",rules:[].concat(m()(I.rules),[{pattern:new RegExp("^[0-9]*$")}]),help:A.format("createEnvFormNumberTip",{name:I.help})})):(0,r.jsx)(W.Z,i()(i()({fieldProps:U},I),{},{width:e.showInDrawer?"sm":"md"}))}return(0,r.jsxs)(S.Z,{ghost:e.showCardGhost,title:e.label?e.label:null,headerBordered:!0,extra:(e.showCodeMode||e.showImportButton)&&(0,r.jsxs)(z.Z,{children:[e.showImportButton&&(0,r.jsx)("div",{style:{marginBottom:"-25px"},children:(0,r.jsx)(h.Z,{title:A.format("createEnvFormEnvImport"),onImport:function(a){return ee(a),!0},onLoad:function(a){if(a.indexOf("=")<0)throw new Error(j.FD.format("commonFileIncorrectFormat",{name:"env"}));return!0}})}),e.showCodeMode?(0,r.jsx)(p.ZP,{icon:(0,r.jsx)(b.Z,{}),type:H=="code"?"primary":"default",onClick:re,children:A.format("createEnvFormEnvCode")},"code"):""]}),children:[(0,r.jsx)(R.u,{name:e.name?e.name:"environment",actionRef:v,creatorButtonProps:e.showAddButton?{creatorButtonText:e.addButtonLabel?e.addButtonLabel:A.format("createEnvFormListAddButton")}:!1,copyIconProps:!1,deleteIconProps:e.showDeleteButton,min:100,label:e.listLabel,transform:function(a,l,c){return _()({},l,a.map(function(u){return Array.isArray(u.value)&&(u.value=u.value.filter(function(O){return O!=""}).join(",")),u}))},children:function(a,l,c){var u=c.getCurrentRowData();return(0,r.jsxs)(d.UW,{style:{marginBottom:"5px"},children:[(0,r.jsx)(W.Z,{width:e.showInDrawer?"sm":"md",name:"name",label:A.format("createEnvFormName"),required:!0,rules:[{required:!0}],disabled:e.showDisableName,placeholder:A.format("createEnvFormNameEmpty")}),te(u)]})}}),e.showCodeMode&&(0,r.jsx)(V.Z,{width:N.ob,open:H=="code",onCancel:function(){return L("docker-image")},onOk:function(){ee(X),L("docker-image")},children:(0,r.jsx)(k.ZP,{onChange:function(a){return Y(a)},value:ne(),height:N.Ed,theme:"dark"})})]})});M.Z=D},12491:function($,M,n){n.d(M,{Z:function(){return z}});var g=n(5574),_=n.n(g),T=n(3616),m=n(24963),s=n(36146),i=n(88484),w=n(57546),C=n(62370),b=n(11106),f=n(42075),W=n(83622),S=n(85576),R=n(67294),d=n(85893);function z(p){var V=(0,R.useContext)(m.Z),E=V.message,k=V.notice,h=(0,R.useRef)(null),B=(0,R.useState)(!1),P=_()(B,2),N=P[0],j=P[1],r=(0,R.useState)(""),o=_()(r,2),D=o[0],e=o[1],Q=function(){h.current&&(h.current.click(),h.current.onchange=function(K){if(!K||!K.target)return"";var H=new FileReader;H.onload=function(J){var G,X,Y=(G=J.target)===null||G===void 0?void 0:G.result;if(p.onLoad)try{p.onLoad&&p.onLoad(Y)}catch(A){k.error(A);return}e(Y),typeof p.onImport=="function"&&(E.success(s.FD.format("finish")),p.onImport(Y)),(X=h.current)!==null&&X!==void 0&&X.value&&(h.current.value="")};var L=K.target;if(L.files&&L.files[0]){var v=L.files[0];try{H.readAsText(v)}catch(J){k.error(s.FD.format("commonContentIncorrectFormat",{name:L.files[0].name}))}}})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(C.Z,{children:(0,d.jsxs)(f.Z.Compact,{block:!0,children:[(0,d.jsx)(W.ZP,{icon:(0,d.jsx)(i.Z,{}),block:!0,onClick:Q,children:p.title}),p.showPaset&&(0,d.jsx)(W.ZP,{icon:(0,d.jsx)(w.Z,{}),onClick:function(){j(!0)}})]})}),(0,d.jsx)("input",{style:{display:"none"},type:"file",ref:h,name:"importFileInput"}),(0,d.jsx)(S.Z,{width:T.ob,open:N,onClose:function(){j(!1)},onCancel:function(){j(!1)},onOk:function(){typeof p.onImport=="function"&&(E.success(s.FD.format("finish")),p.onImport(D)),j(!1)},children:(0,d.jsx)(b.ZP,{height:T.Ed,theme:"dark",value:D,onChange:function(K){e(K)}})})]})}},3616:function($,M,n){n.d(M,{Ed:function(){return m},FK:function(){return _},R_:function(){return g},ob:function(){return T}});var g=window.innerWidth<=1024?"90vw":"65vw",_="90vw",T="60vw",m="50vh"},24963:function($,M,n){var g=n(67294),_=(0,g.createContext)({});M.Z=_},62597:function($,M,n){n.d(M,{$G:function(){return C},Ct:function(){return k},Tb:function(){return R},XH:function(){return z},cl:function(){return W},fp:function(){return f},fu:function(){return w},iE:function(){return V},xb:function(){return B},ze:function(){return N}});var g=n(15009),_=n.n(g),T=n(99289),m=n.n(T),s=n(82346),i="com.dpanel.container.description",w="com.dpanel.container.title";function C(r){return b.apply(this,arguments)}function b(){return b=m()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/site/create-by-image",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),b.apply(this,arguments)}var f={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192};function W(r){return S.apply(this,arguments)}function S(){return S=m()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/site/get-list",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),S.apply(this,arguments)}function R(r){return d.apply(this,arguments)}function d(){return d=m()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.download=!1,e.next=3,(0,s.request)("/api/app/log/run",{method:"POST",data:o});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),d.apply(this,arguments)}function z(r){return p.apply(this,arguments)}function p(){return p=m()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.download=!0,e.next=3,(0,s.request)("/api/app/log/run",{method:"POST",data:o,responseType:"blob"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),p.apply(this,arguments)}function V(r){return E.apply(this,arguments)}function E(){return E=m()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.id=String(o.id),e.next=3,(0,s.request)("/api/app/site/get-detail",{data:o,method:"POST"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),E.apply(this,arguments)}function k(r){return h.apply(this,arguments)}function h(){return h=m()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/container/delete",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),h.apply(this,arguments)}function B(r){return P.apply(this,arguments)}function P(){return P=m()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/site/delete",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),P.apply(this,arguments)}function N(r){return j.apply(this,arguments)}function j(){return j=m()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/container/ignore",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),j.apply(this,arguments)}},79245:function($,M,n){n.d(M,{m:function(){return T},y:function(){return m}});var g=n(64599),_=n.n(g);function T(s){var i=[];if(!s||s=="")return i;var w=s.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),C=_()(w),b;try{for(C.s();!(b=C.n()).done;){var f=b.value;i.push({name:f[1],value:f[2]?f[2].indexOf("-")==0?f[2].substring(1):f[2]:""})}}catch(W){C.e(W)}finally{C.f()}return i}function m(s,i){return!s||!i?!1:(s&i)!==0}}}]);
