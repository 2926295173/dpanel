"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4214],{80821:function(z,T,e){e.d(T,{Z:function(){return W}});var U=e(5574),l=e.n(U),d=e(24963),o=e(86738),E=e(28036),p=e(83062),A=e(67294),C=e(85893);function W(r){var I=(0,A.useState)(!1),L=l()(I,2),B=L[0],x=L[1],j=(0,A.useContext)(d.Z),M=j.lang,D=j.notice,R=j.message,h=function(){x(!0);var m=r.action();m instanceof Promise?m.then(function(O){if(x(!1),O){typeof r.onSuccess=="function"&&r.onSuccess(O);var n="";r.messageSuccess?typeof r.messageSuccess=="function"?n=r.messageSuccess(O):n=r.messageSuccess.indexOf("notification.")==0?M(r.messageSuccess):r.messageSuccess:n=M("notification.finish"),r.asynced?R.info(n):R.success(n)}}).catch(function(O){x(!1),typeof r.onError=="function"&&r.onError(O)}):x(!1)};return r.confirm?(0,C.jsx)(o.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:M("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?M(r.confirm):r.confirm,onConfirm:h,okText:"Yes",cancelText:"No",children:(0,C.jsx)(E.ZP,{disabled:r.disabled,icon:r.icon,loading:B,danger:r.danger,type:r.type,children:r.children})}):(0,C.jsx)(p.Z,{title:r.tips,children:(0,C.jsx)(E.ZP,{style:r.ghost?{padding:0,height:"auto"}:{},disabled:r.disabled,icon:r.icon,loading:B,onClick:h,danger:r.danger,type:r.type,children:r.children})})}},92754:function(z,T,e){var U=e(5574),l=e.n(U),d=e(67294),o=e(82346),E=e(38703),p=e(85893),A=(0,d.forwardRef)(function(C,W){var r=(0,d.useState)(""),I=l()(r,2),L=I[0],B=I[1];(0,d.useImperativeHandle)(W,function(){return{setFinish:function(){R({finish:{downloading:100,extracting:100}})},setStart:function(u){u&&B(u),R({start:{downloading:0,extracting:0}})}}});var x=(0,o.useModel)("subscriber");x.addDataHandler("image:pull:"+L,function(h){R(h.data)});var j=(0,d.useState)(),M=l()(j,2),D=M[0],R=M[1];return(0,d.useEffect)(function(){R({start:{downloading:0,extracting:0}})},[]),(0,p.jsx)(p.Fragment,{children:D&&Object.keys(D).map(function(h){return(0,p.jsx)(E.Z,{percent:D[h].downloading,success:{percent:D[h].extracting}},h)})})});T.Z=A},88583:function(z,T,e){e.r(T),e.d(T,{default:function(){return ue}});var U=e(19632),l=e.n(U),d=e(15009),o=e.n(d),E=e(99289),p=e.n(E),A=e(5574),C=e.n(A),W=e(90078),r=e(10641),I=e(37476),L=e(62370),B=e(5966),x=e(31418),j=e(28036),M=e(25593),D=e(42075),R=e(66309),h=e(96074),u=e(83062),m=e(84567),O=e(50136),n=e(67294),F=e(82346),S=e(18148),w=e(5251),N=e(80821),k=e(43425),q=e(95556),ee=e(58638),ne=e(1912),te=e(28307),ae=e(96042),V=e(67255),re=e(24963),se=e(3393),Y=e(93162),fe=e.n(Y),a=e(85893);function ue(){var G=(0,n.useContext)(re.Z),_e=G.message,Ee=G.notice,le=G.lang,v=(0,n.useRef)(),ie=(0,n.useState)({force:!1}),H=C()(ie,2),oe=H[0],de=H[1],ge=x.Z.useApp(),ce=(0,n.useState)(1),J=C()(ce,2),Q=J[0],me=J[1],X=(0,n.useRef)();return(0,n.useEffect)(function(){var g;(g=v.current)===null||g===void 0||g.reload()},[Q]),(0,a.jsx)(W._z,{header:{extra:[(0,a.jsx)(F.Link,{to:"/image/create",children:(0,a.jsx)(j.ZP,{type:"primary",children:"\u521B\u5EFA&\u5BFC\u5165\u955C\u50CF"},"create")},"create"),(0,a.jsx)(te.Z,{onFinish:function(){var i,t;!((i=v.current)===null||i===void 0)&&i.reloadAndRest&&((t=v.current)===null||t===void 0||t.reloadAndRest())}},"remote")]},children:(0,a.jsx)(r.Z,{scroll:{x:"max-content"},rowKey:"Id",columns:[{title:"\u540D\u79F0",dataIndex:"title",render:function(i,t,c,P,s){var _=t.Id.substring(7,19);return t.Title&&(_=t.Title),(0,a.jsx)(M.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u955C\u50CF\u5907\u6CE8\u540D\u79F0",onChange:function(){var f=p()(o()().mark(function y(Z){var K;return o()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,S.Fj)({tag:t.RepoTags[0],title:Z});case 2:K=$.sent,me(Q+1),_e.success("\u4FEE\u6539\u955C\u50CF\u540D\u79F0\u6210\u529F");case 5:case"end":return $.stop()}},y)}));function b(y){return f.apply(this,arguments)}return b}()},children:(0,a.jsx)(F.Link,{to:"/image/detail/"+t.Id,children:_},"edit")},"title-".concat(c))}},{title:"Tag",dataIndex:"tag",render:function(i,t,c,P){return(0,a.jsx)(D.Z,{direction:"vertical",style:{textAlign:"left"},children:t.RepoTags.map(function(s,_){return(0,a.jsxs)(D.Z,{children:[(0,a.jsx)(R.Z,{color:"#2db7f5",children:(0,a.jsx)(M.Z.Text,{copyable:!0,title:s,style:{color:"#ffffff"},children:s},"tag-"+_)},"tag-".concat(_)),t.Containers>0&&(0,a.jsx)(R.Z,{color:"cyan",children:"\u4F7F\u7528\u4E2D"},"use-".concat(_))]},_)})},t.Id)}},{title:"\u67B6\u6784",width:80,search:!1,render:function(i,t,c,P,s){if(t.Labels&&t.Labels["com.dpanel.image.arch"])return(0,a.jsx)(R.Z,{children:t.Labels["com.dpanel.image.arch"]},"arch"+t.Id)}},{title:"\u5C3A\u5BF8",dataIndex:"size",ellipsis:!0,width:"120px",search:!1,sorter:function(i,t){return parseFloat(i.Size)-parseFloat(t.Size)},render:function(i,t,c,P){return(0,a.jsx)("div",{children:(0,w.FI)(parseFloat(t.Size))},t.Id)}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(i,t,c,P){return(0,a.jsx)("div",{children:(0,w.ZM)(t.Created*1e3)},t.Id)},sorter:function(i,t){return i.Created-t.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,fixed:"right",render:function(i,t,c,P){return(0,a.jsxs)(D.Z,{split:(0,a.jsx)(h.Z,{type:"vertical"}),children:[(0,a.jsx)(F.Link,{to:"/image/detail/"+t.Id,children:(0,a.jsx)(u.Z,{title:"\u7BA1\u7406",children:(0,a.jsx)(k.Z,{})})},"edit"),(0,a.jsx)(F.Link,{to:"/app/create/image?imageId="+t.RepoTags[0],children:(0,a.jsx)(u.Z,{title:"\u521B\u5EFA\u5BB9\u5668",children:(0,a.jsx)(q.Z,{})})},"create")]})}}],request:function(){var g=p()(o()().mark(function i(t,c,P){var s;return o()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,S.KG)({tag:t.tag,title:t.title});case 2:if(s=f.sent,!(!s||!s.data||!s.data.list)){f.next=5;break}return f.abrupt("return",{data:[],success:!0,total:0});case 5:return s.data.list.map(function(b){var y="";b.RepoTags.map(function(Z){s.data.title[Z]&&(y=s.data.title[Z])}),b.Title=y}),f.abrupt("return",{data:s.data.list,success:!0,total:s.data.list.length});case 7:case"end":return f.stop()}},i)}));return function(i,t,c){return g.apply(this,arguments)}}(),pagination:(0,V.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:v,tableAlertOptionRender:function(i){var t=i.selectedRowKeys,c=i.selectedRows;return(0,a.jsxs)(D.Z,{size:16,children:[(0,a.jsx)(N.Z,{icon:(0,a.jsx)(ee.Z,{}),action:function(){var s=[];return c.map(function(_){s.push.apply(s,l()(_.RepoTags))}),(0,se.Rb)({md5:s})},onSuccess:function(s){var _=c.map(function(b){return b.RepoTags[0]}),f=new Blob([s],{type:"application/tar"});(0,Y.saveAs)(f,_.join("-")+".tar")},children:"\u5BFC\u51FA"}),(0,a.jsxs)(I.Y,{formRef:X,title:"\u6279\u91CF\u63A8\u9001\u955C\u50CF",trigger:(0,a.jsx)(j.ZP,{icon:(0,a.jsx)(ne.Z,{}),children:"\u540C\u6B65\u81F3\u5176\u5B83\u4ED3\u5E93"}),onFinish:function(){var P=p()(o()().mark(function s(_){var f,b,y;return o()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,(0,S.KX)({md5:t,registryId:_.registryId,newNamespace:_.newNamespace});case 2:return y=K.sent,(f=v.current)===null||f===void 0||f.reload(),!((b=v.current)===null||b===void 0)&&b.clearSelected&&v.current.clearSelected(),K.abrupt("return",!0);case 6:case"end":return K.stop()}},s)}));return function(s){return P.apply(this,arguments)}}(),children:[(0,a.jsx)(L.Z,{name:"registryId",hidden:!0}),(0,a.jsx)(L.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,a.jsxs)(a.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,a.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,a.jsx)(ae.Z,{multiple:!0,top:!0,onChangeList:function(s){var _;(_=X.current)===null||_===void 0||_.setFieldValue("registryId",s.map(function(f){return f.id}))}})}),(0,a.jsx)(B.Z,{tooltip:"\u53EF\u4EE5\u901A\u8FC7\u6B64\u9879\u91CD\u65B0\u5B9A\u4E49\u547D\u540D\u7A7A\u95F4\uFF0Cdocker hub \u4E0D\u53D7\u8BE5\u914D\u7F6E\u7684\u5F71\u54CD\u3002 \u914D\u7F6E\u6B64\u9879\u540E mysql:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/mysql:latest\uFF0C dpanel/dpanel:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/dpanel:latest",label:"\u91CD\u5199\u4ED3\u5E93\u547D\u540D\u7A7A\u95F4",name:"newNamespace"})]}),(0,a.jsx)(N.Z,{danger:!0,type:"primary",action:function(){return(0,S.ao)({md5:t,force:oe.force})},onSuccess:function(){var s,_;return!((s=v.current)===null||s===void 0)&&s.reloadAndRest&&((_=v.current)===null||_===void 0||_.reloadAndRest()),!0},onError:function(){var s,_;return!((s=v.current)===null||s===void 0)&&s.reset&&((_=v.current)===null||_===void 0||_.reset()),!0},confirm:(0,a.jsxs)(D.Z,{style:{width:280},direction:"vertical",children:[(0,a.jsx)(M.Z.Text,{children:le("notification.confirm.title")}),(0,a.jsx)(m.Z,{name:"deleteVolume",onChange:function(s){return de({force:s.target.checked})},children:"\u5F3A\u5236\u5220\u9664\uFF1F"})]}),children:"\u6279\u91CF\u5220\u9664"})]})},tableExtraRender:function(){return(0,a.jsx)(O.Z,{mode:"horizontal",selectedKeys:["all"],items:[{label:(0,a.jsx)(F.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,a.jsx)(F.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})},toolBarRender:function(){return[(0,a.jsx)(N.Z,{action:function(){return(0,S.c7)()},onSuccess:function(){var t,c;return!((t=v.current)===null||t===void 0)&&t.reloadAndRest&&((c=v.current)===null||c===void 0||c.reloadAndRest()),!0},onError:function(){var t,c;return!((t=v.current)===null||t===void 0)&&t.reset&&((c=v.current)===null||c===void 0||c.reset()),!0},confirm:"notification.confirm.title",children:"\u6E05\u7406\u672A\u4F7F\u7528\u955C\u50CF"})]},columnsState:(0,V.j)("image-list")})})}},3393:function(z,T,e){e.d(T,{Gb:function(){return C},Pn:function(){return L},Rb:function(){return x},YU:function(){return p},ZQ:function(){return R},_U:function(){return r},cd:function(){return M}});var U=e(15009),l=e.n(U),d=e(99289),o=e.n(d),E=e(82346);function p(u){return A.apply(this,arguments)}function A(){return A=o()(l()().mark(function u(m){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/get-detail",{method:"POST",data:m}));case 1:case"end":return n.stop()}},u)})),A.apply(this,arguments)}function C(u){return W.apply(this,arguments)}function W(){return W=o()(l()().mark(function u(m){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/tag-remote",{method:"POST",data:m}));case 1:case"end":return n.stop()}},u)})),W.apply(this,arguments)}function r(u){return I.apply(this,arguments)}function I(){return I=o()(l()().mark(function u(m){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/tag-add",{method:"POST",data:m}));case 1:case"end":return n.stop()}},u)})),I.apply(this,arguments)}function L(u){return B.apply(this,arguments)}function B(){return B=o()(l()().mark(function u(m){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/tag-delete",{method:"POST",data:m}));case 1:case"end":return n.stop()}},u)})),B.apply(this,arguments)}function x(u){return j.apply(this,arguments)}function j(){return j=o()(l()().mark(function u(m){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/export",{method:"POST",data:m,responseType:"blob"}));case 1:case"end":return n.stop()}},u)})),j.apply(this,arguments)}function M(u){return D.apply(this,arguments)}function D(){return D=o()(l()().mark(function u(m){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/pro/image/get-remote-tag",{method:"POST",data:m}));case 1:case"end":return n.stop()}},u)})),D.apply(this,arguments)}function R(u){return h.apply(this,arguments)}function h(){return h=o()(l()().mark(function u(m){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/check-upgrade",{method:"POST",data:m}));case 1:case"end":return n.stop()}},u)})),h.apply(this,arguments)}},67255:function(z,T,e){e.d(T,{O:function(){return U},j:function(){return l}});function U(){var d=localStorage.getItem("dpanel-pagesize");return d=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(d!=null?d:"20")}}function l(d){var o="dpanel-table-column-".concat(d),E={};if(localStorage.getItem(o)){var p;E=JSON.parse((p=localStorage.getItem(o))!==null&&p!==void 0?p:"{}")}return{defaultValue:E,onChange:function(C){localStorage.setItem("dpanel-table-column-".concat(d),JSON.stringify(C))}}}}}]);
