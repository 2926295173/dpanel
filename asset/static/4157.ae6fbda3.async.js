"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4157],{57716:function(K,j,n){n.d(j,{Z:function(){return u}});var M=n(5574),r=n.n(M),L=n(15009),o=n.n(L),l=n(99289),W=n.n(l),d=n(67294),w=n(184),v=n(38345),a=n(64317),O=n(5966),R=n(62370),m=n(97462),D=n(42075),_=n(89035),C=n(82346),c=n(28036),f=n(85893);function p(s){var i=(0,d.useState)({height:800,width:1024}),t=r()(i,2),g=t[0],e=t[1],F=function(){var N=window.innerWidth,z=window.innerHeight;e({height:z,width:N})};(0,d.useEffect)(function(){window.addEventListener("resize",function(){F()}),F()},[s]);var $=s.query?Object.keys(s.query).map(function(x){if(s.query)return"".concat(x,"=").concat(s.query[x])}):[];return(0,f.jsx)(C.Link,{target:"_blank",to:"/console/"+s.container+"?width=".concat(g.width,"&height=").concat(g.height,"&").concat($.join("&")),children:(0,f.jsx)(c.ZP,{type:"primary",icon:(0,f.jsx)(_.Z,{}),children:s.content})})}var T=n(60335),y=n(5251),E=n(49610),h=(0,d.forwardRef)(function(s,i){(0,d.useImperativeHandle)(i,function(){return{show:function(U,P){return W()(o()().mark(function S(){var B,k,I;return o()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,T.jV)({md5:U});case 2:I=Z.sent,P&&P!=""&&(I.data.info.Config.WorkingDir=P),V(I.data.info),x(!0),(B=t.current)===null||B===void 0||B.resetFields(),(k=t.current)===null||k===void 0||k.setFieldsValue({workDir:I.data.info.Config.WorkingDir});case 8:case"end":return Z.stop()}},S)}))()}}});var t=(0,d.useRef)(),g=(0,d.useRef)(),e=(0,d.useState)(!1),F=r()(e,2),$=F[0],x=F[1],N=(0,d.useState)(),z=r()(N,2),A=z[0],V=z[1];return(0,d.useEffect)(function(){return A&&setTimeout(function(){var b;(b=g.current)===null||b===void 0||b.start(A.Id,{width:"800",height:"".concat(window.innerHeight),cmd:"/bin/sh",workDir:A.Config.WorkingDir})},2e3),function(){var b;(b=g.current)===null||b===void 0||b.close()}},[A,$]),(0,f.jsxs)(w.a,{drawerProps:{forceRender:!0},onFinish:function(){var b=W()(o()().mark(function U(P){var S,B;return o()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(A){I.next=2;break}return I.abrupt("return",!1);case 2:return(S=g.current)===null||S===void 0||S.close(),(B=g.current)===null||B===void 0||B.start(A.Id,{width:"800",height:"".concat(window.innerHeight),cmd:P.entryCmd,workDir:P.workDir}),I.abrupt("return",!1);case 5:case"end":return I.stop()}},U)}));return function(U){return b.apply(this,arguments)}}(),onValuesChange:function(U,P){if(P.entryCmd){var S;(S=t.current)===null||S===void 0||S.submit()}},isKeyPressSubmit:!0,open:$,formRef:t,onOpenChange:function(U){if(x(U),U){var P;(P=g.current)===null||P===void 0||P.fit()}},submitter:!1,title:(0,y.fi)(A?A.Name:"","/")+" \u63A7\u5236\u53F0",children:[(0,f.jsx)(v.Z,{ghost:!0,children:(0,f.jsxs)(D.Z.Compact,{children:[(0,f.jsx)(a.Z,{label:"shell",width:"sm",name:"entryCmd",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,f.jsx)(O.Z,{width:"sm",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",disabled:!0}),(0,f.jsx)(R.Z,{label:" ",children:(0,f.jsx)(m.Z,{name:["entryCmd","workDir"],children:function(U){var P=U.entryCmd;return(!P||P=="")&&(P="/bin/sh"),A&&(0,f.jsx)(p,{container:A.Id,query:{cmd:encodeURIComponent(P),workDir:encodeURIComponent(A.Config.WorkingDir)},content:"\u65B0\u7A97\u53E3\u6253\u5F00"})}})})]})}),$&&(0,f.jsx)(E.Z,{showInDrawer:!0,ref:g})]})}),u=h},80821:function(K,j,n){n.d(j,{Z:function(){return v}});var M=n(5574),r=n.n(M),L=n(24963),o=n(86738),l=n(28036),W=n(83062),d=n(67294),w=n(85893);function v(a){var O=(0,d.useState)(!1),R=r()(O,2),m=R[0],D=R[1],_=(0,d.useContext)(L.Z),C=_.lang,c=_.notice,f=_.message,p=function(){D(!0);var y=a.action();y instanceof Promise?y.then(function(E){if(D(!1),E){typeof a.onSuccess=="function"&&a.onSuccess(E);var h="";a.messageSuccess?typeof a.messageSuccess=="function"?h=a.messageSuccess(E):h=a.messageSuccess.indexOf("notification.")==0?C(a.messageSuccess):a.messageSuccess:h=C("notification.finish"),a.asynced?f.info(h):f.success(h)}}).catch(function(E){D(!1),typeof a.onError=="function"&&a.onError(E)}):D(!1)};return a.confirm?(0,w.jsx)(o.Z,{style:{width:500},title:a.confirmTitle?a.confirmTitle:C("notification.title.tip"),description:typeof a.confirm=="string"&&a.confirm.indexOf("notification.")==0?C(a.confirm):a.confirm,onConfirm:p,okText:"Yes",cancelText:"No",children:(0,w.jsx)(l.ZP,{disabled:a.disabled,icon:a.icon,loading:m,danger:a.danger,type:a.type,children:a.children})}):(0,w.jsx)(W.Z,{title:a.tips,children:(0,w.jsx)(l.ZP,{style:a.ghost?{padding:0,height:"auto"}:{},disabled:a.disabled,icon:a.icon,loading:m,onClick:p,danger:a.danger,type:a.type,children:a.children})})}},49610:function(K,j,n){var M=n(67294),r=n(54964),L=n(52626),o=n(12320),l=n.n(o),W=n(78267),d=n.n(W),w=n(85893),v,a=new o.Terminal(r.a),O=new W.FitAddon,R=(0,M.forwardRef)(function(m,D){var _,C=function(){a.reset(),_&&_.dispose(),v&&(v.close(),v=null)},c=function(){a.reset(),O.fit(),a.focus(),_&&_.dispose(),_=a.onData(function(p){var T={content:{command:p},type:"console"};v&&v.send(JSON.stringify(T))})};return(0,M.useImperativeHandle)(D,function(){return{start:function(p,T){var y=T?Object.keys(T).map(function(E){if(T&&T[E])return"".concat(E,"=").concat(T[E])}):[];v=new WebSocket((0,L.R)("/console/"+p+"?"+y.join("&"))),v.addEventListener("message",function(E){var h=JSON.parse(E.data),u=h.type;if(u=="console:"+p&&(a.write(h.data),h.data.indexOf("exec failed")!=-1)){C();return}}),c()},close:function(){C()},fit:function(){O.fit()}}}),(0,M.useEffect)(function(){return a.loadAddon(O),a.open(document.getElementById("terminal-container-console")),O.fit(),function(){C()}},[]),(0,w.jsx)("div",{style:{height:m.showInDrawer?"75vh":"100vh"},id:"terminal-container-console"})});j.Z=R},54964:function(K,j,n){n.d(j,{a:function(){return R}});var M=n(5574),r=n.n(M),L=n(78267),o=n.n(L),l=n(75458),W=n.n(l),d=n(67294),w=n(12320),v=n.n(w),a=n(89629),O=n(85893),R={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},m=new w.Terminal(R),D=new l.SearchAddon,_=new L.FitAddon,C=(0,d.forwardRef)(function(c,f){var p,T=(0,d.useState)(!0),y=r()(T,2),E=y[0],h=y[1];return(0,d.useEffect)(function(){return window.addEventListener("resize",function(){c.showInModal||_.fit()}),c.style&&c.style.fontSize&&(m.options.fontSize=c.style.fontSize),m.loadAddon(_),m.loadAddon(D),m.open(document.getElementById(c.id?c.id:"terminal-container")),c.showInModal||_.fit(),function(){m.reset(),h(!0)}},[]),(0,d.useImperativeHandle)(f,function(){return{write:function(s){E&&(_.fit(),h(!1)),m.write(s)},clear:function(){m.clear()},getTerminal:function(){return m},findNext:function(s){D.findNext(s)},findPrev:function(s){D.findPrevious(s)},fit:function(){_.fit()},onData:function(s){return m.onData(s)}}}),(0,O.jsx)("div",{id:c.id?c.id:"terminal-container",style:{width:c.width?c.width:"100%",height:c.height?c.height:"500px",marginTop:(p=c.style)===null||p===void 0?void 0:p.marginTop}})});j.Z=C},24963:function(K,j,n){var M=n(67294),r=(0,M.createContext)({});j.Z=r},28031:function(K,j,n){n.d(j,{C4:function(){return f},LK:function(){return C},OQ:function(){return T},V9:function(){return W},Yx:function(){return R},ZU:function(){return a},_U:function(){return w},gb:function(){return D},lE:function(){return u},vp:function(){return E}});var M=n(15009),r=n.n(M),L=n(99289),o=n.n(L),l=n(82346);function W(i){return d.apply(this,arguments)}function d(){return d=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/explorer/get-path-list",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),d.apply(this,arguments)}function w(i){return v.apply(this,arguments)}function v(){return v=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/explorer/export",{data:t,method:"POST",responseType:"blob"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),v.apply(this,arguments)}function a(i){return O.apply(this,arguments)}function O(){return O=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/explorer/import",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),O.apply(this,arguments)}function R(i){return m.apply(this,arguments)}function m(){return m=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/explorer/delete",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),m.apply(this,arguments)}function D(i){return _.apply(this,arguments)}function _(){return _=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/explorer/unzip",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),_.apply(this,arguments)}function C(i){return c.apply(this,arguments)}function c(){return c=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/explorer/get-content",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),c.apply(this,arguments)}function f(i){return p.apply(this,arguments)}function p(){return p=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/explorer/import-file-content",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),p.apply(this,arguments)}function T(i){return y.apply(this,arguments)}function y(){return y=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/explorer/chmod",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),y.apply(this,arguments)}function E(i){return h.apply(this,arguments)}function h(){return h=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/volume/backup",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),h.apply(this,arguments)}function u(i){return s.apply(this,arguments)}function s(){return s=o()(r()().mark(function i(t){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.request)("/api/app/explorer/get-passwd",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},i)})),s.apply(this,arguments)}},60335:function(K,j,n){n.d(j,{IE:function(){return w},IW:function(){return W},KK:function(){return D},LJ:function(){return C},RF:function(){return T},Re:function(){return f},aF:function(){return E},eE:function(){return R},jV:function(){return a}});var M=n(15009),r=n.n(M),L=n(99289),o=n.n(L),l=n(82346);function W(u){return d.apply(this,arguments)}function d(){return d=o()(r()().mark(function u(s){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.request)("/api/app/container/status",{method:"POST",data:s}));case 1:case"end":return t.stop()}},u)})),d.apply(this,arguments)}function w(u){return v.apply(this,arguments)}function v(){return v=o()(r()().mark(function u(s){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.request)("/api/app/container/get-list",{data:s,method:"POST"}));case 1:case"end":return t.stop()}},u)})),v.apply(this,arguments)}function a(u){return O.apply(this,arguments)}function O(){return O=o()(r()().mark(function u(s){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.request)("/api/app/container/get-detail",{data:s,method:"POST"}));case 1:case"end":return t.stop()}},u)})),O.apply(this,arguments)}function R(u){return m.apply(this,arguments)}function m(){return m=o()(r()().mark(function u(s){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.request)("/api/app/container/update",{data:s,method:"POST"}));case 1:case"end":return t.stop()}},u)})),m.apply(this,arguments)}function D(){return _.apply(this,arguments)}function _(){return _=o()(r()().mark(function u(){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,l.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return i.stop()}},u)})),_.apply(this,arguments)}function C(u){return c.apply(this,arguments)}function c(){return c=o()(r()().mark(function u(s){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.request)("/api/app/container/export",{method:"POST",data:s,responseType:"blob"}));case 1:case"end":return t.stop()}},u)})),c.apply(this,arguments)}function f(u){return p.apply(this,arguments)}function p(){return p=o()(r()().mark(function u(s){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.request)("/api/app/container/commit",{method:"POST",data:s}));case 1:case"end":return t.stop()}},u)})),p.apply(this,arguments)}function T(u){return y.apply(this,arguments)}function y(){return y=o()(r()().mark(function u(s){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.request)("/api/app/container/upgrade",{method:"POST",data:s}));case 1:case"end":return t.stop()}},u)})),y.apply(this,arguments)}function E(u){return h.apply(this,arguments)}function h(){return h=o()(r()().mark(function u(s){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.request)("/api/app/container/copy",{method:"POST",data:s}));case 1:case"end":return t.stop()}},u)})),h.apply(this,arguments)}}}]);
