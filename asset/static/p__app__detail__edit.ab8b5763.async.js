"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8878],{76428:function(Ze,U,n){n.d(U,{Z:function(){return y}});var z=n(25593),m=n(67294),J=n(85893);function y(W){return(0,J.jsx)(z.Z.Text,{copyable:!0,children:W.title})}},78498:function(Ze,U,n){n.d(U,{Z:function(){return I}});var z=n(25035),m=n(42075),J=n(83062),y=n(67294),W=n(85893);function I(Y){return(0,W.jsxs)(m.Z,{children:[Y.title,(0,W.jsx)(J.Z,{title:Y.help,children:(0,W.jsx)(z.Z,{})})]})}},50479:function(Ze,U,n){n.r(U),n.d(U,{default:function(){return lt}});var z=n(15009),m=n.n(z),J=n(99289),y=n.n(J),W=n(5574),I=n.n(W),Y=n(14946),de=n(29158),Be=n(48689),M=n(38345),$=n(10641),g=n(42075),R=n(25593),De=n(83062),i=n(67294),c=n(80821),x=n(60335),ce=n(78498),t=n(85893),ve=(0,i.forwardRef)(function(D,k){var Z=(0,i.useRef)();return(0,i.useImperativeHandle)(k,function(){return{reload:function(){var h;!((h=Z.current)===null||h===void 0)&&h.reloadAndRest&&Z.current.reloadAndRest()}}}),(0,t.jsx)(M.Z,{title:(0,t.jsx)(de.Z,{}),subTitle:"\u5BB9\u5668\u5173\u8054\u4FE1\u606F",ghost:!0,children:(0,t.jsx)($.Z,{scroll:{x:"max-content"},rowKey:"key",actionRef:Z,pagination:!1,options:!1,columns:[{title:"\u6240\u5C5E\u7F51\u7EDC",key:"name",dataIndex:"networkName",width:300},{title:"\u5BB9\u5668\u540D\u79F0",key:"containerName",dataIndex:"containerName"},{title:(0,t.jsx)(ce.Z,{title:"hostname",help:"\u63D0\u4F9B\u5BB9\u5668\u5185\u90E8\u8BBF\u95EE"}),key:"hostName",render:function(h,v,p){return v.hostName?(0,t.jsx)(g.Z,{direction:"vertical",children:v.hostName.map(function(f){if(f)return(0,t.jsx)(R.Z.Text,{copyable:!0,keyboard:!0,children:f},f)})}):(0,t.jsx)(t.Fragment,{})}},{title:"Ip",key:"ip",render:function(h,v,p,f,S){return(0,t.jsxs)(g.Z,{direction:"vertical",children:[(0,t.jsx)("span",{children:v.networkInfo.IPv4Address}),v.networkInfo.IPv6Address&&(0,t.jsx)("span",{children:v.networkInfo.IPv6Address})]})}},{title:"\u64CD\u4F5C",key:"option",width:100,render:function(h,v,p,f,S){return(0,t.jsx)(g.Z,{children:v.key!="bridge"&&v.key!="none"&&v.key!="host"&&v.networkName!=""&&(0,t.jsx)(De.Z,{title:"\u9000\u51FA\u7F51\u7EDC",children:(0,t.jsx)(c.Z,{confirm:"\u786E\u8BA4\u9000\u51FA\u8BE5\u7F51\u7EDC\uFF1F",type:"link",action:function(){var B;return(0,Y.t9)({name:v.networkName,containerName:(B=D.containerName)!==null&&B!==void 0?B:""})},messageSuccess:"leave",onSuccess:function(){var B,r;!((B=Z.current)===null||B===void 0)&&B.reloadAndRest&&((r=Z.current)===null||r===void 0||r.reloadAndRest())},children:(0,t.jsx)(Be.Z,{})})})})}}],request:function(){var E=y()(m()().mark(function h(v,p,f){var S,A;return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,x.jV)({md5:D.containerName});case 2:return S=r.sent,r.next=5,(0,Y._3)({name:Object.keys(S.data.info.NetworkSettings.Networks)});case 5:return A=r.sent,r.abrupt("return",{data:A.data.list,success:!0,total:A.data.list.length});case 7:case"end":return r.stop()}},h)}));return function(h,v,p){return E.apply(this,arguments)}}(),search:!1,expandable:{defaultExpandAllRows:!0,expandRowByClick:!1,defaultExpandedRowKeys:["bridge"]}})})}),me=ve,fe=n(44771),b=n(76428),Se=n(62597),ne=n(43425),he=n(74842),Pe=n(87784),ye=n(33160),Ae=n(30159),pe=n(58638),ge=n(60219),ae=n(86548),X=n(57132),Re=n(50888),xe=n(16596),je=n(45605),be=n(238),Te=n(32319),ue=n(16664),re=n(97269),le=n(62370),H=n(54006),Q=n(96074),q=n(84567),K=n(65233),T=n(14726),Ee=n(40411),l=n(26412),O=n(66309),ie=n(93162),_=n(87662),Oe=n(75516),V=n(28031),j=n(85576),Ke=n(63490),Ve=n(37476),Ge=n(86615),Ye=n(97462),we=n(5966),ze=n(2831);function Je(D){var k=j.Z.useModal(),Z=I()(k,2),E=Z[0],h=Z[1],v=(0,i.useState)(),p=I()(v,2),f=p[0],S=p[1],A=(0,i.useRef)(),B="";return(0,i.useEffect)(function(){var r,e;(0,ze.aF)().then(function(L){S(L.data.dpanel.containerInfo)}),B=(r=localStorage.getItem("backupPath"))!==null&&r!==void 0?r:"",(e=A.current)===null||e===void 0||e.setFieldValue("backupPath",B)},[]),(0,t.jsxs)(t.Fragment,{children:[h,(0,t.jsxs)(Ve.Y,{modalProps:{forceRender:!0},formRef:A,title:"\u5907\u4EFD\u5BB9\u5668\u5B58\u50A8\u5377",trigger:(0,t.jsxs)(T.ZP,{children:[(0,t.jsx)(ge.Z,{})," \u5907\u4EFD\u5B58\u50A8"]}),onFinish:function(){var r=y()(m()().mark(function e(L){var ee,te;return m()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return L.backupPath&&localStorage.setItem("backupPath",L.backupPath),ee={containerMd5:D.container.Id,backupTargetType:L.backupTargetType,backupPath:L.backupPath},L.backupTargetType=="dpanel"&&f&&f.Mounts&&f.Mounts.map(function(G){G.Destination=="/dpanel"&&(ee.backupPath=G.Type=="volume"?G.Name:ee.backupPath=G.Source)}),P.next=5,(0,V.vp)(ee);case 5:return te=P.sent,E.info({title:"\u6B63\u5728\u5907\u4EFD\u5B58\u50A8\u4E2D",content:(0,t.jsx)(M.Z,{ghost:!0,style:{paddingTop:30},children:(0,t.jsx)(Ke.Z,{columns:[{title:"\u5907\u4EFD\u6587\u4EF6",key:"backup",dataIndex:"backup",width:300,render:function(Fe,se,Ce){return(0,t.jsx)(R.Z.Paragraph,{ellipsis:{rows:5,expandable:!0},children:se.backupTar})}},{title:"\u5907\u4EFD\u76EE\u5F55",key:"pathList",dataIndex:"pathList",render:function(Fe,se,Ce){return se.pathList.map(function(N,oe){return(0,t.jsx)("div",{children:N},oe)})}}],dataSource:[{key:1,backupTar:te.data.backupTar,pathList:te.data.pathList}],rowKey:"key",pagination:!1})}),closable:!0,width:800}),P.abrupt("return",!0);case 8:case"end":return P.stop()}},e)}));return function(e){return r.apply(this,arguments)}}(),children:[(0,t.jsx)(Ge.Z.Group,{label:"\u5907\u4EFD\u76EE\u6807\u4F4D\u7F6E",name:"backupTargetType",initialValue:"dpanel",fieldProps:{defaultValue:"dpanel"},options:[{label:"DPanel \u5907\u4EFD\u76EE\u5F55\u4E2D",value:"dpanel"},{label:"\u5BBF\u4E3B\u673A\u76EE\u5F55\u4E2D",value:"host"}]}),(0,t.jsx)(Ye.Z,{name:["backupTargetType"],children:function(e){var L=e.backupTargetType;return L=="host"?(0,t.jsx)(we.Z,{label:"\u6307\u5B9A\u5BBF\u4E3B\u673A\u76EE\u5F55",tooltip:"\u8BF7\u586B\u5199\u5BBF\u4E3B\u673A\u76EE\u5F55\uFF0C\u4E0D\u5B58\u65F6\u4F1A\u65B0\u5EFA",name:"backupPath",placeholder:"/home/backup",initialValue:"/home/backup"}):(0,t.jsxs)(t.Fragment,{children:["\u5907\u4EFD\u4F4D\u4E8E DPanel \u5BB9\u5668\u4E2D\u7684 /dpanel/backup \u8DEF\u5F84 ",(0,t.jsx)(H.Link,{target:"_blank",to:"/app/detail/file/".concat(f==null?void 0:f.Id,"?tab=file&path=").concat(encodeURIComponent("/dpanel/backup")),children:"\u67E5\u770B"})]})}})]})]})}var ke=n(78451),Qe=n(24963),Xe=n(50070),qe=n(64599),_e=n.n(qe),et=n(40717),tt=n(184),nt=n(4798);function at(D){var k=(0,i.useRef)();return[(0,t.jsx)(tt.a,{trigger:(0,t.jsx)(T.ZP,{icon:(0,t.jsx)(et.Z,{}),children:"\u52A0\u5165\u5DF2\u6709\u7F51\u7EDC"},"button"),width:800,formRef:k,title:"\u914D\u7F6E\u7F51\u7EDC",onFinish:function(){var Z=y()(m()().mark(function E(h){var v,p,f,S,A;return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!h.network){r.next=19;break}p=_e()(h.network),r.prev=2,p.s();case 4:if((f=p.n()).done){r.next=11;break}return S=f.value,r.next=8,(0,Y.HY)({name:S.name,containerName:D.containerName,containerAlise:S.alise,ipV4:S.ipV4});case 8:A=r.sent;case 9:r.next=4;break;case 11:r.next=16;break;case 13:r.prev=13,r.t0=r.catch(2),p.e(r.t0);case 16:return r.prev=16,p.f(),r.finish(16);case 19:return!((v=k.current)===null||v===void 0)&&v.resetFields&&k.current.resetFields(),D.onSuccess&&D.onSuccess(),r.abrupt("return",!0);case 22:case"end":return r.stop()}},E,null,[[2,13,16,19]])}));return function(E){return Z.apply(this,arguments)}}(),children:(0,t.jsx)(nt.Z,{siteName:D.containerName})},"form")]}var ut=n(99861),rt=n(3393);function lt(){var D,k,Z,E=(0,i.useContext)(Qe.Z),h=E.message,v=E.notice,p=E.loading,f=E.lang,S=(0,i.useContext)(Xe.AppDetailContext),A=(0,H.useParams)(),B=(0,i.useState)(),r=I()(B,2),e=r[0],L=r[1],ee=(0,i.useState)(1),te=I()(ee,2),w=te[0],P=te[1],G=(0,H.useNavigate)(),Fe=(0,i.useRef)(),se=(0,i.useState)({deleteImage:!1,deleteVolume:!1,deleteLink:!1}),Ce=I()(se,2),N=Ce[0],oe=Ce[1],it=(0,i.useState)(""),Le=I()(it,2),st=Le[0],ot=Le[1],Me=(0,i.useRef)(),Ne=(0,i.useRef)(),Ue=(0,i.useRef)(),We=(0,i.useRef)(),dt=(0,i.useState)(0),$e=I()(dt,2),Ie=$e[0],He=$e[1];return(0,i.useEffect)(function(){var u;p.show(),S.reload(),(0,x.jV)({md5:(u=A.id)!==null&&u!==void 0?u:""}).then(function(a){var d;if(a.data){var o;a.data.info.HostConfig.NetworkMode=="host"&&a.data.info.Config.ExposedPorts&&Object.keys(a.data.info.Config.ExposedPorts).map(function(s){a.data.info.NetworkSettings.Ports[s]=[{HostIp:"0.0.0.0",HostPort:s.substring(0,s.indexOf("/"))}]}),(0,rt.ZQ)({tag:(o=a.data.info.Config.Image)!==null&&o!==void 0?o:""}).then(function(s){He(s.data.upgrade?1:2)}).catch(function(s){He(-1)}),L(a.data.info)}(d=Fe.current)===null||d===void 0||d.setFieldValue("restart",a.data.info.HostConfig.RestartPolicy.Name)}).finally(function(){p.destroy()}),(0,_.EH)().then(function(a){ot(a.data.ip)})},[w]),(0,t.jsxs)(t.Fragment,{children:[e&&(0,t.jsx)(ut.Z,{image:[e.Config.Image],ref:We}),(0,t.jsxs)(M.Z,{direction:"column",gutter:[0,10],children:[(0,t.jsx)(M.Z,{title:(0,t.jsx)(ne.Z,{}),subTitle:"\u72B6\u6001\u7BA1\u7406",ghost:!0,children:(0,t.jsxs)(g.Z,{wrap:!0,children:[(0,t.jsx)(c.Z,{icon:(0,t.jsx)(he.Z,{}),action:function(){var a;return(0,x.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"start"})},messageSuccess:"start",onSuccess:function(){return P(w+1)},disabled:e&&e.State.Running||e&&e.State.Paused,children:"\u542F\u52A8"}),(0,t.jsx)(c.Z,{action:function(){var a;return(0,x.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"stop"})},messageSuccess:"stop",icon:(0,t.jsx)(Pe.Z,{}),onSuccess:function(){return P(w+1)},disabled:e&&e.State.Dead,children:"\u505C\u6B62"}),(0,t.jsx)(c.Z,{action:function(){var a;return(0,x.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"restart"})},messageSuccess:"restart",onSuccess:function(){return P(w+1)},icon:(0,t.jsx)(ye.Z,{}),children:"\u91CD\u542F"}),(0,t.jsx)(c.Z,{action:function(){var a;return(0,x.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"pause"})},messageSuccess:"pause",onSuccess:function(){return P(w+1)},icon:(0,t.jsx)(Ae.Z,{}),disabled:e&&!e.State.Running,children:"\u6682\u505C"}),(0,t.jsx)(c.Z,{action:function(){var a;return(0,x.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"unpause"})},messageSuccess:"resume",onSuccess:function(){return P(w+1)},icon:(0,t.jsx)(he.Z,{}),disabled:e&&!e.State.Paused,children:"\u6062\u590D"}),(0,t.jsx)(Q.Z,{type:"vertical"}),e&&(0,t.jsx)(Oe.Z,{container:e}),(0,t.jsx)(Q.Z,{type:"vertical"}),e&&(!e.Config.Labels||!e.Config.Labels["com.docker.compose.project"])&&(0,t.jsx)(c.Z,{action:function(){var a;return(0,Se.Ct)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",deleteImage:N.deleteImage,deleteVolume:N.deleteVolume})},messageSuccess:"delete",danger:!0,type:"primary",icon:(0,t.jsx)(Pe.Z,{}),onSuccess:function(){return G("/app/list")},confirm:(0,t.jsxs)(g.Z,{style:{width:280},direction:"vertical",children:[(0,t.jsx)(R.Z.Text,{children:"\u5220\u9664\u5BB9\u5668\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"}),(0,t.jsx)(q.Z,{name:"deleteVolume",onChange:function(a){return oe({deleteImage:N.deleteImage,deleteVolume:a.target.checked,deleteLink:N.deleteLink})},children:"\u5220\u9664\u5B58\u50A8\uFF1F"}),(0,t.jsx)(q.Z,{name:"deleteImage",onChange:function(a){return oe({deleteImage:a.target.checked,deleteVolume:N.deleteVolume,deleteLink:N.deleteLink})},children:"\u5220\u9664\u955C\u50CF\uFF1F"}),(0,t.jsx)(q.Z,{name:"deleteLink",onChange:function(a){return oe({deleteImage:N.deleteVolume,deleteVolume:N.deleteVolume,deleteLink:a.target.checked})},children:"\u5220\u9664\u5173\u8054\u5BB9\u5668\uFF1F"})]}),children:"\u5220\u9664"})]})}),(0,t.jsx)(M.Z,{title:(0,t.jsx)(ne.Z,{}),subTitle:"\u5BB9\u5668\u7BA1\u7406",ghost:!0,children:(0,t.jsxs)(g.Z,{wrap:!0,children:[(0,t.jsx)(c.Z,{icon:(0,t.jsx)(pe.Z,{}),action:function(){var a;return(0,x.LJ)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:""})},confirm:"\u5BFC\u51FA\u5BB9\u5668 Tar \u5305\u4E0D\u5305\u542B\u6302\u8F7D\u76EE\u5F55\u7684\u6570\u636E\uFF0C\u786E\u5B9A\u5417\uFF1F",onSuccess:function(a){var d=new Blob([a],{type:"application/tar"});(0,ie.saveAs)(d,(e==null?void 0:e.Id)+".tar")},messageSuccess:"export",children:"\u5BFC\u51FA\u5BB9\u5668"}),(0,t.jsx)(c.Z,{icon:(0,t.jsx)(ge.Z,{}),action:y()(m()().mark(function u(){var a,d,o;return m()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,x.Re)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",name:(d=(o=Me.current)===null||o===void 0?void 0:o.getFieldValue("saveImageName"))!==null&&d!==void 0?d:e==null?void 0:e.Name});case 2:case"end":return F.stop()}},u)})),confirmTitle:"\u5C06\u5F53\u524D\u5BB9\u5668\u4FDD\u5B58\u4E3A\u955C\u50CF",confirm:(0,t.jsx)(g.Z,{style:{width:300,marginTop:"10px",paddingRight:"10px"},direction:"vertical",children:(0,t.jsx)(re.A,{formRef:Me,submitter:!1,children:(0,t.jsx)(le.Z,{name:"saveImageName",children:(0,t.jsx)(K.Z,{addonBefore:"\u955C\u50CF\u540D\u79F0"})})})}),messageSuccess:"save",children:"\u53E6\u5B58\u4E3A\u955C\u50CF"}),e&&(0,t.jsx)(Je,{container:e}),(0,t.jsx)(Q.Z,{type:"vertical"}),(0,t.jsx)(H.Link,{to:"/app/create/image?containerId=".concat(e==null?void 0:e.Id,"&op=update"),children:(0,t.jsx)(T.ZP,{type:"primary",icon:(0,t.jsx)(ae.Z,{}),children:"\u7F16\u8F91\u5BB9\u5668"})}),(0,t.jsx)(H.Link,{to:"/app/create/image?containerId=".concat(e==null?void 0:e.Id,"&op=copy"),children:(0,t.jsx)(T.ZP,{icon:(0,t.jsx)(X.Z,{}),children:"\u590D\u5236"})}),(0,t.jsx)(Ee.Z,{count:f("app.detail.checkImageUpgrade."+Ie),color:Ie<=0?"red":"green",children:(0,t.jsx)(c.Z,{disabled:Ie===0,icon:Ie===0?(0,t.jsx)(Re.Z,{}):(0,t.jsx)(xe.Z,{}),action:y()(m()().mark(function u(){var a,d,o,s;return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(a=We.current)===null||a===void 0?void 0:a.start();case 2:return C.next=4,(0,x.RF)({md5:(d=e==null?void 0:e.Id)!==null&&d!==void 0?d:"",imageTag:"",enableBak:(o=(s=Ne.current)===null||s===void 0?void 0:s.getFieldValue("enableBak"))!==null&&o!==void 0?o:!0});case 4:return C.abrupt("return",C.sent);case 5:case"end":return C.stop()}},u)})),confirm:(0,t.jsxs)(g.Z,{style:{width:280,paddingRight:"10px"},direction:"vertical",children:[(0,t.jsx)(R.Z.Text,{children:"\u66F4\u65B0\u5BB9\u5668\u524D\u8BF7\u786E\u4FDD\u8FDC\u7A0B Docker \u7248\u672C\u4E0E\u9762\u677F\u73AF\u5883\u4E00\u81F4\u3002\u6B64\u64CD\u4F5C\u5C06\u4F1A\u91CD\u65B0\u62C9\u53D6\u955C\u50CF\u5E76\u91CD\u5EFA\u5BB9\u5668\u3002\u786E\u5B9A\u5417\uFF1F"}),(0,t.jsx)(re.A,{formRef:Ne,submitter:!1,layout:"inline",children:(0,t.jsx)(le.Z,{name:"enableBak",initialValue:!0,valuePropName:"checked",children:(0,t.jsx)(q.Z,{children:"\u5907\u4EFD\u65E7\u5BB9\u5668\uFF1F"})})})]}),onSuccess:function(a){G("/app/list")},messageSuccess:"upgrade",children:"\u5FEB\u901F\u5347\u7EA7\u5BB9\u5668"})}),(0,t.jsx)(Q.Z,{type:"vertical"}),e&&(0,t.jsx)(at,{onSuccess:function(){var a;(a=Ue.current)===null||a===void 0||a.reload()},containerName:e.Name})]})}),(0,t.jsx)(M.Z,{title:(0,t.jsx)(je.Z,{}),subTitle:"\u5BB9\u5668\u72B6\u6001",ghost:!0,children:(0,t.jsxs)(l.Z,{column:1,bordered:!0,children:[(0,t.jsx)(l.Z.Item,{label:"ID",children:(0,t.jsx)(b.Z,{title:e==null?void 0:e.Id})}),(0,t.jsx)(l.Z.Item,{label:"\u5BB9\u5668\u540D\u79F0",children:(0,t.jsx)(R.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u5BB9\u5668\u540D\u79F0",onChange:function(){var u=y()(m()().mark(function d(o){var s;return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(e!=null&&e.Id){C.next=2;break}return C.abrupt("return");case 2:return C.next=4,(0,x.eE)({md5:e.Id,name:o});case 4:s=C.sent,P(w+1),h.success("\u4FEE\u6539\u5BB9\u5668\u540D\u79F0");case 7:case"end":return C.stop()}},d)}));function a(d){return u.apply(this,arguments)}return a}()},children:e&&e.Name})}),(0,t.jsx)(l.Z.Item,{label:(0,t.jsx)(ce.Z,{title:"\u7F51\u7EDC",help:"\u9ED8\u8BA4\u7F51\u7EDC\u53EA\u652F\u6301\u901A\u8FC7ip\u8BBF\u95EE,ip\u4F1A\u968F\u7740\u5BB9\u5668\u542F\u52A8\u505C\u6B62\u6539\u53D8.\u5982\u679C\u9700\u8981\u5728\u5BB9\u5668\u5185\u4E92\u8054,\u8BF7\u901A\u8FC7\u3010\u7F16\u8F91\u7AD9\u70B9\u3011-\u3010\u6DFB\u52A0\u5173\u8054\u3011"}),children:(e==null?void 0:e.State.Running)&&(0,t.jsxs)(l.Z,{column:1,bordered:!0,children:[e.NetworkSettings.Networks&&Object.keys(e.NetworkSettings.Networks).map(function(u,a){return(0,t.jsx)(l.Z.Item,{label:u,children:u=="host"?" Host \u7F51\u7EDC\uFF0C\u4E0E\u5BBF\u4E3B\u673A\u5171\u7528\u540C\u4E00\u7F51\u7EDC":(0,t.jsxs)(g.Z,{direction:"vertical",children:[(0,t.jsx)(b.Z,{title:e==null?void 0:e.NetworkSettings.Networks[u].IPAddress}),e==null?void 0:e.NetworkSettings.Networks[u].Gateway,e==null?void 0:e.NetworkSettings.Networks[u].MacAddress]})},"1")}),e.HostConfig.ExtraHosts&&(0,t.jsx)(l.Z.Item,{label:"\u5BBF\u4E3B\u673A\u7F51\u7EDC",children:(0,t.jsx)(g.Z,{direction:"vertical",children:e.HostConfig.ExtraHosts.map(function(u){if(u.indexOf(":")>-1){var a=u.split(":");return(0,t.jsxs)(g.Z,{children:[(0,t.jsx)(b.Z,{title:a[0]})," - ",a[1]]})}})})},"1")]})}),(0,t.jsx)(l.Z.Item,{label:"\u72B6\u6001",children:e==null?void 0:e.State.Status}),(0,t.jsx)(l.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:new Date((D=e==null?void 0:e.Created)!==null&&D!==void 0?D:"").toLocaleString()}),(0,t.jsx)(l.Z.Item,{label:"\u542F\u52A8\u65F6\u95F4",children:new Date((k=e==null?void 0:e.State.StartedAt)!==null&&k!==void 0?k:"").toLocaleString()}),(0,t.jsx)(l.Z.Item,{label:"\u91CD\u542F\u7B56\u7565",children:(0,t.jsx)(re.A,{onFinish:function(){var u=y()(m()().mark(function a(d){var o;return m()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(e!=null&&e.Id){F.next=2;break}return F.abrupt("return");case 2:return F.next=4,(0,x.eE)({md5:e.Id,restart:d.restart});case 4:return o=F.sent,h.success("\u4FEE\u6539\u91CD\u542F\u7B56\u7565\u6210\u529F"),F.abrupt("return");case 7:case"end":return F.stop()}},a)}));return function(a){return u.apply(this,arguments)}}(),formRef:Fe,children:(0,t.jsx)(fe.Z,{defaultValue:e==null?void 0:e.HostConfig.RestartPolicy.Name})})})]})}),e&&e.Mounts&&e.Mounts.length>0&&(0,t.jsx)(M.Z,{title:(0,t.jsx)(be.Z,{}),subTitle:"\u6301\u4E45\u5B58\u50A8\u8BE6\u60C5",ghost:!0,children:(0,t.jsx)(l.Z,{column:1,bordered:!0,children:e==null?void 0:e.Mounts.map(function(u,a){return(0,t.jsx)(l.Z.Item,{labelStyle:{width:"30%"},label:u.Type=="volume"?(0,t.jsx)(ke.Z,{content:u.Name}):u.Source,children:(0,t.jsxs)(H.Link,{target:"_blank",to:"/app/detail/file/".concat(e.Id,"?tab=file&path=").concat(encodeURIComponent(u.Destination)),children:[u.Destination," ",(0,t.jsx)(Te.Z,{})]})},a)})})}),(0,t.jsx)(M.Z,{title:(0,t.jsx)(ue.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",ghost:!0,children:(0,t.jsxs)(l.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,t.jsx)(l.Z.Item,{label:"Image Tag",children:(0,t.jsx)(H.Link,{target:"_blank",to:"/image/detail/"+(e==null?void 0:e.Image),children:e==null?void 0:e.Config.Image})}),(0,t.jsx)(l.Z.Item,{label:"Image",children:e==null?void 0:e.Image}),(0,t.jsx)(l.Z.Item,{label:"Port",children:(0,t.jsx)(g.Z,{direction:"vertical",children:(e==null?void 0:e.NetworkSettings.Ports)&&Object.keys(e.NetworkSettings.Ports).map(function(u){var a,d=(a=e==null?void 0:e.NetworkSettings.Ports[u])!==null&&a!==void 0?a:[{HostPort:null,HostIp:""}];return d.map(function(o){var s=st;return s!=""&&s.indexOf(":")>-1&&(s="[".concat(s,"]")),s==""&&o.HostIp=="::"&&(s="[::1]"),s==""&&o.HostIp=="0.0.0.0"&&(s="127.0.0.1"),s==""&&(s=o.HostIp),(0,t.jsxs)(g.Z.Compact,{children:[(0,t.jsxs)(O.Z,{color:o.HostPort?"success":"",children:[o.HostPort?"".concat(o.HostIp,":").concat(o.HostPort," ->"):"",u]},u),o.HostPort?(0,t.jsx)("a",{href:"http://".concat(s,":").concat(o.HostPort),target:"_blank",children:(0,t.jsx)(de.Z,{})}):""]})})})})}),(0,t.jsx)(l.Z.Item,{label:"CMD",children:(e==null?void 0:e.Config.Cmd)&&(e==null?void 0:e.Config.Cmd.join(" "))}),(0,t.jsx)(l.Z.Item,{label:"ENTRYPOINT",children:e==null?void 0:e.Config.Entrypoint}),(0,t.jsx)(l.Z.Item,{label:"ENV",children:(0,t.jsx)(l.Z,{column:1,bordered:!0,children:(e==null?void 0:e.Config.Env)&&e.Config.Env.map(function(u,a){var d=u.split("=");return(0,t.jsx)(l.Z.Item,{label:d[0],children:(0,t.jsx)(ke.Z,{content:d.slice(1).join("=")})},a)})})}),(0,t.jsx)(l.Z.Item,{label:"Labels",children:(0,t.jsx)(l.Z,{column:1,bordered:!0,children:e&&Object.keys(e.Config.Labels).map(function(u){return(0,t.jsx)(l.Z.Item,{label:u,children:(0,t.jsx)(R.Z.Text,{style:{width:"400px"},ellipsis:{tooltip:e.Config.Labels[u]},children:e.Config.Labels[u]})},u)})})})]})}),(e==null?void 0:e.Name)&&(0,t.jsx)(me,{containerName:(Z=e==null?void 0:e.Name)!==null&&Z!==void 0?Z:"",ref:Ue})]})]})}},50070:function(Ze,U,n){n.r(U),n.d(U,{AppDetailContext:function(){return x},default:function(){return ce}});var z=n(15009),m=n.n(z),J=n(99289),y=n.n(J),W=n(5574),I=n.n(W),Y=n(24963),de=n(2831),Be=n(60335),M=n(41123),$=n(54006),g=n(86738),R=n(25593),De=n(50136),i=n(67294),c=n(85893),x=(0,i.createContext)({});function ce(){var t,ve=(0,i.useContext)(Y.Z),me=ve.lang,fe=ve.loading,b=(0,$.useParams)(),Se=(0,$.useSearchParams)(),ne=I()(Se,2),he=ne[0],Pe=ne[1],ye=(t=he.get("tab"))!==null&&t!==void 0?t:"edit",Ae=(0,i.useState)("edit"),pe=I()(Ae,2),ge=pe[0],ae=pe[1],X=(0,$.useNavigate)(),Re=(0,i.useState)(1),xe=I()(Re,2),je=xe[0],be=xe[1],Te=(0,$.useAccess)(),ue=[{label:(0,c.jsx)($.Link,{to:"/app/detail/edit/".concat(b.id,"?tab=edit"),children:"\u5BB9\u5668\u8BE6\u60C5"}),key:"edit"},{label:(0,c.jsx)($.Link,{to:"/app/detail/domain/".concat(b.id,"?tab=domain"),children:"\u57DF\u540D\u7BA1\u7406"}),key:"domain"},{label:(0,c.jsx)(g.Z,{style:{width:500},title:me("notification.title.tip"),description:me("app.detail.createExplorerPlugin"),onConfirm:function(){X("/app/detail/file/".concat(b.id,"?tab=file")),Q(ue.filter(function(T){return T.key!="fileConfirm"})),ae("file")},okText:"Yes",cancelText:"No",children:(0,c.jsx)(R.Z.Link,{children:"\u6587\u4EF6\u7BA1\u7406"})}),key:"fileConfirm"},{label:(0,c.jsx)(R.Z.Link,{children:"\u6587\u4EF6\u7BA1\u7406"}),key:"file",onClick:function(){X("/app/detail/file/".concat(b.id,"?tab=file"))}},{label:(0,c.jsx)(R.Z.Link,{children:"\u8FD0\u884C\u65E5\u5FD7"}),key:"log",onClick:function(){X("/app/detail/log/".concat(b.id,"?tab=log"))}},{label:(0,c.jsx)(R.Z.Link,{children:"\u8FD0\u884C\u72B6\u6001"}),key:"stat",onClick:function(){X("/app/detail/stat/".concat(b.id,"?tab=stat"))}},{label:"",key:"containerName",icon:(0,c.jsx)(M.Z,{}),disabled:!0}],re=(0,i.useState)(ue),le=I()(re,2),H=le[0],Q=le[1];(0,i.useEffect)(function(){fe.show(),ae(ye);var K=function(){var T=y()(m()().mark(function Ee(){var l,O,ie,_;return m()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return O=ue,V.next=3,(0,de.aF)();case 3:return ie=V.sent,Te.canSeeContainerDomain||(O=O.filter(function(j){return j.key!="domain"})),ie.data.plugin.explorer.isCreated||(O=O.filter(function(j){return j.key!="file"})),ie.data.plugin.explorer.isCreated&&(O=O.filter(function(j){return j.key!="fileConfirm"})),V.next=9,(0,Be.jV)({md5:(l=b.id)!==null&&l!==void 0?l:""});case 9:_=V.sent,O.map(function(j){return j.key=="containerName"&&(j.label=_.data.info.Name),(!_.data.info.State.Running||_.data.info.State.Restarting)&&(j.key=="file"||j.key=="fileConfirm"||j.key=="stat")&&(j.disabled=!0),j}),Q(O),fe.destroy();case 13:case"end":return V.stop()}},Ee)}));return function(){return T.apply(this,arguments)}}();K()},[je]);var q=function(T){T.key!="fileConfirm"&&ae(T.key)};return(0,c.jsxs)(x.Provider,{value:{reload:function(){be(je+1)}},children:[(0,c.jsx)(De.Z,{mode:"horizontal",onClick:q,selectedKeys:[ge],items:H}),(0,c.jsx)($.Outlet,{})]})}}}]);
