"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8914],{80271:function(pe,ne,t){var te=t(15009),x=t.n(te),re=t(99289),v=t.n(re),ae=t(5574),D=t.n(ae),se=t(184),U=t(9773),oe=t(83062),I=t(67294),d=t(68536),Q=t(5251),H=t(81366),b=t(3616),V=t(36146),A=t(73813),l=t(85893),O=(0,I.forwardRef)(function(g,W){(0,I.useImperativeHandle)(W,function(){return{show:function(){}}});var S=(0,I.useState)(""),ue=D()(S,2),M=ue[0],B=ue[1],o=(0,I.useState)(!1),me=D()(o,2),i=me[0],ie=me[1],ce=(0,I.useRef)(),fe=(0,I.useRef)(),ve=function(j,m){B(m)},Z=new V.Uo("components.explorer"),he=new V.Uo("image");return(0,l.jsx)(se.a,{drawerProps:{width:b.R_},open:i,submitter:!1,title:he.format("fileTitle"),onOpenChange:function(j){ie(j),B(j?"/":"")},trigger:(0,l.jsx)(oe.Z,{title:he.format("fileTitle"),children:g.trigger}),children:(0,l.jsx)(U.Z,{headerTitle:(0,l.jsx)(H.Z,{ref:fe,showPath:ve}),scroll:{x:"max-content"},search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},actionRef:ce,request:v()(x()().mark(function T(){var j;return x()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(M!=""){c.next=2;break}return c.abrupt("return",{data:[],total:0,success:!0});case 2:return c.next=4,(0,A.cD)({md5:g.imageId,path:M});case 4:return j=c.sent,c.abrupt("return",{data:j.data.info,total:j.data.info.length,success:!0});case 6:case"end":return c.stop()}},T)})),columns:[{title:Z.format("listName"),dataIndex:"showName",key:"name",render:function(n,m,c,y,L){var n,Y=m.name.replace(M,"");return m.isDir?n=(0,l.jsx)(d.Z,{isDir:!0,onClick:function(){return ve(Y,m.path)},showName:Y}):m.isSymlink?n=(0,l.jsx)(d.Z,{isLink:!0,showName:Y}):n=(0,l.jsx)(d.Z,{showName:Y}),n}},{title:Z.format("listModStr"),dataIndex:"modStr",key:"modStr"},{title:Z.format("listUser"),dataIndex:"user"},{title:Z.format("listGroup"),dataIndex:"group"},{title:Z.format("listSize"),dataIndex:"size",key:"size",render:function(j,m,c,y,L){return(0,Q.FI)(m.size)}},{title:Z.format("listModTime"),dataIndex:"modTime",key:"modTime",render:function(j,m,c,y,L){return(0,Q.NF)(m.modTime)},sorter:function(j,m){return new Date(j.modTime).getTime()-new Date(m.modTime).getTime()}}],cardProps:{ghost:!0}},"".concat(g.imageId,"-").concat(M))})});ne.Z=O},78914:function(pe,ne,t){t.d(ne,{Z:function(){return ye}});var te=t(5574),x=t.n(te),re=t(15009),v=t.n(re),ae=t(99289),D=t.n(ae),se=t(80271),U=t(73813),oe=t(43425),I=t(95591),d=t(64789),Q=t(40666),H=t(1912),b=t(77171),V=t(82061),A=t(1883),l=t(38345),O=t(89359),g=t(82346),W=t(42075),S=t(83622),ue=t(96074),M=t(66309),B=t(25593),o=t(26412),me=t(60940),i=t(67294),ie=t(80821),ce=t(5251),fe=t(184),ve=t(97269),Z=t(62370),he=t(25278),T=t(2487),j=t(4393),m=t(65913),c=t(3616),y=t(36146),L=t(68297),n=t(85893),Y=(0,i.forwardRef)(function(K,X){(0,i.useImperativeHandle)(X,function(){return{show:function(f){return D()(v()().mark(function G(){var q,ee;return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return E(!0),(q=k.current)===null||q===void 0||q.show(),r.prev=2,r.next=5,(0,L.aw)({imageName:f}).finally(function(){var s;(s=k.current)===null||s===void 0||s.destroy()});case 5:ee=r.sent,$(ee.data.list),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(2),E(!1);case 12:case"end":return r.stop()}},G,null,[[2,9]])}))()}}});var w=(0,i.useState)(),F=x()(w,2),u=F[0],$=F[1],C=(0,i.useState)(""),z=x()(C,2),P=z[0],e=z[1],N=(0,i.useState)(!1),J=x()(N,2),le=J[0],E=J[1],k=(0,i.useRef)(),de=new y.Uo("image");return(0,n.jsx)(fe.a,{open:le,onOpenChange:function(f){E(f),!f&&$(void 0)},title:de.format("remoteTagTitle"),isKeyPressSubmit:!0,submitter:!1,drawerProps:{width:c.R_,extra:(0,n.jsx)(ve.A,{isKeyPressSubmit:!0,onFinish:function(f){e(f.search)},submitter:!1,children:(0,n.jsx)(W.Z.Compact,{children:(0,n.jsx)(Z.Z,{style:{margin:0},name:"search",children:(0,n.jsx)(he.Z,{allowClear:!0,addonBefore:de.format("remoteSearch"),placeholder:de.format("remoteSearchEmpty"),onClear:function(){e("")}})})})})},children:(0,n.jsx)(m.Z,{ref:k,children:(0,n.jsx)(T.Z,{rowKey:function(f){return"".concat(f)},pagination:{pageSize:50},grid:{gutter:10,column:2},dataSource:u&&u.filter(function(R){return!P||R.toLocaleLowerCase().indexOf(P.toLocaleLowerCase())!==-1}),loading:!u||(u==null?void 0:u.length)<=0,renderItem:function(f,G){return(0,n.jsx)(T.Z.Item,{children:(0,n.jsx)(j.Z,{style:{height:"80px"},children:(0,n.jsx)(B.Z.Text,{copyable:!0,children:f})})},G)}})})},"form")}),Te=Y,Ce=t(5966),Pe=t(2205);function De(K){var X=(0,i.useRef)(),w=(0,i.useState)(!1),F=x()(w,2),u=F[0],$=F[1],C=new y.Uo("image");return(0,n.jsxs)(fe.a,{drawerProps:{width:c.R_},open:u,title:C.format("tagTitle"),onOpenChange:function(P){var e;$(P),!P&&((e=X.current)===null||e===void 0||e.resetFields())},formRef:X,onFinish:function(){var z=D()(v()().mark(function P(e){var N,J;return v()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,L.Qd)({md5:(N=K.imageInfo.info.Id)!==null&&N!==void 0?N:"",tag:(e.imageRegistry?e.imageRegistry.serverAddress+"/":"")+e.imageTag});case 2:return J=E.sent,$(!1),K.onFinish&&K.onFinish(),E.abrupt("return",!0);case 6:case"end":return E.stop()}},P)}));return function(P){return z.apply(this,arguments)}}(),trigger:(0,n.jsx)(S.ZP,{icon:(0,n.jsx)(d.Z,{}),children:C.format("tagTitle")}),children:[(0,n.jsx)(Z.Z,{label:C.format("tagRegistry"),name:"imageRegistry",tooltip:C.format("tagRegistryTip"),children:(0,n.jsx)(Pe.Z,{})}),(0,n.jsx)(Ce.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],required:!0,placeholder:C.format("tagImageTagEmpty"),label:C.format("tagImageTag"),name:"imageTag",tooltip:C.format("tagImageTagTip")})]})}var Ie=t(24963),_e=t(1699),Oe=t(78451),Re=t(27166),Ze=(0,i.forwardRef)(function(K,X){var w;(0,i.useImperativeHandle)(X,function(){return{show:function(s){return D()(v()().mark(function a(){return v()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return k(!0),h.next=3,xe(s);case 3:case"end":return h.stop()}},a)}))()}}});var F=(0,g.useAccess)(),u=new y.Uo("components.image"),$=(0,i.useContext)(Ie.Z),C=$.message,z=(0,i.useState)(),P=x()(z,2),e=P[0],N=P[1],J=(0,i.useState)(!1),le=x()(J,2),E=le[0],k=le[1],de=(0,i.useState)(0),R=x()(de,2),f=R[0],G=R[1],q=(0,i.useRef)(),ee=(0,i.useRef)(),xe=function(){var r=D()(v()().mark(function s(a){var p,h;return v()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return(p=ee.current)===null||p===void 0||p.loading(),_.next=3,(0,U.YU)({md5:a,showLayer:!0}).finally(function(){var je;(je=ee.current)===null||je===void 0||je.finish()});case 3:h=_.sent,N(h.data);case 5:case"end":return _.stop()}},s)}));return function(a){return r.apply(this,arguments)}}();return(0,i.useEffect)(function(){e&&xe(e==null?void 0:e.info.Id)},[f]),(0,n.jsxs)(Re.Z,{drawerProps:{width:c.R_},submitter:!1,ref:ee,title:u.format("quickTitle"),open:E,onOpenChange:function(s){k(s),s||K.onClose&&K.onClose()},children:[!F.canSeeEnableCe&&(0,n.jsx)(Te,{ref:q}),(0,n.jsxs)(l.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,n.jsx)(l.Z,{title:(0,n.jsx)(oe.Z,{}),subTitle:u.format("quickDetailManageTitle"),ghost:!0,children:(0,n.jsxs)(W.Z,{children:[(e==null?void 0:e.info)&&(0,n.jsx)(_e.u,{access:"canSeeEnableCe",showProTips:!0,children:function(s){var a=s.canSeeEnableCe;return(0,n.jsx)(se.Z,{trigger:(0,n.jsx)(S.ZP,{disabled:a,icon:(0,n.jsx)(I.Z,{}),children:y.FD.format("listManageFilePath")}),imageId:e.info.Id})}}),(0,n.jsx)(ue.Z,{type:"vertical"}),(e==null?void 0:e.info)&&(0,n.jsx)(De,{imageInfo:e,onFinish:function(){G(f+1)}}),(0,n.jsx)(g.Link,{to:"/app/create/image?imageId="+(e==null?void 0:e.info.RepoTags[0]),children:(0,n.jsx)(S.ZP,{icon:(0,n.jsx)(d.Z,{}),type:"primary",children:y.FD.format("listManageDeploy")})},"create")]})},"manage"),(0,n.jsx)(l.Z,{title:(0,n.jsx)(Q.Z,{}),subTitle:u.format("quickTagTitle"),ghost:!0,children:(0,n.jsx)(O.Rs,{grid:{gutter:40,column:2},headerTitle:!1,metas:{content:{render:function(s,a,p){return(0,n.jsx)(M.Z,{color:"blue",children:(0,n.jsx)(B.Z.Text,{copyable:!0,children:a})},p)}},title:{render:function(s,a,p){return(0,n.jsxs)(W.Z,{children:[(0,n.jsx)(ie.Z,{buttonProps:{icon:(0,n.jsx)(H.Z,{})},action:function(){return(0,L.Ze)({tag:a,type:"push"})},children:"Push"}),(0,n.jsx)(ie.Z,{buttonProps:{icon:(0,n.jsx)(b.Z,{})},action:function(){return(0,L.Ze)({tag:a,type:"pull"})},children:"Pull"}),(0,n.jsx)(_e.u,{access:"canSeeEnableCe",showProTips:!0,showProTipsOffset:[-15,9],children:function(ge){var _=ge.canSeeEnableCe;return(0,n.jsx)(S.ZP,{disabled:_,onClick:function(){var Ee;(Ee=q.current)===null||Ee===void 0||Ee.show(a)},children:u.format("quickRemoteTagButton")})}}),(0,n.jsx)(_e.u,{access:"canSeeImageListManage",children:(0,n.jsx)(ie.Z,{buttonProps:{danger:!0},confirmProps:{showCommonConfirm:!0},action:function(){return(0,L.cV)({tag:a})},onSuccess:function(ge){return G(f+1),!0},children:(0,n.jsx)(V.Z,{})})})]},p)}}},dataSource:e==null?void 0:e.info.RepoTags})}),e&&(0,n.jsx)(l.Z,{title:(0,n.jsx)(A.Z,{}),subTitle:u.format("quickDetail"),ghost:!0,children:(0,n.jsxs)(o.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:[(0,n.jsx)(o.Z.Item,{label:"ID",children:(0,n.jsx)(B.Z.Text,{editable:{tooltip:u.format("quickDetailManageEditNameTip"),onChange:function(){var r=D()(v()().mark(function a(p){var h;return v()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,U.Fj)({tag:e==null?void 0:e.info.RepoTags[0],title:p});case 2:h=_.sent,G(f+1),C.success(y.FD.format("finish"));case 5:case"end":return _.stop()}},a)}));function s(a){return r.apply(this,arguments)}return s}()},children:e==null?void 0:e.info.Id.substring(7,19)})}),(0,n.jsx)(o.Z.Item,{label:"Parent",children:e==null?void 0:e.info.Parent}),(0,n.jsx)(o.Z.Item,{label:"Size",children:(0,ce.FI)((w=e==null?void 0:e.info.Size)!==null&&w!==void 0?w:0)}),(0,n.jsx)(o.Z.Item,{label:"Created",children:e==null?void 0:e.info.Created}),(0,n.jsxs)(o.Z.Item,{label:"Build",children:["Docker ",e==null?void 0:e.info.DockerVersion," ",e==null?void 0:e.info.Os," ",e==null?void 0:e.info.Architecture]}),(0,n.jsx)(o.Z.Item,{label:"Labels",children:(0,n.jsx)(o.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Labels)&&Object.keys(e==null?void 0:e.info.Config.Labels).map(function(r){return(0,n.jsx)(o.Z.Item,{label:r,children:e==null?void 0:e.info.Config.Labels[r]},r)})})})]})}),(0,n.jsx)(l.Z,{title:(0,n.jsx)(A.Z,{}),subTitle:u.format("quickDockerfileTitle"),ghost:!0,children:(0,n.jsxs)(o.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:[(0,n.jsx)(o.Z.Item,{label:"CMD",children:e==null?void 0:e.info.Config.Cmd}),(0,n.jsx)(o.Z.Item,{label:"ENTRYPOINT",children:e==null?void 0:e.info.Config.Entrypoint}),(0,n.jsx)(o.Z.Item,{label:"EXPOSE",children:(e==null?void 0:e.info.Config.ExposedPorts)&&Object.keys(e==null?void 0:e.info.Config.ExposedPorts).map(function(r){return(0,n.jsx)(M.Z,{color:"gray",children:r},r)})}),(0,n.jsx)(o.Z.Item,{label:"VOLUME",children:(e==null?void 0:e.info.Config.Volumes)&&Object.keys(e==null?void 0:e.info.Config.Volumes).map(function(r){return(0,n.jsx)(M.Z,{color:"gray",children:r},r)})}),(0,n.jsx)(o.Z.Item,{label:"Env",children:(0,n.jsx)(o.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Env)&&(e==null?void 0:e.info.Config.Env.map(function(r,s){var a=r.split("=");return(0,n.jsx)(o.Z.Item,{label:a[0],children:a[1]},s)}))})})]})}),(e==null?void 0:e.layer)&&(0,n.jsx)(l.Z,{title:(0,n.jsx)(A.Z,{}),subTitle:"Layers",ghost:!0,children:(0,n.jsx)(me.Z,{rowKey:"CreatedBy",dataSource:e.layer.reverse(),columns:[{title:"Size",key:"size",render:function(s,a,p){return(0,ce.FI)(a.Size)}},{title:"Layer",dataIndex:"CreatedBy",key:"CreatedBy",render:function(s,a,p){return(0,n.jsx)(Oe.Z,{content:a.CreatedBy})}}]})})]})]})}),ye=Ze},2205:function(pe,ne,t){t.d(ne,{Z:function(){return I}});var te=t(97857),x=t.n(te),re=t(5574),v=t.n(re),ae=t(75870),D=t(36146),se=t(34041),U=t(67294),oe=t(85893);function I(d){var Q=(0,U.useState)([]),H=v()(Q,2),b=H[0],V=H[1],A=new D.Uo("components.selectRegistry");(0,U.useEffect)(function(){(0,ae.Ot)().then(function(O){O&&V(O.data.list)})},[]);var l={};return d.multiple&&(l.mode="multiple"),d.top&&(l.placement="topLeft"),(0,oe.jsx)(se.Z,x()({popupMatchSelectWidth:!d.width,style:d.width?{width:d.width}:{},onChange:function(g){if(g)if(Array.isArray(g)){var W=g.map(function(S){return b[S]});d.onChangeList&&d.onChangeList(W)}else d.onChange&&d.onChange(b[g])},placeholder:A.format("nameEmpty"),options:b.map(function(O,g){return{value:g,label:O.title+"("+O.serverAddress+")"}}),allowClear:!0},l))}}}]);
