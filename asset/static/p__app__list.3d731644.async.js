!(function(){var Ct=Object.defineProperty,St=Object.defineProperties;var Ot=Object.getOwnPropertyDescriptors;var ot=Object.getOwnPropertySymbols;var Rt=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable;var ut=(J,I,e)=>I in J?Ct(J,I,{enumerable:!0,configurable:!0,writable:!0,value:e}):J[I]=e,ct=(J,I)=>{for(var e in I||(I={}))Rt.call(I,e)&&ut(J,e,I[e]);if(ot)for(var e of ot(I))yt.call(I,e)&&ut(J,e,I[e]);return J},dt=(J,I)=>St(J,Ot(I));(self.webpackChunk=self.webpackChunk||[]).push([[4316],{26522:function(J,I,e){"use strict";e.d(I,{Z:function(){return O}});var ae=e(87462),b=e(67294),z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"}}]},name:"apartment",theme:"outlined"},f=z,E=e(84089),_=function(t,o){return b.createElement(E.Z,(0,ae.Z)({},t,{ref:o,icon:f}))},L=b.forwardRef(_),O=L},36435:function(J,I,e){"use strict";var ae=e(15009),b=e.n(ae),z=e(64599),f=e.n(z),E=e(99289),_=e.n(E),L=e(9783),O=e.n(L),n=e(5574),t=e.n(n),o=e(67294),a=e(184),c=e(38345),d=e(97269),h=e(97321),g=e(97462),y=e(64317),w=e(5966),H=e(86615),X=e(68602),G=e(83622),K=e(83403),Y=e(24963),ie=e(1699),Z=e(29177),D=e(1883),W=e(43425),le=e(44349),m=e(3616),Pe=e(36146),k=e(85893),Be=(0,o.forwardRef)(function(de,pe){var fe=(0,o.useState)(!1),N=t()(fe,2),Ee=N[0],Se=N[1],me=(0,o.useRef)(),ge=(0,o.useContext)(Y.Z),s=ge.message,Fe=(0,o.useState)([]),Ae=t()(Fe,2),Le=Ae[0],te=Ae[1],q=new Pe.Uo("components.permissionButton"),We=O()(O()(O()(O()(O()({},K.W6.CONTAINER,"Id"),K.W6.APPSTORE,"name"),K.W6.COMPOSE,"name"),K.W6.REGISTRY,"serverAddress"),K.W6.DOCKER_ENV,"name"),Ke=O()(O()(O()(O()(O()({},K.W6.CONTAINER,"name"),K.W6.APPSTORE,"name"),K.W6.COMPOSE,"name"),K.W6.REGISTRY,"title"),K.W6.DOCKER_ENV,"title"),Ue=We[de.type],ke=Ke[de.type],$e=de.selected.map(function(x){return x[We[de.type]]});return o.useEffect(function(){if(Ee){if(!de.selected||de.selected.length==0){s.error(Pe.FD.format("message.noDataSelect")),Se(!1);return}(0,X.dP)({permission:{uri:de.type,key:Ue,value:$e}}).then(function(x){var A;(A=me.current)===null||A===void 0||A.setFieldValue("list",Object.keys(x.data.list).map(function(B){return{name:B,type:x.data.list[B].type,users:x.data.list[B].users}}))}),(0,X.lE)().then(function(x){var A,B=(A=x.data)===null||A===void 0||(A=A.list)===null||A===void 0?void 0:A.map(function(F){return{label:F.username,value:F.username}});te(B)})}},[Ee]),(0,k.jsx)(ie.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,k.jsxs)(a.a,{name:"create",title:q.format("drawerTitle"),open:Ee,onOpenChange:function(A){if(!A){var B;(B=me.current)===null||B===void 0||B.resetFields()}Se(A)},drawerProps:{forceRender:!0,width:m.R_},formRef:me,trigger:(0,k.jsx)(G.ZP,{icon:(0,k.jsx)(Z.Z,{}),children:q.format("drawerTriggerButton")}),onFinish:function(){var x=_()(b()().mark(function A(B){var F,V,p;return b()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:F=f()(B.list),U.prev=1,F.s();case 3:if((V=F.n()).done){U.next=9;break}return p=V.value,U.next=7,(0,X.Db)({usernames:p.users,permissionType:p.type,permission:{uri:de.type,key:Ue,showKey:ke,value:[p.name]}});case 7:U.next=3;break;case 9:U.next=14;break;case 11:U.prev=11,U.t0=U.catch(1),F.e(U.t0);case 14:return U.prev=14,F.f(),U.finish(14);case 17:s.success(Pe.FD.format("finish")),Se(!1),de.onSuccess();case 20:case"end":return U.stop()}},A,null,[[1,11,14,17]])}));return function(A){return x.apply(this,arguments)}}(),children:[(0,k.jsxs)(c.Z,{ghost:!0,title:(0,k.jsx)(D.Z,{}),subTitle:q.format("batchTitle"),children:[(0,k.jsx)(d.A.Item,{name:"type",style:{marginBottom:0},children:(0,k.jsx)(h.Z.Group,{defaultValue:"admin",onChange:function(A){var B,F,V=(B=me.current)===null||B===void 0?void 0:B.getFieldValue("list");V.forEach(function(p){p.type=A,p.users=[]}),(F=me.current)===null||F===void 0||F.setFieldValue("list",V)},children:["admin","restricted","public"].map(function(x){return(0,k.jsx)(h.Z,{style:{width:240},title:q.format("dataTypeOption.".concat(x)),description:q.format("dataTypeOptionDesc.".concat(x)),value:x},x)})})}),(0,k.jsx)(g.Z,{name:["type"],children:function(A){var B=A.type;if(B==="restricted")return(0,k.jsx)(y.Z,{mode:"multiple",name:"usernames",label:q.format("formUsernames"),onChange:function(V){var p,oe,U=(p=me.current)===null||p===void 0?void 0:p.getFieldValue("list");U.forEach(function(ue){ue.users=V}),(oe=me.current)===null||oe===void 0||oe.setFieldValue("list",U)},rules:[{required:!0}],request:_()(b()().mark(function F(){var V,p,oe;return b()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(!(Le.length>0)){ue.next=2;break}return ue.abrupt("return",Le);case 2:return ue.next=4,(0,X.lE)();case 4:return p=ue.sent,oe=(V=p.data)===null||V===void 0||(V=V.list)===null||V===void 0?void 0:V.map(function(Ze){return{label:Ze.username,value:Ze.username}}),te(oe),ue.abrupt("return",oe);case 8:case"end":return ue.stop()}},F)}))})}})]}),(0,k.jsx)(c.Z,{ghost:!0,title:(0,k.jsx)(W.Z,{}),subTitle:q.format("dataTitle"),children:(0,k.jsx)(le.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:q.format("dataName"),render:function(A,B,F){var V=F.getCurrentRowData();return(0,k.jsx)(w.Z,{disabled:!0,label:q.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:q.format("dataType"),render:function(A,B,F){var V=F.getCurrentRowData();return(0,k.jsx)(H.Z.Group,{label:q.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(p){return{label:q.format("dataTypeOption.".concat(p)),value:p}})})}},{name:"users",label:q.format("dataUsers"),render:function(A,B,F){return(0,k.jsx)(g.Z,{name:["type"],children:function(p){var oe=p.type;if(oe=="restricted")return(0,k.jsx)(y.Z,{width:"sm",mode:"tags",name:"users",label:q.format("dataUsers"),options:Le})}})}}]})})]})})});I.Z=Be},14668:function(J,I,e){"use strict";e.r(I),e.d(I,{default:function(){return ht}});var ae=e(64599),b=e.n(ae),z=e(15009),f=e.n(z),E=e(19632),_=e.n(E),L=e(99289),O=e.n(L),n=e(5574),t=e.n(n),o=e(90078),a=e(83622),c=e(34041),d=e(56729),h=e(97269),g=e(62370),y=e(42075),w=e(25593),H=e(40411),X=e(96074),G=e(83062),K=e(84567),Y=e(50136),ie=e(82346),Z=e(1883),D=e(89035),W=e(95591),le=e(86548),m=e(74842),Pe=e(87784),k=e(33160),Be=e(30159),de=e(94359),pe=e(13822),fe=e(80821),N=e(67294),Ee=e(62597),Se=e(87662),me=e(16165),ge=e(5251),s=e(85893),Fe=function(){return(0,s.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"18403",children:(0,s.jsx)("path",{d:"M224 192v64H96v576h128v64h64v-64h64v64h64v-64h64v64h64v-64h64v64h64v-64h64v64h64v-64h128V256h-128V192h-64v64h-64V192h-64v64h-64V192h-64v64h-64V192h-64v64H288V192z m-64 128h704v448H160z m96 64c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32zM256 512c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m512 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32zM256 640c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z","p-id":"18404"})})},Ae=function(){return(0,s.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"18546",children:(0,s.jsx)("path",{d:"M64 224v576h416v-32c0-17.76 14.24-32 32-32 17.76 0 32 14.24 32 32v32h416V224z m64 64h768v288H128z m64 64v160h192v-160z m224 0v160h192v-160z m224 0v160h192v-160zM256 416h64v32H256z m224 0h64v32h-64z m224 0h64v32h-64zM128 640h768v96h-300.992c-14.144-35.52-42.752-64-83.008-64-40.256 0-68.864 28.48-83.008 64H128z","p-id":"18547"})})};function Le(ne){var be,$,Te,Oe,Ie,we;return(0,s.jsx)(s.Fragment,{children:ne.value&&ne.value.memory&&ne.value.memory.out>0?(0,s.jsxs)(y.Z,{children:[(0,s.jsxs)(G.Z,{title:"Cpu: ".concat((be=ne.value)===null||be===void 0?void 0:be.cpu.toFixed(2),"%"),children:[(0,s.jsx)(me.Z,{component:Fe,style:{width:15,lineHeight:20}})," ","".concat(($=ne.value)===null||$===void 0?void 0:$.cpu.toFixed(2),"%")]}),(0,s.jsxs)(G.Z,{title:"Memory: ".concat((0,ge.FI)((Te=ne.value)===null||Te===void 0?void 0:Te.memory.in)," / ").concat((0,ge.FI)((Oe=ne.value)===null||Oe===void 0?void 0:Oe.memory.out)),children:[(0,s.jsx)(me.Z,{component:Ae,style:{width:15,lineHeight:20}})," ","".concat((((Ie=ne.value)===null||Ie===void 0?void 0:Ie.memory.in)/((we=ne.value)===null||we===void 0?void 0:we.memory.out)*100).toFixed(2),"%")]})]}):""})}var te=e(67255),q=e(37413),We=e(46357),Ke=e(99922),Ue=e(83403),ke=e(20578),$e=e(99861),x=e(78914),A=e(29453),B=e(8287),F=e(93362),V=e(78451),p=e(36146),oe=e(36435),U=e(1699),ue=e(96486),Ze=e.n(ue),De=e(55375);function ht(){var ne=(0,ie.useLocation)(),be=(0,ie.useAccess)(),$=(0,N.useRef)(),Te=(0,N.useState)(""),Oe=t()(Te,2),Ie=Oe[0],we=Oe[1],ft=(0,N.useState)(1),Ye=t()(ft,2),he=Ye[0],ve=Ye[1],mt=(0,N.useState)([]),Qe=t()(mt,2),Re=Qe[0],vt=Qe[1],pt=(0,N.useState)(),Je=t()(pt,2),ye=Je[0],_t=Je[1],gt=(0,N.useState)([]),Xe=t()(gt,2),qe=Xe[0],Dt=Xe[1],et=(0,N.useRef)(),tt=(0,N.useRef)(),rt=(0,N.useRef)(),nt=(0,N.useRef)(),st=(0,N.useRef)(),ze=(0,N.useRef)(),at=(0,N.useRef)(),Ne=new p.Uo("components.appDetail.appDetailQuickManage");return(0,N.useEffect)(function(){(0,Se.K3)().then(function(P){var C;we((C=P.data.serverUrl)!==null&&C!==void 0?C:"")}),!be.canSeeEnableCe&&(0,ke.q)().then(function(P){_t(P.data)})},[]),(0,N.useEffect)(function(){var P;!((P=$.current)===null||P===void 0)&&P.reloadAndRest&&$.current.reloadAndRest().then(function(){var C,u;!((C=$.current)===null||C===void 0)&&C.setPageInfo&&$.current.setPageInfo({current:(0,te.G$)(De.Dc,(u=$.current)===null||u===void 0?void 0:u.pageInfo)})})},[he]),(0,N.useEffect)(function(){var P,C;ne.state&&!((P=$.current)===null||P===void 0)&&P.setPageInfo&&$.current.setPageInfo({current:(0,te.G$)(De.Dc,(C=$.current)===null||C===void 0?void 0:C.pageInfo)})},[ne.state,$.current]),(0,s.jsxs)(o._z,{header:{extra:[(0,s.jsx)(U.u,{access:"canSeeContainerListManageCreate",children:(0,s.jsx)(ie.Link,{to:"/app/create/image",children:(0,s.jsx)(a.ZP,{type:"primary",children:p.Ob.format("container.create")})})},"create")]},children:[(0,s.jsx)(We.Z,{ref:et,onFinish:function(){ve(he+1)},onUpgradeFinish:function(){ve(he+1)}}),(0,s.jsx)(Ke.Z,{showFileExplorer:!0,ref:tt}),(0,s.jsx)(B.Z,{ref:rt}),(0,s.jsx)($e.Z,{ref:ze,finishAutoHide:!0}),(0,s.jsx)(x.Z,{ref:at}),(0,s.jsx)(F.Z,{showConsole:!0,ref:nt}),(0,s.jsx)(d.Z,{sticky:{offsetHeader:64,offsetScroll:5},actionRef:$,onRow:function(C){return{onContextMenu:function(){console.log(C)}}},scroll:{x:"max-content"},onChange:function(C,u,T){!Ze().isArray(T)&&(0,te.LX)(De.Dc,T.columnKey,T.order),(0,te.MJ)(De.Dc,C.current)},columns:[{key:"title",title:p.FD.format("listTitle"),width:300,dataIndex:"siteTitle",sorter:function(C,u){return C.Names[0].localeCompare(u.Names[0])},defaultSortOrder:(0,te.rj)(De.Dc,"title"),sortDirections:te.h5,render:function(C,u,T,j,i){var l=(0,ge.fi)(u.Names[0],"/");return(0,s.jsxs)(y.Z,{direction:"vertical",children:[(0,s.jsx)(w.Z.Link,{onClick:function(){var S;(S=et.current)===null||S===void 0||S.show(u.Id)},children:(0,s.jsx)(V.Z,{content:l})}),!be.canSeeEnableCe&&ye&&ye.container&&ye.container.find(function(v){return v.id==u.Id})&&(0,s.jsx)(H.Z,{count:"new"})]})}},{title:p.FD.format("listTag"),hidden:!0,dataIndex:"tag",renderFormItem:function(C,u,T,j){return(0,s.jsx)(c.Z,{onSelect:function(l){T.submit()},onDeselect:function(){T.submit()},mode:"multiple",popupMatchSelectWidth:!1,options:qe&&Object.entries(qe.reduce(function(i,l){var v=l.group||"tag";return i[v]||(i[v]=[]),i[v].push(l),i},{})).map(function(i){var l=t()(i,2),v=l[0],S=l[1];return{label:v,title:v,options:S.map(function(Q){return{label:Q.tag,value:Q.tag}})}})})}},{key:"ports",title:p.FD.format("listAccess"),tooltip:p.FD.format("listAccessTip"),width:150,dataIndex:"ports",search:!1,render:function(C,u,T,j){var i,l=[],v=[];return u!=null&&u.Ports&&u.Ports.map(function(S,Q){S.PublicPort?l.push(S):v.push(S)}),(0,s.jsx)(q.Z,{publicPort:l,privatePort:v,domain:(i=u.DPExtend)===null||i===void 0?void 0:i.domainList,serverIp:Ie})}},{title:p.FD.format("listUsage"),width:200,search:!1,key:"usage",sorter:function(C,u){var T={},j={};if(Re){var i,l;T=(i=Re.find(function(v){return C.Id.startsWith(v.container)}))!==null&&i!==void 0?i:{},j=(l=Re.find(function(v){return u.Id.startsWith(v.container)}))!==null&&l!==void 0?l:{}}return JSON.stringify(T).localeCompare(JSON.stringify(j))},defaultSortOrder:(0,te.rj)(De.Dc,"usage"),sortDirections:te.h5,render:function(C,u,T,j,i){if(!Re||Re.length<=0)return"";var l={};return Re.filter(function(v){u.Id.indexOf(v.container)==0&&(l=v)}),(0,s.jsx)(Le,{value:l})}},{title:p.FD.format("listRunStatus"),key:"status",dataIndex:["container","status"],search:!1,width:130,render:function(C,u,T,j){var i="",l={};if(u.State.includes("(")){var v=u.State.indexOf("(");v>-1&&(i="compose.".concat(u.State.slice(0,v))),l={count:u.State.slice(v+1,u.State.length-1)}}else i="container.".concat(u.State),u.Status.indexOf("(healthy)")>-1?i="container.healthy":u.Status.indexOf("(unhealthy)")>-1&&(i="container.unhealthy");return(0,s.jsx)(de.Z,{statusValue:l,status:i,tip:"".concat(u.State," ").concat(u.Status)})}},{title:p.FD.format("listImageName"),key:"image",search:!1,width:150,render:function(C,u,T,j){return(0,s.jsx)("span",{style:{wordBreak:"break-word"},children:(0,s.jsx)(w.Z.Link,{onClick:function(){var l;(l=at.current)===null||l===void 0||l.show(u.Image)},children:u.Image})})}},{key:"created",search:!1,title:p.FD.format("listCreatedAt"),width:170,dataIndex:["Created"],render:function(C,u,T,j,i){return(0,ge.ZM)(u.Created*1e3)},sorter:function(C,u){return new Date(C.Created*1e3).toISOString().localeCompare(new Date(u.Created*1e3).toISOString())},defaultSortOrder:(0,te.rj)(De.Dc,"created"),sortDirections:te.h5},{title:p.FD.format("listManage"),valueType:"option",key:"option",width:200,fixed:"right",hidden:!be.canSeeContainerListManage,render:function(C,u,T,j){return(0,s.jsxs)(y.Z,{split:(0,s.jsx)(X.Z,{type:"vertical"}),children:[(0,s.jsx)(w.Z.Link,{onClick:function(){var l;(l=rt.current)===null||l===void 0||l.show(u.Id)},children:(0,s.jsx)(G.Z,{title:p.FD.format("listManageLog"),children:(0,s.jsx)(Z.Z,{})})},"log"),(u.State=="running"||u.State=="healthy"||u.State=="unhealthy")&&(0,s.jsx)(w.Z.Link,{onClick:function(){var l;(l=tt.current)===null||l===void 0||l.show({url:"/console/container/".concat(u.Id),title:(0,ge.fi)(u.Names[0],"/")})},children:(0,s.jsx)(G.Z,{title:p.FD.format("listManageConsole"),children:(0,s.jsx)(D.Z,{})})},"console"),(u.State=="running"||u.State=="healthy"||u.State=="unhealthy")&&(0,s.jsx)(w.Z.Link,{onClick:function(){var l,v=u.Names.find(function(S){if(S.indexOf("/")===0)return S});(l=nt.current)===null||l===void 0||l.showContainer(v!=null?v:u.Names[0])},children:(0,s.jsx)(G.Z,{title:p.FD.format("listManageFileExplorer"),children:(0,s.jsx)(W.Z,{})})},"file"),(0,s.jsx)(ie.Link,{to:"/app/create/image?id="+u.Id,children:(0,s.jsx)(G.Z,{title:p.FD.format("listManageEdit"),children:(0,s.jsx)(le.Z,{})})},"edit")]})}}],rowKey:"Id",request:function(){var P=O()(f()().mark(function C(u,T,j){var i,l,v,S,Q,r;return f()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,(0,pe.IE)({tag:u.title,siteTitle:u.title,md5:u.Id});case 2:return l=se.sent,v="",S=[],se.next=7,(0,A.e1)({showCompose:!0,showSwarm:!0});case 7:return Q=se.sent,Dt(Q.data.list),r=[],r=l.data.list.map(function(R){var re=l.data.siteList.find(function(ee){return ee.containerInfo&&ee.containerInfo.Id==R.Id&&ee.siteTitle!=""});if(re&&R.Names.unshift(re.siteTitle),R.Labels&&R.Labels[Ee.fu]&&R.Names.unshift(R.Labels[Ee.fu]),R.DPExtend={domainList:l.data.domainList.filter(function(ee,Me){return R.Names.includes(ee.containerId)}).map(function(ee){return ee.setting.enableSSL?"https://"+ee.serverName:"http://"+ee.serverName}),tag:[]},R.Labels&&R.Labels["com.docker.compose.project"]){var ce;(ce=R.DPExtend.tag)===null||ce===void 0||ce.push((0,ge.fi)(R.Labels["com.docker.compose.project"],"dpanel-c-"))}if(R.Labels&&R.Labels["com.docker.swarm.service.name"]){var _e;(_e=R.DPExtend.tag)===null||_e===void 0||_e.push(R.Labels["com.docker.swarm.service.name"])}return Q.data.list.forEach(function(ee){ee.item&&ee.item.forEach(function(Me){if(R.Names.includes(Me.name)&&R.DPExtend){var Ce;(Ce=R.DPExtend.tag)===null||Ce===void 0||Ce.push(ee.tag)}})}),R}),u.tag&&r.forEach(function(R){var re;!((re=R.DPExtend)===null||re===void 0)&&re.tag&&R.DPExtend.tag.forEach(function(ce){u.tag.includes(ce)&&S.push.apply(S,_()(R.Names))})}),v!=""?r=r.filter(function(R){var re=!1;return R.Names.forEach(function(ce){ce.startsWith("/"+v)&&(re=!0)}),re}):S&&S.length>0&&(r=r.filter(function(R){var re=!1;return R.Names.forEach(function(ce){S.includes(ce)&&(re=!0)}),re})),(0,Se.Cz)({follow:!1}).then(function(R){vt(R.data.list)}),se.abrupt("return",{data:(i=r)!==null&&i!==void 0?i:[],success:!0,total:l.data.list.length});case 15:case"end":return se.stop()}},C)}));return function(C,u,T){return P.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(C){var u=C.selectedRowKeys,T=C.selectedRows;return(0,s.jsxs)(y.Z,{size:16,wrap:!0,children:[(0,s.jsx)(oe.Z,{type:Ue.W6.CONTAINER,selected:T!=null?T:[],onSuccess:function(){return ve(he+1),!0}},"dataPermission"),(0,s.jsxs)(U.u,{access:"canSeeContainerList",space:{size:16,wrap:!0},children:[(0,s.jsx)(fe.Z,{icon:(0,s.jsx)(m.Z,{}),action:O()(f()().mark(function j(){var i,l,v,S;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=b()(u),r.prev=1,i.s();case 3:if((l=i.n()).done){r.next=10;break}return v=l.value,r.next=7,(0,pe.IW)({md5:v,operate:"start"});case 7:S=r.sent;case 8:r.next=3;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(1),i.e(r.t0);case 15:return r.prev=15,i.f(),r.finish(15);case 18:return r.abrupt("return",!0);case 19:case"end":return r.stop()}},j,null,[[1,12,15,18]])})),onSuccess:function(){return ve(he+1),!0},children:p.FD.format("listManageStart")}),(0,s.jsx)(fe.Z,{action:O()(f()().mark(function j(){var i,l,v,S;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=b()(u),r.prev=1,i.s();case 3:if((l=i.n()).done){r.next=10;break}return v=l.value,r.next=7,(0,pe.IW)({md5:v,operate:"stop"});case 7:S=r.sent;case 8:r.next=3;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(1),i.e(r.t0);case 15:return r.prev=15,i.f(),r.finish(15);case 18:return r.abrupt("return",!0);case 19:case"end":return r.stop()}},j,null,[[1,12,15,18]])})),icon:(0,s.jsx)(Pe.Z,{}),onSuccess:function(){return ve(he+1),!0},children:p.FD.format("listManageStop")}),(0,s.jsx)(fe.Z,{action:O()(f()().mark(function j(){var i,l,v,S;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=b()(u),r.prev=1,i.s();case 3:if((l=i.n()).done){r.next=10;break}return v=l.value,r.next=7,(0,pe.IW)({md5:v,operate:"restart"});case 7:S=r.sent;case 8:r.next=3;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(1),i.e(r.t0);case 15:return r.prev=15,i.f(),r.finish(15);case 18:return r.abrupt("return",!0);case 19:case"end":return r.stop()}},j,null,[[1,12,15,18]])})),onSuccess:function(){return ve(he+1),!0},icon:(0,s.jsx)(k.Z,{}),children:p.FD.format("listManageRestart")}),(0,s.jsx)(fe.Z,{action:O()(f()().mark(function j(){var i,l,v,S;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=b()(u),r.prev=1,i.s();case 3:if((l=i.n()).done){r.next=10;break}return v=l.value,r.next=7,(0,pe.IW)({md5:v,operate:"pause"});case 7:S=r.sent;case 8:r.next=3;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(1),i.e(r.t0);case 15:return r.prev=15,i.f(),r.finish(15);case 18:return r.abrupt("return",!0);case 19:case"end":return r.stop()}},j,null,[[1,12,15,18]])})),onSuccess:function(){return ve(he+1),!0},icon:(0,s.jsx)(Be.Z,{}),children:p.FD.format("listManagePause")}),(0,s.jsx)(fe.Z,{action:O()(f()().mark(function j(){var i,l,v,S;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=b()(u),r.prev=1,i.s();case 3:if((l=i.n()).done){r.next=10;break}return v=l.value,r.next=7,(0,pe.IW)({md5:v,operate:"unpause"});case 7:S=r.sent;case 8:r.next=3;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(1),i.e(r.t0);case 15:return r.prev=15,i.f(),r.finish(15);case 18:return r.abrupt("return",!0);case 19:case"end":return r.stop()}},j,null,[[1,12,15,18]])})),onSuccess:function(){return ve(he+1),!0},icon:(0,s.jsx)(m.Z,{}),children:p.FD.format("listManageUnpause")})]}),(0,s.jsx)(X.Z,{}),(0,s.jsx)(U.u,{showProTips:!0,access:["canSeeEnableCe","canSeeContainerListManageOp"],children:function(i){var l=i.canSeeEnableCe,v=i.canSeeContainerListManageOp;return v&&(0,s.jsx)(fe.Z,{disabled:l,type:"primary",action:O()(f()().mark(function S(){var Q,r,je,se,R,re,ce,_e,ee,Me,Ce,Ve,it;return f()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(T){M.next=2;break}return M.abrupt("return",!1);case 2:je=[],se=b()(T),M.prev=4,re=f()().mark(function Et(){var He,lt,xe;return f()().wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:lt=R.value,xe=ye==null||(He=ye.container)===null||He===void 0?void 0:He.find(function(bt){return bt.id==lt.Id}),xe&&!je.includes(xe.image)&&je.push(xe.image);case 3:case"end":return Ge.stop()}},Et)}),se.s();case 7:if((R=se.n()).done){M.next=11;break}return M.delegateYield(re(),"t0",9);case 9:M.next=7;break;case 11:M.next=16;break;case 13:M.prev=13,M.t1=M.catch(4),se.e(M.t1);case 16:return M.prev=16,se.f(),M.finish(16);case 19:if(je){M.next=21;break}return M.abrupt("return",!1);case 21:return M.next=23,(Q=ze.current)===null||Q===void 0?void 0:Q.pull(je);case 23:(r=ze.current)===null||r===void 0||r.finish(),_e=b()(T),M.prev=25,_e.s();case 27:if((ee=_e.n()).done){M.next=34;break}return it=ee.value,M.next=31,(0,pe.RF)({md5:(Me=it.Id)!==null&&Me!==void 0?Me:"",imageTag:"",enableBak:(Ce=(Ve=st.current)===null||Ve===void 0?void 0:Ve.getFieldValue("enableBak"))!==null&&Ce!==void 0?Ce:!1});case 31:ce=M.sent;case 32:M.next=27;break;case 34:M.next=39;break;case 36:M.prev=36,M.t2=M.catch(25),_e.e(M.t2);case 39:return M.prev=39,_e.f(),M.finish(39);case 42:return M.abrupt("return",ce);case 43:case"end":return M.stop()}},S,null,[[4,13,16,19],[25,36,39,42]])})),onSuccess:function(){return ve(he+1),!0},confirm:(0,s.jsxs)(y.Z,{style:{width:280,paddingRight:"10px"},direction:"vertical",children:[(0,s.jsx)(w.Z.Text,{children:Ne.format("upgradeConfirm")}),(0,s.jsxs)(h.A,{formRef:st,submitter:!1,layout:"inline",children:[(0,s.jsx)(g.Z,{name:"enableBak",valuePropName:"checked",children:(0,s.jsx)(K.Z,{children:Ne.format("upgradeConfirmEnableBak")})}),(0,s.jsx)(g.Z,{name:"enableForcePull",valuePropName:"checked",children:(0,s.jsx)(K.Z,{children:Ne.format("upgradeConfirmEnableFourcePull")})})]})]}),children:p.FD.format("listManageUpgradeBatch")})}}),(0,s.jsx)(U.u,{access:"canSeeContainerListManageDelete",children:(0,s.jsx)(fe.Z,{danger:!0,type:"primary",action:O()(f()().mark(function j(){var i,l,v,S;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:l=b()(u),r.prev=1,l.s();case 3:if((v=l.n()).done){r.next=12;break}return S=v.value,r.next=7,(0,Ee.Ct)({md5:S,deleteImage:!1,deleteVolume:!1});case 7:return i=r.sent,r.next=10,(0,A.rn)({name:S});case 10:r.next=3;break;case 12:r.next=17;break;case 14:r.prev=14,r.t0=r.catch(1),l.e(r.t0);case 17:return r.prev=17,l.f(),r.finish(17);case 20:return r.abrupt("return",i);case 21:case"end":return r.stop()}},j,null,[[1,14,17,20]])})),onSuccess:function(){var i,l;return!((i=$.current)===null||i===void 0)&&i.reloadAndRest&&((l=$.current)===null||l===void 0||l.reloadAndRest()),!0},onError:function(){var i,l;return!((i=$.current)===null||i===void 0)&&i.reload&&((l=$.current)===null||l===void 0||l.reload()),!0},confirm:"notification.confirm.title",children:p.FD.format("listManageDeleteBatch")})})]})},pagination:(0,te.Oh)(),search:{collapsed:!1},tableExtraRender:function(){return(0,s.jsx)(Y.Z,{mode:"horizontal",selectedKeys:["list"],items:[{label:(0,s.jsx)(ie.Link,{to:"/app/list",replace:!0,children:p.Ob.format("container.list")}),key:"list"},{label:(0,s.jsx)(ie.Link,{to:"/app/list/recycle",replace:!0,children:p.Ob.format("container.list.recycle")}),key:"recycle"}]})},toolBarRender:function(){return[(0,s.jsx)(U.u,{access:"canSeeContainerListManageDelete",children:(0,s.jsx)(fe.Z,{action:function(){return(0,pe.KK)()},onSuccess:function(){return ve(he+1),!0},onError:function(){var u,T;return!((u=$.current)===null||u===void 0)&&u.reset&&((T=$.current)===null||T===void 0||T.reset()),!0},tips:p.FD.format("listManagePruneTip"),confirm:"notification.confirm.title",children:p.FD.format("listManagePrune")})},"clear")]},columnsState:(0,te.j_)(De.Dc)})]})}},62597:function(J,I,e){"use strict";e.d(I,{$G:function(){return n},Ct:function(){return X},Tb:function(){return d},XH:function(){return g},cl:function(){return a},fp:function(){return o},fu:function(){return L},iE:function(){return w},nL:function(){return O},xb:function(){return K},ze:function(){return ie}});var ae=e(15009),b=e.n(ae),z=e(99289),f=e.n(z),E=e(82346),_="com.dpanel.container.description",L="com.dpanel.container.title",O={Nanosecond:1,Microsecond:1e3,Millisecond:1e3*1e3,Second:1e3*1e3*1e3,Minute:60*1e3*1e3*1e3,Hour:3600*1e3*1e3*1e3};function n(D){return t.apply(this,arguments)}function t(){return t=f()(b()().mark(function D(W){return b()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,E.request)("/api/app/site/create-by-image",{method:"POST",data:W}));case 1:case"end":return m.stop()}},D)})),t.apply(this,arguments)}var o={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueRuleRWOnly:4,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192};function a(D){return c.apply(this,arguments)}function c(){return c=f()(b()().mark(function D(W){return b()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,E.request)("/api/app/site/get-list",{method:"POST",data:W}));case 1:case"end":return m.stop()}},D)})),c.apply(this,arguments)}function d(D){return h.apply(this,arguments)}function h(){return h=f()(b()().mark(function D(W){return b()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return W.download=!1,m.next=3,(0,E.request)("/api/app/log/run",{method:"POST",data:W});case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},D)})),h.apply(this,arguments)}function g(D){return y.apply(this,arguments)}function y(){return y=f()(b()().mark(function D(W){return b()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return W.download=!0,m.next=3,(0,E.request)("/api/app/log/run",{method:"POST",data:W,responseType:"blob"});case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},D)})),y.apply(this,arguments)}function w(D){return H.apply(this,arguments)}function H(){return H=f()(b()().mark(function D(W){return b()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return W.id=String(W.id),m.next=3,(0,E.request)("/api/app/site/get-detail",{data:W,method:"POST"});case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},D)})),H.apply(this,arguments)}function X(D){return G.apply(this,arguments)}function G(){return G=f()(b()().mark(function D(W){return b()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,E.request)("/api/app/container/delete",{method:"POST",data:W}));case 1:case"end":return m.stop()}},D)})),G.apply(this,arguments)}function K(D){return Y.apply(this,arguments)}function Y(){return Y=f()(b()().mark(function D(W){return b()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,E.request)("/api/app/site/delete",{method:"POST",data:W}));case 1:case"end":return m.stop()}},D)})),Y.apply(this,arguments)}function ie(D){return Z.apply(this,arguments)}function Z(){return Z=f()(b()().mark(function D(W){return b()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,E.request)("/api/app/container/ignore",{method:"POST",data:W}));case 1:case"end":return m.stop()}},D)})),Z.apply(this,arguments)}},20578:function(J,I,e){"use strict";e.d(I,{q:function(){return _}});var ae=e(15009),b=e.n(ae),z=e(99289),f=e.n(z),E=e(82346);function _(){return L.apply(this,arguments)}function L(){return L=f()(b()().mark(function O(){return b()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,E.request)("/api/pro/container-upgrade/get-all-list",{method:"POST"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},O)})),L.apply(this,arguments)}},75458:function(J){(function(I,e){J.exports=e()})(self,()=>(()=>{"use strict";var I={345:(z,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.runAndSubscribe=f.forwardEvent=f.EventEmitter=void 0,f.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=E=>(this._listeners.push(E),{dispose:()=>{if(!this._disposed){for(let _=0;_<this._listeners.length;_++)if(this._listeners[_]===E)return void this._listeners.splice(_,1)}}})),this._event}fire(E,_){const L=[];for(let O=0;O<this._listeners.length;O++)L.push(this._listeners[O]);for(let O=0;O<L.length;O++)L[O].call(void 0,E,_)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},f.forwardEvent=function(E,_){return E(L=>_.fire(L))},f.runAndSubscribe=function(E,_){return _(void 0),E(L=>_(L))}},859:(z,f)=>{function E(_){for(const L of _)L.dispose();_.length=0}Object.defineProperty(f,"__esModule",{value:!0}),f.getDisposeArrayDisposable=f.disposeArray=f.toDisposable=f.MutableDisposable=f.Disposable=void 0,f.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const _ of this._disposables)_.dispose();this._disposables.length=0}register(_){return this._disposables.push(_),_}unregister(_){const L=this._disposables.indexOf(_);L!==-1&&this._disposables.splice(L,1)}},f.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(_){var L;this._isDisposed||_===this._value||((L=this._value)==null||L.dispose(),this._value=_)}clear(){this.value=void 0}dispose(){var _;this._isDisposed=!0,(_=this._value)==null||_.dispose(),this._value=void 0}},f.toDisposable=function(_){return{dispose:_}},f.disposeArray=E,f.getDisposeArrayDisposable=function(_){return{dispose:()=>E(_)}}}},e={};function ae(z){var f=e[z];if(f!==void 0)return f.exports;var E=e[z]={exports:{}};return I[z](E,E.exports,ae),E.exports}var b={};return(()=>{var z=b;Object.defineProperty(z,"__esModule",{value:!0}),z.SearchAddon=void 0;const f=ae(345),E=ae(859),_=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";class L extends E.Disposable{constructor(n){var t;super(),this._highlightedLines=new Set,this._highlightDecorations=[],this._selectedDecoration=this.register(new E.MutableDisposable),this._linesCacheTimeoutId=0,this._linesCacheDisposables=new E.MutableDisposable,this._onDidChangeResults=this.register(new f.EventEmitter),this.onDidChangeResults=this._onDidChangeResults.event,this._highlightLimit=(t=n==null?void 0:n.highlightLimit)!=null?t:1e3}activate(n){this._terminal=n,this.register(this._terminal.onWriteParsed(()=>this._updateMatches())),this.register(this._terminal.onResize(()=>this._updateMatches())),this.register((0,E.toDisposable)(()=>this.clearDecorations()))}_updateMatches(){var n;this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&((n=this._lastSearchOptions)!=null&&n.decorations)&&(this._highlightTimeout=setTimeout(()=>{const t=this._cachedSearchTerm;this._cachedSearchTerm=void 0,this.findPrevious(t,dt(ct({},this._lastSearchOptions),{incremental:!0,noScroll:!0}))},200))}clearDecorations(n){this._selectedDecoration.clear(),(0,E.disposeArray)(this._highlightDecorations),this._highlightDecorations=[],this._highlightedLines.clear(),n||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){this._selectedDecoration.clear()}findNext(n,t){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");const o=!this._lastSearchOptions||this._didOptionsChange(this._lastSearchOptions,t);this._lastSearchOptions=t,t!=null&&t.decorations&&(this._cachedSearchTerm===void 0||n!==this._cachedSearchTerm||o)&&this._highlightAllMatches(n,t);const a=this._findNextAndSelect(n,t);return this._fireResults(t),this._cachedSearchTerm=n,a}_highlightAllMatches(n,t){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!n||n.length===0)return void this.clearDecorations();t=t||{},this.clearDecorations(!0);const o=[];let a,c=this._find(n,0,0,t);for(;c&&((a==null?void 0:a.row)!==c.row||(a==null?void 0:a.col)!==c.col)&&!(o.length>=this._highlightLimit);)a=c,o.push(a),c=this._find(n,a.col+a.term.length>=this._terminal.cols?a.row+1:a.row,a.col+a.term.length>=this._terminal.cols?0:a.col+1,t);for(const d of o){const h=this._createResultDecoration(d,t.decorations);h&&(this._highlightedLines.add(h.marker.line),this._highlightDecorations.push({decoration:h,match:d,dispose(){h.dispose()}}))}}_find(n,t,o,a){var h;if(!this._terminal||!n||n.length===0)return(h=this._terminal)==null||h.clearSelection(),void this.clearDecorations();if(o>this._terminal.cols)throw new Error(`Invalid col: ${o} to search in terminal of ${this._terminal.cols} cols`);let c;this._initLinesCache();const d={startRow:t,startCol:o};if(c=this._findInLine(n,d,a),!c)for(let g=t+1;g<this._terminal.buffer.active.baseY+this._terminal.rows&&(d.startRow=g,d.startCol=0,c=this._findInLine(n,d,a),!c);g++);return c}_findNextAndSelect(n,t){var g;if(!this._terminal||!n||n.length===0)return(g=this._terminal)==null||g.clearSelection(),this.clearDecorations(),!1;const o=this._terminal.getSelectionPosition();this._terminal.clearSelection();let a=0,c=0;o&&(this._cachedSearchTerm===n?(a=o.end.x,c=o.end.y):(a=o.start.x,c=o.start.y)),this._initLinesCache();const d={startRow:c,startCol:a};let h=this._findInLine(n,d,t);if(!h)for(let y=c+1;y<this._terminal.buffer.active.baseY+this._terminal.rows&&(d.startRow=y,d.startCol=0,h=this._findInLine(n,d,t),!h);y++);if(!h&&c!==0)for(let y=0;y<c&&(d.startRow=y,d.startCol=0,h=this._findInLine(n,d,t),!h);y++);return!h&&o&&(d.startRow=o.start.y,d.startCol=0,h=this._findInLine(n,d,t)),this._selectResult(h,t==null?void 0:t.decorations,t==null?void 0:t.noScroll)}findPrevious(n,t){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");const o=!this._lastSearchOptions||this._didOptionsChange(this._lastSearchOptions,t);this._lastSearchOptions=t,t!=null&&t.decorations&&(this._cachedSearchTerm===void 0||n!==this._cachedSearchTerm||o)&&this._highlightAllMatches(n,t);const a=this._findPreviousAndSelect(n,t);return this._fireResults(t),this._cachedSearchTerm=n,a}_didOptionsChange(n,t){return!!t&&(n.caseSensitive!==t.caseSensitive||n.regex!==t.regex||n.wholeWord!==t.wholeWord)}_fireResults(n){if(n!=null&&n.decorations){let t=-1;if(this._selectedDecoration.value){const o=this._selectedDecoration.value.match;for(let a=0;a<this._highlightDecorations.length;a++){const c=this._highlightDecorations[a].match;if(c.row===o.row&&c.col===o.col&&c.size===o.size){t=a;break}}}this._onDidChangeResults.fire({resultIndex:t,resultCount:this._highlightDecorations.length})}}_findPreviousAndSelect(n,t){var y;if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!this._terminal||!n||n.length===0)return(y=this._terminal)==null||y.clearSelection(),this.clearDecorations(),!1;const o=this._terminal.getSelectionPosition();this._terminal.clearSelection();let a=this._terminal.buffer.active.baseY+this._terminal.rows-1,c=this._terminal.cols;const d=!0;this._initLinesCache();const h={startRow:a,startCol:c};let g;if(o&&(h.startRow=a=o.start.y,h.startCol=c=o.start.x,this._cachedSearchTerm!==n&&(g=this._findInLine(n,h,t,!1),g||(h.startRow=a=o.end.y,h.startCol=c=o.end.x))),g||(g=this._findInLine(n,h,t,d)),!g){h.startCol=Math.max(h.startCol,this._terminal.cols);for(let w=a-1;w>=0&&(h.startRow=w,g=this._findInLine(n,h,t,d),!g);w--);}if(!g&&a!==this._terminal.buffer.active.baseY+this._terminal.rows-1)for(let w=this._terminal.buffer.active.baseY+this._terminal.rows-1;w>=a&&(h.startRow=w,g=this._findInLine(n,h,t,d),!g);w--);return this._selectResult(g,t==null?void 0:t.decorations,t==null?void 0:t.noScroll)}_initLinesCache(){const n=this._terminal;this._linesCache||(this._linesCache=new Array(n.buffer.active.length),this._linesCacheDisposables.value=(0,E.getDisposeArrayDisposable)([n.onLineFeed(()=>this._destroyLinesCache()),n.onCursorMove(()=>this._destroyLinesCache()),n.onResize(()=>this._destroyLinesCache())])),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._linesCacheDisposables.clear(),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(n,t,o){return(n===0||_.includes(t[n-1]))&&(n+o.length===t.length||_.includes(t[n+o.length]))}_findInLine(n,t,o={},a=!1){var ie;const c=this._terminal,d=t.startRow,h=t.startCol,g=c.buffer.active.getLine(d);if(g!=null&&g.isWrapped)return a?void(t.startCol+=c.cols):(t.startRow--,t.startCol+=c.cols,this._findInLine(n,t,o));let y=(ie=this._linesCache)==null?void 0:ie[d];y||(y=this._translateBufferLineToStringWithWrap(d,!0),this._linesCache&&(this._linesCache[d]=y));const[w,H]=y,X=this._bufferColsToStringOffset(d,h),G=o.caseSensitive?n:n.toLowerCase(),K=o.caseSensitive?w:w.toLowerCase();let Y=-1;if(o.regex){const Z=RegExp(G,"g");let D;if(a)for(;D=Z.exec(K.slice(0,X));)Y=Z.lastIndex-D[0].length,n=D[0],Z.lastIndex-=n.length-1;else D=Z.exec(K.slice(X)),D&&D[0].length>0&&(Y=X+(Z.lastIndex-D[0].length),n=D[0])}else a?X-G.length>=0&&(Y=K.lastIndexOf(G,X-G.length)):Y=K.indexOf(G,X);if(Y>=0){if(o.wholeWord&&!this._isWholeWord(Y,K,n))return;let Z=0;for(;Z<H.length-1&&Y>=H[Z+1];)Z++;let D=Z;for(;D<H.length-1&&Y+n.length>=H[D+1];)D++;const W=Y-H[Z],le=Y+n.length-H[D],m=this._stringLengthToBufferSize(d+Z,W);return{term:n,col:m,row:d+Z,size:this._stringLengthToBufferSize(d+D,le)-m+c.cols*(D-Z)}}}_stringLengthToBufferSize(n,t){const o=this._terminal.buffer.active.getLine(n);if(!o)return 0;for(let a=0;a<t;a++){const c=o.getCell(a);if(!c)break;const d=c.getChars();d.length>1&&(t-=d.length-1);const h=o.getCell(a+1);h&&h.getWidth()===0&&t++}return t}_bufferColsToStringOffset(n,t){const o=this._terminal;let a=n,c=0,d=o.buffer.active.getLine(a);for(;t>0&&d;){for(let h=0;h<t&&h<o.cols;h++){const g=d.getCell(h);if(!g)break;g.getWidth()&&(c+=g.getCode()===0?1:g.getChars().length)}if(a++,d=o.buffer.active.getLine(a),d&&!d.isWrapped)break;t-=o.cols}return c}_translateBufferLineToStringWithWrap(n,t){var h;const o=this._terminal,a=[],c=[0];let d=o.buffer.active.getLine(n);for(;d;){const g=o.buffer.active.getLine(n+1),y=!!g&&g.isWrapped;let w=d.translateToString(!y&&t);if(y&&g){const H=d.getCell(d.length-1);H&&H.getCode()===0&&H.getWidth()===1&&((h=g.getCell(0))==null?void 0:h.getWidth())===2&&(w=w.slice(0,-1))}if(a.push(w),!y)break;c.push(c[c.length-1]+w.length),n++,d=g}return[a.join(""),c]}_selectResult(n,t,o){const a=this._terminal;if(this._selectedDecoration.clear(),!n)return a.clearSelection(),!1;if(a.select(n.col,n.row,n.size),t){const c=a.registerMarker(-a.buffer.active.baseY-a.buffer.active.cursorY+n.row);if(c){const d=a.registerDecoration({marker:c,x:n.col,width:n.size,backgroundColor:t.activeMatchBackground,layer:"top",overviewRulerOptions:{color:t.activeMatchColorOverviewRuler}});if(d){const h=[];h.push(c),h.push(d.onRender(g=>this._applyStyles(g,t.activeMatchBorder,!0))),h.push(d.onDispose(()=>(0,E.disposeArray)(h))),this._selectedDecoration.value={decoration:d,match:n,dispose(){d.dispose()}}}}}if(!o&&(n.row>=a.buffer.active.viewportY+a.rows||n.row<a.buffer.active.viewportY)){let c=n.row-a.buffer.active.viewportY;c-=Math.floor(a.rows/2),a.scrollLines(c)}return!0}_applyStyles(n,t,o){n.classList.contains("xterm-find-result-decoration")||(n.classList.add("xterm-find-result-decoration"),t&&(n.style.outline=`1px solid ${t}`)),o&&n.classList.add("xterm-find-active-result-decoration")}_createResultDecoration(n,t){const o=this._terminal,a=o.registerMarker(-o.buffer.active.baseY-o.buffer.active.cursorY+n.row);if(!a)return;const c=o.registerDecoration({marker:a,x:n.col,width:n.size,backgroundColor:t.matchBackground,overviewRulerOptions:this._highlightedLines.has(a.line)?void 0:{color:t.matchOverviewRuler,position:"center"}});if(c){const d=[];d.push(a),d.push(c.onRender(h=>this._applyStyles(h,t.matchBorder,!1))),d.push(c.onDispose(()=>(0,E.disposeArray)(d)))}return c}}z.SearchAddon=L})(),b})())}}]);
}());