"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4214],{80821:function(F,C,e){e.d(C,{Z:function(){return T}});var A=e(5574),d=e.n(A),h=e(24963),c=e(86738),g=e(28036),O=e(83062),M=e(67294),P=e(85893);function T(r){var B=(0,M.useState)(!1),j=d()(B,2),R=j[0],l=j[1],m=(0,M.useContext)(h.Z),o=m.lang,_=m.notice,I=m.message,b=function(){l(!0),r.action().then(function(U){if(l(!1),U){typeof r.onSuccess=="function"&&r.onSuccess(U);var W="";r.messageSuccess?typeof r.messageSuccess=="function"?W=r.messageSuccess(U):W=r.messageSuccess.indexOf("notification.")==0?o(r.messageSuccess):r.messageSuccess:W=o("notification.finish"),r.asynced?I.info(W):I.success(W)}}).catch(function(U){l(!1),typeof r.onError=="function"&&r.onError(U)})};return r.confirm?(0,P.jsx)(c.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:o("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?o(r.confirm):r.confirm,onConfirm:b,okText:"Yes",cancelText:"No",children:(0,P.jsx)(g.ZP,{disabled:r.disabled,icon:r.icon,loading:R,danger:r.danger,type:r.type,children:r.children})}):(0,P.jsx)(O.Z,{title:r.tips,children:(0,P.jsx)(g.ZP,{style:r.ghost?{padding:0,height:"auto"}:{},disabled:r.disabled,icon:r.icon,loading:R,onClick:b,danger:r.danger,type:r.type,children:r.children})})}},96042:function(F,C,e){e.d(C,{Z:function(){return T}});var A=e(97857),d=e.n(A),h=e(5574),c=e.n(h),g=e(75870),O=e(34041),M=e(67294),P=e(85893);function T(r){var B=(0,M.useState)([]),j=c()(B,2),R=j[0],l=j[1];(0,M.useEffect)(function(){(0,g.Ot)().then(function(o){o&&l(o.data.list)})},[]);var m={};return r.multiple&&(m.mode="multiple"),r.top&&(m.placement="topLeft"),(0,P.jsx)(O.Z,d()({onChange:function(_){if(Array.isArray(_)){var I=_.map(function(b){return R[b]});r.onChangeList&&r.onChangeList(I)}else r.onChange&&r.onChange(R[_])},placeholder:"\u9009\u62E9\u955C\u50CF\u4ED3\u5E93\uFF0C\u9ED8\u8BA4\u4E3A\u5F53\u524D\u4ED3\u5E93",options:R.map(function(o,_){return{value:_,label:o.title+"("+o.serverAddress+")"}}),allowClear:!0},m))}},24963:function(F,C,e){var A=e(67294),d=(0,A.createContext)({});C.Z=d},88583:function(F,C,e){e.r(C),e.d(C,{default:function(){return se}});var A=e(19632),d=e.n(A),h=e(15009),c=e.n(h),g=e(99289),O=e.n(g),M=e(5574),P=e.n(M),T=e(90078),r=e(10641),B=e(37476),j=e(62370),R=e(5966),l=e(31418),m=e(28036),o=e(25593),_=e(42075),I=e(66309),b=e(96074),z=e(83062),U=e(84567),W=e(50136),x=e(67294),K=e(63713),S=e(18148),V=e(5251),N=e(80821),w=e(43425),q=e(95556),ee=e(58638),te=e(1912),ne=e(28307),re=e(96042),J=e(67255),ae=e(24963),_e=e(3393),Y=e(93162),Ee=e.n(Y),n=e(85893);function se(){var G=(0,x.useContext)(ae.Z),ue=G.message,fe=G.notice,le=G.lang,D=(0,x.useRef)(),oe=(0,x.useState)({force:!1}),H=P()(oe,2),ie=H[0],de=H[1],he=l.Z.useApp(),ce=(0,x.useState)(1),X=P()(ce,2),Q=X[0],me=X[1],k=(0,x.useRef)();return(0,x.useEffect)(function(){var f;(f=D.current)===null||f===void 0||f.reload()},[Q]),(0,n.jsx)(T._z,{header:{extra:[(0,n.jsx)(K.Link,{to:"/image/create",children:(0,n.jsx)(m.ZP,{type:"primary",children:"\u521B\u5EFA&\u5BFC\u5165\u955C\u50CF"},"create")},"create"),(0,n.jsx)(ne.Z,{onFinish:function(){var u,t;!((u=D.current)===null||u===void 0)&&u.reloadAndRest&&((t=D.current)===null||t===void 0||t.reloadAndRest())}},"remote")]},children:(0,n.jsx)(r.Z,{scroll:{x:"max-content"},rowKey:"Id",columns:[{title:"\u540D\u79F0",dataIndex:"title",render:function(u,t,i,v,a){var s=t.Id.substring(7,19);return t.Title&&(s=t.Title),(0,n.jsx)(o.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u955C\u50CF\u5907\u6CE8\u540D\u79F0",onChange:function(){var E=O()(c()().mark(function y(Z){var L;return c()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,S.Fj)({tag:t.RepoTags[0],title:Z});case 2:L=$.sent,me(Q+1),ue.success("\u4FEE\u6539\u955C\u50CF\u540D\u79F0\u6210\u529F");case 5:case"end":return $.stop()}},y)}));function p(y){return E.apply(this,arguments)}return p}()},children:(0,n.jsx)(K.Link,{to:"/image/detail/"+t.Id,children:s},"edit")},"title-".concat(i))}},{title:"Tag",dataIndex:"tag",render:function(u,t,i,v){return(0,n.jsx)(_.Z,{direction:"vertical",style:{textAlign:"left"},children:t.RepoTags.map(function(a,s){return(0,n.jsxs)(_.Z,{children:[(0,n.jsx)(I.Z,{color:"#2db7f5",children:(0,n.jsx)(o.Z.Text,{copyable:!0,title:a,style:{color:"#ffffff"},children:a},"tag-"+s)},"tag-".concat(s)),t.Containers>0&&(0,n.jsx)(I.Z,{color:"cyan",children:"\u4F7F\u7528\u4E2D"},"use-".concat(s))]},s)})},t.Id)}},{title:"\u67B6\u6784",width:80,search:!1,render:function(u,t,i,v,a){if(t.Labels&&t.Labels["com.dpanel.image.arch"])return(0,n.jsx)(I.Z,{children:t.Labels["com.dpanel.image.arch"]},"arch"+t.Id)}},{title:"\u5C3A\u5BF8",dataIndex:"size",ellipsis:!0,width:"120px",search:!1,sorter:function(u,t){return parseFloat(u.Size)-parseFloat(t.Size)},render:function(u,t,i,v){return(0,n.jsx)("div",{children:(0,V.FI)(parseFloat(t.Size))},t.Id)}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(u,t,i,v){return(0,n.jsx)("div",{children:(0,V.ZM)(t.Created*1e3)},t.Id)},sorter:function(u,t){return u.Created-t.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",render:function(u,t,i,v){return(0,n.jsxs)(_.Z,{split:(0,n.jsx)(b.Z,{type:"vertical"}),children:[(0,n.jsx)(K.Link,{to:"/image/detail/"+t.Id,children:(0,n.jsx)(z.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(w.Z,{})})},"edit"),(0,n.jsx)(K.Link,{to:"/app/create/image?imageId="+t.RepoTags[0],children:(0,n.jsx)(z.Z,{title:"\u521B\u5EFA\u5BB9\u5668",children:(0,n.jsx)(q.Z,{})})},"create")]})}}],request:function(){var f=O()(c()().mark(function u(t,i,v){var a;return c()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,S.KG)({tag:t.tag,title:t.title});case 2:if(a=E.sent,!(!a||!a.data||!a.data.list)){E.next=5;break}return E.abrupt("return",{data:[],success:!0,total:0});case 5:return a.data.list.map(function(p){var y="";p.RepoTags.map(function(Z){a.data.title[Z]&&(y=a.data.title[Z])}),p.Title=y}),E.abrupt("return",{data:a.data.list,success:!0,total:a.data.list.length});case 7:case"end":return E.stop()}},u)}));return function(u,t,i){return f.apply(this,arguments)}}(),pagination:(0,J.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:D,tableAlertOptionRender:function(u){var t=u.selectedRowKeys,i=u.selectedRows;return(0,n.jsxs)(_.Z,{size:16,children:[(0,n.jsx)(N.Z,{icon:(0,n.jsx)(ee.Z,{}),action:function(){var a=[];return i.map(function(s){a.push.apply(a,d()(s.RepoTags))}),(0,_e.Rb)({md5:a})},onSuccess:function(a){var s=i.map(function(p){return p.RepoTags[0]}),E=new Blob([a],{type:"application/tar"});(0,Y.saveAs)(E,s.join("-")+".tar")},children:"\u5BFC\u51FA"}),(0,n.jsxs)(B.Y,{formRef:k,title:"\u6279\u91CF\u63A8\u9001\u955C\u50CF",trigger:(0,n.jsx)(m.ZP,{icon:(0,n.jsx)(te.Z,{}),children:"\u540C\u6B65\u81F3\u5176\u5B83\u4ED3\u5E93"}),onFinish:function(){var v=O()(c()().mark(function a(s){var E,p,y;return c()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,S.KX)({md5:t,registryId:s.registryId,newNamespace:s.newNamespace});case 2:return y=L.sent,(E=D.current)===null||E===void 0||E.reload(),!((p=D.current)===null||p===void 0)&&p.clearSelected&&D.current.clearSelected(),L.abrupt("return",!0);case 6:case"end":return L.stop()}},a)}));return function(a){return v.apply(this,arguments)}}(),children:[(0,n.jsx)(j.Z,{name:"registryId",hidden:!0}),(0,n.jsx)(j.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,n.jsxs)(n.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,n.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,n.jsx)(re.Z,{multiple:!0,top:!0,onChangeList:function(a){var s;(s=k.current)===null||s===void 0||s.setFieldValue("registryId",a.map(function(E){return E.id}))}})}),(0,n.jsx)(R.Z,{tooltip:"\u53EF\u4EE5\u901A\u8FC7\u6B64\u9879\u91CD\u65B0\u5B9A\u4E49\u547D\u540D\u7A7A\u95F4\uFF0Cdocker hub \u4E0D\u53D7\u8BE5\u914D\u7F6E\u7684\u5F71\u54CD\u3002 \u914D\u7F6E\u6B64\u9879\u540E mysql:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/mysql:latest\uFF0C dpanel/dpanel:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/dpanel:latest",label:"\u91CD\u5199\u4ED3\u5E93\u547D\u540D\u7A7A\u95F4",name:"newNamespace"})]}),(0,n.jsx)(N.Z,{danger:!0,type:"primary",action:function(){return(0,S.ao)({md5:t,force:ie.force})},onSuccess:function(){var a,s;return!((a=D.current)===null||a===void 0)&&a.reloadAndRest&&((s=D.current)===null||s===void 0||s.reloadAndRest()),!0},onError:function(){var a,s;return!((a=D.current)===null||a===void 0)&&a.reset&&((s=D.current)===null||s===void 0||s.reset()),!0},confirm:(0,n.jsxs)(_.Z,{style:{width:280},direction:"vertical",children:[(0,n.jsx)(o.Z.Text,{children:le("notification.confirm.title")}),(0,n.jsx)(U.Z,{name:"deleteVolume",onChange:function(a){return de({force:a.target.checked})},children:"\u5F3A\u5236\u5220\u9664\uFF1F"})]}),children:"\u6279\u91CF\u5220\u9664"})]})},tableExtraRender:function(){return(0,n.jsx)(W.Z,{mode:"horizontal",selectedKeys:["all"],items:[{label:(0,n.jsx)(K.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,n.jsx)(K.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})},toolBarRender:function(){return[(0,n.jsx)(N.Z,{action:function(){return(0,S.c7)()},onSuccess:function(){var t,i;return!((t=D.current)===null||t===void 0)&&t.reloadAndRest&&((i=D.current)===null||i===void 0||i.reloadAndRest()),!0},onError:function(){var t,i;return!((t=D.current)===null||t===void 0)&&t.reset&&((i=D.current)===null||i===void 0||i.reset()),!0},confirm:"notification.confirm.title",children:"\u6E05\u7406\u672A\u4F7F\u7528\u955C\u50CF"})]},columnsState:(0,J.j)("image-list")})})}},75870:function(F,C,e){e.d(C,{Ot:function(){return O},ZH:function(){return P},ix:function(){return r},t1:function(){return j}});var A=e(15009),d=e.n(A),h=e(99289),c=e.n(h),g=e(63713);function O(l){return M.apply(this,arguments)}function M(){return M=c()(d()().mark(function l(m){return d()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,g.request)("/api/common/registry/get-list",{method:"POST",data:m}));case 1:case"end":return _.stop()}},l)})),M.apply(this,arguments)}function P(l){return T.apply(this,arguments)}function T(){return T=c()(d()().mark(function l(m){return d()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,g.request)("/api/common/registry/create",{method:"POST",data:m}));case 1:case"end":return _.stop()}},l)})),T.apply(this,arguments)}function r(l){return B.apply(this,arguments)}function B(){return B=c()(d()().mark(function l(m){return d()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,g.request)("/api/common/registry/delete",{method:"POST",data:m}));case 1:case"end":return _.stop()}},l)})),B.apply(this,arguments)}function j(l){return R.apply(this,arguments)}function R(){return R=c()(d()().mark(function l(m){return d()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,g.request)("/api/common/registry/get-detail",{method:"POST",data:m}));case 1:case"end":return _.stop()}},l)})),R.apply(this,arguments)}},67255:function(F,C,e){e.d(C,{O:function(){return A},j:function(){return d}});function A(){var h=localStorage.getItem("dpanel-pagesize");return h=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(h!=null?h:"20")}}function d(h){var c="dpanel-table-column-".concat(h),g={};if(localStorage.getItem(c)){var O;g=JSON.parse((O=localStorage.getItem(c))!==null&&O!==void 0?O:"{}")}return{defaultValue:g,onChange:function(P){localStorage.setItem("dpanel-table-column-".concat(h),JSON.stringify(P))}}}}}]);
