"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4577],{99922:function(Oe,J,e){var Q=e(97857),t=e.n(Q),k=e(15009),c=e.n(k),B=e(99289),z=e.n(B),u=e(5574),x=e.n(u),O=e(67294),y=e(85265),te=e(42075),a=e(28036),P=e(49610),E=e(3616),g=e(93362),F=e(90581),R=e(5251),T=e(36146),M=e(85893),d=new T.Uo("components.appDetail.appDetailQuickConsole"),de=(0,O.forwardRef)(function(ne,C){var b,N,oe=(0,O.useRef)(),j=(0,O.useRef)(),S=(0,O.useState)(!1),Z=x()(S,2),w=Z[0],Y=Z[1],$=(0,O.useState)(),ae=x()($,2),l=ae[0],fe=ae[1];return(0,O.useImperativeHandle)(C,function(){return{show:function(ie){return z()(c()().mark(function me(){var Ce;return c()().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:fe(ie),Y(!0),(Ce=oe.current)===null||Ce===void 0||Ce.resetFields();case 3:case"end":return be.stop()}},me)}))()}}}),(0,O.useEffect)(function(){return setTimeout(function(){var X;l&&((X=j.current)===null||X===void 0||X.start(l.url,{cmd:l&&l.cmd,workDir:l&&l.workDir}))},1e3),function(){var X;(X=j.current)===null||X===void 0||X.close()}},[l,w]),(0,M.jsxs)(y.Z,{forceRender:!0,width:E.FK,open:w,onClose:function(){return[Y(!1)]},title:d.format("drawerTitle",{name:l==null?void 0:l.title}),children:[(0,M.jsxs)(te.Z,{style:{marginBottom:20},children:[(0,M.jsx)(g.Z,{trigger:(0,M.jsx)(a.ZP,{type:"primary",children:d.format("fileExplorerButton")}),type:"container",title:(0,R.fi)((b=l==null?void 0:l.title)!==null&&b!==void 0?b:"","/"),name:l&&l.url&&(N=l.url.split("/").pop())!==null&&N!==void 0?N:""}),(0,M.jsx)(F.Z,{onChangeShell:function(ie){var me;if(!l)return!1;(me=j.current)===null||me===void 0||me.close(),ie!=(l==null?void 0:l.cmd)&&fe(t()(t()({},l),{cmd:ie}))},onOpenNewWindow:function(ie){return l?(ie.workDir=l&&l.workDir?l.workDir:"","".concat(l.url,"?").concat(Object.keys(ie).map(function(me){return"".concat(me,"=").concat(encodeURIComponent(ie[me]))}).join("&"))):""},onOpenNewWindowFinish:function(){var ie;(ie=j.current)===null||ie===void 0||ie.close(),Y(!1)},onBatchCommandFinish:function(ie){j.current&&j.current.run(ie)}})]}),w&&(0,M.jsx)(P.Z,{height:"80vh",ref:j})]})});J.Z=de},93362:function(Oe,J,e){var Q=e(97857),t=e.n(Q),k=e(5574),c=e.n(k),B=e(67294),z=e(34593),u=e(85265),x=e(3616),O=e(5251),y=e(36146),te=e(85893),a=(0,B.forwardRef)(function(P,E){var g,F=(0,B.useState)(!1),R=c()(F,2),T=R[0],M=R[1],d=(0,B.useState)(),de=c()(d,2),ne=de[0],C=de[1],b=(0,B.useRef)(),N=new y.Uo("components.appDetail.appDetailQuickFile");return(0,B.useImperativeHandle)(E,function(){return{showContainer:function(j){C({name:(0,O.fi)(j,"/"),type:"container"}),M(!0)},showHost:function(j){C({name:j,type:"host"}),M(!0)}}}),(0,te.jsxs)(te.Fragment,{children:[P.trigger?B.cloneElement(P.trigger,{onClick:function(){P.name&&P.type&&(C(P),M(!0))}}):null,(0,te.jsx)(u.Z,{width:x.R_,title:N.format("drawerTitle",{name:(g=P.title)!==null&&g!==void 0?g:ne==null?void 0:ne.name}),onClose:function(){var j;(j=b.current)===null||j===void 0||j.close(),M(!1)},open:T,children:T&&ne&&(0,te.jsx)(z.Z,t()({ref:b},ne))})]})});J.Z=a},80821:function(Oe,J,e){e.d(J,{Z:function(){return te}});var Q=e(97857),t=e.n(Q),k=e(5574),c=e.n(k),B=e(24963),z=e(86738),u=e(28036),x=e(83062),O=e(67294),y=e(85893);function te(a){var P=(0,O.useState)(!1),E=c()(P,2),g=E[0],F=E[1],R=(0,O.useContext)(B.Z),T=R.lang,M=R.message,d=function(){F(!0);var ne=a.action();ne instanceof Promise?ne.then(function(C){if(F(!1),C){typeof a.onSuccess=="function"&&a.onSuccess(C);var b="";a.messageSuccess?typeof a.messageSuccess=="function"?b=a.messageSuccess(C):b=a.messageSuccess.indexOf("notification.")==0?T(a.messageSuccess):a.messageSuccess:b=T("notification.finish"),a.asynced?M.info(b):M.success(b)}}).catch(function(C){F(!1),typeof a.onError=="function"&&a.onError(C)}):F(!1)};return a.confirm?(0,y.jsx)(z.Z,t()(t()({style:{width:500},title:a.confirmTitle?a.confirmTitle:T("notification.title.tip"),description:typeof a.confirm=="string"&&a.confirm.indexOf("notification.")==0?T(a.confirm):a.confirm,onConfirm:d,okText:"Yes",cancelText:"No",onOpenChange:a.confirmOnOpenChange},a.confirmProps),{},{children:(0,y.jsx)(u.ZP,{block:a.block,disabled:a.disabled,icon:!a.children&&g?void 0:a.icon,loading:g,danger:a.danger,type:a.type,children:a.children})})):(0,y.jsx)(x.Z,{title:a.tips,children:(0,y.jsx)(u.ZP,{block:a.block,style:a.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:a.disabled,icon:!a.children&&g?void 0:a.icon,loading:g,onClick:d,danger:a.danger,type:a.type,children:a.children})})}},90581:function(Oe,J,e){e.d(J,{Z:function(){return b}});var Q=e(15009),t=e.n(Q),k=e(99289),c=e.n(k),B=e(5574),z=e.n(B),u=e(3616),x=e(97269),O=e(38345),y=e(64317),te=e(37476),a=e(62370),P=e(97462),E=e(95089),g=e(42075),F=e(28036),R=e(83062),T=e(67294),M=e(58638),d=e(82346),de=e(69938),ne=e(36146),C=e(85893);function b(N){var oe=(0,T.useState)(!1),j=z()(oe,2),S=j[0],Z=j[1],w=(0,T.useRef)(),Y=new ne.Uo("components.console");return(0,C.jsx)(x.A,{layout:"inline",submitter:!1,children:(0,C.jsx)(O.Z,{ghost:!0,children:(0,C.jsxs)(g.Z,{children:[(0,C.jsx)(y.Z,{label:" ",width:"sm",name:"entryCmd",placeholder:Y.format("toolbarEntryCmdEmpty"),valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(ae){N.onChangeShell&&N.onChangeShell(ae)}}),(0,C.jsx)(te.Y,{modalProps:{width:u.ob,height:u.Ed},title:Y.format("toolbarBatchCommandTitle"),name:"batchCommand",open:S,trigger:(0,C.jsx)(F.ZP,{children:Y.format("toolbarBatchCommandTitle")}),formKey:"batchCommand",formRef:w,isKeyPressSubmit:!0,onFinish:function(){var $=c()(t()().mark(function ae(l){return t()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:N.onBatchCommandFinish&&N.onBatchCommandFinish(l.shell.split(`
`)),Z(!1);case 2:case"end":return X.stop()}},ae)}));return function(ae){return $.apply(this,arguments)}}(),onOpenChange:function(ae){Z(ae),ae&&w.current&&w.current.resetFields()},children:(0,C.jsx)(a.Z,{name:"shell",children:(0,C.jsx)(E.ZP,{theme:"dark",height:u.Ed})})}),(0,C.jsx)(P.Z,{name:["entryCmd"],children:function(ae){var l=ae.entryCmd;return(!l||l=="")&&(l="/bin/sh"),N.onOpenNewWindow&&(0,C.jsx)(d.Link,{onClick:function(){N.onOpenNewWindowFinish&&N.onOpenNewWindowFinish()},target:"_blank",to:N.onOpenNewWindow({cmd:l}),children:(0,C.jsx)(R.Z,{title:Y.format("toolbarOpenInNewWindowTip"),children:(0,C.jsx)(F.ZP,{type:"dashed",icon:(0,C.jsx)(M.Z,{})})})})}}),(0,C.jsx)(de.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})}},49610:function(Oe,J,e){var Q=e(5574),t=e.n(Q),k=e(67294),c=e(52626),B=e(78267),z=e.n(B),u=e(12323),x=e(87662),O=e(4244),y=e.n(O),te=e(24078),a=e(85893),P,E,g,F,R=(0,k.forwardRef)(function(T,M){var d,de=(0,k.useState)(),ne=t()(de,2),C=ne[0],b=ne[1],N=(0,k.useState)(""),oe=t()(N,2),j=oe[0],S=oe[1];(0,k.useImperativeHandle)(M,function(){return{start:function(Y,$){Z(),E.fit(),$.width=P.cols,$.height=P.rows;var ae=$?Object.keys($).filter(function(l){return $&&$[l]}).map(function(l){if($&&$[l])return"".concat(l,"=").concat($[l])}):[];g=new WebSocket((0,c.R)(Y+"?"+ae.join("&"))),g.addEventListener("message",function(l){var fe=JSON.parse(l.data),X=fe.type;if(X==Y&&(P.write(fe.data),fe.data.indexOf("exec failed")!=-1)){Z();return}}),F=P.onData(function(l){var fe={content:{command:l},type:Y};g&&g.send(JSON.stringify(fe))}),S(Y),b($)},close:function(){Z()},fit:function(){return E.fit(),{width:P.cols,height:P.rows}},run:function(Y){C&&Y&&Y.forEach(function($){var ae={content:{command:$+`
`},type:j};g&&g.send(JSON.stringify(ae))})}}}),(0,k.useEffect)(function(){return P=new O.Terminal(u.X),E=new B.FitAddon,P.loadAddon(E),P.open(document.getElementById("terminal-container-console")),E.fit(),(0,x.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(w){w.data&&w.data.fontSize&&Object.assign(P.options,w.data)}),function(){Z()}},[]),(0,k.useEffect)(function(){window.addEventListener("resize",function(){E.fit();var w={size:{width:P.cols,height:P.rows},type:j};j&&g&&g.send(JSON.stringify(w))})},[j]);function Z(){F&&(P.reset(),E.fit(),P.focus(),F.dispose()),g&&(g.close(),g=null)}return(0,a.jsx)("div",{style:{height:(d=T.height)!==null&&d!==void 0?d:"100vh"},id:"terminal-container-console"})});J.Z=R},81366:function(Oe,J,e){var Q=e(97857),t=e.n(Q),k=e(19632),c=e.n(k),B=e(5574),z=e.n(B),u=e(27254),x=e(42075),O=e(85418),y=e(25593),te=e(28036),a=e(67294),P=e(31112),E=e(85893),g={title:"ROOT",path:"/"},F=(0,a.forwardRef)(function(R,T){var M=(0,a.useContext)(P.Z),d=M.showPath,de=M.redirectPath,ne=(0,a.useState)([g]),C=z()(ne,2),b=C[0],N=C[1];(0,a.useImperativeHandle)(T,function(){return{addHistory:function(S,Z){Z=="/"?N([g]):N([].concat(c()(b),[{title:S,path:Z}]))},initHistory:function(S,Z){N([t()(t()({},g),{},{children:Z})].concat(c()(S)))}}});var oe=function(S){d?d(b[S].title,b[S].path):R.showPath&&R.showPath(b[S].title,b[S].path);var Z=b.filter(function(w,Y){return Y<=S});N(c()(Z))};return(0,E.jsxs)(x.Z,{children:[(0,E.jsx)(x.Z.Compact,{children:b.map(function(j,S){return j.children?(0,E.jsxs)(O.Z.Button,{menu:{items:j.children.map(function(Z,w){return{key:w,label:(0,E.jsx)(y.Z.Link,{onClick:function(){de(Z)},children:Z},w)}})},type:"dashed",onClick:function(w){oe(S)},children:[(0,E.jsx)(u.Z,{})," ",j.title]},S):(0,E.jsx)(te.ZP,{icon:(0,E.jsx)(u.Z,{}),type:"dashed",onClick:function(){oe(S)},children:j.title},S)})}),b.length>=2&&(0,E.jsx)(y.Z.Text,{copyable:{text:b[b.length-1].path}})]})});J.Z=F},31112:function(Oe,J,e){var Q=e(67294),t=(0,Q.createContext)({});J.Z=t},34593:function(Oe,J,e){e.d(J,{Z:function(){return on}});var Q=e(15009),t=e.n(Q),k=e(99289),c=e.n(k),B=e(5574),z=e.n(B),u=e(67294),x=e(82346);function O(r,o){return y.apply(this,arguments)}function y(){return y=c()(t()().mark(function r(o,_){var m;return t()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return m="/api/".concat(o,"/explorer/get-path-list"),H.next=3,(0,x.request)(m,{data:_,method:"POST"});case 3:return H.abrupt("return",H.sent);case 4:case"end":return H.stop()}},r)})),y.apply(this,arguments)}function te(r,o){return a.apply(this,arguments)}function a(){return a=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/export"),{data:_,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),a.apply(this,arguments)}function P(r,o){return E.apply(this,arguments)}function E(){return E=_asyncToGenerator(_regeneratorRuntime().mark(function r(o,_){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return _.enableExportHost=!0,n.next=3,request("/api/".concat(o,"/explorer/export"),{data:_,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},r)})),E.apply(this,arguments)}function g(r,o){return F.apply(this,arguments)}function F(){return F=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/import"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),F.apply(this,arguments)}function R(r,o){return T.apply(this,arguments)}function T(){return T=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/delete"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),T.apply(this,arguments)}function M(r,o){return d.apply(this,arguments)}function d(){return d=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/unzip"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),d.apply(this,arguments)}function de(r,o){return ne.apply(this,arguments)}function ne(){return ne=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/get-content"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ne.apply(this,arguments)}function C(r,o){return b.apply(this,arguments)}function b(){return b=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/import-file-content"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),b.apply(this,arguments)}function N(r,o){return oe.apply(this,arguments)}function oe(){return oe=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/mkdir"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),oe.apply(this,arguments)}function j(r,o){return S.apply(this,arguments)}function S(){return S=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/chmod"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),S.apply(this,arguments)}function Z(r,o){return w.apply(this,arguments)}function w(){return w=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/get-user-list"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),w.apply(this,arguments)}function Y(r,o){return $.apply(this,arguments)}function $(){return $=c()(t()().mark(function r(o,_){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(o,"/explorer/get-file-stat"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),$.apply(this,arguments)}var ae=e(41482),l=e(31112),fe=e(51042),X=e(48689),ie=e(42075),me=e(28036),Ce=e(80821),Be=e(88484),be=e(37476),we=e(91604),Ae=e(97961),Fe=e(3616),je=e(36146),s=e(85893);function Ie(){var r=(0,u.useRef)(),o=(0,u.useContext)(l.Z),_=o.refresh,m=o.name,n=o.apiPrefix,H=o.currentPath,se=new je.Uo("components.explorer");return(0,s.jsx)(be.Y,{modalProps:{width:Fe.ob},formRef:r,trigger:(0,s.jsx)(me.ZP,{icon:(0,s.jsx)(Be.Z,{}),children:se.format("toolbarUploadButton")}),title:se.format("toolbarUploadModalTitle"),onFinish:function(){var A=c()(t()().mark(function I(q){var _e,V;return t()().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return V=[],q.importFileList&&q.importFileList.map(function(Pe){V.push({name:Pe.name,path:Pe.response.data.path})}),g(n,{fileList:V,name:m,destPath:H}),(_e=r.current)===null||_e===void 0||_e.resetFields(),_(),ce.abrupt("return",!0);case 6:case"end":return ce.stop()}},I)}));return function(I){return A.apply(this,arguments)}}(),children:(0,s.jsx)(we.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(I){return new Promise(function(q){var _e;(0,Ae._2)({path:(_e=I.response.data.path)!==null&&_e!==void 0?_e:""}).then(function(V){q(!0)})})}}})})}var Se=e(23430),Ze=e(93162),Re=e(24963);function Ke(r){var o=(0,u.useContext)(l.Z),_=o.name,m=o.apiPrefix,n=(0,u.useContext)(Re.Z),H=n.message,se=new je.Uo("components.explorer");return(0,s.jsx)(Ce.Z,{action:function(){return!r.selectFileList||r.selectFileList.length==0?(H.info(se.format("commonMessageNoSelect")),!1):te(m,{name:_,fileList:r.selectFileList})},onSuccess:function(I){var q=new Blob([I],{type:"application/zip"});(0,Ze.saveAs)(q,"export.zip")},icon:(0,s.jsx)(Se.Z,{}),children:se.format("toolbarExportButton")})}var Te=e(38345),ge=e(63434),Ne=e(24739),ye=e(5966);function $e(r){var o=(0,u.useContext)(Re.Z),_=o.notice,m=(0,u.useRef)(),n=(0,u.useContext)(l.Z),H=n.refresh,se=n.name,A=n.apiPrefix,I=(0,u.useState)(!1),q=z()(I,2),_e=q[0],V=q[1],f=new je.Uo("components.explorer"),ce=function(p){var v=p.split(""),h=0,L=0,ee=0;return v[1]=="r"&&(h+=4),v[2]=="w"&&(h+=2),v[3]=="x"&&(h+=1),v[4]=="r"&&(L+=4),v[5]=="w"&&(L+=2),v[6]=="x"&&(L+=1),v[7]=="r"&&(ee+=4),v[8]=="w"&&(ee+=2),v[9]=="x"&&(ee+=1),"".concat(h).concat(L).concat(ee)},Pe=function(p){var v;if((v=m.current)===null||v===void 0||v.setFieldValue("permission",p),p.length>=1){var h;(h=m.current)===null||h===void 0||h.setFieldsValue({ownerRead:Number(p[0])&4,ownerWrite:Number(p[0])&2,ownerExec:Number(p[0])&1})}if(p.length>=2){var L;(L=m.current)===null||L===void 0||L.setFieldsValue({groupRead:Number(p[1])&4,groupWrite:Number(p[1])&2,groupExec:Number(p[1])&1})}if(p.length>=3){var ee;(ee=m.current)===null||ee===void 0||ee.setFieldsValue({everyoneRead:Number(p[2])&4,everyoneWrite:Number(p[2])&2,everyoneExec:Number(p[2])&1})}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(me.ZP,{onClick:c()(t()().mark(function he(){var p;return t()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(!r.selectFileObject||r.selectFileObject.length==0)){h.next=7;break}return(p=m.current)===null||p===void 0||p.resetFields(),_.error(f.format("commonMessageNoSelect")),V(!1),h.abrupt("return",!1);case 7:V(!0);case 8:case"end":return h.stop()}},he)})),children:f.format("toolbarPermissionButton")}),(0,s.jsxs)(be.Y,{modalProps:{forceRender:!0,width:Fe.ob},title:f.format("toolbarPermissionModalTitle"),layout:"horizontal",open:_e,onOpenChange:function(p){V(p),r.selectFileObject.length==1&&Pe(ce(r.selectFileObject[0].modStr))},formRef:m,onValuesChange:function(p,v){if(p.permission)Pe(p.permission);else{var h=["-",v.ownerRead?"r":"-",v.ownerWrite?"w":"-",v.ownerExec?"x":"-",v.groupRead?"r":"-",v.groupWrite?"w":"-",v.groupExec?"x":"-",v.everyoneRead?"r":"-",v.everyoneWrite?"w":"-",v.everyoneExec?"x":"-"];Pe(ce(h.join("")))}},onFinish:function(){var he=c()(t()().mark(function p(v){var h,L,ee,W;return t()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return ee=[],r.selectFileObject.map(function(D){ee.push(D.path)}),U.next=4,j(A,{name:se,fileList:ee,mod:(h=v.permission)!==null&&h!==void 0?h:"600",hasChildren:(L=v.hasChildren)!==null&&L!==void 0?L:!0,user:v.user});case 4:return W=U.sent,H(),U.abrupt("return",!0);case 7:case"end":return U.stop()}},p)}));return function(p){return he.apply(this,arguments)}}(),children:[(0,s.jsxs)(Te.Z,{direction:"row",gutter:[20,10],children:[(0,s.jsxs)(Te.Z,{bordered:!0,title:f.format("toolbarPermissionOwner"),headerBordered:!0,children:[(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionRead"),name:"ownerRead"}),(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionWrite"),name:"ownerWrite"}),(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionExec"),name:"ownerExec"})]}),(0,s.jsxs)(Te.Z,{bordered:!0,title:f.format("toolbarPermissionGroup"),headerBordered:!0,children:[(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionRead"),name:"groupRead"}),(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionWrite"),name:"groupWrite"}),(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionExec"),name:"groupExec"})]}),(0,s.jsxs)(Te.Z,{bordered:!0,title:f.format("toolbarPermissionEveryone"),headerBordered:!0,children:[(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionRead"),name:"everyoneRead"}),(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionWrite"),name:"everyoneWrite"}),(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionExec"),name:"everyoneExec"})]})]}),(0,s.jsx)(Te.Z,{children:(0,s.jsxs)(Ne.UW,{children:[(0,s.jsx)(ye.Z,{label:f.format("toolbarPermissionButton"),name:"permission",fieldProps:{maxLength:3},width:"xs"}),(0,s.jsxs)(ie.Z.Compact,{children:[(0,s.jsx)(ye.Z,{width:"sm",placeholder:f.format("toolbarPermissionOwnerEmpty"),label:f.format("toolbarPermissionOwner"),name:"user",fieldProps:{addonAfter:":"}}),(0,s.jsx)(ye.Z,{width:"sm",placeholder:f.format("toolbarPermissionGroupEmpty"),name:"group"})]}),(0,s.jsx)(ge.Z,{label:f.format("toolbarPermissionHasChildren"),name:"hasChildren",initialValue:!0})]})})]})]})}var He=e(27461);function ke(r){var o=(0,u.useContext)(l.Z),_=o.currentPath,m=o.refresh,n=o.name,H=o.apiPrefix,se=(0,u.useContext)(Re.Z),A=se.notice,I=new je.Uo("components.explorer");return(0,s.jsx)(Ce.Z,{icon:(0,s.jsx)(He.Z,{}),action:c()(t()().mark(function q(){return t()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(r.selectFileObject.length!=0){V.next=3;break}return A.error(I.format(["commonMessageNoSelect","toolbarUnzipMessageAllowFileExt"])),V.abrupt("return",!1);case 3:return V.abrupt("return",M(H,{name:n,file:r.selectFileObject.map(function(f){return f.path}),path:_}));case 4:case"end":return V.stop()}},q)})),onSuccess:function(){m()},children:I.format("toolbarUnzipButton")})}function ln(r){var o=useContext(FileExplorerContext),_=o.name,m=o.apiPrefix,n=useContext(AppContext),H=n.message,se=useRef(),A=new Lang("components.explorer");return _jsx(RequestButton,{confirm:_jsx(Space,{children:_jsx(ProForm,{layout:"inline",submitter:!1,formRef:se,children:_jsx(ProFormText,{width:"md",label:A.format("toolbarExportHostHostPath"),name:"hostPath"})})}),action:function(){var q;return!r.selectFileList||r.selectFileList.length==0?(H.info(A.format("commonMessageNoSelect")),!1):exportFileList(m,{name:_,hostPath:(q=se.current)===null||q===void 0?void 0:q.getFieldValue("hostPath"),enableExportHost:!0,fileList:r.selectFileList})},icon:_jsx(ExportOutlined,{}),children:A.format("toolbarExportHostButton")})}function ze(r){var o=(0,u.useContext)(l.Z),_=o.refresh,m=o.name,n=o.apiPrefix,H=o.currentPath,se=o.newFile,A=new je.Uo("components.explorer");return(0,s.jsxs)(ie.Z,{size:16,wrap:!0,children:[(0,s.jsx)(Ke,{selectFileList:r.selectFileList}),!1,(0,s.jsx)(Ie,{}),(0,s.jsx)($e,{selectFileObject:r.selectFileObject}),(0,s.jsx)(ke,{selectFileObject:r.selectFileObject}),(0,s.jsx)(me.ZP,{icon:(0,s.jsx)(fe.Z,{}),onClick:function(){se()},type:"primary",children:A.format("toolbarNewButton")}),(0,s.jsx)(Ce.Z,{danger:!0,type:"default",icon:(0,s.jsx)(X.Z,{}),action:function(){return R(n,{name:m,fileList:r.selectFileList})},onSuccess:function(){_()},confirm:"notification.confirm.title",children:A.format("toolbarDeleteButton")})]})}var Ve=e(81366),Ge=e(97269),Je=e(86615),Qe=e(97462),Ye=e(62370),Xe=e(85576),qe=e(95089),We=e(5251),ve=new je.Uo("components.explorer"),en=(0,u.forwardRef)(function(r,o){var _,m,n=(0,u.useContext)(Re.Z),H=n.message,se=n.notice,A=(0,u.useContext)(l.Z),I=A.currentPath,q=A.refresh,_e=A.name,V=A.apiPrefix,f=(0,u.useRef)(),ce=(0,u.useState)(!1),Pe=z()(ce,2),he=Pe[0],p=Pe[1];return(0,u.useImperativeHandle)(o,function(){return{newFile:function(){var h,L;p(!0),(h=f.current)===null||h===void 0||h.resetFields(),(L=f.current)===null||L===void 0||L.setFieldValue("type","newFile")},editFile:function(h,L,ee){return c()(t()().mark(function W(){var pe,U,D,i,K;return t()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return(pe=f.current)===null||pe===void 0||pe.resetFields(),H.loading(ve.format("editFileMessageLoading")),G.next=4,de(V,{name:_e,file:L}).finally(function(){H.destroy()});case 4:if(K=G.sent,!(K.data.content==""&&ee!="0")){G.next=9;break}return H.error(ve.format("editFileMessageNotSupport")),p(!1),G.abrupt("return");case 9:return(U=f.current)===null||U===void 0||U.setFieldValue("newValue",K.data.content),(D=f.current)===null||D===void 0||D.setFieldValue("newName",h),(i=f.current)===null||i===void 0||i.setFieldValue("type","editFile"),p(!0),G.abrupt("return");case 14:case"end":return G.stop()}},W)}))()}}}),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(Xe.Z,{width:Fe.ob,open:he,onCancel:function(){var h;p(!1),(h=f.current)===null||h===void 0||h.resetFields()},footer:!1,forceRender:!0,children:(0,s.jsxs)(Ge.A,{formRef:f,onFinish:function(){var v=c()(t()().mark(function h(L){return t()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(L.type!="newDir"){W.next=13;break}return W.prev=1,W.next=4,N(V,{name:_e,destPath:"".concat(I,"/").concat((0,We.fi)(L.newPath,"/"))});case 4:return q(),p(!1),W.abrupt("return",!0);case 9:W.prev=9,W.t0=W.catch(1);case 11:W.next=23;break;case 13:return W.prev=13,W.next=16,C(V,{destPath:I,file:L.newName,content:L.newValue,name:_e});case 16:return q(),p(!1),W.abrupt("return",!0);case 21:W.prev=21,W.t1=W.catch(13);case 23:return W.abrupt("return",!1);case 24:case"end":return W.stop()}},h,null,[[1,9],[13,21]])}));return function(h){return v.apply(this,arguments)}}(),children:[(0,s.jsx)(Je.Z.Group,{name:"type",options:[{label:ve.format("editFileTypeEditFile"),value:"editFile",disabled:((_=f.current)===null||_===void 0?void 0:_.getFieldValue("type"))!="editFile"},{label:ve.format("editFileTypeNewFile"),value:"newFile"},{label:ve.format("editFileTypeNewDir"),value:"newDir"}],disabled:((m=f.current)===null||m===void 0?void 0:m.getFieldValue("type"))=="editFile"}),(0,s.jsx)(Qe.Z,{name:["type"],children:function(h){var L=h.type;return L!="newDir"?[(0,s.jsx)(ye.Z,{label:ve.format("editFileNewName"),tooltip:ve.format("editFileNewNameTip"),name:"newName",fieldProps:{addonBefore:"".concat(I,"/")},placeholder:ve.format("editFileNewNameEmpty"),disabled:L=="editFile"},"fileName"),(0,s.jsx)(Ye.Z,{label:ve.format("editFileNewValue"),name:"newValue",children:(0,s.jsx)(qe.ZP,{theme:"dark",height:Fe.Ed,onChange:function(W){var pe;(pe=f.current)===null||pe===void 0||pe.setFieldValue("newValue",W)}})},"fileContent")]:(0,s.jsx)(ye.Z,{name:"newPath",label:ve.format("editFileNewPath"),placeholder:ve.format("editFileNewPathEmpty")})}})]})})})}),nn=en,tn=e(99922),Ue=e(68536),rn=e(83062),an=e(66309),un=null,Ee=new je.Uo("components.explorer"),sn=(0,u.forwardRef)(function(r,o){(0,u.useImperativeHandle)(o,function(){return{close:function(){ce([]),I("")}}});var _=(0,u.useRef)(),m=(0,u.useRef)(),n=(0,u.useRef)(),H=(0,u.useState)(""),se=z()(H,2),A=se[0],I=se[1],q=(0,u.useRef)(),_e=(0,x.useSearchParams)(),V=z()(_e,2),f=V[0],ce=V[1],Pe=(0,u.useState)(),he=z()(Pe,2),p=he[0],v=he[1],h=(0,u.useContext)(Re.Z),L=h.message,ee=r.type=="host"?"common":"app";(0,u.useEffect)(function(){L.info(Ee.format("commonMessageCreateExplorerPlugin")),I("")},[]);function W(U,D){return pe.apply(this,arguments)}function pe(){return pe=c()(t()().mark(function U(D,i){var K,le,G;return t()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:(K=_.current)===null||K===void 0||K.addHistory(D,i),I(i),n.current&&(le=n.current)!==null&&le!==void 0&&le.reloadAndRest&&((G=n.current)===null||G===void 0||G.reloadAndRest()),i=="/"?ce([]):(f.set("path",i),ce(f));case 4:case"end":return ue.stop()}},U)})),pe.apply(this,arguments)}return r&&(0,s.jsxs)(l.Z.Provider,{value:{apiPrefix:ee,name:r.name,currentPath:A,showPath:W,redirectPath:function(D){var i;if(I(D),n.current&&(i=n.current)!==null&&i!==void 0&&i.reloadAndRest){var K;(K=n.current)===null||K===void 0||K.reloadAndRest()}D=="/"?ce([]):(f.set("path",D),ce(f))},refresh:function(){var D;if(n&&typeof((D=n.current)===null||D===void 0?void 0:D.reloadAndRest)=="function"){var i;(i=n.current)===null||i===void 0||i.reloadAndRest()}},editFile:function(D,i,K){m.current&&m.current.editFile(D,i,K)},newFile:function(){m.current&&m.current.newFile()}},children:[(0,s.jsx)(ae.Z,{scroll:{x:"max-content"},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},toolBarRender:function(){var D=[];return r.onConsole&&D.push((0,s.jsx)(me.ZP,{type:"dashed",onClick:function(){r.onConsole&&r.onConsole(A)},children:"Console"},"fileConsole")),[].concat(D)},tableAlertOptionRender:function(D){var i=D.selectedRowKeys,K=D.selectedRows,le=[];return K.map(function(G){le.push(G.path)}),[(0,s.jsx)(ze,{selectFileList:le,selectFileObject:K,enableExportHost:r.type=="container"},"1")]},headerTitle:(0,s.jsx)(Ve.Z,{ref:_}),actionRef:n,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:c()(t()().mark(function U(){var D,i,K,le,G;return t()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,O(ee,{name:r.name,path:A});case 2:if(i=ue.sent,A==""&&i.data.currentPath!=""&&I(i.data.currentPath),K=[],(D=_.current)===null||D===void 0||D.initHistory(i.data.currentPath.split("/").filter(function(re){return re!=""}).map(function(re){return K.push(re),{title:re,path:"/".concat(K.join("/"))}}),i.data.rootDirs),le=p,le){ue.next=13;break}return ue.next=10,Z(ee,{name:r.name});case 10:G=ue.sent,v(G.data),le=G.data;case 13:return ue.abrupt("return",{data:i.data.list.map(function(re){if(le){var xe,Le;re.group=(xe=(Le=le.group.find(function(Me){return Me.gid==re.group}))===null||Le===void 0?void 0:Le.name)!==null&&xe!==void 0?xe:re.group}return re}),success:!0,total:i.data.list.length});case 14:case"end":return ue.stop()}},U)})),columns:[{title:Ee.format("listName"),dataIndex:"name",key:"name",render:function(De,i,K,le,G){var De;return i.isDir?De=(0,s.jsx)(Ue.Z,{isDir:!0,onClick:function(){return W(i.name,i.path)},showName:i.name}):i.isSymlink?De=(0,s.jsx)(Ue.Z,{isLink:!0,showName:"".concat(i.name," -> ").concat(i.linkName),onClick:c()(t()().mark(function ue(){var re,xe;return t()().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return Me.next=2,Y(ee,{name:r.name,path:i.path});case 2:re=Me.sent,re.data.info.isDir?W(i.name,re.data.info.target):(xe=m.current)===null||xe===void 0||xe.editFile(re.data.info.name,re.data.info.target,i.size);case 4:case"end":return Me.stop()}},ue)}))}):De=(0,s.jsx)(Ue.Z,{showName:i.name,onClick:function(){var re;(re=m.current)===null||re===void 0||re.editFile(i.name,i.path,i.size)}}),De}},{title:Ee.format("listStatus"),key:"status",width:110,render:function(D,i,K,le,G){return i.change>-1&&(0,s.jsx)(rn.Z,{title:Ee.format("listStatus.".concat(i.change,".tip")),children:(0,s.jsx)(an.Z,{color:Ee.format("listStatus.".concat(i.change,".color")),children:Ee.format("listStatus.".concat(i.change,".title"))})})}},{title:Ee.format("listModStr"),dataIndex:"modStr",key:"mod"},{title:Ee.format("listUser"),dataIndex:"user"},{title:Ee.format("listGroup"),dataIndex:"group"},{title:Ee.format("listSize"),dataIndex:"size",key:"size",render:function(D,i,K,le,G){return(0,We.FI)(i.size)}},{title:Ee.format("listModTime"),dataIndex:"modTime",key:"modTime",sorter:function(D,i){return new Date(D.modTime).getTime()-new Date(i.modTime).getTime()},render:function(D,i,K,le,G){return(0,We.NF)(i.modTime)}}],cardProps:{ghost:!0}}),(0,s.jsx)(nn,{ref:m}),(0,s.jsx)(tn.Z,{ref:q})]})}),on=sn},68536:function(Oe,J,e){e.d(J,{Z:function(){return te}});var Q=e(24963),t=e(36146),k=e(93613),c=e(36693),B=e(2741),z=e(25593),u=e(42075),x=e(67294),O=e(85893),y=0;function te(a){var P=(0,x.useContext)(Q.Z),E=P.message,g=new t.Uo("components.explorer");return a.isDir?(0,O.jsx)(z.Z.Link,{onClick:function(){a.onClick&&a.onClick()},children:(0,O.jsxs)(u.Z,{children:[(0,O.jsx)(k.Z,{}),a.showName]})}):a.isLink?(0,O.jsx)(z.Z.Link,{onClick:function(){a.onClick&&a.onClick()},children:(0,O.jsxs)(u.Z,{children:[(0,O.jsx)(c.Z,{}),a.showName]})}):(0,O.jsx)(z.Z.Text,{onClick:function(){if(y++,y==2){y=0,a.onClick&&a.onClick();return}setTimeout(function(){y==1&&E.info(g.format("fileNameMessageViewDetail")),y=0},400)},style:{cursor:"pointer"},children:(0,O.jsxs)(u.Z,{children:[(0,O.jsx)(B.Z,{}),a.showName]})})}},12323:function(Oe,J,e){e.d(J,{X:function(){return Q},n:function(){return t}});var Q={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},t=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},97961:function(Oe,J,e){e.d(J,{GH:function(){return te},_2:function(){return P},fN:function(){return u},ii:function(){return z},vC:function(){return O}});var Q=e(15009),t=e.n(Q),k=e(99289),c=e.n(k),B=e(82346),z=[{name:"amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"i386",arch:"386",search:[]},{name:"arm/v6",arch:"arm",search:[]},{name:"arm/v7",arch:"arm",search:[]},{name:"arm/v8",arch:"arm64",search:[]},{name:"ppc64le",arch:"ppc64le",search:[]},{name:"riscv64",arch:"riscv64",search:[]}];function u(R){return x.apply(this,arguments)}function x(){return x=c()(t()().mark(function R(T){return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,B.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:T}));case 1:case"end":return d.stop()}},R)})),x.apply(this,arguments)}function O(R){return y.apply(this,arguments)}function y(){return y=c()(t()().mark(function R(T){return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,B.request)("/api/app/image/import-by-container-tar",{method:"POST",data:T}));case 1:case"end":return d.stop()}},R)})),y.apply(this,arguments)}function te(R){return a.apply(this,arguments)}function a(){return a=c()(t()().mark(function R(T){return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,B.request)("/api/app/image/import-by-image-tar",{method:"POST",data:T}));case 1:case"end":return d.stop()}},R)})),a.apply(this,arguments)}function P(R){return E.apply(this,arguments)}function E(){return E=c()(t()().mark(function R(T){return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,B.request)("/api/common/attach/delete",{method:"POST",data:T});case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},R)})),E.apply(this,arguments)}function g(){return F.apply(this,arguments)}function F(){return F=_asyncToGenerator(_regeneratorRuntime().mark(function R(){return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.abrupt("return",request("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return M.stop()}},R)})),F.apply(this,arguments)}}}]);
