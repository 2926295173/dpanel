"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8373],{91058:function(H,U,t){var B=t(19632),a=t.n(B),W=t(97857),l=t.n(W),_=t(5574),v=t.n(_),E=t(89035),O=t(64317),d=t(5966),g=t(38345),y=t(17186),R=t(24739),K=t(42075),M=t(28036),S=t(85576),j=t(67294),k=t(95089),A=t(12491),C=t(62597),I=t(79245),b=t(3616),i=t(85893),D="docker-image",F=(0,j.forwardRef)(function(s,N){var $=(0,j.useState)(D),G=v()($,2),L=G[0],x=G[1],m=(0,j.useRef)(),Y=(0,j.useState)(""),Z=v()(Y,2),r=Z[0],n=Z[1],f=function(){L!="code"?x("code"):x(D)};(0,j.useImperativeHandle)(N,function(){return{addEnvItem:function(u,p){var h,c=(h=m.current)===null||h===void 0?void 0:h.getList(),T=!1;if(c==null||c.map(function(w){if(w.name==u){T=!0;return}}),!T){var P;(P=m.current)===null||P===void 0||P.add({name:u,value:p})}},clear:function(){var u;(u=m.current)===null||u===void 0||(u=u.getList())===null||u===void 0||u.map(function(p,h){var c;(c=m.current)===null||c===void 0||c.remove(h)})}}});function e(o){try{var u,p;o==""&&(o=Q());for(var h=(u=(p=m.current)===null||p===void 0||(p=p.getList())===null||p===void 0?void 0:p.length)!==null&&u!==void 0?u:0,c=h;c>=0;c--){var T;(T=m.current)===null||T===void 0||T.remove(c)}var P=o.split(`
`),w=0;P.map(function(V){var z,J=V.split("=");J.length<2||((z=m.current)===null||z===void 0||z.add({name:J[0],value:J.slice(1).join("=")},w),w++)})}catch(V){console.log(V)}}function Q(){if(m&&m.current&&m.current.getList){var o,u=(o=m.current)===null||o===void 0?void 0:o.getList();if(u){var p=[];return u.map(function(h){p.push("".concat(h.name,"=").concat(h.value))}),p.join(`
`)}else return""}else return""}function X(o){var u,p,h,c,T={},P={help:o&&o.label?o.label:"",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:s.requireValue?!0:(0,I.y)((u=o.rule)===null||u===void 0?void 0:u.kind,C.fp.EnvValueRuleRequired)}],disabled:s.showDisableValue||(0,I.y)((p=o.rule)===null||p===void 0?void 0:p.kind,C.fp.EnvValueRuleDisabled)};if((0,I.y)((h=o.rule)===null||h===void 0?void 0:h.kind,C.fp.EnvValueTypeSelect)){var w;return(0,i.jsx)(O.Z,l()(l()({fieldProps:T},P),{},{width:s.showInDrawer?"sm":"md",options:((w=o.rule)===null||w===void 0?void 0:w.option)&&o.rule.option.map(function(V){return{label:V.name,value:V.value}}),initialValue:o.value}))}else return(0,I.y)((c=o.rule)===null||c===void 0?void 0:c.kind,C.fp.EnvValueTypeNumber)?(0,i.jsx)(d.Z,l()(l()({fieldProps:T},P),{},{width:s.showInDrawer?"sm":"md",rules:[].concat(a()(P.rules),[{pattern:new RegExp("^[0-9]*$")}]),help:P.help+",\u6570\u503C\u7C7B\u578B"})):(0,i.jsx)(d.Z,l()(l()({fieldProps:T},P),{},{width:s.showInDrawer?"sm":"md"}))}return(0,i.jsxs)(g.Z,{ghost:s.showCardGhost,title:s.label?s.label:null,headerBordered:!0,extra:(s.showCodeMode||s.showImportButton)&&(0,i.jsxs)(K.Z,{children:[s.showImportButton&&(0,i.jsx)("div",{style:{marginBottom:"-25px"},children:(0,i.jsx)(A.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(u){return e(u),!0},onLoad:function(u){if(u.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),s.showCodeMode?(0,i.jsx)(M.ZP,{icon:(0,i.jsx)(E.Z,{}),type:L=="code"?"primary":"default",onClick:f,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,i.jsx)(y.u,{name:s.name?s.name:"environment",actionRef:m,creatorButtonProps:s.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,deleteIconProps:s.showDeleteButton,min:100,label:s.listLabel,children:function(u,p,h){var c=h.getCurrentRowData();return(0,i.jsxs)(R.UW,{style:{marginBottom:"5px"},children:[(0,i.jsx)(d.Z,{width:s.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:s.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),X(c)]})}}),s.showCodeMode&&(0,i.jsx)(S.Z,{width:b.ob,open:L=="code",onCancel:function(){return x("docker-image")},onOk:function(){e(r),x("docker-image")},children:(0,i.jsx)(k.ZP,{onChange:function(u){return n(u)},value:Q(),height:b.Ed,theme:"dark"})})]})});U.Z=F},12491:function(H,U,t){t.d(U,{Z:function(){return O}});var B=t(24963),a=t(88484),W=t(62370),l=t(31418),_=t(28036),v=t(67294),E=t(85893);function O(d){var g=(0,v.useContext)(B.Z),y=g.message,R=g.notice,K=g.lang,M=(0,v.useRef)(null),S=l.Z.useApp(),j=function(){M.current&&(M.current.click(),M.current.onchange=function(A){if(!A||!A.target)return"";var C=new FileReader;C.onload=function(b){var i,D,F=(i=b.target)===null||i===void 0?void 0:i.result;if(d.onLoad)try{d.onLoad&&d.onLoad(F)}catch(s){R.error(s);return}typeof d.onImport=="function"&&(y.success("\u6210\u529F\u5BFC\u5165 ".concat(d.title)),d.onImport(F)),(D=M.current)!==null&&D!==void 0&&D.value&&(M.current.value="")};var I=A.target;if(I.files)try{C.readAsText(I.files[0])}catch(b){R.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(W.Z,{children:(0,E.jsx)(_.ZP,{icon:(0,E.jsx)(a.Z,{}),block:!0,onClick:j,children:d.title})}),(0,E.jsx)("input",{style:{display:"none"},type:"file",ref:M,name:"importFileInput"})]})}},90098:function(H,U,t){t.d(U,{GG:function(){return A},MG:function(){return N},Oh:function(){return M},Pn:function(){return g},U_:function(){return F},Yz:function(){return I},iE:function(){return x},ik:function(){return R},im:function(){return v},mg:function(){return j},pm:function(){return O},tw:function(){return Y},vf:function(){return i},xC:function(){return G}});var B=t(15009),a=t.n(B),W=t(99289),l=t.n(W),_=t(82346);function v(r){return E.apply(this,arguments)}function E(){return E=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/app/compose/create",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),E.apply(this,arguments)}function O(r){return d.apply(this,arguments)}function d(){return d=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/app/compose/get-list",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),d.apply(this,arguments)}function g(r){return y.apply(this,arguments)}function y(){return y=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,_.request)("/api/app/compose/get-task",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),y.apply(this,arguments)}function R(r){return K.apply(this,arguments)}function K(){return K=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/app/compose/delete",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),K.apply(this,arguments)}function M(r){return S.apply(this,arguments)}function S(){return S=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,_.request)("/api/app/compose/container-deploy",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),S.apply(this,arguments)}function j(r){return k.apply(this,arguments)}function k(){return k=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,_.request)("/api/app/compose/container-destroy",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),k.apply(this,arguments)}function A(r){return C.apply(this,arguments)}function C(){return C=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,_.request)("/api/app/compose/container-ctrl",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),C.apply(this,arguments)}function I(r){return b.apply(this,arguments)}function b(){return b=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,_.request)("/api/app/compose/container-log",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),b.apply(this,arguments)}function i(r){return D.apply(this,arguments)}function D(){return D=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.download=!0,n.id=String(n.id),e.next=4,(0,_.request)("/api/app/compose/container-log",{method:"POST",data:n,responseType:"blob"});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},r)})),D.apply(this,arguments)}function F(r){return s.apply(this,arguments)}function s(){return s=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/app/compose/container-process-kill",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),s.apply(this,arguments)}function N(r){return $.apply(this,arguments)}function $(){return $=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/app/compose/get-from-uri",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),$.apply(this,arguments)}function G(r){return L.apply(this,arguments)}function L(){return L=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,_.request)("/api/app/compose/parse",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),L.apply(this,arguments)}function x(r){return m.apply(this,arguments)}function m(){return m=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/common/store/deploy",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),m.apply(this,arguments)}function Y(r){return Z.apply(this,arguments)}function Z(){return Z=l()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,_.request)("/api/app/compose/download",{method:"POST",data:n,responseType:"blob"}));case 2:case"end":return e.stop()}},r)})),Z.apply(this,arguments)}},79245:function(H,U,t){t.d(U,{m:function(){return W},y:function(){return l}});var B=t(64599),a=t.n(B);function W(_){var v=[];if(!_||_=="")return v;var E=_.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),O=a()(E),d;try{for(O.s();!(d=O.n()).done;){var g=d.value;v.push({name:g[1],value:g[2]?g[2].indexOf("-")==0?g[2].substring(1):g[2]:""})}}catch(y){O.e(y)}finally{O.f()}return v}function l(_,v){return!_||!v?!1:(_&v)!==0}}}]);
