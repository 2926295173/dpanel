"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9002],{1699:function(z,C,e){e.d(C,{u:function(){return r}});var I=e(9783),o=e.n(I),g=e(97857),c=e.n(g),T=e(67294),A=e(82346),B=e(40411),S=e(42075),M=e(85893),r=function(h){var E=(0,A.useAccess)(),b=Array.isArray(h.access)?h.access:[h.access],f,p=h.fallback;return typeof h.children=="function"?(f=h.children(b.reduce(function(U,_){return c()(c()({},U),{},o()({},_,E[_]))},{})),f||(f=p)):b.every(function(U){return E[U]})?f=h.children:f=p,!p&&f&&h.showProTips&&E.canSeeEnableCe&&(f=(0,M.jsx)(B.Z,{offset:h.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:f})),!p&&f&&h.showProRibbonTips&&E.canSeeEnableCe&&(f=(0,M.jsx)(B.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:f})),h.space?(0,M.jsx)(S.Z,c()(c()({},h.space),{},{children:f})):f}},80821:function(z,C,e){e.d(C,{Z:function(){return M}});var I=e(5574),o=e.n(I),g=e(24963),c=e(86738),T=e(28036),A=e(83062),B=e(67294),S=e(85893);function M(r){var R=(0,B.useState)(!1),h=o()(R,2),E=h[0],b=h[1],f=(0,B.useContext)(g.Z),p=f.lang,U=f.notice,_=f.message,$=function(){b(!0);var V=r.action();V instanceof Promise?V.then(function(L){if(b(!1),L){typeof r.onSuccess=="function"&&r.onSuccess(L);var D="";r.messageSuccess?typeof r.messageSuccess=="function"?D=r.messageSuccess(L):D=r.messageSuccess.indexOf("notification.")==0?p(r.messageSuccess):r.messageSuccess:D=p("notification.finish"),r.asynced?_.info(D):_.success(D)}}).catch(function(L){b(!1),typeof r.onError=="function"&&r.onError(L)}):b(!1)};return r.confirm?(0,S.jsx)(c.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:p("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?p(r.confirm):r.confirm,onConfirm:$,okText:"Yes",cancelText:"No",onOpenChange:r.confirmOnOpenChange,children:(0,S.jsx)(T.ZP,{block:r.block,disabled:r.disabled,icon:!r.children&&E?void 0:r.icon,loading:E,danger:r.danger,type:r.type,children:r.children})}):(0,S.jsx)(A.Z,{title:r.tips,children:(0,S.jsx)(T.ZP,{block:r.block,style:r.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:r.disabled,icon:!r.children&&E?void 0:r.icon,loading:E,onClick:$,danger:r.danger,type:r.type,children:r.children})})}},78451:function(z,C,e){e.d(C,{Z:function(){return g}});var I=e(67294),o=e(85893);function g(c){return(0,o.jsx)("span",{style:{width:c.width?c.width:"auto",wordBreak:"break-word"},children:c.content})}},86783:function(z,C,e){e.r(C),e.d(C,{default:function(){return Pe}});var I=e(15009),o=e.n(I),g=e(99289),c=e.n(g),T=e(1699),A=e(80821),B=e(78451),S=e(5574),M=e.n(S),r=e(24963),R=e(82346);function h(i){return E.apply(this,arguments)}function E(){return E=c()(o()().mark(function i(x){return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,R.request)("/api/app/volume/get-list",{method:"POST",data:x}));case 1:case"end":return l.stop()}},i)})),E.apply(this,arguments)}function b(i){return f.apply(this,arguments)}function f(){return f=c()(o()().mark(function i(x){return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,R.request)("/api/app/volume/create",{method:"POST",data:x}));case 1:case"end":return l.stop()}},i)})),f.apply(this,arguments)}function p(i){return U.apply(this,arguments)}function U(){return U=c()(o()().mark(function i(x){return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,R.request)("/api/app/volume/prune",{method:"POST",data:x});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},i)})),U.apply(this,arguments)}function _(i){return $.apply(this,arguments)}function $(){return $=c()(o()().mark(function i(x){return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,R.request)("/api/app/volume/delete",{method:"POST",data:x});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},i)})),$.apply(this,arguments)}function Q(i){return V.apply(this,arguments)}function V(){return V=c()(o()().mark(function i(x){return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,R.request)("/api/app/volume/get-detail",{method:"POST",data:x}));case 1:case"end":return l.stop()}},i)})),V.apply(this,arguments)}var L=e(184),D=e(5966),X=e(62370),re=e(86615),ae=e(97462),le=e(17186),ue=e(24739),ie=e(28036),k=e(34041),P=e(67294),n=e(85893),se=(0,P.forwardRef)(function(i,x){var y=(0,P.useState)(!1),l=M()(y,2),w=l[0],N=l[1],O=(0,P.useRef)(),m=(0,P.useContext)(r.Z),d=m.message,a=m.notice;return(0,P.useImperativeHandle)(x,function(){return{}}),(0,n.jsxs)(L.a,{name:"create",title:"\u6DFB\u52A0\u5B58\u50A8\u5377",open:w,onOpenChange:function(t){N(t)},formRef:O,trigger:(0,n.jsx)(ie.ZP,{type:"primary",children:"\u521B\u5EFA\u5B58\u50A8\u5377"}),onFinish:function(){var u=c()(o()().mark(function t(s){var v,j,Z,F,J,Y;return o()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return F=[],s.otherOptions&&s.otherOptions.map(function(te){F.push(te.name+`
`+te.value)}),K.next=4,b({name:s.name,driver:"local",type:s.type,nfsUrl:(v=s.nfsUrl)!==null&&v!==void 0?v:"",nfsMountPoint:(j=s.nfsMountPoint)!==null&&j!==void 0?j:"",nfsOptions:(Z=s.nfsOptions)!==null&&Z!==void 0?Z:"",tmpfsOptions:s.tmpfsOptions,otherOptions:F});case 4:if(J=K.sent,!(J&&J.data&&J.data.info.Name!="")){K.next=10;break}return d.success("\u6DFB\u52A0\u5B58\u50A8\u5377\u6210\u529F"),i.onFinish&&i.onFinish(),(Y=O.current)===null||Y===void 0||Y.resetFields(),K.abrupt("return",!0);case 10:case"end":return K.stop()}},t)}));return function(t){return u.apply(this,arguments)}}(),children:[(0,n.jsx)(D.Z,{label:"\u540D\u79F0",name:"name",placeholder:"\u6307\u5B9A\u552F\u4E00\u5B58\u50A8\u5377\u540D\u79F0"}),(0,n.jsx)(X.Z,{label:"\u7C7B\u578B",name:"driver",children:(0,n.jsx)(k.Z,{defaultValue:"local",children:(0,n.jsx)(k.Z.Option,{value:"local",children:"local"})})}),(0,n.jsx)(re.Z.Group,{name:"type",label:"\u5B58\u50A8\u7C7B\u578B",valueEnum:{default:"\u9ED8\u8BA4",tmpfs:"tmpfs",nfs:"Nfs",nfs4:"Nfs4",other:"\u81EA\u5B9A\u4E49"},initialValue:"default"}),(0,n.jsx)(ae.Z,{name:["type"],children:function(t){var s=t.type;if(s=="other")return(0,n.jsx)(le.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:"\u5B58\u50A8"},copyIconProps:!1,min:0,children:(0,n.jsxs)(ue.UW,{children:[(0,n.jsx)(D.Z,{name:"name",label:"\u540D\u79F0",placeholder:"\u4F8B\u5982:mountpoint"}),(0,n.jsx)(D.Z,{name:"value",label:"\u503C",placeholder:"\u4F8B\u5982:/etc/path"})]})});if(s=="nfs"||s=="nfs4")return[(0,n.jsx)(D.Z,{label:"\u5730\u5740",name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:"\u914D\u7F6ENfs\u670D\u52A1\u5730\u5740,\u4F8B\u5982 my.nfs.com \u6216\u662F 172.16.1.13 "},"nfsUrl"),(0,n.jsx)(D.Z,{label:"\u6302\u8F7D\u70B9",name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"\u4F8B\u5982, /export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,n.jsx)(D.Z,{label:"\u914D\u7F6E",name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(s=="tmpfs")return[(0,n.jsx)(D.Z,{label:"\u914D\u7F6E",name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),oe=se,q=e(5251),ee=e(38345),W=e(26412),de=e(60940),G=e(66309),ce=(0,P.forwardRef)(function(i,x){var y;(0,P.useImperativeHandle)(x,function(){return{showDetail:function(s){return c()(o()().mark(function v(){var j;return o()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,Q({name:s});case 2:j=F.sent,O(!0),u(j.data);case 5:case"end":return F.stop()}},v)}))()}}});var l=(0,P.useState)(!1),w=M()(l,2),N=w[0],O=w[1],m=(0,P.useState)(),d=M()(m,2),a=d[0],u=d[1];return(0,n.jsxs)(L.a,{title:"\u5B58\u50A8\u8BE6\u60C5",open:N,submitter:!1,onOpenChange:function(s){O(s),!s&&u(void 0)},children:[(0,n.jsx)(ee.Z,{title:"\u5B58\u50A8\u8BE6\u60C5",ghost:!0,children:(0,n.jsxs)(W.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:[(0,n.jsx)(W.Z.Item,{label:"\u540D\u79F0",children:a==null?void 0:a.info.Name}),(0,n.jsx)(W.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:new Date((y=a==null?void 0:a.info.CreatedAt)!==null&&y!==void 0?y:"").toLocaleString()}),(0,n.jsx)(W.Z.Item,{label:"\u6302\u8F7D\u70B9",children:a==null?void 0:a.info.Mountpoint}),(0,n.jsx)(W.Z.Item,{label:"\u7C7B\u578B",children:a==null?void 0:a.info.Driver}),(a==null?void 0:a.info.Labels)&&(0,n.jsx)(W.Z.Item,{label:"Lables",children:(0,n.jsx)(W.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:(a==null?void 0:a.info.Labels)&&Object.keys(a==null?void 0:a.info.Labels).map(function(t){return(0,n.jsx)(W.Z.Item,{label:t,children:a.info.Labels[t]})})})})]})}),(0,n.jsx)(ee.Z,{title:"\u4F7F\u7528\u5BB9\u5668",ghost:!0,children:(0,n.jsx)(de.Z,{rowKey:"Id",columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"Name",render:function(s,v,j){return(0,n.jsx)(R.Link,{target:"_blank",to:"/app/detail/edit/".concat(v.Id),children:(0,q.fi)(v.Name,"/")})}},{title:"\u5BB9\u5668\u5185\u8DEF\u5F84",dataIndex:"Mount"},{title:"\u6743\u9650",render:function(s,v,j){return v.RW?(0,n.jsx)(G.Z,{children:"\u8BFB\u5199"}):(0,n.jsx)(G.Z,{children:"\u53EA\u8BFB"})}}],dataSource:a==null?void 0:a.inUseContainer,pagination:!1})})]})}),fe=ce,me=e(67255),he=e(36693),ve=e(43425),xe=e(90078),ge=e(41482),je=e(97269),H=e(42075),Oe=e(96074),ne=e(25593),Ee=e(83062),De=e(84567);function Pe(){var i=(0,P.useRef)(),x=(0,P.useRef)(),y=(0,P.useRef)(),l=(0,R.useAccess)(),w=(0,P.useContext)(r.Z),N=w.lang;return(0,n.jsxs)(xe._z,{header:{extra:[(0,n.jsx)(T.u,{access:"canSeeDockerVolumeManage",children:(0,n.jsx)(oe,{onFinish:function(){var m,d;!((m=i.current)===null||m===void 0)&&m.reloadAndRest&&((d=i.current)===null||d===void 0||d.reloadAndRest())}},"create")})]},children:[(0,n.jsx)(fe,{ref:x}),(0,n.jsx)(ge.Z,{scroll:{x:"max-content"},rowKey:"Name",pagination:(0,me.O)(),columns:[{title:"\u540D\u79F0",dataIndex:"Name",width:300,render:function(m,d,a,u,t){return(0,n.jsx)(B.Z,{content:d.Name})}},{title:"\u6240\u5C5E\u5BB9\u5668",ellipsis:!0,search:!1,render:function(m,d,a,u,t){return d.InUse?(0,n.jsx)(H.Z,{direction:"vertical",children:d.InUse.map(function(s,v){return(0,n.jsx)(R.Link,{target:"_blank",to:"/app/detail/edit/"+s.md5,children:(0,n.jsx)(G.Z,{color:"cyan",icon:(0,n.jsx)(he.Z,{}),children:(0,q.fi)(s.name,"/")})},v)})},a):(0,n.jsx)(G.Z,{children:"\u672A\u4F7F\u7528"})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:"\u6302\u8F7D\u70B9",search:!1,width:250,dataIndex:"Mountpoint",render:function(m,d,a,u,t){return(0,n.jsx)(B.Z,{content:d.Mountpoint})}},{title:"\u521B\u5EFA\u65F6\u95F4",ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(m,d,a,u,t){return new Date(d.CreatedAt).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,fixed:"right",hidden:!l.canSeeDockerVolumeManage,render:function(m,d,a,u,t){return(0,n.jsx)(H.Z,{split:(0,n.jsx)(Oe.Z,{type:"vertical"}),children:(0,n.jsx)(ne.Z.Link,{onClick:function(){var v;(v=x.current)===null||v===void 0||v.showDetail(d.Name)},children:(0,n.jsx)(Ee.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(ve.Z,{})})})})}}],request:function(){var O=c()(o()().mark(function m(d,a,u){var t,s;return o()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,h({name:d.name});case 2:return t=j.sent,s=[],t.data.inUse?s=t.data.list.map(function(Z){return t.data.inUse&&t.data.inUse[Z.Name]?Z.InUse=t.data.inUse[Z.Name]:Z.InUse=void 0,Z}):s=t.data.list,j.abrupt("return",{data:s,success:!0,total:t.data.list.length});case 6:case"end":return j.stop()}},m)}));return function(m,d,a){return O.apply(this,arguments)}}(),rowSelection:l.canSeeDockerVolumeManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:i,tableAlertOptionRender:function(m){var d=m.selectedRowKeys;return(0,n.jsxs)(H.Z,{size:16,children:[(0,n.jsx)(A.Z,{danger:!0,type:"primary",action:function(){return _({name:d})},onSuccess:function(){var u,t;return!((u=i.current)===null||u===void 0)&&u.reloadAndRest&&((t=i.current)===null||t===void 0||t.reloadAndRest()),!0},onError:function(){var u,t;return!((u=i.current)===null||u===void 0)&&u.reset&&((t=i.current)===null||t===void 0||t.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"}),(0,n.jsx)(A.Z,{action:function(){var u,t;return p({deleteAll:(u=(t=y.current)===null||t===void 0?void 0:t.getFieldValue("deleteAll"))!==null&&u!==void 0?u:!1})},onSuccess:function(){var u,t;return!((u=i.current)===null||u===void 0)&&u.reloadAndRest&&((t=i.current)===null||t===void 0||t.reloadAndRest()),!0},onError:function(){var u,t;return!((u=i.current)===null||u===void 0)&&u.reset&&((t=i.current)===null||t===void 0||t.reset()),!0},confirm:(0,n.jsx)(je.A,{formRef:y,submitter:!1,children:(0,n.jsxs)(H.Z,{style:{width:280},direction:"vertical",children:[(0,n.jsx)(ne.Z.Text,{children:N("notification.confirm.title")}),(0,n.jsx)(X.Z,{name:"deleteAll",valuePropName:"checked",children:(0,n.jsx)(De.Z,{children:"\u662F\u5426\u6E05\u7406\u975E\u533F\u540D\u5377\uFF1F"})})]})}),children:"\u6E05\u7406\u672A\u4F7F\u7528\u5B58\u50A8"},"clear")]})}})]})}},67255:function(z,C,e){e.d(C,{O:function(){return I},j:function(){return o}});function I(){var g=localStorage.getItem("dpanel-pagesize");return g=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(g!=null?g:"20")}}function o(g){var c="dpanel-table-column-".concat(g),T={};if(localStorage.getItem(c)){var A;T=JSON.parse((A=localStorage.getItem(c))!==null&&A!==void 0?A:"{}")}return{defaultValue:T,onChange:function(S){localStorage.setItem("dpanel-table-column-".concat(g),JSON.stringify(S))}}}}}]);
