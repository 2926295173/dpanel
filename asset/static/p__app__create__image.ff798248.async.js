"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{28307:function(Be,Q,u){var ae=u(5574),l=u.n(ae),re=u(38345),F=u(97269),p=u(5966),O=u(64317),U=u(62370),b=u(28036),te=u(85265),q=u(42075),C=u(67294),N=u(80821),ie=u(3393),oe=u(97961),de=u(92754),h=u(63713),v=u(85893),W=(0,C.forwardRef)(function(R,Z){var $=(0,C.useState)(!1),Ee=l()($,2),le=Ee[0],ne=Ee[1],z=(0,C.useRef)(),B=(0,C.useRef)();return(0,C.useImperativeHandle)(Z,function(){return{upgradeImage:function(g){var n;return ne(!0),(n=z.current)===null||n===void 0||n.setFieldValue("imageUrl",g),(0,ie.Gb)({tag:g,type:"pull"})},setImageName:function(g){var n;ne(!0),(n=z.current)===null||n===void 0||n.setFieldValue("imageUrl",g)}}}),[(0,v.jsx)(b.ZP,{type:R.buttonType?R.buttonType:"default",onClick:function(){var g,n;R.onClick&&R.onClick(),ne(!0),(g=z.current)===null||g===void 0||g.resetFields(),(n=B.current)===null||n===void 0||n.setStart("")},children:"\u62C9\u53D6\u955C\u50CF"},"remoteBtn"),(0,v.jsxs)(te.Z,{forceRender:!0,open:le,title:"\u4E0B\u8F7D\u8FDC\u7A0B\u955C\u50CF",width:800,onClose:function(){return ne(!1)},footer:!1,children:[(0,v.jsx)(re.Z,{children:(0,v.jsxs)(q.Z,{direction:"vertical",size:"middle",children:[(0,v.jsxs)("div",{children:["1\u3001\u955C\u50CF\u540D\u79F0\u4E2D\u4E0D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C \u9ED8\u8BA4\u4ECE ",(0,v.jsx)("a",{href:"https://hub.docker.com/",target:"_blank",children:"docker hub"})," \u4E2D\u4E0B\u8F7D\uFF0C \u4F60\u53EF\u4EE5\u5728\u4E0A\u9762",(0,v.jsx)("a",{href:"https://hub.docker.com/search?q=",target:"_blank",children:"\u3010\u67E5\u627E\u3011"}),"\u9700\u8981\u7684\u955C\u50CF"]}),(0,v.jsxs)("div",{children:["2\u3001\u955C\u50CF\u4E2D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C\u8BF7\u786E",(0,v.jsx)(h.Link,{to:"/image/registry",children:"\u3010\u6DFB\u52A0\u3011"}),"\u8FC7\u8BE5\u4ED3\u5E93\uFF0C\u5E76\u6709 Pull \u6743\u9650"]}),(0,v.jsxs)("div",{children:["3\u3001\u53EF\u5728",(0,v.jsx)(h.Link,{to:"/image/registry",children:"\u3010\u4ED3\u5E93\u7BA1\u7406\u3011"}),"\u4E2D\u914D\u7F6E\u955C\u50CF\u7684\u52A0\u901F\u5730\u5740"]})]})}),(0,v.jsx)(re.Z,{title:"\u4E0B\u8F7D\u955C\u50CF",headerBordered:!0,children:(0,v.jsxs)(F.A,{submitter:!1,formRef:z,children:[(0,v.jsxs)(q.Z.Compact,{children:[(0,v.jsx)(p.Z,{width:400,name:"imageUrl",placeholder:"\u8BF7\u8F93\u5165\u955C\u50CF\u5730\u5740"}),(0,v.jsx)(O.Z,{name:"platform",style:{width:150},placeholder:"\u9ED8\u8BA4\u5F53\u524D\u67B6\u6784",options:oe.ii.map(function(P){return{label:P.name,value:P.name}})}),(0,v.jsx)(N.Z,{action:function(){var g,n,xe,ge,je,ye=(g=(n=z.current)===null||n===void 0?void 0:n.getFieldValue("imageUrl"))!==null&&g!==void 0?g:"";return(xe=B.current)===null||xe===void 0||xe.setStart(ye),(0,ie.Gb)({tag:ye,type:"pull",platform:(ge=(je=z.current)===null||je===void 0?void 0:je.getFieldValue("platform"))!==null&&ge!==void 0?ge:""})},onSuccess:function(g){var n;(n=B.current)===null||n===void 0||n.setFinish(),ne(!1),R.onFinish&&R.onFinish(g.data.tag)},messageSuccess:"imagePull",children:"\u62C9\u53D6\u955C\u50CF"})]}),(0,v.jsx)(U.Z,{label:"\u4E0B\u8F7D\u8FDB\u5EA6",children:(0,v.jsx)(de.Z,{ref:B})})]})})]},"remoteDrawer")]});Q.Z=W},35880:function(Be,Q,u){var ae=u(67294),l=(0,ae.createContext)({});Q.Z=l},21965:function(Be,Q,u){u.r(Q),u.d(Q,{default:function(){return Du}});var ae=u(15009),l=u.n(ae),re=u(99289),F=u.n(re),p=u(5574),O=u.n(p),U=u(90078),b=u(38345),te=u(97269),q=u(2236),C=u(5966),N=u(97462),ie=u(64218),oe=u(92398),de=u(38925),h=u(67294),v=u(35880),W=u(10641),R=u(62370),Z=u(85576),$=u(42075),Ee=u(96074),le=u(25593),ne=u(83062),z=u(71230),B=u(15746),P=u(28036),g=u(3393),n=u(18148),xe=u(5251),ge=u(64789),je=u(75162),ye=u(85060),Ne=u(28307),Ve=u(78451),$e=u(99861),e=u(85893);function Ke(i){var I=(0,h.useState)(!1),x=O()(I,2),d=x[0],s=x[1],E=(0,h.useRef)(),r=(0,h.useContext)(v.Z),m=r.createFormRef,A=r.volumeListRef,D=r.createEnvRef,o=r.domainRef,c=(0,h.useRef)(),T=function(){var j=F()(l()().mark(function y(f){var w,V,H,_,K,X,L,Fe,J,ee,he,G;return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s(!1),a.next=3,(0,g.YU)({md5:f});case 3:_=a.sent,i.redeploy||(Fe=(K=m.current)===null||K===void 0?void 0:K.getFieldsValue(),(X=m.current)===null||X===void 0||X.resetFields(),(L=m.current)===null||L===void 0||L.setFieldsValue({siteName:Fe.siteName,siteTitle:Fe.siteTitle})),_.data.info.Config.Env&&_.data.info.Config.Env.map(function(t){var Y,ue=t.split("=");(Y=D.current)===null||Y===void 0||Y.addEnvItem(ue[0],ue.slice(1).join("="))}),(w=m.current)===null||w===void 0||w.setFieldValue("imageName",f),(V=m.current)===null||V===void 0||V.setFieldValue("workDir",_.data.info.Config.WorkingDir),(H=o.current)===null||H===void 0||H.setExposePort(_.data.info.Config.ExposedPorts),i.redeploy||(_.data.info.Config.Volumes?(he=[],Object.keys(_.data.info.Config.Volumes).map(function(t,Y){he.push(t)}),(ee=A.current)===null||ee===void 0||ee.setDefaultDestPath(he)):(G=A.current)===null||G===void 0||G.setDefaultDestPath([]),(J=m.current)===null||J===void 0||J.setFieldsValue({workDir:{value:"",useDefault:!0,default:_.data.info.Config.WorkingDir},user:{value:"",useDefault:!0,default:_.data.info.Config.User},command:{value:"",useDefault:!0,default:_.data.info.Config.Cmd&&_.data.info.Config.Cmd.join(" ")},entrypoint:{value:"",useDefault:!0,default:_.data.info.Config.Entrypoint&&_.data.info.Config.Entrypoint.join(" ")}}));case 10:case"end":return a.stop()}},y)}));return function(f){return j.apply(this,arguments)}}();return(0,h.useEffect)(function(){i.fromImageId&&T(i.fromImageId)},[i.fromImageId]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Z.Z,{open:d,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return s(!1)},children:(0,e.jsx)(W.Z,{scroll:{x:"max-content"},columns:[{title:"Id",dataIndex:"Id",search:!1,width:200,render:function(y,f,w,V,H){return(0,e.jsx)(Ve.Z,{content:f.Id})}},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",width:200,render:function(y,f,w,V){return(0,e.jsx)(Ve.Z,{content:f.RepoTags[0]})}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(y,f,w,V){return(0,e.jsx)("div",{children:(0,xe.ZM)(f.Created*1e3)},f.Id)},sorter:function(y,f){return y.Created-f.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:80,render:function(y,f,w,V){return(0,e.jsxs)($.Z,{split:(0,e.jsx)(Ee.Z,{type:"vertical"}),children:[(0,e.jsx)(le.Z.Link,{onClick:F()(l()().mark(function H(){return l()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",T(f.RepoTags[0]));case 1:case"end":return K.stop()}},H)})),children:(0,e.jsx)(ne.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(ge.Z,{})})},"addImage"),(0,e.jsx)(le.Z.Link,{onClick:F()(l()().mark(function H(){var _;return l()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:f.RepoTags[0]&&((_=c.current)===null||_===void 0||_.setImageName(f.RepoTags[0]));case 1:case"end":return X.stop()}},H)})),children:(0,e.jsx)(ne.Z,{title:"\u66F4\u65B0\u955C\u50CF",children:(0,e.jsx)(je.Z,{})})},"updateImage")]})}}],request:function(){var j=F()(l()().mark(function y(f,w,V){var H,_,K,X,L;return l()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return i.redeploy&&(_=(H=m.current)===null||H===void 0?void 0:H.getFieldValue("imageName"),f.tag=_?_.split(":")[0]:f.tag),J.next=3,(0,n.KG)({tag:f.tag});case 3:return K=J.sent,X=0,L=[],K.data.list&&(L=K.data.list.flatMap(function(ee){return ee.RepoTags.map(function(he){return{Key:X++,Id:ee.Id,Created:ee.Created,RepoTags:[he]}})})),J.abrupt("return",{data:L,success:!0,total:L.length});case 8:case"end":return J.stop()}},y)}));return function(y,f,w){return j.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(Ne.Z,{onClick:function(){s(!1)},buttonType:"primary",ref:c,onFinish:function(f){T(f)}},"remote")]},formRef:E,rowKey:"Key",pagination:{pageSize:5}})},"imageTableList"),(0,e.jsxs)(z.Z,{children:[(0,e.jsx)(B.Z,{span:14,children:(0,e.jsx)(C.Z,{label:"\u955C\u50CF",tooltip:i.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0})}),(0,e.jsx)(B.Z,{children:(0,e.jsx)(R.Z,{label:" ",children:(0,e.jsxs)($.Z.Compact,{children:[(0,e.jsx)(P.ZP,{type:"primary",onClick:function(){return s(!0)},children:i.redeploy?"\u66F4\u6362\u955C\u50CF":"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(N.Z,{name:["imageName"],children:function(y){var f=y.imageName;return i.redeploy?(0,e.jsx)($e.Z,{image:[f],trigger:(0,e.jsx)(ne.Z,{title:"\u91CD\u65B0\u62C9\u53D6\u5F53\u524D\u955C\u50CF",children:(0,e.jsx)(P.ZP,{icon:(0,e.jsx)(ye.Z,{}),children:"\u5347\u7EA7\u5F53\u524D\u955C\u50CF"})})}):(0,e.jsx)(Ne.Z,{onClick:function(){s(!1)},ref:c,onFinish:function(V){T(V)}},"remote")}})]})})})]})]})}var Ze=u(60335),Ye=u(51042),ce=u(24739),Ge=u(63434),De=u(17186),ze=u(27496),Xe=u(66309);function Je(i){return(0,e.jsx)(W.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"names",render:function(x,d,s,E){return(0,e.jsx)($.Z,{direction:"vertical",style:{textAlign:"left"},children:d==null?void 0:d.Names.map(function(r){return r})},d.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(x,d,s,E){return d!=null&&d.Ports?(0,e.jsx)($.Z,{direction:"vertical",style:{textAlign:"left"},children:d==null?void 0:d.Ports.map(function(r,m){return(0,e.jsx)(Xe.Z,{color:"#2db7f5",icon:r.PublicPort?(0,e.jsx)(ze.Z,{}):"",children:"".concat(r.PublicPort?r.IP+":"+r.PublicPort+"->":"").concat(r.PrivatePort,"/").concat(r.Type)},m)})},d.Id):(0,e.jsx)(e.Fragment,{})}},{title:"\u8FD0\u884C\u5BB9\u5668",search:!1,render:function(x,d,s,E){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(le.Z.Text,{ellipsis:{tooltip:d.Image},children:d.Image},d.Id)})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(x,d,s,E){return[(0,e.jsx)(P.ZP,{type:"link",onClick:function(){(0,Ze.jV)({md5:d.Id}).then(function(m){return i.onSelect&&i.onSelect(m.data.info),!0})},children:(0,e.jsx)(ge.Z,{})},d.Id)]}}],rowKey:"Id",request:function(){var I=F()(l()().mark(function x(d,s,E){return l()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",new Promise(function(A,D){(0,Ze.IE)({tag:d.names}).then(function(o){var c={data:o.data.list,success:!0,total:o.data.list.length};A(c)})}));case 1:case"end":return m.stop()}},x)}));return function(x,d,s){return I.apply(this,arguments)}}(),pagination:{pageSize:5}})}var Qe=(0,h.forwardRef)(function(i,I){var x=(0,h.useState)(!1),d=O()(x,2),s=d[0],E=d[1],r=(0,h.useRef)(),m=function(o){var c=(0,h.useState)([]),T=O()(c,2),j=T[0],y=T[1];return(0,h.useEffect)(function(){(0,Ze.jV)({md5:o.name}).then(function(f){var w;return y((w=f.data.info.Config.Env)!==null&&w!==void 0?w:[]),!0})},[]),(0,e.jsxs)(b.Z,{bordered:!0,extra:o.action,style:{marginBottom:10},children:[(0,e.jsx)(b.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(ce.UW,{children:[(0,e.jsx)(C.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(C.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(Ge.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(b.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)($.Z,{direction:"vertical",children:j&&j.map(function(f,w){return(0,e.jsx)(le.Z.Text,{copyable:{icon:(0,e.jsx)(Ye.Z,{}),onCopy:function(){var H=f.split("=");i.onAddEnv(H[0],H[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:f},style:{width:300},children:f},w)})},"linkEnv")})]})},A=function(o){var c,T,j=!1,y=(c=(T=r.current)===null||T===void 0?void 0:T.getList())!==null&&c!==void 0?c:[];if(y.map(function(w){w.name==o.name&&(j=!0)}),!j){var f;(f=r.current)===null||f===void 0||f.add(o)}};return(0,h.useImperativeHandle)(I,function(){return{setDefaultLink:function(o){o&&o.map(function(c){c.name!=""&&A(c)})}}}),(0,e.jsxs)(b.Z,{title:"\u5173\u8054\u5BB9\u5668",headerBordered:!0,children:[(0,e.jsx)(De.u,{name:"links",actionRef:r,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(o,c){return E(!0),!1}},copyIconProps:!1,min:0,itemRender:function(o,c){return(0,e.jsx)(m,{action:o.action,name:c.record.name})}}),(0,e.jsx)(Z.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:1024,footer:!1,open:s,onCancel:function(){return E(!1)},children:(0,e.jsx)(Je,{onSelect:function(o){A({name:o.Name,alise:o.Config.Hostname,volume:!1}),E(!1)}})})]})}),qe=Qe,eu=u(91058),Ae=u(64317),uu=(0,h.forwardRef)(function(i,I){var x=(0,h.useRef)();return(0,h.useImperativeHandle)(I,function(){return{setDefaultDestPath:function(s){var E,r,m=(E=(r=x.current)===null||r===void 0?void 0:r.getList())!==null&&E!==void 0?E:[];s.length!=0&&s.filter(function(A){return A!=""}).map(function(A){var D=!1;if(m.map(function(c){if(c.dest==A){D=!0;return}}),!D){var o;(o=x.current)===null||o===void 0||o.add({dest:A,permission:"write",inImage:!0})}})},addUserVolumeItem:function(s,E){var r,m=(r=x.current)===null||r===void 0?void 0:r.getList(),A=!1;if(m==null||m.map(function(o){if(o.dest==E){A=!0;return}}),!A){var D;(D=x.current)===null||D===void 0||D.add({host:s,dest:E})}}}}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(b.Z,{title:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u6216\u662F\u5B58\u50A8\u5377",tooltip:"\u6302\u8F7D\u53EF\u4EE5\u662F\u5BBF\u4E3B\u673A\u7684\u76EE\u5F55\u6216\u662F\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u5B58\u50A8\u5377\u540D\uFF08\u81EA\u52A8\u65B0\u5EFA\uFF09\u3002",headerBordered:!0,direction:"column",children:(0,e.jsx)(De.u,{actionRef:x,name:"volumes",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u6620\u5C04\u76EE\u5F55"},copyIconProps:!1,min:0,children:function(s,E,r){var m=r.getCurrentRowData();return(0,e.jsxs)(ce.UW,{children:[(0,e.jsxs)($.Z.Compact,{children:[(0,e.jsx)(C.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u3001\u76EE\u5F55\u6216\u5B58\u50A8\u5377",name:"host",width:i.showInDrawer?"sm":"md"}),(0,e.jsx)(Ae.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(C.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:i.showInDrawer?"sm":"md",required:!0,rules:[{required:!0}],disabled:i.disabledUserVolumeDest||m.inImage})]})}})})})}),tu=uu,nu=u(2831),se=u(52688),Le=u(86125),au=u(44349);function ru(i){var I,x=(0,h.useState)(),d=O()(x,2),s=d[0],E=d[1];return(0,h.useEffect)(function(){(0,nu.aF)().then(function(r){return E(r.data.info)})},[]),(0,e.jsxs)(b.Z,{children:[(0,e.jsx)(C.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:"64M",tooltip:"0 \u4E3A\u4F7F\u7528\u9ED8\u8BA464M"}),(0,e.jsx)(R.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Le.Z,{step:.1,max:s==null?void 0:s.NCPU,marks:{0:"0",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(R.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Le.Z,{step:256,max:Math.round(((I=s==null?void 0:s.MemTotal)!==null&&I!==void 0?I:0)/1024/1024),marks:{0:"0",1024:"1G",2048:"2G",3072:"3G",4096:"4G"}})}),(0,e.jsx)(Ae.Z,{label:"\u65E5\u5FD7\u7C7B\u578B",name:["log","driver"],tooltip:"\u9ED8\u8BA4\u4F7F\u7528 json-file \u9A71\u52A8\u7531 docker \u7EDF\u4E00\u7BA1\u7406\u3002\u91C7\u7528 journal \u65F6\u65E5\u5FD7\u5C06\u6765\u5BBF\u4E3B\u673A\u7BA1\u7406",initialValue:"json-file",valueEnum:{"json-file":"json-file",journald:"journal (\u5BBF\u4E3B\u9700\u8981\u5B89\u88C5journal\u670D\u52A1)"}}),(0,e.jsx)(N.Z,{name:["log"],children:function(m){var A=m.log;if(A.driver=="json-file")return(0,e.jsxs)(ce.UW,{children:[(0,e.jsx)(C.Z,{label:"\u65E5\u5FD7\u5207\u5272\u5C3A\u5BF8",name:["log","maxSize"],placeholder:"\u4F8B\u5982\uFF1A10k,5M",tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u5207\u5272\u65E5\u5FD7"}),(0,e.jsx)(C.Z,{tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u6E05\u7406\u65E5\u5FD7\u6587\u4EF6",label:"\u4FDD\u7559\u65E5\u5FD7\u6587\u4EF6\u6570",name:["log","maxFile"],placeholder:"\u4F8B\u5982\uFF1A10"})]})}}),(0,e.jsx)(au.Z,{name:"device",label:"\u5173\u8054\u8BBE\u5907",hideCopyButton:!0,showAddButton:!0,items:[{label:"\u5BBF\u4E3B\u673A\u8DEF\u5F84",name:"host",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"},{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"}]}),(0,e.jsxs)(z.Z,{children:[(0,e.jsx)(B.Z,{span:4,children:(0,e.jsx)(se.Z,{label:"\u4F7F\u7528 Gpu",name:["gpus","enable"]})}),(0,e.jsx)(B.Z,{span:20,children:(0,e.jsx)(N.Z,{name:["gpus"],children:function(m){var A=m.gpus;if(A&&A.enable)return(0,e.jsx)(Ae.Z,{mode:"tags",label:"\u8BBE\u5907\u5217\u8868",name:["gpus","device"],placeholder:"\u914D\u7F6E\u4F7F\u7528\u8BBE\u5907id\u6216\u662Fuuid\uFF0C\u4E0D\u586B\u6240\u4E3A\u6240\u6709\u8BBE\u5907"})}})})]}),(0,e.jsx)(N.Z,{name:["gpus"],children:function(m){var A=m.gpus;if(A&&A.enable)return(0,e.jsx)(Ae.Z,{label:"\u8BA1\u7B97\u80FD\u529B",name:["gpus","capabilities"],mode:"multiple",fieldProps:{allowClear:!0},options:[{label:"compute - \u8BA1\u7B97\u80FD\u529B",value:"compute"},{label:"compat32 - \u517C\u5BB932\u4F4D",value:"compat32"},{label:"graphics - \u56FE\u5F62\u5904\u7406\u80FD\u529B",value:"graphics"},{label:"utility - \u76D1\u63A7\u548C\u7BA1\u7406\u80FD\u529B",value:"utility"},{label:"video - \u89C6\u9891\u5904\u7406\u80FD\u529B",value:"video"},{label:"display - \u663E\u793A\u56FE\u5F62\u754C\u9762\u80FD\u529B",value:"display"}]})}})]})}function iu(){return(0,e.jsx)(b.Z,{title:"\u5BB9\u5668\u6807\u7B7E",children:(0,e.jsx)(De.u,{name:"label",label:"",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ce.UW,{children:[(0,e.jsx)(C.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(C.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var lu=u(44771),su=u(86615),Au="default",Iu="user";function ou(i){return(0,e.jsx)(R.Z,{label:i.label,tooltip:i.tooltip,children:(0,e.jsxs)($.Z.Compact,{block:!0,children:[(0,e.jsx)(su.Z.Group,{radioType:"button",name:[i.name,"useDefault"],options:[{label:"\u4F7F\u7528\u9ED8\u8BA4",value:!0},{label:"\u81EA\u5B9A\u4E49",value:!1}]}),(0,e.jsx)(N.Z,{name:[i.name],children:function(x){return x[i.name]&&x[i.name].useDefault?(0,e.jsx)(C.Z,{name:[i.name,"default"],disabled:!0,placeholder:"\u672A\u8BBE\u7F6E"}):(0,e.jsx)(C.Z,{name:[i.name,"value"]})}})]})})}var be=ou,we=u(24963);function du(){var i=(0,h.useContext)(we.Z),I=i.notice,x=i.lang;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(b.Z,{children:[(0,e.jsx)(lu.Z,{label:"\u91CD\u542F\u7B56\u7565"}),(0,e.jsxs)(ce.UW,{children:[(0,e.jsx)(se.Z,{fieldProps:{onChange:function(s){s&&I.warning(x("app.create.privilegedNotice"))}},name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(se.Z,{name:"autoRemove",label:"\u505C\u6B62\u540E\u81EA\u52A8\u5220\u9664",initialValue:!1}),(0,e.jsx)(se.Z,{fieldProps:{onChange:function(s){s&&I.warning(x("app.create.hostPidNotice"))}},name:"hostPid",label:"\u5173\u8054\u5BBF\u4E3B\u673APid",initialValue:!1})]}),(0,e.jsx)(be,{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55",name:"workDir"}),(0,e.jsx)(be,{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237",name:"user"}),(0,e.jsx)(be,{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command"}),(0,e.jsx)(be,{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4",name:"entrypoint"})]})})}var cu=u(91845),Me=u(62597),Ue=u(63713),mu=u(4798),fu=(0,h.forwardRef)(function(i,I){var x=(0,h.useState)(""),d=O()(x,2),s=d[0],E=d[1],r=(0,h.useRef)(),m=(0,h.useContext)(v.Z),A=m.createFormRef;return(0,h.useImperativeHandle)(I,function(){return{setExposePort:function(o){if(o){var c,T,j=(c=(T=r.current)===null||T===void 0?void 0:T.getList())!==null&&c!==void 0?c:[];Object.keys(o).map(function(y){var f=!1;if(j.map(function(V){V.dest==y&&(f=!0)}),!f){var w;(w=r.current)===null||w===void 0||w.add({host:"",dest:y})}})}},setHostname:function(o){E(o)},addPortItem:function(o,c){var T,j=(T=r.current)===null||T===void 0?void 0:T.getList(),y=!1;if(j==null||j.map(function(w){if(w.host==o){y=!0;return}}),!y){var f;(f=r.current)===null||f===void 0||f.add({host:String(o),dest:String(c)})}}}}),(0,e.jsx)(b.Z,{title:"\u7ED1\u5B9A\u7AEF\u53E3",tooltip:"\u8BBF\u95EE\u7AEF\u53E3\u7559\u7A7A\u65F6\u968F\u673A\u751F\u6210\u7AEF\u53E3\uFF0C\u5168\u90E8\u5220\u9664\u5219\u8868\u793A\u4E0D\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,extra:(0,e.jsxs)($.Z,{children:[i.showBindHost&&(0,e.jsx)(se.Z,{name:"useHostNetwork",fieldProps:{checkedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",unCheckedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",onChange:function(o){if(o){var c;(c=A.current)===null||c===void 0||c.setFieldsValue({bindIpV6:!1,publishAllPorts:!1})}}}}),i.showBindIpV6&&(0,e.jsx)(N.Z,{name:["siteName","useHostNetwork"],children:function(o){var c=o.useHostNetwork;return(0,e.jsx)(se.Z,{name:"publishAllPorts",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3",unCheckedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3"},disabled:c},"publishAllPorts")}}),i.showBindIpV6&&(0,e.jsx)(N.Z,{name:["siteName","useHostNetwork"],children:function(o){var c=o.useHostNetwork;return(0,e.jsx)(se.Z,{name:"bindIpV6",fieldProps:{checkedChildren:"IpV6",unCheckedChildren:"IpV6"},disabled:c},"bindIpV6")}})]}),children:(0,e.jsx)(N.Z,{name:["useHostNetwork","bindIpV6","publishAllPorts"],children:function(o){var c=o.useHostNetwork,T=o.bindIpV6,j=o.publishAllPorts;if(!c&&!j)return(0,e.jsx)(De.u,{name:"ports",actionRef:r,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(ce.UW,{children:[(0,e.jsx)(C.Z,{width:i.showInDrawer?"sm":"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u6DFB\u52A0\u8BBF\u95EE\u7AEF\u53E3\u6216\u662F\u521B\u5EFA\u5B8C\u6210\u540E\u5BF9\u5BB9\u5668\u7ED1\u5B9A\u57DF\u540D",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3\uFF0C\u7ED1\u5B9AIpV6\u5FC5\u586B",required:T,rules:[{required:T}]}),(0,e.jsx)(C.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:i.showInDrawer?"sm":"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3",required:!0,rules:[{required:!0}]})]})})}})})}),hu=fu;function fe(i){return(0,e.jsx)("div",{style:{display:i.show?"block":"none"},children:i.children})}function pu(){var i=(0,h.useRef)(),I=function(s){var E,r,m=!1,A=(E=(r=i.current)===null||r===void 0?void 0:r.getList())!==null&&E!==void 0?E:[];if(A.map(function(o){o.name==s.name&&(m=!0)}),!m){var D;(D=i.current)===null||D===void 0||D.add(s)}},x=function(s){var E,r,m=!1,A=(E=(r=i.current)===null||r===void 0?void 0:r.getList())!==null&&E!==void 0?E:[];A.map(function(D,o){if(D.name==s){var c;(c=i.current)===null||c===void 0||c.remove(o)}})};return(0,e.jsx)(b.Z,{title:"\u5173\u8054\u5BBF\u4E3B\u7F51\u7EDC\u4E3B\u673A",tooltip:"\u5BB9\u5668\u5185\u5982\u679C\u9700\u8981\u8BF7\u6C42\u5BBF\u4E3B\u673A\u6240\u5728\u7684\u7F51\u7EDC\u4E2D\u7684\u4E3B\u673A\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6B64\u914D\u7F6E\u5C06Ip\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D",extra:(0,e.jsx)($.Z,{children:(0,e.jsx)(se.Z,{name:"enableBindHost",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",unCheckedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",onChange:function(s){s?I({name:"host.dpanel.local",value:"host-gateway"}):x("host.dpanel.local")}}})}),children:(0,e.jsx)(De.u,{name:"extraHosts",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BBF\u4E3B\u673A\u7F51\u7EDC\u5173\u8054"},actionRef:i,copyIconProps:!1,min:0,children:(0,e.jsxs)(ce.UW,{children:[(0,e.jsx)(C.Z,{width:"md",name:"name",label:"Hostname",placeholder:""}),(0,e.jsx)(C.Z,{width:"md",name:"value",label:"ip",placeholder:""})]})})})}var Te=u(90672),vu=(0,h.forwardRef)(function(i,I){return(0,h.useImperativeHandle)(I,function(){return{}}),(0,e.jsxs)(b.Z,{title:"\u7F51\u7EDC\u914D\u7F6E",children:[(0,e.jsxs)(ce.UW,{children:[(0,e.jsx)(C.Z,{label:"\u914D\u7F6E ipV4 \u5730\u5740",name:["ipV4","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u5730\u5740\uFF0C\u4F8B\u5982 192.168.1.5",placeholder:"192.168.1.5"}),(0,e.jsx)(N.Z,{name:["ipV4"],children:function(d){var s=d.ipV4;return(0,e.jsx)(C.Z,{label:"\u914D\u7F6E ipV4 \u5B50\u7F51",name:["ipV4","subnet"],width:"md",required:s&&s.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 192.168.1.0/24",placeholder:"192.168.1.0/24",rules:[{required:s&&s.address}]})}}),(0,e.jsx)(C.Z,{label:"\u914D\u7F6E ipV4 \u7F51\u5173",name:["ipV4","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 192.168.1.1",placeholder:"192.168.1.1"}),(0,e.jsx)(se.Z,{label:"\u81EA\u5B9A\u4E49ipV6",name:"enableIpV6Address"})]}),(0,e.jsx)(N.Z,{name:["enableIpV6Address"],children:function(d){var s=d.enableIpV6Address;if(s)return(0,e.jsxs)(ce.UW,{children:[(0,e.jsx)(C.Z,{label:"\u914D\u7F6E ipV6 \u5730\u5740",name:["ipV6","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u5730\u5740\uFF0C\u4F8B\u5982 2001:db8::5",placeholder:"2001:db8::5"}),(0,e.jsx)(N.Z,{name:["ipV6"],children:function(r){var m=r.ipV6;return(0,e.jsx)(C.Z,{label:"\u914D\u7F6E ipV6 \u5B50\u7F51",name:["ipV6","subnet"],width:"md",required:m&&m.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 2001:db8::/48",placeholder:"2001:db8::/48",rules:[{required:m&&m.address}]})}}),(0,e.jsx)(C.Z,{label:"\u914D\u7F6E ipV6 \u7F51\u5173",name:["ipV6","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 2001:db8::1",placeholder:"2001:db8::1"})]})}}),(0,e.jsx)(Te.Z,{label:"DNS\u914D\u7F6E",name:"dns",placeholder:"\u8BF7\u6307\u5B9Adns\u5730\u5740\uFF0C\u4F8B\u5982\uFF1A8.8.8.8\uFF0C\u4E00\u884C\u6DFB\u4E00\u6761dns\u5730\u5740"})]})}),Eu=vu,Re=u(31199),gu=u(86250);function Fu(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(b.Z,{title:"\u9644\u52A0\u6267\u884C\u811A\u672C",headerBordered:!0,subTitle:"",children:(0,e.jsx)(Te.Z,{label:"\u5BB9\u5668\u521B\u5EFA\u540E\u6267\u884C\u811A\u672C",name:["hook","containerCreate"],placeholder:"\u5BB9\u5668\u5728\u521B\u5EFA\u540E\u6267\u884C\u7684\u811A\u672C\uFF0C\u6B64\u811A\u672C\u5E76\u4E0D\u4F1A\u5F71\u54CD entrypoint \u53CA command\u3002\u4F8B\u5982\uFF1Als -al && touch abc.txt && apt update"})}),(0,e.jsxs)(b.Z,{title:"\u5065\u5EB7\u68C0\u67E5",headerBordered:!0,children:[(0,e.jsxs)(gu.Z,{gap:20,justify:"start",children:[(0,e.jsx)(Re.Z,{label:"\u91CD\u590D\u95F4\u9694\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","interval"],initialValue:30}),(0,e.jsx)(Re.Z,{label:"\u8D85\u65F6\u5931\u8D25\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","timeout"],initialValue:10}),(0,e.jsx)(Re.Z,{label:"\u5931\u8D25\u91CD\u590D\u6B21\u6570",name:["healthcheck","retries"],initialValue:3}),(0,e.jsx)(Ae.Z,{width:"sm",label:"\u811A\u672C\u6267\u884C\u73AF\u5883",initialValue:"CMD",name:["healthcheck","shellType"],valueEnum:{CMD:"\u5728 Docker \u73AF\u5883\u6267\u884C","CMD-SHELL":"\u5728\u5BB9\u5668\u5185\u6267\u884C"}})]}),(0,e.jsx)(Te.Z,{label:"\u6267\u884C\u811A\u672C",name:["healthcheck","cmd"],placeholder:"\u914D\u7F6E\u5BB9\u5668\u5065\u5EB7\u68C0\u67E5\u811A\u672C\uFF0C\u4F8B\u5982\uFF1Acurl -f http://localhost:8080/ || exit 1"})]})]})}var Cu=u(74763),He=u(2487),Bu=[{name:"ALL"},{name:"AUDIT_CONTROL"},{name:"AUDIT_WRITE",default:!0},{name:"BLOCK_SUSPEND"},{name:"CHOWN",default:!0},{name:"DAC_OVERRIDE",default:!0},{name:"DAC_READ_SEARCH"},{name:"FOWNER",default:!0},{name:"FSETID",default:!0},{name:"IPC_LOCK"},{name:"IPC_OWNER"},{name:"KILL",default:!0},{name:"LEASE"},{name:"LINUX_IMMUTABLE"},{name:"MAC_ADMIN"},{name:"MAC_OVERRIDE"},{name:"MKNOD",default:!0},{name:"NET_ADMIN"},{name:"NET_BIND_SERVICE",default:!0},{name:"NET_BROADCAST"},{name:"NET_RAW",default:!0},{name:"SETFCAP",default:!0},{name:"SETGID",default:!0},{name:"SETPCAP",default:!0},{name:"SETUID",default:!0},{name:"SYSLOG"},{name:"SYS_ADMIN"},{name:"SYS_BOOT"},{name:"SYS_CHROOT",default:!0},{name:"SYS_MODULE"},{name:"SYS_NICE"},{name:"SYS_PACCT"},{name:"SYS_PTRACE"},{name:"SYS_RAWIO"},{name:"SYS_RESOURCE"},{name:"SYS_TIME"},{name:"SYS_TTY_CONFIG"}],xu=(0,h.forwardRef)(function(i,I){var x=(0,h.useContext)(we.Z),d=x.lang,s=(0,h.useState)(null),E=O()(s,2),r=E[0],m=E[1],A=(0,h.useContext)(v.Z),D=A.createFormRef;return(0,h.useImperativeHandle)(I,function(){return{}}),(0,e.jsx)(b.Z,{children:(0,e.jsx)(He.Z,{grid:{gutter:10,xs:3,sm:3,md:4,lg:4,xl:4,xxl:6},dataSource:Bu,renderItem:function(c,T){var j;return(0,e.jsx)(He.Z.Item,{children:(0,e.jsx)(se.Z,{fieldProps:{onChange:function(f){c.name=="ALL"&&m(f)}},disabled:c.name!="ALL"&&((0,Cu.k)(r)?(j=D.current)===null||j===void 0?void 0:j.getFieldValue(["capAdd","ALL"]):r),initialValue:c.default,name:["capAdd",c.name],tooltip:d("app.create.cap."+c.name.toLocaleLowerCase()),label:c.name})},T)}})})}),ju=xu,Ie="update",We="copy",_e="new";function Du(){var i,I,x,d=(0,h.useContext)(we.Z),s=d.loading,E=(0,h.useContext)(v.Z),r=E.createFormRef,m=E.volumeListRef,A=E.domainRef,D=E.createEnvRef,o=E.createLinkRef,c=(0,h.useState)(_e),T=O()(c,2),j=T[0],y=T[1],f=(0,Ue.useSearchParams)(),w=O()(f,2),V=w[0],H=w[1],_=(0,Ue.useNavigate)(),K=(0,h.useState)("basic"),X=O()(K,2),L=X[0],Fe=X[1],J=parseInt((i=V.get("id"))!==null&&i!==void 0?i:""),ee=(I=V.get("containerId"))!==null&&I!==void 0?I:"",he=(x=V.get("imageId"))!==null&&x!==void 0?x:"";return(0,h.useEffect)(function(){if(ee||J)s.show(),(0,Me.iE)({md5:ee,id:J}).then(function(){var M=F()(l()().mark(function a(t){var Y,ue,S,pe,me,Pe,Se,ke,Oe;return l()().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(S={info:{},layer:[]},!t.data.env.imageName){Ce.next=6;break}return Ce.next=4,(0,g.YU)({md5:t.data.env.imageName});case 4:pe=Ce.sent,S=pe.data;case 6:V.get("op")==We?y(We):y(Ie),t.data.env.network&&t.data.env.network.map(function(k){return!k.alise&&k.name!="bridge"&&(k.alise=[t.data.siteName+".pod.dpanel.local"]),k}),t.data.env.ports&&t.data.env.ports.map(function(k){return k.host=="0"&&(k.host=""),k}),me=t.data.env.bindIpV6,t.data.containerInfo.Info&&t.data.containerInfo.Info.NetworkSettings.Networks&&Object.keys(t.data.containerInfo.Info.NetworkSettings.Networks).map(function(k){t.data.env.network&&(t.data.env.network=t.data.env.network.map(function(ve){return k==ve.name&&(ve.subnet=t.data.containerInfo.Info.NetworkSettings.Networks[k].IPAddress+"/"+t.data.containerInfo.Info.NetworkSettings.Networks[k].IPPrefixLen),ve})),t.data.containerInfo.Info.NetworkSettings.Networks[k].IPv6Gateway!=""&&(me=!0)}),t.data.env.extraHosts&&t.data.env.extraHosts.map(function(k){if(k.value=="host-gateway"){var ve;(ve=r.current)===null||ve===void 0||ve.setFieldValue("enableBindHost",!0)}}),Pe=t.data.env.ports,t.data.env.ports&&(Pe=t.data.env.ports.map(function(k){return k.host=(k.hostIp?k.hostIp+":":"")+k.host,k})),(Y=r.current)===null||Y===void 0||Y.setFieldsValue({imageName:t.data.env.imageName,privileged:t.data.env.privileged,bindIpV6:t.data.env.useHostNetwork?!1:me,useHostNetwork:t.data.env.useHostNetwork,publishAllPorts:t.data.env.useHostNetwork?!1:t.data.env.publishAllPorts,workDir:{value:t.data.env.workDir,useDefault:!t.data.env.workDir,default:S&&S.info.Config&&S.info.Config.WorkingDir},user:{value:t.data.env.user,useDefault:!t.data.env.user,default:S&&S.info.Config&&S.info.Config.User},command:{value:t.data.env.command,useDefault:!t.data.env.command,default:S&&S.info.Config&&S.info.Config.Cmd&&S.info.Config.Cmd.join(" ")},entrypoint:{value:t.data.env.entrypoint,useDefault:!t.data.env.entrypoint,default:S&&S.info.Config&&S.info.Config.Entrypoint&&S.info.Config.Entrypoint.join(" ")},shmsize:(ue=t.data.env.shmsize)!==null&&ue!==void 0?ue:"64M",cpus:t.data.env.cpus,memory:t.data.env.memory,environment:t.data.env.environment,label:t.data.env.label,volumes:t.data.env.volumes,ports:Pe,links:t.data.env.links,network:t.data.env.network,restart:t.data.env.restart,extraHosts:t.data.env.extraHosts,autoRemove:t.data.env.autoRemove,log:t.data.env.log,dns:t.data.env.dns&&t.data.env.dns.join(`
`),ipV4:t.data.env.ipV4,ipV6:t.data.env.ipV6,gpus:t.data.env.gpus,device:t.data.env.device,hook:t.data.env.hook,hostPid:t.data.env.hostPid,capAdd:t.data.env.capAdd&&Object.fromEntries(t.data.env.capAdd.map(function(k){return[k,!0]}))}),t.data.env.ipV6&&((Se=r.current)===null||Se===void 0||Se.setFieldValue("enableIpV6Address",!0)),t.data.env.healthcheck&&t.data.env.healthcheck.cmd&&t.data.env.healthcheck.cmd!=""&&((ke=r.current)===null||ke===void 0||ke.setFieldsValue({healthcheck:t.data.env.healthcheck})),V.get("op")==Ie&&((Oe=r.current)===null||Oe===void 0||Oe.setFieldsValue({siteTitle:t.data.siteTitle,siteName:t.data.siteName}));case 18:case"end":return Ce.stop()}},a)}));return function(a){return M.apply(this,arguments)}}()).finally(function(){s.destroy()});else{var G;y(_e),(G=r.current)===null||G===void 0||G.resetFields()}},[V]),(0,e.jsx)(U._z,{children:(0,e.jsx)(b.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(te.A,{submitter:{render:function(M,a){return(0,e.jsx)(q.S,{children:a})}},formRef:r,onFinish:function(){var G=F()(l()().mark(function M(a){var t,Y,ue,S;return l()().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return S={siteTitle:a.siteTitle,siteName:a.siteName,imageName:a.imageName,environment:a.environment,links:a.links,ports:a.ports,volumes:a.volumes,network:a.network,privileged:(t=a.privileged)!==null&&t!==void 0?t:!1,autoRemove:(Y=a.autoRemove)!==null&&Y!==void 0?Y:!1,restart:a.restart,cpus:a.cpus,memory:a.memory,shmsize:(ue=a.shmsize)!==null&&ue!==void 0?ue:0,workDir:a.workDir&&!a.workDir.useDefault?a.workDir.value:"",user:a.user&&!a.user.useDefault?a.user.value:"",command:a.command&&!a.command.useDefault?a.command.value:"",entrypoint:a.entrypoint&&!a.entrypoint.useDefault?a.entrypoint.value:"",useHostNetwork:a.useHostNetwork,bindIpV6:a.bindIpV6,log:a.log,dns:a.dns&&a.dns!=""?a.dns.split(`
`):[],label:a.label,publishAllPorts:a.publishAllPorts,extraHosts:a.extraHosts,ipV4:a.ipV4,ipV6:a.ipV6,device:a.device,gpus:a.gpus,hook:a.hook,hostPid:a.hostPid,capAdd:a.capAdd?Object.keys(a.capAdd).map(function(Pe){return Pe}):[]},a.healthcheck&&a.healthcheck.cmd&&a.healthcheck.cmd!=""&&(S.healthcheck=a.healthcheck),ee&&j==Ie&&(S.containerId=ee),me.next=5,(0,Me.$G)(S);case 5:return _("/app/list"),me.abrupt("return",!0);case 7:case"end":return me.stop()}},M)}));return function(M){return G.apply(this,arguments)}}(),children:[(0,e.jsxs)(b.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(C.Z,{name:"siteTitle",label:"\u5BB9\u5668\u63CF\u8FF0",fieldProps:{onChange:function(M){var a="";if(M.target.value&&j!=Ie){var t,Y=(0,cu.N9)(M.target.value.trim(),{toneType:"none",type:"array"});a=Y.join(""),(t=r.current)===null||t===void 0||t.setFieldValue("siteName",a)}}},placeholder:"\u8BF7\u8F93\u5165\u5BB9\u5668\u63CF\u8FF0\u540D\u79F0"}),(0,e.jsx)(C.Z,{name:"siteName",label:"\u5BB9\u5668\u6807\u8BC6",tooltip:"\u5BB9\u5668\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u5BB9\u5668\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:j==Ie,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u5BB9\u5668\u6807\u8BC6\u540D\u79F0"}),(0,e.jsx)(Ke,{redeploy:j!=_e,fromImageId:he})]}),(0,e.jsx)(ie.Z,{offsetTop:50,children:(0,e.jsx)(b.Z,{style:{marginBottom:-20},children:(0,e.jsx)(oe.Z,{activeKey:L,onChange:function(M){Fe(M),window.scrollTo(0,450)},items:[{label:"\u57FA\u672C\u914D\u7F6E",key:"basic"},{label:"\u5173\u8054\u914D\u7F6E",key:"link"},{label:"\u5B58\u50A8\u914D\u7F6E",key:"storage"},{label:"\u8FD0\u884C\u914D\u7F6E",key:"run-command"},{label:"\u8D44\u6E90\u914D\u7F6E",key:"resource"},{label:"Hook",key:"hook"},{label:"\u80FD\u529B\u914D\u7F6E",key:"cap"},{label:"\u5176\u5B83",key:"other"}]})})}),(0,e.jsxs)(fe,{show:L=="basic",children:[(0,e.jsx)(hu,{ref:A,showBindHost:!0,showBindIpV6:!0}),(0,e.jsx)(eu.Z,{showAddButton:!0,showImportButton:!0,showCodeMode:!0,label:"\u73AF\u5883\u53D8\u91CF",ref:D}),(0,e.jsx)(N.Z,{name:["siteName","useHostNetwork"],children:function(M){var a=M.siteName,t=M.useHostNetwork;if(!t)return(0,e.jsx)(Eu,{})}})]}),(0,e.jsx)(fe,{show:L=="link",children:(0,e.jsx)(N.Z,{name:["siteName","useHostNetwork"],children:function(M){var a=M.siteName,t=M.useHostNetwork;return t?(0,e.jsx)(de.Z,{showIcon:!0,description:"\u7ED1\u5B9A\u5230\u5BBF\u4E3B\u673A\u7F51\u7EDC\u65F6\uFF0C\u65E0\u6CD5\u901A\u8FC7 Docker \u5173\u8054\u5176\u5B83\u5BB9\u5668\u3002\u8BF7\u4F7F\u7528\u5BBF\u4E3B\u673A\u5185\u7F51IP\u6216\u662F127.0.0.1\u4E92\u8054\u5BB9\u5668\u66B4\u9732\u7AEF\u53E3\u3002"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qe,{onAddEnv:function(ue,S){var pe;(pe=D.current)===null||pe===void 0||pe.addEnvItem(ue,S)},ref:o}),(0,e.jsx)(mu.Z,{siteName:a}),(0,e.jsx)(pu,{})]})}})}),(0,e.jsx)(fe,{show:L=="storage",children:(0,e.jsx)(tu,{showDefault:!0,ref:m})}),(0,e.jsx)(fe,{show:L=="run-command",children:(0,e.jsx)(du,{})}),(0,e.jsx)(fe,{show:L=="resource",children:(0,e.jsx)(ru,{})}),(0,e.jsx)(fe,{show:L=="hook",children:(0,e.jsx)(Fu,{})}),(0,e.jsx)(fe,{show:L=="other",children:(0,e.jsx)(iu,{})}),(0,e.jsx)(fe,{show:L=="cap",children:(0,e.jsx)(ju,{})})]},"form")})})}},97961:function(Be,Q,u){u.d(Q,{GH:function(){return C},MF:function(){return de},_2:function(){return ie},fN:function(){return U},ii:function(){return O},vC:function(){return te}});var ae=u(15009),l=u.n(ae),re=u(99289),F=u.n(re),p=u(63713),O=[{name:"linux/amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"linux/arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"linux/i386",arch:"386",search:[]},{name:"linux/arm/v6",arch:"arm",search:[]},{name:"linux/arm/v7",arch:"arm",search:[]},{name:"linux/arm/v8",arch:"arm64",search:[]},{name:"linux/ppc64le",arch:"ppc64le",search:[]},{name:"linux/riscv64",arch:"riscv64",search:[]}];function U(v){return b.apply(this,arguments)}function b(){return b=F()(l()().mark(function v(W){return l()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,p.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:W}));case 1:case"end":return Z.stop()}},v)})),b.apply(this,arguments)}function te(v){return q.apply(this,arguments)}function q(){return q=F()(l()().mark(function v(W){return l()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,p.request)("/api/app/image/import-by-container-tar",{method:"POST",data:W}));case 1:case"end":return Z.stop()}},v)})),q.apply(this,arguments)}function C(v){return N.apply(this,arguments)}function N(){return N=F()(l()().mark(function v(W){return l()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,p.request)("/api/app/image/import-by-image-tar",{method:"POST",data:W}));case 1:case"end":return Z.stop()}},v)})),N.apply(this,arguments)}function ie(v){return oe.apply(this,arguments)}function oe(){return oe=F()(l()().mark(function v(W){return l()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,p.request)("/api/common/attach/delete",{method:"POST",data:W});case 2:return Z.abrupt("return",Z.sent);case 3:case"end":return Z.stop()}},v)})),oe.apply(this,arguments)}function de(){return h.apply(this,arguments)}function h(){return h=F()(l()().mark(function v(){return l()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,p.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return R.stop()}},v)})),h.apply(this,arguments)}},18148:function(Be,Q,u){u.d(Q,{$q:function(){return oe},Fj:function(){return Ee},KG:function(){return O},KX:function(){return ne},T8:function(){return N},Xn:function(){return q},ao:function(){return h},c5:function(){return Z},c7:function(){return W}});var ae=u(15009),l=u.n(ae),re=u(99289),F=u.n(re),p=u(63713);function O(B){return U.apply(this,arguments)}function U(){return U=F()(l()().mark(function B(P){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/app/image/get-list",{method:"POST",data:P}));case 1:case"end":return n.stop()}},B)})),U.apply(this,arguments)}function b(B){return te.apply(this,arguments)}function te(){return te=_asyncToGenerator(_regeneratorRuntime().mark(function B(P){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,request("/api/app/log/image-build",{method:"POST",data:P});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),te.apply(this,arguments)}function q(B){return C.apply(this,arguments)}function C(){return C=F()(l()().mark(function B(P){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/app/image/get-list-build",{method:"POST",data:P}));case 1:case"end":return n.stop()}},B)})),C.apply(this,arguments)}function N(B){return ie.apply(this,arguments)}function ie(){return ie=F()(l()().mark(function B(P){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,p.request)("/api/app/image/get-build-task",{method:"POST",data:P});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),ie.apply(this,arguments)}function oe(B){return de.apply(this,arguments)}function de(){return de=F()(l()().mark(function B(P){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,p.request)("/api/app/image/delete-build-task",{method:"POST",data:P});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),de.apply(this,arguments)}function h(B){return v.apply(this,arguments)}function v(){return v=F()(l()().mark(function B(P){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,p.request)("/api/app/image/image-delete",{method:"POST",data:P});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),v.apply(this,arguments)}function W(){return R.apply(this,arguments)}function R(){return R=F()(l()().mark(function B(){return l()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,p.request)("/api/app/image/image-prune",{method:"POST"});case 2:return g.abrupt("return",g.sent);case 3:case"end":return g.stop()}},B)})),R.apply(this,arguments)}function Z(){return $.apply(this,arguments)}function $(){return $=F()(l()().mark(function B(){return l()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,p.request)("/api/app/image/build-prune",{method:"POST"});case 2:return g.abrupt("return",g.sent);case 3:case"end":return g.stop()}},B)})),$.apply(this,arguments)}function Ee(B){return le.apply(this,arguments)}function le(){return le=F()(l()().mark(function B(P){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,p.request)("/api/app/image/update-title",{method:"POST",data:P});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),le.apply(this,arguments)}function ne(B){return z.apply(this,arguments)}function z(){return z=F()(l()().mark(function B(P){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/app/image/tag-sync",{method:"POST",data:P}));case 1:case"end":return n.stop()}},B)})),z.apply(this,arguments)}},5251:function(Be,Q,u){u.d(Q,{FI:function(){return l},ZM:function(){return re}});function ae(F){return F.trim()}function l(F){var p="";F<.1*1024?p=F.toFixed(2)+"B":F<.1*1024*1024?p=(F/1024).toFixed(2)+"KB":F<1*1024*1024*1024?p=(F/(1024*1024)).toFixed(2)+"MB":p=(F/(1024*1024*1024)).toFixed(2)+"GB";var O=p+"",U=O.indexOf("."),b=O.substring(U+1,U+3);return b=="00"?O.substring(0,U)+O.substr(U+3,2):p}function re(F){if(F){var p=new Date(F),O=p.getFullYear()+"-",U=(p.getMonth()+1<10?"0"+(p.getMonth()+1):p.getMonth()+1)+"-",b=(p.getDate()<10?"0"+p.getDate():p.getDate())+" ",te=(p.getHours()<10?"0"+p.getHours():p.getHours())+":",q=(p.getMinutes()<10?"0"+p.getMinutes():p.getMinutes())+":",C=p.getSeconds()<10?"0"+p.getSeconds():p.getSeconds();return O+U+b+te+q+C}}}}]);
