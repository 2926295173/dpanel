"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{99861:function(je,Q,n){var te=n(15009),l=n.n(te),re=n(64599),F=n.n(re),W=n(99289),T=n.n(W),O=n(5574),x=n.n(O),p=n(42119),se=n(83062),o=n(67294),j=n(92754),q=n(3393),u=n(184),K=n(38345),a=n(85893),i=(0,o.forwardRef)(function(Y,y){(0,o.useImperativeHandle)(y,function(){return{start:function(){return De(!0),Pe()},finish:function(){De(!1)}}});var V=(0,o.useState)(0),Z=x()(V,2),E=Z[0],s=Z[1],M=(0,o.useRef)(),d=(0,o.useState)(!1),Ce=x()(d,2),xe=Ce[0],De=Ce[1],Pe=function(){var ae=T()(l()().mark(function L(){var D,H,N,z,ne,e,C;return l()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:H=0,N=F()(Y.image),w.prev=2,N.s();case 4:if((z=N.n()).done){w.next=14;break}return e=z.value,s(H),(ne=M.current)===null||ne===void 0||ne.setStart(e),w.next=10,(0,q.Gb)({tag:e,type:"pull"});case 10:C=w.sent,H++;case 12:w.next=4;break;case 14:w.next=19;break;case 16:w.prev=16,w.t0=w.catch(2),N.e(w.t0);case 19:return w.prev=19,N.f(),w.finish(19);case 22:(D=M.current)===null||D===void 0||D.setFinish(),s(H);case 24:case"end":return w.stop()}},L,null,[[2,16,19,22]])}));return function(){return ae.apply(this,arguments)}}();return(0,a.jsxs)(u.a,{trigger:Y.trigger,width:800,open:xe,submitter:!1,title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",onOpenChange:function(){var ae=T()(l()().mark(function L(D){return l()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:De(D),D&&Y.trigger&&Pe();case 2:case"end":return N.stop()}},L)}));return function(L){return ae.apply(this,arguments)}}(),drawerProps:{forceRender:!0},children:[(0,a.jsx)(K.Z,{children:(0,a.jsx)(p.Z,{current:E,items:Y.image.map(function(ae,L){return{title:(0,a.jsx)(se.Z,{title:ae,children:ae.length>15?ae.substring(0,6)+" ... "+ae.substring(ae.length-6):ae}),key:L}})})}),(0,a.jsx)(K.Z,{children:(0,a.jsx)(j.Z,{ref:M})})]})});Q.Z=i},91058:function(je,Q,n){var te=n(5574),l=n.n(te),re=n(89035),F=n(38345),W=n(17186),T=n(24739),O=n(5966),x=n(42075),p=n(28036),se=n(85576),o=n(67294),j=n(95089),q=n(12491),u=n(85893),K="docker-image",a=(0,o.forwardRef)(function(i,Y){var y=(0,o.useState)(K),V=l()(y,2),Z=V[0],E=V[1],s=(0,o.useRef)(),M=(0,o.useState)(""),d=l()(M,2),Ce=d[0],xe=d[1],De=function(){Z!="code"?E("code"):E(K)};(0,o.useImperativeHandle)(Y,function(){return{addEnvItem:function(D,H){var N,z=(N=s.current)===null||N===void 0?void 0:N.getList(),ne=!1;if(z==null||z.map(function(C){if(C.name==D){ne=!0;return}}),!ne){var e;(e=s.current)===null||e===void 0||e.add({name:D,value:H})}},clear:function(){var D;(D=s.current)===null||D===void 0||(D=D.getList())===null||D===void 0||D.map(function(H,N){var z;(z=s.current)===null||z===void 0||z.remove(N)})}}});function Pe(L){try{var D,H;L==""&&(L=ae());for(var N=(D=(H=s.current)===null||H===void 0||(H=H.getList())===null||H===void 0?void 0:H.length)!==null&&D!==void 0?D:0,z=N;z>=0;z--){var ne;(ne=s.current)===null||ne===void 0||ne.remove(z)}var e=L.split(`
`),C=0;e.map(function(de){var w,ee=de.split("=");ee.length<2||((w=s.current)===null||w===void 0||w.add({name:ee[0],value:ee.slice(1).join("=")},C),C++)})}catch(de){console.log(de)}}function ae(){if(s&&s.current&&s.current.getList){var L,D=(L=s.current)===null||L===void 0?void 0:L.getList();if(D){var H=[];return D.map(function(N){H.push("".concat(N.name,"=").concat(N.value))}),H.join(`
`)}else return""}else return""}return(0,u.jsxs)(F.Z,{ghost:i.showCardGhost,title:i.label?i.label:null,headerBordered:!0,extra:(i.showCodeMode||i.showImportButton)&&(0,u.jsxs)(x.Z,{children:[i.showImportButton&&(0,u.jsx)("div",{style:{marginBottom:"-25px"},children:(0,u.jsx)(q.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(D){return Pe(D),!0},onLoad:function(D){if(D.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),i.showCodeMode?(0,u.jsx)(p.ZP,{icon:(0,u.jsx)(re.Z,{}),type:Z=="code"?"primary":"default",onClick:De,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,u.jsx)(W.u,{name:i.name?i.name:"environment",actionRef:s,creatorButtonProps:i.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,min:100,label:i.listLabel,children:function(D,H,N){var z=N.getCurrentRowData();return(0,u.jsxs)(T.UW,{children:[(0,u.jsx)(O.Z,{width:i.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:i.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),(0,u.jsx)(O.Z,{width:i.showInDrawer?"sm":"md",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:!!i.requireValue}],disabled:i.showDisableValue,placeholder:z&&z.label?z.label:"\u8F93\u5165\u53D8\u91CF\u503C"})]})}}),(0,u.jsx)(se.Z,{width:"800px",open:Z=="code",onCancel:function(){return E("docker-image")},onOk:function(){Pe(Ce),E("docker-image")},children:(0,u.jsx)(j.ZP,{onChange:function(D){return xe(D)},value:ae(),height:"680px",theme:"light"})})]})});Q.Z=a},4798:function(je,Q,n){var te=n(15009),l=n.n(te),re=n(99289),F=n.n(re),W=n(5574),T=n.n(W),O=n(24963),x=n(14946),p=n(64789),se=n(38345),o=n(17186),j=n(24739),q=n(5966),u=n(62370),K=n(10641),a=n(31418),i=n(25593),Y=n(85576),y=n(66309),V=n(42075),Z=n(28036),E=n(67294),s=n(85893),M=(0,E.forwardRef)(function(d,Ce){var xe=(0,E.useContext)(O.Z),De=xe.notice,Pe=(0,E.useState)(!1),ae=T()(Pe,2),L=ae[0],D=ae[1],H=(0,E.useRef)(),N=a.Z.useApp();(0,E.useImperativeHandle)(Ce,function(){return{}});var z=function(e){var C,de,w=!1,ee=(C=(de=H.current)===null||de===void 0?void 0:de.getList())!==null&&C!==void 0?C:[];if(ee.map(function(_e){_e.name==e.name&&(w=!0)}),!w){var Ae;(Ae=H.current)===null||Ae===void 0||Ae.add(e)}};return(0,s.jsxs)(se.Z,{title:"\u5173\u8054\u7F51\u7EDC",headerBordered:!0,children:[(0,s.jsx)(o.u,{name:"network",actionRef:H,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u7F51\u7EDC"},actionGuard:{beforeAddRow:function(e,C){return!d.siteName||d.siteName==""||typeof d.siteName=="undefined"?(De.error("\u8BF7\u8F93\u5165\u7AD9\u70B9\u6807\u8BC6"),!1):(D(!0),!1)}},copyIconProps:!1,min:0,itemRender:function(e,C){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(j.UW,{children:[(0,s.jsx)(q.Z,{label:"\u7F51\u7EDC\u540D\u79F0",name:"name",width:"md",disabled:!0,fieldProps:{value:C.record.name}}),(0,s.jsx)(u.Z,{label:"\u8BBF\u95EEHostname",name:"alise",children:C.record.alise!=""&&(0,s.jsx)(i.Z.Text,{code:!0,copyable:!0,children:C.record.alise})}),(0,s.jsx)(u.Z,{label:" ",children:e.action})]}),(0,s.jsx)(j.UW,{children:(0,s.jsx)(q.Z,{label:"\u6307\u5B9AIpV4",name:"ipV4",width:"md",fieldProps:{addonAfter:C.record.subnet}})})]})}}),(0,s.jsx)(Y.Z,{title:"\u9009\u62E9\u7F51\u7EDC",width:1024,footer:!1,open:L,onCancel:function(){return D(!1)},children:(0,s.jsx)(K.Z,{rowKey:"Name",toolBarRender:!1,columns:[{title:"\u540D\u79F0",dataIndex:"Name",render:function(e,C,de,w,ee){return C.Name=="none"||C.Name=="bridge"||C.Name=="host"?(0,s.jsxs)(s.Fragment,{children:[C.Name," ",(0,s.jsx)(y.Z,{color:"blue",children:"System"})]}):(0,s.jsx)(s.Fragment,{children:e})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,dataIndex:"Driver",search:!1},{title:"IPAM Driver",ellipsis:!0,width:120,search:!1,dataIndex:["IPAM","Driver"]},{title:"IPV4 IPAM Network",search:!1,dataIndex:["IPAM","Config",0,"Subnet"],render:function(e,C,de,w,ee){return(0,s.jsxs)(V.Z,{children:[C.IPAM.Config&&C.IPAM.Config[0]&&"".concat(C.IPAM.Config[0].Subnet," - ").concat(C.IPAM.Config[0].Gateway),C.IPAM.Config&&C.IPAM.Config[1]&&"".concat(C.IPAM.Config[1].Subnet," - ").concat(C.IPAM.Config[1].Gateway)]})}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(e,C,de,w,ee){return[(0,s.jsx)(Z.ZP,{type:"link",onClick:function(){z({name:C.Name,alise:[""],subnet:C.IPAM.Config[0].Subnet}),D(!1)},children:(0,s.jsx)(p.Z,{})},C.Id)]}}],request:function(){var ne=F()(l()().mark(function e(C,de,w){var ee;return l()().wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:return _e.next=2,(0,x.jR)({name:C.Name});case 2:return ee=_e.sent,_e.abrupt("return",{data:ee.data.list,success:!0,total:ee.data.list.length});case 4:case"end":return _e.stop()}},e)}));return function(e,C,de){return ne.apply(this,arguments)}}(),pagination:{pageSize:10}})})]})});Q.Z=M},92067:function(je,Q,n){n.d(Q,{Z:function(){return j}});var te=n(15009),l=n.n(te),re=n(99289),F=n.n(re),W=n(60335),T=n(64789),O=n(10641),x=n(42075),p=n(28036),se=n(37413),o=n(85893);function j(q){return(0,o.jsx)(O.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"names",render:function(K,a,i,Y){return(0,o.jsx)(x.Z,{direction:"vertical",style:{textAlign:"left"},children:a==null?void 0:a.Names.map(function(y){return y})},a.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(K,a,i,Y){var y=[],V=[];return a!=null&&a.Ports&&a.Ports.map(function(Z,E){Z.PublicPort?y.push(Z):V.push(Z)}),(0,o.jsx)(se.Z,{publicPort:y,privatePort:V,domain:[]})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(K,a,i,Y){return[(0,o.jsx)(p.ZP,{type:"link",onClick:function(){(0,W.jV)({md5:a.Id}).then(function(V){return q.onSelect&&q.onSelect(V.data.info),!0})},children:(0,o.jsx)(T.Z,{})},a.Id)]}}],rowKey:"Id",request:function(){var u=F()(l()().mark(function K(a,i,Y){return l()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.abrupt("return",new Promise(function(Z,E){(0,W.IE)({tag:a.names}).then(function(s){var M={data:s.data.list,success:!0,total:s.data.list.length};Z(M)})}));case 1:case"end":return V.stop()}},K)}));return function(K,a,i){return u.apply(this,arguments)}}(),pagination:{pageSize:5}})}},52255:function(je,Q,n){n.d(Q,{Z:function(){return re}});var te=n(67294),l=n(85893);function re(F){return(0,l.jsx)("div",{style:{display:F.show?"block":"none"},children:F.children})}},44349:function(je,Q,n){var te=n(97857),l=n.n(te),re=n(17186),F=n(5966),W=n(86250),T=n(67294),O=n(85893),x=(0,T.forwardRef)(function(p,se){var o=(0,T.useRef)();(0,T.useImperativeHandle)(se,function(){return{addItem:function(u,K){var a,i=(a=o.current)===null||a===void 0?void 0:a.getList(),Y=!1;if(i==null||i.map(function(V){if(V.name==u){Y=!0;return}}),!Y){var y;(y=o.current)===null||y===void 0||y.add({name:u,value:K})}},clear:function(){var u;(u=o.current)===null||u===void 0||(u=u.getList())===null||u===void 0||u.map(function(K,a){var i;(i=o.current)===null||i===void 0||i.remove(a)})}}});var j={};return p.hideCopyButton===!0&&(j.copyIconProps=!1),p.hideDeleteButton===!0&&(j.deleteIconProps=!1),(0,O.jsx)(re.u,l()(l()({initialValue:p.initialValue,label:p.label,name:p.name,actionRef:o,creatorButtonProps:p.showAddButton?{creatorButtonText:"\u6DFB\u52A0"+(p.label?p.label:p.name)}:!1,min:p.min?p.min:0},j),{},{children:function(u,K,a){return(0,O.jsx)(W.Z,{justify:p.justify,gap:p.gap,children:p.items.map(function(i){return i.render?(0,O.jsx)("div",{children:i.render&&i.render(u,K,a)},"".concat(p.name,"-").concat(i.name,"-").concat(u.key)):(0,O.jsx)(F.Z,{width:i.width,name:i.name,label:i.label,required:i.required,rules:[{required:i.required}],disabled:i.disabled,placeholder:i.placeholder},"".concat(p.name,"-").concat(i.name,"-").concat(u.key))})})}}))});Q.Z=x},12491:function(je,Q,n){n.d(Q,{Z:function(){return x}});var te=n(24963),l=n(88484),re=n(62370),F=n(31418),W=n(28036),T=n(67294),O=n(85893);function x(p){var se=(0,T.useContext)(te.Z),o=se.message,j=se.notice,q=se.lang,u=(0,T.useRef)(null),K=F.Z.useApp(),a=function(){u.current&&(u.current.click(),u.current.onchange=function(Y){if(!Y||!Y.target)return"";var y=new FileReader;y.onload=function(Z){var E,s,M=(E=Z.target)===null||E===void 0?void 0:E.result;if(p.onLoad)try{p.onLoad&&p.onLoad(M)}catch(d){j.error(d);return}typeof p.onImport=="function"&&(o.success("\u6210\u529F\u5BFC\u5165 ".concat(p.title)),p.onImport(M)),(s=u.current)!==null&&s!==void 0&&s.value&&(u.current.value="")};var V=Y.target;if(V.files)try{y.readAsText(V.files[0])}catch(Z){j.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(re.Z,{children:(0,O.jsx)(W.ZP,{icon:(0,O.jsx)(l.Z,{}),block:!0,onClick:a,children:p.title})}),(0,O.jsx)("input",{style:{display:"none"},type:"file",ref:u,name:"importFileInput"})]})}},35880:function(je,Q,n){var te=n(67294),l=(0,te.createContext)({});Q.Z=l},80378:function(je,Q,n){n.r(Q),n.d(Q,{default:function(){return Pn}});var te=n(15009),l=n.n(te),re=n(99289),F=n.n(re),W=n(5574),T=n.n(W),O=n(90078),x=n(38345),p=n(97269),se=n(2236),o=n(5966),j=n(97462),q=n(64218),u=n(92398),K=n(38925),a=n(67294),i=n(35880),Y=n(10641),y=n(62370),V=n(85576),Z=n(42075),E=n(96074),s=n(25593),M=n(83062),d=n(71230),Ce=n(15746),xe=n(28036),De=n(3393),Pe=n(18148),ae=n(5251),L=n(64789),D=n(75162),H=n(85060),N=n(28307),z=n(78451),ne=n(99861),e=n(85893);function C(_){var $=(0,a.useState)(!1),R=T()($,2),k=R[0],h=R[1],B=(0,a.useRef)(),c=(0,a.useContext)(i.Z),g=c.createFormRef,A=c.volumeListRef,I=c.createEnvRef,m=c.domainRef,f=(0,a.useRef)(),S=function(){var P=F()(l()().mark(function b(v){var U,ue,ie,G,ce,ve,oe,be,he,Ee,Oe,fe;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return h(!1),r.next=3,(0,De.YU)({md5:v});case 3:G=r.sent,_.redeploy||(be=(ce=g.current)===null||ce===void 0?void 0:ce.getFieldsValue(),(ve=g.current)===null||ve===void 0||ve.resetFields(),(oe=g.current)===null||oe===void 0||oe.setFieldsValue({siteName:be.siteName,siteTitle:be.siteTitle})),G.data.info.Config.Env&&G.data.info.Config.Env.map(function(t){var me,pe=t.split("=");(me=I.current)===null||me===void 0||me.addEnvItem(pe[0],pe.slice(1).join("="))}),(U=g.current)===null||U===void 0||U.setFieldValue("imageName",v),(ue=g.current)===null||ue===void 0||ue.setFieldValue("workDir",G.data.info.Config.WorkingDir),(ie=m.current)===null||ie===void 0||ie.setExposePort(G.data.info.Config.ExposedPorts),_.redeploy||(G.data.info.Config.Volumes?(Oe=[],Object.keys(G.data.info.Config.Volumes).map(function(t,me){Oe.push(t)}),(Ee=A.current)===null||Ee===void 0||Ee.setDefaultDestPath(Oe)):(fe=A.current)===null||fe===void 0||fe.setDefaultDestPath([]),(he=g.current)===null||he===void 0||he.setFieldsValue({workDir:{value:"",useDefault:!0,default:G.data.info.Config.WorkingDir},user:{value:"",useDefault:!0,default:G.data.info.Config.User},command:{value:"",useDefault:!0,default:G.data.info.Config.Cmd&&G.data.info.Config.Cmd.join(" ")},entrypoint:{value:"",useDefault:!0,default:G.data.info.Config.Entrypoint&&G.data.info.Config.Entrypoint.join(" ")}}));case 10:case"end":return r.stop()}},b)}));return function(v){return P.apply(this,arguments)}}();return(0,a.useEffect)(function(){_.fromImageId&&S(_.fromImageId)},[_.fromImageId]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(V.Z,{open:k,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return h(!1)},children:(0,e.jsx)(Y.Z,{scroll:{x:"max-content"},columns:[{title:"Id",dataIndex:"Id",search:!1,width:200,render:function(b,v,U,ue,ie){return(0,e.jsx)(z.Z,{content:v.Id})}},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",width:200,render:function(b,v,U,ue){return(0,e.jsx)(z.Z,{content:v.RepoTags[0]})}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(b,v,U,ue){return(0,e.jsx)("div",{children:(0,ae.ZM)(v.Created*1e3)},v.Id)},sorter:function(b,v){return b.Created-v.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:80,render:function(b,v,U,ue){return(0,e.jsxs)(Z.Z,{split:(0,e.jsx)(E.Z,{type:"vertical"}),children:[(0,e.jsx)(s.Z.Link,{onClick:F()(l()().mark(function ie(){return l()().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.abrupt("return",S(v.RepoTags[0]));case 1:case"end":return ce.stop()}},ie)})),children:(0,e.jsx)(M.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(L.Z,{})})},"addImage"),(0,e.jsx)(s.Z.Link,{onClick:F()(l()().mark(function ie(){var G;return l()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:v.RepoTags[0]&&((G=f.current)===null||G===void 0||G.setImageName(v.RepoTags[0]));case 1:case"end":return ve.stop()}},ie)})),children:(0,e.jsx)(M.Z,{title:"\u66F4\u65B0\u955C\u50CF",children:(0,e.jsx)(D.Z,{})})},"updateImage")]})}}],request:function(){var P=F()(l()().mark(function b(v,U,ue){var ie,G,ce,ve,oe;return l()().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return _.redeploy&&(G=(ie=g.current)===null||ie===void 0?void 0:ie.getFieldValue("imageName"),v.tag=G?G.split(":")[0]:v.tag),he.next=3,(0,Pe.KG)({tag:v.tag});case 3:return ce=he.sent,ve=0,oe=[],ce.data.list&&(oe=ce.data.list.flatMap(function(Ee){return Ee.RepoTags.map(function(Oe){return{Key:ve++,Id:Ee.Id,Created:Ee.Created,RepoTags:[Oe]}})})),he.abrupt("return",{data:oe,success:!0,total:oe.length});case 8:case"end":return he.stop()}},b)}));return function(b,v,U){return P.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(N.Z,{onClick:function(){h(!1)},buttonType:"primary",ref:f,onFinish:function(v){S(v)}},"remote")]},formRef:B,rowKey:"Key",pagination:{pageSize:5}})},"imageTableList"),(0,e.jsxs)(d.Z,{children:[(0,e.jsx)(Ce.Z,{span:14,children:(0,e.jsx)(o.Z,{label:"\u955C\u50CF",tooltip:_.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0})}),(0,e.jsx)(Ce.Z,{children:(0,e.jsx)(y.Z,{label:" ",children:(0,e.jsxs)(Z.Z.Compact,{children:[(0,e.jsx)(xe.ZP,{type:"primary",onClick:function(){return h(!0)},children:_.redeploy?"\u66F4\u6362\u955C\u50CF":"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(j.Z,{name:["imageName"],children:function(b){var v=b.imageName;return _.redeploy?(0,e.jsx)(ne.Z,{image:[v],trigger:(0,e.jsx)(M.Z,{title:"\u91CD\u65B0\u62C9\u53D6\u5F53\u524D\u955C\u50CF",children:(0,e.jsx)(xe.ZP,{icon:(0,e.jsx)(H.Z,{}),children:"\u62C9\u53D6\u5F53\u524D\u955C\u50CF"})})}):(0,e.jsx)(N.Z,{onClick:function(){h(!1)},ref:f,onFinish:function(ue){S(ue)}},"remote")}})]})})})]})]})}var de=n(60335),w=n(51042),ee=n(24739),Ae=n(63434),_e=n(17186),ze=n(85265),Xe=n(92067),Je=(0,a.forwardRef)(function(_,$){var R=(0,a.useState)(!1),k=T()(R,2),h=k[0],B=k[1],c=(0,a.useRef)(),g=function(m){var f=(0,a.useState)([]),S=T()(f,2),P=S[0],b=S[1];return(0,a.useEffect)(function(){(0,de.jV)({md5:m.name}).then(function(v){var U;return b((U=v.data.info.Config.Env)!==null&&U!==void 0?U:[]),!0})},[]),(0,e.jsxs)(x.Z,{bordered:!0,extra:m.action,style:{marginBottom:10},children:[(0,e.jsx)(x.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(ee.UW,{children:[(0,e.jsx)(o.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(o.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(Ae.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(x.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(Z.Z,{direction:"vertical",children:P&&P.map(function(v,U){return(0,e.jsx)(s.Z.Text,{copyable:{icon:(0,e.jsx)(w.Z,{}),onCopy:function(){var ie=v.split("=");_.onAddEnv(ie[0],ie[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:v},style:{width:300},children:v},U)})},"linkEnv")})]})},A=function(m){var f,S,P=!1,b=(f=(S=c.current)===null||S===void 0?void 0:S.getList())!==null&&f!==void 0?f:[];if(b.map(function(U){U.name==m.name&&(P=!0)}),!P){var v;(v=c.current)===null||v===void 0||v.add(m)}};return(0,a.useImperativeHandle)($,function(){return{setDefaultLink:function(m){m&&m.map(function(f){f.name!=""&&A(f)})}}}),(0,e.jsxs)(x.Z,{title:"\u5173\u8054\u5BB9\u5668",headerBordered:!0,children:[(0,e.jsx)(_e.u,{name:"links",actionRef:c,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(m,f){return B(!0),!1}},copyIconProps:!1,min:0,itemRender:function(m,f){return(0,e.jsx)(g,{action:m.action,name:f.record.name})}}),(0,e.jsx)(ze.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:800,footer:!1,open:h,onClose:function(){return B(!1)},children:(0,e.jsx)(Xe.Z,{onSelect:function(m){A({name:m.Name,alise:m.Config.Hostname,volume:!1}),B(!1)}})})]})}),Qe=Je,qe=n(91058),Te=n(64317),en=(0,a.forwardRef)(function(_,$){var R=(0,a.useRef)();return(0,a.useImperativeHandle)($,function(){return{setDefaultDestPath:function(h){var B,c,g=(B=(c=R.current)===null||c===void 0?void 0:c.getList())!==null&&B!==void 0?B:[];h.length!=0&&h.filter(function(A){return A!=""}).map(function(A){var I=!1;if(g.map(function(f){if(f.dest==A){I=!0;return}}),!I){var m;(m=R.current)===null||m===void 0||m.add({dest:A,permission:"write",inImage:!0})}})},addUserVolumeItem:function(h,B){var c,g=(c=R.current)===null||c===void 0?void 0:c.getList(),A=!1;if(g==null||g.map(function(m){if(m.dest==B){A=!0;return}}),!A){var I;(I=R.current)===null||I===void 0||I.add({host:h,dest:B})}}}}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(x.Z,{title:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u6216\u662F\u5B58\u50A8\u5377",tooltip:"\u6302\u8F7D\u53EF\u4EE5\u662F\u5BBF\u4E3B\u673A\u7684\u76EE\u5F55\u6216\u662F\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u5B58\u50A8\u5377\u540D\uFF08\u81EA\u52A8\u65B0\u5EFA\uFF09\u3002",headerBordered:!0,direction:"column",children:(0,e.jsx)(_e.u,{actionRef:R,name:"volumes",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u6620\u5C04\u76EE\u5F55"},copyIconProps:!1,min:0,children:function(h,B,c){var g=c.getCurrentRowData();return(0,e.jsxs)(ee.UW,{children:[(0,e.jsxs)(Z.Z.Compact,{children:[(0,e.jsx)(o.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u3001\u76EE\u5F55\u6216\u5B58\u50A8\u5377",name:"host",width:_.showInDrawer?"sm":"md"}),(0,e.jsx)(Te.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(o.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:_.showInDrawer?"sm":"md",required:!0,rules:[{required:!0}],disabled:_.disabledUserVolumeDest||g.inImage})]})}})})})}),nn=en,tn=n(2831),Be=n(52688),Ve=n(86125),an=n(44349);function un(_){var $,R=(0,a.useState)(),k=T()(R,2),h=k[0],B=k[1];return(0,a.useEffect)(function(){(0,tn.aF)().then(function(c){return B(c.data.info)})},[]),(0,e.jsxs)(x.Z,{children:[(0,e.jsx)(o.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:"64M",tooltip:"0 \u4E3A\u4F7F\u7528\u9ED8\u8BA464M"}),(0,e.jsx)(y.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Ve.Z,{step:.1,max:h==null?void 0:h.NCPU,marks:{0:"0",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(y.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Ve.Z,{step:256,max:Math.round((($=h==null?void 0:h.MemTotal)!==null&&$!==void 0?$:0)/1024/1024),marks:{0:"0",1024:"1G",2048:"2G",3072:"3G",4096:"4G"}})}),(0,e.jsx)(Te.Z,{label:"\u65E5\u5FD7\u7C7B\u578B",name:["log","driver"],tooltip:"\u9ED8\u8BA4\u4F7F\u7528 json-file \u9A71\u52A8\u7531 docker \u7EDF\u4E00\u7BA1\u7406\u3002\u91C7\u7528 journal \u65F6\u65E5\u5FD7\u5C06\u6765\u5BBF\u4E3B\u673A\u7BA1\u7406",initialValue:"json-file",valueEnum:{"json-file":"json-file",journald:"journal (\u5BBF\u4E3B\u9700\u8981\u5B89\u88C5journal\u670D\u52A1)"}}),(0,e.jsx)(j.Z,{name:["log"],children:function(g){var A=g.log;if(A.driver=="json-file")return(0,e.jsxs)(ee.UW,{children:[(0,e.jsx)(o.Z,{label:"\u65E5\u5FD7\u5207\u5272\u5C3A\u5BF8",name:["log","maxSize"],placeholder:"\u4F8B\u5982\uFF1A10k,5M",tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u5207\u5272\u65E5\u5FD7"}),(0,e.jsx)(o.Z,{tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u6E05\u7406\u65E5\u5FD7\u6587\u4EF6",label:"\u4FDD\u7559\u65E5\u5FD7\u6587\u4EF6\u6570",name:["log","maxFile"],placeholder:"\u4F8B\u5982\uFF1A10"})]})}}),(0,e.jsx)(an.Z,{name:"device",label:"\u5173\u8054\u8BBE\u5907",hideCopyButton:!0,showAddButton:!0,items:[{label:"\u5BBF\u4E3B\u673A\u8DEF\u5F84",name:"host",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"},{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"}]}),(0,e.jsxs)(d.Z,{children:[(0,e.jsx)(Ce.Z,{span:4,children:(0,e.jsx)(Be.Z,{label:"\u4F7F\u7528 Gpu",name:["gpus","enable"]})}),(0,e.jsx)(Ce.Z,{span:20,children:(0,e.jsx)(j.Z,{name:["gpus"],children:function(g){var A=g.gpus;if(A&&A.enable)return(0,e.jsx)(Te.Z,{mode:"tags",label:"\u8BBE\u5907\u5217\u8868",name:["gpus","device"],placeholder:"\u914D\u7F6E\u4F7F\u7528\u8BBE\u5907id\u6216\u662Fuuid\uFF0C\u4E0D\u586B\u6240\u4E3A\u6240\u6709\u8BBE\u5907"})}})})]}),(0,e.jsx)(j.Z,{name:["gpus"],children:function(g){var A=g.gpus;if(A&&A.enable)return(0,e.jsx)(Te.Z,{label:"\u8BA1\u7B97\u80FD\u529B",name:["gpus","capabilities"],mode:"multiple",fieldProps:{allowClear:!0},options:[{label:"compute - \u8BA1\u7B97\u80FD\u529B",value:"compute"},{label:"compat32 - \u517C\u5BB932\u4F4D",value:"compat32"},{label:"graphics - \u56FE\u5F62\u5904\u7406\u80FD\u529B",value:"graphics"},{label:"utility - \u76D1\u63A7\u548C\u7BA1\u7406\u80FD\u529B",value:"utility"},{label:"video - \u89C6\u9891\u5904\u7406\u80FD\u529B",value:"video"},{label:"display - \u663E\u793A\u56FE\u5F62\u754C\u9762\u80FD\u529B",value:"display"}]})}})]})}function rn(){return(0,e.jsx)(x.Z,{title:"\u5BB9\u5668\u6807\u7B7E",children:(0,e.jsx)(_e.u,{name:"label",label:"",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ee.UW,{children:[(0,e.jsx)(o.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(o.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var sn=n(44771),on=n(86615),Fn="default",xn="user";function ln(_){return(0,e.jsx)(y.Z,{label:_.label,tooltip:_.tooltip,children:(0,e.jsxs)(Z.Z.Compact,{block:!0,children:[(0,e.jsx)(on.Z.Group,{radioType:"button",name:[_.name,"useDefault"],options:[{label:"\u4F7F\u7528\u9ED8\u8BA4",value:!0},{label:"\u81EA\u5B9A\u4E49",value:!1}]}),(0,e.jsx)(j.Z,{name:[_.name],children:function(R){return R[_.name]&&R[_.name].useDefault?(0,e.jsx)(o.Z,{name:[_.name,"default"],disabled:!0,placeholder:"\u672A\u8BBE\u7F6E"}):(0,e.jsx)(o.Z,{name:[_.name,"value"]})}})]})})}var Le=ln,we=n(24963);function dn(){var _=(0,a.useContext)(we.Z),$=_.notice,R=_.lang;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(x.Z,{children:[(0,e.jsx)(sn.Z,{label:"\u91CD\u542F\u7B56\u7565"}),(0,e.jsxs)(ee.UW,{children:[(0,e.jsx)(Be.Z,{fieldProps:{onChange:function(h){h&&$.warning(R("app.create.privilegedNotice"))}},name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(Be.Z,{name:"autoRemove",label:"\u505C\u6B62\u540E\u81EA\u52A8\u5220\u9664",initialValue:!1}),(0,e.jsx)(Be.Z,{fieldProps:{onChange:function(h){h&&$.warning(R("app.create.hostPidNotice"))}},name:"hostPid",label:"\u5173\u8054\u5BBF\u4E3B\u673APid",initialValue:!1})]}),(0,e.jsx)(Le,{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55",name:"workDir"}),(0,e.jsx)(Le,{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237",name:"user"}),(0,e.jsx)(Le,{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command"}),(0,e.jsx)(Le,{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4",name:"entrypoint"})]})})}var cn=n(91845),He=n(62597),$e=n(63713),mn=n(4798),_n=(0,a.forwardRef)(function(_,$){var R=(0,a.useState)(""),k=T()(R,2),h=k[0],B=k[1],c=(0,a.useRef)(),g=(0,a.useContext)(i.Z),A=g.createFormRef;return(0,a.useImperativeHandle)($,function(){return{setExposePort:function(m){if(m){var f,S,P=(f=(S=c.current)===null||S===void 0?void 0:S.getList())!==null&&f!==void 0?f:[];Object.keys(m).map(function(b){var v=!1;if(P.map(function(ue){ue.dest==b&&(v=!0)}),!v){var U;(U=c.current)===null||U===void 0||U.add({host:"",dest:b})}})}},setHostname:function(m){B(m)},addPortItem:function(m,f){var S,P=(S=c.current)===null||S===void 0?void 0:S.getList(),b=!1;if(P==null||P.map(function(U){if(U.host==m){b=!0;return}}),!b){var v;(v=c.current)===null||v===void 0||v.add({host:String(m),dest:String(f)})}}}}),(0,e.jsx)(x.Z,{title:"\u7ED1\u5B9A\u7AEF\u53E3",tooltip:"\u8BBF\u95EE\u7AEF\u53E3\u7559\u7A7A\u65F6\u968F\u673A\u751F\u6210\u7AEF\u53E3\uFF0C\u5168\u90E8\u5220\u9664\u5219\u8868\u793A\u4E0D\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,extra:(0,e.jsxs)(Z.Z,{children:[_.showBindHost&&(0,e.jsx)(Be.Z,{name:"useHostNetwork",fieldProps:{checkedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",unCheckedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",onChange:function(m){if(m){var f;(f=A.current)===null||f===void 0||f.setFieldsValue({bindIpV6:!1,publishAllPorts:!1})}}}}),_.showBindIpV6&&(0,e.jsx)(j.Z,{name:["siteName","useHostNetwork"],children:function(m){var f=m.useHostNetwork;return(0,e.jsx)(Be.Z,{name:"publishAllPorts",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3",unCheckedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3"},disabled:f},"publishAllPorts")}}),_.showBindIpV6&&(0,e.jsx)(j.Z,{name:["siteName","useHostNetwork"],children:function(m){var f=m.useHostNetwork;return(0,e.jsx)(Be.Z,{name:"bindIpV6",fieldProps:{checkedChildren:"IpV6",unCheckedChildren:"IpV6"},disabled:f},"bindIpV6")}})]}),children:(0,e.jsx)(j.Z,{name:["useHostNetwork","bindIpV6","publishAllPorts"],children:function(m){var f=m.useHostNetwork,S=m.bindIpV6,P=m.publishAllPorts;if(!f&&!P)return(0,e.jsx)(_e.u,{name:"ports",actionRef:c,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(ee.UW,{children:[(0,e.jsx)(o.Z,{width:_.showInDrawer?"sm":"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u6DFB\u52A0\u8BBF\u95EE\u7AEF\u53E3\u6216\u662F\u521B\u5EFA\u5B8C\u6210\u540E\u5BF9\u5BB9\u5668\u7ED1\u5B9A\u57DF\u540D",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3\uFF0C\u7ED1\u5B9AIpV6\u5FC5\u586B",required:S,rules:[{required:S}]}),(0,e.jsx)(o.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:_.showInDrawer?"sm":"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3",required:!0,rules:[{required:!0}]})]})})}})})}),fn=_n,Ie=n(52255);function vn(){var _=(0,a.useRef)(),$=function(h){var B,c,g=!1,A=(B=(c=_.current)===null||c===void 0?void 0:c.getList())!==null&&B!==void 0?B:[];if(A.map(function(m){m.name==h.name&&(g=!0)}),!g){var I;(I=_.current)===null||I===void 0||I.add(h)}},R=function(h){var B,c,g=!1,A=(B=(c=_.current)===null||c===void 0?void 0:c.getList())!==null&&B!==void 0?B:[];A.map(function(I,m){if(I.name==h){var f;(f=_.current)===null||f===void 0||f.remove(m)}})};return(0,e.jsx)(x.Z,{title:"\u5173\u8054\u5BBF\u4E3B\u7F51\u7EDC\u4E3B\u673A",tooltip:"\u5BB9\u5668\u5185\u5982\u679C\u9700\u8981\u8BF7\u6C42\u5BBF\u4E3B\u673A\u6240\u5728\u7684\u7F51\u7EDC\u4E2D\u7684\u4E3B\u673A\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6B64\u914D\u7F6E\u5C06Ip\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D",extra:(0,e.jsx)(Z.Z,{children:(0,e.jsx)(Be.Z,{name:"enableBindHost",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",unCheckedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",onChange:function(h){h?$({name:"host.dpanel.local",value:"host-gateway"}):R("host.dpanel.local")}}})}),children:(0,e.jsx)(_e.u,{name:"extraHosts",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BBF\u4E3B\u673A\u7F51\u7EDC\u5173\u8054"},actionRef:_,copyIconProps:!1,min:0,children:(0,e.jsxs)(ee.UW,{children:[(0,e.jsx)(o.Z,{width:"md",name:"name",label:"Hostname",placeholder:""}),(0,e.jsx)(o.Z,{width:"md",name:"value",label:"ip",placeholder:""})]})})})}var Ue=n(90672),hn=(0,a.forwardRef)(function(_,$){return(0,a.useImperativeHandle)($,function(){return{}}),(0,e.jsxs)(x.Z,{title:"\u7F51\u7EDC\u914D\u7F6E",children:[(0,e.jsxs)(ee.UW,{children:[(0,e.jsx)(o.Z,{label:"\u914D\u7F6E ipV4 \u5730\u5740",name:["ipV4","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u5730\u5740\uFF0C\u4F8B\u5982 192.168.1.5",placeholder:"192.168.1.5"}),(0,e.jsx)(j.Z,{name:["ipV4"],children:function(k){var h=k.ipV4;return(0,e.jsx)(o.Z,{label:"\u914D\u7F6E ipV4 \u5B50\u7F51",name:["ipV4","subnet"],width:"md",required:h&&h.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 192.168.1.0/24",placeholder:"192.168.1.0/24",rules:[{required:h&&h.address}]})}}),(0,e.jsx)(o.Z,{label:"\u914D\u7F6E ipV4 \u7F51\u5173",name:["ipV4","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 192.168.1.1",placeholder:"192.168.1.1"}),(0,e.jsx)(Be.Z,{label:"\u81EA\u5B9A\u4E49ipV6",name:"enableIpV6Address"})]}),(0,e.jsx)(j.Z,{name:["enableIpV6Address"],children:function(k){var h=k.enableIpV6Address;if(h)return(0,e.jsxs)(ee.UW,{children:[(0,e.jsx)(o.Z,{label:"\u914D\u7F6E ipV6 \u5730\u5740",name:["ipV6","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u5730\u5740\uFF0C\u4F8B\u5982 2001:db8::5",placeholder:"2001:db8::5"}),(0,e.jsx)(j.Z,{name:["ipV6"],children:function(c){var g=c.ipV6;return(0,e.jsx)(o.Z,{label:"\u914D\u7F6E ipV6 \u5B50\u7F51",name:["ipV6","subnet"],width:"md",required:g&&g.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 2001:db8::/48",placeholder:"2001:db8::/48",rules:[{required:g&&g.address}]})}}),(0,e.jsx)(o.Z,{label:"\u914D\u7F6E ipV6 \u7F51\u5173",name:["ipV6","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 2001:db8::1",placeholder:"2001:db8::1"})]})}}),(0,e.jsx)(Ue.Z,{label:"DNS\u914D\u7F6E",name:"dns",placeholder:"\u8BF7\u6307\u5B9Adns\u5730\u5740\uFF0C\u4F8B\u5982\uFF1A8.8.8.8\uFF0C\u4E00\u884C\u6DFB\u4E00\u6761dns\u5730\u5740"})]})}),En=hn,We=n(31199),pn=n(86250);function Cn(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(x.Z,{title:"\u9644\u52A0\u6267\u884C\u811A\u672C",headerBordered:!0,subTitle:"",children:(0,e.jsx)(Ue.Z,{label:"\u5BB9\u5668\u521B\u5EFA\u540E\u6267\u884C\u811A\u672C",name:["hook","containerCreate"],placeholder:"\u5BB9\u5668\u5728\u521B\u5EFA\u540E\u6267\u884C\u7684\u811A\u672C\uFF0C\u6B64\u811A\u672C\u5E76\u4E0D\u4F1A\u5F71\u54CD entrypoint \u53CA command\u3002\u4F8B\u5982\uFF1Als -al && touch abc.txt && apt update"})}),(0,e.jsxs)(x.Z,{title:"\u5065\u5EB7\u68C0\u67E5",headerBordered:!0,children:[(0,e.jsxs)(pn.Z,{gap:20,justify:"start",children:[(0,e.jsx)(We.Z,{label:"\u91CD\u590D\u95F4\u9694\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","interval"],initialValue:30}),(0,e.jsx)(We.Z,{label:"\u8D85\u65F6\u5931\u8D25\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","timeout"],initialValue:10}),(0,e.jsx)(We.Z,{label:"\u5931\u8D25\u91CD\u590D\u6B21\u6570",name:["healthcheck","retries"],initialValue:3}),(0,e.jsx)(Te.Z,{width:"sm",label:"\u811A\u672C\u6267\u884C\u73AF\u5883",initialValue:"CMD",name:["healthcheck","shellType"],valueEnum:{CMD:"\u5728 Docker \u73AF\u5883\u6267\u884C","CMD-SHELL":"\u5728\u5BB9\u5668\u5185\u6267\u884C"}})]}),(0,e.jsx)(Ue.Z,{label:"\u6267\u884C\u811A\u672C",name:["healthcheck","cmd"],placeholder:"\u914D\u7F6E\u5BB9\u5668\u5065\u5EB7\u68C0\u67E5\u811A\u672C\uFF0C\u4F8B\u5982\uFF1Acurl -f http://localhost:8080/ || exit 1"})]})]})}var gn=n(74763),Ge=n(2487),jn=[{name:"ALL"},{name:"AUDIT_CONTROL"},{name:"AUDIT_WRITE",default:!0},{name:"BLOCK_SUSPEND"},{name:"CHOWN",default:!0},{name:"DAC_OVERRIDE",default:!0},{name:"DAC_READ_SEARCH"},{name:"FOWNER",default:!0},{name:"FSETID",default:!0},{name:"IPC_LOCK"},{name:"IPC_OWNER"},{name:"KILL",default:!0},{name:"LEASE"},{name:"LINUX_IMMUTABLE"},{name:"MAC_ADMIN"},{name:"MAC_OVERRIDE"},{name:"MKNOD",default:!0},{name:"NET_ADMIN"},{name:"NET_BIND_SERVICE",default:!0},{name:"NET_BROADCAST"},{name:"NET_RAW",default:!0},{name:"SETFCAP",default:!0},{name:"SETGID",default:!0},{name:"SETPCAP",default:!0},{name:"SETUID",default:!0},{name:"SYSLOG"},{name:"SYS_ADMIN"},{name:"SYS_BOOT"},{name:"SYS_CHROOT",default:!0},{name:"SYS_MODULE"},{name:"SYS_NICE"},{name:"SYS_PACCT"},{name:"SYS_PTRACE"},{name:"SYS_RAWIO"},{name:"SYS_RESOURCE"},{name:"SYS_TIME"},{name:"SYS_TTY_CONFIG"}],Dn=(0,a.forwardRef)(function(_,$){var R=(0,a.useContext)(we.Z),k=R.lang,h=(0,a.useState)(null),B=T()(h,2),c=B[0],g=B[1],A=(0,a.useContext)(i.Z),I=A.createFormRef;return(0,a.useImperativeHandle)($,function(){return{}}),(0,e.jsx)(x.Z,{children:(0,e.jsx)(Ge.Z,{grid:{gutter:10,xs:3,sm:3,md:4,lg:4,xl:4,xxl:6},dataSource:jn,renderItem:function(f,S){var P;return(0,e.jsx)(Ge.Z.Item,{children:(0,e.jsx)(Be.Z,{fieldProps:{onChange:function(v){f.name=="ALL"&&g(v)}},disabled:f.name!="ALL"&&((0,gn.k)(c)?(P=I.current)===null||P===void 0?void 0:P.getFieldValue(["capAdd","ALL"]):c),initialValue:f.default,name:["capAdd",f.name],tooltip:k("app.create.cap."+f.name.toLocaleLowerCase()),label:f.name})},S)}})})}),Bn=Dn,Ze="update",Ye="copy",Se="new";function Pn(){var _,$,R,k=(0,a.useContext)(we.Z),h=k.loading,B=(0,a.useContext)(i.Z),c=B.createFormRef,g=B.volumeListRef,A=B.domainRef,I=B.createEnvRef,m=B.createLinkRef,f=(0,a.useState)(Se),S=T()(f,2),P=S[0],b=S[1],v=(0,$e.useSearchParams)(),U=T()(v,2),ue=U[0],ie=U[1],G=(0,$e.useNavigate)(),ce=(0,a.useState)("basic"),ve=T()(ce,2),oe=ve[0],be=ve[1],he=parseInt((_=ue.get("id"))!==null&&_!==void 0?_:""),Ee=($=ue.get("containerId"))!==null&&$!==void 0?$:"",Oe=(R=ue.get("imageId"))!==null&&R!==void 0?R:"";return(0,a.useEffect)(function(){if(Ee||he)h.show(),(0,He.iE)({md5:Ee,id:he}).then(function(){var le=F()(l()().mark(function r(t){var me,pe,X,Me,Fe,ye,Ne,ke,Ke;return l()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(X={info:{},layer:[]},!t.data.env.imageName){ge.next=11;break}return ge.prev=2,ge.next=5,(0,De.YU)({md5:t.data.env.imageName});case 5:Me=ge.sent,X=Me.data,ge.next=11;break;case 9:ge.prev=9,ge.t0=ge.catch(2);case 11:ue.get("op")==Ye?b(Ye):b(Ze),t.data.env.network&&t.data.env.network.map(function(J){return!J.alise&&J.name!="bridge"&&(J.alise=[t.data.siteName+".pod.dpanel.local"]),J}),t.data.env.ports&&t.data.env.ports.map(function(J){return J.host=="0"&&(J.host=""),J}),Fe=t.data.env.bindIpV6,t.data.containerInfo.Info&&t.data.containerInfo.Info.NetworkSettings.Networks&&Object.keys(t.data.containerInfo.Info.NetworkSettings.Networks).map(function(J){t.data.env.network&&(t.data.env.network=t.data.env.network.map(function(Re){return J==Re.name&&(Re.subnet=t.data.containerInfo.Info.NetworkSettings.Networks[J].IPAddress+"/"+t.data.containerInfo.Info.NetworkSettings.Networks[J].IPPrefixLen),Re})),t.data.containerInfo.Info.NetworkSettings.Networks[J].IPv6Gateway!=""&&(Fe=!0)}),t.data.env.extraHosts&&t.data.env.extraHosts.map(function(J){if(J.value=="host-gateway"){var Re;(Re=c.current)===null||Re===void 0||Re.setFieldValue("enableBindHost",!0)}}),ye=t.data.env.ports,t.data.env.ports&&(ye=t.data.env.ports.map(function(J){return J.host=(J.hostIp?J.hostIp+":":"")+J.host,J})),(me=c.current)===null||me===void 0||me.setFieldsValue({imageName:t.data.env.imageName,privileged:t.data.env.privileged,bindIpV6:t.data.env.useHostNetwork?!1:Fe,useHostNetwork:t.data.env.useHostNetwork,publishAllPorts:t.data.env.useHostNetwork?!1:t.data.env.publishAllPorts,workDir:{value:t.data.env.workDir,useDefault:!t.data.env.workDir,default:X&&X.info.Config&&X.info.Config.WorkingDir},user:{value:t.data.env.user,useDefault:!t.data.env.user,default:X&&X.info.Config&&X.info.Config.User},command:{value:t.data.env.command,useDefault:!t.data.env.command,default:X&&X.info.Config&&X.info.Config.Cmd&&X.info.Config.Cmd.join(" ")},entrypoint:{value:t.data.env.entrypoint,useDefault:!t.data.env.entrypoint,default:X&&X.info.Config&&X.info.Config.Entrypoint&&X.info.Config.Entrypoint.join(" ")},shmsize:(pe=t.data.env.shmsize)!==null&&pe!==void 0?pe:"64M",cpus:t.data.env.cpus,memory:t.data.env.memory,environment:t.data.env.environment,label:t.data.env.label,volumes:t.data.env.volumes,ports:ye,links:t.data.env.links,network:t.data.env.network,restart:t.data.env.restart,extraHosts:t.data.env.extraHosts,autoRemove:t.data.env.autoRemove,log:t.data.env.log,dns:t.data.env.dns&&t.data.env.dns.join(`
`),ipV4:t.data.env.ipV4,ipV6:t.data.env.ipV6,gpus:t.data.env.gpus,device:t.data.env.device,hook:t.data.env.hook,hostPid:t.data.env.hostPid,capAdd:t.data.env.capAdd&&Object.fromEntries(t.data.env.capAdd.map(function(J){return[J,!0]}))}),t.data.env.ipV6&&((Ne=c.current)===null||Ne===void 0||Ne.setFieldValue("enableIpV6Address",!0)),t.data.env.healthcheck&&t.data.env.healthcheck.cmd&&t.data.env.healthcheck.cmd!=""&&((ke=c.current)===null||ke===void 0||ke.setFieldsValue({healthcheck:t.data.env.healthcheck})),ue.get("op")==Ze&&((Ke=c.current)===null||Ke===void 0||Ke.setFieldsValue({siteTitle:t.data.siteTitle,siteName:t.data.siteName}));case 23:case"end":return ge.stop()}},r,null,[[2,9]])}));return function(r){return le.apply(this,arguments)}}()).finally(function(){h.destroy()});else{var fe;b(Se),(fe=c.current)===null||fe===void 0||fe.resetFields()}},[ue]),(0,e.jsx)(O._z,{children:(0,e.jsx)(x.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(p.A,{submitter:{render:function(le,r){return(0,e.jsx)(se.S,{children:r})}},formRef:c,onFinish:function(){var fe=F()(l()().mark(function le(r){var t,me,pe,X;return l()().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return X={siteTitle:r.siteTitle,siteName:r.siteName,imageName:r.imageName,environment:r.environment,links:r.links,ports:r.ports,volumes:r.volumes,network:r.network,privileged:(t=r.privileged)!==null&&t!==void 0?t:!1,autoRemove:(me=r.autoRemove)!==null&&me!==void 0?me:!1,restart:r.restart,cpus:r.cpus,memory:r.memory,shmsize:(pe=r.shmsize)!==null&&pe!==void 0?pe:0,workDir:r.workDir&&!r.workDir.useDefault?r.workDir.value:"",user:r.user&&!r.user.useDefault?r.user.value:"",command:r.command&&!r.command.useDefault?r.command.value:"",entrypoint:r.entrypoint&&!r.entrypoint.useDefault?r.entrypoint.value:"",useHostNetwork:r.useHostNetwork,bindIpV6:r.bindIpV6,log:r.log,dns:r.dns&&r.dns!=""?r.dns.split(`
`):[],label:r.label,publishAllPorts:r.publishAllPorts,extraHosts:r.extraHosts,ipV4:r.ipV4,ipV6:r.ipV6,device:r.device,gpus:r.gpus,hook:r.hook,hostPid:r.hostPid,capAdd:r.capAdd?Object.keys(r.capAdd).map(function(ye){return ye}):[]},r.healthcheck&&r.healthcheck.cmd&&r.healthcheck.cmd!=""&&(X.healthcheck=r.healthcheck),Ee&&P==Ze&&(X.containerId=Ee),Fe.next=5,(0,He.$G)(X);case 5:return G("/app/list"),Fe.abrupt("return",!0);case 7:case"end":return Fe.stop()}},le)}));return function(le){return fe.apply(this,arguments)}}(),children:[(0,e.jsxs)(x.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(o.Z,{name:"siteTitle",label:"\u5BB9\u5668\u63CF\u8FF0",fieldProps:{onChange:function(le){var r="";if(le.target.value&&P!=Ze){var t,me=(0,cn.N9)(le.target.value.trim(),{toneType:"none",type:"array"});r=me.join(""),(t=c.current)===null||t===void 0||t.setFieldValue("siteName",r)}}},placeholder:"\u8BF7\u8F93\u5165\u5BB9\u5668\u63CF\u8FF0\u540D\u79F0"}),(0,e.jsx)(o.Z,{name:"siteName",label:"\u5BB9\u5668\u6807\u8BC6",tooltip:"\u5BB9\u5668\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u5BB9\u5668\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:P==Ze,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u5BB9\u5668\u6807\u8BC6\u540D\u79F0"}),(0,e.jsx)(C,{redeploy:P!=Se,fromImageId:Oe})]}),(0,e.jsx)(q.Z,{offsetTop:50,children:(0,e.jsx)(x.Z,{style:{marginBottom:-20},children:(0,e.jsx)(u.Z,{activeKey:oe,onChange:function(le){be(le),window.scrollTo(0,450)},items:[{label:"\u57FA\u672C\u914D\u7F6E",key:"basic"},{label:"\u5173\u8054\u914D\u7F6E",key:"link"},{label:"\u5B58\u50A8\u914D\u7F6E",key:"storage"},{label:"\u8FD0\u884C\u914D\u7F6E",key:"run-command"},{label:"\u8D44\u6E90\u914D\u7F6E",key:"resource"},{label:"Hook",key:"hook"},{label:"\u80FD\u529B\u914D\u7F6E",key:"cap"},{label:"\u5176\u5B83",key:"other"}]})})}),(0,e.jsxs)(Ie.Z,{show:oe=="basic",children:[(0,e.jsx)(fn,{ref:A,showBindHost:!0,showBindIpV6:!0}),(0,e.jsx)(qe.Z,{showAddButton:!0,showImportButton:!0,showCodeMode:!0,label:"\u73AF\u5883\u53D8\u91CF",ref:I}),(0,e.jsx)(j.Z,{name:["siteName","useHostNetwork"],children:function(le){var r=le.siteName,t=le.useHostNetwork;if(!t)return(0,e.jsx)(En,{})}})]}),(0,e.jsx)(Ie.Z,{show:oe=="link",children:(0,e.jsx)(j.Z,{name:["siteName","useHostNetwork"],children:function(le){var r=le.siteName,t=le.useHostNetwork;return t?(0,e.jsx)(K.Z,{showIcon:!0,description:"\u7ED1\u5B9A\u5230\u5BBF\u4E3B\u673A\u7F51\u7EDC\u65F6\uFF0C\u65E0\u6CD5\u901A\u8FC7 Docker \u5173\u8054\u5176\u5B83\u5BB9\u5668\u3002\u8BF7\u4F7F\u7528\u5BBF\u4E3B\u673A\u5185\u7F51IP\u6216\u662F127.0.0.1\u4E92\u8054\u5BB9\u5668\u66B4\u9732\u7AEF\u53E3\u3002"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Qe,{onAddEnv:function(pe,X){var Me;(Me=I.current)===null||Me===void 0||Me.addEnvItem(pe,X)},ref:m}),(0,e.jsx)(mn.Z,{siteName:r}),(0,e.jsx)(vn,{})]})}})}),(0,e.jsx)(Ie.Z,{show:oe=="storage",children:(0,e.jsx)(nn,{showDefault:!0,ref:g})}),(0,e.jsx)(Ie.Z,{show:oe=="run-command",children:(0,e.jsx)(dn,{})}),(0,e.jsx)(Ie.Z,{show:oe=="resource",children:(0,e.jsx)(un,{})}),(0,e.jsx)(Ie.Z,{show:oe=="hook",children:(0,e.jsx)(Cn,{})}),(0,e.jsx)(Ie.Z,{show:oe=="other",children:(0,e.jsx)(rn,{})}),(0,e.jsx)(Ie.Z,{show:oe=="cap",children:(0,e.jsx)(Bn,{})})]},"form")})})}},2831:function(je,Q,n){n.d(Q,{Ll:function(){return x},aF:function(){return T},d6:function(){return se}});var te=n(15009),l=n.n(te),re=n(99289),F=n.n(re),W=n(63713);function T(){return O.apply(this,arguments)}function O(){return O=F()(l()().mark(function j(){return l()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,W.request)("/api/common/home/info",{method:"POST"});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},j)})),O.apply(this,arguments)}function x(){return p.apply(this,arguments)}function p(){return p=F()(l()().mark(function j(){return l()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,W.request)("/api/common/home/usage",{method:"POST"});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},j)})),p.apply(this,arguments)}function se(){return o.apply(this,arguments)}function o(){return o=F()(l()().mark(function j(){return l()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,W.request)("/api/common/home/upgrade-script",{method:"POST"});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},j)})),o.apply(this,arguments)}},14946:function(je,Q,n){n.d(Q,{CI:function(){return se},HY:function(){return Y},IS:function(){return T},XY:function(){return u},_3:function(){return V},_x:function(){return j},jR:function(){return x},t9:function(){return a}});var te=n(15009),l=n.n(te),re=n(99289),F=n.n(re),W=n(63713);function T(E){return O.apply(this,arguments)}function O(){return O=F()(l()().mark(function E(s){return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,W.request)("/api/app/network/get-detail",{method:"POST",data:s}));case 1:case"end":return d.stop()}},E)})),O.apply(this,arguments)}function x(E){return p.apply(this,arguments)}function p(){return p=F()(l()().mark(function E(s){return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,W.request)("/api/app/network/get-list",{method:"POST",data:s}));case 1:case"end":return d.stop()}},E)})),p.apply(this,arguments)}function se(){return o.apply(this,arguments)}function o(){return o=F()(l()().mark(function E(){return l()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,(0,W.request)("/api/app/network/prune",{method:"POST"});case 2:return M.abrupt("return",M.sent);case 3:case"end":return M.stop()}},E)})),o.apply(this,arguments)}function j(E){return q.apply(this,arguments)}function q(){return q=F()(l()().mark(function E(s){return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,W.request)("/api/app/network/delete",{method:"POST",data:s});case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},E)})),q.apply(this,arguments)}function u(E){return K.apply(this,arguments)}function K(){return K=F()(l()().mark(function E(s){return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,W.request)("/api/app/network/create",{method:"POST",data:s});case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},E)})),K.apply(this,arguments)}function a(E){return i.apply(this,arguments)}function i(){return i=F()(l()().mark(function E(s){return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,W.request)("/api/app/network/disconnect",{method:"POST",data:s});case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},E)})),i.apply(this,arguments)}function Y(E){return y.apply(this,arguments)}function y(){return y=F()(l()().mark(function E(s){return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,W.request)("/api/app/network/connect",{method:"POST",data:s});case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},E)})),y.apply(this,arguments)}function V(E){return Z.apply(this,arguments)}function Z(){return Z=F()(l()().mark(function E(s){return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,W.request)("/api/app/network/get-container-list",{method:"POST",data:s}));case 1:case"end":return d.stop()}},E)})),Z.apply(this,arguments)}}}]);
