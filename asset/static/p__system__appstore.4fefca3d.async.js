"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3917],{80821:function(z,A,e){e.d(A,{Z:function(){return F}});var C=e(5574),o=e.n(C),p=e(24963),g=e(86738),E=e(28036),x=e(83062),P=e(67294),f=e(85893);function F(n){var D=(0,P.useState)(!1),L=o()(D,2),B=L[0],S=L[1],O=(0,P.useContext)(p.Z),j=O.lang,$=O.notice,l=O.message,a=function(){S(!0);var r=n.action();r instanceof Promise?r.then(function(I){if(S(!1),I){typeof n.onSuccess=="function"&&n.onSuccess(I);var M="";n.messageSuccess?typeof n.messageSuccess=="function"?M=n.messageSuccess(I):M=n.messageSuccess.indexOf("notification.")==0?j(n.messageSuccess):n.messageSuccess:M=j("notification.finish"),n.asynced?l.info(M):l.success(M)}}).catch(function(I){S(!1),typeof n.onError=="function"&&n.onError(I)}):S(!1)};return n.confirm?(0,f.jsx)(g.Z,{style:{width:500},title:n.confirmTitle?n.confirmTitle:j("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?j(n.confirm):n.confirm,onConfirm:a,okText:"Yes",cancelText:"No",children:(0,f.jsx)(E.ZP,{disabled:n.disabled,icon:n.icon,loading:B,danger:n.danger,type:n.type,children:n.children})}):(0,f.jsx)(x.Z,{title:n.tips,children:(0,f.jsx)(E.ZP,{style:n.ghost?{padding:0,height:"auto"}:{},disabled:n.disabled,icon:n.icon,loading:B,onClick:a,danger:n.danger,type:n.type,children:n.children})})}},24963:function(z,A,e){var C=e(67294),o=(0,C.createContext)({});A.Z=o},29337:function(z,A,e){e.r(A),e.d(A,{default:function(){return ne}});var C=e(15009),o=e.n(C),p=e(99289),g=e.n(p),E=e(5574),x=e.n(E),P=e(24963),f=e(15078),F=e(184),n=e(5966),D=e(97462),L=e(86615),B=e(62370),S=e(82346),O=e(28036),j=e(42075),$=e(25593),l=e(66309),a=e(67294),t=e(85893),r=(0,a.forwardRef)(function(m,G){var w=(0,a.useState)(!1),b=x()(w,2),h=b[0],u=b[1],R=(0,a.useRef)(),T=(0,a.useContext)(P.Z),c=T.message,y=T.notice,s=(0,S.useSearchParams)(),v=x()(s,2),te=v[0],re=v[1];return(0,a.useImperativeHandle)(G,function(){return{edit:function(d){var i;(i=R.current)===null||i===void 0||i.setFieldsValue({title:d.title,name:d.name,type:d.setting.type,url:d.setting.url,id:d.id}),u(!0)}}}),(0,a.useEffect)(function(){te.get("op")=="create"&&u(!0)},[]),(0,t.jsxs)(F.a,{name:"create",title:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97",open:h,onOpenChange:function(d){u(d)},drawerProps:{forceRender:!0},formRef:R,trigger:(0,t.jsx)(O.ZP,{type:"primary",children:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97"}),onFinish:function(){var W=g()(o()().mark(function d(i){var Z,U,K;return o()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,f.ks)({name:i.name,url:i.url,type:i.type});case 2:if(Z=_.sent,!(Z&&Z.data)){_.next=12;break}return _.next=6,(0,f.$c)({id:i.id,name:i.name,title:i.title,type:i.type,url:i.url,apps:Z.data.list});case 6:if(U=_.sent,!(U&&U.data)){_.next=12;break}return c.success("\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\u6210\u529F"),m.onFinish&&m.onFinish(),(K=R.current)===null||K===void 0||K.resetFields(),_.abrupt("return",!0);case 12:case"end":return _.stop()}},d)}));return function(d){return W.apply(this,arguments)}}(),children:[(0,t.jsx)(n.Z,{name:"id",hidden:!0}),(0,t.jsx)(n.Z,{label:"\u540D\u79F0",name:"title",required:!0,rules:[{required:!0}],placeholder:"\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u5E94\u7528\u5546\u5E97"}),(0,t.jsx)(D.Z,{name:["id"],children:function(d){var i=d.id;return(0,t.jsx)(n.Z,{label:"\u6807\u8BC6",name:"name",required:!0,disabled:!!i,rules:[{required:!0}],placeholder:"\u6307\u5B9A\u5546\u5E97\u6807\u8BC6\uFF0C\u7528\u4E8E\u521B\u5EFA\u5546\u5E97\u6587\u4EF6\u5B58\u50A8\u76EE\u5F55"})}}),(0,t.jsx)(L.Z.Group,{name:"type",label:"\u5546\u5E97\u7C7B\u578B",valueEnum:{casaos:"casaos \u5E94\u7528\u5546\u5E97","1panel":"1panel \u5E94\u7528\u5546\u5E97"},fieldProps:{onChange:function(d){var i;(i=R.current)===null||i===void 0||i.resetFields(["url"])}}}),(0,t.jsx)(D.Z,{name:["type"],children:function(d){var i=d.type,Z=[],U=[];if(i=="1panel"&&(U=["https://gitee.com/qyg2297248353/appstore-dpanel","https://github.com/1Panel-dev/appstore","https://github.com/okxlin/appstore"],Z=[(0,t.jsx)(n.Z,{label:"\u4ED3\u5E93\u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B git \u4ED3\u5E93\u5730\u5740"},"gitUrl")]),i=="portainer"&&(Z=[(0,t.jsx)(n.Z,{label:"template.json \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/Lissy93/portainer-templates/blob/main/templates.json"},"jsonUrl")]),i=="casaos"&&(U=["https://play.cuse.eu.org/Cp0204-AppStore-Play.zip"],Z=[(0,t.jsx)(n.Z,{label:"zip \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B zip \u5730\u5740"},"zipUrl")]),i&&i!="")return[Z,(0,t.jsx)(B.Z,{label:(0,t.jsxs)(j.Z,{children:["\u63A8\u8350\u5546\u5E97",(0,t.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/setting/store?id=%e6%94%af%e6%8c%81%e7%b1%bb%e5%9e%8b",target:"_blank",children:"\u4E09\u65B9\u5546\u5E97\u63A5\u5165\u8BF4\u660E"})]}),children:(0,t.jsx)(j.Z,{wrap:!0,children:U.map(function(K,V){return(0,t.jsx)($.Z.Link,{onClick:function(){var N;(N=R.current)===null||N===void 0||N.setFieldValue("url",K)},children:(0,t.jsx)(l.Z,{color:"cyan",children:K})},V)})})},"recommend")]}})]})}),I=r,M=e(80821),J=e(5251),H=e(67255),Y=e(43425),Q=e(98165),X=e(90078),k=e(10641),q=e(96074),ee=e(83062);function ne(){var m=(0,a.useRef)(),G=(0,S.useAccess)(),w=(0,a.useRef)();return(0,t.jsx)(X._z,{header:{extra:[G.canSeeFounder&&(0,t.jsx)(I,{ref:w,onFinish:function(){var h,u;!((h=m.current)===null||h===void 0)&&h.reloadAndRest&&((u=m.current)===null||u===void 0||u.reloadAndRest())}},"create")]},children:(0,t.jsx)(k.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,H.O)(),columns:[{title:"\u6807\u8BC6",dataIndex:"name",width:200},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u5730\u5740",width:500,search:!1,render:function(h,u,R,T,c){return(0,t.jsx)("a",{href:u.setting.url,target:"_blank",children:(0,t.jsx)(l.Z,{children:u.setting.url})})}},{title:"\u6700\u540E\u66F4\u65B0",width:180,render:function(h,u,R,T,c){if(u.setting.updatedAt)return(0,J.ZM)(u.setting.updatedAt*1e3)}},{title:"\u64CD\u4F5C",width:100,search:!1,fixed:"right",render:function(h,u,R,T,c){return(0,t.jsxs)(j.Z,{split:(0,t.jsx)(q.Z,{type:"vertical"}),children:[(0,t.jsx)($.Z.Link,{onClick:function(){var s;(s=w.current)===null||s===void 0||s.edit(u)},children:(0,t.jsx)(ee.Z,{title:"\u7BA1\u7406",children:(0,t.jsx)(Y.Z,{})})},"manage"),(0,t.jsx)(M.Z,{type:"link",icon:(0,t.jsx)(Q.Z,{}),action:function(){var s,v;return(0,f.ks)({id:u.id,name:u.name,url:(s=u.setting.url)!==null&&s!==void 0?s:"",type:(v=u.setting.type)!==null&&v!==void 0?v:""})},onSuccess:function(){var s,v;return!((s=m.current)===null||s===void 0)&&s.reloadAndRest&&((v=m.current)===null||v===void 0||v.reloadAndRest()),!0},onError:function(){var s,v;return!((s=m.current)===null||s===void 0)&&s.reloadAndRest&&((v=m.current)===null||v===void 0||v.reloadAndRest()),!0},children:" "},"upgrade")]})}}],request:function(){var b=g()(o()().mark(function h(u,R,T){var c;return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,f.eO)({name:u.name,title:u.title});case 2:return c=s.sent,s.abrupt("return",{data:c.data.list,success:!0,total:c.data.list.length});case 4:case"end":return s.stop()}},h)}));return function(h,u,R){return b.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:m,tableAlertOptionRender:function(h){var u=h.selectedRowKeys,R=h.selectedRows;return(0,t.jsx)(j.Z,{size:16,children:(0,t.jsx)(M.Z,{danger:!0,type:"primary",action:function(){return(0,f.Me)({id:R.map(function(c){return c.id})})},onSuccess:function(){var c,y;return!((c=m.current)===null||c===void 0)&&c.reloadAndRest&&((y=m.current)===null||y===void 0||y.reloadAndRest()),!0},onError:function(){var c,y;return!((c=m.current)===null||c===void 0)&&c.reset&&((y=m.current)===null||y===void 0||y.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"},"delete")})}})})}},15078:function(z,A,e){e.d(A,{$c:function(){return x},Me:function(){return S},eO:function(){return L},ks:function(){return f},yL:function(){return j}});var C=e(15009),o=e.n(C),p=e(99289),g=e.n(p),E=e(82346);function x(l){return P.apply(this,arguments)}function P(){return P=g()(o()().mark(function l(a){return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,E.request)("/api/common/store/create",{method:"POST",data:a}));case 1:case"end":return r.stop()}},l)})),P.apply(this,arguments)}function f(l){return F.apply(this,arguments)}function F(){return F=g()(o()().mark(function l(a){return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,E.request)("/api/common/store/sync",{method:"POST",data:a}));case 1:case"end":return r.stop()}},l)})),F.apply(this,arguments)}function n(l){return D.apply(this,arguments)}function D(){return D=_asyncToGenerator(_regeneratorRuntime().mark(function l(a){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:a}));case 1:case"end":return r.stop()}},l)})),D.apply(this,arguments)}function L(l){return B.apply(this,arguments)}function B(){return B=g()(o()().mark(function l(a){return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,E.request)("/api/common/store/get-list",{method:"POST",data:a}));case 1:case"end":return r.stop()}},l)})),B.apply(this,arguments)}function S(l){return O.apply(this,arguments)}function O(){return O=g()(o()().mark(function l(a){return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,E.request)("/api/common/store/delete",{method:"POST",data:a});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},l)})),O.apply(this,arguments)}function j(l){return $.apply(this,arguments)}function $(){return $=g()(o()().mark(function l(a){return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,E.request)(a==null?void 0:a.path,{method:"GET"}));case 1:case"end":return r.stop()}},l)})),$.apply(this,arguments)}},67255:function(z,A,e){e.d(A,{O:function(){return C},j:function(){return o}});function C(){var p=localStorage.getItem("dpanel-pagesize");return p=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(p!=null?p:"20")}}function o(p){var g="dpanel-table-column-".concat(p),E={};if(localStorage.getItem(g)){var x;E=JSON.parse((x=localStorage.getItem(g))!==null&&x!==void 0?x:"{}")}return{defaultValue:E,onChange:function(f){localStorage.setItem("dpanel-table-column-".concat(p),JSON.stringify(f))}}}}}]);
