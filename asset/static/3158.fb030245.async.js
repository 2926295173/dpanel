"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3158],{99922:function(_e,w,e){var S=e(97857),t=e.n(S),U=e(15009),d=e.n(U),A=e(99289),K=e.n(A),O=e(5574),L=e.n(O),P=e(67294),H=e(85265),g=e(42075),i=e(28036),F=e(49610),v=e(3616),I=e(93362),N=e(90581),D=e(5251),C=e(85893),R=(0,P.forwardRef)(function(_,re){var T,Z,p=(0,P.useRef)(),z=(0,P.useRef)(),de=(0,P.useState)(!1),se=L()(de,2),me=se[0],oe=se[1],le=(0,P.useState)(),W=L()(le,2),l=W[0],m=W[1];return(0,P.useImperativeHandle)(re,function(){return{show:function(y){return K()(d()().mark(function X(){var Ee;return d()().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:m(y),oe(!0),(Ee=p.current)===null||Ee===void 0||Ee.resetFields();case 3:case"end":return Pe.stop()}},X)}))()}}}),(0,P.useEffect)(function(){return setTimeout(function(){var x;l&&((x=z.current)===null||x===void 0||x.start(l.url,{cmd:l&&l.cmd,workDir:l&&l.workDir}))},500),function(){var x;(x=z.current)===null||x===void 0||x.close()}},[l,me]),(0,C.jsxs)(H.Z,{forceRender:!0,width:v.FK,open:me,onClose:function(){return[oe(!1)]},title:(l==null?void 0:l.title)+" - \u63A7\u5236\u53F0",children:[(0,C.jsxs)(g.Z,{style:{marginBottom:20},children:[(0,C.jsx)(I.Z,{trigger:(0,C.jsx)(i.ZP,{type:"primary",children:"\u6587\u4EF6\u7BA1\u7406"}),apiPrefix:"container",workDir:l&&l.workDir,title:(0,D.fi)((T=l==null?void 0:l.title)!==null&&T!==void 0?T:"","/"),name:l&&l.url&&(Z=l.url.split("/").pop())!==null&&Z!==void 0?Z:""}),(0,C.jsx)(N.Z,{onChangeShell:function(y){var X;if(!l)return!1;(X=z.current)===null||X===void 0||X.close(),y!=(l==null?void 0:l.cmd)&&m(t()(t()({},l),{cmd:y}))},onOpenNewWindow:function(y){return l?(y.workDir=l&&l.workDir?l.workDir:"","".concat(l.url,"?").concat(Object.keys(y).map(function(X){return"".concat(X,"=").concat(encodeURIComponent(y[X]))}).join("&"))):""},onOpenNewWindowFinish:function(){var y;(y=z.current)===null||y===void 0||y.close(),oe(!1)},onBatchCommandFinish:function(y){z.current&&z.current.run(y)},onPreviewTheme:function(y){var X;(X=z.current)===null||X===void 0||X.option({theme:y})}})]}),me&&(0,C.jsx)(F.Z,{height:"80vh",ref:z})]})});w.Z=R},93362:function(_e,w,e){var S=e(97857),t=e.n(S),U=e(5574),d=e.n(U),A=e(67294),K=e(4459),O=e(25593),L=e(85265),P=e(95591),H=e(3616),g=e(82346),i=e(85893),F=(0,A.forwardRef)(function(v,I){var N=(0,A.useState)(!1),D=d()(N,2),C=D[0],R=D[1],_=(0,g.useSearchParams)(),re=d()(_,2),T=re[0],Z=re[1];return(0,A.useImperativeHandle)(I,function(){return{}}),(0,i.jsxs)(i.Fragment,{children:[v.trigger?A.cloneElement(v.trigger,{onClick:function(){R(!0)}}):(0,i.jsx)(O.Z.Link,{onClick:function(){R(!0)},children:(0,i.jsx)(P.Z,{})},"file"),(0,i.jsx)(L.Z,{width:H.R_,title:"".concat(v.title," - \u6587\u4EF6\u7BA1\u7406"),onClose:function(){Z([]),R(!1)},open:C,children:C&&(0,i.jsx)(K.Z,t()({},v))})]})});w.Z=F},80821:function(_e,w,e){e.d(w,{Z:function(){return g}});var S=e(97857),t=e.n(S),U=e(5574),d=e.n(U),A=e(24963),K=e(86738),O=e(28036),L=e(83062),P=e(67294),H=e(85893);function g(i){var F=(0,P.useState)(!1),v=d()(F,2),I=v[0],N=v[1],D=(0,P.useContext)(A.Z),C=D.lang,R=D.message,_=function(){N(!0);var T=i.action();T instanceof Promise?T.then(function(Z){if(N(!1),Z){typeof i.onSuccess=="function"&&i.onSuccess(Z);var p="";i.messageSuccess?typeof i.messageSuccess=="function"?p=i.messageSuccess(Z):p=i.messageSuccess.indexOf("notification.")==0?C(i.messageSuccess):i.messageSuccess:p=C("notification.finish"),i.asynced?R.info(p):R.success(p)}}).catch(function(Z){N(!1),typeof i.onError=="function"&&i.onError(Z)}):N(!1)};return i.confirm?(0,H.jsx)(K.Z,t()(t()({style:{width:500},title:i.confirmTitle?i.confirmTitle:C("notification.title.tip"),description:typeof i.confirm=="string"&&i.confirm.indexOf("notification.")==0?C(i.confirm):i.confirm,onConfirm:_,okText:"Yes",cancelText:"No",onOpenChange:i.confirmOnOpenChange},i.confirmProps),{},{children:(0,H.jsx)(O.ZP,{block:i.block,disabled:i.disabled,icon:!i.children&&I?void 0:i.icon,loading:I,danger:i.danger,type:i.type,children:i.children})})):(0,H.jsx)(L.Z,{title:i.tips,children:(0,H.jsx)(O.ZP,{block:i.block,style:i.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:i.disabled,icon:!i.children&&I?void 0:i.icon,loading:I,onClick:_,danger:i.danger,type:i.type,children:i.children})})}},90581:function(_e,w,e){e.d(w,{Z:function(){return Z}});var S=e(15009),t=e.n(S),U=e(99289),d=e.n(U),A=e(5574),K=e.n(A),O=e(3616),L=e(97269),P=e(38345),H=e(64317),g=e(37476),i=e(62370),F=e(97462),v=e(95089),I=e(42075),N=e(28036),D=e(83062),C=e(67294),R=e(58638),_=e(82346),re=e(69938),T=e(85893);function Z(p){var z=(0,C.useState)(!1),de=K()(z,2),se=de[0],me=de[1],oe=(0,C.useRef)();return(0,T.jsx)(L.A,{layout:"inline",submitter:!1,children:(0,T.jsx)(P.Z,{ghost:!0,children:(0,T.jsxs)(I.Z,{children:[(0,T.jsx)(H.Z,{label:" ",width:"sm",name:"entryCmd",placeholder:"\u5207\u6362 shell \u73AF\u5883",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(W){p.onChangeShell&&p.onChangeShell(W)}}),(0,T.jsx)(g.Y,{modalProps:{width:O.ob,height:O.Ed},title:"\u6279\u91CF\u6267\u884C\u811A\u672C",name:"batchCommand",open:se,trigger:(0,T.jsx)(N.ZP,{children:"\u6279\u91CF\u6267\u884C"}),formKey:"batchCommand",formRef:oe,isKeyPressSubmit:!0,onFinish:function(){var le=d()(t()().mark(function W(l){return t()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:p.onBatchCommandFinish&&p.onBatchCommandFinish(l.shell.split(`
`)),me(!1);case 2:case"end":return x.stop()}},W)}));return function(W){return le.apply(this,arguments)}}(),onOpenChange:function(W){me(W),W&&oe.current&&oe.current.resetFields()},children:(0,T.jsx)(i.Z,{name:"shell",children:(0,T.jsx)(v.ZP,{theme:"dark",height:O.Ed})})}),(0,T.jsx)(F.Z,{name:["entryCmd"],children:function(W){var l=W.entryCmd;return(!l||l=="")&&(l="/bin/sh"),p.onOpenNewWindow&&(0,T.jsx)(_.Link,{onClick:function(){p.onOpenNewWindowFinish&&p.onOpenNewWindowFinish()},target:"_blank",to:p.onOpenNewWindow({cmd:l}),children:(0,T.jsx)(D.Z,{title:"\u65B0\u7A97\u53E3\u6253\u5F00",children:(0,T.jsx)(N.ZP,{type:"dashed",icon:(0,T.jsx)(R.Z,{})})})})}}),(0,T.jsx)(re.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})}},49610:function(_e,w,e){var S=e(5574),t=e.n(S),U=e(67294),d=e(52626),A=e(12320),K=e.n(A),O=e(78267),L=e.n(O),P=e(12323),H=e(87662),g=e(82346),i=e(85893),F,v=new A.Terminal(P.Xq),I=new O.FitAddon,N,D=(0,U.forwardRef)(function(C,R){var _,re=(0,U.useState)(),T=t()(re,2),Z=T[0],p=T[1],z=(0,U.useState)(""),de=t()(z,2),se=de[0],me=de[1],oe=(0,g.useAccess)();(0,U.useImperativeHandle)(R,function(){return{start:function(l,m){le(),m.width=v.cols,m.height=v.rows;var x=m?Object.keys(m).filter(function(y){return m&&m[y]}).map(function(y){if(m&&m[y])return"".concat(y,"=").concat(m[y])}):[];F=new WebSocket((0,d.R)(l+"?"+x.join("&"))),F.addEventListener("message",function(y){var X=JSON.parse(y.data),Ee=X.type;if(Ee==l&&(v.write(X.data),X.data.indexOf("exec failed")!=-1)){le();return}}),N=v.onData(function(y){var X={content:{command:y},type:l};F&&F.send(JSON.stringify(X))}),me(l),p(m)},close:function(){le()},fit:function(){return I.fit(),{width:v.cols,height:v.rows}},run:function(l){Z&&l&&l.forEach(function(m){var x={content:{command:m+`
`},type:se};F&&F.send(JSON.stringify(x))})},option:function(l){return l&&Object.assign(v.options,l),v.options}}}),(0,U.useEffect)(function(){return v.loadAddon(I),v.open(document.getElementById("terminal-container-console")),I.fit(),(0,H.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(W){W.data&&(oe.canSeeEnableCe&&Object.assign(W.data,{theme:{}}),Object.assign(v.options,W.data))}),function(){le()}},[]),(0,U.useEffect)(function(){window.addEventListener("resize",function(){I.fit();var W={size:{width:v.cols,height:v.rows},type:se};se&&F&&F.send(JSON.stringify(W))})},[se]);function le(){v.reset(),I.fit(),v.focus(),N&&N.dispose(),F&&(F.close(),F=null)}return(0,i.jsx)("div",{style:{height:(_=C.height)!==null&&_!==void 0?_:"100vh"},id:"terminal-container-console"})});w.Z=D},81366:function(_e,w,e){var S=e(19632),t=e.n(S),U=e(5574),d=e.n(U),A=e(27254),K=e(42075),O=e(28036),L=e(25593),P=e(67294),H=e(31112),g=e(85893),i={title:"ROOT",path:"/"},F=(0,P.forwardRef)(function(v,I){var N=(0,P.useContext)(H.Z),D=N.showPath,C=(0,P.useState)([i]),R=d()(C,2),_=R[0],re=R[1];(0,P.useImperativeHandle)(I,function(){return{addHistory:function(p,z){z=="/"?re([i]):re([].concat(t()(_),[{title:p,path:z}]))},initHistory:function(p){re([i].concat(t()(p)))}}});var T=function(p){D?D(_[p].title,_[p].path):v.showPath&&v.showPath(_[p].title,_[p].path);var z=_.filter(function(de,se){return se<=p});re(t()(z))};return(0,g.jsxs)(K.Z,{children:[(0,g.jsx)(K.Z.Compact,{children:_.map(function(Z,p){return(0,g.jsx)(O.ZP,{icon:(0,g.jsx)(A.Z,{}),type:"dashed",onClick:function(){T(p)},children:Z.title},p)})}),_.length>=2&&(0,g.jsx)(L.Z.Text,{copyable:{text:_[_.length-1].path}})]})});w.Z=F},31112:function(_e,w,e){var S=e(67294),t=(0,S.createContext)({});w.Z=t},4459:function(_e,w,e){e.d(w,{Z:function(){return an}});var S=e(15009),t=e.n(S),U=e(99289),d=e.n(U),A=e(5574),K=e.n(A),O=e(82346);function L(r,s){return P.apply(this,arguments)}function P(){return P=d()(t()().mark(function r(s,u){var h;return t()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return h="/api/".concat(s,"/explorer/get-path-list"),G.next=3,(0,O.request)(h,{data:u,method:"POST"});case 3:return G.abrupt("return",G.sent);case 4:case"end":return G.stop()}},r)})),P.apply(this,arguments)}function H(r,s){return g.apply(this,arguments)}function g(){return g=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/export"),{data:u,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),g.apply(this,arguments)}function i(r,s){return F.apply(this,arguments)}function F(){return F=_asyncToGenerator(_regeneratorRuntime().mark(function r(s,u){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u.enableExportHost=!0,n.next=3,request("/api/".concat(s,"/explorer/export"),{data:u,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},r)})),F.apply(this,arguments)}function v(r,s){return I.apply(this,arguments)}function I(){return I=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/import"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),I.apply(this,arguments)}function N(r,s){return D.apply(this,arguments)}function D(){return D=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/delete"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),D.apply(this,arguments)}function C(r,s){return R.apply(this,arguments)}function R(){return R=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/unzip"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),R.apply(this,arguments)}function _(r,s){return re.apply(this,arguments)}function re(){return re=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/get-content"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),re.apply(this,arguments)}function T(r,s){return Z.apply(this,arguments)}function Z(){return Z=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/import-file-content"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),Z.apply(this,arguments)}function p(r,s){return z.apply(this,arguments)}function z(){return z=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/mkdir"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),z.apply(this,arguments)}function de(r,s){return se.apply(this,arguments)}function se(){return se=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/chmod"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),se.apply(this,arguments)}function me(r,s){return oe.apply(this,arguments)}function oe(){return oe=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/get-user-list"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),oe.apply(this,arguments)}function le(r,s){return W.apply(this,arguments)}function W(){return W=d()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,O.request)("/api/".concat(s,"/explorer/get-file-stat"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),W.apply(this,arguments)}var l=e(41482),m=e(67294),x=e(31112),y=e(51042),X=e(48689),Ee=e(42075),De=e(28036),Pe=e(80821),Ae=e(88484),Be=e(37476),Le=e(91604),We=e(97961),xe=e(3616),a=e(85893);function Ue(){var r=(0,m.useRef)(),s=(0,m.useContext)(x.Z),u=s.refresh,h=s.name,n=s.apiPrefix,G=s.currentPath;return(0,a.jsx)(Be.Y,{modalProps:{width:xe.ob},formRef:r,trigger:(0,a.jsx)(De.ZP,{icon:(0,a.jsx)(Ae.Z,{}),children:"\u4E0A\u4F20"}),title:"\u4E0A\u4F20\u6587\u4EF6\u5230\u5BB9\u5668",onFinish:function(){var V=d()(t()().mark(function te(J){var ae,q;return t()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return q=[],J.importFileList&&J.importFileList.map(function(ee){q.push({name:ee.name,path:ee.response.data.path})}),v(n,{fileList:q,name:h,destPath:G}),(ae=r.current)===null||ae===void 0||ae.resetFields(),u(),ie.abrupt("return",!0);case 6:case"end":return ie.stop()}},te)}));return function(te){return V.apply(this,arguments)}}(),children:(0,a.jsx)(Le.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(te){return new Promise(function(J){var ae;(0,We._2)({path:(ae=te.response.data.path)!==null&&ae!==void 0?ae:""}).then(function(q){J(!0)})})}}})})}var we=e(23430),Se=e(93162),Ce=e(24963);function Ie(r){var s=(0,m.useContext)(x.Z),u=s.name,h=s.apiPrefix,n=(0,m.useContext)(Ce.Z),G=n.message;return(0,a.jsx)(Pe.Z,{action:function(){return!r.selectFileList||r.selectFileList.length==0?(G.info("\u8BF7\u9009\u62E9\u8981\u4E0B\u8F7D\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):H(h,{name:u,fileList:r.selectFileList})},onSuccess:function(te){var J=new Blob([te],{type:"application/zip"});(0,Se.saveAs)(J,"export.zip")},icon:(0,a.jsx)(we.Z,{}),children:"\u4E0B\u8F7D"})}var je=e(38345),he=e(63434),Ze=e(24739),Me=e(5966);function Ke(r){var s=(0,m.useContext)(Ce.Z),u=s.notice,h=(0,m.useRef)(),n=(0,m.useContext)(x.Z),G=n.currentPath,V=n.refresh,te=n.name,J=n.apiPrefix,ae=(0,m.useState)(!1),q=K()(ae,2),ue=q[0],ie=q[1],ee=function(j){var E=j.split(""),B=0,b=0,M=0;return E[1]=="r"&&(B+=4),E[2]=="w"&&(B+=2),E[3]=="x"&&(B+=1),E[4]=="r"&&(b+=4),E[5]=="w"&&(b+=2),E[6]=="x"&&(b+=1),E[7]=="r"&&(M+=4),E[8]=="w"&&(M+=2),E[9]=="x"&&(M+=1),"".concat(B).concat(b).concat(M)},pe=function(j){var E;if((E=h.current)===null||E===void 0||E.setFieldValue("permission",j),j.length>=1){var B;(B=h.current)===null||B===void 0||B.setFieldsValue({ownerRead:Number(j[0])&4,ownerWrite:Number(j[0])&2,ownerExec:Number(j[0])&1})}if(j.length>=2){var b;(b=h.current)===null||b===void 0||b.setFieldsValue({groupRead:Number(j[1])&4,groupWrite:Number(j[1])&2,groupExec:Number(j[1])&1})}if(j.length>=3){var M;(M=h.current)===null||M===void 0||M.setFieldsValue({everyoneRead:Number(j[2])&4,everyoneWrite:Number(j[2])&2,everyoneExec:Number(j[2])&1})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(De.ZP,{onClick:d()(t()().mark(function ce(){var j;return t()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(!(!r.selectFileObject||r.selectFileObject.length==0)){B.next=7;break}return(j=h.current)===null||j===void 0||j.resetFields(),u.error("\u8BF7\u5148\u9009\u62E9\u8981\u4FEE\u6539\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),ie(!1),B.abrupt("return",!1);case 7:ie(!0);case 8:case"end":return B.stop()}},ce)})),children:"\u6743\u9650"}),(0,a.jsxs)(Be.Y,{modalProps:{forceRender:!0,width:xe.ob},title:r.selectFileObject.length==1?"\u4FEE\u6539 ".concat(r.selectFileObject[0].name," \u6743\u9650"):"\u6279\u91CF\u6587\u4EF6\u4FEE\u6539\u6743\u9650",layout:"horizontal",open:ue,onOpenChange:function(j){ie(j),r.selectFileObject.length==1&&pe(ee(r.selectFileObject[0].modStr))},formRef:h,onValuesChange:function(j,E){if(j.permission)pe(j.permission);else{var B=["-",E.ownerRead?"r":"-",E.ownerWrite?"w":"-",E.ownerExec?"x":"-",E.groupRead?"r":"-",E.groupWrite?"w":"-",E.groupExec?"x":"-",E.everyoneRead?"r":"-",E.everyoneWrite?"w":"-",E.everyoneExec?"x":"-"];pe(ee(B.join("")))}},onFinish:function(){var ce=d()(t()().mark(function j(E){var B,b,M,fe;return t()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return M=[],r.selectFileObject.map(function(o){M.push(o.path)}),c.next=4,de(J,{name:te,fileList:M,mod:(B=E.permission)!==null&&B!==void 0?B:"600",hasChildren:(b=E.hasChildren)!==null&&b!==void 0?b:!0,user:E.user});case 4:return fe=c.sent,V(),c.abrupt("return",!0);case 7:case"end":return c.stop()}},j)}));return function(j){return ce.apply(this,arguments)}}(),children:[(0,a.jsxs)(je.Z,{direction:"row",gutter:[20,10],children:[(0,a.jsxs)(je.Z,{bordered:!0,title:"\u6240\u6709\u8005",headerBordered:!0,children:[(0,a.jsx)(he.Z,{label:"\u8BFB\u53D6",name:"ownerRead"}),(0,a.jsx)(he.Z,{label:"\u5199\u5165",name:"ownerWrite"}),(0,a.jsx)(he.Z,{label:"\u6267\u884C",name:"ownerExec"})]}),(0,a.jsxs)(je.Z,{bordered:!0,title:"\u7528\u6237\u7EC4",headerBordered:!0,children:[(0,a.jsx)(he.Z,{label:"\u8BFB\u53D6",name:"groupRead"}),(0,a.jsx)(he.Z,{label:"\u5199\u5165",name:"groupWrite"}),(0,a.jsx)(he.Z,{label:"\u6267\u884C",name:"groupExec"})]}),(0,a.jsxs)(je.Z,{bordered:!0,title:"\u516C\u5171",headerBordered:!0,children:[(0,a.jsx)(he.Z,{label:"\u8BFB\u53D6",name:"everyoneRead"}),(0,a.jsx)(he.Z,{label:"\u5199\u5165",name:"everyoneWrite"}),(0,a.jsx)(he.Z,{label:"\u6267\u884C",name:"everyoneExec"})]})]}),(0,a.jsx)(je.Z,{children:(0,a.jsxs)(Ze.UW,{children:[(0,a.jsx)(Me.Z,{label:"\u6743\u9650",name:"permission",fieldProps:{maxLength:3},width:"xs"}),(0,a.jsxs)(Ee.Z.Compact,{children:[(0,a.jsx)(Me.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237",label:"\u6240\u6709\u8005",name:"user",fieldProps:{addonAfter:":"}}),(0,a.jsx)(Me.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237\u7EC4",name:"group"})]}),(0,a.jsx)(he.Z,{label:"\u5E94\u7528\u5230\u5B50\u76EE\u5F55",name:"hasChildren",initialValue:!0})]})})]})]})}var Ne=e(27461);function ke(r){var s=(0,m.useContext)(x.Z),u=s.currentPath,h=s.refresh,n=s.name,G=s.apiPrefix,V=(0,m.useContext)(Ce.Z),te=V.notice;return(0,a.jsx)(Pe.Z,{icon:(0,a.jsx)(Ne.Z,{}),action:d()(t()().mark(function J(){return t()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(r.selectFileObject.length!=0){q.next=3;break}return te.error("\u8BF7\u5148\u9009\u62E9\u8981\u89E3\u538B\u7684 .zip .tar .tar.gz \u6587\u4EF6"),q.abrupt("return",!1);case 3:return q.abrupt("return",C(G,{name:n,file:r.selectFileObject.map(function(ue){return ue.path}),path:u}));case 4:case"end":return q.stop()}},J)})),onSuccess:function(){h()},children:"\u89E3\u538B"})}function sn(r){var s=useContext(FileExplorerContext),u=s.name,h=s.apiPrefix,n=useContext(AppContext),G=n.message,V=useRef();return _jsx(RequestButton,{confirm:_jsx(Space,{children:_jsx(ProForm,{layout:"inline",submitter:!1,formRef:V,children:_jsx(ProFormText,{width:"md",label:"\u5BFC\u51FA\u5230\u4E3B\u673A\u76EE\u5F55",name:"hostPath"})})}),action:function(){var J;return!r.selectFileList||r.selectFileList.length==0?(G.info("\u8BF7\u9009\u62E9\u8981\u5BFC\u51FA\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):exportFileList(h,{name:u,hostPath:(J=V.current)===null||J===void 0?void 0:J.getFieldValue("hostPath"),enableExportHost:!0,fileList:r.selectFileList})},icon:_jsx(ExportOutlined,{}),children:"\u5BFC\u51FA\u5230\u4E3B\u673A"})}function $e(r){var s=(0,m.useContext)(x.Z),u=s.refresh,h=s.name,n=s.apiPrefix,G=s.currentPath,V=s.newFile;return(0,a.jsxs)(Ee.Z,{size:16,wrap:!0,children:[(0,a.jsx)(Ie,{selectFileList:r.selectFileList}),!1,(0,a.jsx)(Ue,{}),(0,a.jsx)(Ke,{selectFileObject:r.selectFileObject}),(0,a.jsx)(ke,{selectFileObject:r.selectFileObject}),(0,a.jsx)(De.ZP,{icon:(0,a.jsx)(y.Z,{}),onClick:function(){V()},type:"primary",children:"\u65B0\u5EFA"}),(0,a.jsx)(Pe.Z,{danger:!0,type:"default",icon:(0,a.jsx)(X.Z,{}),action:function(){return N(n,{name:h,fileList:r.selectFileList})},onSuccess:function(){u()},confirm:"notification.confirm.title",children:"\u5220\u9664"})]})}var Fe=e(83062),Te=e(66309);function He(r){return r.change==0?(0,a.jsx)(Fe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u4FEE\u6539",children:(0,a.jsx)(Te.Z,{color:"blue",children:"MODIFIED"})}):r.change==1?(0,a.jsx)(Fe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u65B0\u589E\u7684\u6587\u4EF6",children:(0,a.jsx)(Te.Z,{color:"green",children:"ADD"})}):r.change==2?(0,a.jsx)(Fe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u5220\u9664\u6587\u4EF6",children:(0,a.jsx)(Te.Z,{color:"error",children:"DELETED"})}):r.change==100?(0,a.jsx)(Fe.Z,{title:"\u6302\u8F7D\u7684\u6301\u4E45\u5316\u76EE\u5F55",children:(0,a.jsx)(Te.Z,{color:"cyan",children:"VOLUME"})}):(0,a.jsx)(a.Fragment,{})}var ze=e(81366),Ge=e(97269),Ve=e(86615),Je=e(97462),Ye=e(62370),Qe=e(85576),Xe=e(95089),Re=e(5251),qe=(0,m.forwardRef)(function(r,s){var u,h,n,G=(0,m.useContext)(Ce.Z),V=G.message,te=G.notice,J=(0,m.useContext)(x.Z),ae=J.currentPath,q=J.refresh,ue=J.name,ie=J.apiPrefix,ee=(0,m.useRef)(),pe=(0,m.useState)(!1),ce=K()(pe,2),j=ce[0],E=ce[1];return(0,m.useImperativeHandle)(s,function(){return{newFile:function(){var b,M;E(!0),(b=ee.current)===null||b===void 0||b.resetFields(),(M=ee.current)===null||M===void 0||M.setFieldValue("type","newFile")},editFile:function(b,M,fe){return d()(t()().mark(function f(){var c,o,k,$,Y;return t()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return(c=ee.current)===null||c===void 0||c.resetFields(),V.loading("\u6B63\u5728\u83B7\u53D6\u6587\u4EF6\u5185\u5BB9"),Q.next=4,_(ie,{name:ue,file:M}).finally(function(){V.destroy()});case 4:if(Y=Q.sent,!(Y.data.content==""&&fe!="0")){Q.next=9;break}return V.error("\u4E0D\u652F\u6301\u7F16\u8F91\u7684\u6587\u4EF6\u7C7B\u578B"),E(!1),Q.abrupt("return");case 9:return(o=ee.current)===null||o===void 0||o.setFieldValue("newValue",Y.data.content),(k=ee.current)===null||k===void 0||k.setFieldValue("newName",b),($=ee.current)===null||$===void 0||$.setFieldValue("type","editFile"),E(!0),Q.abrupt("return");case 14:case"end":return Q.stop()}},f)}))()}}}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Qe.Z,{width:xe.ob,title:(u=ee.current)!==null&&u!==void 0&&u.getFieldValue("newName")?"\u7F16\u8F91\u6587\u4EF6":"\u65B0\u5EFA\u6587\u4EF6",open:j,onCancel:function(){var b;E(!1),(b=ee.current)===null||b===void 0||b.resetFields()},footer:!1,forceRender:!0,children:(0,a.jsxs)(Ge.A,{formRef:ee,onFinish:function(){var B=d()(t()().mark(function b(M){return t()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(M.type!="newDir"){f.next=13;break}return f.prev=1,f.next=4,p(ie,{name:ue,destPath:"".concat(ae,"/").concat((0,Re.fi)(M.newPath,"/"))});case 4:return q(),E(!1),f.abrupt("return",!0);case 9:f.prev=9,f.t0=f.catch(1);case 11:f.next=23;break;case 13:return f.prev=13,f.next=16,T(ie,{destPath:ae,file:M.newName,content:M.newValue,name:ue});case 16:return q(),E(!1),f.abrupt("return",!0);case 21:f.prev=21,f.t1=f.catch(13);case 23:return f.abrupt("return",!1);case 24:case"end":return f.stop()}},b,null,[[1,9],[13,21]])}));return function(b){return B.apply(this,arguments)}}(),children:[(0,a.jsx)(Ve.Z.Group,{name:"type",options:[{label:"\u7F16\u8F91\u6587\u4EF6",value:"editFile",disabled:((h=ee.current)===null||h===void 0?void 0:h.getFieldValue("type"))!="editFile"},{label:"\u65B0\u5EFA\u6587\u4EF6",value:"newFile"},{label:"\u65B0\u5EFA\u76EE\u5F55",value:"newDir"}],disabled:((n=ee.current)===null||n===void 0?void 0:n.getFieldValue("type"))=="editFile"}),(0,a.jsx)(Je.Z,{name:["type"],children:function(b){var M=b.type;return M!="newDir"?[(0,a.jsx)(Me.Z,{label:"\u6587\u4EF6\u540D",tooltip:"\u7F16\u8F91\u6587\u4EF6\u65F6\u4FEE\u6539\u6587\u4EF6\u540D\u53EF\u5B9E\u73B0\u590D\u5236\u529F\u80FD",name:"newName",fieldProps:{addonBefore:"".concat(ae,"/")},placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D",disabled:M=="editFile"},"fileName"),(0,a.jsx)(Ye.Z,{label:"\u5185\u5BB9",name:"newValue",children:(0,a.jsx)(Xe.ZP,{theme:"dark",height:xe.Ed,onChange:function(f){var c;(c=ee.current)===null||c===void 0||c.setFieldValue("newValue",f)}})},"fileContent")]:(0,a.jsx)(Me.Z,{name:"newPath",label:"\u76EE\u5F55\u540D",placeholder:"\u8F93\u5165\u76EE\u5F55\u540D\u79F0\uFF0C\u652F\u6301\u591A\u7EA7"})}})]})})})}),en=qe,nn=e(99922),ye=e(68536),rn=e(87662),on=null;function tn(r){var s=(0,m.useRef)(),u=(0,m.useRef)(),h=(0,m.useRef)(),n=(0,m.useState)(""),G=K()(n,2),V=G[0],te=G[1],J=(0,m.useRef)(),ae=(0,O.useSearchParams)(),q=K()(ae,2),ue=q[0],ie=q[1],ee=(0,m.useState)(),pe=K()(ee,2),ce=pe[0],j=pe[1],E=(0,m.useContext)(Ce.Z),B=E.lang,b=E.message,M=r.apiPrefix=="host"?"common":"app";(0,m.useEffect)(function(){var f=ue.get("path");if(f){for(var c,o=f.split("/"),k=[],$="",Y=1;Y<o.length;Y++)$+="/"+o[Y],k.push({title:o[Y],path:$});fe(o[o.length-1],f),(c=s.current)===null||c===void 0||c.initHistory([].concat(k))}(0,rn.K3)().then(function(ve){!ve.data.enableSSH&&b.info(B("app.detail.createExplorerPlugin"))})},[r.name,ue]);var fe=function(c,o){var k,$;if((k=s.current)===null||k===void 0||k.addHistory(c,o),te(o),h.current&&($=h.current)!==null&&$!==void 0&&$.reloadAndRest){var Y;(Y=h.current)===null||Y===void 0||Y.reloadAndRest()}o=="/"?ie([]):(ue.set("path",o),ie(ue))};return(0,a.jsxs)(x.Z.Provider,{value:{apiPrefix:M,name:r.name,currentPath:V,showPath:fe,refresh:function(){var c;if(h&&typeof((c=h.current)===null||c===void 0?void 0:c.reloadAndRest)=="function"){var o;(o=h.current)===null||o===void 0||o.reloadAndRest()}},editFile:function(c,o,k){u.current&&u.current.editFile(c,o,k)},newFile:function(){u.current&&u.current.newFile()}},children:[(0,a.jsx)(l.Z,{scroll:{x:"max-content"},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},toolBarRender:function(){var c=[];return r.onConsole&&c.push((0,a.jsx)(De.ZP,{type:"dashed",onClick:function(){r.onConsole&&r.onConsole(V)},children:"Console"},"fileConsole")),[].concat(c)},tableAlertOptionRender:function(c){var o=c.selectedRowKeys,k=c.selectedRows,$=[];return k.map(function(Y){$.push(Y.path)}),[(0,a.jsx)($e,{selectFileList:$,selectFileObject:k,enableExportHost:r.apiPrefix=="container"},"1")]},headerTitle:(0,a.jsx)(ze.Z,{ref:s}),actionRef:h,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:d()(t()().mark(function f(){var c,o,k,$,Y;return t()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,L(M,{name:r.name,path:V});case 2:if(c=Q.sent,V==""&&c.data.currentPath!=""&&(k=[],te(c.data.currentPath),(o=s.current)===null||o===void 0||o.initHistory(c.data.currentPath.split("/").filter(function(ne){return ne!=""}).map(function(ne){return k.push(ne),{title:ne,path:"/".concat(k.join("/"))}}))),$=ce,$){Q.next=11;break}return Q.next=8,me(M,{name:r.name});case 8:Y=Q.sent,j(Y.data),$=Y.data;case 11:return Q.abrupt("return",{data:c.data.list.map(function(ne){if($){var ge,be;ne.group=(ge=(be=$.group.find(function(Oe){return Oe.gid==ne.group}))===null||be===void 0?void 0:be.name)!==null&&ge!==void 0?ge:ne.group}return ne}),success:!0,total:c.data.list.length});case 12:case"end":return Q.stop()}},f)})),columns:[{title:"\u540D\u79F0",dataIndex:"name",key:"name",render:function(ve,o,k,$,Y){var ve;return o.isDir?ve=(0,a.jsx)(ye.Z,{isDir:!0,onClick:function(){return fe(o.name,o.path)},showName:o.name}):o.isSymlink?ve=(0,a.jsx)(ye.Z,{isLink:!0,showName:"".concat(o.name," -> ").concat(o.linkName),onClick:d()(t()().mark(function Q(){var ne,ge;return t()().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:return Oe.next=2,le(M,{name:r.name,path:o.path});case 2:ne=Oe.sent,ne.data.info.isDir?fe(o.name,ne.data.info.target):(ge=u.current)===null||ge===void 0||ge.editFile(ne.data.info.name,ne.data.info.target,o.size);case 4:case"end":return Oe.stop()}},Q)}))}):ve=(0,a.jsx)(ye.Z,{showName:o.name,onClick:function(){var ne;(ne=u.current)===null||ne===void 0||ne.editFile(o.name,o.path,o.size)}}),ve}},{title:"\u72B6\u6001",key:"status",width:110,render:function(c,o,k,$,Y){return(0,a.jsx)(He,{change:o.change})}},{title:"\u6743\u9650",dataIndex:"modStr",key:"mod"},{title:"\u7528\u6237",dataIndex:"user"},{title:"\u7528\u6237\u7EC4",dataIndex:"group"},{title:"\u5927\u5C0F",dataIndex:"size",key:"size",render:function(c,o,k,$,Y){return(0,Re.FI)(o.size)}},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"modTime",key:"modTime",sorter:function(c,o){return new Date(c.modTime).getTime()-new Date(o.modTime).getTime()},render:function(c,o,k,$,Y){return(0,Re.NF)(o.modTime)}}],cardProps:{ghost:!0}}),(0,a.jsx)(en,{ref:u}),(0,a.jsx)(nn.Z,{ref:J})]})}var an=tn},68536:function(_e,w,e){e.d(w,{Z:function(){return H}});var S=e(24963),t=e(93613),U=e(36693),d=e(2741),A=e(25593),K=e(42075),O=e(67294),L=e(85893),P=0;function H(g){var i=(0,O.useContext)(S.Z),F=i.message;return g.isDir?(0,L.jsx)(A.Z.Link,{onClick:function(){g.onClick&&g.onClick()},children:(0,L.jsxs)(K.Z,{children:[(0,L.jsx)(t.Z,{}),g.showName]})}):g.isLink?(0,L.jsx)(A.Z.Link,{onClick:function(){g.onClick&&g.onClick()},children:(0,L.jsxs)(K.Z,{children:[(0,L.jsx)(U.Z,{}),g.showName]})}):(0,L.jsx)(A.Z.Text,{onClick:function(){if(P++,P==2){P=0,g.onClick&&g.onClick();return}setTimeout(function(){P==1&&F.info("\u53CC\u51FB\u67E5\u770B\u6587\u4EF6\u5185\u5BB9"),P=0},400)},style:{cursor:"pointer"},children:(0,L.jsxs)(K.Z,{children:[(0,L.jsx)(d.Z,{}),g.showName]})})}},3616:function(_e,w,e){e.d(w,{Ed:function(){return d},FK:function(){return t},R_:function(){return S},ob:function(){return U}});var S=window.innerWidth<=1024?"90vw":"65vw",t="90vw",U="60vw",d="50vh"},12323:function(_e,w,e){e.d(w,{Xq:function(){return t},nS:function(){return U}});var S=null,t={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},U=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},24963:function(_e,w,e){var S=e(67294),t=(0,S.createContext)({});w.Z=t},97961:function(_e,w,e){e.d(w,{GH:function(){return g},MF:function(){return I},_2:function(){return F},fN:function(){return O},ii:function(){return K},vC:function(){return P}});var S=e(15009),t=e.n(S),U=e(99289),d=e.n(U),A=e(82346),K=[{name:"amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"i386",arch:"386",search:[]},{name:"arm/v6",arch:"arm",search:[]},{name:"arm/v7",arch:"arm",search:[]},{name:"arm/v8",arch:"arm64",search:[]},{name:"ppc64le",arch:"ppc64le",search:[]},{name:"riscv64",arch:"riscv64",search:[]}];function O(D){return L.apply(this,arguments)}function L(){return L=d()(t()().mark(function D(C){return t()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,A.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:C}));case 1:case"end":return _.stop()}},D)})),L.apply(this,arguments)}function P(D){return H.apply(this,arguments)}function H(){return H=d()(t()().mark(function D(C){return t()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,A.request)("/api/app/image/import-by-container-tar",{method:"POST",data:C}));case 1:case"end":return _.stop()}},D)})),H.apply(this,arguments)}function g(D){return i.apply(this,arguments)}function i(){return i=d()(t()().mark(function D(C){return t()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,A.request)("/api/app/image/import-by-image-tar",{method:"POST",data:C}));case 1:case"end":return _.stop()}},D)})),i.apply(this,arguments)}function F(D){return v.apply(this,arguments)}function v(){return v=d()(t()().mark(function D(C){return t()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,A.request)("/api/common/attach/delete",{method:"POST",data:C});case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},D)})),v.apply(this,arguments)}function I(){return N.apply(this,arguments)}function N(){return N=d()(t()().mark(function D(){return t()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,A.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return R.stop()}},D)})),N.apply(this,arguments)}}}]);
