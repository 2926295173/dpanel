"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9002],{1699:function(K,x,e){e.d(x,{u:function(){return M}});var D=e(9783),s=e.n(D),v=e(97857),o=e.n(v),F=e(67294),R=e(82346),y=e(40411),W=e(42075),A=e(85893),M=function(n){var S=(0,R.useAccess)(),Z=Array.isArray(n.access)?n.access:[n.access],f,O=n.fallback;if(typeof n.children=="function"?(f=n.children(Z.reduce(function(I,C){return o()(o()({},I),{},s()({},C,S[C]))},{})),f||(f=O)):Z.every(function(I){return S[I]})?f=n.children:f=O,!O&&f&&n.showProTips&&S.canSeeEnableCe){if(S.canSeeEnableHiddenProTips)return null;f=(0,A.jsx)(y.Z,{offset:n.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:f})}if(!O&&f&&n.showProRibbonTips&&S.canSeeEnableCe){if(S.canSeeEnableHiddenProTips)return null;f=(0,A.jsx)(y.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:f})}return n.space?(0,A.jsx)(W.Z,o()(o()({},n.space),{},{children:f})):f}},80821:function(K,x,e){e.d(x,{Z:function(){return N}});var D=e(97857),s=e.n(D),v=e(5574),o=e.n(v),F=e(24963),R=e(86738),y=e(28036),W=e(83062),A=e(67294),M=e(85893);function N(n){var S=(0,A.useState)(!1),Z=o()(S,2),f=Z[0],O=Z[1],I=(0,A.useContext)(F.Z),C=I.lang,H=I.message,w=function(){O(!0);var $=n.action();$ instanceof Promise?$.then(function(T){if(O(!1),T){typeof n.onSuccess=="function"&&n.onSuccess(T);var _="";n.messageSuccess?typeof n.messageSuccess=="function"?_=n.messageSuccess(T):_=n.messageSuccess.indexOf("notification.")==0?C(n.messageSuccess):n.messageSuccess:_=C("notification.finish"),n.asynced?H.info(_):H.success(_)}}).catch(function(T){O(!1),typeof n.onError=="function"&&n.onError(T)}):O(!1)};return n.confirm?(0,M.jsx)(R.Z,s()(s()({style:{width:500},title:n.confirmTitle?n.confirmTitle:C("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?C(n.confirm):n.confirm,onConfirm:w,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,M.jsx)(y.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&f?void 0:n.icon,loading:f,danger:n.danger,type:n.type,children:n.children})})):(0,M.jsx)(W.Z,{title:n.tips,children:(0,M.jsx)(y.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&f?void 0:n.icon,loading:f,onClick:w,danger:n.danger,type:n.type,children:n.children})})}},78451:function(K,x,e){e.d(x,{Z:function(){return v}});var D=e(67294),s=e(85893);function v(o){return(0,s.jsx)("span",{style:{width:o.width?o.width:"auto",wordBreak:"break-word"},children:o.content})}},3616:function(K,x,e){e.d(x,{Ed:function(){return o},FK:function(){return s},R_:function(){return D},ob:function(){return v}});var D=window.innerWidth<=1024?"90vw":"65vw",s="90vw",v="60vw",o="50vh"},24963:function(K,x,e){var D=e(67294),s=(0,D.createContext)({});x.Z=s},86783:function(K,x,e){e.r(x),e.d(x,{default:function(){return Pe}});var D=e(15009),s=e.n(D),v=e(99289),o=e.n(v),F=e(1699),R=e(80821),y=e(78451),W=e(5574),A=e.n(W),M=e(3616),N=e(24963),n=e(82346);function S(i){return Z.apply(this,arguments)}function Z(){return Z=o()(s()().mark(function i(j){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,n.request)("/api/app/volume/get-list",{method:"POST",data:j}));case 1:case"end":return l.stop()}},i)})),Z.apply(this,arguments)}function f(i){return O.apply(this,arguments)}function O(){return O=o()(s()().mark(function i(j){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,n.request)("/api/app/volume/create",{method:"POST",data:j}));case 1:case"end":return l.stop()}},i)})),O.apply(this,arguments)}function I(i){return C.apply(this,arguments)}function C(){return C=o()(s()().mark(function i(j){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,n.request)("/api/app/volume/prune",{method:"POST",data:j});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},i)})),C.apply(this,arguments)}function H(i){return w.apply(this,arguments)}function w(){return w=o()(s()().mark(function i(j){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,n.request)("/api/app/volume/delete",{method:"POST",data:j});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},i)})),w.apply(this,arguments)}function X(i){return $.apply(this,arguments)}function $(){return $=o()(s()().mark(function i(j){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,n.request)("/api/app/volume/get-detail",{method:"POST",data:j}));case 1:case"end":return l.stop()}},i)})),$.apply(this,arguments)}var T=e(184),_=e(5966),k=e(62370),ae=e(86615),le=e(97462),ue=e(17186),ie=e(24739),se=e(28036),q=e(34041),p=e(67294),t=e(85893),oe=(0,p.forwardRef)(function(i,j){var P=(0,p.useState)(!1),l=A()(P,2),V=l[0],z=l[1],E=(0,p.useRef)(),m=(0,p.useContext)(N.Z),c=m.message,a=m.notice;return(0,p.useImperativeHandle)(j,function(){return{}}),(0,t.jsxs)(T.a,{name:"create",title:"\u6DFB\u52A0\u5B58\u50A8\u5377",drawerProps:{width:M.R_},open:V,onOpenChange:function(r){z(r)},formRef:E,trigger:(0,t.jsx)(se.ZP,{type:"primary",children:"\u521B\u5EFA\u5B58\u50A8\u5377"}),onFinish:function(){var u=o()(s()().mark(function r(d){var h,g,b,B,Y,Q;return s()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return B=[],d.otherOptions&&d.otherOptions.map(function(re){B.push(re.name+`
`+re.value)}),L.next=4,f({name:d.name,driver:"local",type:d.type,nfsUrl:(h=d.nfsUrl)!==null&&h!==void 0?h:"",nfsMountPoint:(g=d.nfsMountPoint)!==null&&g!==void 0?g:"",nfsOptions:(b=d.nfsOptions)!==null&&b!==void 0?b:"",tmpfsOptions:d.tmpfsOptions,otherOptions:B});case 4:if(Y=L.sent,!(Y&&Y.data&&Y.data.info.Name!="")){L.next=10;break}return c.success("\u6DFB\u52A0\u5B58\u50A8\u5377\u6210\u529F"),i.onFinish&&i.onFinish(),(Q=E.current)===null||Q===void 0||Q.resetFields(),L.abrupt("return",!0);case 10:case"end":return L.stop()}},r)}));return function(r){return u.apply(this,arguments)}}(),children:[(0,t.jsx)(_.Z,{label:"\u540D\u79F0",name:"name",placeholder:"\u6307\u5B9A\u552F\u4E00\u5B58\u50A8\u5377\u540D\u79F0"}),(0,t.jsx)(k.Z,{label:"\u7C7B\u578B",name:"driver",children:(0,t.jsx)(q.Z,{defaultValue:"local",children:(0,t.jsx)(q.Z.Option,{value:"local",children:"local"})})}),(0,t.jsx)(ae.Z.Group,{name:"type",label:"\u5B58\u50A8\u7C7B\u578B",valueEnum:{default:"\u9ED8\u8BA4",tmpfs:"tmpfs",nfs:"Nfs",nfs4:"Nfs4",other:"\u81EA\u5B9A\u4E49"},initialValue:"default"}),(0,t.jsx)(le.Z,{name:["type"],children:function(r){var d=r.type;if(d=="other")return(0,t.jsx)(ue.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:"\u5B58\u50A8"},copyIconProps:!1,min:0,children:(0,t.jsxs)(ie.UW,{children:[(0,t.jsx)(_.Z,{name:"name",label:"\u540D\u79F0",placeholder:"\u4F8B\u5982:mountpoint"}),(0,t.jsx)(_.Z,{name:"value",label:"\u503C",placeholder:"\u4F8B\u5982:/etc/path"})]})});if(d=="nfs"||d=="nfs4")return[(0,t.jsx)(_.Z,{label:"\u5730\u5740",name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:"\u914D\u7F6ENfs\u670D\u52A1\u5730\u5740,\u4F8B\u5982 my.nfs.com \u6216\u662F 172.16.1.13 "},"nfsUrl"),(0,t.jsx)(_.Z,{label:"\u6302\u8F7D\u70B9",name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"\u4F8B\u5982, /export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,t.jsx)(_.Z,{label:"\u914D\u7F6E",name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(d=="tmpfs")return[(0,t.jsx)(_.Z,{label:"\u914D\u7F6E",name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),de=oe,ee=e(5251),ne=e(38345),U=e(26412),ce=e(60940),G=e(66309),fe=(0,p.forwardRef)(function(i,j){var P;(0,p.useImperativeHandle)(j,function(){return{showDetail:function(d){return o()(s()().mark(function h(){var g;return s()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,X({name:d});case 2:g=B.sent,E(!0),u(g.data);case 5:case"end":return B.stop()}},h)}))()}}});var l=(0,p.useState)(!1),V=A()(l,2),z=V[0],E=V[1],m=(0,p.useState)(),c=A()(m,2),a=c[0],u=c[1];return(0,t.jsxs)(T.a,{title:"\u5B58\u50A8\u8BE6\u60C5",open:z,submitter:!1,onOpenChange:function(d){E(d),!d&&u(void 0)},drawerProps:{width:M.R_},children:[(0,t.jsx)(ne.Z,{title:"\u5B58\u50A8\u8BE6\u60C5",ghost:!0,children:(0,t.jsxs)(U.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:[(0,t.jsx)(U.Z.Item,{label:"\u540D\u79F0",children:a==null?void 0:a.info.Name}),(0,t.jsx)(U.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:new Date((P=a==null?void 0:a.info.CreatedAt)!==null&&P!==void 0?P:"").toLocaleString()}),(0,t.jsx)(U.Z.Item,{label:"\u6302\u8F7D\u70B9",children:a==null?void 0:a.info.Mountpoint}),(0,t.jsx)(U.Z.Item,{label:"\u7C7B\u578B",children:a==null?void 0:a.info.Driver}),(a==null?void 0:a.info.Labels)&&(0,t.jsx)(U.Z.Item,{label:"Lables",children:(0,t.jsx)(U.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:(a==null?void 0:a.info.Labels)&&Object.keys(a==null?void 0:a.info.Labels).map(function(r){return(0,t.jsx)(U.Z.Item,{label:r,children:a.info.Labels[r]})})})})]})}),(0,t.jsx)(ne.Z,{title:"\u4F7F\u7528\u5BB9\u5668",ghost:!0,children:(0,t.jsx)(ce.Z,{rowKey:"Id",columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"Name",render:function(d,h,g){return(0,t.jsx)(n.Link,{target:"_blank",to:"/app/detail/edit/".concat(h.Id),children:(0,ee.fi)(h.Name,"/")})}},{title:"\u5BB9\u5668\u5185\u8DEF\u5F84",dataIndex:"Mount"},{title:"\u6743\u9650",render:function(d,h,g){return h.RW?(0,t.jsx)(G.Z,{children:"\u8BFB\u5199"}):(0,t.jsx)(G.Z,{children:"\u53EA\u8BFB"})}}],dataSource:a==null?void 0:a.inUseContainer,pagination:!1})})]})}),me=fe,he=e(67255),ve=e(36693),je=e(43425),ge=e(90078),xe=e(41482),Ee=e(97269),J=e(42075),Oe=e(96074),te=e(25593),_e=e(83062),pe=e(84567);function Pe(){var i=(0,p.useRef)(),j=(0,p.useRef)(),P=(0,p.useRef)(),l=(0,n.useAccess)(),V=(0,p.useContext)(N.Z),z=V.lang;return(0,t.jsxs)(ge._z,{header:{extra:[(0,t.jsx)(F.u,{access:"canSeeDockerVolumeManage",children:(0,t.jsx)(de,{onFinish:function(){var m,c;!((m=i.current)===null||m===void 0)&&m.reloadAndRest&&((c=i.current)===null||c===void 0||c.reloadAndRest())}},"create")})]},children:[(0,t.jsx)(me,{ref:j}),(0,t.jsx)(xe.Z,{scroll:{x:"max-content"},rowKey:"Name",pagination:(0,he.O)(),columns:[{title:"\u540D\u79F0",dataIndex:"Name",width:300,render:function(m,c,a,u,r){return(0,t.jsx)(y.Z,{content:c.Name})}},{title:"\u6240\u5C5E\u5BB9\u5668",ellipsis:!0,search:!1,render:function(m,c,a,u,r){return c.InUse?(0,t.jsx)(J.Z,{direction:"vertical",children:c.InUse.map(function(d,h){return(0,t.jsx)(n.Link,{target:"_blank",to:"/app/detail/edit/"+d.md5,children:(0,t.jsx)(G.Z,{color:"cyan",icon:(0,t.jsx)(ve.Z,{}),children:(0,ee.fi)(d.name,"/")})},h)})},a):(0,t.jsx)(G.Z,{children:"\u672A\u4F7F\u7528"})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:"\u6302\u8F7D\u70B9",search:!1,width:250,dataIndex:"Mountpoint",render:function(m,c,a,u,r){return(0,t.jsx)(y.Z,{content:c.Mountpoint})}},{title:"\u521B\u5EFA\u65F6\u95F4",ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(m,c,a,u,r){return new Date(c.CreatedAt).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,fixed:"right",hidden:!l.canSeeDockerVolumeManage,render:function(m,c,a,u,r){return(0,t.jsx)(J.Z,{split:(0,t.jsx)(Oe.Z,{type:"vertical"}),children:(0,t.jsx)(te.Z.Link,{onClick:function(){var h;(h=j.current)===null||h===void 0||h.showDetail(c.Name)},children:(0,t.jsx)(_e.Z,{title:"\u7BA1\u7406",children:(0,t.jsx)(je.Z,{})})})})}}],request:function(){var E=o()(s()().mark(function m(c,a,u){var r,d;return s()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,S({name:c.name});case 2:return r=g.sent,d=[],r.data.inUse?d=r.data.list.map(function(b){return r.data.inUse&&r.data.inUse[b.Name]?b.InUse=r.data.inUse[b.Name]:b.InUse=void 0,b}):d=r.data.list,g.abrupt("return",{data:d,success:!0,total:r.data.list.length});case 6:case"end":return g.stop()}},m)}));return function(m,c,a){return E.apply(this,arguments)}}(),rowSelection:l.canSeeDockerVolumeManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:i,tableAlertOptionRender:function(m){var c=m.selectedRowKeys;return(0,t.jsxs)(J.Z,{size:16,children:[(0,t.jsx)(R.Z,{danger:!0,type:"primary",action:function(){return H({name:c})},onSuccess:function(){var u,r;return!((u=i.current)===null||u===void 0)&&u.reloadAndRest&&((r=i.current)===null||r===void 0||r.reloadAndRest()),!0},onError:function(){var u,r;return!((u=i.current)===null||u===void 0)&&u.reset&&((r=i.current)===null||r===void 0||r.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"}),(0,t.jsx)(R.Z,{action:function(){var u,r;return I({deleteAll:(u=(r=P.current)===null||r===void 0?void 0:r.getFieldValue("deleteAll"))!==null&&u!==void 0?u:!1})},onSuccess:function(){var u,r;return!((u=i.current)===null||u===void 0)&&u.reloadAndRest&&((r=i.current)===null||r===void 0||r.reloadAndRest()),!0},onError:function(){var u,r;return!((u=i.current)===null||u===void 0)&&u.reset&&((r=i.current)===null||r===void 0||r.reset()),!0},confirm:(0,t.jsx)(Ee.A,{formRef:P,submitter:!1,children:(0,t.jsxs)(J.Z,{style:{width:280},direction:"vertical",children:[(0,t.jsx)(te.Z.Text,{children:z("notification.confirm.title")}),(0,t.jsx)(k.Z,{name:"deleteAll",valuePropName:"checked",children:(0,t.jsx)(pe.Z,{children:"\u662F\u5426\u6E05\u7406\u975E\u533F\u540D\u5377\uFF1F"})})]})}),children:"\u6E05\u7406\u672A\u4F7F\u7528\u5B58\u50A8"},"clear")]})}})]})}},67255:function(K,x,e){e.d(x,{O:function(){return D},j:function(){return s}});function D(v){var o=localStorage.getItem("dpanel-pagesize");return o=="all"?!1:{current:v==null?void 0:v.page,showSizeChanger:!0,defaultPageSize:parseInt(o!=null?o:"20"),onChange:function(R,y){localStorage.setItem("dpanel-page-"+location.pathname.split("/").slice(-2).join("-"),"".concat(R))}}}function s(v){var o="dpanel-table-column-".concat(v),F={};if(localStorage.getItem(o)){var R;F=JSON.parse((R=localStorage.getItem(o))!==null&&R!==void 0?R:"{}")}return{defaultValue:F,onChange:function(W){localStorage.setItem("dpanel-table-column-".concat(v),JSON.stringify(W))}}}}}]);
