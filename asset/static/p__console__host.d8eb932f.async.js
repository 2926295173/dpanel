"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6856],{49610:function(C,l,e){var u=e(5574),d=e.n(u),r=e(67294),O=e(52626),f=e(78267),D=e.n(f),M=e(12323),g=e(87662),m=e(4244),W=e.n(m),T=e(24078),h=e(85893),t,o,n,i,U=(0,r.forwardRef)(function(B,I){var y,L=(0,r.useState)(),b=d()(L,2),S=b[0],j=b[1],K=(0,r.useState)(""),R=d()(K,2),v=R[0],x=R[1];(0,r.useImperativeHandle)(I,function(){return{start:function(c,_){P(),o.fit(),_.width=t.cols,_.height=t.rows;var A=_?Object.keys(_).filter(function(a){return _&&_[a]}).map(function(a){if(_&&_[a])return"".concat(a,"=").concat(_[a])}):[];n=new WebSocket((0,O.R)(c+"?"+A.join("&"))),n.addEventListener("message",function(a){var E=JSON.parse(a.data),p=E.type;if(p==c&&(t.write(E.data),E.data.indexOf("exec failed")!=-1)){P();return}}),i=t.onData(function(a){var E={content:{command:a},type:c};n&&n.send(JSON.stringify(E))}),x(c),j(_)},close:function(){P()},fit:function(){return o.fit(),{width:t.cols,height:t.rows}},run:function(c){S&&c&&c.forEach(function(_){var A={content:{command:_+`
`},type:v};n&&n.send(JSON.stringify(A))})}}}),(0,r.useEffect)(function(){return t=new m.Terminal(M.X),o=new f.FitAddon,t.loadAddon(o),t.open(document.getElementById("terminal-container-console")),o.fit(),(0,g.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(s){s.data&&s.data.fontSize&&Object.assign(t.options,s.data)}),function(){P()}},[]),(0,r.useEffect)(function(){window.addEventListener("resize",function(){o.fit();var s={size:{width:t.cols,height:t.rows},type:v};v&&n&&n.send(JSON.stringify(s))})},[v]);function P(){i&&(t.reset(),o.fit(),t.focus(),i.dispose()),n&&(n.close(),n=null)}return(0,h.jsx)("div",{style:{height:(y=B.height)!==null&&y!==void 0?y:"100vh"},id:"terminal-container-console"})});l.Z=U},12323:function(C,l,e){e.d(l,{X:function(){return u}});var u={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},d=null},67359:function(C,l,e){e.r(l),e.d(l,{default:function(){return g}});var u=e(5574),d=e.n(u),r=e(49610),O=e(87662),f=e(82346),D=e(67294),M=e(85893);function g(){var m=(0,f.useParams)(),W=(0,f.useSearchParams)(),T=d()(W,2),h=T[0],t=T[1],o=(0,D.useRef)();return(0,D.useEffect)(function(){m.id&&(0,O.K3)({name:m.id}).then(function(n){var i;window.document.title="".concat(n.data.name," - console"),(i=o.current)===null||i===void 0||i.start("/console/host/".concat(n.data.name),{cmd:h.get("cmd"),workDir:h.get("workDir")})}),document.body.style.overflow="hidden"},[]),(0,M.jsx)(r.Z,{ref:o})}}}]);
