"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{91058:function(Ce,Y,n){var q=n(19632),f=n.n(q),te=n(97857),j=n.n(te),k=n(5574),P=n.n(k),B=n(89035),F=n(64317),E=n(5966),J=n(38345),d=n(17186),b=n(24739),N=n(42075),g=n(28036),ee=n(85576),r=n(67294),t=n(95089),z=n(12491),ue=n(62597),R=n(79245),T=n(85893),w="docker-image",ae=(0,r.forwardRef)(function(y,de){var se=(0,r.useState)(w),M=P()(se,2),ge=M[0],je=M[1],Q=(0,r.useRef)(),Ie=(0,r.useState)(""),he=P()(Ie,2),we=he[0],ye=he[1],e=function(){ge!="code"?je("code"):je(w)};(0,r.useImperativeHandle)(de,function(){return{addEnvItem:function(x,ne){var le,re=(le=Q.current)===null||le===void 0?void 0:le.getList(),_e=!1;if(re==null||re.map(function(ce){if(ce.name==x){_e=!0;return}}),!_e){var ve;(ve=Q.current)===null||ve===void 0||ve.add({name:x,value:ne})}},clear:function(){var x;(x=Q.current)===null||x===void 0||(x=x.getList())===null||x===void 0||x.map(function(ne,le){var re;(re=Q.current)===null||re===void 0||re.remove(le)})}}});function Oe(S){try{var x,ne;S==""&&(S=Ze());for(var le=(x=(ne=Q.current)===null||ne===void 0||(ne=ne.getList())===null||ne===void 0?void 0:ne.length)!==null&&x!==void 0?x:0,re=le;re>=0;re--){var _e;(_e=Q.current)===null||_e===void 0||_e.remove(re)}var ve=S.split(`
`),ce=0;ve.map(function(xe){var be,Re=xe.split("=");Re.length<2||((be=Q.current)===null||be===void 0||be.add({name:Re[0],value:Re.slice(1).join("=")},ce),ce++)})}catch(xe){console.log(xe)}}function Ze(){if(Q&&Q.current&&Q.current.getList){var S,x=(S=Q.current)===null||S===void 0?void 0:S.getList();if(x){var ne=[];return x.map(function(le){ne.push("".concat(le.name,"=").concat(le.value))}),ne.join(`
`)}else return""}else return""}function Le(S){var x,ne,le,re,_e={},ve={help:S&&S.label?S.label:"",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:y.requireValue?!0:(0,R.y)((x=S.rule)===null||x===void 0?void 0:x.kind,ue.fp.EnvValueRuleRequired)}],disabled:y.showDisableValue||(0,R.y)((ne=S.rule)===null||ne===void 0?void 0:ne.kind,ue.fp.EnvValueRuleDisabled)};if((0,R.y)((le=S.rule)===null||le===void 0?void 0:le.kind,ue.fp.EnvValueTypeSelect)){var ce;return(0,T.jsx)(F.Z,j()(j()({fieldProps:_e},ve),{},{width:y.showInDrawer?"sm":"md",options:((ce=S.rule)===null||ce===void 0?void 0:ce.option)&&S.rule.option.map(function(xe){return{label:xe.name,value:xe.value}}),initialValue:S.value}))}else return(0,R.y)((re=S.rule)===null||re===void 0?void 0:re.kind,ue.fp.EnvValueTypeNumber)?(0,T.jsx)(E.Z,j()(j()({fieldProps:_e},ve),{},{width:y.showInDrawer?"sm":"md",rules:[].concat(f()(ve.rules),[{pattern:new RegExp("^[0-9]*$")}]),help:ve.help+",\u6570\u503C\u7C7B\u578B"})):(0,T.jsx)(E.Z,j()(j()({fieldProps:_e},ve),{},{width:y.showInDrawer?"sm":"md"}))}return(0,T.jsxs)(J.Z,{ghost:y.showCardGhost,title:y.label?y.label:null,headerBordered:!0,extra:(y.showCodeMode||y.showImportButton)&&(0,T.jsxs)(N.Z,{children:[y.showImportButton&&(0,T.jsx)("div",{style:{marginBottom:"-25px"},children:(0,T.jsx)(z.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(x){return Oe(x),!0},onLoad:function(x){if(x.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),y.showCodeMode?(0,T.jsx)(g.ZP,{icon:(0,T.jsx)(B.Z,{}),type:ge=="code"?"primary":"default",onClick:e,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,T.jsx)(d.u,{name:y.name?y.name:"environment",actionRef:Q,creatorButtonProps:y.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,deleteIconProps:y.showDeleteButton,min:100,label:y.listLabel,children:function(x,ne,le){var re=le.getCurrentRowData();return(0,T.jsxs)(b.UW,{style:{marginBottom:"5px"},children:[(0,T.jsx)(E.Z,{width:y.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:y.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),Le(re)]})}}),y.showCodeMode&&(0,T.jsx)(ee.Z,{width:"800px",open:ge=="code",onCancel:function(){return je("docker-image")},onOk:function(){Oe(we),je("docker-image")},children:(0,T.jsx)(t.ZP,{onChange:function(x){return ye(x)},value:Ze(),height:"680px",theme:"light"})})]})});Y.Z=ae},92067:function(Ce,Y,n){n.d(Y,{Z:function(){return N}});var q=n(15009),f=n.n(q),te=n(99289),j=n.n(te),k=n(60335),P=n(64789),B=n(78099),F=n(42075),E=n(28036),J=n(37413),d=n(5251),b=n(85893);function N(g){return(0,b.jsx)(B.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"name",render:function(r,t,z,ue){return(0,b.jsx)(F.Z,{direction:"vertical",style:{textAlign:"left"},children:t==null?void 0:t.Names.map(function(R){return(0,d.fi)(R,"/")})},t.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(r,t,z,ue){var R=[],T=[];return t!=null&&t.Ports&&t.Ports.map(function(w,ae){w.PublicPort?R.push(w):T.push(w)}),(0,b.jsx)(J.Z,{publicPort:R,privatePort:T,domain:[]})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(r,t,z,ue){return[(0,b.jsx)(E.ZP,{type:"link",onClick:j()(f()().mark(function R(){var T;return f()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,(0,k.jV)({md5:t.Id});case 2:T=ae.sent,g.onSelect&&g.onSelect(T.data.info);case 4:case"end":return ae.stop()}},R)})),children:(0,b.jsx)(P.Z,{})},t.Id)]}}],rowKey:"Id",request:function(){var ee=j()(f()().mark(function r(t,z,ue){var R;return f()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,k.IE)({siteTitle:t.name});case 2:return R=w.sent,w.abrupt("return",{data:R.data.list,success:!0,total:R.data.list.length});case 4:case"end":return w.stop()}},r)}));return function(r,t,z){return ee.apply(this,arguments)}}(),pagination:{pageSize:9}})}},52255:function(Ce,Y,n){n.d(Y,{Z:function(){return te}});var q=n(67294),f=n(85893);function te(j){return(0,f.jsx)("div",{style:{display:j.show?"block":"none"},children:j.children})}},53102:function(Ce,Y,n){n.d(Y,{Z:function(){return te}});var q=n(67294),f=n(85893);function te(j){var k=function(B){if(j.check&&j.check(B)){B.preventDefault();return}if(B.target&&B.target.className&&B.target.className.indexOf(j.targetClassName)!==-1){B.preventDefault();return}};return(0,q.useEffect)(function(){return window.addEventListener("wheel",k,{passive:!1}),function(){window.removeEventListener("wheel",k)}},[]),(0,f.jsx)(f.Fragment,{children:j.children})}},44349:function(Ce,Y,n){var q=n(97857),f=n.n(q),te=n(17186),j=n(5966),k=n(86250),P=n(67294),B=n(85893),F=(0,P.forwardRef)(function(E,J){var d=(0,P.useRef)();(0,P.useImperativeHandle)(J,function(){return{addItem:function(g,ee){var r,t=(r=d.current)===null||r===void 0?void 0:r.getList(),z=!1;if(t==null||t.map(function(R){if(R.name==g){z=!0;return}}),!z){var ue;(ue=d.current)===null||ue===void 0||ue.add({name:g,value:ee})}},clear:function(){var g;(g=d.current)===null||g===void 0||(g=g.getList())===null||g===void 0||g.map(function(ee,r){var t;(t=d.current)===null||t===void 0||t.remove(r)})}}});var b={};return E.hideCopyButton===!0&&(b.copyIconProps=!1),E.hideDeleteButton===!0&&(b.deleteIconProps=!1),(0,B.jsx)(te.u,f()(f()({initialValue:E.initialValue,label:E.label,name:E.name,actionRef:d,creatorButtonProps:E.showAddButton?{creatorButtonText:"\u6DFB\u52A0"+(E.label?E.label:E.name)}:!1,min:E.min?E.min:0},b),{},{children:function(g,ee,r){return(0,B.jsx)(k.Z,{justify:E.justify,gap:E.gap,children:E.items.map(function(t){return t.render?(0,B.jsx)("div",{children:t.render&&t.render(g,ee,r)},"".concat(E.name,"-").concat(t.name,"-").concat(g.key)):(0,B.jsx)(j.Z,{width:t.width,name:t.name,label:t.label,required:t.required,rules:[{required:t.required}],disabled:t.disabled,placeholder:t.placeholder},"".concat(E.name,"-").concat(t.name,"-").concat(g.key))})})}}))});Y.Z=F},12491:function(Ce,Y,n){n.d(Y,{Z:function(){return F}});var q=n(24963),f=n(88484),te=n(62370),j=n(31418),k=n(28036),P=n(67294),B=n(85893);function F(E){var J=(0,P.useContext)(q.Z),d=J.message,b=J.notice,N=J.lang,g=(0,P.useRef)(null),ee=j.Z.useApp(),r=function(){g.current&&(g.current.click(),g.current.onchange=function(z){if(!z||!z.target)return"";var ue=new FileReader;ue.onload=function(T){var w,ae,y=(w=T.target)===null||w===void 0?void 0:w.result;if(E.onLoad)try{E.onLoad&&E.onLoad(y)}catch(de){b.error(de);return}typeof E.onImport=="function"&&(d.success("\u6210\u529F\u5BFC\u5165 ".concat(E.title)),E.onImport(y)),(ae=g.current)!==null&&ae!==void 0&&ae.value&&(g.current.value="")};var R=z.target;if(R.files)try{ue.readAsText(R.files[0])}catch(T){b.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(te.Z,{children:(0,B.jsx)(k.ZP,{icon:(0,B.jsx)(f.Z,{}),block:!0,onClick:r,children:E.title})}),(0,B.jsx)("input",{style:{display:"none"},type:"file",ref:g,name:"importFileInput"})]})}},46442:function(Ce,Y,n){var q=n(15009),f=n.n(q),te=n(99289),j=n.n(te),k=n(5574),P=n.n(k),B=n(67294),F=n(14946),E=n(64789),J=n(78099),d=n(28036),b=n(85265),N=n(42075),g=n(66309),ee=n(28230),r=n(85893),t=(0,B.forwardRef)(function(z,ue){(0,B.useImperativeHandle)(ue,function(){return{show:function(){ae(!0)}}});var R=(0,B.useState)(!1),T=P()(R,2),w=T[0],ae=T[1],y=(0,B.useRef)();return(0,r.jsxs)(r.Fragment,{children:[z.showTriggerButton&&(0,r.jsx)(d.ZP,{onClick:function(){ae(!0)},children:"\u52A0\u5165\u7F51\u7EDC"}),(0,r.jsx)(b.Z,{title:"\u9009\u62E9\u7F51\u7EDC",width:800,footer:!1,open:w,onClose:function(){return ae(!1)},extra:(0,r.jsx)(N.Z,{children:(0,r.jsx)(ee.Z,{onFinish:function(){var se,M;!((se=y.current)===null||se===void 0)&&se.reloadAndRest&&((M=y.current)===null||M===void 0||M.reloadAndRest())}},"create")}),children:(0,r.jsx)(J.Z,{rowKey:"Name",toolBarRender:!1,actionRef:y,columns:[{title:"\u540D\u79F0",dataIndex:"Name",render:function(se,M,ge,je,Q){return M.Name=="none"||M.Name=="bridge"||M.Name=="host"?(0,r.jsxs)(r.Fragment,{children:[M.Name," ",(0,r.jsx)(g.Z,{color:"blue",children:"System"})]}):(0,r.jsx)(r.Fragment,{children:se})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,dataIndex:"Driver",search:!1},{title:"IPAM Driver",ellipsis:!0,width:120,search:!1,dataIndex:["IPAM","Driver"]},{title:"IPV4 IPAM Network",search:!1,dataIndex:["IPAM","Config",0,"Subnet"],render:function(se,M,ge,je,Q){return(0,r.jsxs)(N.Z,{children:[M.IPAM.Config&&M.IPAM.Config[0]&&"".concat(M.IPAM.Config[0].Subnet," - ").concat(M.IPAM.Config[0].Gateway),M.IPAM.Config&&M.IPAM.Config[1]&&"".concat(M.IPAM.Config[1].Subnet," - ").concat(M.IPAM.Config[1].Gateway)]})}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(se,M,ge,je,Q){return[M.Name!="none"&&M.Name!="bridge"&&M.Name!="host"&&(0,r.jsx)(d.ZP,{type:"link",onClick:function(){z.onSelect(M),ae(!1)},children:(0,r.jsx)(E.Z,{})},M.Id)]}}],request:function(){var de=j()(f()().mark(function se(M,ge,je){var Q;return f()().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return he.next=2,(0,F.jR)({name:M.Name});case 2:return Q=he.sent,he.abrupt("return",{data:Q.data.list,success:!0,total:Q.data.list.length});case 4:case"end":return he.stop()}},se)}));return function(se,M,ge){return de.apply(this,arguments)}}(),pagination:{pageSize:10}})})]})});Y.Z=t},35880:function(Ce,Y,n){var q=n(67294),f=(0,q.createContext)({});Y.Z=f},57841:function(Ce,Y,n){n.r(Y),n.d(Y,{default:function(){return jn}});var q=n(15009),f=n.n(q),te=n(99289),j=n.n(te),k=n(5574),P=n.n(k),B=n(90078),F=n(38345),E=n(97269),J=n(2236),d=n(5966),b=n(24739),N=n(97462),g=n(30291),ee=n(92398),r=n(38925),t=n(67294),z=n(35880),ue=n(78099),R=n(62370),T=n(85265),w=n(42075),ae=n(96074),y=n(28036),de=n(83062),se=n(3393),M=n(18148),ge=n(5251),je=n(64789),Q=n(85060),Ie=n(28307),he=n(78451),we=n(99861),ye=n(80821),e=n(85893);function Oe(c){var V=(0,t.useState)(!1),A=P()(V,2),U=A[0],p=A[1],I=(0,t.useRef)(),s=(0,t.useContext)(z.Z),v=s.createFormRef,D=s.volumeListRef,O=s.createEnvRef,m=s.domainRef,o=(0,t.useRef)(),C=function(){var i=j()(f()().mark(function _(l){var h,H,Z,W,ie,Be,G,L,a,X,u,fe;return f()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.next=2,(0,se.YU)({md5:l});case 2:return W=oe.sent,c.redeploy||(L=(ie=v.current)===null||ie===void 0?void 0:ie.getFieldsValue(),(Be=v.current)===null||Be===void 0||Be.resetFields(),(G=v.current)===null||G===void 0||G.setFieldsValue({siteName:L.siteName,siteTitle:L.siteTitle,useBridgeNetwork:L.useBridgeNetwork})),W.data.info.Config.Env&&W.data.info.Config.Env.map(function(K){var De,me=K.split("=");(De=O.current)===null||De===void 0||De.addEnvItem(me[0],me.slice(1).join("="))}),(h=v.current)===null||h===void 0||h.setFieldValue("imageName",l),(H=v.current)===null||H===void 0||H.setFieldValue("workDir",W.data.info.Config.WorkingDir),(Z=m.current)===null||Z===void 0||Z.setExposePort(W.data.info.Config.ExposedPorts),c.redeploy||(W.data.info.Config.Volumes?(u=[],Object.keys(W.data.info.Config.Volumes).map(function(K,De){u.push(K)}),(X=D.current)===null||X===void 0||X.setDefaultDestPath(u)):(fe=D.current)===null||fe===void 0||fe.setDefaultDestPath([]),(a=v.current)===null||a===void 0||a.setFieldsValue({workDir:{value:"",useDefault:!0,default:W.data.info.Config.WorkingDir},user:{value:"",useDefault:!0,default:W.data.info.Config.User},command:{value:"",useDefault:!0,default:W.data.info.Config.Cmd&&W.data.info.Config.Cmd.join(" ")},entrypoint:{value:"",useDefault:!0,default:W.data.info.Config.Entrypoint&&W.data.info.Config.Entrypoint.join(" ")}})),oe.abrupt("return",!0);case 10:case"end":return oe.stop()}},_)}));return function(l){return i.apply(this,arguments)}}();return(0,t.useEffect)(function(){c.fromImageId&&C(c.fromImageId)},[c.fromImageId]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(T.Z,{open:U,width:800,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onClose:function(){return p(!1)},children:(0,e.jsx)(ue.Z,{scroll:{x:"max-content"},columns:[{title:"Id",dataIndex:"Id",search:!1,width:80,render:function(_,l,h,H,Z){return(0,e.jsx)(he.Z,{content:l.Id.slice(7,19)})}},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",width:200,render:function(_,l,h,H){return(0,e.jsx)(he.Z,{content:l.RepoTags[0]})}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",search:!1,width:100,render:function(_,l,h,H){return(0,e.jsx)("div",{children:(0,ge.ZM)(l.Created*1e3)},l.Id)},sorter:function(_,l){return _.Created-l.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:50,render:function(_,l,h,H){return(0,e.jsx)(w.Z,{split:(0,e.jsx)(ae.Z,{type:"vertical"}),children:(0,e.jsx)(ye.Z,{icon:(0,e.jsx)(je.Z,{}),tips:"\u4F7F\u7528\u955C\u50CF",action:function(){return C(l.RepoTags[0])},type:"link",onSuccess:function(){var W;p(!1),(W=D.current)===null||W===void 0||W.initImageRootfs(l.RepoTags[0])}},"addImage")})}}],request:function(){var i=j()(f()().mark(function _(l,h,H){var Z,W,ie,Be,G;return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c.redeploy&&(W=(Z=v.current)===null||Z===void 0?void 0:Z.getFieldValue("imageName"),l.tag=W?W.split(":")[0]:l.tag),a.next=3,(0,M.KG)({tag:l.tag});case 3:return ie=a.sent,Be=0,G=[],ie.data.list&&(G=ie.data.list.flatMap(function(X){return X.RepoTags.map(function(u){return{Key:Be++,Id:X.Id,Created:X.Created,RepoTags:[u]}})})),a.abrupt("return",{data:G,success:!0,total:G.length});case 8:case"end":return a.stop()}},_)}));return function(_,l,h){return i.apply(this,arguments)}}(),formRef:I,rowKey:"Key",pagination:{pageSize:8}})},"imageTableList"),(0,e.jsxs)(w.Z.Compact,{children:[(0,e.jsx)(d.Z,{width:"lg",label:"\u955C\u50CF",tooltip:c.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0}),!c.redeploy&&(0,e.jsx)(R.Z,{label:" ",children:(0,e.jsx)(y.ZP,{type:"primary",onClick:function(){return p(!0)},children:"\u9009\u62E9\u955C\u50CF"},"showBtn")}),(0,e.jsx)(N.Z,{name:["imageName"],children:function(_){var l=_.imageName;if(l)return(0,e.jsx)(R.Z,{label:" ",children:(0,e.jsx)(we.Z,{finishAutoHide:!0,image:l?[l]:[],trigger:(0,e.jsx)(de.Z,{title:"\u91CD\u65B0\u62C9\u53D6\u5F53\u524D\u955C\u50CF",children:(0,e.jsx)(y.ZP,{icon:(0,e.jsx)(Q.Z,{}),children:"\u66F4\u65B0\u5F53\u524D\u955C\u50CF"})})})})}}),(0,e.jsx)(R.Z,{label:" ",children:(0,e.jsx)(Ie.Z,{onClick:function(){p(!1)},ref:o,onFinish:function(_){C(_)}},"remote")})]})]})}var Ze=n(60335),Le=n(51042),S=n(63434),x=n(17186),ne=n(25593),le=n(92067),re=(0,t.forwardRef)(function(c,V){var A=(0,t.useState)(!1),U=P()(A,2),p=U[0],I=U[1],s=(0,t.useRef)(),v=function(m){var o=(0,t.useState)([]),C=P()(o,2),i=C[0],_=C[1];return(0,t.useEffect)(function(){(0,Ze.jV)({md5:m.name}).then(function(l){var h;return _((h=l.data.info.Config.Env)!==null&&h!==void 0?h:[]),!0})},[]),(0,e.jsxs)(F.Z,{bordered:!0,extra:m.action,style:{marginBottom:10},children:[(0,e.jsx)(F.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(d.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(d.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(S.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(F.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(w.Z,{direction:"vertical",children:i&&i.map(function(l,h){return(0,e.jsx)(ne.Z.Text,{copyable:{icon:(0,e.jsx)(Le.Z,{}),onCopy:function(){var Z=l.split("=");c.onAddEnv(Z[0],Z[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:l},style:{width:300},children:l},h)})},"linkEnv")})]})},D=function(m){var o,C,i=!1,_=(o=(C=s.current)===null||C===void 0?void 0:C.getList())!==null&&o!==void 0?o:[];if(_.map(function(h){h.name==m.name&&(i=!0)}),!i){var l;(l=s.current)===null||l===void 0||l.add(m)}};return(0,t.useImperativeHandle)(V,function(){return{setDefaultLink:function(m){m&&m.map(function(o){o.name!=""&&D(o)})}}}),(0,e.jsxs)(F.Z,{title:"\u5173\u8054\u5BB9\u5668",headerBordered:!0,children:[(0,e.jsx)(x.u,{name:"links",actionRef:s,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(m,o){return I(!0),!1}},copyIconProps:!1,min:0,itemRender:function(m,o){return(0,e.jsx)(v,{action:m.action,name:o.record.name})}}),(0,e.jsx)(T.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:800,footer:!1,open:p,onClose:function(){return I(!1)},children:(0,e.jsx)(le.Z,{onSelect:function(m){D({name:m.Name,alise:m.Config.Hostname,volume:!1}),I(!1)}})})]})}),_e=re,ve=n(91058),ce=n(64317),xe=n(19054),be=n(53102),Re=(0,t.forwardRef)(function(c,V){var A=(0,t.useRef)(),U=(0,t.useContext)(z.Z),p=U.createFormRef,I=(0,t.useState)(),s=P()(I,2),v=s[0],D=s[1];(0,t.useImperativeHandle)(V,function(){return{setDefaultDestPath:function(o){var C,i,_=(C=(i=A.current)===null||i===void 0?void 0:i.getList())!==null&&C!==void 0?C:[];o.length!=0&&o.filter(function(l){return l!=""}).map(function(l){var h=!1;if(_.map(function(Z){if(Z.dest==l){h=!0;return}}),!h){var H;(H=A.current)===null||H===void 0||H.add({dest:l,permission:"write",inImage:!0})}})},addUserVolumeItem:function(o,C){var i,_=(i=A.current)===null||i===void 0?void 0:i.getList(),l=!1;if(_==null||_.map(function(H){if(H.dest==C){l=!0;return}}),!l){var h;(h=A.current)===null||h===void 0||h.add({host:o,dest:C})}},initImageRootfs:O}});var O=function(){var m=j()(f()().mark(function o(C){var i,_;return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!v){h.next=2;break}return h.abrupt("return");case 2:if(C){h.next=4;break}return h.abrupt("return");case 4:return h.next=6,(0,se.cD)({md5:C});case 6:i=h.sent,_={title:"/",value:"/",children:[]},i.data.list.map(function(H){var Z=_;H.split("/").map(function(W,ie,Be){var G;if(W){var L=(G=Z.children)===null||G===void 0?void 0:G.find(function(a){return a.title===W});L||(L={title:W,value:Be.join("/"),children:[]},Z.children?Z.children.push(L):Z.children=[L]),Z=L}})}),_.children&&D(_.children);case 10:case"end":return h.stop()}},o)}));return function(C){return m.apply(this,arguments)}}();return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(F.Z,{title:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u6216\u662F\u5B58\u50A8\u5377",tooltip:"\u6302\u8F7D\u53EF\u4EE5\u662F\u5BBF\u4E3B\u673A\u7684\u76EE\u5F55\u6216\u662F\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u5B58\u50A8\u5377\u540D\uFF08\u81EA\u52A8\u65B0\u5EFA\uFF09\u3002",headerBordered:!0,direction:"column",children:(0,e.jsx)(x.u,{actionRef:A,name:"volumes",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u6620\u5C04\u76EE\u5F55"},copyIconProps:!1,min:0,children:function(o,C,i){var _,l=i.getCurrentRowData();return(0,e.jsxs)(b.UW,{children:[(0,e.jsxs)(w.Z.Compact,{children:[(0,e.jsx)(d.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u3001\u76EE\u5F55\u6216\u5B58\u50A8\u5377",name:"host",width:c.showInDrawer?"sm":"md"}),(0,e.jsx)(ce.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsxs)(w.Z.Compact,{children:[(0,e.jsx)(d.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:c.showInDrawer?"sm":"md",required:!0,rules:[{required:!0}],disabled:c.disabledUserVolumeDest||l.inImage}),!c.disabledUserVolumeDest&&!l.inImage&&((_=p.current)===null||_===void 0?void 0:_.getFieldValue)&&p.current.getFieldValue("imageName")&&(0,e.jsx)(be.Z,{targetClassName:"ant-select-tree",children:(0,e.jsx)(xe.Z,{label:" ",width:"sm",placeholder:"\u9009\u62E9\u5BB9\u5668\u5185\u76EE\u5F55",fieldProps:{loading:!v,popupMatchSelectWidth:500,placement:"topLeft",treeLine:!0,showSearch:!0,onChange:function(H,Z,W){i.setCurrentRowData({dest:H})},treeData:v}},"abc4")})]})]})}})})})}),ze=Re,Xe=n(2831),Ee=n(52688),Ke=n(86125),Je=n(71230),He=n(15746),Qe=n(44349);function qe(c){var V,A=(0,t.useState)(),U=P()(A,2),p=U[0],I=U[1];return(0,t.useEffect)(function(){(0,Xe.aF)().then(function(s){return I(s.data.info)})},[]),(0,e.jsxs)(F.Z,{children:[(0,e.jsx)(d.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:"64M",tooltip:"0 \u4E3A\u4F7F\u7528\u9ED8\u8BA464M\uFF0C\u914D\u7F6E\u65F6\u8BF7\u9644\u52A0\u5355\u4F4D\uFF0C\u4F8B\u5982\uFF1A1G"}),(0,e.jsx)(R.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Ke.Z,{step:.1,max:p==null?void 0:p.NCPU,marks:{0:"0",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(R.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Ke.Z,{step:256,max:Math.round(((V=p==null?void 0:p.MemTotal)!==null&&V!==void 0?V:0)/1024/1024),marks:{0:"0",1024:"1G",2048:"2G",3072:"3G",4096:"4G"}})}),(0,e.jsx)(ce.Z,{label:"\u65E5\u5FD7\u7C7B\u578B",name:["log","driver"],tooltip:"\u9ED8\u8BA4\u4F7F\u7528 json-file \u9A71\u52A8\u7531 docker \u7EDF\u4E00\u7BA1\u7406\u3002\u91C7\u7528 journal \u65F6\u65E5\u5FD7\u5C06\u6765\u5BBF\u4E3B\u673A\u7BA1\u7406",initialValue:"json-file",valueEnum:{"json-file":"json-file",journald:"journal (\u5BBF\u4E3B\u9700\u8981\u5B89\u88C5journal\u670D\u52A1)"}}),(0,e.jsx)(N.Z,{name:["log"],children:function(v){var D=v.log;if(D.driver=="json-file")return(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(d.Z,{label:"\u65E5\u5FD7\u5207\u5272\u5927\u5C0F",name:["log","maxSize"],placeholder:"\u4F8B\u5982\uFF1A10k,5M",tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u5207\u5272\u65E5\u5FD7"}),(0,e.jsx)(d.Z,{tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u6E05\u7406\u65E5\u5FD7\u6587\u4EF6",label:"\u4FDD\u7559\u65E5\u5FD7\u6587\u4EF6\u6570",name:["log","maxFile"],placeholder:"\u4F8B\u5982\uFF1A10"})]})}}),(0,e.jsx)(Qe.Z,{name:"device",label:"\u5173\u8054\u8BBE\u5907",hideCopyButton:!0,showAddButton:!0,items:[{label:"\u5BBF\u4E3B\u673A\u8DEF\u5F84",name:"host",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"},{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"}]}),(0,e.jsxs)(Je.Z,{children:[(0,e.jsx)(He.Z,{span:4,children:(0,e.jsx)(Ee.Z,{label:"\u4F7F\u7528 Gpu",name:["gpus","enable"]})}),(0,e.jsx)(He.Z,{span:20,children:(0,e.jsx)(N.Z,{name:["gpus"],children:function(v){var D=v.gpus;if(D&&D.enable)return(0,e.jsx)(ce.Z,{mode:"tags",label:"\u8BBE\u5907\u5217\u8868",name:["gpus","device"],placeholder:"\u914D\u7F6E\u4F7F\u7528\u8BBE\u5907id\u6216\u662Fuuid\uFF0C\u4E0D\u586B\u6240\u4E3A\u6240\u6709\u8BBE\u5907"})}})})]}),(0,e.jsx)(N.Z,{name:["gpus"],children:function(v){var D=v.gpus;if(D&&D.enable)return(0,e.jsx)(ce.Z,{label:"\u8BA1\u7B97\u80FD\u529B",name:["gpus","capabilities"],mode:"multiple",fieldProps:{allowClear:!0},options:[{label:"compute - \u8BA1\u7B97\u80FD\u529B",value:"compute"},{label:"compat32 - \u517C\u5BB932\u4F4D",value:"compat32"},{label:"graphics - \u56FE\u5F62\u5904\u7406\u80FD\u529B",value:"graphics"},{label:"utility - \u76D1\u63A7\u548C\u7BA1\u7406\u80FD\u529B",value:"utility"},{label:"video - \u89C6\u9891\u5904\u7406\u80FD\u529B",value:"video"},{label:"display - \u663E\u793A\u56FE\u5F62\u754C\u9762\u80FD\u529B",value:"display"}]})}})]})}function en(){return(0,e.jsx)(F.Z,{title:"\u5BB9\u5668\u6807\u7B7E",children:(0,e.jsx)(x.u,{name:"label",label:"",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(d.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(d.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var nn=n(44771),tn=n(86615),Bn="default",Fn="user";function un(c){return(0,e.jsx)(R.Z,{label:c.label,tooltip:c.tooltip,children:(0,e.jsxs)(w.Z.Compact,{block:!0,children:[(0,e.jsx)(tn.Z.Group,{radioType:"button",name:[c.name,"useDefault"],options:[{label:"\u4F7F\u7528\u9ED8\u8BA4",value:!0},{label:"\u81EA\u5B9A\u4E49",value:!1}]}),(0,e.jsx)(N.Z,{name:[c.name],children:function(A){return A[c.name]&&A[c.name].useDefault?(0,e.jsx)(d.Z,{name:[c.name,"default"],disabled:!0,placeholder:"\u672A\u8BBE\u7F6E"}):(0,e.jsx)(d.Z,{name:[c.name,"value"]})}})]})})}var Te=un,Se=n(24963);function an(){var c=(0,t.useContext)(Se.Z),V=c.message,A=c.lang;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(F.Z,{children:[(0,e.jsx)(nn.Z,{label:"\u91CD\u542F\u7B56\u7565"}),(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(Ee.Z,{fieldProps:{onChange:function(p){p&&V.warning(A("app.create.privilegedNotice"))}},name:"privileged",tooltip:"--privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(Ee.Z,{name:"autoRemove",tooltip:"--rm",label:"\u505C\u6B62\u540E\u81EA\u52A8\u5220\u9664",initialValue:!1}),(0,e.jsx)(Ee.Z,{fieldProps:{onChange:function(p){p&&V.warning(A("app.create.hostPidNotice"))}},tooltip:"--pid host",name:"hostPid",label:"\u5173\u8054\u5BBF\u4E3B\u673APid",initialValue:!1})]}),(0,e.jsx)(Te,{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55",name:"workDir"}),(0,e.jsx)(Te,{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237",name:"user"}),(0,e.jsx)(Te,{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command"}),(0,e.jsx)(Te,{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4",name:"entrypoint"})]})})}var rn=n(91845),$e=n(62597),Ge=n(82346),ln=n(46442),on=(0,t.forwardRef)(function(c,V){var A=(0,t.useRef)(),U=(0,t.useRef)();(0,t.useImperativeHandle)(V,function(){return{}});var p=function(s){var v,D,O=!1,m=(v=(D=A.current)===null||D===void 0?void 0:D.getList())!==null&&v!==void 0?v:[];if(m.map(function(C){C.name==s.name&&(O=!0)}),!O){var o;(o=A.current)===null||o===void 0||o.add(s)}};return(0,e.jsxs)(F.Z,{title:"\u5173\u8054\u7F51\u7EDC",headerBordered:!0,extra:(0,e.jsx)(w.Z,{children:c.showUseBridgeNetwork&&(0,e.jsx)(Ee.Z,{name:"useBridgeNetwork",fieldProps:{checkedChildren:"\u5173\u8054 Bridge \u7F51\u7EDC",unCheckedChildren:"\u5173\u8054 Bridge \u7F51\u7EDC"}},"useBridgeNetwork")}),children:[(0,e.jsx)(x.u,{name:"network",actionRef:A,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u7F51\u7EDC"},actionGuard:{beforeAddRow:function(s,v){var D;return(D=U.current)===null||D===void 0||D.show(),!1}},copyIconProps:!1,min:0,itemRender:function(s,v){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(d.Z,{label:"\u7F51\u7EDC\u540D\u79F0",name:"name",width:"md",disabled:!0,fieldProps:{value:v.record.name}}),(0,e.jsx)(R.Z,{label:"\u8BBF\u95EEHostname",name:"alise",children:v.record.alise!=""&&(0,e.jsx)(ne.Z.Text,{code:!0,copyable:!0,children:v.record.alise})}),(0,e.jsx)(R.Z,{label:" ",children:s.action})]}),(0,e.jsx)(b.UW,{children:(0,e.jsx)(d.Z,{label:"\u6307\u5B9AIpV4",name:"ipV4",width:"md",disabled:v.record.name=="bridge",fieldProps:{addonAfter:v.record.subnet}})})]})}}),(0,e.jsx)(ln.Z,{ref:U,onSelect:function(s){p({name:s.Name,alise:[""],subnet:s.IPAM.Config[0].Subnet})}})]})}),sn=on,dn=(0,t.forwardRef)(function(c,V){var A=(0,t.useState)(""),U=P()(A,2),p=U[0],I=U[1],s=(0,t.useRef)(),v=(0,t.useContext)(z.Z),D=v.createFormRef;return(0,t.useImperativeHandle)(V,function(){return{setExposePort:function(m){if(m){var o,C,i=(o=(C=s.current)===null||C===void 0?void 0:C.getList())!==null&&o!==void 0?o:[];Object.keys(m).map(function(_){var l=!1;if(i.map(function(H){H.dest==_&&(l=!0)}),!l){var h;(h=s.current)===null||h===void 0||h.add({host:"",dest:_})}})}},setHostname:function(m){I(m)},addPortItem:function(m,o){var C,i=(C=s.current)===null||C===void 0?void 0:C.getList(),_=!1;if(i==null||i.map(function(h){if(h.host==m){_=!0;return}}),!_){var l;(l=s.current)===null||l===void 0||l.add({host:String(m),dest:String(o)})}}}}),(0,e.jsx)(F.Z,{title:"\u7ED1\u5B9A\u7AEF\u53E3",tooltip:"\u8BBF\u95EE\u7AEF\u53E3\u7559\u7A7A\u65F6\u968F\u673A\u751F\u6210\u7AEF\u53E3\uFF0C\u5168\u90E8\u5220\u9664\u5219\u8868\u793A\u4E0D\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,extra:(0,e.jsxs)(w.Z,{children:[c.showBindHost&&(0,e.jsx)(Ee.Z,{name:"useHostNetwork",fieldProps:{checkedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",unCheckedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",onChange:function(m){if(m){var o;(o=D.current)===null||o===void 0||o.setFieldsValue({bindIpV6:!1,publishAllPorts:!1})}}}}),c.showBindIpV6&&(0,e.jsx)(N.Z,{name:["siteName","useHostNetwork"],children:function(m){var o=m.useHostNetwork;return(0,e.jsx)(Ee.Z,{name:"publishAllPorts",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3",unCheckedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3"},disabled:o},"publishAllPorts")}}),c.showBindIpV6&&(0,e.jsx)(N.Z,{name:["siteName","useHostNetwork"],children:function(m){var o=m.useHostNetwork;return(0,e.jsx)(Ee.Z,{name:"bindIpV6",fieldProps:{checkedChildren:"IpV6",unCheckedChildren:"IpV6"},disabled:o},"bindIpV6")}})]}),children:(0,e.jsx)(N.Z,{name:["useHostNetwork","bindIpV6","publishAllPorts"],children:function(m){var o=m.useHostNetwork,C=m.bindIpV6,i=m.publishAllPorts;if(!o&&!i)return(0,e.jsx)(x.u,{name:"ports",actionRef:s,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(d.Z,{width:c.showInDrawer?"sm":"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u6DFB\u52A0\u8BBF\u95EE\u7AEF\u53E3\u6216\u662F\u521B\u5EFA\u5B8C\u6210\u540E\u5BF9\u5BB9\u5668\u7ED1\u5B9A\u57DF\u540D",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3\uFF0C\u7ED1\u5B9AIpV6\u5FC5\u586B",required:C,rules:[{required:C}]}),(0,e.jsx)(d.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:c.showInDrawer?"sm":"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3",required:!0,rules:[{required:!0}]})]})})}})})}),cn=dn,Pe=n(52255);function mn(){var c=(0,t.useRef)(),V=function(p){var I,s,v=!1,D=(I=(s=c.current)===null||s===void 0?void 0:s.getList())!==null&&I!==void 0?I:[];if(D.map(function(m){m.name==p.name&&(v=!0)}),!v){var O;(O=c.current)===null||O===void 0||O.add(p)}},A=function(p){var I,s,v=!1,D=(I=(s=c.current)===null||s===void 0?void 0:s.getList())!==null&&I!==void 0?I:[];D.map(function(O,m){if(O.name==p){var o;(o=c.current)===null||o===void 0||o.remove(m)}})};return(0,e.jsx)(F.Z,{title:"\u5173\u8054\u5BBF\u4E3B\u673A\u7F51\u7EDC\u5185\u4E3B\u673A",tooltip:"\u5BB9\u5668\u5185\u5982\u679C\u9700\u8981\u8BF7\u6C42\u5BBF\u4E3B\u673A\u6240\u5728\u7684\u7F51\u7EDC\u4E2D\u7684\u4E3B\u673A\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6B64\u914D\u7F6E\u5C06Ip\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D",extra:(0,e.jsx)(w.Z,{children:(0,e.jsx)(Ee.Z,{name:"enableBindHost",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",unCheckedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",onChange:function(p){p?V({name:"host.dpanel.local",value:"host-gateway"}):A("host.dpanel.local")}}})}),children:(0,e.jsx)(x.u,{name:"extraHosts",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BBF\u4E3B\u673A\u7F51\u7EDC\u5173\u8054"},actionRef:c,copyIconProps:!1,min:0,children:(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(d.Z,{width:"md",name:"name",label:"Hostname",placeholder:""}),(0,e.jsx)(d.Z,{width:"md",name:"value",label:"ip",placeholder:""})]})})})}var Ue=n(90672),vn=(0,t.forwardRef)(function(c,V){return(0,t.useImperativeHandle)(V,function(){return{}}),(0,e.jsxs)(F.Z,{title:"\u7F51\u7EDC\u914D\u7F6E",children:[(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(d.Z,{label:"\u914D\u7F6E ipV4 \u5730\u5740",name:["ipV4","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u5730\u5740\uFF0C\u4F8B\u5982 192.168.1.5",placeholder:"192.168.1.5"}),(0,e.jsx)(N.Z,{name:["ipV4"],children:function(U){var p=U.ipV4;return(0,e.jsx)(d.Z,{label:"\u914D\u7F6E ipV4 \u5B50\u7F51",name:["ipV4","subnet"],width:"md",required:p&&p.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 192.168.1.0/24",placeholder:"192.168.1.0/24",rules:[{required:p&&p.address}]})}}),(0,e.jsx)(d.Z,{label:"\u914D\u7F6E ipV4 \u7F51\u5173",name:["ipV4","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 192.168.1.1",placeholder:"192.168.1.1"}),(0,e.jsx)(Ee.Z,{label:"\u81EA\u5B9A\u4E49ipV6",name:"enableIpV6Address"})]}),(0,e.jsx)(N.Z,{name:["enableIpV6Address"],children:function(U){var p=U.enableIpV6Address;if(p)return(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(d.Z,{label:"\u914D\u7F6E ipV6 \u5730\u5740",name:["ipV6","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u5730\u5740\uFF0C\u4F8B\u5982 2001:db8::5",placeholder:"2001:db8::5"}),(0,e.jsx)(N.Z,{name:["ipV6"],children:function(s){var v=s.ipV6;return(0,e.jsx)(d.Z,{label:"\u914D\u7F6E ipV6 \u5B50\u7F51",name:["ipV6","subnet"],width:"md",required:v&&v.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 2001:db8::/48",placeholder:"2001:db8::/48",rules:[{required:v&&v.address}]})}}),(0,e.jsx)(d.Z,{label:"\u914D\u7F6E ipV6 \u7F51\u5173",name:["ipV6","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 2001:db8::1",placeholder:"2001:db8::1"})]})}}),(0,e.jsx)(Ue.Z,{label:"DNS\u914D\u7F6E",name:"dns",placeholder:"\u8BF7\u6307\u5B9Adns\u5730\u5740\uFF0C\u4F8B\u5982\uFF1A8.8.8.8\uFF0C\u4E00\u884C\u6DFB\u4E00\u6761dns\u5730\u5740"})]})}),fn=vn,Ne=n(31199),hn=n(86250);function _n(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.Z,{title:"\u9644\u52A0\u6267\u884C\u811A\u672C",headerBordered:!0,subTitle:"",children:(0,e.jsx)(Ue.Z,{label:"\u5BB9\u5668\u521B\u5EFA\u540E\u6267\u884C\u811A\u672C",name:["hook","containerCreate"],placeholder:"\u5BB9\u5668\u5728\u521B\u5EFA\u540E\u6267\u884C\u7684\u811A\u672C\uFF0C\u6B64\u811A\u672C\u5E76\u4E0D\u4F1A\u5F71\u54CD entrypoint \u53CA command\u3002\u4F8B\u5982\uFF1Als -al && touch abc.txt && apt update"})}),(0,e.jsxs)(F.Z,{title:"\u5065\u5EB7\u68C0\u67E5",headerBordered:!0,children:[(0,e.jsxs)(hn.Z,{gap:20,justify:"start",children:[(0,e.jsx)(Ne.Z,{label:"\u91CD\u590D\u95F4\u9694\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","interval"],initialValue:30}),(0,e.jsx)(Ne.Z,{label:"\u8D85\u65F6\u5931\u8D25\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","timeout"],initialValue:10}),(0,e.jsx)(Ne.Z,{label:"\u5931\u8D25\u91CD\u590D\u6B21\u6570",name:["healthcheck","retries"],initialValue:3}),(0,e.jsx)(ce.Z,{width:"sm",label:"\u811A\u672C\u6267\u884C\u73AF\u5883",initialValue:"CMD",name:["healthcheck","shellType"],valueEnum:{CMD:"\u5728 Docker \u73AF\u5883\u6267\u884C","CMD-SHELL":"\u5728\u5BB9\u5668\u5185\u6267\u884C"}})]}),(0,e.jsx)(Ue.Z,{label:"\u6267\u884C\u811A\u672C",name:["healthcheck","cmd"],placeholder:"\u914D\u7F6E\u5BB9\u5668\u5065\u5EB7\u68C0\u67E5\u811A\u672C\uFF0C\u4F8B\u5982\uFF1Acurl -f http://localhost:8080/ || exit 1"})]})]})}var En=n(74763),Ye=n(2487),pn=[{name:"ALL"},{name:"AUDIT_CONTROL"},{name:"AUDIT_WRITE",default:!0},{name:"BLOCK_SUSPEND"},{name:"CHOWN",default:!0},{name:"DAC_OVERRIDE",default:!0},{name:"DAC_READ_SEARCH"},{name:"FOWNER",default:!0},{name:"FSETID",default:!0},{name:"IPC_LOCK"},{name:"IPC_OWNER"},{name:"KILL",default:!0},{name:"LEASE"},{name:"LINUX_IMMUTABLE"},{name:"MAC_ADMIN"},{name:"MAC_OVERRIDE"},{name:"MKNOD",default:!0},{name:"NET_ADMIN"},{name:"NET_BIND_SERVICE",default:!0},{name:"NET_BROADCAST"},{name:"NET_RAW",default:!0},{name:"SETFCAP",default:!0},{name:"SETGID",default:!0},{name:"SETPCAP",default:!0},{name:"SETUID",default:!0},{name:"SYSLOG"},{name:"SYS_ADMIN"},{name:"SYS_BOOT"},{name:"SYS_CHROOT",default:!0},{name:"SYS_MODULE"},{name:"SYS_NICE"},{name:"SYS_PACCT"},{name:"SYS_PTRACE"},{name:"SYS_RAWIO"},{name:"SYS_RESOURCE"},{name:"SYS_TIME"},{name:"SYS_TTY_CONFIG"}],Cn=(0,t.forwardRef)(function(c,V){var A=(0,t.useContext)(Se.Z),U=A.lang,p=(0,t.useState)(null),I=P()(p,2),s=I[0],v=I[1],D=(0,t.useContext)(z.Z),O=D.createFormRef;return(0,t.useImperativeHandle)(V,function(){return{}}),(0,e.jsx)(F.Z,{children:(0,e.jsx)(Ye.Z,{grid:{gutter:10,xs:3,sm:3,md:4,lg:4,xl:4,xxl:6},dataSource:pn,renderItem:function(o,C){var i;return(0,e.jsx)(Ye.Z.Item,{children:(0,e.jsx)(Ee.Z,{fieldProps:{onChange:function(l){o.name=="ALL"&&v(l)}},disabled:o.name!="ALL"&&((0,En.k)(s)?(i=O.current)===null||i===void 0?void 0:i.getFieldValue(["capAdd","ALL"]):s),initialValue:o.default,name:["capAdd",o.name],tooltip:U("app.create.cap."+o.name.toLocaleLowerCase()),label:o.name})},C)}})})}),gn=Cn;function jn(){var c,V,A=(0,t.useContext)(Se.Z),U=A.loading,p=A.notice,I=(0,t.useContext)(z.Z),s=I.createFormRef,v=I.volumeListRef,D=I.domainRef,O=I.createEnvRef,m=I.createLinkRef,o=(0,Ge.useSearchParams)(),C=P()(o,2),i=C[0],_=C[1],l=(0,Ge.useNavigate)(),h=(0,t.useState)("basic"),H=P()(h,2),Z=H[0],W=H[1],ie=(c=i.get("containerId"))!==null&&c!==void 0?c:"",Be=(V=i.get("imageId"))!==null&&V!==void 0?V:"";return(0,t.useEffect)(function(){if(ie)U.show(),(0,$e.iE)({md5:ie}).then(function(){var a=j()(f()().mark(function X(u){var fe,Fe,oe,K,De,me,Me,We,ke;return f()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(K={info:{}},!u.data.env.imageName){pe.next=11;break}return pe.prev=2,pe.next=5,(0,se.YU)({md5:u.data.env.imageName});case 5:De=pe.sent,K=De.data,pe.next=11;break;case 9:pe.prev=9,pe.t0=pe.catch(2);case 11:u.data.env.network&&u.data.env.network.map(function($){return!$.alise&&$.name!="bridge"&&($.alise=[u.data.siteName+".pod.dpanel.local"]),$}),u.data.env.ports&&u.data.env.ports.map(function($){return $.host=="0"&&($.host=""),$}),me=u.data.env.bindIpV6,u.data.containerInfo.Info&&u.data.containerInfo.Info.NetworkSettings.Networks&&Object.keys(u.data.containerInfo.Info.NetworkSettings.Networks).map(function($){if(u.data.env.network&&(u.data.env.network=u.data.env.network.map(function(Ve){return $==Ve.name&&(Ve.subnet=u.data.containerInfo.Info.NetworkSettings.Networks[$].IPAddress+"/"+u.data.containerInfo.Info.NetworkSettings.Networks[$].IPPrefixLen),Ve})),u.data.containerInfo.Info.NetworkSettings.Networks[$].IPv6Gateway!=""&&(me=!0),$=="bridge"){var Ae;(Ae=s.current)===null||Ae===void 0||Ae.setFieldValue("useBridgeNetwork",!0)}}),u.data.env.extraHosts&&u.data.env.extraHosts.map(function($){if($.value=="host-gateway"){var Ae;(Ae=s.current)===null||Ae===void 0||Ae.setFieldValue("enableBindHost",!0)}}),Me=u.data.env.ports,u.data.env.ports&&(Me=u.data.env.ports.map(function($){return $.host=($.hostIp?$.hostIp+":":"")+$.host,$})),(fe=s.current)===null||fe===void 0||fe.setFieldsValue({siteTitle:u.data.siteTitle,siteName:u.data.siteName,imageName:u.data.env.imageName,privileged:u.data.env.privileged,bindIpV6:u.data.env.useHostNetwork?!1:me,useHostNetwork:u.data.env.useHostNetwork,publishAllPorts:u.data.env.useHostNetwork?!1:u.data.env.publishAllPorts,workDir:{value:u.data.env.workDir,useDefault:!u.data.env.workDir,default:K&&K.info.Config&&K.info.Config.WorkingDir},user:{value:u.data.env.user,useDefault:!u.data.env.user,default:K&&K.info.Config&&K.info.Config.User},command:{value:u.data.env.command,useDefault:!u.data.env.command,default:K&&K.info.Config&&K.info.Config.Cmd&&K.info.Config.Cmd.join(" ")},entrypoint:{value:u.data.env.entrypoint,useDefault:!u.data.env.entrypoint,default:K&&K.info.Config&&K.info.Config.Entrypoint&&K.info.Config.Entrypoint.join(" ")},shmsize:(Fe=u.data.env.shmsize)!==null&&Fe!==void 0?Fe:"64M",cpus:u.data.env.cpus,memory:u.data.env.memory,environment:u.data.env.environment,label:u.data.env.label,volumes:u.data.env.volumes,ports:Me,links:u.data.env.links,network:u.data.env.network,restart:u.data.env.restart,extraHosts:u.data.env.extraHosts,autoRemove:u.data.env.autoRemove,log:u.data.env.log,dns:u.data.env.dns&&u.data.env.dns.join(`
`),ipV4:u.data.env.ipV4,ipV6:u.data.env.ipV6,gpus:u.data.env.gpus,device:u.data.env.device,hook:u.data.env.hook,hostPid:u.data.env.hostPid,capAdd:u.data.env.capAdd&&Object.fromEntries(u.data.env.capAdd.map(function($){return[$,!0]}))}),u.data.env.ipV6&&((We=s.current)===null||We===void 0||We.setFieldValue("enableIpV6Address",!0)),u.data.env.healthcheck&&u.data.env.healthcheck.cmd&&u.data.env.healthcheck.cmd!=""&&((ke=s.current)===null||ke===void 0||ke.setFieldsValue({healthcheck:u.data.env.healthcheck})),(oe=v.current)===null||oe===void 0||oe.initImageRootfs(u.data.env.imageName);case 22:case"end":return pe.stop()}},X,null,[[2,9]])}));return function(X){return a.apply(this,arguments)}}()).finally(function(){U.destroy()});else{var G,L;(G=s.current)===null||G===void 0||G.resetFields(),(L=s.current)===null||L===void 0||L.setFieldValue("useBridgeNetwork",!0)}},[i]),(0,e.jsx)(B._z,{children:(0,e.jsx)(F.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(E.A,{submitter:{render:function(L,a){return(0,e.jsx)(J.S,{children:a})}},formRef:s,onFinish:function(){var G=j()(f()().mark(function L(a){var X,u,fe,Fe,oe,K;return f()().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(K={siteTitle:a.siteTitle,siteName:a.siteName,hostname:a.hostname,imageName:a.imageName,environment:a.environment,links:a.links,ports:a.ports,volumes:a.volumes,network:(X=a.network)!==null&&X!==void 0?X:[],privileged:(u=a.privileged)!==null&&u!==void 0?u:!1,autoRemove:(fe=a.autoRemove)!==null&&fe!==void 0?fe:!1,restart:a.restart,cpus:a.cpus,memory:a.memory,shmsize:(Fe=a.shmsize)!==null&&Fe!==void 0?Fe:0,workDir:a.workDir&&!a.workDir.useDefault?a.workDir.value:"",user:a.user&&!a.user.useDefault?a.user.value:"",command:a.command&&!a.command.useDefault?a.command.value:"",entrypoint:a.entrypoint&&!a.entrypoint.useDefault?a.entrypoint.value:"",useHostNetwork:a.useHostNetwork,bindIpV6:a.bindIpV6,log:a.log,dns:a.dns&&a.dns!=""?a.dns.split(`
`):[],label:a.label,publishAllPorts:a.publishAllPorts,extraHosts:a.extraHosts,ipV4:a.ipV4,ipV6:a.ipV6,device:a.device,gpus:a.gpus,hook:a.hook,hostPid:a.hostPid,capAdd:a.capAdd?Object.keys(a.capAdd).map(function(Me){return Me}):[],useBridgeNetwork:(oe=a.useBridgeNetwork)!==null&&oe!==void 0?oe:!0},!(!a.useBridgeNetwork&&!a.useHostNetwork&&(!a.network||a.network.length==0))){me.next=4;break}return p.error("\u4E0D\u52A0\u5165 Bridge \u7F51\u7EDC\u65F6\uFF0C\u5FC5\u987B\u6307\u5B9A\u4E00\u4E2A\u81EA\u5B9A\u4E49\u7F51\u7EDC"),me.abrupt("return",!1);case 4:return a.useBridgeNetwork&&K.network.push({name:"bridge",alise:[],ipV4:""}),a.healthcheck&&a.healthcheck.cmd&&a.healthcheck.cmd!=""&&(K.healthcheck=a.healthcheck),ie&&(K.containerId=ie),me.next=9,(0,$e.$G)(K);case 9:return l("/app/list"),me.abrupt("return",!0);case 11:case"end":return me.stop()}},L)}));return function(L){return G.apply(this,arguments)}}(),children:[(0,e.jsxs)(F.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(d.Z,{name:"siteTitle",label:"\u5BB9\u5668\u63CF\u8FF0",fieldProps:{onChange:function(L){var a="";if(L.target.value&&!ie){var X,u=(0,rn.N9)(L.target.value.trim(),{toneType:"none",type:"array"});a=u.join(""),(X=s.current)===null||X===void 0||X.setFieldValue("siteName",a)}}},placeholder:"\u8BF7\u8F93\u5165\u5BB9\u5668\u63CF\u8FF0\u540D\u79F0"}),(0,e.jsxs)(b.UW,{children:[(0,e.jsx)(d.Z,{width:"lg",name:"siteName",label:"\u5BB9\u5668\u6807\u8BC6",tooltip:"\u5BB9\u5668\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u5BB9\u5668\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:!!ie,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u5BB9\u5668\u6807\u8BC6\u540D\u79F0"}),(0,e.jsx)(d.Z,{label:"Hostname",name:"hostname",width:"md"})]}),(0,e.jsx)(Oe,{redeploy:!!ie,fromImageId:Be})]}),(0,e.jsx)(g.Z,{offsetTop:50,children:(0,e.jsx)(F.Z,{style:{marginBottom:-20},children:(0,e.jsx)(ee.Z,{activeKey:Z,onChange:function(L){W(L),window.scrollTo(0,450)},items:[{label:"\u57FA\u672C\u914D\u7F6E",key:"basic"},{label:"\u5173\u8054\u914D\u7F6E",key:"link"},{label:"\u8FD0\u884C\u914D\u7F6E",key:"run-command"},{label:"\u8D44\u6E90\u914D\u7F6E",key:"resource"},{label:"Hook",key:"hook"},{label:"\u80FD\u529B\u914D\u7F6E",key:"cap"},{label:"\u5176\u5B83",key:"other"}]})})}),(0,e.jsxs)(Pe.Z,{show:Z=="basic",children:[(0,e.jsx)(cn,{ref:D,showBindHost:!0,showBindIpV6:!0}),(0,e.jsx)(ve.Z,{showAddButton:!0,showImportButton:!0,showCodeMode:!0,label:"\u73AF\u5883\u53D8\u91CF",ref:O}),(0,e.jsx)(ze,{showDefault:!0,ref:v}),(0,e.jsx)(N.Z,{name:["siteName","useHostNetwork"],children:function(L){var a=L.siteName,X=L.useHostNetwork;if(!X)return(0,e.jsx)(fn,{})}})]}),(0,e.jsx)(Pe.Z,{show:Z=="link",children:(0,e.jsx)(N.Z,{name:["siteName","useHostNetwork"],children:function(L){var a=L.siteName,X=L.useHostNetwork;return X?(0,e.jsx)(r.Z,{showIcon:!0,description:"\u7ED1\u5B9A\u5230\u5BBF\u4E3B\u673A\u7F51\u7EDC\u65F6\uFF0C\u65E0\u6CD5\u901A\u8FC7 Docker \u5173\u8054\u5176\u5B83\u5BB9\u5668\u3002\u8BF7\u4F7F\u7528\u5BBF\u4E3B\u673A\u5185\u7F51IP\u6216\u662F127.0.0.1\u4E92\u8054\u5BB9\u5668\u66B4\u9732\u7AEF\u53E3\u3002"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(_e,{onAddEnv:function(fe,Fe){var oe;(oe=O.current)===null||oe===void 0||oe.addEnvItem(fe,Fe)},ref:m}),(0,e.jsx)(sn,{showUseBridgeNetwork:!0,siteName:a}),(0,e.jsx)(mn,{})]})}})}),(0,e.jsx)(Pe.Z,{show:Z=="run-command",children:(0,e.jsx)(an,{})}),(0,e.jsx)(Pe.Z,{show:Z=="resource",children:(0,e.jsx)(qe,{})}),(0,e.jsx)(Pe.Z,{show:Z=="hook",children:(0,e.jsx)(_n,{})}),(0,e.jsx)(Pe.Z,{show:Z=="other",children:(0,e.jsx)(en,{})}),(0,e.jsx)(Pe.Z,{show:Z=="cap",children:(0,e.jsx)(gn,{})})]},"form")})})}},2831:function(Ce,Y,n){n.d(Y,{Ll:function(){return J},aF:function(){return P},d6:function(){return b},u5:function(){return F}});var q=n(15009),f=n.n(q),te=n(99289),j=n.n(te),k=n(82346);function P(){return B.apply(this,arguments)}function B(){return B=j()(f()().mark(function g(){return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,k.request)("/api/common/home/info",{method:"POST"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},g)})),B.apply(this,arguments)}function F(){return E.apply(this,arguments)}function E(){return E=j()(f()().mark(function g(){return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,k.request)("/api/common/home/check-new-version",{method:"POST"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},g)})),E.apply(this,arguments)}function J(){return d.apply(this,arguments)}function d(){return d=j()(f()().mark(function g(){return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,k.request)("/api/common/home/usage",{method:"POST"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},g)})),d.apply(this,arguments)}function b(){return N.apply(this,arguments)}function N(){return N=j()(f()().mark(function g(){return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,k.request)("/api/common/home/upgrade-script",{method:"POST"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},g)})),N.apply(this,arguments)}},79245:function(Ce,Y,n){n.d(Y,{m:function(){return te},y:function(){return j}});var q=n(64599),f=n.n(q);function te(k){var P=[];if(!k||k=="")return P;var B=k.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),F=f()(B),E;try{for(F.s();!(E=F.n()).done;){var J=E.value;P.push({name:J[1],value:J[2]?J[2].indexOf("-")==0?J[2].substring(1):J[2]:""})}}catch(d){F.e(d)}finally{F.f()}return P}function j(k,P){return!k||!P?!1:(k&P)!==0}}}]);
