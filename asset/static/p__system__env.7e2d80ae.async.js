"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{1699:function(X,x,e){e.d(x,{u:function(){return b}});var F=e(9783),h=e.n(F),$=e(97857),U=e.n($),V=e(67294),B=e(82346),A=e(40411),f=e(42075),s=e(85893),b=function(i){var n=(0,B.useAccess)(),d=Array.isArray(i.access)?i.access:[i.access],a,u=i.fallback;if(typeof i.children=="function"?(a=i.children(d.reduce(function(_,K){return U()(U()({},_),{},h()({},K,n[K]))},{})),a||(a=u)):d.every(function(_){return n[_]})?a=i.children:a=u,!u&&a&&i.showProTips&&n.canSeeEnableCe){if(n.canSeeEnableHiddenProTips)return null;a=(0,s.jsx)(A.Z,{offset:i.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:a})}if(!u&&a&&i.showProRibbonTips&&n.canSeeEnableCe){if(n.canSeeEnableHiddenProTips)return null;a=(0,s.jsx)(A.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:a})}return i.space?(0,s.jsx)(f.Z,U()(U()({},i.space),{},{children:a})):a}},80821:function(X,x,e){e.d(x,{Z:function(){return i}});var F=e(97857),h=e.n(F),$=e(5574),U=e.n($),V=e(24963),B=e(36146),A=e(86738),f=e(83062),s=e(28036),b=e(67294),t=e(85893);function i(n){var d=(0,b.useState)(!1),a=U()(d,2),u=a[0],_=a[1],K=(0,b.useContext)(V.Z),p=K.message,g=new B.Uo,N=function(){_(!0);var z=n.action();z instanceof Promise?z.then(function(R){if(_(!1),R){typeof n.onSuccess=="function"&&n.onSuccess(R);var L="";n.messageSuccess?typeof n.messageSuccess=="function"?L=n.messageSuccess(R):L=n.messageSuccess.indexOf("notification.")==0?g.format(n.messageSuccess):n.messageSuccess:L=g.format("notification.finish"),n.asynced?p.info(L):p.success(L)}}).catch(function(R){_(!1),typeof n.onError=="function"&&n.onError(R)}):_(!1)};return n.confirm?(0,t.jsx)(A.Z,h()(h()({style:{width:500},title:n.confirmTitle?n.confirmTitle:g.format("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?g.format(n.confirm):n.confirm,onConfirm:N,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,t.jsx)(f.Z,{title:n.tips,children:(0,t.jsx)(s.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&u?void 0:n.icon,loading:u,danger:n.danger,type:n.type,children:n.children})})})):(0,t.jsx)(f.Z,{title:n.tips,children:(0,t.jsx)(s.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&u?void 0:n.icon,loading:u,onClick:N,danger:n.danger,type:n.type,children:n.children})})}},44349:function(X,x,e){var F=e(97857),h=e.n(F),$=e(17186),U=e(5966),V=e(86250),B=e(67294),A=e(85893),f=(0,B.forwardRef)(function(s,b){var t=(0,B.useRef)();(0,B.useImperativeHandle)(b,function(){return{addItem:function(d,a){var u,_=(u=t.current)===null||u===void 0?void 0:u.getList(),K=!1;if(_==null||_.map(function(g){if(g.name==d){K=!0;return}}),!K){var p;(p=t.current)===null||p===void 0||p.add({name:d,value:a})}},clear:function(){var d;(d=t.current)===null||d===void 0||(d=d.getList())===null||d===void 0||d.map(function(a,u){var _;(_=t.current)===null||_===void 0||_.remove(u)})}}});var i={};return s.hideCopyButton===!0&&(i.copyIconProps=!1),s.hideDeleteButton===!0&&(i.deleteIconProps=!1),(0,A.jsx)($.u,h()(h()({initialValue:s.initialValue,label:s.label,name:s.name,actionRef:t,creatorButtonProps:s.showAddButton?{creatorButtonText:s.label?s.label:s.name}:!1,min:s.min?s.min:0},i),{},{children:function(d,a,u){return(0,A.jsx)(V.Z,{justify:s.justify,gap:s.gap,children:s.items.map(function(_){return _.render?(0,A.jsx)("div",{children:_.render&&_.render(d,a,u)},"".concat(s.name,"-").concat(_.name,"-").concat(d.key)):(0,A.jsx)(U.Z,{width:_.width,name:_.name,label:_.label,required:_.required,rules:[{required:_.required}],disabled:_.disabled,placeholder:_.placeholder},"".concat(s.name,"-").concat(_.name,"-").concat(d.key))})})}}))});x.Z=f},36435:function(X,x,e){var F=e(15009),h=e.n(F),$=e(64599),U=e.n($),V=e(99289),B=e.n(V),A=e(9783),f=e.n(A),s=e(5574),b=e.n(s),t=e(67294),i=e(184),n=e(38345),d=e(97269),a=e(97321),u=e(97462),_=e(64317),K=e(5966),p=e(86615),g=e(68602),N=e(28036),r=e(83403),z=e(24963),R=e(1699),L=e(29177),H=e(1883),ee=e(43425),ne=e(44349),_e=e(3616),J=e(36146),v=e(85893),w=(0,t.forwardRef)(function(y,Q){var q=(0,t.useState)(!1),k=b()(q,2),I=k[0],O=k[1],D=(0,t.useRef)(),T=(0,t.useContext)(z.Z),G=T.message,l=(0,t.useState)([]),W=b()(l,2),Y=W[0],te=W[1],C=new J.Uo("components.permissionButton"),ae=f()(f()(f()(f()(f()({},r.W6.CONTAINER,"Id"),r.W6.APPSTORE,"name"),r.W6.COMPOSE,"name"),r.W6.REGISTRY,"serverAddress"),r.W6.DOCKER_ENV,"name"),le=f()(f()(f()(f()(f()({},r.W6.CONTAINER,"name"),r.W6.APPSTORE,"name"),r.W6.COMPOSE,"name"),r.W6.REGISTRY,"title"),r.W6.DOCKER_ENV,"title"),se=ae[y.type],oe=le[y.type],ie=y.selected.map(function(c){return c[ae[y.type]]});return t.useEffect(function(){if(I){if(!y.selected||y.selected.length==0){G.error(J.FD.format("message.noDataSelect")),O(!1);return}(0,g.dP)({permission:{uri:y.type,key:se,value:ie}}).then(function(c){var o;(o=D.current)===null||o===void 0||o.setFieldValue("list",Object.keys(c.data.list).map(function(m){return{name:m,type:c.data.list[m].type,users:c.data.list[m].users}}))}),(0,g.lE)().then(function(c){var o,m=(o=c.data)===null||o===void 0||(o=o.list)===null||o===void 0?void 0:o.map(function(E){return{label:E.username,value:E.username}});te(m)})}},[I]),(0,v.jsx)(R.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,v.jsxs)(i.a,{name:"create",title:C.format("drawerTitle"),open:I,onOpenChange:function(o){if(!o){var m;(m=D.current)===null||m===void 0||m.resetFields()}O(o)},drawerProps:{forceRender:!0,width:_e.R_},formRef:D,trigger:(0,v.jsx)(N.ZP,{icon:(0,v.jsx)(L.Z,{}),children:C.format("drawerTriggerButton")}),onFinish:function(){var c=B()(h()().mark(function o(m){var E,j,P;return h()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:E=U()(m.list),M.prev=1,E.s();case 3:if((j=E.n()).done){M.next=9;break}return P=j.value,M.next=7,(0,g.Db)({usernames:P.users,permissionType:P.type,permission:{uri:y.type,key:se,showKey:oe,value:[P.name]}});case 7:M.next=3;break;case 9:M.next=14;break;case 11:M.prev=11,M.t0=M.catch(1),E.e(M.t0);case 14:return M.prev=14,E.f(),M.finish(14);case 17:G.success(J.FD.format("finish")),O(!1),y.onSuccess();case 20:case"end":return M.stop()}},o,null,[[1,11,14,17]])}));return function(o){return c.apply(this,arguments)}}(),children:[(0,v.jsxs)(n.Z,{ghost:!0,title:(0,v.jsx)(H.Z,{}),subTitle:C.format("batchTitle"),children:[(0,v.jsx)(d.A.Item,{name:"type",style:{marginBottom:0},children:(0,v.jsx)(a.Z.Group,{defaultValue:"admin",onChange:function(o){var m,E,j=(m=D.current)===null||m===void 0?void 0:m.getFieldValue("list");j.forEach(function(P){P.type=o,P.users=[]}),(E=D.current)===null||E===void 0||E.setFieldValue("list",j)},children:["admin","restricted","public"].map(function(c){return(0,v.jsx)(a.Z,{style:{width:240},title:C.format("dataTypeOption.".concat(c)),description:C.format("dataTypeOptionDesc.".concat(c)),value:c},c)})})}),(0,v.jsx)(u.Z,{name:["type"],children:function(o){var m=o.type;if(m==="restricted")return(0,v.jsx)(_.Z,{mode:"multiple",name:"usernames",label:C.format("formUsernames"),onChange:function(j){var P,S,M=(P=D.current)===null||P===void 0?void 0:P.getFieldValue("list");M.forEach(function(Z){Z.users=j}),(S=D.current)===null||S===void 0||S.setFieldValue("list",M)},rules:[{required:!0}],request:B()(h()().mark(function E(){var j,P,S;return h()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!(Y.length>0)){Z.next=2;break}return Z.abrupt("return",Y);case 2:return Z.next=4,(0,g.lE)();case 4:return P=Z.sent,S=(j=P.data)===null||j===void 0||(j=j.list)===null||j===void 0?void 0:j.map(function(re){return{label:re.username,value:re.username}}),te(S),Z.abrupt("return",S);case 8:case"end":return Z.stop()}},E)}))})}})]}),(0,v.jsx)(n.Z,{ghost:!0,title:(0,v.jsx)(ee.Z,{}),subTitle:C.format("dataTitle"),children:(0,v.jsx)(ne.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:C.format("dataName"),render:function(o,m,E){var j=E.getCurrentRowData();return(0,v.jsx)(K.Z,{disabled:!0,label:C.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:C.format("dataType"),render:function(o,m,E){var j=E.getCurrentRowData();return(0,v.jsx)(p.Z.Group,{label:C.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(P){return{label:C.format("dataTypeOption.".concat(P)),value:P}})})}},{name:"users",label:C.format("dataUsers"),render:function(o,m,E){return(0,v.jsx)(u.Z,{name:["type"],children:function(P){var S=P.type;if(S=="restricted")return(0,v.jsx)(_.Z,{width:"sm",mode:"tags",name:"users",label:C.format("dataUsers"),options:Y})}})}}]})})]})})});x.Z=w},64312:function(X,x,e){e.r(x),e.d(x,{default:function(){return z}});var F=e(15009),h=e.n(F),$=e(99289),U=e.n($),V=e(80821),B=e(77273),A=e(36435),f=e(83403),s=e(24963),b=e(87662),t=e(36146),i=e(86548),n=e(90078),d=e(78099),a=e(82346),u=e(28036),_=e(42075),K=e(96074),p=e(25593),g=e(83062),N=e(67294),r=e(85893);function z(){var R=(0,N.useRef)(),L=(0,N.useRef)(),H=(0,a.useModel)("@@initialState"),ee=H.initialState,ne=H.loading,_e=H.error,J=H.refresh,v=H.setInitialState,w=(0,N.useContext)(s.Z),y=w.message,Q=(0,a.useLocation)(),q=(0,a.useNavigate)(),k=new t.Uo("system.env");return(0,N.useEffect)(function(){var I=Q.state;if(I&&I.item){var O;(O=L.current)===null||O===void 0||O.edit(I.item)}},[Q.state]),(0,r.jsx)(n._z,{header:{extra:[(0,r.jsx)(B.Z,{trigger:(0,r.jsx)(u.ZP,{type:"primary",children:k.format("createButton")}),ref:L,onFinish:U()(h()().mark(function I(){var O,D,T;return h()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(T=Q.state,!(T&&T.item)){l.next=6;break}return l.next=4,(0,b.vC)({name:T.item.name});case 4:return q(Q.pathname,{replace:!0,state:null}),l.abrupt("return");case 6:J(),!((O=R.current)===null||O===void 0)&&O.reloadAndRest&&((D=R.current)===null||D===void 0||D.reloadAndRest());case 8:case"end":return l.stop()}},I)}))},"dockerEnvCreate")]},children:(0,r.jsx)(d.Z,{rowKey:"name",columns:[{title:t.FD.format("listName"),dataIndex:"name"},{title:t.FD.format("listTitle"),dataIndex:"title"},{title:t.FD.format("listTargetAddress"),dataIndex:"address"},{title:t.FD.format("listManage"),width:100,search:!1,render:function(O,D,T,G,l){return(0,r.jsx)(_.Z,{split:(0,r.jsx)(K.Z,{type:"vertical"}),children:(0,r.jsx)(p.Z.Link,{onClick:function(){var Y;(Y=L.current)===null||Y===void 0||Y.edit(D)},children:(0,r.jsx)(g.Z,{title:t.FD.format("listManageEdit"),children:(0,r.jsx)(i.Z,{})})},D.name)})}}],pagination:!1,request:U()(h()().mark(function I(){var O;return h()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,b.Kg)();case 2:return O=T.sent,T.abrupt("return",{data:O.data.list,total:O.data.list.length});case 4:case"end":return T.stop()}},I)})),search:!1,rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:R,tableAlertOptionRender:function(O){var D=O.selectedRows,T=O.selectedRowKeys;return(0,r.jsxs)(_.Z,{size:16,children:[(0,r.jsx)(A.Z,{type:f.W6.DOCKER_ENV,selected:D,onSuccess:function(){var l,W;return!((l=R.current)===null||l===void 0)&&l.reloadAndRest&&((W=R.current)===null||W===void 0||W.reloadAndRest()),!0}},"permissionButton"),(0,r.jsx)(V.Z,{danger:!0,type:"primary",action:function(){return D.find(function(l){return l.default})?(y.warning(t.FD.format("systemEnvDefaultCannotDelete")),!1):(0,b._g)({name:T})},onSuccess:function(){var l,W;return!((l=R.current)===null||l===void 0)&&l.reloadAndRest&&((W=R.current)===null||W===void 0||W.reloadAndRest()),!0},onError:function(){var l,W;return!((l=R.current)===null||l===void 0)&&l.reset&&((W=R.current)===null||W===void 0||W.reset()),!0},confirm:"notification.confirm.title",children:t.FD.format("listManageDeleteBatch")})]})}})})}}}]);
