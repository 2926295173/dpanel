"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3763],{91806:function($e,k,n){n.d(k,{Z:function(){return x}});var Q=n(87462),u=n(67294),G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},D=G,ae=n(84089),b=function(Y,J){return u.createElement(ae.Z,(0,Q.Z)({},Y,{ref:J,icon:D}))},H=u.forwardRef(b),x=H},74842:function($e,k,n){n.d(k,{Z:function(){return x}});var Q=n(87462),u=n(67294),G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},D=G,ae=n(84089),b=function(Y,J){return u.createElement(ae.Z,(0,Q.Z)({},Y,{ref:J,icon:D}))},H=u.forwardRef(b),x=H},87784:function($e,k,n){n.d(k,{Z:function(){return x}});var Q=n(87462),u=n(67294),G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},D=G,ae=n(84089),b=function(Y,J){return u.createElement(ae.Z,(0,Q.Z)({},Y,{ref:J,icon:D}))},H=u.forwardRef(b),x=H},75293:function($e,k,n){n.d(k,{Z:function(){return G}});var Q=n(25593),u=n(85893);function G(D){return(0,u.jsx)(Q.Z.Text,{copyable:!0,style:{padding:10,display:D.block?"block":"",background:"#24292f",color:"#ffffff"},children:D.content})}},47900:function($e,k,n){n.r(k),n.d(k,{default:function(){return Pt}});var Q=n(15009),u=n.n(Q),G=n(99289),D=n.n(G),ae=n(5574),b=n.n(ae),H=n(94359),x=n(24494),o=n(36146),Y=n(184),J=n(5966),Me=n(52688),Fe=n(83622),ue=n(86250),h=n(67294),e=n(85893);function He(v){var j=(0,h.useRef)(),i=new o.Uo("swarm");return(0,e.jsxs)(Y.a,{title:i.format("nodeInitTitle"),trigger:(0,e.jsx)(Fe.ZP,{type:"primary",children:i.format("nodeInitTitle")}),onFinish:function(){var P=D()(u()().mark(function I(R){var O;return u()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,x.UK)({advertiseAddr:R.advertiseAddr,listenAddr:R.listenAddr,dataPathAddr:R.dataPathAddr,autoLockManagers:R.autoLockManagers,forceNewCluster:R.forceNewCluster,subnet:R.subnet});case 2:return O=S.sent,v.onFinish&&v.onFinish(),S.abrupt("return",!0);case 5:case"end":return S.stop()}},I)}));return function(I){return P.apply(this,arguments)}}(),formRef:j,onOpenChange:function(I){var R;!I&&(!((R=j.current)===null||R===void 0)&&R.resetFields)&&j.current.resetFields()},children:[(0,e.jsx)(J.Z,{name:"advertiseAddr",label:i.format("nodeInitAdvertiseAddr"),tooltip:i.format("nodeInitAdvertiseAddrTip"),required:!0,rules:[{required:!0}],placeholder:"172.16.1.13"}),(0,e.jsx)(J.Z,{name:"listenAddr",label:i.format("nodeInitListenAddr"),tooltip:i.format("nodeInitListenAddrTip"),initialValue:"0.0.0.0",required:!0,rules:[{required:!0}]}),(0,e.jsx)(J.Z,{name:"subnet",label:i.format("nodeInitSubnet"),initialValue:"10.0.0.0/16"}),(0,e.jsxs)(ue.Z,{gap:30,children:[(0,e.jsx)(Me.Z,{label:i.format("nodeInitAutoLockManagers"),name:"autoLockManagers",tooltip:i.format("nodeInitAutoLockManagersTip")}),(0,e.jsx)(Me.Z,{label:i.format("nodeInitForceNewCluster"),name:"forceNewCluster",tooltip:i.format("nodeInitForceNewClusterTip")})]})]})}var Ee=n(3616),Je=n(86615),l=n(64317),y=n(97462),A=n(62370),se=n(40056),ce=n(75293),re=n(82346);function ve(v){var j,i=new o.Uo("swarm"),P=(0,h.useRef)(),I=(0,h.useState)(),R=b()(I,2),O=R[0],z=R[1],S=(0,re.useModel)("@@initialState"),te=S.initialState;(0,h.useEffect)(function(){v.detail&&v.type=="add"&&L(v.detail,"worker")},[v.detail]);function L(w,g){return le.apply(this,arguments)}function le(){return le=D()(u()().mark(function w(g,N){var U,W,B;return u()().wrap(function($){for(;;)switch($.prev=$.next){case 0:z("docker swarm join --token ".concat(N=="manager"?(U=g.swarm)===null||U===void 0?void 0:U.JoinTokens.Manager:(W=g.swarm)===null||W===void 0?void 0:W.JoinTokens.Worker," ").concat((g==null?void 0:g.node)&&(g==null||(B=g.node.ManagerStatus)===null||B===void 0?void 0:B.Addr)));case 1:case"end":return $.stop()}},w)})),le.apply(this,arguments)}return(0,e.jsxs)(Y.a,{drawerProps:{width:Ee.R_},submitter:!1,formRef:P,onOpenChange:function(g){var N;!g&&(!((N=P.current)===null||N===void 0)&&N.resetFields)&&P.current.resetFields(),!g&&v.onFinish&&v.onFinish()},title:i.format("nodeJoinTitle.".concat(v.type)),trigger:(0,e.jsx)(Fe.ZP,{children:i.format("nodeJoinTitle.".concat(v.type))}),onValuesChange:function(){var w=D()(u()().mark(function g(N,U){var W,B;return u()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(z(""),!U.dockerEnvName){$.next=12;break}return $.prev=2,$.next=5,(0,x.vb)({dockerEnvName:U.dockerEnvName,role:U.role,type:v.type});case 5:W=$.sent,L(W.data,U.role),$.next=12;break;case 9:$.prev=9,$.t0=$.catch(2),(B=P.current)===null||B===void 0||B.resetFields(["dockerEnvName"]);case 12:v.type=="add"&&v.detail&&L(v.detail,U.role);case 13:case"end":return $.stop()}},g,null,[[2,9]])}));return function(g,N){return w.apply(this,arguments)}}(),children:[(0,e.jsx)(Je.Z.Group,{label:i.format("nodeJoinRole"),name:"role",initialValue:"worker",options:i.option("nodeAddRoleOption",["manager","worker"])}),v.type=="join"&&(0,e.jsx)(l.Z,{label:i.format("nodeJoinDockerEnvName"),name:"dockerEnvName",placeholder:i.format("nodeJoinDockerEnvNameEmpty"),options:te==null||(j=te.dockerEnv)===null||j===void 0?void 0:j.list.map(function(w){return{value:w.name,label:w.title}})},"env"),v.type=="join"&&!O&&(0,e.jsx)(y.Z,{name:["role"],children:function(g){var N=g.role;return(0,e.jsx)(A.Z,{label:i.format("nodeJoinCommandManual"),children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)(se.Z,{type:"warning",message:i.format("nodeJoinCommandManualTip")}),(0,e.jsx)(ce.Z,{block:!0,content:"docker swarm join-token ".concat(N)})]})})}}),O&&(0,e.jsx)(A.Z,{label:i.format("nodeJoinCommandJoin"),children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)(se.Z,{message:i.format("nodeJoinCommandJoinTip",{target:i.format("nodeJoinCommandJoinTarget.".concat(v.type))})}),(0,e.jsx)(ce.Z,{block:!0,content:O})]})})]})}var De=n(43425),je=n(74842),Ae=n(30159),Te=n(87784),oe=n(87462),we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.5 360.3a7.95 7.95 0 00-12.9 0l-178 246c-3.8 5.3 0 12.7 6.5 12.7H381c10.2 0 19.9-4.9 25.9-13.2L512 460.4l105.2 145.4c6 8.3 15.6 13.2 25.9 13.2H690c6.5 0 10.3-7.4 6.5-12.7l-178-246z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"up-circle",theme:"outlined"},Ze=we,ee=n(84089),be=function(j,i){return h.createElement(ee.Z,(0,oe.Z)({},j,{ref:i,icon:Ze}))},ze=h.forwardRef(be),xe=ze,ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},fe=ye,We=function(j,i){return h.createElement(ee.Z,(0,oe.Z)({},j,{ref:i,icon:fe}))},me=h.forwardRef(We),Le=me,he=n(45605),Pe=n(91806),Qe=n(60433),q=n(38345),de=n(42075),Ye=n(96074),F=n(26412),Ne=n(66309),pe=n(80821),Ve=n(5251),dt=n(91058),ut=n(76428),ct=n(24963),vt=n(97269),qe=n(25593),ft=n(84567);function _e(v){var j=(0,h.useRef)(),i=new o.Uo("swarm");return(0,e.jsx)(pe.Z,{type:"primary",danger:!0,confirmTitle:o.FD.format("title.tip"),confirmOnOpenChange:function(){var I;!((I=j.current)===null||I===void 0)&&I.resetFields&&j.current.resetFields()},confirm:(0,e.jsx)(vt.A,{submitter:!1,formRef:j,children:(0,e.jsxs)(de.Z,{style:{width:600,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(qe.Z.Text,{children:(0,e.jsx)("ul",{children:i.prefix("removeButtonTip",4).map(function(P,I){return(0,e.jsx)("li",{children:P},I)})})}),(0,e.jsx)(A.Z,{name:"enableForce",valuePropName:"checked",children:(0,e.jsxs)(ft.Z,{disabled:!!v.nodeId,children:[o.FD.format("listManageExitForce"),"\uFF1F"]})})]})}),action:D()(u()().mark(function P(){var I;return u()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.abrupt("return",(0,x.QB)({nodeId:v.nodeId,force:(I=j.current)===null||I===void 0?void 0:I.getFieldValue("enableForce")}));case 1:case"end":return O.stop()}},P)})),onSuccess:function(){v.onFinish&&v.onFinish()},children:v.title},"console")}var mt=n(94617),ht=(0,h.forwardRef)(function(v,j){var i,P,I,R,O,z,S,te,L,le,w,g,N,U,W,B,Se,$,Ie,M,C,s,Z,T,V,d,a,c,p,E,X,K,Ce,Re,Ke;(0,h.useImperativeHandle)(j,function(){return{show:function(r){var ne,f,Oe;!((ne=r.Spec)===null||ne===void 0)&&ne.Labels&&((f=lt.current)===null||f===void 0||f.setFieldValue("labels",Object.keys((Oe=r.Spec)===null||Oe===void 0?void 0:Oe.Labels).map(function(Be){var ie,Ge,Xe;return{name:Be,value:(ie=r.Spec)!==null&&ie!==void 0&&ie.Labels&&(Ge=r.Spec)!==null&&Ge!==void 0&&Ge.Labels[Be]?(Xe=r.Spec)===null||Xe===void 0?void 0:Xe.Labels[Be]:""}}))),ge(r),ke(!0)}}});var Mt=(0,h.useState)(!1),rt=b()(Mt,2),ot=rt[0],ke=rt[1],lt=(0,h.useRef)(),Et=(0,h.useState)(),st=b()(Et,2),t=st[0],ge=st[1],_=new o.Uo("swarm"),Ue=new o.Uo("system.home.overview"),At=(0,h.useContext)(ct.Z),Tt=At.message;return(0,e.jsx)(Y.a,{title:_.format("nodeDetailTitle",{name:t==null||(i=t.Description)===null||i===void 0?void 0:i.Hostname}),open:ot,drawerProps:{forceRender:!0,width:Ee.R_},onOpenChange:function(r){ke(r),!r&&v.onFinish&&v.onFinish()},onFinish:function(){var m=D()(u()().mark(function r(ne){var f,Oe;return u()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,(0,x.Zc)({nodeId:(f=t==null?void 0:t.ID)!==null&&f!==void 0?f:"",labels:ne.labels});case 2:return Oe=ie.sent,ge(Oe.data.detail),Tt.success(o.FD.format("finish")),ie.abrupt("return",!1);case 6:case"end":return ie.stop()}},r)}));return function(r){return m.apply(this,arguments)}}(),formRef:lt,children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,children:[(0,e.jsx)(q.Z,{title:(0,e.jsx)(De.Z,{}),ghost:!0,subTitle:o.FD.format("listManage"),children:(0,e.jsxs)(de.Z,{wrap:!0,children:[(0,e.jsx)(pe.Z,{action:D()(u()().mark(function m(){var r;return u()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,x.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",availability:"active"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},disabled:(t==null||(P=t.Spec)===null||P===void 0?void 0:P.Availability)=="active"||(t==null||(I=t.Status)===null||I===void 0?void 0:I.State)!="ready",tips:_.format("nodeListStatusOptionTip.active"),icon:(0,e.jsx)(je.Z,{}),children:o.FD.format("listManageUnpause")}),(0,e.jsx)(pe.Z,{action:D()(u()().mark(function m(){var r;return u()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,x.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",availability:"pause"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},disabled:(t==null||(R=t.Spec)===null||R===void 0?void 0:R.Availability)=="pause"||(t==null||(O=t.Status)===null||O===void 0?void 0:O.State)!="ready",tips:_.format("nodeListStatusOptionTip.pause"),icon:(0,e.jsx)(Ae.Z,{}),children:o.FD.format("listManagePause")}),(0,e.jsx)(pe.Z,{action:D()(u()().mark(function m(){var r;return u()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,x.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",availability:"drain"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},tips:_.format("nodeListStatusOptionTip.drain"),disabled:(t==null||(z=t.Spec)===null||z===void 0?void 0:z.Availability)=="drain"||(t==null||(S=t.Status)===null||S===void 0?void 0:S.State)!="ready",icon:(0,e.jsx)(Te.Z,{}),children:o.FD.format("listManageStop")}),(0,e.jsx)(Ye.Z,{type:"vertical"}),(t==null||(te=t.Spec)===null||te===void 0?void 0:te.Role)=="worker"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(pe.Z,{action:D()(u()().mark(function m(){var r;return u()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,x.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",role:"manager"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},type:"primary",disabled:(t==null||(L=t.Spec)===null||L===void 0?void 0:L.Availability)=="drain"||(t==null||(le=t.Status)===null||le===void 0?void 0:le.State)!="ready",icon:(0,e.jsx)(xe,{}),children:_.format("nodeDetailManageManager")})}),(t==null||(w=t.Spec)===null||w===void 0?void 0:w.Role)=="manager"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(pe.Z,{action:D()(u()().mark(function m(){var r;return u()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,x.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",role:"worker"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},type:"primary",disabled:(t==null||(g=t.Spec)===null||g===void 0?void 0:g.Availability)=="drain"||(t==null||(N=t.Status)===null||N===void 0?void 0:N.State)!="ready",icon:(0,e.jsx)(Le,{}),children:_.format("nodeDetailManageWorker")})}),(0,e.jsx)(Ye.Z,{type:"vertical"}),(0,e.jsx)(_e,{title:o.FD.format("listManageDelete"),nodeId:t==null?void 0:t.ID,onFinish:function(){ke(!1),v.onFinish&&v.onFinish()}})]})}),(0,e.jsx)(q.Z,{title:(0,e.jsx)(he.Z,{}),subTitle:o.FD.format("listManageDetail"),ghost:!0,children:(0,e.jsxs)(F.Z,{column:1,bordered:!0,styles:{label:{width:150}},children:[(0,e.jsxs)(F.Z.Item,{label:"Hostname",children:[(0,e.jsx)(ut.Z,{title:t==null?void 0:t.ID})," - ",t==null||(U=t.Description)===null||U===void 0?void 0:U.Hostname," - ",(0,e.jsx)(Ne.Z,{color:"blue",children:t==null||(W=t.Spec)===null||W===void 0?void 0:W.Role})," ",t&&(0,e.jsx)(H.Z,{status:"swarm.".concat((B=t.Status)===null||B===void 0?void 0:B.State),tip:_.format("nodeListRunStatusOptionTip.".concat((Se=($=t.Status)===null||$===void 0?void 0:$.State)!==null&&Se!==void 0?Se:"ready"))}),t&&(0,e.jsx)(H.Z,{status:"swarm.".concat((Ie=t.Spec)===null||Ie===void 0?void 0:Ie.Availability),tip:_.format("nodeListStatusOptionTip.".concat((M=(C=t.Spec)===null||C===void 0?void 0:C.Availability)!==null&&M!==void 0?M:"active"))})]}),(0,e.jsx)(F.Z.Item,{label:Ue.format("basicDockerTitleSystemVersion"),children:"".concat(t==null||(s=t.Description)===null||s===void 0||(s=s.Platform)===null||s===void 0?void 0:s.OS,` - 
              `).concat(t==null||(Z=t.Description)===null||Z===void 0||(Z=Z.Platform)===null||Z===void 0?void 0:Z.Architecture,` - 
              `).concat(t==null||(T=t.Description)===null||T===void 0||(T=T.Engine)===null||T===void 0?void 0:T.EngineVersion)}),(0,e.jsxs)(F.Z.Item,{label:"Cpu",children:[((V=t==null||(d=t.Description)===null||d===void 0||(d=d.Resources)===null||d===void 0?void 0:d.NanoCPUs)!==null&&V!==void 0?V:0)/1e9," ",o.FD.format("unitCpu")]}),(0,e.jsx)(F.Z.Item,{label:"Memory",children:(0,Ve.FI)((a=t==null||(c=t.Description)===null||c===void 0||(c=c.Resources)===null||c===void 0?void 0:c.MemoryBytes)!==null&&a!==void 0?a:0)}),(0,e.jsx)(F.Z.Item,{label:Ue.format("basicDockerTitlePluginsVolume"),children:(0,e.jsx)(de.Z,{children:(t==null||(p=t.Description)===null||p===void 0||(p=p.Engine)===null||p===void 0?void 0:p.Plugins)&&(t==null||(E=t.Description)===null||E===void 0||(E=E.Engine)===null||E===void 0?void 0:E.Plugins.filter(function(m){return m.Type=="Volume"}).map(function(m){return m.Name}))})}),(0,e.jsx)(F.Z.Item,{label:Ue.format("basicDockerTitlePluginsNetwork"),children:(0,e.jsx)(de.Z,{wrap:!0,children:(t==null||(X=t.Description)===null||X===void 0||(X=X.Engine)===null||X===void 0?void 0:X.Plugins)&&(t==null||(K=t.Description)===null||K===void 0||(K=K.Engine)===null||K===void 0?void 0:K.Plugins.filter(function(m){return m.Type=="Network"}).map(function(m){return m.Name}))})}),(0,e.jsx)(F.Z.Item,{label:Ue.format("basicDockerTitleLogDriver"),children:(0,e.jsx)(de.Z,{wrap:!0,children:(t==null||(Ce=t.Description)===null||Ce===void 0||(Ce=Ce.Engine)===null||Ce===void 0?void 0:Ce.Plugins)&&(t==null||(Re=t.Description)===null||Re===void 0||(Re=Re.Engine)===null||Re===void 0?void 0:Re.Plugins.filter(function(m){return m.Type=="Log"}).map(function(m){return m.Name}))})})]})}),t&&t.ID&&ot&&(0,e.jsx)(q.Z,{title:(0,e.jsx)(Pe.Z,{}),subTitle:_.format("nodeDetailServiceList"),headStyle:{paddingBottom:0},ghost:!0,children:(0,e.jsx)(mt.Z,{showWithNodeId:t.ID})}),(t==null||(Ke=t.Spec)===null||Ke===void 0?void 0:Ke.Labels)&&(0,e.jsx)(q.Z,{title:(0,e.jsx)(Qe.Z,{}),ghost:!0,subTitle:_.format("nodeDetailTagList"),children:(0,e.jsx)(dt.Z,{drawerProps:{ghost:!0},name:"labels",showAddButton:!0,addButtonLabel:_.format("nodeDetailTagAdd")})})]})})}),pt=ht,St=n(98009),gt=function(j,i){return h.createElement(ee.Z,(0,oe.Z)({},j,{ref:i,icon:St.Z}))},Dt=h.forwardRef(gt),et=Dt,jt=n(30432),Zt=function(j,i){return h.createElement(ee.Z,(0,oe.Z)({},j,{ref:i,icon:jt.Z}))},xt=h.forwardRef(Zt),yt=xt,It=n(90078),Ct=n(56729),tt=n(32983),Rt=n(60940),Ot=n(40411),$t=n(83062),Ft=n(22181),nt=n(89240),it={xs:1,sm:2,md:2,lg:2,xl:3,xxl:4},at={display:"flex",justifyContent:"flex-end",width:100};function Pt(){var v=(0,h.useState)(),j=b()(v,2),i=j[0],P=j[1],I=(0,h.useState)(0),R=b()(I,2),O=R[0],z=R[1],S=new o.Uo("swarm"),te=(0,h.useRef)(),L=(0,h.useRef)(),le=(0,h.useState)(),w=b()(le,2),g=w[0],N=w[1],U=(0,h.useState)(),W=b()(U,2),B=W[0],Se=W[1],$=(0,re.useModel)("@@initialState"),Ie=$.refresh;return(0,h.useEffect)(function(){(0,x.JC)().then(function(M){var C;P(M.data),!((C=L.current)===null||C===void 0)&&C.reloadAndRest&&L.current.reloadAndRest()})},[O]),(0,e.jsxs)(It._z,{extra:[i&&i.status.isManage&&(0,e.jsx)(ve,{type:"add",detail:i,onFinish:function(){z(O+1)}},"join"),i&&i.status.isNode&&(0,e.jsx)(_e,{title:S.format("nodeDetailDeleteButton.".concat(i.status.isManage?"delete":"leave")),onFinish:function(){i.status.isManage?Ie():z(O+1)}},"leave")],children:[(0,e.jsx)(pt,{ref:te,onFinish:function(){z(O+1)}}),(0,e.jsxs)(q.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(!i||!i.status.isNode)&&(0,e.jsx)(ue.Z,{justify:"center",style:{height:"58vh"},vertical:!0,children:(0,e.jsx)(tt.Z,{image:tt.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(de.Z,{direction:"vertical",size:[0,20],children:[S.format("nodeDetailJoinTip"),(0,e.jsxs)(de.Z,{children:[(0,e.jsx)(ve,{type:"join",detail:i,onFinish:function(){z(O+1)}},"join"),(0,e.jsx)(He,{onFinish:function(){Ie(),z(O+1)}})]})]})})}),i&&i.status.isNode&&i.info&&i.info.LocalNodeState!="error"&&(0,e.jsxs)(q.Z,{title:(0,e.jsx)(et,{}),subTitle:S.format("nodeDetailCurrent"),direction:"column",gutter:[0,20],children:[(0,e.jsx)(q.Z,{ghost:!0,children:(0,e.jsxs)(F.Z,{column:it,styles:{label:at},children:[(0,e.jsx)(F.Z.Item,{label:"Id",children:i.info.NodeID}),(0,e.jsx)(F.Z.Item,{label:o.FD.format("listRunStatus"),children:(0,e.jsx)(H.Z,{status:"swarm.".concat(i.info.LocalNodeState),tip:S.format("nodeListRunStatusOptionTip.".concat(i.info.LocalNodeState))})}),(0,e.jsx)(F.Z.Item,{label:o.FD.format("listType"),children:S.format("nodeAddRoleOption.".concat(i.info.ControlAvailable?"manager":"worker"))})]})}),i.info.RemoteManagers&&!i.status.isManage&&(0,e.jsx)(q.Z,{ghost:!0,title:(0,e.jsx)(et,{}),subTitle:S.format("nodeDetailManager"),children:(0,e.jsx)(Rt.Z,{pagination:!1,columns:[{title:o.FD.format("listName"),dataIndex:"NodeID"},{title:o.FD.format("listIpAddress"),dataIndex:"Addr"}],dataSource:i.info.RemoteManagers})})]}),i&&i.status.isManage&&i.swarm&&(0,e.jsx)(q.Z,{title:(0,e.jsx)(yt,{}),subTitle:S.format("nodeDetailSwarm"),direction:"column",gutter:[0,15],children:(0,e.jsx)(q.Z,{ghost:!0,children:(0,e.jsxs)(F.Z,{column:it,styles:{label:at},children:[(0,e.jsx)(F.Z.Item,{label:o.FD.format("listName"),children:i.swarm.ID}),(0,e.jsx)(F.Z.Item,{label:o.FD.format("listTitle"),children:i.swarm.Spec&&i.swarm.Spec.Name}),(0,e.jsxs)(F.Z.Item,{label:o.FD.format("listResource"),children:[g&&(0,nt.PD)(g.cpu)," ",o.FD.format("unitCpu")," / ",(0,Ve.FI)(g==null?void 0:g.memory)]}),(0,e.jsxs)(F.Z.Item,{label:"".concat(S.format("nodeDetailSwarmWorker")," / ").concat(S.format("nodeDetailSwarmManager")),children:[i.info.Nodes," / ",i.info.Managers]}),(0,e.jsx)(F.Z.Item,{label:o.FD.format("listCreatedAt"),children:new Date(i.swarm.CreatedAt).toLocaleString()}),(0,e.jsx)(F.Z.Item,{label:o.FD.format("listUpdatedAt"),children:new Date(i.swarm.UpdatedAt).toLocaleString()})]})})}),i&&i.status.isManage&&i.info.LocalNodeState!="error"&&(0,e.jsx)(q.Z,{title:(0,e.jsx)(Qe.Z,{}),subTitle:S.format("nodeDetailSwarmNodeList"),children:(0,e.jsx)(Ct.Z,{scroll:{x:"max-content"},rowKey:"ID",actionRef:L,pagination:!1,ghost:!0,search:!1,request:D()(u()().mark(function M(){var C,s,Z,T,V;return u()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,x.HN)();case 2:return C=a.sent,s={cpu:0,memory:0},C.data.list&&C.data.list.forEach(function(c){var p,E,X,K;s.cpu+=(p=(E=c.Description)===null||E===void 0||(E=E.Resources)===null||E===void 0?void 0:E.NanoCPUs)!==null&&p!==void 0?p:0,s.memory+=(X=(K=c.Description)===null||K===void 0||(K=K.Resources)===null||K===void 0?void 0:K.MemoryBytes)!==null&&X!==void 0?X:0}),N(s),a.next=8,(0,x.kM)();case 8:return Z=a.sent,a.next=11,(0,x.XX)();case 11:return T=a.sent,T.data&&T.data.list&&(V=[],T.data.list.forEach(function(c){if(c.Status.State=="running"){var p,E=Z.data&&Z.data.list&&((p=Z.data.list.find(function(X){return X.ID==c.ServiceID}))===null||p===void 0||(p=p.Spec)===null||p===void 0?void 0:p.Name);(!E||E=="")&&(E=c.ServiceID),V.push({nodeId:c.NodeID,serviceName:E,taskId:c.ID})}}),Se(V)),a.abrupt("return",{data:C.data.list,success:!0,total:C.data.list.length});case 14:case"end":return a.stop()}},M)})),columns:[{title:o.FD.format("listName"),render:function(C,s,Z,T,V){var d,a;return(0,e.jsxs)(de.Z,{children:[(0,e.jsx)(qe.Z.Link,{onClick:function(){var p;(p=te.current)===null||p===void 0||p.show(s)},children:(d=(a=s.Description)===null||a===void 0?void 0:a.Hostname)!==null&&d!==void 0?d:s.ID})," ",i.node&&s.ID==i.node.ID&&(0,e.jsx)(Ot.Z,{status:"processing"})]})}},{title:o.FD.format("listRole"),dataIndex:["Spec","Role"],render:function(C,s,Z,T,V){var d,a,c,p;return(0,e.jsx)(Ne.Z,{color:S.format("nodeAddRoleColor.".concat((d=(a=s.Spec)===null||a===void 0?void 0:a.Role)!==null&&d!==void 0?d:"worker")),children:S.format("nodeAddRoleOption.".concat((c=(p=s.Spec)===null||p===void 0?void 0:p.Role)!==null&&c!==void 0?c:"worker"))})}},{title:"CPU / Memory",render:function(C,s,Z,T,V){var d,a,c;return"".concat((0,nt.PD)((d=s.Description)===null||d===void 0||(d=d.Resources)===null||d===void 0?void 0:d.NanoCPUs)," ").concat(o.FD.format("unitCpu")," / ").concat((0,Ve.FI)((a=(c=s.Description)===null||c===void 0||(c=c.Resources)===null||c===void 0?void 0:c.MemoryBytes)!==null&&a!==void 0?a:0))}},{title:o.FD.format("listRunTask"),render:function(C,s,Z,T,V){var d={};return B&&B.filter(function(a){return a.nodeId==s.ID}).forEach(function(a){d[a.serviceName]||(d[a.serviceName]=0),d[a.serviceName]+=1}),Object.keys(d).length>0?Object.keys(d).map(function(a,c){return(0,e.jsx)($t.Z,{title:a,children:(0,e.jsx)(Ne.Z,{color:"success",children:d[a]})},"".concat(a,"-").concat(c))}):(0,e.jsx)(Ne.Z,{children:"0"})}},{title:o.FD.format("listApiVersion"),dataIndex:["Description","Engine","EngineVersion"]},{title:o.FD.format("listIpAddress"),dataIndex:["Status","Addr"]},{title:o.FD.format("listRunStatus"),render:function(C,s,Z,T,V){var d,a,c=(d=(a=s.Status)===null||a===void 0?void 0:a.State)!==null&&d!==void 0?d:"ready";return(0,e.jsx)(H.Z,{status:"swarm.".concat(c),tip:S.format("nodeListRunStatusOptionTip.".concat(c))})}},{title:o.FD.format("listStatus"),render:function(C,s,Z,T,V){var d,a,c,p;return(0,e.jsx)(H.Z,{status:"swarm.".concat((d=(a=s.Spec)===null||a===void 0?void 0:a.Availability)!==null&&d!==void 0?d:"active"),tip:S.format("nodeListStatusOptionTip.".concat((c=(p=s.Spec)===null||p===void 0?void 0:p.Availability)!==null&&c!==void 0?c:"active"))})}}],toolBarRender:function(){return[(0,e.jsx)(pe.Z,{action:function(){return(0,x.kp)()},onSuccess:function(){var s,Z;return!((s=L.current)===null||s===void 0)&&s.reloadAndRest&&((Z=L.current)===null||Z===void 0||Z.reloadAndRest()),!0},onError:function(){var s,Z;return!((s=L.current)===null||s===void 0)&&s.reset&&((Z=L.current)===null||Z===void 0||Z.reset()),!0},tips:o.FD.format("listManagePruneTip"),confirm:"notification.confirm.title",children:o.FD.format("listManagePrune")},"clear")]}})}),i&&i.status.isNode&&i.info.LocalNodeState=="error"&&(0,e.jsx)(Ft.ZP,{status:"error",title:S.format(["nodeListRunStatusOptionTip.error","nodeListRunStatusOptionTip.exit"]),subTitle:i.info.Error})]})]})}},89240:function($e,k,n){n.d(k,{HJ:function(){return h},PD:function(){return He},Rk:function(){return e},pM:function(){return Ee},yi:function(){return ue},zY:function(){return Je}});var Q=n(64599),u=n.n(Q),G=n(5251),D=n(88237),ae=n(43836),b=n(17179),H=n(74911),x=n(17637),o=n(58353),Y=/^([1-9]|[1-5]?[0-9]{2,4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$/m;function J(l){return Y.test(l)?parseInt(l,10):0}function Me(l){typeof l!="string"&&(l=l.toString());var y=D.Z(l,"-",2),A=ae.Z(y,J);return A.length==1&&A.push(A[0]),A}function Fe(l,y){typeof l!="string"&&(l=l.toString());var A=null,se=l.indexOf(":");se>=0&&(A=l.substring(0,se),l=l.substring(se+1)),y=typeof y=="number"?y:J(y);var ce=Me(l),re=Math.min(ce[0],y),ve=Math.max(ce[1],y);return A?A+":"+re+"-"+ve:re+"-"+ve}function ue(l){if(!l||!l.HostConfig||!l.HostConfig.PortBindings)return[];var y=[],A=l.HostConfig.PortBindings,se=b.Z(A),ce=H.Z(se,function(re){return D.Z(re,"/")[1]});return x.Z(ce,function(re,ve){var De={},je=u()(re),Ae;try{for(je.s();!(Ae=je.n()).done;){var Te=Ae.value,oe=u()(A[Te]),we;try{for(oe.s();!(we=oe.n()).done;){var Ze=we.value;De[Ze.HostIp]=De[Ze.HostIp]||[],De[Ze.HostIp].push(Te)}}catch(ee){oe.e(ee)}finally{oe.f()}}}catch(ee){je.e(ee)}finally{je.f()}x.Z(De,function(ee,be){var ze=o.Z(ee,function(fe){return parseInt(D.Z(fe,"/")[0],10)}),xe=-1,ye=-1;x.Z(ze,function(fe){var We=D.Z(fe,"/"),me=parseInt(We[0],10),Le=A[fe][0];A[fe].shift();var he=J(Le.HostPort);if(he>0){if(y.length>0&&xe===he-1&&ye===me-1){y[y.length-1].host=Fe(y[y.length-1].host,he),y[y.length-1].dest=Fe(y[y.length-1].dest,me),xe=he,ye=me;return}xe=he,ye=me}else xe=-1,ye=-1;var Pe=Le.HostPort.toString();be&&(Pe="".concat(be,":").concat(Pe)),y.push({host:Pe,dest:me.toString(),protocol:ve})})})}),y}function h(l){return(0,G.fi)(l,"/")}function e(l){return l?(0,G.FI)(l):"64M"}function He(l){return l&&l>1e8?l/1e9:0}function Ee(l){return l?l/1024/1024:0}function Je(l){return"".concat(h(l),".pod.dpanel.local")}}}]);
