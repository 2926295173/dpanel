"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1417],{1699:function(H,L,n){n.d(L,{u:function(){return o}});var T=n(97857),r=n.n(T),S=n(67294),s=n(82346),d=n(42075),P=n(85893),o=function(i){var p=(0,s.useAccess)(),v=Array.isArray(i.access)?i.access:[i.access];return i.space?(0,P.jsx)(d.Z,r()(r()({},i.space),{},{children:v.every(function(y){return p[y]})?i.children:i.fallback})):(0,P.jsx)(P.Fragment,{children:v.every(function(y){return p[y]})?i.children:i.fallback})}},57716:function(H,L,n){n.d(L,{Z:function(){return C}});var T=n(5574),r=n.n(T),S=n(15009),s=n.n(S),d=n(99289),P=n.n(d),o=n(67294),B=n(184),i=n(38345),p=n(64317),v=n(5966),y=n(62370),m=n(97462),F=n(42075),_=n(89035),W=n(82346),u=n(28036),l=n(85893);function E(c){var Z=(0,o.useState)({height:800,width:1024}),j=r()(Z,2),t=j[0],a=j[1],f=function(){var N=window.innerWidth,A=window.innerHeight;a({height:A,width:N})};(0,o.useEffect)(function(){window.addEventListener("resize",function(){f()}),f()},[c]);var e=c.query?Object.keys(c.query).map(function(U){if(c.query)return"".concat(U,"=").concat(c.query[U])}):[];return(0,l.jsx)(W.Link,{target:"_blank",to:"/console/"+c.container+"?width=".concat(t.width,"&height=").concat(t.height,"&").concat(e.join("&")),children:(0,l.jsx)(u.ZP,{type:"primary",icon:(0,l.jsx)(_.Z,{}),children:c.content})})}var g=n(60335),I=n(5251),w=n(49610),M=(0,o.forwardRef)(function(c,Z){(0,o.useImperativeHandle)(Z,function(){return{show:function(b,h){return P()(s()().mark(function K(){var $,V,R;return s()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,(0,g.jV)({md5:b});case 2:R=z.sent,h&&h!=""&&(R.data.info.Config.WorkingDir=h),x(R.data.info),U(!0),($=j.current)===null||$===void 0||$.resetFields(),(V=j.current)===null||V===void 0||V.setFieldsValue({workDir:R.data.info.Config.WorkingDir});case 8:case"end":return z.stop()}},K)}))()}}});var j=(0,o.useRef)(),t=(0,o.useRef)(),a=(0,o.useState)(!1),f=r()(a,2),e=f[0],U=f[1],N=(0,o.useState)(),A=r()(N,2),D=A[0],x=A[1];return(0,o.useEffect)(function(){return D&&setTimeout(function(){var O;(O=t.current)===null||O===void 0||O.start(D.Id,{width:"800",height:"".concat(window.innerHeight),cmd:"/bin/sh",workDir:D.Config.WorkingDir})},1e3),function(){var O;(O=t.current)===null||O===void 0||O.close()}},[D,e]),(0,l.jsxs)(B.a,{drawerProps:{forceRender:!0},onFinish:function(){var O=P()(s()().mark(function b(h){var K,$;return s()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(D){R.next=2;break}return R.abrupt("return",!1);case 2:return(K=t.current)===null||K===void 0||K.close(),($=t.current)===null||$===void 0||$.start(D.Id,{width:"800",height:"".concat(window.innerHeight),cmd:h.entryCmd,workDir:h.workDir}),R.abrupt("return",!1);case 5:case"end":return R.stop()}},b)}));return function(b){return O.apply(this,arguments)}}(),onValuesChange:function(b,h){if(h.entryCmd){var K;(K=j.current)===null||K===void 0||K.submit()}},isKeyPressSubmit:!0,open:e,formRef:j,onOpenChange:function(b){if(U(b),b){var h;(h=t.current)===null||h===void 0||h.fit()}},submitter:!1,title:(0,I.fi)(D?D.Name:"","/")+" \u63A7\u5236\u53F0",children:[(0,l.jsx)(i.Z,{ghost:!0,children:(0,l.jsxs)(F.Z.Compact,{children:[(0,l.jsx)(p.Z,{label:"shell",width:"sm",name:"entryCmd",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,l.jsx)(v.Z,{width:"sm",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",disabled:!0}),(0,l.jsx)(y.Z,{label:" ",children:(0,l.jsx)(m.Z,{name:["entryCmd","workDir"],children:function(b){var h=b.entryCmd;return(!h||h=="")&&(h="/bin/sh"),D&&(0,l.jsx)(E,{container:D.Id,query:{cmd:encodeURIComponent(h),workDir:encodeURIComponent(D.Config.WorkingDir)},content:"\u65B0\u7A97\u53E3\u6253\u5F00"})}})})]})}),e&&(0,l.jsx)(w.Z,{showInDrawer:!0,ref:t})]})}),C=M},49610:function(H,L,n){var T=n(67294),r=n(54964),S=n(52626),s=n(12320),d=n.n(s),P=n(78267),o=n.n(P),B=n(85893),i,p=new s.Terminal(r.a),v=new P.FitAddon,y=(0,T.forwardRef)(function(m,F){var _,W=function(){p.reset(),_&&_.dispose(),i&&(i.close(),i=null)},u=function(){p.reset(),v.fit(),p.focus(),_&&_.dispose(),_=p.onData(function(E){var g={content:{command:E},type:"console"};i&&i.send(JSON.stringify(g))})};return(0,T.useImperativeHandle)(F,function(){return{start:function(E,g){var I=g?Object.keys(g).map(function(w){if(g&&g[w])return"".concat(w,"=").concat(g[w])}):[];i=new WebSocket((0,S.R)("/console/"+E+"?"+I.join("&"))),i.addEventListener("message",function(w){var M=JSON.parse(w.data),C=M.type;if(C=="console:"+E&&(p.write(M.data),M.data.indexOf("exec failed")!=-1)){W();return}}),u()},close:function(){W()},fit:function(){v.fit()}}}),(0,T.useEffect)(function(){return p.loadAddon(v),p.open(document.getElementById("terminal-container-console")),v.fit(),function(){W()}},[]),(0,B.jsx)("div",{style:{height:m.showInDrawer?"75vh":"100vh"},id:"terminal-container-console"})});L.Z=y},54964:function(H,L,n){n.d(L,{a:function(){return y}});var T=n(5574),r=n.n(T),S=n(78267),s=n.n(S),d=n(75458),P=n.n(d),o=n(67294),B=n(12320),i=n.n(B),p=n(89629),v=n(85893),y={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},m=new B.Terminal(y),F=new d.SearchAddon,_=new S.FitAddon,W=(0,o.forwardRef)(function(u,l){var E,g=(0,o.useState)(!0),I=r()(g,2),w=I[0],M=I[1];return(0,o.useEffect)(function(){return window.addEventListener("resize",function(){u.showInModal||_.fit()}),u.style&&u.style.fontSize&&(m.options.fontSize=u.style.fontSize),m.loadAddon(_),m.loadAddon(F),m.open(document.getElementById(u.id?u.id:"terminal-container")),u.showInModal||_.fit(),function(){m.reset(),M(!0)}},[]),(0,o.useImperativeHandle)(l,function(){return{write:function(c){w&&(_.fit(),M(!1)),m.write(c)},clear:function(){m.clear()},getTerminal:function(){return m},findNext:function(c){F.findNext(c)},findPrev:function(c){F.findPrevious(c)},fit:function(){_.fit()},onData:function(c){return m.onData(c)}}}),(0,v.jsx)("div",{id:u.id?u.id:"terminal-container",style:{width:u.width?u.width:"100%",height:u.height?u.height:"500px",marginTop:(E=u.style)===null||E===void 0?void 0:E.marginTop}})});L.Z=W},28031:function(H,L,n){n.d(L,{C4:function(){return l},LK:function(){return W},OQ:function(){return g},V9:function(){return P},Yx:function(){return y},ZU:function(){return p},_U:function(){return B},gb:function(){return F},lE:function(){return C},mR:function(){return Z},vp:function(){return w}});var T=n(15009),r=n.n(T),S=n(99289),s=n.n(S),d=n(82346);function P(t){return o.apply(this,arguments)}function o(){return o=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/get-path-list",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),o.apply(this,arguments)}function B(t){return i.apply(this,arguments)}function i(){return i=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/export",{data:a,method:"POST",responseType:"blob"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),i.apply(this,arguments)}function p(t){return v.apply(this,arguments)}function v(){return v=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/import",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),v.apply(this,arguments)}function y(t){return m.apply(this,arguments)}function m(){return m=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/delete",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),m.apply(this,arguments)}function F(t){return _.apply(this,arguments)}function _(){return _=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/unzip",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),_.apply(this,arguments)}function W(t){return u.apply(this,arguments)}function u(){return u=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/get-content",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),u.apply(this,arguments)}function l(t){return E.apply(this,arguments)}function E(){return E=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/import-file-content",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),E.apply(this,arguments)}function g(t){return I.apply(this,arguments)}function I(){return I=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/chmod",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),I.apply(this,arguments)}function w(t){return M.apply(this,arguments)}function M(){return M=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/volume/backup",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),M.apply(this,arguments)}function C(t){return c.apply(this,arguments)}function c(){return c=s()(r()().mark(function t(a){var f,e,U;return r()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,W({md5:a.md5,file:"/etc/passwd"});case 2:return f=A.sent,e=[],U=f.data.content,U&&U.split(`
`).map(function(D){var x=D.split(":");x.length<7||e.push({username:x[0],uid:x[2],gid:x[3],description:x[4],homePath:x[5]})}),A.abrupt("return",{data:{list:e},error:"",code:200});case 7:case"end":return A.stop()}},t)})),c.apply(this,arguments)}function Z(t){return j.apply(this,arguments)}function j(){return j=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/get-file-stat",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),j.apply(this,arguments)}}}]);
