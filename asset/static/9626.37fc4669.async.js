"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9626],{69626:function(Ee,ge,t){t.d(ge,{Z:function(){return fn}});var ye=t(19632),v=t.n(ye),Ce=t(5574),C=t.n(Ce),k=t(15009),d=t.n(k),pe=t(99289),Z=t.n(pe),o=t(67294),_=t(80821),L=t(90098),je=t(52209),b=t(86548),re=t(43425),Q=t(74842),ve=t(48689),I=t(33160),we=t(87784),se=t(30159),xe=t(25035),W=t(38345),de=t(97269),le=t(86615),A=t(62370),V=t(82346),De=t(85265),H=t(42075),he=t(96074),q=t(25593),me=t(83062),Se=t(40056),ue=t(84567),Re=t(28036),u=t(99861),s=t(91058),G=t(79245),r=t(60940),Be=t(55241),be=t(78451),We=t(37413),Ke=t(94359),Ge=t(91806),Ne=t(60433),Ue=t(89035),Qe=t(99922),ze=t(46357),Ye=t(87662),He=t(5251),N=t(36146),e=t(85893);function Xe(l){var ee=(0,o.useState)(""),z=C()(ee,2),U=z[0],X=z[1],E=(0,o.useRef)(),T=(0,o.useRef)(),$=(0,o.useState)(!1),f=C()($,2),w=f[0],n=f[1],B=new N.Uo("components.appCompose");return(0,o.useEffect)(function(){(0,Ye.K3)().then(function(g){var h;X((h=g.data.serverUrl)!==null&&h!==void 0?h:"")}),n(!1)},[l.containerList]),l.containerList&&(0,e.jsxs)(W.Z,{ghost:!0,title:(0,e.jsx)(Ge.Z,{}),subTitle:B.format("detailContainerTitle"),extra:l.enableSelectService&&(0,e.jsx)(ue.Z,{onChange:function(h){n(h.target.checked)},children:B.format("selectService")},"selectService"),children:[(0,e.jsx)(Qe.Z,{ref:E}),(0,e.jsx)(ze.Z,{ref:T}),(0,e.jsx)(r.Z,{scroll:{x:"max-content"},rowKey:"service",pagination:!1,columns:[{title:N.FD.format("listName"),dataIndex:"name",width:200,render:function(h,a,y){return(0,e.jsx)(me.Z,{title:a.service,children:(0,e.jsx)(be.Z,{content:a.name?(0,He.fi)(a.name,"/"):a.service})})}},{title:N.FD.format("listPort"),render:function(h,a,y){var D=[],R=[];return a.publishers&&a.publishers.map(function(P){P.publishedPort?D.push({PrivatePort:P.targetPort,Type:P.protocol,IP:P.url,PublicPort:P.publishedPort}):P.publishedPort&&R.push({PrivatePort:P.targetPort,Type:P.protocol,IP:P.url,PublicPort:P.publishedPort})}),(0,e.jsx)(We.Z,{publicPort:D,privatePort:R,domain:[],serverIp:U})}},{title:N.FD.format("listStatus"),render:function(h,a,y){return(0,e.jsx)(Ke.Z,{status:"container.".concat(a.state),tip:"".concat(a.state," ").concat(a.status)},a.name)}},{title:N.FD.format("listManage"),fixed:"right",render:function(h,a,y){return(0,e.jsxs)(H.Z,{split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[a.name==""&&(0,e.jsx)(Be.Z,{placement:"left",content:(0,e.jsx)(W.Z,{ghost:!0,title:N.FD.format("listManageShowContainerEnv"),children:(0,e.jsx)(H.Z,{direction:"vertical",children:a.environment&&Object.keys(a.environment).map(function(D){if(a.environment&&a.environment[D])return(0,e.jsx)(q.Z.Text,{code:!0,children:"".concat(D,"=").concat(a.environment[D])},D)})})}),children:(0,e.jsx)(Ne.Z,{})}),a.name!=""&&(0,e.jsx)(q.Z.Link,{onClick:function(){var R;(R=T.current)===null||R===void 0||R.show(a.name)},children:(0,e.jsx)(re.Z,{})},"container"),a.state=="running"&&(0,e.jsx)(q.Z.Link,{onClick:function(){var R;(R=E.current)===null||R===void 0||R.show({url:"/console/container/".concat(a.name),title:a.name})},children:(0,e.jsx)(Ue.Z,{})},"console")]})}}],dataSource:l.containerList,rowSelection:w&&l.containerList?{defaultSelectedRowKeys:l.containerList.map(function(g){return g.service}),onChange:function(h,a,y){l.selectServiceFinish&&l.selectServiceFinish(h)}}:void 0})]})}var Je=t(81146),_e=t(45742),Ze=t(3616),qe=(0,o.forwardRef)(function(l,ee){(0,o.useImperativeHandle)(ee,function(){return{show:function(h){return Z()(d()().mark(function a(){return d()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:w(l.composeItem),E(!0);case 2:case"end":return D.stop()}},a)}))()}}});var z=(0,o.useState)(!1),U=C()(z,2),X=U[0],E=U[1],T=(0,o.useState)(),$=C()(T,2),f=$[0],w=$[1],n=(0,o.useRef)(),B=new N.Uo("components.appCompose");return(0,e.jsxs)(e.Fragment,{children:[l.showTriggerButton&&(0,e.jsx)(q.Z.Link,{onClick:Z()(d()().mark(function g(){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:w(l.composeItem),E(!0);case 2:case"end":return a.stop()}},g)})),children:(0,e.jsx)(me.Z,{title:N.FD.format("listManageLog"),children:(0,e.jsx)(_e.Z,{})})},"log"),(0,e.jsx)(De.Z,{title:B.format("logDrawerTitle"),open:X,forceRender:!0,onClose:function(){E(!1)},afterOpenChange:function(h){if(h)setTimeout(function(){var y,D;(y=n.current)===null||y===void 0||y.start(),(D=n.current)===null||D===void 0||D.fit()},1e3);else{var a;(a=n.current)===null||a===void 0||a.close()}},width:Ze.FK,children:f&&X&&(0,e.jsx)(Je.Z,{ref:n,showInDrawer:!0,id:"compose:log:".concat(String(f.id||f.name)),request:function(){var g=Z()(d()().mark(function h(a){var y;return d()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,(0,L.Yz)({id:f.id||f.name,lineTotal:a.lineTotal,download:(y=a.download)!==null&&y!==void 0?y:!1,showTime:a.showTime});case 2:case"end":return R.stop()}},h)}));return function(h){return g.apply(this,arguments)}}(),download:function(){var g=Z()(d()().mark(function h(a){var y;return d()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,(0,L.vf)({id:f.id||f.name,lineTotal:a.lineTotal,showTime:a.showTime,download:!0});case 2:return y=R.sent,R.abrupt("return",{data:new Blob([y],{type:"text/plain"}),name:l.composeItem.name+"_"+new Date().toLocaleDateString()+".log"});case 4:case"end":return R.stop()}},h)}));return function(h){return g.apply(this,arguments)}}()})})]})}),en=qe,Me=t(24963),ke=t(184),nn=t(95213),tn=t(95089),rn=t(92398);function an(l){var ee=(0,o.useContext)(Me.Z),z=ee.message,U=(0,o.useRef)(),X=new N.Uo("components.appCompose"),E=new N.Uo("compose");return l.composeItem.yamlList&&(0,e.jsx)(ke.a,{drawerProps:{width:Ze.R_},title:X.format("yamlDrawerTitle"),formRef:U,trigger:(0,e.jsx)(q.Z.Link,{children:(0,e.jsx)(me.Z,{title:"Yaml",children:"Yaml"})}),onFinish:function(){var T=Z()(d()().mark(function $(f){return d()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,L.im)({id:String(l.composeItem.id?l.composeItem.id:l.composeItem.name),name:l.composeItem.name,type:l.composeItem.setting.type,yaml:f.yaml,yamlOverride:f.yamlOverride});case 2:return n.next=4,(0,L.xC)({yaml:[f.yaml,f.yamlOverride],environment:l.composeItem.setting.environment,id:l.composeItem.id||l.composeItem.name});case 4:return l.onFinish&&l.onFinish(),n.abrupt("return",!0);case 6:case"end":return n.stop()}},$)}));return function($){return T.apply(this,arguments)}}(),children:(0,e.jsx)(W.Z,{ghost:!0,children:(0,e.jsx)(rn.Z,{items:l.composeItem.yamlList.map(function(T,$){var f=[{label:E.format("createYaml"),key:"yaml"},{label:E.format("createYamlOverride"),key:"yamlOverride"}];return{label:f[$].label,key:f[$].key,children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(A.Z,{hidden:!0,name:f[$].key}),(0,e.jsx)(A.Z,{shouldUpdate:!0,children:function(n){return(0,e.jsx)(tn.ZP,{onFocus:function(){if(f[$].key=="yaml"&&l.composeItem.setting.type=="remoteUrl"){z.error(E.format("createYamlDisableEdit"));return}},readOnly:f[$].key=="yaml"&&l.composeItem.setting.type=="remoteUrl",theme:"dark",minHeight:"550px",value:T,onChange:function(g){n.setFieldValue(f[$].key,g)},extensions:[nn.RI.yaml()]})}})]})}})})})})}var sn=t(65913),Te=t(1699),on=t(16970),ln=t(35887),un=(0,o.forwardRef)(function(l,ee){(0,o.useImperativeHandle)(ee,function(){return{show:function(){return Z()(d()().mark(function w(){var n;return d()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return $(!0),(n=U.current)===null||n===void 0||n.clear(),g.next=4,new Promise(function(h){return setTimeout(function(){var a;(a=U.current)===null||a===void 0||a.fit(),h(!0)},1e3)});case 4:case"end":return g.stop()}},w)}))()},close:function(){var w;$(!1),(w=U.current)===null||w===void 0||w.clear()}}});var z=(0,V.useModel)("subscriber"),U=(0,o.useRef)(),X=(0,o.useState)(!1),E=C()(X,2),T=E[0],$=E[1];return z.addDataHandler("compose:"+l.id,function(f){var w;(w=U.current)===null||w===void 0||w.write(f.data)}),(0,e.jsx)(W.Z,{hidden:!T,ghost:!0,title:(0,e.jsx)(Ue.Z,{}),subTitle:"Console",extra:(0,e.jsx)(H.Z,{children:(0,e.jsx)(_.Z,{action:function(){var w;return(w=U.current)===null||w===void 0||w.clear(),(0,L.U_)({})},icon:(0,e.jsx)(ve.Z,{}),danger:!0,onSuccess:function(){},children:N.FD.format("listManageKill")},"kill")}),children:(0,e.jsx)(ln.Z,{id:"create-log-".concat(l.id),height:"200px",style:{fontSize:12},ref:U})})}),Ae=un,cn=(0,o.forwardRef)(function(l,ee){var z=(0,o.useState)(!1),U=C()(z,2),X=U[0],E=U[1],T=new N.Uo("components.appCompose"),$=(0,o.useState)(),f=C()($,2),w=f[0],n=f[1],B=(0,o.useRef)(),g=(0,o.useRef)();return(0,o.useImperativeHandle)(ee,function(){return{show:function(a){var y;E(!0),n(a),(y=B.current)===null||y===void 0||y.setFieldsValue({environment:a.detail.setting.environment})}}}),(0,e.jsxs)(ke.a,{formRef:B,open:X,drawerProps:{forceRender:!0},title:T.format("taskDrawerTitle",{name:""}),onOpenChange:function(a){E(a)},children:[(0,e.jsx)(W.Z,{title:(0,e.jsx)(re.Z,{}),subTitle:T.format("managerTitle"),ghost:!0,children:w&&(0,e.jsx)(H.Z,{wrap:!0,split:(0,e.jsx)(he.Z,{type:"vertical"}),children:(0,e.jsx)(_.Z,{icon:(0,e.jsx)(Q.Z,{}),type:"primary",confirmOnOpenChange:function(a){var y;a&&(!((y=B.current)===null||y===void 0)&&y.resetFields)&&B.current.resetFields()},action:Z()(d()().mark(function h(){var a,y,D;return d()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return(a=g.current)===null||a===void 0||a.show(),D=(y=B.current)===null||y===void 0?void 0:y.getFieldValue("environment"),P.next=4,(0,L.Oh)({id:w.detail.name,environment:D,autoRemove:!0});case 4:E(!1),l.onFinish&&l.onFinish(D);case 6:case"end":return P.stop()}},h)})),children:T.format("managerCreateButton")},"create")})},"operator"),w&&(0,e.jsx)(Ae,{ref:g,id:w.detail.name}),(0,e.jsx)(W.Z,{title:T.format("envTitle"),subTitle:T.format("envSubTitle"),tooltip:T.format("envTip"),ghost:!0,children:(0,e.jsx)(s.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,requireValue:!0,showDeleteButton:!1})})]})}),dn=cn,mn=(0,o.forwardRef)(function(l,ee){var z;(0,o.useImperativeHandle)(ee,function(){return{show:function(c){return Z()(d()().mark(function m(){var x;return d()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(x=oe.current)===null||x===void 0||x.close(),T(!0),i.prev=2,i.next=5,Ve(c);case 5:i.next=12;break;case 7:i.prev=7,i.t0=i.catch(2),T(!1),B(void 0),l.onClose&&l.onClose();case 12:case"end":return i.stop()}},m,null,[[2,7]])}))()}}});var U=(0,o.useState)(!1),X=C()(U,2),E=X[0],T=X[1],$=(0,V.useNavigate)(),f=(0,o.useState)(),w=C()(f,2),n=w[0],B=w[1],g=(0,o.useState)(),h=C()(g,2),a=h[0],y=h[1],D=(0,o.useState)(0),R=C()(D,2),P=R[0],ce=R[1],ne=(0,o.useRef)(),Fe=(0,o.useRef)(),ae=(0,o.useRef)(),Oe=(0,o.useRef)(),oe=(0,o.useRef)(),Le=(0,o.useRef)(),pn=(0,o.useContext)(Me.Z),vn=pn.message,Pe=(0,V.useAccess)(),F=new N.Uo("components.appCompose"),hn=(0,o.useRef)();function gn(j){return $e.apply(this,arguments)}function $e(){return $e=Z()(d()().mark(function j(c){var m,x,S;return d()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(m=oe.current)===null||m===void 0?void 0:m.show();case 2:if(!c.pullImageUseDPanel){p.next=6;break}return p.next=5,(x=Oe.current)===null||x===void 0?void 0:x.start();case 5:(S=Oe.current)===null||S===void 0||S.finish();case 6:return p.prev=6,p.next=9,(0,L.Oh)(c);case 9:l.onDeployFinish&&l.onDeployFinish(),p.next=15;break;case 12:p.prev=12,p.t0=p.catch(6),l.onDeployFailed&&l.onDeployFailed(n);case 15:ce(P+1);case 16:case"end":return p.stop()}},j,null,[[6,12]])})),$e.apply(this,arguments)}function Ve(j){return Ie.apply(this,arguments)}function Ie(){return Ie=Z()(d()().mark(function j(c){var m,x,S,i,p,J,Y;return d()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return(m=Le.current)===null||m===void 0||m.show(),(x=ne.current)===null||x===void 0||x.resetFields(),K.next=4,(0,L.Pn)({id:c}).finally(Z()(d()().mark(function O(){var M;return d()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:(M=Le.current)===null||M===void 0||M.destroy();case 1:case"end":return te.stop()}},O)}))).catch(function(O){throw O});case 4:S=K.sent,i=S.data.detail,i.setting.status&&i.setting.status.indexOf("running")>-1&&(i.isRunning=!0),i.setting.status&&i.setting.status.indexOf("paused")>-1&&(i.isPaused=!0),i.setting.status&&i.setting.status.indexOf("exited")>-1&&(i.isExited=!0),i.setting.status&&i.setting.status=="waiting"?i.isDeploy=!1:i.isDeploy=!0,i.setting.status&&i.setting.status.indexOf("created")>-1&&(i.isCreated=!0,i.isDeploy=!1),p=S.data.project,p&&(i.imageList=v()(new Set(Object.keys(p.services).map(function(O){var M;return(M=p.services[O].image)!==null&&M!==void 0?M:""})))),i.containerList=S.data.containerList,(!i.containerList||i.containerList.length==0)&&p&&p.services&&(i.containerList=Object.keys(p.services).map(function(O){return{name:"",service:O,publishers:p.services[O].ports?p.services[O].ports.map(function(M){var fe;return{url:"",targetPort:M.target,publishedPort:parseInt(M.published),protocol:(fe=M.protocol)!==null&&fe!==void 0?fe:""}}):[],state:"waiting",status:"",environment:p.services[O].environment}})),i.containerList&&((J=ne.current)===null||J===void 0||J.setFieldValue("deployServiceName",S.data.detail.setting.deployServiceName)),i.yamlList=S.data.yaml,B(i),y(S.data.task),S.data.yaml&&S.data.yaml.map(function(O){(0,G.m)(O).map(function(M){i.setting.environment&&!i.setting.environment.find(function(fe){return fe.name==M.name})&&i.setting.environment.push(M)})}),S.data.detail.setting.environment&&((Y=ne.current)===null||Y===void 0||Y.setFieldValue("environment",S.data.detail.setting.environment));case 21:case"end":return K.stop()}},j)})),Ie.apply(this,arguments)}return(0,o.useEffect)(function(){P>0&&n&&Ve(n.id||n.name).catch(function(j){T(!1)})},[P]),(0,e.jsxs)(De.Z,{width:Ze.R_,forceRender:!0,extra:n&&n.setting.type!="dangling"&&(0,e.jsxs)(H.Z,{split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[n.isDeploy&&(0,e.jsx)(en,{composeItem:n,showTriggerButton:!0}),Pe.canSeeComposeListManage&&(0,e.jsx)(on.Z,{trigger:(0,e.jsx)(q.Z.Link,{children:(0,e.jsx)(je.Z,{})},"network")},"network-create"),Pe.canSeeComposeListManage&&(0,e.jsx)(an,{composeItem:n,onFinish:Z()(d()().mark(function j(){return d()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:vn.info(F.format("messageYamlEditFinish")),ce(P+1);case 2:case"end":return m.stop()}},j)}))}),Pe.canSeeComposeListManageCreate&&(0,e.jsx)(V.Link,{to:"/compose/create?id="+(n.id||n.name),children:(0,e.jsx)(me.Z,{title:F.format("drawerEditButtonTip"),children:(0,e.jsx)(b.Z,{})})})]}),title:(0,e.jsx)(H.Z,{children:F.format("drawerTitle",{name:(z=n==null?void 0:n.name)!==null&&z!==void 0?z:""})}),open:E,onClose:function(){T(!1),B(void 0),l.onClose&&l.onClose()},children:[(0,e.jsx)(dn,{onFinish:function(c){var m,x,S,i=((m=ne.current)===null||m===void 0?void 0:m.getFieldFormatValue)&&((x=ne.current)===null||x===void 0?void 0:x.getFieldFormatValue("environment"));i==null||i.forEach(function(p,J){var Y=c.find(function(ie){return ie.name==p.name});Y&&(i[J].value=Y.value)}),!((S=ne.current)===null||S===void 0)&&S.setFieldValue&&ne.current.setFieldValue("environment",i)},ref:hn}),(0,e.jsx)(sn.Z,{ref:Le,children:(0,e.jsxs)(W.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,e.jsxs)(W.Z,{title:(0,e.jsx)(re.Z,{}),subTitle:F.format("managerTitle"),ghost:!0,extra:(0,e.jsx)(e.Fragment,{children:n&&n.imageList&&n.imageList.length>0&&(0,e.jsx)(u.Z,{ref:Oe,image:n.imageList})}),children:[n&&n.setting.type=="dangling"&&(0,e.jsx)(Se.Z,{type:"warning",showIcon:!0,description:(0,e.jsxs)("div",{children:[F.format("managerStatusDanglingAlert",{name:n.name})," ",(0,e.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/compose/external",target:"_blank",children:N.FD.format("help")})]})}),n&&n.setting.type!="dangling"&&(0,e.jsxs)(H.Z,{wrap:!0,split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[(0,e.jsx)(Te.u,{access:"canSeeComposeList",children:(0,e.jsx)(_.Z,{icon:(0,e.jsx)(Q.Z,{}),type:"primary",confirmOnOpenChange:function(c){var m;c&&(!((m=ae.current)===null||m===void 0)&&m.resetFields)&&ae.current.resetFields()},confirm:(0,e.jsxs)(H.Z,{style:{width:300},direction:"vertical",children:[(0,e.jsx)(q.Z.Text,{children:F.format("managerCreateTip")}),(0,e.jsxs)(de.A,{name:"createForm",formRef:ae,layout:"inline",submitter:!1,children:[(0,e.jsx)(le.Z.Group,{name:"pullImageUse",layout:"vertical",fieldProps:{style:{display:"flex",flexDirection:"column",gap:8}},valueEnum:{useCommand:F.format("managerCreatePullImageUseCommand"),useDPanel:F.format("managerCreatePullImageUseDPanel")}}),(0,e.jsx)(A.Z,{initialValue:!0,name:"createPath",valuePropName:"checked",children:(0,e.jsx)(ue.Z,{defaultChecked:!0,children:F.format("managerCreateCreatePath")})}),(0,e.jsx)(A.Z,{initialValue:!0,name:"removeOrphans",valuePropName:"checked",children:(0,e.jsx)(ue.Z,{defaultChecked:!0,children:F.format("managerCreateRemoveOrphans")})})]})]}),action:Z()(d()().mark(function j(){var c,m,x,S,i,p,J,Y,ie,K,O,M;return d()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(K={id:n.id||n.name},(c=ae.current)!==null&&c!==void 0&&c.getFieldValue&&((m=ae.current)===null||m===void 0?void 0:m.getFieldValue("pullImageUse"))=="useDPanel"&&(K.pullImage=!1,K.pullImageUseDPanel=!0),(x=ae.current)!==null&&x!==void 0&&x.getFieldValue&&((S=ae.current)===null||S===void 0?void 0:S.getFieldValue("pullImageUse"))=="useCommand"&&(K.pullImage=!0),O=((i=ne.current)===null||i===void 0?void 0:i.getFieldsFormatValue)&&ne.current.getFieldsFormatValue(),K.environment=O.environment,K.deployServiceName=O.deployServiceName,K.createPath=(p=(J=ae.current)===null||J===void 0?void 0:J.getFieldValue("createPath"))!==null&&p!==void 0?p:!0,K.removeOrphans=(Y=(ie=ae.current)===null||ie===void 0?void 0:ie.getFieldValue("removeOrphans"))!==null&&Y!==void 0?Y:!0,!(n!=null&&n.isDeploy)){te.next=12;break}if(!((M=ae.current)!==null&&M!==void 0&&M.getFieldValue("pullImageUseCommand"))){te.next=12;break}return te.next=12,(0,L.GG)({id:n.id||n.name,op:"pull"});case 12:return te.abrupt("return",gn(K));case 13:case"end":return te.stop()}},j)})),children:F.format(n.isDeploy?"managerUpgradeButton":"managerCreateButton")},"create")}),(n.isDeploy||n.isCreated)&&Pe.canSeeComposeListManage&&(0,e.jsx)(_.Z,{action:function(){var c;return(c=oe.current)===null||c===void 0||c.show(),(0,L.mg)({id:n.id||n.name,deleteImage:!1,deleteData:!1,deleteVolume:!1,deletePath:!1})},onSuccess:function(){ce(P+1)},type:"primary",danger:!0,confirm:"notification.confirm.title",icon:(0,e.jsx)(ve.Z,{}),children:F.format("managerDeleteContainerButton")}),n.isDeploy&&(0,e.jsxs)(Te.u,{access:"canSeeComposeList",space:{direction:"horizontal"},children:[(0,e.jsx)(_.Z,{icon:(0,e.jsx)(I.Z,{}),action:Z()(d()().mark(function j(){var c;return d()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return(c=oe.current)===null||c===void 0||c.show(),x.abrupt("return",(0,L.GG)({id:n.id||n.name,op:"restart"}));case 2:case"end":return x.stop()}},j)})),onSuccess:function(){ce(P+1)},children:F.format("managerRestartButton")},"restart"),(0,e.jsx)(_.Z,{action:function(){var c;return(c=oe.current)===null||c===void 0||c.show(),(0,L.GG)({id:n.id||n.name,op:"stop"})},icon:(0,e.jsx)(we.Z,{}),disabled:n.isExited,onSuccess:function(){ce(P+1)},children:F.format("managerStopButton")}),n.isPaused&&(0,e.jsx)(_.Z,{action:function(){var c;return(c=oe.current)===null||c===void 0||c.show(),(0,L.GG)({id:n.id||n.name,op:"unpause"})},onSuccess:function(){ce(P+1)},icon:(0,e.jsx)(Q.Z,{}),children:F.format("managerUnpauseButton")}),!n.isPaused&&(0,e.jsx)(_.Z,{action:function(){var c;return(c=oe.current)===null||c===void 0||c.show(),(0,L.GG)({id:n.id||n.name,op:"pause"})},onSuccess:function(){ce(P+1)},icon:(0,e.jsx)(se.Z,{}),disabled:!n.isRunning,children:F.format("managerPauseButton")})]}),n.id>0&&Pe.canSeeComposeListManageDelete&&(0,e.jsx)(_.Z,{type:"primary",action:Z()(d()().mark(function j(){var c,m,x,S,i,p,J,Y,ie;return d()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return(c=oe.current)===null||c===void 0||c.show(),O.next=3,(0,L.mg)({id:(m=n==null?void 0:n.id)!==null&&m!==void 0?m:n.name,deleteImage:(x=(S=Fe.current)===null||S===void 0?void 0:S.getFieldValue("deleteImage"))!==null&&x!==void 0?x:!1,deleteVolume:(i=(p=Fe.current)===null||p===void 0?void 0:p.getFieldValue("deleteVolume"))!==null&&i!==void 0?i:!1,deletePath:(J=(Y=Fe.current)===null||Y===void 0?void 0:Y.getFieldValue("deletePath"))!==null&&J!==void 0?J:!1});case 3:return O.next=5,(0,L.ik)({id:[(ie=n.id)!==null&&ie!==void 0?ie:0]});case 5:ce(P+1);case 6:case"end":return O.stop()}},j)})),danger:!0,onSuccess:function(){$("/compose/list")},confirm:(0,e.jsxs)(H.Z,{style:{width:240},direction:"vertical",children:[(0,e.jsx)(q.Z.Text,{children:F.format("managerDeleteTaskTip")}),(0,e.jsxs)(de.A,{formRef:Fe,layout:"inline",submitter:!1,children:[(0,e.jsx)(A.Z,{initialValue:!1,name:"deleteImage",valuePropName:"checked",children:(0,e.jsx)(ue.Z,{children:F.format("managerDeleteTaskDeleteImage")})}),(0,e.jsx)(A.Z,{addonAfter:(0,e.jsx)(me.Z,{title:F.format("managerDeleteTaskDeleteVolumeTip"),children:(0,e.jsx)(xe.Z,{})}),initialValue:!1,name:"deleteVolume",valuePropName:"checked",children:(0,e.jsx)(ue.Z,{children:F.format("managerDeleteTaskDeleteVolume")})}),(0,e.jsx)(A.Z,{initialValue:!1,name:"deletePath",valuePropName:"checked",children:(0,e.jsx)(ue.Z,{children:F.format("managerDeleteTaskDeletePath")})})]})]}),children:F.format("managerDeleteTaskButton")}),l.showBackListButton&&(0,e.jsx)(V.Link,{to:"/compose/list",children:(0,e.jsx)(Re.ZP,{children:N.Ob.format("compose.list")})})]})]},"operator"),n&&(0,e.jsx)(Ae,{ref:oe,id:n.id||n.name}),n&&(0,e.jsx)(Xe,{containerList:n.containerList,enableSelectService:!n.isDeploy,selectServiceFinish:function(c){var m;(m=ne.current)===null||m===void 0||m.setFieldValue("deployServiceName",c)}}),(0,e.jsx)(Te.u,{access:"canSeeComposeList",children:(0,e.jsxs)(de.A,{submitter:!1,formRef:ne,children:[(0,e.jsx)(A.Z,{name:"deployServiceName",hidden:!0}),n&&n.setting.type!="dangling"&&(0,e.jsx)(W.Z,{title:F.format("envTitle"),subTitle:F.format("envSubTitle"),tooltip:F.format("envTip"),ghost:!0,children:(0,e.jsx)(s.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,requireValue:!0,showDeleteButton:!1})})]})})]})})]})}),fn=mn},35887:function(Ee,ge,t){var ye=t(5574),v=t.n(ye),Ce=t(12323),C=t(78267),k=t.n(C),d=t(75458),pe=t.n(d),Z=t(67294),o=t(4244),_=t.n(o),L=t(24078),je=t(85893),b,re,Q,ve=(0,Z.forwardRef)(function(I,we){var se,xe=(0,Z.useState)(!0),W=v()(xe,2),de=W[0],le=W[1];return(0,Z.useEffect)(function(){return b=new o.Terminal(Ce.X),re=new d.SearchAddon,Q=new C.FitAddon,window.addEventListener("resize",function(){I.showInModal||Q.fit()}),I.style&&I.style.fontSize&&(b.options.fontSize=I.style.fontSize),b.loadAddon(Q),b.loadAddon(re),b.open(document.getElementById(I.id?I.id:"terminal-container")),I.showInModal||Q.fit(),function(){b.reset(),le(!0)}},[]),(0,Z.useImperativeHandle)(we,function(){return{write:function(V){de&&(Q.fit(),le(!1)),b.write(V)},clear:function(){b.clear()},getTerminal:function(){return b},findNext:function(V){re.findNext(V)},findPrev:function(V){re.findPrevious(V)},fit:function(){Q.fit()},onData:function(V){return b.onData(V)}}}),(0,je.jsx)("div",{id:I.id?I.id:"terminal-container",style:{width:I.width?I.width:"100%",height:I.height?I.height:"500px",marginTop:(se=I.style)===null||se===void 0?void 0:se.marginTop}})});ge.Z=ve},90098:function(Ee,ge,t){t.d(ge,{GG:function(){return we},MG:function(){return De},Oh:function(){return re},Pn:function(){return _},U_:function(){return A},Yz:function(){return xe},iE:function(){return me},ik:function(){return je},im:function(){return d},mg:function(){return ve},pm:function(){return Z},tw:function(){return ue},vf:function(){return de},xC:function(){return he}});var ye=t(15009),v=t.n(ye),Ce=t(99289),C=t.n(Ce),k=t(82346);function d(u){return pe.apply(this,arguments)}function pe(){return pe=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/create",{method:"POST",data:s}));case 1:case"end":return r.stop()}},u)})),pe.apply(this,arguments)}function Z(u){return o.apply(this,arguments)}function o(){return o=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/get-list",{method:"POST",data:s}));case 1:case"end":return r.stop()}},u)})),o.apply(this,arguments)}function _(u){return L.apply(this,arguments)}function L(){return L=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/get-task",{method:"POST",data:s}));case 2:case"end":return r.stop()}},u)})),L.apply(this,arguments)}function je(u){return b.apply(this,arguments)}function b(){return b=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/delete",{method:"POST",data:s}));case 1:case"end":return r.stop()}},u)})),b.apply(this,arguments)}function re(u){return Q.apply(this,arguments)}function Q(){return Q=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/container-deploy",{method:"POST",data:s}));case 2:case"end":return r.stop()}},u)})),Q.apply(this,arguments)}function ve(u){return I.apply(this,arguments)}function I(){return I=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/container-destroy",{method:"POST",data:s}));case 2:case"end":return r.stop()}},u)})),I.apply(this,arguments)}function we(u){return se.apply(this,arguments)}function se(){return se=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/container-ctrl",{method:"POST",data:s}));case 2:case"end":return r.stop()}},u)})),se.apply(this,arguments)}function xe(u){return W.apply(this,arguments)}function W(){return W=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/container-log",{method:"POST",data:s}));case 2:case"end":return r.stop()}},u)})),W.apply(this,arguments)}function de(u){return le.apply(this,arguments)}function le(){return le=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.download=!0,s.id=String(s.id),r.next=4,(0,k.request)("/api/app/compose/container-log",{method:"POST",data:s,responseType:"blob"});case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}},u)})),le.apply(this,arguments)}function A(u){return V.apply(this,arguments)}function V(){return V=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/container-process-kill",{method:"POST",data:s}));case 1:case"end":return r.stop()}},u)})),V.apply(this,arguments)}function De(u){return H.apply(this,arguments)}function H(){return H=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/get-from-uri",{method:"POST",data:s}));case 1:case"end":return r.stop()}},u)})),H.apply(this,arguments)}function he(u){return q.apply(this,arguments)}function q(){return q=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/parse",{method:"POST",data:s}));case 2:case"end":return r.stop()}},u)})),q.apply(this,arguments)}function me(u){return Se.apply(this,arguments)}function Se(){return Se=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/common/store/deploy",{method:"POST",data:s}));case 1:case"end":return r.stop()}},u)})),Se.apply(this,arguments)}function ue(u){return Re.apply(this,arguments)}function Re(){return Re=C()(v()().mark(function u(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/download",{method:"POST",data:s,responseType:"blob"}));case 2:case"end":return r.stop()}},u)})),Re.apply(this,arguments)}}}]);
