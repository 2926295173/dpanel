"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1058],{91058:function(N,U,n){var W=n(9783),u=n.n(W),B=n(19632),f=n.n(B),i=n(97857),d=n.n(i),I=n(5574),v=n.n(I),b=n(89035),m=n(64317),j=n(5966),A=n(38345),L=n(17186),h=n(24739),x=n(42075),R=n(28036),Z=n(85576),E=n(67294),F=n(95089),P=n(12491),T=n(62597),D=n(79245),r=n(3616),o=n(36146),_=n(85893),e="docker-image",Y=(0,E.forwardRef)(function(s,J){var Q=(0,E.useState)(e),H=v()(Q,2),k=H[0],V=H[1],O=(0,E.useRef)(),q=(0,E.useState)(""),$=v()(q,2),ee=$[0],ne=$[1],K=new o.Uo("components.appForm");(0,E.useImperativeHandle)(J,function(){return{addEnvItem:function(a,c){var p,l=(p=O.current)===null||p===void 0?void 0:p.getList(),g=!1;if(l==null||l.map(function(M){if(M.name==a){g=!0;return}}),!g){var C;(C=O.current)===null||C===void 0||C.add({name:a,value:c})}},clear:function(){var a;(a=O.current)===null||a===void 0||(a=a.getList())===null||a===void 0||a.map(function(c,p){var l;(l=O.current)===null||l===void 0||l.remove(p)})}}});function z(t){try{var a,c;t==""&&(t=X());for(var p=(a=(c=O.current)===null||c===void 0||(c=c.getList())===null||c===void 0?void 0:c.length)!==null&&a!==void 0?a:0,l=p;l>=0;l--){var g;(g=O.current)===null||g===void 0||g.remove(l)}var C=t.split(`
`),M=0;C.map(function(w){var S,y=w.split("=");y.length<2||((S=O.current)===null||S===void 0||S.add({name:y[0],value:y.slice(1).join("=")},M),M++)})}catch(w){console.log(w)}}function re(){k!="code"?V("code"):V(e)}function X(){if(O&&O.current&&O.current.getList){var t,a=(t=O.current)===null||t===void 0?void 0:t.getList();if(a){var c=[];return a.map(function(p){c.push("".concat(p.name,"=").concat(p.value))}),c.join(`
`)}else return""}else return""}function te(t){var a,c,p,l,g,C={},M={help:t&&t.label?t.label:"",name:"value",label:K.format("createEnvFormValue"),rules:[{required:s.requireValue?!0:(0,D.y)((a=t.rule)===null||a===void 0?void 0:a.kind,T.fp.EnvValueRuleRequired)}],disabled:s.showDisableValue||(0,D.y)((c=t.rule)===null||c===void 0?void 0:c.kind,T.fp.EnvValueRuleDisabled)};if((0,D.y)((p=t.rule)===null||p===void 0?void 0:p.kind,T.fp.EnvValueTypeSelect)){var w;return(0,_.jsx)(m.Z,d()(d()({fieldProps:C},M),{},{initialValue:t.value,width:s.showInDrawer?"sm":"md",options:((w=t.rule)===null||w===void 0?void 0:w.option)&&t.rule.option.map(function(y){return{label:y.name,value:y.value}})}))}else if((0,D.y)((l=t.rule)===null||l===void 0?void 0:l.kind,T.fp.EnvValueTypeSelectMultiple)){var S;return(0,_.jsx)(m.Z,d()(d()({mode:"tags"},M),{},{fieldProps:C,convertValue:function(G){return Array.isArray(G)?G:G.split(",")},width:s.showInDrawer?"sm":"md",options:((S=t.rule)===null||S===void 0?void 0:S.option)&&t.rule.option.map(function(y){return{label:y.name,value:y.value}})}))}else return(0,D.y)((g=t.rule)===null||g===void 0?void 0:g.kind,T.fp.EnvValueTypeNumber)?(0,_.jsx)(j.Z,d()(d()({fieldProps:C},M),{},{width:s.showInDrawer?"sm":"md",rules:[].concat(f()(M.rules),[{pattern:new RegExp("^[0-9]*$")}]),help:K.format("createEnvFormNumberTip",{name:M.help})})):(0,_.jsx)(j.Z,d()(d()({fieldProps:C},M),{},{width:s.showInDrawer?"sm":"md"}))}return(0,_.jsxs)(A.Z,{ghost:s.showCardGhost,title:s.label?s.label:null,headerBordered:!0,extra:(s.showCodeMode||s.showImportButton)&&(0,_.jsxs)(x.Z,{children:[s.showImportButton&&(0,_.jsx)("div",{style:{marginBottom:"-25px"},children:(0,_.jsx)(P.Z,{title:K.format("createEnvFormEnvImport"),onImport:function(a){return z(a),!0},onLoad:function(a){if(a.indexOf("=")<0)throw new Error(o.FD.format("commonFileIncorrectFormat",{name:"env"}));return!0}})}),s.showCodeMode?(0,_.jsx)(R.ZP,{icon:(0,_.jsx)(b.Z,{}),type:k=="code"?"primary":"default",onClick:re,children:K.format("createEnvFormEnvCode")},"code"):""]}),children:[(0,_.jsx)(L.u,{name:s.name?s.name:"environment",actionRef:O,creatorButtonProps:s.showAddButton?{creatorButtonText:K.format("createEnvFormListAddButton")}:!1,copyIconProps:!1,deleteIconProps:s.showDeleteButton,min:100,label:s.listLabel,transform:function(a,c,p){return u()({},c,a.map(function(l){return Array.isArray(l.value)&&(l.value=l.value.filter(function(g){return g!=""}).join(",")),l}))},children:function(a,c,p){var l=p.getCurrentRowData();return(0,_.jsxs)(h.UW,{style:{marginBottom:"5px"},children:[(0,_.jsx)(j.Z,{width:s.showInDrawer?"sm":"md",name:"name",label:K.format("createEnvFormName"),required:!0,rules:[{required:!0}],disabled:s.showDisableName,placeholder:K.format("createEnvFormNameEmpty")}),te(l)]})}}),s.showCodeMode&&(0,_.jsx)(Z.Z,{width:r.ob,open:k=="code",onCancel:function(){return V("docker-image")},onOk:function(){z(ee),V("docker-image")},children:(0,_.jsx)(F.ZP,{onChange:function(a){return ne(a)},value:X(),height:r.Ed,theme:"dark"})})]})});U.Z=Y},12491:function(N,U,n){n.d(U,{Z:function(){return b}});var W=n(24963),u=n(36146),B=n(88484),f=n(62370),i=n(31418),d=n(28036),I=n(67294),v=n(85893);function b(m){var j=(0,I.useContext)(W.Z),A=j.message,L=j.notice,h=(0,I.useRef)(null),x=i.Z.useApp(),R=function(){h.current&&(h.current.click(),h.current.onchange=function(E){if(!E||!E.target)return"";var F=new FileReader;F.onload=function(D){var r,o,_=(r=D.target)===null||r===void 0?void 0:r.result;if(m.onLoad)try{m.onLoad&&m.onLoad(_)}catch(e){L.error(e);return}typeof m.onImport=="function"&&(A.success(u.FD.format("finish")),m.onImport(_)),(o=h.current)!==null&&o!==void 0&&o.value&&(h.current.value="")};var P=E.target;if(P.files&&P.files[0]){var T=P.files[0];if(T.type!=""&&!T.type.includes("text/")){L.error(u.FD.format("commonContentIncorrectFormat",{name:P.files[0].name}));return}try{F.readAsText(P.files[0])}catch(D){L.error(u.FD.format("commonContentIncorrectFormat",{name:P.files[0].name}))}}})};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(f.Z,{children:(0,v.jsx)(d.ZP,{icon:(0,v.jsx)(B.Z,{}),block:!0,onClick:R,children:m.title})}),(0,v.jsx)("input",{style:{display:"none"},type:"file",ref:h,name:"importFileInput"})]})}},62597:function(N,U,n){n.d(U,{$G:function(){return d},Ct:function(){return Z},Tb:function(){return j},XH:function(){return L},cl:function(){return b},fp:function(){return v},iE:function(){return x},xb:function(){return F},ze:function(){return T}});var W=n(15009),u=n.n(W),B=n(99289),f=n.n(B),i=n(82346);function d(r){return I.apply(this,arguments)}function I(){return I=f()(u()().mark(function r(o){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/app/site/create-by-image",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),I.apply(this,arguments)}var v={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192};function b(r){return m.apply(this,arguments)}function m(){return m=f()(u()().mark(function r(o){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/app/site/get-list",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),m.apply(this,arguments)}function j(r){return A.apply(this,arguments)}function A(){return A=f()(u()().mark(function r(o){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.download=!1,e.next=3,(0,i.request)("/api/app/log/run",{method:"POST",data:o});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),A.apply(this,arguments)}function L(r){return h.apply(this,arguments)}function h(){return h=f()(u()().mark(function r(o){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.download=!0,e.next=3,(0,i.request)("/api/app/log/run",{method:"POST",data:o,responseType:"blob"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),h.apply(this,arguments)}function x(r){return R.apply(this,arguments)}function R(){return R=f()(u()().mark(function r(o){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.id=String(o.id),e.next=3,(0,i.request)("/api/app/site/get-detail",{data:o,method:"POST"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),R.apply(this,arguments)}function Z(r){return E.apply(this,arguments)}function E(){return E=f()(u()().mark(function r(o){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/app/container/delete",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),E.apply(this,arguments)}function F(r){return P.apply(this,arguments)}function P(){return P=f()(u()().mark(function r(o){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/app/site/delete",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),P.apply(this,arguments)}function T(r){return D.apply(this,arguments)}function D(){return D=f()(u()().mark(function r(o){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/app/container/ignore",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),D.apply(this,arguments)}},79245:function(N,U,n){n.d(U,{m:function(){return B},y:function(){return f}});var W=n(64599),u=n.n(W);function B(i){var d=[];if(!i||i=="")return d;var I=i.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),v=u()(I),b;try{for(v.s();!(b=v.n()).done;){var m=b.value;d.push({name:m[1],value:m[2]?m[2].indexOf("-")==0?m[2].substring(1):m[2]:""})}}catch(j){v.e(j)}finally{v.f()}return d}function f(i,d){return!i||!d?!1:(i&d)!==0}}}]);
