"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{1699:function(N,W,e){e.d(W,{u:function(){return j}});var I=e(9783),d=e.n(I),p=e(97857),R=e.n(p),V=e(67294),y=e(82346),A=e(40411),f=e(42075),a=e(85893),j=function(n){var b=(0,y.useAccess)(),s=Array.isArray(n.access)?n.access:[n.access],t,r=n.fallback;return typeof n.children=="function"?(t=n.children(s.reduce(function(_,T){return R()(R()({},_),{},d()({},T,b[T]))},{})),t||(t=r)):s.every(function(_){return b[_]})?t=n.children:t=r,!r&&t&&n.showProTips&&b.canSeeEnableCe&&(t=(0,a.jsx)(A.Z,{offset:n.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:t})),!r&&t&&n.showProRibbonTips&&b.canSeeEnableCe&&(t=(0,a.jsx)(A.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:t})),n.space?(0,a.jsx)(f.Z,R()(R()({},n.space),{},{children:t})):t}},80821:function(N,W,e){e.d(W,{Z:function(){return P}});var I=e(97857),d=e.n(I),p=e(5574),R=e.n(p),V=e(24963),y=e(86738),A=e(28036),f=e(83062),a=e(67294),j=e(85893);function P(n){var b=(0,a.useState)(!1),s=R()(b,2),t=s[0],r=s[1],_=(0,a.useContext)(V.Z),T=_.lang,g=_.message,c=function(){r(!0);var l=n.action();l instanceof Promise?l.then(function(S){if(r(!1),S){typeof n.onSuccess=="function"&&n.onSuccess(S);var K="";n.messageSuccess?typeof n.messageSuccess=="function"?K=n.messageSuccess(S):K=n.messageSuccess.indexOf("notification.")==0?T(n.messageSuccess):n.messageSuccess:K=T("notification.finish"),n.asynced?g.info(K):g.success(K)}}).catch(function(S){r(!1),typeof n.onError=="function"&&n.onError(S)}):r(!1)};return n.confirm?(0,j.jsx)(y.Z,d()(d()({style:{width:500},title:n.confirmTitle?n.confirmTitle:T("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?T(n.confirm):n.confirm,onConfirm:c,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,j.jsx)(A.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&t?void 0:n.icon,loading:t,danger:n.danger,type:n.type,children:n.children})})):(0,j.jsx)(f.Z,{title:n.tips,children:(0,j.jsx)(A.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&t?void 0:n.icon,loading:t,onClick:c,danger:n.danger,type:n.type,children:n.children})})}},44349:function(N,W,e){var I=e(97857),d=e.n(I),p=e(17186),R=e(5966),V=e(86250),y=e(67294),A=e(85893),f=(0,y.forwardRef)(function(a,j){var P=(0,y.useRef)();(0,y.useImperativeHandle)(j,function(){return{addItem:function(s,t){var r,_=(r=P.current)===null||r===void 0?void 0:r.getList(),T=!1;if(_==null||_.map(function(c){if(c.name==s){T=!0;return}}),!T){var g;(g=P.current)===null||g===void 0||g.add({name:s,value:t})}},clear:function(){var s;(s=P.current)===null||s===void 0||(s=s.getList())===null||s===void 0||s.map(function(t,r){var _;(_=P.current)===null||_===void 0||_.remove(r)})}}});var n={};return a.hideCopyButton===!0&&(n.copyIconProps=!1),a.hideDeleteButton===!0&&(n.deleteIconProps=!1),(0,A.jsx)(p.u,d()(d()({initialValue:a.initialValue,label:a.label,name:a.name,actionRef:P,creatorButtonProps:a.showAddButton?{creatorButtonText:"\u6DFB\u52A0"+(a.label?a.label:a.name)}:!1,min:a.min?a.min:0},n),{},{children:function(s,t,r){return(0,A.jsx)(V.Z,{justify:a.justify,gap:a.gap,children:a.items.map(function(_){return _.render?(0,A.jsx)("div",{children:_.render&&_.render(s,t,r)},"".concat(a.name,"-").concat(_.name,"-").concat(s.key)):(0,A.jsx)(R.Z,{width:_.width,name:_.name,label:_.label,required:_.required,rules:[{required:_.required}],disabled:_.disabled,placeholder:_.placeholder},"".concat(a.name,"-").concat(_.name,"-").concat(s.key))})})}}))});W.Z=f},8680:function(N,W,e){var I=e(15009),d=e.n(I),p=e(64599),R=e.n(p),V=e(99289),y=e.n(V),A=e(9783),f=e.n(A),a=e(5574),j=e.n(a),P=e(67294),n=e(184),b=e(38345),s=e(97269),t=e(97321),r=e(97462),_=e(64317),T=e(5966),g=e(86615),c=e(68602),H=e(28036),l=e(83403),S=e(24963),K=e(1699),Q=e(29177),X=e(45742),k=e(43425),Y=e(44349),w=e(3616),i=e(85893),z=(0,P.forwardRef)(function(x,q){var Z=(0,P.useState)(!1),v=j()(Z,2),U=v[0],D=v[1],L=(0,P.useRef)(),u=(0,P.useContext)(S.Z),B=u.message,G=(0,P.useState)([]),ee=j()(G,2),J=ee[0],ne=ee[1],_e=f()(f()(f()(f()(f()({},l.W6.CONTAINER,"Id"),l.W6.APPSTORE,"name"),l.W6.COMPOSE,"name"),l.W6.REGISTRY,"serverAddress"),l.W6.DOCKER_ENV,"name"),se=f()(f()(f()(f()(f()({},l.W6.CONTAINER,"name"),l.W6.APPSTORE,"name"),l.W6.COMPOSE,"name"),l.W6.REGISTRY,"title"),l.W6.DOCKER_ENV,"title"),te=_e[x.type],re=se[x.type],le=x.selected.map(function(C){return C[_e[x.type]]});return P.useEffect(function(){U&&((0,c.dP)({permission:{uri:x.type,key:te,value:le}}).then(function(C){var o;(o=L.current)===null||o===void 0||o.setFieldValue("list",Object.keys(C.data.list).map(function(E){return{name:E,type:C.data.list[E].type,users:C.data.list[E].users}}))}),(0,c.lE)().then(function(C){var o,E=(o=C.data)===null||o===void 0||(o=o.list)===null||o===void 0?void 0:o.map(function(m){return{label:m.username,value:m.username}});ne(E)}))},[U]),(0,i.jsx)(K.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,i.jsxs)(n.a,{name:"create",title:"\u6570\u636E\u6743\u9650\u8BBE\u7F6E",open:U,onOpenChange:function(o){if(!o){var E;(E=L.current)===null||E===void 0||E.resetFields()}D(o)},drawerProps:{forceRender:!0,width:w.R_},formRef:L,trigger:(0,i.jsx)(H.ZP,{icon:(0,i.jsx)(Q.Z,{}),children:"\u6570\u636E\u6743\u9650"}),onFinish:function(){var C=y()(d()().mark(function o(E){var m,h,M;return d()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:m=R()(E.list),O.prev=1,m.s();case 3:if((h=m.n()).done){O.next=9;break}return M=h.value,O.next=7,(0,c.Db)({usernames:M.users,permissionType:M.type,permission:{uri:x.type,key:te,showKey:re,value:[M.name]}});case 7:O.next=3;break;case 9:O.next=14;break;case 11:O.prev=11,O.t0=O.catch(1),m.e(O.t0);case 14:return O.prev=14,m.f(),O.finish(14);case 17:B.success("\u6743\u9650\u8BBE\u7F6E\u6210\u529F"),D(!1),x.onSuccess();case 20:case"end":return O.stop()}},o,null,[[1,11,14,17]])}));return function(o){return C.apply(this,arguments)}}(),children:[(0,i.jsxs)(b.Z,{ghost:!0,title:(0,i.jsx)(X.Z,{}),subTitle:"\u6279\u91CF\u8BBE\u7F6E",children:[(0,i.jsx)(s.A.Item,{name:"type",style:{marginBottom:0},children:(0,i.jsxs)(t.Z.Group,{defaultValue:"admin",onChange:function(o){var E,m,h=(E=L.current)===null||E===void 0?void 0:E.getFieldValue("list");h.forEach(function(M){M.type=o,M.users=[]}),(m=L.current)===null||m===void 0||m.setFieldValue("list",h)},children:[(0,i.jsx)(t.Z,{style:{width:240},title:"\u7BA1\u7406\u5458",description:"\u4EC5\u7BA1\u7406\u5458\u53EF\u89C1",value:"admin"}),(0,i.jsx)(t.Z,{style:{width:240},title:"\u6307\u5B9A\u7528\u6237",description:"\u4EC5\u9009\u4E2D\u7528\u6237\u53EF\u89C1",value:"restricted"}),(0,i.jsx)(t.Z,{style:{width:240},title:"\u516C\u5171",description:"\u6240\u6709\u4EBA\u53EF\u89C1",value:"public"})]})}),(0,i.jsx)(r.Z,{name:["type"],children:function(o){var E=o.type;if(E==="restricted")return(0,i.jsx)(_.Z,{mode:"multiple",name:"usernames",label:"\u9009\u62E9\u7528\u6237",onChange:function(h){var M,F,O=(M=L.current)===null||M===void 0?void 0:M.getFieldValue("list");O.forEach(function($){$.users=h}),(F=L.current)===null||F===void 0||F.setFieldValue("list",O)},rules:[{required:!0}],request:y()(d()().mark(function m(){var h,M,F;return d()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(!(J.length>0)){$.next=2;break}return $.abrupt("return",J);case 2:return $.next=4,(0,c.lE)();case 4:return M=$.sent,F=(h=M.data)===null||h===void 0||(h=h.list)===null||h===void 0?void 0:h.map(function(ae){return{label:ae.username,value:ae.username}}),ne(F),$.abrupt("return",F);case 8:case"end":return $.stop()}},m)}))})}})]}),(0,i.jsx)(b.Z,{ghost:!0,title:(0,i.jsx)(k.Z,{}),subTitle:"\u6570\u636E\u6743\u9650\u8BBE\u7F6E",children:(0,i.jsx)(Y.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:"\u540D\u79F0",render:function(o,E,m){var h=m.getCurrentRowData();return(0,i.jsx)(T.Z,{disabled:!0,label:"\u540D\u79F0",width:"sm",name:"name"})}},{name:"type",label:"\u6743\u9650\u7C7B\u578B",render:function(o,E,m){var h=m.getCurrentRowData();return(0,i.jsx)(g.Z.Group,{label:"\u6743\u9650\u7C7B\u578B",name:"type",radioType:"button",options:[{label:"\u7BA1\u7406\u5458",value:"admin"},{label:"\u516C\u5171",value:"public"},{label:"\u6307\u5B9A\u7528\u6237",value:"restricted"}]})}},{name:"users",label:"\u5173\u8054\u7528\u6237",render:function(o,E,m){return(0,i.jsx)(r.Z,{name:["type"],children:function(M){var F=M.type;if(F=="restricted")return(0,i.jsx)(_.Z,{width:"sm",mode:"tags",name:"users",label:"\u5173\u8054\u7528\u6237",options:J})}})}}]})})]})})});W.Z=z},3616:function(N,W,e){e.d(W,{Ed:function(){return R},FK:function(){return d},R_:function(){return I},ob:function(){return p}});var I=window.innerWidth<=1024?"90vw":"65vw",d="90vw",p="60vw",R="50vh"},24963:function(N,W,e){var I=e(67294),d=(0,I.createContext)({});W.Z=d},98163:function(N,W,e){e.r(W),e.d(W,{default:function(){return H}});var I=e(15009),d=e.n(I),p=e(99289),R=e.n(p),V=e(80821),y=e(77273),A=e(8680),f=e(83403),a=e(24963),j=e(87662),P=e(86548),n=e(90078),b=e(41482),s=e(82346),t=e(28036),r=e(42075),_=e(96074),T=e(25593),g=e(67294),c=e(85893);function H(){var l=(0,g.useRef)(),S=(0,g.useRef)(),K=(0,s.useModel)("@@initialState"),Q=K.initialState,X=K.loading,k=K.error,Y=K.refresh,w=K.setInitialState,i=(0,g.useContext)(a.Z),z=i.message,x=(0,s.useLocation)(),q=(0,s.useNavigate)();return(0,g.useEffect)(function(){var Z=x.state;if(Z&&Z.item){var v;(v=S.current)===null||v===void 0||v.edit(Z.item)}},[x.state]),(0,c.jsx)(n._z,{header:{extra:[(0,c.jsx)(y.Z,{trigger:(0,c.jsx)(t.ZP,{type:"primary",children:"\u6DFB\u52A0\u670D\u52A1\u7AEF"}),ref:S,onFinish:R()(d()().mark(function Z(){var v,U,D;return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(D=x.state,!(D&&D.item)){u.next=6;break}return u.next=4,(0,j.vC)({name:D.item.name});case 4:return q(x.pathname,{replace:!0,state:null}),u.abrupt("return");case 6:Y(),!((v=l.current)===null||v===void 0)&&v.reloadAndRest&&((U=l.current)===null||U===void 0||U.reloadAndRest());case 8:case"end":return u.stop()}},Z)}))},"dockerEnvCreate")]},children:(0,c.jsx)(b.Z,{rowKey:"name",columns:[{title:"\u6807\u8BC6",dataIndex:"name"},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u5730\u5740",dataIndex:"address"},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(v,U,D,L,u){return(0,c.jsx)(r.Z,{split:(0,c.jsx)(_.Z,{type:"vertical"}),children:(0,c.jsx)(T.Z.Link,{onClick:function(){var G;(G=S.current)===null||G===void 0||G.edit(U)},children:(0,c.jsx)(P.Z,{})},U.name)})}}],pagination:!1,request:R()(d()().mark(function Z(){var v;return d()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,j.Kg)();case 2:return v=D.sent,D.abrupt("return",{data:v.data.list,total:v.data.list.length});case 4:case"end":return D.stop()}},Z)})),search:!1,rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:l,tableAlertOptionRender:function(v){var U=v.selectedRows,D=v.selectedRowKeys;return(0,c.jsxs)(r.Z,{size:16,children:[(0,c.jsx)(A.Z,{type:f.W6.DOCKER_ENV,selected:U,onSuccess:function(){var u,B;return!((u=l.current)===null||u===void 0)&&u.reloadAndRest&&((B=l.current)===null||B===void 0||B.reloadAndRest()),!0}}),(0,c.jsx)(V.Z,{danger:!0,type:"primary",action:function(){return U.find(function(u){return u.default})?(z.warning("\u9ED8\u8BA4\u73AF\u5883\u4E0D\u80FD\u5220\u9664"),!1):(0,j._g)({name:D})},onSuccess:function(){var u,B;return!((u=l.current)===null||u===void 0)&&u.reloadAndRest&&((B=l.current)===null||B===void 0||B.reloadAndRest()),!0},onError:function(){var u,B;return!((u=l.current)===null||u===void 0)&&u.reset&&((B=l.current)===null||B===void 0||B.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"})]})}})})}}}]);
