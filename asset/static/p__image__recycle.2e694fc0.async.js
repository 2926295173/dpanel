"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4202],{45742:function(y,T,e){e.d(T,{Z:function(){return M}});var R=e(87462),i=e(67294),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656zM492 400h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zM340 368a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"profile",theme:"outlined"},f=m,E=e(84089),j=function(r,A){return i.createElement(E.Z,(0,R.Z)({},r,{ref:A,icon:f}))},I=i.forwardRef(j),M=I},80821:function(y,T,e){e.d(T,{Z:function(){return P}});var R=e(5574),i=e.n(R),m=e(24963),f=e(86738),E=e(28036),j=e(83062),I=e(67294),M=e(85893);function P(r){var A=(0,I.useState)(!1),s=i()(A,2),h=s[0],t=s[1],l=(0,I.useContext)(m.Z),L=l.lang,c=l.notice,B=l.message,C=function(){t(!0);var O=r.action();O instanceof Promise?O.then(function(v){if(t(!1),v){typeof r.onSuccess=="function"&&r.onSuccess(v);var _="";r.messageSuccess?typeof r.messageSuccess=="function"?_=r.messageSuccess(v):_=r.messageSuccess.indexOf("notification.")==0?L(r.messageSuccess):r.messageSuccess:_=L("notification.finish"),r.asynced?B.info(_):B.success(_)}}).catch(function(v){t(!1),typeof r.onError=="function"&&r.onError(v)}):t(!1)};return r.confirm?(0,M.jsx)(f.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:L("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?L(r.confirm):r.confirm,onConfirm:C,okText:"Yes",cancelText:"No",onOpenChange:r.confirmOnOpenChange,children:(0,M.jsx)(E.ZP,{block:r.block,disabled:r.disabled,icon:!r.children&&h?void 0:r.icon,loading:h,danger:r.danger,type:r.type,children:r.children})}):(0,M.jsx)(j.Z,{title:r.tips,children:(0,M.jsx)(E.ZP,{block:r.block,style:r.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:r.disabled,icon:!r.children&&h?void 0:r.icon,loading:h,onClick:C,danger:r.danger,type:r.type,children:r.children})})}},94359:function(y,T,e){e.d(T,{Z:function(){return h}});var R=e(3089),i=e(98165),m=e(18429),f=e(8751),E=e(14313),j=e(30159),I=e(87740),M=e(50888),P=e(66309),r=e(83062),A=e(82346),s=e(85893);function h(t){var l=(0,s.jsx)(s.Fragment,{});if(t.status=="0"&&(l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(R.Z,{}),color:"default",children:"waiting"})),t.status=="10"&&(l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(i.Z,{spin:!0}),color:"processing",children:"processing"})),t.status=="20"&&(l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(m.Z,{}),color:"error",children:"error"})),t.status=="30"&&(l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(f.Z,{}),color:"success",children:"success"})),t.status=="running"||t.status=="healthy"){var L,c;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(E.Z,{}),color:"success",children:(L=t.message)!==null&&L!==void 0&&L.showInTag?(c=t.message)===null||c===void 0?void 0:c.content:t.status})}if(t.status=="paused"){var B,C;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(j.Z,{}),children:(B=t.message)!==null&&B!==void 0&&B.showInTag?(C=t.message)===null||C===void 0?void 0:C.content:t.status})}if(t.status=="waiting"||t.status=="starting"){var W,O;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(I.Z,{}),children:(W=t.message)!==null&&W!==void 0&&W.showInTag?(O=t.message)===null||O===void 0?void 0:O.content:t.status})}if(t.status=="deploying"){var v,_;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(M.Z,{}),color:"processing",children:(v=t.message)!==null&&v!==void 0&&v.showInTag?(_=t.message)===null||_===void 0?void 0:_.content:t.status})}if(t.status=="error"){var a,d;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(m.Z,{}),color:"error",children:(a=t.message)!==null&&a!==void 0&&a.showInTag?(d=t.message)===null||d===void 0?void 0:d.content:t.status})}if(t.status=="exited"||t.status=="dead"||t.status=="removing"||t.status=="restarting"||t.status=="unhealthy"||t.status=="created"){var u,D;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(m.Z,{}),color:"warning",children:(u=t.message)!==null&&u!==void 0&&u.showInTag?(D=t.message)===null||D===void 0?void 0:D.content:t.status})}if(t.link)return(0,s.jsx)(A.Link,{to:t.link,children:l});if(t.message){var o,n;return(0,s.jsx)(r.Z,{placement:(o=t.message.placement)!==null&&o!==void 0?o:"top",title:(n=t.message.title)!==null&&n!==void 0?n:t.message.content,children:l})}return l}},74344:function(y,T,e){var R=e(5574),i=e.n(R),m=e(37476),f=e(38345),E=e(82346),j=e(67294),I=e(54964),M=e(85893),P=(0,j.forwardRef)(function(r,A){(0,j.useImperativeHandle)(A,function(){return{start:function(){for(var _=arguments.length,a=new Array(_),d=0;d<_;d++)a[d]=arguments[d];C(a.join(":")),l(!0)},reset:function(){var _;(_=O.current)===null||_===void 0||_.clear(),l(!1)},show:function(_){var a,d;(a=O.current)===null||a===void 0||a.clear(),(d=O.current)===null||d===void 0||d.write(_),l(!0)}}});var s=(0,j.useState)(!1),h=i()(s,2),t=h[0],l=h[1],L=(0,j.useState)(""),c=i()(L,2),B=c[0],C=c[1],W=(0,E.useModel)("subscriber"),O=(0,j.useRef)();return W.addDataHandler("image:"+B,function(v){var _;(_=O.current)===null||_===void 0||_.write(v.data)}),(0,j.useEffect)(function(){var v;(v=O.current)===null||v===void 0||v.fit()},[]),(0,M.jsx)(m.Y,{modalProps:{forceRender:!0},title:"\u6784\u5EFA\u65E5\u5FD7",submitter:!1,width:1e3,onOpenChange:function(_){if(l(_),_){var a,d;(a=O.current)===null||a===void 0||a.clear(),(d=O.current)===null||d===void 0||d.fit()}},open:t,children:(0,M.jsx)(f.Z,{ghost:!0,children:(0,M.jsx)(I.Z,{showInModal:!0,width:"960px",height:"500px",ref:O})})})});T.Z=P},78451:function(y,T,e){e.d(T,{Z:function(){return m}});var R=e(67294),i=e(85893);function m(f){return(0,i.jsx)("span",{style:{width:f.width?f.width:"auto",wordBreak:"break-word"},children:f.content})}},54964:function(y,T,e){e.d(T,{a:function(){return s}});var R=e(5574),i=e.n(R),m=e(78267),f=e.n(m),E=e(75458),j=e.n(E),I=e(67294),M=e(12320),P=e.n(M),r=e(89629),A=e(85893),s={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},h=new M.Terminal(s),t=new E.SearchAddon,l=new m.FitAddon,L=(0,I.forwardRef)(function(c,B){var C,W=(0,I.useState)(!0),O=i()(W,2),v=O[0],_=O[1];return(0,I.useEffect)(function(){return window.addEventListener("resize",function(){c.showInModal||l.fit()}),c.style&&c.style.fontSize&&(h.options.fontSize=c.style.fontSize),h.loadAddon(l),h.loadAddon(t),h.open(document.getElementById(c.id?c.id:"terminal-container")),c.showInModal||l.fit(),function(){h.reset(),_(!0)}},[]),(0,I.useImperativeHandle)(B,function(){return{write:function(d){v&&(l.fit(),_(!1)),h.write(d)},clear:function(){h.clear()},getTerminal:function(){return h},findNext:function(d){t.findNext(d)},findPrev:function(d){t.findPrevious(d)},fit:function(){l.fit()},onData:function(d){return h.onData(d)}}}),(0,A.jsx)("div",{id:c.id?c.id:"terminal-container",style:{width:c.width?c.width:"100%",height:c.height?c.height:"500px",marginTop:(C=c.style)===null||C===void 0?void 0:C.marginTop}})});T.Z=L},24963:function(y,T,e){var R=e(67294),i=(0,R.createContext)({});T.Z=i},52548:function(y,T,e){e.r(T),e.d(T,{default:function(){return d}});var R=e(15009),i=e.n(R),m=e(99289),f=e.n(m),E=e(90078),j=e(78099),I=e(28036),M=e(42075),P=e(66309),r=e(96074),A=e(83062),s=e(25593),h=e(50136),t=e(82346),l=e(18148),L=e(94359),c=e(43425),B=e(45742),C=e(80821),W=e(67294),O=e(67255),v=e(78451),_=e(74344),a=e(85893);function d(){var u=(0,W.useRef)(),D=(0,W.useRef)();return(0,a.jsxs)(E._z,{header:{extra:[(0,a.jsx)(I.ZP,{type:"primary",children:(0,a.jsx)(t.Link,{to:"/image/create",children:"\u521B\u5EFA\u955C\u50CF"})},"create"),(0,a.jsx)(I.ZP,{children:"\u62C9\u53D6\u955C\u50CF"},"pull")]},children:[(0,a.jsx)(j.Z,{scroll:{x:"max-content"},actionRef:u,rowKey:"id",columns:[{title:"\u540D\u79F0",render:function(n,g,K,U){return(0,a.jsx)(M.Z,{direction:"vertical",style:{textAlign:"left"},children:g.title},g.id)}},{title:"\u6700\u65B0Tag",dataIndex:"tag",search:!1,render:function(n,g,K,U){return g.imageInfo?g.imageInfo.info.Id==""?(0,a.jsx)(P.Z,{children:"none"},"none"):(0,a.jsx)(M.Z,{direction:"vertical",style:{textAlign:"left"},children:g.imageInfo.info.RepoTags.map(function(x,Z){return(0,a.jsx)(P.Z,{color:"#2db7f5",children:x},Z)})},g.id):(0,a.jsx)(P.Z,{color:"#2db7f5",children:g.tag},g.id)}},{title:"\u955C\u50CFId",search:!1,copyable:!0,width:300,render:function(n,g,K,U,x){return(0,a.jsx)(v.Z,{content:g.imageInfo&&g.imageInfo.info.Id})}},{title:"\u6784\u5EFA\u72B6\u6001",width:150,ellipsis:!0,search:!1,render:function(n,g,K,U){return[(0,a.jsx)("div",{children:(0,a.jsx)(L.Z,{status:g.status},g.id)},g.id)]}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,fixed:"right",render:function(n,g,K,U){return(0,a.jsxs)(M.Z,{split:(0,a.jsx)(r.Z,{type:"vertical"}),children:[(0,a.jsx)(t.Link,{to:"/image/create?id="+g.id,type:"link",children:(0,a.jsx)(A.Z,{title:"\u518D\u6B21\u6784\u5EFA",children:(0,a.jsx)(c.Z,{})})},"rebuild"),(0,a.jsx)(s.Z.Link,{onClick:function(){var Z;(Z=D.current)===null||Z===void 0||Z.show(g.message)},children:(0,a.jsx)(A.Z,{title:"\u6784\u5EFA\u65E5\u5FD7",children:(0,a.jsx)(B.Z,{})})},"logs")]})}}],request:function(){var o=f()(i()().mark(function n(g,K,U){var x,Z,b;return i()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,l.Xn)({page:(x=g.current)!==null&&x!==void 0?x:1,pageSize:(Z=g.pageSize)!==null&&Z!==void 0?Z:10});case 2:return b=S.sent,S.abrupt("return",{data:b.data.list,success:!0,total:b.data.total});case 4:case"end":return S.stop()}},n)}));return function(n,g,K){return o.apply(this,arguments)}}(),pagination:(0,O.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(n){var g=n.selectedRowKeys;return(0,a.jsx)(M.Z,{size:16,children:(0,a.jsx)(C.Z,{danger:!0,type:"primary",action:function(){return(0,l.$q)({id:g})},onSuccess:function(){var U,x;return!((U=u.current)===null||U===void 0)&&U.reloadAndRest&&((x=u.current)===null||x===void 0||x.reloadAndRest()),!0},onError:function(){var U,x;return!((U=u.current)===null||U===void 0)&&U.reset&&((x=u.current)===null||x===void 0||x.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"})})},tableExtraRender:function(){return(0,a.jsx)(h.Z,{mode:"horizontal",selectedKeys:["build"],items:[{label:(0,a.jsx)(t.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,a.jsx)(t.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})}}),(0,a.jsx)(_.Z,{ref:D})]})}},18148:function(y,T,e){e.d(T,{$q:function(){return t},Fj:function(){return v},KG:function(){return j},KX:function(){return a},T8:function(){return s},Xn:function(){return r},ao:function(){return L},c5:function(){return W},c7:function(){return B}});var R=e(15009),i=e.n(R),m=e(99289),f=e.n(m),E=e(82346);function j(u){return I.apply(this,arguments)}function I(){return I=f()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/get-list",{method:"POST",data:D}));case 1:case"end":return n.stop()}},u)})),I.apply(this,arguments)}function M(u){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function u(D){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,request("/api/app/log/image-build",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),P.apply(this,arguments)}function r(u){return A.apply(this,arguments)}function A(){return A=f()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/get-list-build",{method:"POST",data:D}));case 1:case"end":return n.stop()}},u)})),A.apply(this,arguments)}function s(u){return h.apply(this,arguments)}function h(){return h=f()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,E.request)("/api/app/image/get-build-task",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),h.apply(this,arguments)}function t(u){return l.apply(this,arguments)}function l(){return l=f()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,E.request)("/api/app/image/delete-build-task",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),l.apply(this,arguments)}function L(u){return c.apply(this,arguments)}function c(){return c=f()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,E.request)("/api/app/image/image-delete",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),c.apply(this,arguments)}function B(){return C.apply(this,arguments)}function C(){return C=f()(i()().mark(function u(){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,E.request)("/api/app/image/image-prune",{method:"POST"});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},u)})),C.apply(this,arguments)}function W(){return O.apply(this,arguments)}function O(){return O=f()(i()().mark(function u(){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,E.request)("/api/app/image/build-prune",{method:"POST"});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},u)})),O.apply(this,arguments)}function v(u){return _.apply(this,arguments)}function _(){return _=f()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,E.request)("/api/app/image/update-title",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),_.apply(this,arguments)}function a(u){return d.apply(this,arguments)}function d(){return d=f()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/tag-sync",{method:"POST",data:D}));case 1:case"end":return n.stop()}},u)})),d.apply(this,arguments)}},67255:function(y,T,e){e.d(T,{O:function(){return R},j:function(){return i}});function R(){var m=localStorage.getItem("dpanel-pagesize");return m=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(m!=null?m:"20")}}function i(m){var f="dpanel-table-column-".concat(m),E={};if(localStorage.getItem(f)){var j;E=JSON.parse((j=localStorage.getItem(f))!==null&&j!==void 0?j:"{}")}return{defaultValue:E,onChange:function(M){localStorage.setItem("dpanel-table-column-".concat(m),JSON.stringify(M))}}}}}]);
