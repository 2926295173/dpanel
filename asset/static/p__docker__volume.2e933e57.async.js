"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9002],{80821:function(w,Z,e){e.d(Z,{Z:function(){return V}});var D=e(5574),d=e.n(D),p=e(24963),f=e(86738),E=e(28036),S=e(83062),U=e(67294),R=e(85893);function V(r){var Y=(0,U.useState)(!1),M=d()(Y,2),K=M[0],F=M[1],L=(0,U.useContext)(p.Z),A=L.lang,X=L.notice,T=L.message,N=function(){F(!0);var $=r.action();$ instanceof Promise?$.then(function(j){if(F(!1),j){typeof r.onSuccess=="function"&&r.onSuccess(j);var P="";r.messageSuccess?typeof r.messageSuccess=="function"?P=r.messageSuccess(j):P=r.messageSuccess.indexOf("notification.")==0?A(r.messageSuccess):r.messageSuccess:P=A("notification.finish"),r.asynced?T.info(P):T.success(P)}}).catch(function(j){F(!1),typeof r.onError=="function"&&r.onError(j)}):F(!1)};return r.confirm?(0,R.jsx)(f.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:A("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?A(r.confirm):r.confirm,onConfirm:N,okText:"Yes",cancelText:"No",children:(0,R.jsx)(E.ZP,{disabled:r.disabled,icon:r.icon,loading:K,danger:r.danger,type:r.type,children:r.children})}):(0,R.jsx)(S.Z,{title:r.tips,children:(0,R.jsx)(E.ZP,{style:r.ghost?{padding:0,height:"auto"}:{},disabled:r.disabled,icon:r.icon,loading:K,onClick:N,danger:r.danger,type:r.type,children:r.children})})}},78451:function(w,Z,e){e.d(Z,{Z:function(){return p}});var D=e(67294),d=e(85893);function p(f){return(0,d.jsx)("span",{style:{width:f.width?f.width:"auto",wordBreak:"break-word"},children:f.content})}},24963:function(w,Z,e){var D=e(67294),d=(0,D.createContext)({});Z.Z=d},86783:function(w,Z,e){e.r(Z),e.d(Z,{default:function(){return Oe}});var D=e(15009),d=e.n(D),p=e(99289),f=e.n(p),E=e(80821),S=e(78451),U=e(5574),R=e.n(U),V=e(24963),r=e(82346);function Y(i){return M.apply(this,arguments)}function M(){return M=f()(d()().mark(function i(v){return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/app/volume/get-list",{method:"POST",data:v}));case 1:case"end":return u.stop()}},i)})),M.apply(this,arguments)}function K(i){return F.apply(this,arguments)}function F(){return F=f()(d()().mark(function i(v){return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/app/volume/create",{method:"POST",data:v}));case 1:case"end":return u.stop()}},i)})),F.apply(this,arguments)}function L(i){return A.apply(this,arguments)}function A(){return A=f()(d()().mark(function i(v){return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,r.request)("/api/app/volume/prune",{method:"POST",data:v});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},i)})),A.apply(this,arguments)}function X(i){return T.apply(this,arguments)}function T(){return T=f()(d()().mark(function i(v){return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,r.request)("/api/app/volume/delete",{method:"POST",data:v});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},i)})),T.apply(this,arguments)}function N(i){return W.apply(this,arguments)}function W(){return W=f()(d()().mark(function i(v){return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/app/volume/get-detail",{method:"POST",data:v}));case 1:case"end":return u.stop()}},i)})),W.apply(this,arguments)}var $=e(184),j=e(5966),P=e(62370),te=e(86615),re=e(97462),ae=e(17186),ue=e(24739),le=e(28036),k=e(34041),y=e(67294),n=e(85893),ie=(0,y.forwardRef)(function(i,v){var O=(0,y.useState)(!1),u=R()(O,2),b=u[0],h=u[1],l=(0,y.useRef)(),a=(0,y.useContext)(V.Z),x=a.message,t=a.notice;return(0,y.useImperativeHandle)(v,function(){return{}}),(0,n.jsxs)($.a,{name:"create",title:"\u6DFB\u52A0\u5B58\u50A8\u5377",open:b,onOpenChange:function(c){h(c)},formRef:l,trigger:(0,n.jsx)(le.ZP,{type:"primary",children:"\u521B\u5EFA\u5B58\u50A8\u5377"}),onFinish:function(){var s=f()(d()().mark(function c(o){var m,g,H,C,J,Q;return d()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return C=[],o.otherOptions&&o.otherOptions.map(function(ne){C.push(ne.name+`
`+ne.value)}),I.next=4,K({name:o.name,driver:"local",type:o.type,nfsUrl:(m=o.nfsUrl)!==null&&m!==void 0?m:"",nfsMountPoint:(g=o.nfsMountPoint)!==null&&g!==void 0?g:"",nfsOptions:(H=o.nfsOptions)!==null&&H!==void 0?H:"",tmpfsOptions:o.tmpfsOptions,otherOptions:C});case 4:if(J=I.sent,!(J&&J.data&&J.data.info.Name!="")){I.next=10;break}return x.success("\u6DFB\u52A0\u5B58\u50A8\u5377\u6210\u529F"),i.onFinish&&i.onFinish(),(Q=l.current)===null||Q===void 0||Q.resetFields(),I.abrupt("return",!0);case 10:case"end":return I.stop()}},c)}));return function(c){return s.apply(this,arguments)}}(),children:[(0,n.jsx)(j.Z,{label:"\u540D\u79F0",name:"name",placeholder:"\u6307\u5B9A\u552F\u4E00\u5B58\u50A8\u5377\u540D\u79F0"}),(0,n.jsx)(P.Z,{label:"\u7C7B\u578B",name:"driver",children:(0,n.jsx)(k.Z,{defaultValue:"local",children:(0,n.jsx)(k.Z.Option,{value:"local",children:"local"})})}),(0,n.jsx)(te.Z.Group,{name:"type",label:"\u5B58\u50A8\u7C7B\u578B",valueEnum:{default:"\u9ED8\u8BA4",tmpfs:"tmpfs",nfs:"Nfs",nfs4:"Nfs4",other:"\u81EA\u5B9A\u4E49"},initialValue:"default"}),(0,n.jsx)(re.Z,{name:["type"],children:function(c){var o=c.type;if(o=="other")return(0,n.jsx)(ae.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:"\u5B58\u50A8"},copyIconProps:!1,min:0,children:(0,n.jsxs)(ue.UW,{children:[(0,n.jsx)(j.Z,{name:"name",label:"\u540D\u79F0",placeholder:"\u4F8B\u5982:mountpoint"}),(0,n.jsx)(j.Z,{name:"value",label:"\u503C",placeholder:"\u4F8B\u5982:/etc/path"})]})});if(o=="nfs"||o=="nfs4")return[(0,n.jsx)(j.Z,{label:"\u5730\u5740",name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:"\u914D\u7F6ENfs\u670D\u52A1\u5730\u5740,\u4F8B\u5982 my.nfs.com \u6216\u662F 172.16.1.13 "},"nfsUrl"),(0,n.jsx)(j.Z,{label:"\u6302\u8F7D\u70B9",name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"\u4F8B\u5982, /export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,n.jsx)(j.Z,{label:"\u914D\u7F6E",name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(o=="tmpfs")return[(0,n.jsx)(j.Z,{label:"\u914D\u7F6E",name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),se=ie,q=e(5251),_=e(38345),B=e(26412),oe=e(63490),z=e(66309),de=(0,y.forwardRef)(function(i,v){var O;(0,y.useImperativeHandle)(v,function(){return{showDetail:function(o){return f()(d()().mark(function m(){var g;return d()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,N({name:o});case 2:g=C.sent,l(!0),s(g.data);case 5:case"end":return C.stop()}},m)}))()}}});var u=(0,y.useState)(!1),b=R()(u,2),h=b[0],l=b[1],a=(0,y.useState)(),x=R()(a,2),t=x[0],s=x[1];return(0,n.jsxs)($.a,{title:"\u5B58\u50A8\u8BE6\u60C5",open:h,submitter:!1,onOpenChange:function(o){l(o),!o&&s(void 0)},children:[(0,n.jsx)(_.Z,{title:"\u5B58\u50A8\u8BE6\u60C5",ghost:!0,children:(0,n.jsxs)(B.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:[(0,n.jsx)(B.Z.Item,{label:"\u540D\u79F0",children:t==null?void 0:t.info.Name}),(0,n.jsx)(B.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:new Date((O=t==null?void 0:t.info.CreatedAt)!==null&&O!==void 0?O:"").toLocaleString()}),(0,n.jsx)(B.Z.Item,{label:"\u6302\u8F7D\u70B9",children:t==null?void 0:t.info.Mountpoint}),(0,n.jsx)(B.Z.Item,{label:"\u7C7B\u578B",children:t==null?void 0:t.info.Driver}),(t==null?void 0:t.info.Labels)&&(0,n.jsx)(B.Z.Item,{label:"Lables",children:(0,n.jsx)(B.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:(t==null?void 0:t.info.Labels)&&Object.keys(t==null?void 0:t.info.Labels).map(function(c){return(0,n.jsx)(B.Z.Item,{label:c,children:t.info.Labels[c]})})})})]})}),(0,n.jsx)(_.Z,{title:"\u4F7F\u7528\u5BB9\u5668",ghost:!0,children:(0,n.jsx)(oe.Z,{rowKey:"Id",columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"Name",render:function(o,m,g){return(0,n.jsx)(r.Link,{target:"_blank",to:"/app/detail/edit/".concat(m.Id),children:(0,q.fi)(m.Name,"/")})}},{title:"\u5BB9\u5668\u5185\u8DEF\u5F84",dataIndex:"Mount"},{title:"\u6743\u9650",render:function(o,m,g){return m.RW?(0,n.jsx)(z.Z,{children:"\u8BFB\u5199"}):(0,n.jsx)(z.Z,{children:"\u53EA\u8BFB"})}}],dataSource:t==null?void 0:t.inUseContainer,pagination:!1})})]})}),ce=de,fe=e(67255),me=e(36693),ve=e(43425),he=e(90078),xe=e(97269),ge=e(10641),G=e(42075),ee=e(25593),pe=e(84567),je=e(96074),ye=e(83062);function Oe(){var i=(0,y.useRef)(),v=(0,y.useRef)(),O=(0,y.useRef)(),u=(0,y.useContext)(V.Z),b=u.lang;return(0,n.jsxs)(he._z,{header:{extra:[(0,n.jsx)(se,{onFinish:function(){var l,a;!((l=i.current)===null||l===void 0)&&l.reloadAndRest&&((a=i.current)===null||a===void 0||a.reloadAndRest())}},"create"),(0,n.jsx)(E.Z,{action:function(){var l,a;return L({deleteAll:(l=(a=O.current)===null||a===void 0?void 0:a.getFieldValue("deleteAll"))!==null&&l!==void 0?l:!1})},onSuccess:function(){var l,a;return!((l=i.current)===null||l===void 0)&&l.reloadAndRest&&((a=i.current)===null||a===void 0||a.reloadAndRest()),!0},onError:function(){var l,a;return!((l=i.current)===null||l===void 0)&&l.reset&&((a=i.current)===null||a===void 0||a.reset()),!0},confirm:(0,n.jsx)(xe.A,{formRef:O,submitter:!1,children:(0,n.jsxs)(G.Z,{style:{width:280},direction:"vertical",children:[(0,n.jsx)(ee.Z.Text,{children:b("notification.confirm.title")}),(0,n.jsx)(P.Z,{name:"deleteAll",valuePropName:"checked",children:(0,n.jsx)(pe.Z,{children:"\u662F\u5426\u6E05\u7406\u975E\u533F\u540D\u5377\uFF1F"})})]})}),children:"\u6E05\u7406\u672A\u4F7F\u7528\u5B58\u50A8"})]},children:[(0,n.jsx)(ce,{ref:v}),(0,n.jsx)(ge.Z,{scroll:{x:"max-content"},rowKey:"Name",pagination:(0,fe.O)(),columns:[{title:"\u540D\u79F0",dataIndex:"Name",width:300,render:function(l,a,x,t,s){return(0,n.jsx)(S.Z,{content:a.Name})}},{title:"\u6240\u5C5E\u5BB9\u5668",ellipsis:!0,search:!1,render:function(l,a,x,t,s){return a.InUse?(0,n.jsx)(G.Z,{direction:"vertical",children:a.InUse.map(function(c){return(0,n.jsx)(r.Link,{target:"_blank",to:"/app/detail/edit/"+c.md5,children:(0,n.jsx)(z.Z,{color:"cyan",icon:(0,n.jsx)(me.Z,{}),children:(0,q.fi)(c.name,"/")})})})}):(0,n.jsx)(z.Z,{children:"\u672A\u4F7F\u7528"})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:"\u6302\u8F7D\u70B9",search:!1,width:250,dataIndex:"Mountpoint",render:function(l,a,x,t,s){return(0,n.jsx)(S.Z,{content:a.Mountpoint})}},{title:"\u521B\u5EFA\u65F6\u95F4",ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(l,a,x,t,s){return new Date(a.CreatedAt).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,fixed:"right",render:function(l,a,x,t,s){return(0,n.jsx)(G.Z,{split:(0,n.jsx)(je.Z,{type:"vertical"}),children:(0,n.jsx)(ee.Z.Link,{onClick:function(){var o;(o=v.current)===null||o===void 0||o.showDetail(a.Name)},children:(0,n.jsx)(ye.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(ve.Z,{})})})})}}],request:function(){var h=f()(d()().mark(function l(a,x,t){var s,c;return d()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,Y({name:a.name});case 2:return s=m.sent,c=[],s.data.inUse?c=s.data.list.map(function(g){return s.data.inUse&&s.data.inUse[g.Name]?g.InUse=s.data.inUse[g.Name]:g.InUse=void 0,g}):c=s.data.list,m.abrupt("return",{data:c,success:!0,total:s.data.list.length});case 6:case"end":return m.stop()}},l)}));return function(l,a,x){return h.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:i,tableAlertOptionRender:function(l){var a=l.selectedRowKeys;return(0,n.jsx)(G.Z,{size:16,children:(0,n.jsx)(E.Z,{danger:!0,type:"primary",action:function(){return X({name:a})},onSuccess:function(){var t,s;return!((t=i.current)===null||t===void 0)&&t.reloadAndRest&&((s=i.current)===null||s===void 0||s.reloadAndRest()),!0},onError:function(){var t,s;return!((t=i.current)===null||t===void 0)&&t.reset&&((s=i.current)===null||s===void 0||s.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"})})}})]})}},67255:function(w,Z,e){e.d(Z,{O:function(){return D},j:function(){return d}});function D(){var p=localStorage.getItem("dpanel-pagesize");return p=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(p!=null?p:"20")}}function d(p){var f="dpanel-table-column-".concat(p),E={};if(localStorage.getItem(f)){var S;E=JSON.parse((S=localStorage.getItem(f))!==null&&S!==void 0?S:"{}")}return{defaultValue:E,onChange:function(R){localStorage.setItem("dpanel-table-column-".concat(p),JSON.stringify(R))}}}}}]);
