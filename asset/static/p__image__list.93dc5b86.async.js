"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4214],{1912:function(z,j,e){e.d(j,{Z:function(){return R}});var I=e(87462),c=e(67294),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},l=m,F=e(84089),g=function(O,D){return c.createElement(F.Z,(0,I.Z)({},O,{ref:D,icon:l}))},T=c.forwardRef(g),R=T},28307:function(z,j,e){var I=e(5574),c=e.n(I),m=e(38345),l=e(97269),F=e(5966),g=e(64317),T=e(62370),R=e(14726),U=e(85265),O=e(42075),D=e(67294),y=e(80821),b=e(3393),Z=e(97961),L=e(92754),x=e(54006),r=e(85893),f=(0,D.forwardRef)(function(o,a){var Q=(0,D.useState)(!1),J=c()(Q,2),M=J[0],P=J[1],B=(0,D.useRef)(),W=(0,D.useRef)();return(0,D.useImperativeHandle)(a,function(){return{upgradeImage:function(v){var i;return P(!0),(i=B.current)===null||i===void 0||i.setFieldValue("imageUrl",v),(0,b.Gb)({tag:v,type:"pull"})},setImageName:function(v){var i;P(!0),(i=B.current)===null||i===void 0||i.setFieldValue("imageUrl",v)}}}),[(0,r.jsx)(R.ZP,{type:o.buttonType?o.buttonType:"default",onClick:function(){var v,i;o.onClick&&o.onClick(),P(!0),(v=B.current)===null||v===void 0||v.resetFields(),(i=W.current)===null||i===void 0||i.setStart("")},children:"\u62C9\u53D6\u955C\u50CF"},"remoteBtn"),(0,r.jsxs)(U.Z,{forceRender:!0,open:M,title:"\u4E0B\u8F7D\u8FDC\u7A0B\u955C\u50CF",width:800,onClose:function(){return P(!1)},footer:!1,children:[(0,r.jsx)(m.Z,{children:(0,r.jsxs)(O.Z,{direction:"vertical",size:"middle",children:[(0,r.jsxs)("div",{children:["1\u3001\u955C\u50CF\u540D\u79F0\u4E2D\u4E0D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C \u9ED8\u8BA4\u4ECE ",(0,r.jsx)("a",{href:"https://hub.docker.com/",target:"_blank",children:"docker hub"})," \u4E2D\u4E0B\u8F7D\uFF0C \u4F60\u53EF\u4EE5\u5728\u4E0A\u9762",(0,r.jsx)("a",{href:"https://hub.docker.com/search?q=",target:"_blank",children:"\u3010\u67E5\u627E\u3011"}),"\u9700\u8981\u7684\u955C\u50CF"]}),(0,r.jsxs)("div",{children:["2\u3001\u955C\u50CF\u4E2D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C\u8BF7\u786E",(0,r.jsx)(x.Link,{to:"/image/registry",children:"\u3010\u6DFB\u52A0\u3011"}),"\u8FC7\u8BE5\u4ED3\u5E93\uFF0C\u5E76\u6709 Pull \u6743\u9650"]}),(0,r.jsxs)("div",{children:["3\u3001\u53EF\u5728",(0,r.jsx)(x.Link,{to:"/image/registry",children:"\u3010\u4ED3\u5E93\u7BA1\u7406\u3011"}),"\u4E2D\u914D\u7F6E\u955C\u50CF\u7684\u52A0\u901F\u5730\u5740"]})]})}),(0,r.jsx)(m.Z,{title:"\u4E0B\u8F7D\u955C\u50CF",headerBordered:!0,children:(0,r.jsxs)(l.A,{submitter:!1,formRef:B,children:[(0,r.jsxs)(O.Z.Compact,{children:[(0,r.jsx)(F.Z,{width:400,name:"imageUrl",placeholder:"\u8BF7\u8F93\u5165\u955C\u50CF\u5730\u5740"}),(0,r.jsx)(g.Z,{name:"platform",style:{width:150},placeholder:"\u9ED8\u8BA4\u5F53\u524D\u67B6\u6784",options:Z.ii.map(function(A){return{label:A.name,value:A.name}})}),(0,r.jsx)(y.Z,{action:function(){var v,i,w,N,V,X=(v=(i=B.current)===null||i===void 0?void 0:i.getFieldValue("imageUrl"))!==null&&v!==void 0?v:"";return(w=W.current)===null||w===void 0||w.setStart(X),(0,b.Gb)({tag:X,type:"pull",platform:(N=(V=B.current)===null||V===void 0?void 0:V.getFieldValue("platform"))!==null&&N!==void 0?N:""})},onSuccess:function(v){var i;(i=W.current)===null||i===void 0||i.setFinish(),P(!1),o.onFinish&&o.onFinish(v.data.tag)},messageSuccess:function(v){var i="\u62C9\u53D6\u6210\u529F";return v.data.proxyUrl&&(i+="\uFF0C\u4F7F\u7528\u4EE3\u7406 "+v.data.proxyUrl),i},children:"\u62C9\u53D6\u955C\u50CF"})]}),(0,r.jsx)(T.Z,{label:"\u4E0B\u8F7D\u8FDB\u5EA6",children:(0,r.jsx)(L.Z,{ref:W})})]})})]},"remoteDrawer")]});j.Z=f},92754:function(z,j,e){var I=e(5574),c=e.n(I),m=e(67294),l=e(54006),F=e(38703),g=e(85893),T=(0,m.forwardRef)(function(R,U){var O=(0,m.useState)(""),D=c()(O,2),y=D[0],b=D[1];(0,m.useImperativeHandle)(U,function(){return{setFinish:function(){f({finish:{downloading:100,extracting:100}})},setStart:function(a){a&&b(a),f({start:{downloading:0,extracting:0}})}}});var Z=(0,l.useModel)("subscriber");Z.addDataHandler("image:pull:"+y,function(o){f(o.data)});var L=(0,m.useState)(),x=c()(L,2),r=x[0],f=x[1];return(0,m.useEffect)(function(){f({start:{downloading:0,extracting:0}})},[]),(0,g.jsx)(g.Fragment,{children:r&&Object.keys(r).map(function(o){return(0,g.jsx)(F.Z,{percent:r[o].downloading,success:{percent:r[o].extracting}},o)})})});j.Z=T},31810:function(z,j,e){e.r(j),e.d(j,{default:function(){return fe}});var I=e(19632),c=e.n(I),m=e(15009),l=e.n(m),F=e(99289),g=e.n(F),T=e(5574),R=e.n(T),U=e(90078),O=e(10641),D=e(37476),y=e(62370),b=e(5966),Z=e(31418),L=e(14726),x=e(25593),r=e(42075),f=e(66309),o=e(96074),a=e(83062),Q=e(84567),J=e(50136),M=e(67294),P=e(54006),B=e(18148),W=e(5251),A=e(80821),v=e(43425),i=e(87462),w=e(3803),N=e(84089),V=function(k,ee){return M.createElement(N.Z,(0,i.Z)({},k,{ref:ee,icon:w.Z}))},X=M.forwardRef(V),ae=X,se=e(58638),le=e(1912),oe=e(28307),ie=e(96042),q=e(67255),ce=e(24963),de=e(3393),me=e(93162),n=e(85893);function fe(){var Y=(0,M.useContext)(ce.Z),k=Y.message,ee=Y.notice,Fe=Y.lang,_=(0,M.useRef)(),ve=(0,M.useState)({force:!1}),te=R()(ve,2),he=te[0],pe=te[1],_e=Z.Z.useApp(),ge=(0,M.useState)(1),re=R()(ge,2),ne=re[0],Ee=re[1],ue=(0,M.useRef)();return(0,M.useEffect)(function(){var E;(E=_.current)===null||E===void 0||E.reload()},[ne]),(0,n.jsx)(U._z,{header:{extra:[(0,n.jsx)(P.Link,{to:"/image/create",children:(0,n.jsx)(L.ZP,{type:"primary",children:"\u521B\u5EFA&\u5BFC\u5165\u955C\u50CF"},"create")},"create"),(0,n.jsx)(oe.Z,{onFinish:function(){var d,t;!((d=_.current)===null||d===void 0)&&d.reloadAndRest&&((t=_.current)===null||t===void 0||t.reloadAndRest())}},"remote")]},children:(0,n.jsx)(O.Z,{scroll:{x:"max-content"},rowKey:"Id",columns:[{title:"\u540D\u79F0",dataIndex:"title",render:function(d,t,h,C,u){var s=t.Id.substring(7,19);return t.Title&&(s=t.Title),(0,n.jsx)(x.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u955C\u50CF\u5907\u6CE8\u540D\u79F0",onChange:function(){var p=g()(l()().mark(function $(G){var K;return l()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,(0,B.Fj)({tag:t.RepoTags[0],title:G});case 2:K=H.sent,Ee(ne+1),k.success("\u4FEE\u6539\u955C\u50CF\u540D\u79F0\u6210\u529F");case 5:case"end":return H.stop()}},$)}));function S($){return p.apply(this,arguments)}return S}()},children:(0,n.jsx)(P.Link,{to:"/image/detail/"+t.Id,children:s},"edit")},"title-".concat(h))}},{title:"Tag",dataIndex:"tag",render:function(d,t,h,C){return(0,n.jsx)(r.Z,{direction:"vertical",style:{textAlign:"left"},children:t.RepoTags.map(function(u,s){return(0,n.jsxs)(r.Z,{children:[(0,n.jsx)(f.Z,{color:"#2db7f5",children:(0,n.jsx)(x.Z.Text,{copyable:!0,title:u,style:{color:"#ffffff"},children:u},"tag-"+s)},"tag-".concat(s)),t.Containers>0&&(0,n.jsx)(f.Z,{color:"cyan",children:"\u4F7F\u7528\u4E2D"},"use-".concat(s))]},s)})},t.Id)}},{title:"\u67B6\u6784",width:80,search:!1,render:function(d,t,h,C,u){if(t.Labels&&t.Labels["com.dpanel.image.arch"])return(0,n.jsx)(f.Z,{children:t.Labels["com.dpanel.image.arch"]},"arch"+t.Id)}},{title:"\u5C3A\u5BF8",dataIndex:"size",ellipsis:!0,width:"120px",search:!1,sorter:function(d,t){return parseFloat(d.Size)-parseFloat(t.Size)},render:function(d,t,h,C){return(0,n.jsx)("div",{children:(0,W.FI)(parseFloat(t.Size))},t.Id)}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(d,t,h,C){return(0,n.jsx)("div",{children:(0,W.ZM)(t.Created*1e3)},t.Id)},sorter:function(d,t){return d.Created-t.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",render:function(d,t,h,C){return(0,n.jsxs)(r.Z,{split:(0,n.jsx)(o.Z,{type:"vertical"}),children:[(0,n.jsx)(P.Link,{to:"/image/detail/"+t.Id,children:(0,n.jsx)(a.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(v.Z,{})})},"edit"),(0,n.jsx)(P.Link,{to:"/app/create/image?imageId="+t.RepoTags[0],children:(0,n.jsx)(a.Z,{title:"\u521B\u5EFA\u5BB9\u5668",children:(0,n.jsx)(ae,{})})},"create")]})}}],request:function(){var E=g()(l()().mark(function d(t,h,C){var u;return l()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,B.KG)({tag:t.tag,title:t.title});case 2:if(u=p.sent,!(!u||!u.data||!u.data.list)){p.next=5;break}return p.abrupt("return",{data:[],success:!0,total:0});case 5:return u.data.list.map(function(S){var $="";S.RepoTags.map(function(G){u.data.title[G]&&($=u.data.title[G])}),S.Title=$}),p.abrupt("return",{data:u.data.list,success:!0,total:u.data.list.length});case 7:case"end":return p.stop()}},d)}));return function(d,t,h){return E.apply(this,arguments)}}(),pagination:(0,q.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:_,tableAlertOptionRender:function(d){var t=d.selectedRowKeys,h=d.selectedRows;return(0,n.jsxs)(r.Z,{size:16,children:[(0,n.jsx)(A.Z,{icon:(0,n.jsx)(se.Z,{}),action:function(){var u=[];return h.map(function(s){u.push.apply(u,c()(s.RepoTags))}),(0,de.Rb)({md5:u})},onSuccess:function(u){var s=h.map(function(S){return S.RepoTags[0]}),p=new Blob([u],{type:"application/tar"});(0,me.saveAs)(p,s.join("-")+".tar")},messageSuccess:"\u6279\u91CF\u5BFC\u51FA\u6210\u529F",children:"\u5BFC\u51FA"}),(0,n.jsxs)(D.Y,{formRef:ue,title:"\u6279\u91CF\u63A8\u9001\u955C\u50CF",trigger:(0,n.jsx)(L.ZP,{icon:(0,n.jsx)(le.Z,{}),children:"\u63A8\u9001"}),onFinish:function(){var C=g()(l()().mark(function u(s){var p,S,$;return l()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,(0,B.KX)({md5:t,registryId:s.registryId,newNamespace:s.newNamespace});case 2:return $=K.sent,(p=_.current)===null||p===void 0||p.reload(),!((S=_.current)===null||S===void 0)&&S.clearSelected&&_.current.clearSelected(),K.abrupt("return",!0);case 6:case"end":return K.stop()}},u)}));return function(u){return C.apply(this,arguments)}}(),children:[(0,n.jsx)(y.Z,{name:"registryId",hidden:!0}),(0,n.jsx)(y.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,n.jsxs)(n.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,n.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,n.jsx)(ie.Z,{multiple:!0,top:!0,onChangeList:function(u){var s;(s=ue.current)===null||s===void 0||s.setFieldValue("registryId",u.map(function(p){return p.id}))}})}),(0,n.jsx)(b.Z,{tooltip:"\u53EF\u4EE5\u901A\u8FC7\u6B64\u9879\u91CD\u65B0\u5B9A\u4E49\u547D\u540D\u7A7A\u95F4\uFF0Cdocker hub \u4E0D\u53D7\u8BE5\u914D\u7F6E\u7684\u5F71\u54CD\u3002 \u914D\u7F6E\u6B64\u9879\u540E mysql:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/mysql:latest\uFF0C dpanel/dpanel:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/dpanel:latest",label:"\u91CD\u5199\u975E\u5B98\u65B9\u4ED3\u5E93\u547D\u540D\u7A7A\u95F4",name:"newNamespace"})]}),(0,n.jsx)(A.Z,{danger:!0,type:"primary",action:function(){return(0,B.ao)({md5:t,force:he.force})},onSuccess:function(){var u,s;return!((u=_.current)===null||u===void 0)&&u.reloadAndRest&&((s=_.current)===null||s===void 0||s.reloadAndRest()),!0},onError:function(){var u,s;return!((u=_.current)===null||u===void 0)&&u.reset&&((s=_.current)===null||s===void 0||s.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",confirm:(0,n.jsxs)(r.Z,{style:{width:280},direction:"vertical",children:[(0,n.jsx)(x.Z.Text,{children:"\u5220\u9664\u955C\u50CF\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"}),(0,n.jsx)(Q.Z,{name:"deleteVolume",onChange:function(u){return pe({force:u.target.checked})},children:"\u5F3A\u5236\u5220\u9664\uFF1F"})]}),children:"\u6279\u91CF\u5220\u9664"})]})},tableExtraRender:function(){return(0,n.jsx)(J.Z,{mode:"horizontal",selectedKeys:["all"],items:[{label:(0,n.jsx)(P.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,n.jsx)(P.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})},toolBarRender:function(){return[(0,n.jsx)(A.Z,{action:function(){return(0,B.c7)()},onSuccess:function(){var t,h;return!((t=_.current)===null||t===void 0)&&t.reloadAndRest&&((h=_.current)===null||h===void 0||h.reloadAndRest()),!0},onError:function(){var t,h;return!((t=_.current)===null||t===void 0)&&t.reset&&((h=_.current)===null||h===void 0||h.reset()),!0},messageSuccess:"\u6E05\u9664\u6210\u529F",confirm:"\u662F\u5426\u6E05\u7406\u672A\u4F7F\u7528\u6216\u662F\u672A\u8FD0\u884C\u7684\u955C\u50CF",children:"\u6E05\u7406\u672A\u4F7F\u7528\u955C\u50CF"})]},columnsState:(0,q.j)("image-list")})})}},97961:function(z,j,e){e.d(j,{GH:function(){return D},MF:function(){return L},_2:function(){return b},fN:function(){return T},ii:function(){return g},vC:function(){return U}});var I=e(15009),c=e.n(I),m=e(99289),l=e.n(m),F=e(54006),g=[{name:"linux/amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"linux/arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"linux/i386",arch:"386",search:[]},{name:"linux/arm/v6",arch:"arm",search:[]},{name:"linux/arm/v7",arch:"arm",search:[]},{name:"linux/arm/v8",arch:"arm64",search:[]},{name:"linux/ppc64le",arch:"ppc64le",search:[]},{name:"linux/riscv64",arch:"riscv64",search:[]}];function T(r){return R.apply(this,arguments)}function R(){return R=l()(c()().mark(function r(f){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,F.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:f}));case 1:case"end":return a.stop()}},r)})),R.apply(this,arguments)}function U(r){return O.apply(this,arguments)}function O(){return O=l()(c()().mark(function r(f){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,F.request)("/api/app/image/import-by-container-tar",{method:"POST",data:f}));case 1:case"end":return a.stop()}},r)})),O.apply(this,arguments)}function D(r){return y.apply(this,arguments)}function y(){return y=l()(c()().mark(function r(f){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,F.request)("/api/app/image/import-by-image-tar",{method:"POST",data:f}));case 1:case"end":return a.stop()}},r)})),y.apply(this,arguments)}function b(r){return Z.apply(this,arguments)}function Z(){return Z=l()(c()().mark(function r(f){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,F.request)("/api/common/attach/delete",{method:"POST",data:f});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},r)})),Z.apply(this,arguments)}function L(){return x.apply(this,arguments)}function x(){return x=l()(c()().mark(function r(){return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,F.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return o.stop()}},r)})),x.apply(this,arguments)}},67255:function(z,j,e){e.d(j,{O:function(){return I},j:function(){return c}});function I(){var m,l=parseInt((m=localStorage.getItem("dpanel-pagesize"))!==null&&m!==void 0?m:"0");return{showSizeChanger:!0,defaultPageSize:l!=null?l:20}}function c(m){var l="dpanel-table-column-".concat(m),F={};if(localStorage.getItem(l)){var g;F=JSON.parse((g=localStorage.getItem(l))!==null&&g!==void 0?g:"{}")}return{defaultValue:F,onChange:function(R){localStorage.setItem("dpanel-table-column-".concat(m),JSON.stringify(R))}}}}}]);
