"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{1699:function(z,U,e){e.d(U,{u:function(){return I}});var b=e(9783),c=e.n(b),y=e(97857),C=e.n(y),V=e(67294),L=e(82346),g=e(40411),v=e(42075),r=e(85893),I=function(i){var n=(0,L.useAccess)(),d=Array.isArray(i.access)?i.access:[i.access],a,u=i.fallback;if(typeof i.children=="function"?(a=i.children(d.reduce(function(_,p){return C()(C()({},_),{},c()({},p,n[p]))},{})),a||(a=u)):d.every(function(_){return n[_]})?a=i.children:a=u,!u&&a&&i.showProTips&&n.canSeeEnableCe){if(n.canSeeEnableHiddenProTips)return null;a=(0,r.jsx)(g.Z,{offset:i.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:a})}if(!u&&a&&i.showProRibbonTips&&n.canSeeEnableCe){if(n.canSeeEnableHiddenProTips)return null;a=(0,r.jsx)(g.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:a})}return i.space?(0,r.jsx)(v.Z,C()(C()({},i.space),{},{children:a})):a}},80821:function(z,U,e){e.d(U,{Z:function(){return i}});var b=e(97857),c=e.n(b),y=e(5574),C=e.n(y),V=e(24963),L=e(36146),g=e(86738),v=e(83062),r=e(28036),I=e(67294),t=e(85893);function i(n){var d=(0,I.useState)(!1),a=C()(d,2),u=a[0],_=a[1],p=(0,I.useContext)(V.Z),Z=p.message,B=new L.Uo,N=function(){_(!0);var J=n.action();J instanceof Promise?J.then(function(R){if(_(!1),R){typeof n.onSuccess=="function"&&n.onSuccess(R);var x="";n.messageSuccess?typeof n.messageSuccess=="function"?x=n.messageSuccess(R):x=n.messageSuccess.indexOf("notification.")==0?B.format(n.messageSuccess):n.messageSuccess:x=B.format("notification.finish"),n.asynced?Z.info(x):Z.success(x)}}).catch(function(R){_(!1),typeof n.onError=="function"&&n.onError(R)}):_(!1)};return n.confirm?(0,t.jsx)(g.Z,c()(c()({style:{width:500},title:n.confirmTitle?n.confirmTitle:B.format("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?B.format(n.confirm):n.confirm,onConfirm:N,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,t.jsx)(v.Z,{title:n.tips,children:(0,t.jsx)(r.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&u?void 0:n.icon,loading:u,danger:n.danger,type:n.type,children:n.children})})})):(0,t.jsx)(v.Z,{title:n.tips,children:(0,t.jsx)(r.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&u?void 0:n.icon,loading:u,onClick:N,danger:n.danger,type:n.type,children:n.children})})}},44349:function(z,U,e){var b=e(97857),c=e.n(b),y=e(17186),C=e(5966),V=e(86250),L=e(67294),g=e(85893),v=(0,L.forwardRef)(function(r,I){var t=(0,L.useRef)();(0,L.useImperativeHandle)(I,function(){return{addItem:function(d,a){var u,_=(u=t.current)===null||u===void 0?void 0:u.getList(),p=!1;if(_==null||_.map(function(B){if(B.name==d){p=!0;return}}),!p){var Z;(Z=t.current)===null||Z===void 0||Z.add({name:d,value:a})}},clear:function(){var d;(d=t.current)===null||d===void 0||(d=d.getList())===null||d===void 0||d.map(function(a,u){var _;(_=t.current)===null||_===void 0||_.remove(u)})}}});var i={};return r.hideCopyButton===!0&&(i.copyIconProps=!1),r.hideDeleteButton===!0&&(i.deleteIconProps=!1),(0,g.jsx)(y.u,c()(c()({initialValue:r.initialValue,label:r.label,name:r.name,actionRef:t,creatorButtonProps:r.showAddButton?{creatorButtonText:r.label?r.label:r.name}:!1,min:r.min?r.min:0},i),{},{children:function(d,a,u){return(0,g.jsx)(V.Z,{justify:r.justify,gap:r.gap,children:r.items.map(function(_){return _.render?(0,g.jsx)("div",{children:_.render&&_.render(d,a,u)},"".concat(r.name,"-").concat(_.name,"-").concat(d.key)):(0,g.jsx)(C.Z,{width:_.width,name:_.name,label:_.label,required:_.required,rules:[{required:_.required}],disabled:_.disabled,placeholder:_.placeholder},"".concat(r.name,"-").concat(_.name,"-").concat(d.key))})})}}))});U.Z=v},36435:function(z,U,e){var b=e(15009),c=e.n(b),y=e(64599),C=e.n(y),V=e(99289),L=e.n(V),g=e(9783),v=e.n(g),r=e(5574),I=e.n(r),t=e(67294),i=e(184),n=e(38345),d=e(97269),a=e(97321),u=e(97462),_=e(64317),p=e(5966),Z=e(86615),B=e(68602),N=e(28036),s=e(83403),J=e(24963),R=e(1699),x=e(29177),H=e(45742),ee=e(43425),ne=e(44349),_e=e(3616),Q=e(36146),O=e(85893),k=(0,t.forwardRef)(function(S,X){var q=(0,t.useState)(!1),w=I()(q,2),K=w[0],P=w[1],M=(0,t.useRef)(),W=(0,t.useContext)(J.Z),G=W.message,l=(0,t.useState)([]),T=I()(l,2),Y=T[0],te=T[1],A=new Q.Uo("components.permissionButton"),ae=v()(v()(v()(v()(v()({},s.W6.CONTAINER,"Id"),s.W6.APPSTORE,"name"),s.W6.COMPOSE,"name"),s.W6.REGISTRY,"serverAddress"),s.W6.DOCKER_ENV,"name"),le=v()(v()(v()(v()(v()({},s.W6.CONTAINER,"name"),s.W6.APPSTORE,"name"),s.W6.COMPOSE,"name"),s.W6.REGISTRY,"title"),s.W6.DOCKER_ENV,"title"),re=ae[S.type],oe=le[S.type],ie=S.selected.map(function(m){return m[ae[S.type]]});return t.useEffect(function(){if(K){if(!S.selected||S.selected.length==0){G.error(Q.FD.format("message.noDataSelect")),P(!1);return}(0,B.dP)({permission:{uri:S.type,key:re,value:ie}}).then(function(m){var o;(o=M.current)===null||o===void 0||o.setFieldValue("list",Object.keys(m.data.list).map(function(E){return{name:E,type:m.data.list[E].type,users:m.data.list[E].users}}))}),(0,B.lE)().then(function(m){var o,E=(o=m.data)===null||o===void 0||(o=o.list)===null||o===void 0?void 0:o.map(function(f){return{label:f.username,value:f.username}});te(E)})}},[K]),(0,O.jsx)(R.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,O.jsxs)(i.a,{name:"create",title:A.format("drawerTitle"),open:K,onOpenChange:function(o){if(!o){var E;(E=M.current)===null||E===void 0||E.resetFields()}P(o)},drawerProps:{forceRender:!0,width:_e.R_},formRef:M,trigger:(0,O.jsx)(N.ZP,{icon:(0,O.jsx)(x.Z,{}),children:A.format("drawerTriggerButton")}),onFinish:function(){var m=L()(c()().mark(function o(E){var f,j,D;return c()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:f=C()(E.list),h.prev=1,f.s();case 3:if((j=f.n()).done){h.next=9;break}return D=j.value,h.next=7,(0,B.Db)({usernames:D.users,permissionType:D.type,permission:{uri:S.type,key:re,showKey:oe,value:[D.name]}});case 7:h.next=3;break;case 9:h.next=14;break;case 11:h.prev=11,h.t0=h.catch(1),f.e(h.t0);case 14:return h.prev=14,f.f(),h.finish(14);case 17:G.success(Q.FD.format("finish")),P(!1),S.onSuccess();case 20:case"end":return h.stop()}},o,null,[[1,11,14,17]])}));return function(o){return m.apply(this,arguments)}}(),children:[(0,O.jsxs)(n.Z,{ghost:!0,title:(0,O.jsx)(H.Z,{}),subTitle:A.format("batchTitle"),children:[(0,O.jsx)(d.A.Item,{name:"type",style:{marginBottom:0},children:(0,O.jsx)(a.Z.Group,{defaultValue:"admin",onChange:function(o){var E,f,j=(E=M.current)===null||E===void 0?void 0:E.getFieldValue("list");j.forEach(function(D){D.type=o,D.users=[]}),(f=M.current)===null||f===void 0||f.setFieldValue("list",j)},children:["admin","restricted","public"].map(function(m){return(0,O.jsx)(a.Z,{style:{width:240},title:A.format("dataTypeOption.".concat(m)),description:A.format("dataTypeOptionDesc.".concat(m)),value:m},m)})})}),(0,O.jsx)(u.Z,{name:["type"],children:function(o){var E=o.type;if(E==="restricted")return(0,O.jsx)(_.Z,{mode:"multiple",name:"usernames",label:A.format("formUsernames"),onChange:function(j){var D,F,h=(D=M.current)===null||D===void 0?void 0:D.getFieldValue("list");h.forEach(function($){$.users=j}),(F=M.current)===null||F===void 0||F.setFieldValue("list",h)},rules:[{required:!0}],request:L()(c()().mark(function f(){var j,D,F;return c()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(!(Y.length>0)){$.next=2;break}return $.abrupt("return",Y);case 2:return $.next=4,(0,B.lE)();case 4:return D=$.sent,F=(j=D.data)===null||j===void 0||(j=j.list)===null||j===void 0?void 0:j.map(function(se){return{label:se.username,value:se.username}}),te(F),$.abrupt("return",F);case 8:case"end":return $.stop()}},f)}))})}})]}),(0,O.jsx)(n.Z,{ghost:!0,title:(0,O.jsx)(ee.Z,{}),subTitle:A.format("dataTitle"),children:(0,O.jsx)(ne.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:A.format("dataName"),render:function(o,E,f){var j=f.getCurrentRowData();return(0,O.jsx)(p.Z,{disabled:!0,label:A.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:A.format("dataType"),render:function(o,E,f){var j=f.getCurrentRowData();return(0,O.jsx)(Z.Z.Group,{label:A.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(D){return{label:A.format("dataTypeOption.".concat(D)),value:D}})})}},{name:"users",label:A.format("dataUsers"),render:function(o,E,f){return(0,O.jsx)(u.Z,{name:["type"],children:function(D){var F=D.type;if(F=="restricted")return(0,O.jsx)(_.Z,{width:"sm",mode:"tags",name:"users",label:A.format("dataUsers"),options:Y})}})}}]})})]})})});U.Z=k},3616:function(z,U,e){e.d(U,{Ed:function(){return C},FK:function(){return c},R_:function(){return b},ob:function(){return y}});var b=window.innerWidth<=1024?"90vw":"65vw",c="90vw",y="60vw",C="50vh"},24963:function(z,U,e){var b=e(67294),c=(0,b.createContext)({});U.Z=c},64312:function(z,U,e){e.r(U),e.d(U,{default:function(){return J}});var b=e(15009),c=e.n(b),y=e(99289),C=e.n(y),V=e(80821),L=e(77273),g=e(36435),v=e(83403),r=e(24963),I=e(87662),t=e(36146),i=e(86548),n=e(90078),d=e(78099),a=e(82346),u=e(28036),_=e(42075),p=e(96074),Z=e(25593),B=e(83062),N=e(67294),s=e(85893);function J(){var R=(0,N.useRef)(),x=(0,N.useRef)(),H=(0,a.useModel)("@@initialState"),ee=H.initialState,ne=H.loading,_e=H.error,Q=H.refresh,O=H.setInitialState,k=(0,N.useContext)(r.Z),S=k.message,X=(0,a.useLocation)(),q=(0,a.useNavigate)(),w=new t.Uo("system.env");return(0,N.useEffect)(function(){var K=X.state;if(K&&K.item){var P;(P=x.current)===null||P===void 0||P.edit(K.item)}},[X.state]),(0,s.jsx)(n._z,{header:{extra:[(0,s.jsx)(L.Z,{trigger:(0,s.jsx)(u.ZP,{type:"primary",children:w.format("createButton")}),ref:x,onFinish:C()(c()().mark(function K(){var P,M,W;return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(W=X.state,!(W&&W.item)){l.next=6;break}return l.next=4,(0,I.vC)({name:W.item.name});case 4:return q(X.pathname,{replace:!0,state:null}),l.abrupt("return");case 6:Q(),!((P=R.current)===null||P===void 0)&&P.reloadAndRest&&((M=R.current)===null||M===void 0||M.reloadAndRest());case 8:case"end":return l.stop()}},K)}))},"dockerEnvCreate")]},children:(0,s.jsx)(d.Z,{rowKey:"name",columns:[{title:t.FD.format("listName"),dataIndex:"name"},{title:t.FD.format("listTitle"),dataIndex:"title"},{title:t.FD.format("listTargetAddress"),dataIndex:"address"},{title:t.FD.format("listManage"),width:100,search:!1,render:function(P,M,W,G,l){return(0,s.jsx)(_.Z,{split:(0,s.jsx)(p.Z,{type:"vertical"}),children:(0,s.jsx)(Z.Z.Link,{onClick:function(){var Y;(Y=x.current)===null||Y===void 0||Y.edit(M)},children:(0,s.jsx)(B.Z,{title:t.FD.format("listManageEdit"),children:(0,s.jsx)(i.Z,{})})},M.name)})}}],pagination:!1,request:C()(c()().mark(function K(){var P;return c()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,(0,I.Kg)();case 2:return P=W.sent,W.abrupt("return",{data:P.data.list,total:P.data.list.length});case 4:case"end":return W.stop()}},K)})),search:!1,rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:R,tableAlertOptionRender:function(P){var M=P.selectedRows,W=P.selectedRowKeys;return(0,s.jsxs)(_.Z,{size:16,children:[(0,s.jsx)(g.Z,{type:v.W6.DOCKER_ENV,selected:M,onSuccess:function(){var l,T;return!((l=R.current)===null||l===void 0)&&l.reloadAndRest&&((T=R.current)===null||T===void 0||T.reloadAndRest()),!0}},"permissionButton"),(0,s.jsx)(V.Z,{danger:!0,type:"primary",action:function(){return M.find(function(l){return l.default})?(S.warning(t.FD.format("systemEnvDefaultCannotDelete")),!1):(0,I._g)({name:W})},onSuccess:function(){var l,T;return!((l=R.current)===null||l===void 0)&&l.reloadAndRest&&((T=R.current)===null||T===void 0||T.reloadAndRest()),!0},onError:function(){var l,T;return!((l=R.current)===null||l===void 0)&&l.reset&&((T=R.current)===null||T===void 0||T.reset()),!0},confirm:"notification.confirm.title",children:t.FD.format("listManageDeleteBatch")})]})}})})}}}]);
