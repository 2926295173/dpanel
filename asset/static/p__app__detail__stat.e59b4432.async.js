"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7745],{16664:function(C,g,e){e.d(g,{Z:function(){return p}});var M=e(87462),i=e(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},n=D,_=e(84089),d=function(m,E){return i.createElement(_.Z,(0,M.Z)({},m,{ref:E,icon:n}))},o=i.forwardRef(d),p=o},27619:function(C,g,e){e.d(g,{Z:function(){return P}});var M=e(97857),i=e.n(M),D=e(19632),n=e.n(D),_=e(5574),d=e.n(_),o=e(64183),p=e(54006),v=e(9361),m=e(67294),E=e(85893);function P(a){var f,F=(0,m.useState)("academy"),y=d()(F,2),T=y[0],U=y[1],O=Math.max.apply(Math,n()(a.data.map(function(W){var I;return(I=W[a.yField])!==null&&I!==void 0?I:0}))),l=(0,p.useAntdConfig)(),s={xField:a.xField,yField:a.yField,height:200,axis:{y:{line:!0},x:{line:!0,grid:{visable:!0},labelAutoRotate:!0}},style:{opacity:.4},tooltip:{channel:"y",valueFormatter:a.yLabelFormatter},scale:{y:{domainMin:(f=a.yDomainMin)!==null&&f!==void 0?f:0,domainMax:a.yDomainMax?a.yDomainMax:a.yDomainMaxCallback?a.yDomainMaxCallback(O):O}},data:a.data};return a.yLabelFormatter&&(s.axis.y.labelFormatter=a.yLabelFormatter),a.colorField&&(s.colorField=a.colorField),(0,m.useEffect)(function(){var W=l.theme.algorithm;W.includes(v.Z.darkAlgorithm)?U("classicDark"):U("academy")},[l]),(0,E.jsx)(o.Z,i()({theme:T},s))}},71890:function(C,g,e){var M=e(15009),i=e.n(M),D=e(99289),n=e.n(D),_=e(67294);function d(o){var p=o.reqFunction,v=o.interval,m=o.maxPolling,E=o.pollingStatus,P=o.inPath,a=(0,_.useRef)(null),f=0,F=function T(){a.current=window.setTimeout(n()(i()().mark(function U(){var O;return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(f++>=m)){s.next=3;break}return y(),s.abrupt("return");case 3:if(s.prev=3,!(P&&window.location.href.indexOf(P)==-1)){s.next=7;break}return y(),s.abrupt("return");case 7:return s.next=9,p();case 9:O=s.sent,T(),s.next=17;break;case 13:s.prev=13,s.t0=s.catch(3),y(),console.error("\u8F6E\u8BE2\u53D1\u751F\u9519\u8BEF\uFF1A",s.t0);case 17:case"end":return s.stop()}},U,null,[[3,13]])})),v)},y=function(){console.log("end polling"),a.current&&window.clearTimeout(a.current)};return(0,_.useEffect)(function(){return console.log((E?"start":"waiting")+" polling, max "+m),E&&F(),function(){y()}},[v,m,E]),{endPolling:y}}g.Z=d},24963:function(C,g,e){var M=e(67294),i=(0,M.createContext)({});g.Z=i},11386:function(C,g,e){e.r(g),e.d(g,{default:function(){return I}});var M=e(15009),i=e.n(M),D=e(99289),n=e.n(D),_=e(5574),d=e.n(_),o=e(19632),p=e.n(o),v=e(27619),m=e(71890),E=e(24963),P=e(84410),a=e(5251),f=e(12122),F=e(16664),y=e(38345),T=e(54006),U=e(63490),O=e(67294),l=e(85893),s=new Date().toLocaleTimeString(),W={total:0,memory:[{date:s,usage:0,source:{usage:0,limit:0}}],cpu:[{date:s,usage:0}],network:[{usage:0,type:"rx",date:s,source:{usage:0}},{usage:0,type:"tx",date:s,source:{usage:0}}],io:[{usage:0,type:"read",date:s,source:{usage:0}},{usage:0,type:"write",date:s,source:{usage:0}}]};function I(){var w=function(r,t){switch(t.type){case"update":var h=new Date(t.payload.read).toLocaleTimeString(),c=t.payload.cpu_stats.cpu_usage.total_usage-t.payload.precpu_stats.cpu_usage.total_usage,A=t.payload.cpu_stats.system_cpu_usage-t.payload.precpu_stats.system_cpu_usage,j=0,V=0;t.payload.blkio_stats.io_service_bytes_recursive||(t.payload.blkio_stats.io_service_bytes_recursive=[{value:0,op:"read",major:0,minor:0},{value:0,op:"write",major:0,minor:0}]),t.payload.blkio_stats.io_service_bytes_recursive.map(function(L){L.op=="read"&&(j=L.value),L.op=="write"&&(V=L.value)});var Z={total:r.total+1,memory:[].concat(p()(r.memory),[{date:h,usage:Math.round(t.payload.memory_stats.usage),source:{usage:t.payload.memory_stats.usage,limit:t.payload.memory_stats.limit}}]),cpu:[].concat(p()(r.cpu),[{date:h,usage:c/A*t.payload.cpu_stats.online_cpus*100}]),io:[].concat(p()(r.io),[{date:h,usage:parseFloat(t.payload.blkio_stats.io_service_bytes_recursive[0].value.toFixed(2)),type:t.payload.blkio_stats.io_service_bytes_recursive[0].op,source:{usage:t.payload.blkio_stats.io_service_bytes_recursive[0].value}},{date:h,usage:parseFloat(t.payload.blkio_stats.io_service_bytes_recursive[1].value.toFixed(2)),type:t.payload.blkio_stats.io_service_bytes_recursive[1].op,source:{usage:t.payload.blkio_stats.io_service_bytes_recursive[1].value}}]),network:[]};return t.payload.networks&&(Z.network=[].concat(p()(r.network),[{date:h,usage:parseFloat(t.payload.networks.eth0.rx_bytes.toFixed(2)),type:"rx",source:{usage:t.payload.networks.eth0.rx_bytes}},{date:h,usage:parseFloat(t.payload.networks.eth0.tx_bytes.toFixed(2)),type:"tx",source:{usage:t.payload.networks.eth0.tx_bytes}}])),Z}},z=(0,O.useContext)(E.Z),B=z.loading,R=(0,T.useParams)(),$=(0,O.useReducer)(w,W),K=d()($,2),u=K[0],G=K[1],H=(0,O.useState)(0),S=d()(H,2),Y=S[0],N=S[1],J=(0,O.useState)(),k=d()(J,2),x=k[0],Q=k[1],X=(0,m.Z)({reqFunction:function(){var b=n()(i()().mark(function t(){var h,c;return i()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,P.i)({id:(h=R.id)!==null&&h!==void 0?h:""});case 2:c=j.sent,B.destroy(),G({type:"update",payload:c});case 5:case"end":return j.stop()}},t)}));function r(){return b.apply(this,arguments)}return r}(),interval:3e3,maxPolling:999,pollingStatus:Y!=0,inPath:"tab=stat"});return(0,O.useEffect)(function(){var b,r;B.show(),(0,P.i)({id:(b=R.id)!==null&&b!==void 0?b:""}).then(function(t){return N(Math.round(t.memory_stats.limit)),!0}),(0,P.a)({id:(r=R.id)!==null&&r!==void 0?r:""}).then(function(t){var h={columns:[],data:[]};t.data.list.Titles.map(function(c){h.columns.push({title:c,label:c,dataIndex:c})}),t.data.list.Processes.map(function(c,A){h.data.push({UID:c[0],PID:c[1],PPID:c[2],C:c[3],STIME:c[4],TTY:c[5],TIME:c[6],CMD:c[7]})}),Q(h)})},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(y.Z,{direction:"row",wrap:!0,gutter:[20,20],children:[(0,l.jsx)(y.Z,{colSpan:12,title:(0,l.jsx)(f.Z,{}),subTitle:"Memory usage: ".concat((0,a.FI)(u.memory[u.memory.length-1].source.usage)," / ").concat((0,a.FI)(u.memory[u.memory.length-1].source.limit)),headerBordered:!0,bordered:!0,children:(0,l.jsx)(v.Z,{yField:"usage",xField:"date",data:u.memory,yDomainMaxCallback:function(r){return r*2},yLabelFormatter:function(r){return(0,a.FI)(parseFloat(r))}})}),(0,l.jsx)(y.Z,{colSpan:12,title:(0,l.jsx)(f.Z,{}),subTitle:"Cpu usage: ".concat(u.cpu[u.cpu.length-1].usage.toFixed(2),"%"),headerBordered:!0,bordered:!0,children:(0,l.jsx)(v.Z,{yField:"usage",xField:"date",data:u.cpu,yDomainMaxCallback:function(r){return r*1.5},yLabelFormatter:function(r){return"".concat(r,"%")}})}),(0,l.jsx)(y.Z,{colSpan:12,title:(0,l.jsx)(f.Z,{}),subTitle:"I/O: ".concat((0,a.FI)(u.io[u.io.length-1].source.usage)," / ").concat((0,a.FI)(u.io[u.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,l.jsx)(v.Z,{yField:"usage",xField:"date",colorField:"type",data:u.io,yDomainMaxCallback:function(r){return r*2},yLabelFormatter:function(r){return(0,a.FI)(parseFloat(r))}})}),u.network&&u.network.length>0&&(0,l.jsx)(y.Z,{colSpan:12,title:(0,l.jsx)(f.Z,{}),subTitle:"Network: ".concat((0,a.FI)(u.network[u.io.length-1].source.usage)," / ").concat((0,a.FI)(u.network[u.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,l.jsx)(v.Z,{yField:"usage",xField:"date",colorField:"type",data:u.network,yDomainMaxCallback:function(r){return r*2},yLabelFormatter:function(r){return(0,a.FI)(parseFloat(r))}})})]}),(0,l.jsx)(y.Z,{title:(0,l.jsx)(F.Z,{}),subTitle:"Progress",children:(0,l.jsx)(U.Z,{scroll:{x:"max-content"},rowKey:"PID",columns:x==null?void 0:x.columns,dataSource:x==null?void 0:x.data,pagination:{pageSize:10}})})]})}},84410:function(C,g,e){e.d(g,{a:function(){return p},i:function(){return d}});var M=e(15009),i=e.n(M),D=e(99289),n=e.n(D),_=e(54006);function d(m){return o.apply(this,arguments)}function o(){return o=n()(i()().mark(function m(E){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,_.request)("/api/app/container/get-stat-info",{method:"POST",data:E}));case 1:case"end":return a.stop()}},m)})),o.apply(this,arguments)}function p(m){return v.apply(this,arguments)}function v(){return v=n()(i()().mark(function m(E){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,_.request)("/api/app/container/get-process-info",{method:"POST",data:E}));case 1:case"end":return a.stop()}},m)})),v.apply(this,arguments)}},5251:function(C,g,e){e.d(g,{FI:function(){return i},ZM:function(){return D}});function M(n){return n.trim()}function i(n){var _="";n<.1*1024?_=n.toFixed(2)+"B":n<.1*1024*1024?_=(n/1024).toFixed(2)+"KB":n<1*1024*1024*1024?_=(n/(1024*1024)).toFixed(2)+"MB":_=(n/(1024*1024*1024)).toFixed(2)+"GB";var d=_+"",o=d.indexOf("."),p=d.substring(o+1,o+3);return p=="00"?d.substring(0,o)+d.substr(o+3,2):_}function D(n){if(n){var _=new Date(n),d=_.getFullYear()+"-",o=(_.getMonth()+1<10?"0"+(_.getMonth()+1):_.getMonth()+1)+"-",p=(_.getDate()<10?"0"+_.getDate():_.getDate())+" ",v=(_.getHours()<10?"0"+_.getHours():_.getHours())+":",m=(_.getMinutes()<10?"0"+_.getMinutes():_.getMinutes())+":",E=_.getSeconds()<10?"0"+_.getSeconds():_.getSeconds();return d+o+p+v+m+E}}}}]);
