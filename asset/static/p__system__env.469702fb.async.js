"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{1699:function(k,Z,e){e.d(Z,{u:function(){return L}});var H=e(9783),W=e.n(H),Y=e(97857),g=e.n(Y),z=e(67294),F=e(82346),N=e(40411),D=e(42075),p=e(85893),L=function(a){var A=(0,F.useAccess)(),n=Array.isArray(a.access)?a.access:[a.access],r,c=a.fallback;if(typeof a.children=="function"?(r=a.children(n.reduce(function(j,E){return g()(g()({},j),{},W()({},E,A[E]))},{})),r||(r=c)):n.every(function(j){return A[j]})?r=a.children:r=c,!c&&r&&a.showProTips&&A.canSeeEnableCe){if(A.canSeeEnableHiddenProTips)return null;r=(0,p.jsx)(N.Z,{offset:a.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:r})}if(!c&&r&&a.showProRibbonTips&&A.canSeeEnableCe){if(A.canSeeEnableHiddenProTips)return null;r=(0,p.jsx)(N.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:r})}return a.space?(0,p.jsx)(D.Z,g()(g()({},a.space),{},{children:r})):r}},80821:function(k,Z,e){e.d(Z,{Z:function(){return A}});var H=e(97857),W=e.n(H),Y=e(5574),g=e.n(Y),z=e(24963),F=e(36146),N=e(86738),D=e(83062),p=e(96074),L=e(83622),o=e(67294),a=e(85893);function A(n){var r=(0,o.useState)(!1),c=g()(r,2),j=c[0],E=c[1],s=(0,o.useContext)(z.Z),i=s.message,l=new F.Uo,_=function(){E(!0);var M=n.action();M instanceof Promise?M.then(function(f){if(E(!1),f){typeof n.onSuccess=="function"&&n.onSuccess(f);var B="";n.messageSuccess?typeof n.messageSuccess=="function"?B=n.messageSuccess(f):B=n.messageSuccess.indexOf("notification.")==0?l.format(n.messageSuccess):n.messageSuccess:B=l.format("notification.finish"),n.asynced?i.info(B):i.success(B)}}).catch(function(f){E(!1),typeof n.onError=="function"&&n.onError(f)}):E(!1)};return n.confirm?(0,a.jsx)(N.Z,W()(W()({style:{width:500},title:n.confirmTitle?n.confirmTitle:l.format("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?l.format(n.confirm):n.confirm,onConfirm:_,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,a.jsxs)(D.Z,{title:n.tips,children:[n.showDivider&&(0,a.jsx)(p.Z,{type:"vertical",style:{marginRight:15}}),(0,a.jsx)(L.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&j?void 0:n.icon,loading:j,danger:n.danger,type:n.type,children:n.children})]})})):(0,a.jsxs)(D.Z,{title:n.tips,children:[n.showDivider&&(0,a.jsx)(p.Z,{type:"vertical",style:{marginRight:15}}),(0,a.jsx)(L.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&j?void 0:n.icon,loading:j,onClick:_,danger:n.danger,type:n.type,children:n.children})]})}},44349:function(k,Z,e){var H=e(97857),W=e.n(H),Y=e(15009),g=e.n(Y),z=e(99289),F=e.n(z),N=e(74763),D=e(17186),p=e(5966),L=e(86250),o=e(67294),a=e(85893),A=(0,o.forwardRef)(function(n,r){var c=(0,o.useRef)();(0,o.useImperativeHandle)(r,function(){return{addItem:function(E){function s(i,l,_){return E.apply(this,arguments)}return s.toString=function(){return E.toString()},s}(function(E,s,i){var l,_=(l=c.current)===null||l===void 0?void 0:l.getList(),T;if(_==null||_.forEach(function(B,J){B[E]==s[E]&&(T=J)}),!(0,N.k)(T)&&i){var M;(M=c.current)===null||M===void 0||M.remove(T),T=void 0}if(!T){var f;(f=c.current)===null||f===void 0||f.add(s)}}),removeItemByKey:function(s,i){return F()(g()().mark(function l(){var _,T;return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return T=(_=c.current)===null||_===void 0?void 0:_.getList(),T==null||T.forEach(function(B,J){if(B[s]==i){var $;($=c.current)===null||$===void 0||$.remove(J);return}}),f.abrupt("return");case 3:case"end":return f.stop()}},l)}))()},clear:function(s){if(!s){var i;s=(i=c.current)===null||i===void 0||(i=i.getList())===null||i===void 0?void 0:i.map(function(_,T){return T})}if(s){var l;(l=c.current)===null||l===void 0||l.remove(s)}},getList:function(){var s;return(s=c.current)===null||s===void 0?void 0:s.getList()}}});var j={};return n.hideCopyButton===!0&&(j.copyIconProps=!1),n.hideDeleteButton===!0&&(j.deleteIconProps=!1),(0,a.jsx)(D.u,W()(W()({initialValue:n.initialValue,label:n.label,name:n.name,actionRef:c,creatorButtonProps:n.showAddButton?{creatorButtonText:n.label?n.label:n.showAddButtonLabel?n.showAddButtonLabel:n.name}:!1,min:n.min?n.min:0},j),{},{children:function(s,i,l){return(0,a.jsx)(L.Z,{justify:n.justify,gap:n.gap,children:n.items.map(function(_){return _.render?(0,a.jsx)("div",{children:_.render&&_.render(s,i,l)},"".concat(n.name,"-").concat(_.name,"-").concat(s.key)):(0,a.jsx)(p.Z,{width:_.width,name:_.name,label:_.label,required:_.required,rules:[{required:_.required}],disabled:_.disabled,placeholder:_.placeholder},"".concat(n.name,"-").concat(_.name,"-").concat(s.key))})})}}))});Z.Z=A},36435:function(k,Z,e){var H=e(15009),W=e.n(H),Y=e(64599),g=e.n(Y),z=e(99289),F=e.n(z),N=e(9783),D=e.n(N),p=e(5574),L=e.n(p),o=e(67294),a=e(184),A=e(38345),n=e(97269),r=e(97321),c=e(97462),j=e(64317),E=e(5966),s=e(86615),i=e(68602),l=e(83622),_=e(83403),T=e(24963),M=e(1699),f=e(29177),B=e(1883),J=e(43425),$=e(44349),q=e(3616),X=e(36146),d=e(85893),w=(0,o.forwardRef)(function(S,I){var C=(0,o.useState)(!1),U=L()(C,2),m=U[0],x=U[1],t=(0,o.useRef)(),K=(0,o.useContext)(T.Z),Q=K.message,re=(0,o.useState)([]),ne=L()(re,2),ee=ne[0],_e=ne[1],y=new X.Uo("components.permissionButton"),te=D()(D()(D()(D()(D()({},_.W6.CONTAINER,"Id"),_.W6.APPSTORE,"name"),_.W6.COMPOSE,"name"),_.W6.REGISTRY,"serverAddress"),_.W6.DOCKER_ENV,"name"),le=D()(D()(D()(D()(D()({},_.W6.CONTAINER,"name"),_.W6.APPSTORE,"name"),_.W6.COMPOSE,"name"),_.W6.REGISTRY,"title"),_.W6.DOCKER_ENV,"title"),ae=te[S.type],oe=le[S.type],ie=S.selected.map(function(v){return v[te[S.type]]});return o.useEffect(function(){if(m){if(!S.selected||S.selected.length==0){Q.error(X.FD.format("message.noDataSelect")),x(!1);return}(0,i.dP)({permission:{uri:S.type,key:ae,value:ie}}).then(function(v){var u;(u=t.current)===null||u===void 0||u.setFieldValue("list",Object.keys(v.data.list).map(function(O){return{name:O,type:v.data.list[O].type,users:v.data.list[O].users}}))}),(0,i.lE)().then(function(v){var u,O=(u=v.data)===null||u===void 0||(u=u.list)===null||u===void 0?void 0:u.map(function(P){return{label:P.username,value:P.username}});_e(O)})}},[m]),(0,d.jsx)(M.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,d.jsxs)(a.a,{name:"create",title:y.format("drawerTitle"),open:m,onOpenChange:function(u){if(!u){var O;(O=t.current)===null||O===void 0||O.resetFields()}x(u)},drawerProps:{forceRender:!0,width:q.R_},formRef:t,trigger:(0,d.jsx)(l.ZP,{icon:(0,d.jsx)(f.Z,{}),children:y.format("drawerTriggerButton")}),onFinish:function(){var v=F()(W()().mark(function u(O){var P,b,h;return W()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:P=g()(O.list),R.prev=1,P.s();case 3:if((b=P.n()).done){R.next=9;break}return h=b.value,R.next=7,(0,i.Db)({usernames:h.users,permissionType:h.type,permission:{uri:S.type,key:ae,showKey:oe,value:[h.name]}});case 7:R.next=3;break;case 9:R.next=14;break;case 11:R.prev=11,R.t0=R.catch(1),P.e(R.t0);case 14:return R.prev=14,P.f(),R.finish(14);case 17:Q.success(X.FD.format("finish")),x(!1),S.onSuccess();case 20:case"end":return R.stop()}},u,null,[[1,11,14,17]])}));return function(u){return v.apply(this,arguments)}}(),children:[(0,d.jsxs)(A.Z,{ghost:!0,title:(0,d.jsx)(B.Z,{}),subTitle:y.format("batchTitle"),children:[(0,d.jsx)(n.A.Item,{name:"type",style:{marginBottom:0},children:(0,d.jsx)(r.Z.Group,{defaultValue:"admin",onChange:function(u){var O,P,b=(O=t.current)===null||O===void 0?void 0:O.getFieldValue("list");b.forEach(function(h){h.type=u,h.users=[]}),(P=t.current)===null||P===void 0||P.setFieldValue("list",b)},children:["admin","restricted","public"].map(function(v){return(0,d.jsx)(r.Z,{style:{width:240},title:y.format("dataTypeOption.".concat(v)),description:y.format("dataTypeOptionDesc.".concat(v)),value:v},v)})})}),(0,d.jsx)(c.Z,{name:["type"],children:function(u){var O=u.type;if(O==="restricted")return(0,d.jsx)(j.Z,{mode:"multiple",name:"usernames",label:y.format("formUsernames"),onChange:function(b){var h,V,R=(h=t.current)===null||h===void 0?void 0:h.getFieldValue("list");R.forEach(function(G){G.users=b}),(V=t.current)===null||V===void 0||V.setFieldValue("list",R)},rules:[{required:!0}],request:F()(W()().mark(function P(){var b,h,V;return W()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(!(ee.length>0)){G.next=2;break}return G.abrupt("return",ee);case 2:return G.next=4,(0,i.lE)();case 4:return h=G.sent,V=(b=h.data)===null||b===void 0||(b=b.list)===null||b===void 0?void 0:b.map(function(se){return{label:se.username,value:se.username}}),_e(V),G.abrupt("return",V);case 8:case"end":return G.stop()}},P)}))})}})]}),(0,d.jsx)(A.Z,{ghost:!0,title:(0,d.jsx)(J.Z,{}),subTitle:y.format("dataTitle"),children:(0,d.jsx)($.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:y.format("dataName"),render:function(u,O,P){var b=P.getCurrentRowData();return(0,d.jsx)(E.Z,{disabled:!0,label:y.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:y.format("dataType"),render:function(u,O,P){var b=P.getCurrentRowData();return(0,d.jsx)(s.Z.Group,{label:y.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(h){return{label:y.format("dataTypeOption.".concat(h)),value:h}})})}},{name:"users",label:y.format("dataUsers"),render:function(u,O,P){return(0,d.jsx)(c.Z,{name:["type"],children:function(h){var V=h.type;if(V=="restricted")return(0,d.jsx)(j.Z,{width:"sm",mode:"tags",name:"users",label:y.format("dataUsers"),options:ee})}})}}]})})]})})});Z.Z=w},98163:function(k,Z,e){e.r(Z),e.d(Z,{default:function(){return T}});var H=e(15009),W=e.n(H),Y=e(99289),g=e.n(Y),z=e(80821),F=e(77273),N=e(36435),D=e(83403),p=e(24963),L=e(87662),o=e(36146),a=e(86548),A=e(90078),n=e(56729),r=e(82346),c=e(83622),j=e(42075),E=e(96074),s=e(25593),i=e(83062),l=e(67294),_=e(85893);function T(){var M=(0,l.useRef)(),f=(0,l.useRef)(),B=(0,r.useModel)("@@initialState"),J=B.refresh,$=B.initialState,q=(0,l.useContext)(p.Z),X=q.message,d=(0,r.useLocation)(),w=(0,r.useNavigate)(),S=new o.Uo("system.env");return(0,l.useEffect)(function(){var I=d.state;if(I){if(w(".",{replace:!0}),I&&I.item){var C;(C=f.current)===null||C===void 0||C.edit(I.item)}if(I&&I.name){var U,m,x=$==null||(U=$.dockerEnv)===null||U===void 0?void 0:U.list.find(function(t){return t.name==I.name});x&&((m=f.current)===null||m===void 0||m.edit(x))}}},[d.state]),(0,_.jsx)(A._z,{header:{extra:[(0,_.jsx)(F.Z,{trigger:(0,_.jsx)(c.ZP,{type:"primary",children:S.format("createButton")}),ref:f,onFinish:g()(W()().mark(function I(){var C,U,m;return W()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(m=d.state,!(m&&m.item)){t.next=6;break}return t.next=4,(0,L.vC)({name:m.item.name});case 4:return w(d.pathname,{replace:!0,state:null}),t.abrupt("return");case 6:J(),!((C=M.current)===null||C===void 0)&&C.reloadAndRest&&((U=M.current)===null||U===void 0||U.reloadAndRest());case 8:case"end":return t.stop()}},I)}))},"dockerEnvCreate")]},children:(0,_.jsx)(n.Z,{rowKey:"name",columns:[{title:o.FD.format("listName"),dataIndex:"name"},{title:o.FD.format("listTitle"),dataIndex:"title"},{title:o.FD.format("listTargetAddress"),dataIndex:"address"},{title:o.FD.format("listManage"),width:100,search:!1,render:function(C,U,m,x,t){return(0,_.jsx)(j.Z,{split:(0,_.jsx)(E.Z,{type:"vertical"}),children:(0,_.jsx)(s.Z.Link,{onClick:function(){var Q;(Q=f.current)===null||Q===void 0||Q.edit(U)},children:(0,_.jsx)(i.Z,{title:o.FD.format("listManageEdit"),children:(0,_.jsx)(a.Z,{})})},U.name)})}}],pagination:!1,request:g()(W()().mark(function I(){var C;return W()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,L.Kg)({enableCertContent:!0});case 2:return C=m.sent,m.abrupt("return",{data:C.data.list,total:C.data.list.length});case 4:case"end":return m.stop()}},I)})),search:!1,rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:M,tableAlertOptionRender:function(C){var U=C.selectedRows,m=C.selectedRowKeys;return(0,_.jsxs)(j.Z,{size:16,children:[(0,_.jsx)(N.Z,{type:D.W6.DOCKER_ENV,selected:U,onSuccess:function(){var t,K;return!((t=M.current)===null||t===void 0)&&t.reloadAndRest&&((K=M.current)===null||K===void 0||K.reloadAndRest()),!0}},"permissionButton"),(0,_.jsx)(z.Z,{danger:!0,type:"primary",action:function(){return U.find(function(t){return t.default})?(X.warning(o.FD.format("systemEnvDefaultCannotDelete")),!1):(0,L._g)({name:m})},onSuccess:function(){var t,K;return!((t=M.current)===null||t===void 0)&&t.reloadAndRest&&((K=M.current)===null||K===void 0||K.reloadAndRest()),!0},onError:function(){var t,K;return!((t=M.current)===null||t===void 0)&&t.reset&&((K=M.current)===null||K===void 0||K.reset()),!0},confirm:"notification.confirm.title",children:o.FD.format("listManageDeleteBatch")})]})}})})}}}]);
