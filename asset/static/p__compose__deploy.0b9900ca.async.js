"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7667],{33160:function(ee,L,e){e.d(L,{Z:function(){return T}});var u=e(87462),d=e(67294),M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},j=M,y=e(84089),B=function(l,P){return d.createElement(y.Z,(0,u.Z)({},l,{ref:P,icon:j}))},p=d.forwardRef(B),T=p},99861:function(ee,L,e){var u=e(15009),d=e.n(u),M=e(64599),j=e.n(M),y=e(99289),B=e.n(y),p=e(5574),T=e.n(p),v=e(42119),l=e(67294),P=e(92754),r=e(3393),S=e(184),n=e(38345),s=e(85893),Z=(0,l.forwardRef)(function(_,C){(0,l.useImperativeHandle)(C,function(){return{start:function(){return k(!0),g()},finish:function(){k(!1)}}});var O=(0,l.useState)(0),D=T()(O,2),m=D[0],f=D[1],o=(0,l.useRef)(),R=(0,l.useState)(!1),b=T()(R,2),te=b[0],k=b[1],g=function(){var E=B()(d()().mark(function A(){var x,F,U,W,G,H,q;return d()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:F=0,U=j()(_.image),I.prev=2,U.s();case 4:if((W=U.n()).done){I.next=14;break}return H=W.value,f(F),(G=o.current)===null||G===void 0||G.setStart(H),I.next=10,(0,r.Gb)({tag:H,type:"pull"});case 10:q=I.sent,F++;case 12:I.next=4;break;case 14:I.next=19;break;case 16:I.prev=16,I.t0=I.catch(2),U.e(I.t0);case 19:return I.prev=19,U.f(),I.finish(19);case 22:(x=o.current)===null||x===void 0||x.setFinish(),f(F);case 24:case"end":return I.stop()}},A,null,[[2,16,19,22]])}));return function(){return E.apply(this,arguments)}}();return(0,s.jsxs)(S.a,{trigger:_.trigger,width:800,open:te,submitter:!1,title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",onOpenChange:function(){var E=B()(d()().mark(function A(x){return d()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:k(x),x&&_.trigger&&g();case 2:case"end":return U.stop()}},A)}));return function(A){return E.apply(this,arguments)}}(),drawerProps:{forceRender:!0},children:[(0,s.jsx)(n.Z,{children:(0,s.jsx)(v.Z,{current:m,items:_.image.map(function(E,A){return{title:E,key:A}})})}),(0,s.jsx)(n.Z,{children:(0,s.jsx)(P.Z,{ref:o})})]})});L.Z=Z},57165:function(ee,L,e){e.d(L,{Z:function(){return T}});var u=e(5574),d=e.n(u),M=e(89035),j=e(63713),y=e(83062),B=e(67294),p=e(85893);function T(v){var l=(0,B.useState)({height:800,width:1024}),P=d()(l,2),r=P[0],S=P[1],n=function(){var _=window.innerWidth,C=window.innerHeight;S({height:C,width:_})};(0,B.useEffect)(function(){window.addEventListener("resize",function(){n()}),n()},[v]);var s=v.query?Object.keys(v.query).map(function(Z){return"".concat(Z,"=").concat(v.query[Z])}):[];return(0,p.jsx)(j.Link,{target:"_blank",to:"/console/"+v.container+"?width=".concat(r.width,"&height=").concat(r.height,"&").concat(s.join("&")),children:(0,p.jsxs)(y.Z,{title:v.tips?v.tips:"\u7EC8\u7AEF",children:[(0,p.jsx)(M.Z,{})," ",v.content]})})}},80821:function(ee,L,e){e.d(L,{Z:function(){return v}});var u=e(5574),d=e.n(u),M=e(24963),j=e(86738),y=e(28036),B=e(83062),p=e(67294),T=e(85893);function v(l){var P=(0,p.useState)(!1),r=d()(P,2),S=r[0],n=r[1],s=(0,p.useContext)(M.Z),Z=s.lang,_=s.notice,C=s.message,O=function(){n(!0),l.action().then(function(m){if(n(!1),typeof l.onSuccess=="function"&&l.onSuccess(m),l.messageSuccess){var f="";typeof l.messageSuccess=="function"?f=l.messageSuccess(m):f=l.messageSuccess,f=Z("notification.".concat(f))+Z("notification.title.success"),l.asynced?C.info(f):C.success(f)}}).catch(function(m){n(!1),typeof l.onError=="function"&&l.onError(m)})};return l.confirm?(0,T.jsx)(j.Z,{style:{width:500},title:l.confirmTitle?l.confirmTitle:Z("notification.title.tip"),description:l.confirm,onConfirm:O,okText:"Yes",cancelText:"No",children:(0,T.jsx)(y.ZP,{disabled:l.disabled,icon:l.icon,loading:S,danger:l.danger,type:l.type,children:l.children})}):(0,T.jsx)(B.Z,{title:l.tips,children:(0,T.jsx)(y.ZP,{disabled:l.disabled,icon:l.icon,loading:S,onClick:O,danger:l.danger,type:l.type,children:l.children})})}},37413:function(ee,L,e){e.d(L,{Z:function(){return S}});var u=e(19632),d=e.n(u),M=e(27496),j=e(35995),y=e(99611),B=e(29158),p=e(38345),T=e(55241),v=e(42075),l=e(66309),P=e(67294),r=e(85893);function S(n){return(0,r.jsx)(T.Z,{placement:"right",content:(0,r.jsxs)(p.Z,{direction:"column",style:{width:500},ghost:!0,children:[(0,r.jsx)(p.Z,{title:"\u7AEF\u53E3",children:[].concat(d()(n.publicPort),d()(n.privatePort)).map(function(s,Z){var _=n.serverIp;if(_!=""&&_.indexOf("http")===-1&&_.indexOf(":")>-1&&(_="[".concat(_,"]")),_==""){var C=document.location.protocol+"//"+document.location.hostname;_=C}return _==""&&(_=s.IP),(0,r.jsx)(v.Z,{size:"large",wrap:!0,children:(0,r.jsx)(l.Z,{color:s.PublicPort?"#2db7f5":"warning",icon:s.PublicPort?(0,r.jsx)(M.Z,{}):"",style:{marginBottom:5,width:210},children:s.PublicPort?(0,r.jsx)("a",{href:"".concat(_.indexOf("http")===0?_:"http://"+_,":").concat(s.PublicPort),target:"_blank",children:"".concat(s.PublicPort?s.IP+":"+s.PublicPort+" -> ":"").concat(s.PrivatePort,"/").concat(s.Type)},"link".concat(Z)):"".concat(s.PrivatePort,"/").concat(s.Type)})},"space".concat(Z))})}),n.domain.length>0&&(0,r.jsx)(p.Z,{title:"\u57DF\u540D",children:(0,r.jsx)(v.Z,{direction:"vertical",style:{textAlign:"left"},children:n.domain.map(function(s,Z){return(0,r.jsx)(l.Z,{color:"blue",icon:(0,r.jsx)(M.Z,{}),children:(0,r.jsx)("a",{href:s,target:"_blank",children:s})},"domain".concat(Z))})})})]}),children:(0,r.jsxs)(v.Z,{direction:"vertical",children:[n.privatePort.length>0&&(0,r.jsxs)(l.Z,{color:"warning",icon:(0,r.jsx)(j.Z,{}),children:["\u5185\u90E8\u7AEF\u53E3: ",n.privatePort.length]}),n.publicPort.length>0&&(0,r.jsxs)(l.Z,{color:"#2db7f5",icon:(0,r.jsx)(y.Z,{}),children:["\u5BF9\u5916\u7AEF\u53E3: ",n.publicPort.length]}),n.domain.length>0&&(0,r.jsxs)(l.Z,{color:"blue",icon:(0,r.jsx)(B.Z,{}),children:["\u7ED1\u5B9A\u57DF\u540D: ",n.domain.length]})]})})}},94359:function(ee,L,e){e.d(L,{Z:function(){return S}});var u=e(67294),d=e(3089),M=e(98165),j=e(18429),y=e(8751),B=e(14313),p=e(30159),T=e(87740),v=e(66309),l=e(83062),P=e(63713),r=e(85893);function S(n){var s=(0,r.jsx)(r.Fragment,{});if(n.status=="0"&&(s=(0,r.jsx)(v.Z,{icon:(0,r.jsx)(d.Z,{}),color:"default",children:"waiting"})),n.status=="10"&&(s=(0,r.jsx)(v.Z,{icon:(0,r.jsx)(M.Z,{spin:!0}),color:"processing",children:"processing"})),n.status=="20"&&(s=(0,r.jsx)(v.Z,{icon:(0,r.jsx)(j.Z,{}),color:"error",children:"error"})),n.status=="30"&&(s=(0,r.jsx)(v.Z,{icon:(0,r.jsx)(y.Z,{}),color:"success",children:"success"})),n.status=="running"||n.status=="healthy"){var Z,_;s=(0,r.jsx)(v.Z,{icon:(0,r.jsx)(B.Z,{}),color:"success",children:(Z=n.message)!==null&&Z!==void 0&&Z.showInTag?(_=n.message)===null||_===void 0?void 0:_.content:n.status})}if(n.status=="paused"){var C,O;s=(0,r.jsx)(v.Z,{icon:(0,r.jsx)(p.Z,{}),children:(C=n.message)!==null&&C!==void 0&&C.showInTag?(O=n.message)===null||O===void 0?void 0:O.content:n.status})}if(n.status=="waiting"||n.status=="starting"){var D,m;s=(0,r.jsx)(v.Z,{icon:(0,r.jsx)(T.Z,{}),children:(D=n.message)!==null&&D!==void 0&&D.showInTag?(m=n.message)===null||m===void 0?void 0:m.content:n.status})}if(n.status=="exited"||n.status=="dead"||n.status=="removing"||n.status=="restarting"||n.status=="unhealthy"||n.status=="created"){var f,o;s=(0,r.jsx)(v.Z,{icon:(0,r.jsx)(j.Z,{}),color:"warning",children:(f=n.message)!==null&&f!==void 0&&f.showInTag?(o=n.message)===null||o===void 0?void 0:o.content:n.status})}if(n.link&&(s=(0,r.jsx)(P.Link,{to:n.link,children:s})),n.message){var R;s=(0,r.jsx)(l.Z,{placement:(R=n.message.placement)!==null&&R!==void 0?R:"top",title:n.message.content,children:s})}return(0,r.jsx)(r.Fragment,{children:s})}},92754:function(ee,L,e){var u=e(5574),d=e.n(u),M=e(67294),j=e(63713),y=e(38703),B=e(85893),p=(0,M.forwardRef)(function(T,v){var l=(0,M.useState)(""),P=d()(l,2),r=P[0],S=P[1];(0,M.useImperativeHandle)(v,function(){return{setFinish:function(){C({finish:{downloading:100,extracting:100}})},setStart:function(D){D&&S(D),C({start:{downloading:0,extracting:0}})}}});var n=(0,j.useModel)("subscriber");n.addDataHandler("image:pull:"+r,function(O){C(O.data)});var s=(0,M.useState)(),Z=d()(s,2),_=Z[0],C=Z[1];return(0,M.useEffect)(function(){C({start:{downloading:0,extracting:0}})},[]),(0,B.jsx)(B.Fragment,{children:_&&Object.keys(_).map(function(O){return(0,B.jsx)(y.Z,{percent:_[O].downloading,success:{percent:_[O].extracting}},O)})})});L.Z=p},78451:function(ee,L,e){e.d(L,{Z:function(){return M}});var u=e(67294),d=e(85893);function M(j){return(0,d.jsx)("span",{style:{width:j.width?j.width:"auto",wordBreak:"break-word"},children:j.content})}},54964:function(ee,L,e){e.d(L,{a:function(){return l}});var u=e(78267),d=e.n(u),M=e(75458),j=e.n(M),y=e(67294),B=e(12320),p=e.n(B),T=e(89629),v=e(85893),l={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},P=new B.Terminal(l),r=new M.SearchAddon,S=new u.FitAddon,n=(0,y.forwardRef)(function(s,Z){return(0,y.useEffect)(function(){window.addEventListener("resize",function(){s.showInModal||S.fit()}),s.style&&s.style.fontSize&&(P.options.fontSize=s.style.fontSize),P.loadAddon(S),P.loadAddon(r),P.open(document.getElementById("terminal-container")),s.showInModal||S.fit()},[]),(0,y.useImperativeHandle)(Z,function(){return{write:function(C){P.write(C)},clear:function(){P.clear()},getTerminal:function(){return P},findNext:function(C){r.findNext(C)},findPrev:function(C){r.findPrevious(C)},fit:function(){S.fit()},onData:function(C){P.onData(C)}}}),(0,v.jsx)("div",{id:"terminal-container",style:{width:s.width?s.width:"100%",height:s.height?s.height:"500px"}})});L.Z=n},9740:function(ee,L,e){e.r(L),e.d(L,{default:function(){return Q}});var u=e(15009),d=e.n(u),M=e(99289),j=e.n(M),y=e(19632),B=e.n(y),p=e(5574),T=e.n(p),v=e(80821),l=e(54964),P=e(90098),r=e(43425),S=e(74842),n=e(48689),s=e(33160),Z=e(87784),_=e(30159),C=e(86548),O=e(89035),D=e(45742),m=e(90078),f=e(38345),o=e(97269),R=e(62370),b=e(63713),te=e(28036),k=e(42075),g=e(25593),E=e(84567),A=e(96074),x=e(63490),F=e(83062),U=e(92398),W=e(67294),G=e(99861),H=e(95089),q=e(95213),ne=e(24963),I=e(91058),ce=e(12320),xe=e(89629),_e=e(78267),t=e(85893),X=new ce.Terminal(l.a),re=new _e.FitAddon;function ve(V){var oe=(0,b.useModel)("subscriber");return oe.addDataHandler("compose:log:"+V.id,function(Ee){X.write(Ee.data)}),(0,W.useEffect)(function(){return window.addEventListener("resize",function(){re.fit()}),X.options.fontSize=12,X.loadAddon(re),X.open(document.getElementById("terminal-log")),re.fit(),X.clear(),function(){oe.progress.close("compose:log:"+V.id)}},[V.id]),(0,t.jsx)("div",{id:"terminal-log",style:{width:"100%",height:"500px"}})}var De=e(37413),Ce=e(87662),ye=e(94359),ge=e(57165),Fe=e(79245),je=e(78451);function Q(){var V,oe,Ee,Me=(0,W.useContext)(ne.Z),Ae=Me.loading,be=Me.lang,Qe=Me.notice,Pe=(0,b.useParams)(),Ie=(0,b.useNavigate)(),Ke=(0,W.useState)(),Te=T()(Ke,2),i=Te[0],Ne=Te[1],se=(0,W.useRef)(),Ve=(0,W.useState)(0),Re=T()(Ve,2),ue=Re[0],de=Re[1],$e=(0,W.useState)("default"),Be=T()($e,2),ze=Be[0],me=Be[1],ae=(0,W.useRef)(),Se=(0,b.useModel)("subscriber"),Ge=(0,W.useState)(""),Le=T()(Ge,2),He=Le[0],we=Le[1],Oe=(0,W.useRef)(),he=(0,W.useRef)(),pe=(0,W.useRef)(),Ye=(0,W.useState)(!1),Ue=T()(Ye,2),Xe=Ue[0],We=Ue[1];return Se.addDataHandler("compose:"+Pe.id,function(c){var a;(a=se.current)===null||a===void 0||a.write(c.data)}),(0,W.useEffect)(function(){return Ae.show(),We(!1),(0,P.Pn)({id:Pe.id}).then(function(c){var a=c.data.detail;a.setting.status&&a.setting.status.indexOf("running")>-1&&(a.isRunning=!0),a.setting.status&&a.setting.status.indexOf("paused")>-1&&(a.isPaused=!0),a.setting.status&&a.setting.status.indexOf("exited")>-1&&(a.isExited=!0),a.setting.status&&a.setting.status=="waiting"?a.isDeploy=!1:a.isDeploy=!0,a.setting.status&&a.setting.status.indexOf("created")>-1&&(a.isCreated=!0,a.isDeploy=!1),c.data.project&&(a.imageList=B()(new Set(Object.keys(c.data.project.services).map(function(K){var $;return($=c.data.project.services[K].image)!==null&&$!==void 0?$:""}))));var h=c.data.project;if((!c.data.containerList||c.data.containerList.length==0)&&h&&h.services&&(c.data.containerList=Object.keys(h.services).map(function(K){return{name:"-",service:K,publishers:h.services[K].ports?h.services[K].ports.map(function($){var Y;return{url:"",targetPort:$.target,publishedPort:parseInt($.published),protocol:(Y=$.protocol)!==null&&Y!==void 0?Y:""}}):[],state:"waiting",status:""}})),c.data.containerList){var w;(0,Ce.EH)().then(function(K){we(K.data.ip)}),a.containerList=c.data.containerList,(w=ae.current)===null||w===void 0||w.setFieldValue("deployServiceName",c.data.detail.setting.deployServiceName)}if(a.yamlList=c.data.yaml,Ne(a),h!=null&&h.services&&Object.keys(h.services).map(function(K){var $=[];if(h.services&&h.services[K]&&(h.services[K].environment&&Object.keys(h.services[K].environment).map(function(fe){h.services[K].environment&&$.push({name:fe,value:h.services[K].environment[fe]})}),$.length!=0)){var Y;(Y=ae.current)===null||Y===void 0||Y.setFieldValue(["environmentService",K],$)}}),c.data.detail.setting.environment){var z;(z=ae.current)===null||z===void 0||z.setFieldValue("environment",c.data.detail.setting.environment)}else{var J,N=(0,Fe.m)(c.data.yaml[0]);(J=ae.current)===null||J===void 0||J.setFieldValue("environment",N)}a.isDeploy&&(0,P.VN)({id:Pe.id})}).catch(function(c){console.log(c),Ie("/compose/list")}).finally(function(){Ae.destroy()}),function(){Se.progress.close("compose:log:"+Pe.id)}},[ue]),(0,t.jsx)(m._z,{header:{extra:[(0,t.jsx)(b.Link,{to:"/compose/create",reloadDocument:location.search.length>0,children:(0,t.jsx)(te.ZP,{type:"primary",children:"\u521B\u5EFA\u4EFB\u52A1"},"createCompose")},"create")]},children:(0,t.jsxs)(f.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,t.jsx)(f.Z,{title:(0,t.jsx)(r.Z,{}),subTitle:"\u64CD\u4F5C - "+(i==null?void 0:i.name),bordered:!0,extra:(0,t.jsx)(t.Fragment,{children:i&&i.imageList&&i.imageList.length>0&&(0,t.jsx)(G.Z,{ref:pe,image:i.imageList})}),headerBordered:!0,children:i&&(0,t.jsxs)(k.Z,{wrap:!0,children:[(0,t.jsx)(v.Z,{icon:(0,t.jsx)(S.Z,{}),type:"primary",confirm:(0,t.jsxs)(k.Z,{style:{width:300},direction:"vertical",children:[(0,t.jsx)(g.Z.Text,{children:"\u91CD\u65B0\u521B\u5EFA\u8BE5\u4EFB\u52A1\u4E0B\u7684\u5BB9\u5668\uFF1F"}),(0,t.jsxs)(o.A,{name:"createForm",formRef:he,layout:"inline",submitter:!1,children:[(0,t.jsx)(R.Z,{initialValue:!1,name:"pullImageUseCommand",valuePropName:"checked",children:(0,t.jsx)(E.Z,{children:"\u4F7F\u7528\u547D\u4EE4\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u547D\u4EE4\u4EE3\u7406\uFF09\uFF1F"})}),(0,t.jsx)(R.Z,{initialValue:!0,name:"pullImageUseDPanel",valuePropName:"checked",children:(0,t.jsx)(E.Z,{defaultChecked:!0,children:"\u4F7F\u7528\u9762\u677F\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u4ED3\u5E93\u52A0\u901F\uFF09\uFF1F"})}),(0,t.jsx)(R.Z,{initialValue:!0,name:"createPath",valuePropName:"checked",children:(0,t.jsx)(E.Z,{defaultChecked:!0,children:"\u521B\u5EFA\u6302\u8F7D\u76EE\u5F55\uFF08\u4EC5\u9762\u677F\u975E\u5BB9\u5668\u90E8\u7F72\u751F\u6548\uFF09\uFF1F"})}),(0,t.jsx)(R.Z,{initialValue:!0,name:"removeOrphans",valuePropName:"checked",children:(0,t.jsx)(E.Z,{defaultChecked:!0,children:"\u6E05\u9664\u5DF2\u91CD\u547D\u540D\u6216\u662F\u88AB\u5220\u9664\u7684\u670D\u52A1\uFF1F"})})]})]}),action:j()(d()().mark(function c(){var a,h,w,z,J,N,K,$,Y,fe,ie,Ze;return d()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(me("deploy"),(a=se.current)===null||a===void 0||a.clear(),Y={id:i.id||i.name},!((h=he.current)!==null&&h!==void 0&&h.getFieldValue&&he.current.getFieldValue("pullImageUseDPanel"))){le.next=7;break}return le.next=6,(fe=pe.current)===null||fe===void 0?void 0:fe.start();case 6:(ie=pe.current)===null||ie===void 0||ie.finish();case 7:if(Y.environment=(w=ae.current)===null||w===void 0?void 0:w.getFieldValue("environment"),Y.deployServiceName=(z=ae.current)===null||z===void 0?void 0:z.getFieldValue("deployServiceName"),Y.createPath=(J=(N=he.current)===null||N===void 0?void 0:N.getFieldValue("createPath"))!==null&&J!==void 0?J:!0,Y.removeOrphans=(K=($=he.current)===null||$===void 0?void 0:$.getFieldValue("removeOrphans"))!==null&&K!==void 0?K:!0,!(i!=null&&i.isDeploy)){le.next=15;break}if(!((Ze=he.current)!==null&&Ze!==void 0&&Ze.getFieldValue("pullImageUseCommand"))){le.next=15;break}return le.next=15,(0,P.GG)({id:i.id||i.name,op:"pull"});case 15:return le.next=17,(0,P.Oh)(Y);case 17:de(ue+1);case 18:case"end":return le.stop()}},c)})),children:i.isDeploy?"\u66F4\u65B0":"\u542F\u52A8"},"create"),(i.isDeploy||i.isCreated)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Z,{action:function(){var a;return(a=se.current)===null||a===void 0||a.clear(),me("destory"),(0,P.mg)({id:i.id||i.name,deleteImage:!1,deleteData:!1,deleteVolume:!1,deletePath:!1})},onSuccess:function(){de(ue+1)},confirm:"\u662F\u5426\u8981\u5220\u9664\u5BB9\u5668\uFF1F",type:"primary",danger:!0,messageSuccess:"delete",icon:(0,t.jsx)(n.Z,{}),children:"\u5220\u9664\u5BB9\u5668"}),(0,t.jsx)(A.Z,{type:"vertical"})]}),i.isDeploy&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Z,{icon:(0,t.jsx)(s.Z,{}),action:j()(d()().mark(function c(){return d()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return me("crtl"),h.next=3,(0,P.GG)({id:i.id||i.name,op:"restart"});case 3:de(ue+1);case 4:case"end":return h.stop()}},c)})),children:"\u91CD\u542F"},"restart"),(0,t.jsx)(v.Z,{action:function(){var a;return(a=se.current)===null||a===void 0||a.clear(),me("crtl"),(0,P.GG)({id:i.id||i.name,op:"stop"})},messageSuccess:"stop",icon:(0,t.jsx)(Z.Z,{}),disabled:i.isExited,onSuccess:function(){de(ue+1)},children:"\u505C\u6B62"}),i.isPaused&&(0,t.jsx)(v.Z,{action:function(){var a;return me("crtl"),(a=se.current)===null||a===void 0||a.clear(),(0,P.GG)({id:i.id||i.name,op:"unpause"})},messageSuccess:"resume",onSuccess:function(){de(ue+1)},icon:(0,t.jsx)(S.Z,{}),children:"\u6062\u590D"}),!i.isPaused&&(0,t.jsx)(v.Z,{action:function(){var a;return me("crtl"),(a=se.current)===null||a===void 0||a.clear(),(0,P.GG)({id:i.id||i.name,op:"pause"})},onSuccess:function(){de(ue+1)},messageSuccess:"pause",icon:(0,t.jsx)(_.Z,{}),disabled:!i.isRunning,children:"\u6682\u505C"})]}),(0,t.jsx)(A.Z,{type:"vertical"}),i.isDeploy&&(0,t.jsx)(b.Link,{to:"/compose/create?id="+(i.id||i.name),children:(0,t.jsx)(te.ZP,{icon:(0,t.jsx)(C.Z,{}),children:"\u7F16\u8F91\u4EFB\u52A1"})}),i.isDeploy&&i.id>0&&(0,t.jsx)(v.Z,{type:"primary",action:j()(d()().mark(function c(){var a,h,w,z,J,N,K,$,Y;return d()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return(a=se.current)===null||a===void 0||a.clear(),me("destory"),ie.next=4,(0,P.mg)({id:(h=i==null?void 0:i.id)!==null&&h!==void 0?h:0,deleteImage:(w=(z=Oe.current)===null||z===void 0?void 0:z.getFieldValue("deleteImage"))!==null&&w!==void 0?w:!1,deleteData:!0,deleteVolume:(J=(N=Oe.current)===null||N===void 0?void 0:N.getFieldValue("deleteVolume"))!==null&&J!==void 0?J:!1,deletePath:(K=($=Oe.current)===null||$===void 0?void 0:$.getFieldValue("deletePath"))!==null&&K!==void 0?K:!1});case 4:Y=ie.sent;case 5:case"end":return ie.stop()}},c)})),danger:!0,onSuccess:function(){Ie("/compose/list")},confirm:(0,t.jsxs)(k.Z,{style:{width:200},direction:"vertical",children:[(0,t.jsx)(g.Z.Text,{children:"\u4F1A\u540C\u65F6\u5220\u9664\u5BB9\u5668\u53CA\u90E8\u7F72\u76F8\u5173\u6570\u636E\uFF0C\u672A\u52FE\u9009\u5220\u9664 compose \u6587\u4EF6\u65F6 yaml \u6587\u4EF6\u5C06\u4F1A\u4FDD\u7559\uFF0C\u786E\u8BA4\u5417\uFF1F"}),(0,t.jsxs)(o.A,{formRef:Oe,layout:"inline",submitter:!1,children:[(0,t.jsx)(R.Z,{initialValue:!1,name:"deleteImage",valuePropName:"checked",children:(0,t.jsx)(E.Z,{children:"\u5220\u9664\u955C\u50CF\uFF1F"})}),(0,t.jsx)(R.Z,{initialValue:!1,name:"deleteVolume",valuePropName:"checked",children:(0,t.jsx)(E.Z,{children:"\u5220\u9664\u5B58\u50A8\u5377\uFF1F"})}),(0,t.jsx)(R.Z,{initialValue:!1,name:"deletePath",valuePropName:"checked",children:(0,t.jsx)(E.Z,{children:"\u5220\u9664 Compose \u6587\u4EF6\u548C\u4EFB\u52A1\u76EE\u5F55\uFF1F"})})]})]}),children:"\u5220\u9664\u4EFB\u52A1"})]})},"operator"),(0,t.jsxs)(f.Z,{split:"vertical",children:[(0,t.jsxs)(f.Z,{colSpan:"45%",direction:"column",split:"horizontal",title:"\u542F\u52A8\u914D\u7F6E",subTitle:"\u7F16\u8F91\u540E\u53EA\u5F71\u54CD\u672C\u6B21\u90E8\u7F72",extra:[i&&!i.isDeploy&&(0,t.jsx)(E.Z,{onChange:function(a){We(a.target.checked)},children:"\u81EA\u5B9A\u4E49\u90E8\u7F72\u5BB9\u5668\u670D\u52A1\uFF1F"},"selectService")],children:[ze!="default"&&(0,t.jsx)(f.Z,{title:(0,t.jsx)(O.Z,{}),subTitle:"\u63A7\u5236\u53F0",extra:(0,t.jsx)(k.Z,{children:(0,t.jsx)(v.Z,{action:function(){var a;return(a=se.current)===null||a===void 0||a.clear(),(0,P.U_)({})},icon:(0,t.jsx)(n.Z,{}),danger:!0,onSuccess:function(){de(ue+1)},children:"\u4E2D\u6B62\u6267\u884C"},"kill")}),children:(0,t.jsx)(l.Z,{height:"300px",style:{fontSize:12},ref:se})}),i&&(0,t.jsx)(f.Z,{children:(0,t.jsx)(x.Z,{scroll:{x:"max-content"},rowKey:"service",pagination:!1,columns:[{title:"\u5BB9\u5668\u540D",dataIndex:"name",width:170,render:function(a,h,w){return(0,t.jsx)(je.Z,{content:h.name})}},{title:"\u670D\u52A1\u540D",dataIndex:"service",width:100,render:function(a,h,w){return(0,t.jsx)(je.Z,{content:h.service})}},{title:"\u7AEF\u53E3",render:function(a,h,w){var z=[],J=[];return h.publishers&&h.publishers.map(function(N){N.publishedPort?z.push({PrivatePort:N.targetPort,Type:N.protocol,IP:N.url,PublicPort:N.publishedPort}):N.publishedPort&&J.push({PrivatePort:N.targetPort,Type:N.protocol,IP:N.url,PublicPort:N.publishedPort})}),(0,t.jsx)(De.Z,{publicPort:z,privatePort:J,domain:[],serverIp:He})}},{title:"\u72B6\u6001",render:function(a,h,w){return(0,t.jsx)(ye.Z,{status:h.state,message:{content:be("container.status.".concat(h.state)),placement:"top",showInTag:!0}},h.name)}},{title:"\u64CD\u4F5C",render:function(a,h,w){return(0,t.jsxs)(k.Z,{split:(0,t.jsx)(A.Z,{type:"vertical"}),children:[(0,t.jsx)(b.Link,{to:"/app/detail/edit/"+h.name,target:"_blank",children:(0,t.jsx)(F.Z,{title:"\u7BA1\u7406\u5BB9\u5668",children:(0,t.jsx)(r.Z,{})})},"edit"),h.state=="running"&&(0,t.jsx)(ge.Z,{container:h.name},"console")]})}}],dataSource:i.containerList,rowSelection:Xe&&i.containerList?{defaultSelectedRowKeys:i.containerList.map(function(c){return c.service}),onChange:function(a,h,w){var z;(z=ae.current)===null||z===void 0||z.setFieldValue("deployServiceName",a)}}:void 0})}),(0,t.jsxs)(o.A,{formRef:ae,submitter:!1,children:[(0,t.jsx)(R.Z,{name:"deployServiceName",hidden:!0}),!(i!=null&&i.isDeploy)&&(0,t.jsx)(f.Z,{title:"\u73AF\u5883\u53D8\u91CF",subTitle:"\u9762\u677F\u751F\u6210 .dpanel.env \u6587\u4EF6\uFF0C\u540C\u65F6\u4F1A\u52A0\u8F7D .env",children:(0,t.jsx)(I.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,showInDrawer:!0,requireValue:!0})}),!(i!=null&&i.isDeploy)&&(0,t.jsx)(f.Z,{title:"\u670D\u52A1\u73AF\u5883\u53D8\u91CF",tooltip:"\u4FEE\u6539\u670D\u52A1\u4E2D\u7684\u73AF\u5883\u53D8\u91CF\u65F6\uFF0C\u8BF7\u5728 yaml \u4E2D\u5C06\u503C\u5148\u6620\u5C04\u6210\u81EA\u5B9A\u4E49\u7684\u53D8\u91CF\u540D",children:(0,t.jsx)(U.Z,{indicator:{align:"center"},items:ae&&ae.current&&((V=ae.current)===null||V===void 0?void 0:V.getFieldValue("environmentService"))&&Object.keys((oe=ae.current)===null||oe===void 0?void 0:oe.getFieldValue("environmentService")).map(function(c){return{label:c,key:c,children:(0,t.jsx)(I.Z,{showCardGhost:!0,name:["environmentService",c],showDisableName:!0,showDisableValue:!0,showInDrawer:!0,requireValue:!0})}})})})]})]}),i&&!i.isDeploy&&(0,t.jsx)(f.Z,{colSpan:"55%",children:(0,t.jsx)(U.Z,{items:i.yamlList&&i.yamlList.map(function(c,a){var h=[{label:"Yaml \u6587\u4EF6",key:"yaml"},{label:"\u8986\u76D6 Yaml \u6587\u4EF6",key:"yamlOverride"}];return{label:h[a].label,key:h[a].key,disabled:c=="",children:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(H.ZP,{theme:"dark",minHeight:"550px",value:c,readOnly:!0,extensions:[q.RI.yaml()]})})}})})}),i&&i.isDeploy&&(0,t.jsx)(f.Z,{title:(0,t.jsx)(D.Z,{}),subTitle:"\u65E5\u5FD7",colSpan:"55%",children:(0,t.jsx)(ve,{id:(Ee=Pe.id)!==null&&Ee!==void 0?Ee:""})})]})]})})}},3393:function(ee,L,e){e.d(L,{Gb:function(){return T},Pn:function(){return r},Rb:function(){return n},YU:function(){return B},ZQ:function(){return C},_U:function(){return l},cd:function(){return Z}});var u=e(15009),d=e.n(u),M=e(99289),j=e.n(M),y=e(63713);function B(D){return p.apply(this,arguments)}function p(){return p=j()(d()().mark(function D(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/app/image/get-detail",{method:"POST",data:m}));case 1:case"end":return o.stop()}},D)})),p.apply(this,arguments)}function T(D){return v.apply(this,arguments)}function v(){return v=j()(d()().mark(function D(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/app/image/tag-remote",{method:"POST",data:m}));case 1:case"end":return o.stop()}},D)})),v.apply(this,arguments)}function l(D){return P.apply(this,arguments)}function P(){return P=j()(d()().mark(function D(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/app/image/tag-add",{method:"POST",data:m}));case 1:case"end":return o.stop()}},D)})),P.apply(this,arguments)}function r(D){return S.apply(this,arguments)}function S(){return S=j()(d()().mark(function D(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/app/image/tag-delete",{method:"POST",data:m}));case 1:case"end":return o.stop()}},D)})),S.apply(this,arguments)}function n(D){return s.apply(this,arguments)}function s(){return s=j()(d()().mark(function D(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/app/image/export",{method:"POST",data:m,responseType:"blob"}));case 1:case"end":return o.stop()}},D)})),s.apply(this,arguments)}function Z(D){return _.apply(this,arguments)}function _(){return _=j()(d()().mark(function D(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/pro/image/get-remote-tag",{method:"POST",data:m}));case 1:case"end":return o.stop()}},D)})),_.apply(this,arguments)}function C(D){return O.apply(this,arguments)}function O(){return O=j()(d()().mark(function D(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.request)("/api/app/image/check-upgrade",{method:"POST",data:m}));case 1:case"end":return o.stop()}},D)})),O.apply(this,arguments)}},85576:function(ee,L,e){e.d(L,{Z:function(){return D}});var u=e(56080),d=e(38657),M=e(56745),j=e(67294),y=e(93967),B=e.n(y),p=e(40974),T=e(8745),v=e(53124),l=e(35792),P=e(32409),r=e(4941),S=e(71194),n=function(m,f){var o={};for(var R in m)Object.prototype.hasOwnProperty.call(m,R)&&f.indexOf(R)<0&&(o[R]=m[R]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var b=0,R=Object.getOwnPropertySymbols(m);b<R.length;b++)f.indexOf(R[b])<0&&Object.prototype.propertyIsEnumerable.call(m,R[b])&&(o[R[b]]=m[R[b]]);return o};const s=m=>{const{prefixCls:f,className:o,closeIcon:R,closable:b,type:te,title:k,children:g,footer:E}=m,A=n(m,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:x}=j.useContext(v.E_),F=x(),U=f||x("modal"),W=(0,l.Z)(F),[G,H,q]=(0,S.ZP)(U,W),ne=`${U}-confirm`;let I={};return te?I={closable:b!=null?b:!1,title:"",footer:"",children:j.createElement(P.O,Object.assign({},m,{prefixCls:U,confirmPrefixCls:ne,rootPrefixCls:F,content:g}))}:I={closable:b!=null?b:!0,title:k,footer:E!==null&&j.createElement(r.$,Object.assign({},m)),children:g},G(j.createElement(p.s,Object.assign({prefixCls:U,className:B()(H,`${U}-pure-panel`,te&&ne,te&&`${ne}-${te}`,o,q,W)},A,{closeIcon:(0,r.b)(U,R),closable:b},I)))};var Z=(0,T.i)(s),_=e(94423);function C(m){return(0,u.ZP)((0,u.uW)(m))}const O=M.Z;O.useModal=_.Z,O.info=function(f){return(0,u.ZP)((0,u.cw)(f))},O.success=function(f){return(0,u.ZP)((0,u.vq)(f))},O.error=function(f){return(0,u.ZP)((0,u.AQ)(f))},O.warning=C,O.warn=C,O.confirm=function(f){return(0,u.ZP)((0,u.Au)(f))},O.destroyAll=function(){for(;d.Z.length;){const f=d.Z.pop();f&&f()}},O.config=u.ai,O._InternalPanelDoNotUseOrYouWillBeFired=Z;var D=O},86738:function(ee,L,e){e.d(L,{Z:function(){return k}});var u=e(67294),d=e(21640),M=e(93967),j=e.n(M),y=e(21770),B=e(98423),p=e(53124),T=e(55241),v=e(86743),l=e(81643),P=e(28036),r=e(33671),S=e(10110),n=e(24457),s=e(66330),Z=e(83559);const _=g=>{const{componentCls:E,iconCls:A,antCls:x,zIndexPopup:F,colorText:U,colorWarning:W,marginXXS:G,marginXS:H,fontSize:q,fontWeightStrong:ne,colorTextHeading:I}=g;return{[E]:{zIndex:F,[`&${x}-popover`]:{fontSize:q},[`${E}-message`]:{marginBottom:H,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${E}-message-icon ${A}`]:{color:W,fontSize:q,lineHeight:1,marginInlineEnd:H},[`${E}-title`]:{fontWeight:ne,color:I,"&:only-child":{fontWeight:"normal"}},[`${E}-description`]:{marginTop:G,color:U}},[`${E}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:H}}}}},C=g=>{const{zIndexPopupBase:E}=g;return{zIndexPopup:E+60}};var O=(0,Z.I$)("Popconfirm",g=>_(g),C,{resetStyle:!1}),D=function(g,E){var A={};for(var x in g)Object.prototype.hasOwnProperty.call(g,x)&&E.indexOf(x)<0&&(A[x]=g[x]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var F=0,x=Object.getOwnPropertySymbols(g);F<x.length;F++)E.indexOf(x[F])<0&&Object.prototype.propertyIsEnumerable.call(g,x[F])&&(A[x[F]]=g[x[F]]);return A};const m=g=>{const{prefixCls:E,okButtonProps:A,cancelButtonProps:x,title:F,description:U,cancelText:W,okText:G,okType:H="primary",icon:q=u.createElement(d.Z,null),showCancel:ne=!0,close:I,onConfirm:ce,onCancel:xe,onPopupClick:_e}=g,{getPrefixCls:t}=u.useContext(p.E_),[X]=(0,S.Z)("Popconfirm",n.Z.Popconfirm),re=(0,l.Z)(F),ve=(0,l.Z)(U);return u.createElement("div",{className:`${E}-inner-content`,onClick:_e},u.createElement("div",{className:`${E}-message`},q&&u.createElement("span",{className:`${E}-message-icon`},q),u.createElement("div",{className:`${E}-message-text`},re&&u.createElement("div",{className:`${E}-title`},re),ve&&u.createElement("div",{className:`${E}-description`},ve))),u.createElement("div",{className:`${E}-buttons`},ne&&u.createElement(P.ZP,Object.assign({onClick:xe,size:"small"},x),W||(X==null?void 0:X.cancelText)),u.createElement(v.Z,{buttonProps:Object.assign(Object.assign({size:"small"},(0,r.nx)(H)),A),actionFn:ce,close:I,prefixCls:t("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},G||(X==null?void 0:X.okText))))};var o=g=>{const{prefixCls:E,placement:A,className:x,style:F}=g,U=D(g,["prefixCls","placement","className","style"]),{getPrefixCls:W}=u.useContext(p.E_),G=W("popconfirm",E),[H]=O(G);return H(u.createElement(s.ZP,{placement:A,className:j()(G,x),style:F,content:u.createElement(m,Object.assign({prefixCls:G},U))}))},R=function(g,E){var A={};for(var x in g)Object.prototype.hasOwnProperty.call(g,x)&&E.indexOf(x)<0&&(A[x]=g[x]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var F=0,x=Object.getOwnPropertySymbols(g);F<x.length;F++)E.indexOf(x[F])<0&&Object.prototype.propertyIsEnumerable.call(g,x[F])&&(A[x[F]]=g[x[F]]);return A};const te=u.forwardRef((g,E)=>{var A,x;const{prefixCls:F,placement:U="top",trigger:W="click",okType:G="primary",icon:H=u.createElement(d.Z,null),children:q,overlayClassName:ne,onOpenChange:I,onVisibleChange:ce}=g,xe=R(g,["prefixCls","placement","trigger","okType","icon","children","overlayClassName","onOpenChange","onVisibleChange"]),{getPrefixCls:_e}=u.useContext(p.E_),[t,X]=(0,y.Z)(!1,{value:(A=g.open)!==null&&A!==void 0?A:g.visible,defaultValue:(x=g.defaultOpen)!==null&&x!==void 0?x:g.defaultVisible}),re=(Q,V)=>{X(Q,!0),ce==null||ce(Q),I==null||I(Q,V)},ve=Q=>{re(!1,Q)},De=Q=>{var V;return(V=g.onConfirm)===null||V===void 0?void 0:V.call(void 0,Q)},Ce=Q=>{var V;re(!1,Q),(V=g.onCancel)===null||V===void 0||V.call(void 0,Q)},ye=(Q,V)=>{const{disabled:oe=!1}=g;oe||re(Q,V)},ge=_e("popconfirm",F),Fe=j()(ge,ne),[je]=O(ge);return je(u.createElement(T.Z,Object.assign({},(0,B.Z)(xe,["title"]),{trigger:W,placement:U,onOpenChange:ye,open:t,ref:E,overlayClassName:Fe,content:u.createElement(m,Object.assign({okType:G,icon:H},g,{prefixCls:ge,close:ve,onConfirm:De,onCancel:Ce})),"data-popover-inject":!0}),q))});te._InternalPanelDoNotUseOrYouWillBeFired=o;var k=te}}]);
