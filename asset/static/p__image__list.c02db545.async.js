"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4214],{1912:function(z,A,e){e.d(A,{Z:function(){return R}});var I=e(87462),o=e(67294),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},d=i,_=e(84089),p=function(j,D){return o.createElement(_.Z,(0,I.Z)({},j,{ref:D,icon:d}))},T=o.forwardRef(p),R=T},28307:function(z,A,e){var I=e(5574),o=e.n(I),i=e(38345),d=e(97269),_=e(5966),p=e(64317),T=e(62370),R=e(28036),b=e(85265),j=e(42075),D=e(67294),y=e(80821),U=e(3393),Z=e(97961),L=e(92754),x=e(63713),r=e(85893),f=(0,D.forwardRef)(function(l,u){var Q=(0,D.useState)(!1),J=o()(Q,2),M=J[0],O=J[1],P=(0,D.useRef)(),W=(0,D.useRef)();return(0,D.useImperativeHandle)(u,function(){return{upgradeImage:function(g){var m;return O(!0),(m=P.current)===null||m===void 0||m.setFieldValue("imageUrl",g),(0,U.Gb)({tag:g,type:"pull"})},setImageName:function(g){var m;O(!0),(m=P.current)===null||m===void 0||m.setFieldValue("imageUrl",g)}}}),[(0,r.jsx)(R.ZP,{type:l.buttonType?l.buttonType:"default",onClick:function(){var g,m;l.onClick&&l.onClick(),O(!0),(g=P.current)===null||g===void 0||g.resetFields(),(m=W.current)===null||m===void 0||m.setStart("")},children:"\u62C9\u53D6\u955C\u50CF"},"remoteBtn"),(0,r.jsxs)(b.Z,{forceRender:!0,open:M,title:"\u62C9\u53D6\u8FDC\u7A0B\u955C\u50CF",width:800,onClose:function(){return O(!1)},footer:!1,children:[(0,r.jsx)(i.Z,{children:(0,r.jsxs)(j.Z,{direction:"vertical",size:"middle",children:[(0,r.jsxs)("div",{children:["1\u3001\u955C\u50CF\u540D\u79F0\u4E2D\u4E0D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C \u9ED8\u8BA4\u4ECE ",(0,r.jsx)("a",{href:"https://hub.docker.com/",target:"_blank",children:"docker hub"})," \u4E2D\u4E0B\u8F7D\uFF0C \u4F60\u53EF\u4EE5\u5728\u4E0A\u9762",(0,r.jsx)("a",{href:"https://hub.docker.com/search?q=",target:"_blank",children:"\u3010\u67E5\u627E\u3011"}),"\u9700\u8981\u7684\u955C\u50CF"]}),(0,r.jsxs)("div",{children:["2\u3001\u955C\u50CF\u4E2D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C\u8BF7\u786E",(0,r.jsx)(x.Link,{to:"/image/registry",children:"\u3010\u6DFB\u52A0\u3011"}),"\u8FC7\u8BE5\u4ED3\u5E93\uFF0C\u5E76\u6709 Pull \u6743\u9650"]}),(0,r.jsxs)("div",{children:["3\u3001\u53EF\u5728",(0,r.jsx)(x.Link,{to:"/image/registry",children:"\u3010\u4ED3\u5E93\u7BA1\u7406\u3011"}),"\u4E2D\u914D\u7F6E\u955C\u50CF\u7684\u52A0\u901F\u5730\u5740"]})]})}),(0,r.jsx)(i.Z,{title:"\u62C9\u53D6\u955C\u50CF",headerBordered:!0,children:(0,r.jsxs)(d.A,{submitter:!1,formRef:P,children:[(0,r.jsxs)(j.Z.Compact,{children:[(0,r.jsx)(_.Z,{width:400,name:"imageUrl",placeholder:"\u8BF7\u8F93\u5165\u955C\u50CF\u5730\u5740"}),(0,r.jsx)(p.Z,{name:"platform",style:{width:150},placeholder:"\u9ED8\u8BA4\u5F53\u524D\u67B6\u6784",options:Z.ii.map(function(B){return{label:B.name,value:B.name}})}),(0,r.jsx)(y.Z,{action:function(){var g,m,w,N,V,X=(g=(m=P.current)===null||m===void 0?void 0:m.getFieldValue("imageUrl"))!==null&&g!==void 0?g:"";return(w=W.current)===null||w===void 0||w.setStart(X),(0,U.Gb)({tag:X,type:"pull",platform:(N=(V=P.current)===null||V===void 0?void 0:V.getFieldValue("platform"))!==null&&N!==void 0?N:""})},onSuccess:function(g){var m;(m=W.current)===null||m===void 0||m.setFinish(),O(!1),l.onFinish&&(console.log(g),l.onFinish(g.data.tag))},messageSuccess:"imagePull",children:"\u62C9\u53D6\u955C\u50CF"})]}),(0,r.jsx)(T.Z,{label:"\u62C9\u53D6\u8FDB\u5EA6",children:(0,r.jsx)(L.Z,{ref:W})})]})})]},"remoteDrawer")]});A.Z=f},92754:function(z,A,e){var I=e(5574),o=e.n(I),i=e(67294),d=e(63713),_=e(38703),p=e(85893),T=(0,i.forwardRef)(function(R,b){var j=(0,i.useState)(""),D=o()(j,2),y=D[0],U=D[1];(0,i.useImperativeHandle)(b,function(){return{setFinish:function(){f({finish:{downloading:100,extracting:100}})},setStart:function(u){u&&U(u),f({start:{downloading:0,extracting:0}})}}});var Z=(0,d.useModel)("subscriber");Z.addDataHandler("image:pull:"+y,function(l){f(l.data)});var L=(0,i.useState)(),x=o()(L,2),r=x[0],f=x[1];return(0,i.useEffect)(function(){f({start:{downloading:0,extracting:0}})},[]),(0,p.jsx)(p.Fragment,{children:r&&Object.keys(r).map(function(l){return(0,p.jsx)(_.Z,{percent:r[l].downloading,success:{percent:r[l].extracting}},l)})})});A.Z=T},31810:function(z,A,e){e.r(A),e.d(A,{default:function(){return fe}});var I=e(19632),o=e.n(I),i=e(15009),d=e.n(i),_=e(99289),p=e.n(_),T=e(5574),R=e.n(T),b=e(90078),j=e(10641),D=e(37476),y=e(62370),U=e(5966),Z=e(31418),L=e(28036),x=e(25593),r=e(42075),f=e(66309),l=e(96074),u=e(83062),Q=e(84567),J=e(50136),M=e(67294),O=e(63713),P=e(18148),W=e(5251),B=e(80821),g=e(43425),m=e(87462),w=e(3803),N=e(84089),V=function(k,ee){return M.createElement(N.Z,(0,m.Z)({},k,{ref:ee,icon:w.Z}))},X=M.forwardRef(V),ue=X,se=e(58638),le=e(1912),oe=e(28307),ie=e(96042),q=e(67255),ce=e(24963),de=e(3393),me=e(93162),n=e(85893);function fe(){var Y=(0,M.useContext)(ce.Z),k=Y.message,ee=Y.notice,_e=Y.lang,F=(0,M.useRef)(),ve=(0,M.useState)({force:!1}),te=R()(ve,2),he=te[0],pe=te[1],Fe=Z.Z.useApp(),ge=(0,M.useState)(1),re=R()(ge,2),ne=re[0],Ee=re[1],ae=(0,M.useRef)();return(0,M.useEffect)(function(){var E;(E=F.current)===null||E===void 0||E.reload()},[ne]),(0,n.jsx)(b._z,{header:{extra:[(0,n.jsx)(O.Link,{to:"/image/create",children:(0,n.jsx)(L.ZP,{type:"primary",children:"\u521B\u5EFA&\u5BFC\u5165\u955C\u50CF"},"create")},"create"),(0,n.jsx)(oe.Z,{onFinish:function(){var c,t;!((c=F.current)===null||c===void 0)&&c.reloadAndRest&&((t=F.current)===null||t===void 0||t.reloadAndRest())}},"remote")]},children:(0,n.jsx)(j.Z,{scroll:{x:"max-content"},rowKey:"Id",columns:[{title:"\u540D\u79F0",dataIndex:"title",render:function(c,t,v,C,a){var s=t.Id.substring(7,19);return t.Title&&(s=t.Title),(0,n.jsx)(x.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u955C\u50CF\u5907\u6CE8\u540D\u79F0",onChange:function(){var h=p()(d()().mark(function $(G){var K;return d()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,(0,P.Fj)({tag:t.RepoTags[0],title:G});case 2:K=H.sent,Ee(ne+1),k.success("\u4FEE\u6539\u955C\u50CF\u540D\u79F0\u6210\u529F");case 5:case"end":return H.stop()}},$)}));function S($){return h.apply(this,arguments)}return S}()},children:(0,n.jsx)(O.Link,{to:"/image/detail/"+t.Id,children:s},"edit")},"title-".concat(v))}},{title:"Tag",dataIndex:"tag",render:function(c,t,v,C){return(0,n.jsx)(r.Z,{direction:"vertical",style:{textAlign:"left"},children:t.RepoTags.map(function(a,s){return(0,n.jsxs)(r.Z,{children:[(0,n.jsx)(f.Z,{color:"#2db7f5",children:(0,n.jsx)(x.Z.Text,{copyable:!0,title:a,style:{color:"#ffffff"},children:a},"tag-"+s)},"tag-".concat(s)),t.Containers>0&&(0,n.jsx)(f.Z,{color:"cyan",children:"\u4F7F\u7528\u4E2D"},"use-".concat(s))]},s)})},t.Id)}},{title:"\u67B6\u6784",width:80,search:!1,render:function(c,t,v,C,a){if(t.Labels&&t.Labels["com.dpanel.image.arch"])return(0,n.jsx)(f.Z,{children:t.Labels["com.dpanel.image.arch"]},"arch"+t.Id)}},{title:"\u5C3A\u5BF8",dataIndex:"size",ellipsis:!0,width:"120px",search:!1,sorter:function(c,t){return parseFloat(c.Size)-parseFloat(t.Size)},render:function(c,t,v,C){return(0,n.jsx)("div",{children:(0,W.FI)(parseFloat(t.Size))},t.Id)}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(c,t,v,C){return(0,n.jsx)("div",{children:(0,W.ZM)(t.Created*1e3)},t.Id)},sorter:function(c,t){return c.Created-t.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",render:function(c,t,v,C){return(0,n.jsxs)(r.Z,{split:(0,n.jsx)(l.Z,{type:"vertical"}),children:[(0,n.jsx)(O.Link,{to:"/image/detail/"+t.Id,children:(0,n.jsx)(u.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(g.Z,{})})},"edit"),(0,n.jsx)(O.Link,{to:"/app/create/image?imageId="+t.RepoTags[0],children:(0,n.jsx)(u.Z,{title:"\u521B\u5EFA\u5BB9\u5668",children:(0,n.jsx)(ue,{})})},"create")]})}}],request:function(){var E=p()(d()().mark(function c(t,v,C){var a;return d()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,P.KG)({tag:t.tag,title:t.title});case 2:if(a=h.sent,!(!a||!a.data||!a.data.list)){h.next=5;break}return h.abrupt("return",{data:[],success:!0,total:0});case 5:return a.data.list.map(function(S){var $="";S.RepoTags.map(function(G){a.data.title[G]&&($=a.data.title[G])}),S.Title=$}),h.abrupt("return",{data:a.data.list,success:!0,total:a.data.list.length});case 7:case"end":return h.stop()}},c)}));return function(c,t,v){return E.apply(this,arguments)}}(),pagination:(0,q.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:F,tableAlertOptionRender:function(c){var t=c.selectedRowKeys,v=c.selectedRows;return(0,n.jsxs)(r.Z,{size:16,children:[(0,n.jsx)(B.Z,{icon:(0,n.jsx)(se.Z,{}),action:function(){var a=[];return v.map(function(s){a.push.apply(a,o()(s.RepoTags))}),(0,de.Rb)({md5:a})},onSuccess:function(a){var s=v.map(function(S){return S.RepoTags[0]}),h=new Blob([a],{type:"application/tar"});(0,me.saveAs)(h,s.join("-")+".tar")},messageSuccess:"export",children:"\u5BFC\u51FA"}),(0,n.jsxs)(D.Y,{formRef:ae,title:"\u6279\u91CF\u63A8\u9001\u955C\u50CF",trigger:(0,n.jsx)(L.ZP,{icon:(0,n.jsx)(le.Z,{}),children:"\u540C\u6B65\u81F3\u5176\u5B83\u4ED3\u5E93"}),onFinish:function(){var C=p()(d()().mark(function a(s){var h,S,$;return d()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,(0,P.KX)({md5:t,registryId:s.registryId,newNamespace:s.newNamespace});case 2:return $=K.sent,(h=F.current)===null||h===void 0||h.reload(),!((S=F.current)===null||S===void 0)&&S.clearSelected&&F.current.clearSelected(),K.abrupt("return",!0);case 6:case"end":return K.stop()}},a)}));return function(a){return C.apply(this,arguments)}}(),children:[(0,n.jsx)(y.Z,{name:"registryId",hidden:!0}),(0,n.jsx)(y.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,n.jsxs)(n.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,n.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,n.jsx)(ie.Z,{multiple:!0,top:!0,onChangeList:function(a){var s;(s=ae.current)===null||s===void 0||s.setFieldValue("registryId",a.map(function(h){return h.id}))}})}),(0,n.jsx)(U.Z,{tooltip:"\u53EF\u4EE5\u901A\u8FC7\u6B64\u9879\u91CD\u65B0\u5B9A\u4E49\u547D\u540D\u7A7A\u95F4\uFF0Cdocker hub \u4E0D\u53D7\u8BE5\u914D\u7F6E\u7684\u5F71\u54CD\u3002 \u914D\u7F6E\u6B64\u9879\u540E mysql:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/mysql:latest\uFF0C dpanel/dpanel:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/dpanel:latest",label:"\u91CD\u5199\u4ED3\u5E93\u547D\u540D\u7A7A\u95F4",name:"newNamespace"})]}),(0,n.jsx)(B.Z,{danger:!0,type:"primary",action:function(){return(0,P.ao)({md5:t,force:he.force})},onSuccess:function(){var a,s;return!((a=F.current)===null||a===void 0)&&a.reloadAndRest&&((s=F.current)===null||s===void 0||s.reloadAndRest()),!0},onError:function(){var a,s;return!((a=F.current)===null||a===void 0)&&a.reset&&((s=F.current)===null||s===void 0||s.reset()),!0},messageSuccess:"delete",confirm:(0,n.jsxs)(r.Z,{style:{width:280},direction:"vertical",children:[(0,n.jsx)(x.Z.Text,{children:"\u5220\u9664\u955C\u50CF\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"}),(0,n.jsx)(Q.Z,{name:"deleteVolume",onChange:function(a){return pe({force:a.target.checked})},children:"\u5F3A\u5236\u5220\u9664\uFF1F"})]}),children:"\u6279\u91CF\u5220\u9664"})]})},tableExtraRender:function(){return(0,n.jsx)(J.Z,{mode:"horizontal",selectedKeys:["all"],items:[{label:(0,n.jsx)(O.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,n.jsx)(O.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})},toolBarRender:function(){return[(0,n.jsx)(B.Z,{action:function(){return(0,P.c7)()},onSuccess:function(){var t,v;return!((t=F.current)===null||t===void 0)&&t.reloadAndRest&&((v=F.current)===null||v===void 0||v.reloadAndRest()),!0},onError:function(){var t,v;return!((t=F.current)===null||t===void 0)&&t.reset&&((v=F.current)===null||v===void 0||v.reset()),!0},messageSuccess:"clear",confirm:"\u662F\u5426\u6E05\u7406\u672A\u4F7F\u7528\u6216\u662F\u672A\u8FD0\u884C\u7684\u955C\u50CF",children:"\u6E05\u7406\u672A\u4F7F\u7528\u955C\u50CF"})]},columnsState:(0,q.j)("image-list")})})}},97961:function(z,A,e){e.d(A,{GH:function(){return D},MF:function(){return L},_2:function(){return U},fN:function(){return T},ii:function(){return p},vC:function(){return b}});var I=e(15009),o=e.n(I),i=e(99289),d=e.n(i),_=e(63713),p=[{name:"linux/amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"linux/arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"linux/i386",arch:"386",search:[]},{name:"linux/arm/v6",arch:"arm",search:[]},{name:"linux/arm/v7",arch:"arm",search:[]},{name:"linux/arm/v8",arch:"arm64",search:[]},{name:"linux/ppc64le",arch:"ppc64le",search:[]},{name:"linux/riscv64",arch:"riscv64",search:[]}];function T(r){return R.apply(this,arguments)}function R(){return R=d()(o()().mark(function r(f){return o()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,_.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:f}));case 1:case"end":return u.stop()}},r)})),R.apply(this,arguments)}function b(r){return j.apply(this,arguments)}function j(){return j=d()(o()().mark(function r(f){return o()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,_.request)("/api/app/image/import-by-container-tar",{method:"POST",data:f}));case 1:case"end":return u.stop()}},r)})),j.apply(this,arguments)}function D(r){return y.apply(this,arguments)}function y(){return y=d()(o()().mark(function r(f){return o()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,_.request)("/api/app/image/import-by-image-tar",{method:"POST",data:f}));case 1:case"end":return u.stop()}},r)})),y.apply(this,arguments)}function U(r){return Z.apply(this,arguments)}function Z(){return Z=d()(o()().mark(function r(f){return o()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,_.request)("/api/common/attach/delete",{method:"POST",data:f});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},r)})),Z.apply(this,arguments)}function L(){return x.apply(this,arguments)}function x(){return x=d()(o()().mark(function r(){return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,_.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return l.stop()}},r)})),x.apply(this,arguments)}},67255:function(z,A,e){e.d(A,{O:function(){return I},j:function(){return o}});function I(){var i=localStorage.getItem("dpanel-pagesize");return i=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(i!=null?i:"20")}}function o(i){var d="dpanel-table-column-".concat(i),_={};if(localStorage.getItem(d)){var p;_=JSON.parse((p=localStorage.getItem(d))!==null&&p!==void 0?p:"{}")}return{defaultValue:_,onChange:function(R){localStorage.setItem("dpanel-table-column-".concat(i),JSON.stringify(R))}}}}}]);
