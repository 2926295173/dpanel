"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1058],{91058:function($,M,n){var g=n(9783),_=n.n(g),I=n(19632),v=n.n(I),s=n(97857),i=n.n(s),w=n(5574),C=n.n(w),T=n(89035),p=n(64317),b=n(5966),S=n(38345),B=n(17186),c=n(24739),z=n(42075),d=n(83622),Z=n(85576),E=n(67294),V=n(11106),h=n(12491),L=n(62597),P=n(79245),k=n(3616),W=n(36146),r=n(85893),o="docker-image",D=(0,E.forwardRef)(function(e,Q){var N=(0,E.useState)(o),K=C()(N,2),H=K[0],A=K[1],f=(0,E.useRef)(),J=(0,E.useState)(""),G=C()(J,2),X=G[0],Y=G[1],R=new W.Uo("components.appForm");(0,E.useImperativeHandle)(Q,function(){return{addEnvItem:function(a,l){var m,u=(m=f.current)===null||m===void 0?void 0:m.getList(),O=!1;if(u==null||u.map(function(j){if(j.name==a){O=!0;return}}),!O){var U;(U=f.current)===null||U===void 0||U.add({name:a,value:l})}},clear:function(){var a;(a=f.current)===null||a===void 0||(a=a.getList())===null||a===void 0||a.map(function(l,m){var u;(u=f.current)===null||u===void 0||u.remove(m)})}}});function ee(t){try{var a,l;t==""&&(t=ne());for(var m=(a=(l=f.current)===null||l===void 0||(l=l.getList())===null||l===void 0?void 0:l.length)!==null&&a!==void 0?a:0,u=m;u>=0;u--){var O;(O=f.current)===null||O===void 0||O.remove(u)}var U=t.split(`
`),j=0;U.map(function(x){var F,y=x.split("=");y.length<2||((F=f.current)===null||F===void 0||F.add({name:y[0],value:y.slice(1).join("=")},j),j++)})}catch(x){console.log(x)}}function re(){H!="code"?A("code"):A(o)}function ne(){if(f&&f.current&&f.current.getList){var t,a=(t=f.current)===null||t===void 0?void 0:t.getList();if(a){var l=[];return a.map(function(m){l.push("".concat(m.name,"=").concat(m.value))}),l.join(`
`)}else return""}else return""}function te(t){var a,l,m,u,O,U={},j={help:t&&t.label?t.label:"",name:"value",label:R.format("createEnvFormValue"),rules:[{required:e.requireValue?!0:(0,P.y)((a=t.rule)===null||a===void 0?void 0:a.kind,L.fp.EnvValueRuleRequired)}],disabled:e.showDisableValue||(0,P.y)((l=t.rule)===null||l===void 0?void 0:l.kind,L.fp.EnvValueRuleDisabled)};if((0,P.y)((m=t.rule)===null||m===void 0?void 0:m.kind,L.fp.EnvValueTypeSelect)){var x;return(0,r.jsx)(p.Z,i()(i()({fieldProps:U},j),{},{initialValue:t.value,width:e.showInDrawer?"sm":"md",options:((x=t.rule)===null||x===void 0?void 0:x.option)&&t.rule.option.map(function(y){return{label:y.name,value:y.value}})}))}else if((0,P.y)((u=t.rule)===null||u===void 0?void 0:u.kind,L.fp.EnvValueTypeSelectMultiple)){var F;return(0,r.jsx)(p.Z,i()(i()({mode:"tags"},j),{},{fieldProps:U,convertValue:function(q){return Array.isArray(q)?q:q.split(",")},width:e.showInDrawer?"sm":"md",options:((F=t.rule)===null||F===void 0?void 0:F.option)&&t.rule.option.map(function(y){return{label:y.name,value:y.value}})}))}else return(0,P.y)((O=t.rule)===null||O===void 0?void 0:O.kind,L.fp.EnvValueTypeNumber)?(0,r.jsx)(b.Z,i()(i()({fieldProps:U},j),{},{width:e.showInDrawer?"sm":"md",rules:[].concat(v()(j.rules),[{pattern:new RegExp("^[0-9]*$")}]),help:R.format("createEnvFormNumberTip",{name:j.help})})):(0,r.jsx)(b.Z,i()(i()({fieldProps:U},j),{},{width:e.showInDrawer?"sm":"md"}))}return(0,r.jsxs)(S.Z,{ghost:e.showCardGhost,title:e.label?e.label:null,headerBordered:!0,extra:(e.showCodeMode||e.showImportButton)&&(0,r.jsxs)(z.Z,{children:[e.showImportButton&&(0,r.jsx)("div",{style:{marginBottom:"-25px"},children:(0,r.jsx)(h.Z,{title:R.format("createEnvFormEnvImport"),onImport:function(a){return ee(a),!0},onLoad:function(a){if(a.indexOf("=")<0)throw new Error(W.FD.format("commonFileIncorrectFormat",{name:"env"}));return!0}})}),e.showCodeMode?(0,r.jsx)(d.ZP,{icon:(0,r.jsx)(T.Z,{}),type:H=="code"?"primary":"default",onClick:re,children:R.format("createEnvFormEnvCode")},"code"):""]}),children:[(0,r.jsx)(B.u,{name:e.name?e.name:"environment",actionRef:f,creatorButtonProps:e.showAddButton?{creatorButtonText:e.addButtonLabel?e.addButtonLabel:R.format("createEnvFormListAddButton")}:!1,copyIconProps:!1,deleteIconProps:e.showDeleteButton,min:100,label:e.listLabel,transform:function(a,l,m){return _()({},l,a.map(function(u){return Array.isArray(u.value)&&(u.value=u.value.filter(function(O){return O!=""}).join(",")),u}))},children:function(a,l,m){var u=m.getCurrentRowData();return(0,r.jsxs)(c.UW,{style:{marginBottom:"5px"},children:[(0,r.jsx)(b.Z,{width:e.showInDrawer?"sm":"md",name:"name",label:R.format("createEnvFormName"),required:!0,rules:[{required:!0}],disabled:e.showDisableName,placeholder:R.format("createEnvFormNameEmpty")}),te(u)]})}}),e.showCodeMode&&(0,r.jsx)(Z.Z,{width:k.ob,open:H=="code",onCancel:function(){return A("docker-image")},onOk:function(){ee(X),A("docker-image")},children:(0,r.jsx)(V.ZP,{onChange:function(a){return Y(a)},value:ne(),height:k.Ed,theme:"dark"})})]})});M.Z=D},12491:function($,M,n){n.d(M,{Z:function(){return z}});var g=n(5574),_=n.n(g),I=n(3616),v=n(24963),s=n(36146),i=n(88484),w=n(57546),C=n(62370),T=n(11106),p=n(42075),b=n(83622),S=n(85576),B=n(67294),c=n(85893);function z(d){var Z=(0,B.useContext)(v.Z),E=Z.message,V=Z.notice,h=(0,B.useRef)(null),L=(0,B.useState)(!1),P=_()(L,2),k=P[0],W=P[1],r=(0,B.useState)(""),o=_()(r,2),D=o[0],e=o[1];(0,B.useEffect)(function(){d.data&&e(d.data)},[d.data]);var Q=function(){h.current&&(h.current.click(),h.current.onchange=function(K){if(!K||!K.target)return"";var H=new FileReader;H.onload=function(J){var G,X,Y=(G=J.target)===null||G===void 0?void 0:G.result;if(d.onLoad)try{d.onLoad&&d.onLoad(Y)}catch(R){V.error(R);return}e(Y),typeof d.onImport=="function"&&(E.success(s.FD.format("finish")),d.onImport(Y)),(X=h.current)!==null&&X!==void 0&&X.value&&(h.current.value="")};var A=K.target;if(A.files&&A.files[0]){var f=A.files[0];try{H.readAsText(f)}catch(J){V.error(s.FD.format("commonContentIncorrectFormat",{name:A.files[0].name}))}}})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(C.Z,{children:(0,c.jsxs)(p.Z.Compact,{block:!0,children:[(0,c.jsx)(b.ZP,{icon:(0,c.jsx)(i.Z,{}),block:!0,onClick:Q,children:d.title}),d.showPaset&&(0,c.jsx)(b.ZP,{icon:(0,c.jsx)(w.Z,{}),onClick:function(){W(!0)}})]})}),(0,c.jsx)("input",{style:{display:"none"},type:"file",ref:h,name:"importFileInput"}),(0,c.jsx)(S.Z,{width:I.ob,open:k,onCancel:function(){W(!1)},onOk:function(){typeof d.onImport=="function"&&(E.success(s.FD.format("finish")),d.onImport(D)),W(!1)},children:(0,c.jsx)(T.ZP,{height:I.Ed,theme:"dark",value:D,onChange:function(K){e(K)}})})]})}},3616:function($,M,n){n.d(M,{Ed:function(){return v},FK:function(){return _},R_:function(){return g},ob:function(){return I}});var g=window.innerWidth<=1024?"90vw":"65vw",_="90vw",I="60vw",v="50vh"},24963:function($,M,n){var g=n(67294),_=(0,g.createContext)({});M.Z=_},62597:function($,M,n){n.d(M,{$G:function(){return C},Ct:function(){return V},Tb:function(){return B},XH:function(){return z},cl:function(){return b},fp:function(){return p},fu:function(){return w},iE:function(){return Z},xb:function(){return L},ze:function(){return k}});var g=n(15009),_=n.n(g),I=n(99289),v=n.n(I),s=n(82346),i="com.dpanel.container.description",w="com.dpanel.container.title";function C(r){return T.apply(this,arguments)}function T(){return T=v()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/site/create-by-image",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),T.apply(this,arguments)}var p={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192};function b(r){return S.apply(this,arguments)}function S(){return S=v()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/site/get-list",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),S.apply(this,arguments)}function B(r){return c.apply(this,arguments)}function c(){return c=v()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.download=!1,e.next=3,(0,s.request)("/api/app/log/run",{method:"POST",data:o});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),c.apply(this,arguments)}function z(r){return d.apply(this,arguments)}function d(){return d=v()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.download=!0,e.next=3,(0,s.request)("/api/app/log/run",{method:"POST",data:o,responseType:"blob"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),d.apply(this,arguments)}function Z(r){return E.apply(this,arguments)}function E(){return E=v()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.id=String(o.id),e.next=3,(0,s.request)("/api/app/site/get-detail",{data:o,method:"POST"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),E.apply(this,arguments)}function V(r){return h.apply(this,arguments)}function h(){return h=v()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/container/delete",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),h.apply(this,arguments)}function L(r){return P.apply(this,arguments)}function P(){return P=v()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/site/delete",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),P.apply(this,arguments)}function k(r){return W.apply(this,arguments)}function W(){return W=v()(_()().mark(function r(o){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/app/container/ignore",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),W.apply(this,arguments)}},79245:function($,M,n){n.d(M,{m:function(){return I},y:function(){return v}});var g=n(64599),_=n.n(g);function I(s){var i=[];if(!s||s=="")return i;var w=s.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),C=_()(w),T;try{for(C.s();!(T=C.n()).done;){var p=T.value;i.push({name:p[1],value:p[2]?p[2].indexOf("-")==0?p[2].substring(1):p[2]:""})}}catch(b){C.e(b)}finally{C.f()}return i}function v(s,i){return!s||!i?!1:(s&i)!==0}}}]);
