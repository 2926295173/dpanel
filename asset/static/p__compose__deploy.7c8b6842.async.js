"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7667],{99861:function(Y,L,e){var U=e(15009),u=e.n(U),T=e(64599),P=e.n(T),g=e(99289),C=e.n(g),E=e(5574),B=e.n(E),l=e(42119),m=e(67294),p=e(92754),s=e(3393),A=e(184),r=e(38345),o=e(85893),x=(0,m.forwardRef)(function(d,O){(0,m.useImperativeHandle)(O,function(){return{start:function(){return V(!0),k()},finish:function(){V(!1)}}});var I=(0,m.useState)(0),h=B()(I,2),D=h[0],j=h[1],i=(0,m.useRef)(),N=(0,m.useState)(!1),K=B()(N,2),ae=K[0],V=K[1],k=function(){var G=C()(u()().mark(function z(){var F,a,v,R,n,J,q;return u()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:a=0,v=P()(d.image),S.prev=2,v.s();case 4:if((R=v.n()).done){S.next=14;break}return J=R.value,j(a),(n=i.current)===null||n===void 0||n.setStart(J),S.next=10,(0,s.Gb)({tag:J,type:"pull"});case 10:q=S.sent,a++;case 12:S.next=4;break;case 14:S.next=19;break;case 16:S.prev=16,S.t0=S.catch(2),v.e(S.t0);case 19:return S.prev=19,v.f(),S.finish(19);case 22:(F=i.current)===null||F===void 0||F.setFinish(),j(a);case 24:case"end":return S.stop()}},z,null,[[2,16,19,22]])}));return function(){return G.apply(this,arguments)}}();return(0,o.jsxs)(A.a,{trigger:d.trigger,width:800,open:ae,submitter:!1,title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",onOpenChange:function(){var G=C()(u()().mark(function z(F){return u()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:V(F),F&&d.trigger&&k();case 2:case"end":return v.stop()}},z)}));return function(z){return G.apply(this,arguments)}}(),drawerProps:{forceRender:!0},children:[(0,o.jsx)(r.Z,{children:(0,o.jsx)(l.Z,{current:D,items:d.image.map(function(G,z){return{title:G,key:z}})})}),(0,o.jsx)(r.Z,{children:(0,o.jsx)(p.Z,{ref:i})})]})});L.Z=x},57165:function(Y,L,e){e.d(L,{Z:function(){return B}});var U=e(5574),u=e.n(U),T=e(89035),P=e(63713),g=e(83062),C=e(67294),E=e(85893);function B(l){var m=(0,C.useState)({height:800,width:1024}),p=u()(m,2),s=p[0],A=p[1],r=function(){var d=window.innerWidth,O=window.innerHeight;A({height:O,width:d})};(0,C.useEffect)(function(){window.addEventListener("resize",function(){r()}),r()},[l]);var o=l.query?Object.keys(l.query).map(function(x){return"".concat(x,"=").concat(l.query[x])}):[];return(0,E.jsx)(P.Link,{target:"_blank",to:"/console/"+l.container+"?width=".concat(s.width,"&height=").concat(s.height,"&").concat(o.join("&")),children:(0,E.jsxs)(g.Z,{title:l.tips?l.tips:"\u7EC8\u7AEF",children:[(0,E.jsx)(T.Z,{})," ",l.content]})})}},91058:function(Y,L,e){var U=e(5574),u=e.n(U),T=e(89035),P=e(38345),g=e(17186),C=e(24739),E=e(5966),B=e(42075),l=e(28036),m=e(85576),p=e(67294),s=e(95089),A=e(89063),r=e(85893),o="docker-image",x=(0,p.forwardRef)(function(d,O){var I=(0,p.useState)(o),h=u()(I,2),D=h[0],j=h[1],i=(0,p.useRef)(),N=(0,p.useState)(""),K=u()(N,2),ae=K[0],V=K[1],k=function(){D!="code"?j("code"):j(o)};(0,p.useImperativeHandle)(O,function(){return{addEnvItem:function(a,v){var R,n=(R=i.current)===null||R===void 0?void 0:R.getList(),J=!1;if(n==null||n.map(function(ie){if(ie.name==a){J=!0;return}}),!J){var q;(q=i.current)===null||q===void 0||q.add({name:a,value:v})}},clear:function(){var a;(a=i.current)===null||a===void 0||(a=a.getList())===null||a===void 0||a.map(function(v,R){var n;(n=i.current)===null||n===void 0||n.remove(R)})}}});function G(F){try{var a,v;F==""&&(F=z());for(var R=(a=(v=i.current)===null||v===void 0||(v=v.getList())===null||v===void 0?void 0:v.length)!==null&&a!==void 0?a:0,n=R;n>=0;n--){var J;(J=i.current)===null||J===void 0||J.remove(n)}var q=F.split(`
`),ie=0;q.map(function(S){var ce,t=S.split("=");t.length<2||((ce=i.current)===null||ce===void 0||ce.add({name:t[0],value:t.slice(1).join("=")},ie),ie++)})}catch(S){console.log(S)}}function z(){if(i&&i.current&&i.current.getList){var F,a=(F=i.current)===null||F===void 0?void 0:F.getList();if(a){var v=[];return a.map(function(R){v.push("".concat(R.name,"=").concat(R.value))}),v.join(`
`)}else return""}else return""}return(0,r.jsxs)(P.Z,{ghost:d.showCardGhost,title:d.label?d.label:null,headerBordered:!0,extra:(d.showCodeMode||d.showImportButton)&&(0,r.jsxs)(B.Z,{children:[d.showImportButton&&(0,r.jsx)("div",{style:{marginBottom:"-25px"},children:(0,r.jsx)(A.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(a){return G(a),!0},onLoad:function(a){if(a.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),d.showCodeMode?(0,r.jsx)(l.ZP,{icon:(0,r.jsx)(T.Z,{}),type:D=="code"?"primary":"default",onClick:k,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,r.jsx)(g.u,{name:d.name?d.name:"environment",actionRef:i,creatorButtonProps:d.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,min:100,label:d.listLabel,children:function(a,v,R){var n=R.getCurrentRowData();return(0,r.jsxs)(C.UW,{children:[(0,r.jsx)(E.Z,{width:d.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:d.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),(0,r.jsx)(E.Z,{width:d.showInDrawer?"sm":"md",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:!!d.requireValue}],disabled:d.showDisableValue,placeholder:n&&n.label?n.label:"\u8F93\u5165\u53D8\u91CF\u503C"})]})}}),(0,r.jsx)(m.Z,{width:"800px",open:D=="code",onCancel:function(){return j("docker-image")},onOk:function(){G(ae),j("docker-image")},children:(0,r.jsx)(s.ZP,{onChange:function(a){return V(a)},value:z(),height:"680px",theme:"light"})})]})});L.Z=x},80821:function(Y,L,e){e.d(L,{Z:function(){return l}});var U=e(5574),u=e.n(U),T=e(24963),P=e(86738),g=e(28036),C=e(83062),E=e(67294),B=e(85893);function l(m){var p=(0,E.useState)(!1),s=u()(p,2),A=s[0],r=s[1],o=(0,E.useContext)(T.Z),x=o.lang,d=o.notice,O=o.message,I=function(){r(!0),m.action().then(function(D){if(r(!1),typeof m.onSuccess=="function"&&m.onSuccess(D),m.messageSuccess){var j="";typeof m.messageSuccess=="function"?j=m.messageSuccess(D):j=m.messageSuccess,j=x("notification.".concat(j))+x("notification.title.success"),m.asynced?O.info(j):O.success(j)}}).catch(function(D){r(!1),typeof m.onError=="function"&&m.onError(D)})};return m.confirm?(0,B.jsx)(P.Z,{style:{width:500},title:m.confirmTitle?m.confirmTitle:x("notification.title.tip"),description:m.confirm,onConfirm:I,okText:"Yes",cancelText:"No",children:(0,B.jsx)(g.ZP,{disabled:m.disabled,icon:m.icon,loading:A,danger:m.danger,type:m.type,children:m.children})}):(0,B.jsx)(C.Z,{title:m.tips,children:(0,B.jsx)(g.ZP,{disabled:m.disabled,icon:m.icon,loading:A,onClick:I,danger:m.danger,type:m.type,children:m.children})})}},37413:function(Y,L,e){e.d(L,{Z:function(){return A}});var U=e(19632),u=e.n(U),T=e(27496),P=e(35995),g=e(99611),C=e(29158),E=e(38345),B=e(55241),l=e(42075),m=e(66309),p=e(67294),s=e(85893);function A(r){return(0,s.jsx)(B.Z,{placement:"right",content:(0,s.jsxs)(E.Z,{direction:"column",style:{width:500},ghost:!0,children:[(0,s.jsx)(E.Z,{title:"\u7AEF\u53E3",children:[].concat(u()(r.publicPort),u()(r.privatePort)).map(function(o,x){var d=r.serverIp;if(d!=""&&d.indexOf("http")===-1&&d.indexOf(":")>-1&&(d="[".concat(d,"]")),d==""){var O=document.location.protocol+"//"+document.location.hostname;d=O}return d==""&&(d=o.IP),(0,s.jsx)(l.Z,{size:"large",wrap:!0,children:(0,s.jsx)(m.Z,{color:o.PublicPort?"#2db7f5":"warning",icon:o.PublicPort?(0,s.jsx)(T.Z,{}):"",style:{marginBottom:5,width:210},children:o.PublicPort?(0,s.jsx)("a",{href:"".concat(d.indexOf("http")===0?d:"http://"+d,":").concat(o.PublicPort),target:"_blank",children:"".concat(o.PublicPort?o.IP+":"+o.PublicPort+" -> ":"").concat(o.PrivatePort,"/").concat(o.Type)},"link".concat(x)):"".concat(o.PrivatePort,"/").concat(o.Type)})},"space".concat(x))})}),r.domain.length>0&&(0,s.jsx)(E.Z,{title:"\u57DF\u540D",children:(0,s.jsx)(l.Z,{direction:"vertical",style:{textAlign:"left"},children:r.domain.map(function(o,x){return(0,s.jsx)(m.Z,{color:"blue",icon:(0,s.jsx)(T.Z,{}),children:(0,s.jsx)("a",{href:o,target:"_blank",children:o})},"domain".concat(x))})})})]}),children:(0,s.jsxs)(l.Z,{direction:"vertical",children:[r.privatePort.length>0&&(0,s.jsxs)(m.Z,{color:"warning",icon:(0,s.jsx)(P.Z,{}),children:["\u5185\u90E8\u7AEF\u53E3: ",r.privatePort.length]}),r.publicPort.length>0&&(0,s.jsxs)(m.Z,{color:"#2db7f5",icon:(0,s.jsx)(g.Z,{}),children:["\u5BF9\u5916\u7AEF\u53E3: ",r.publicPort.length]}),r.domain.length>0&&(0,s.jsxs)(m.Z,{color:"blue",icon:(0,s.jsx)(C.Z,{}),children:["\u7ED1\u5B9A\u57DF\u540D: ",r.domain.length]})]})})}},94359:function(Y,L,e){e.d(L,{Z:function(){return A}});var U=e(67294),u=e(3089),T=e(98165),P=e(18429),g=e(8751),C=e(14313),E=e(30159),B=e(87740),l=e(66309),m=e(83062),p=e(63713),s=e(85893);function A(r){var o=(0,s.jsx)(s.Fragment,{});if(r.status=="0"&&(o=(0,s.jsx)(l.Z,{icon:(0,s.jsx)(u.Z,{}),color:"default",children:"waiting"})),r.status=="10"&&(o=(0,s.jsx)(l.Z,{icon:(0,s.jsx)(T.Z,{spin:!0}),color:"processing",children:"processing"})),r.status=="20"&&(o=(0,s.jsx)(l.Z,{icon:(0,s.jsx)(P.Z,{}),color:"error",children:"error"})),r.status=="30"&&(o=(0,s.jsx)(l.Z,{icon:(0,s.jsx)(g.Z,{}),color:"success",children:"success"})),r.status=="running"||r.status=="healthy"){var x,d;o=(0,s.jsx)(l.Z,{icon:(0,s.jsx)(C.Z,{}),color:"success",children:(x=r.message)!==null&&x!==void 0&&x.showInTag?(d=r.message)===null||d===void 0?void 0:d.content:r.status})}if(r.status=="paused"){var O,I;o=(0,s.jsx)(l.Z,{icon:(0,s.jsx)(E.Z,{}),children:(O=r.message)!==null&&O!==void 0&&O.showInTag?(I=r.message)===null||I===void 0?void 0:I.content:r.status})}if(r.status=="waiting"||r.status=="starting"){var h,D;o=(0,s.jsx)(l.Z,{icon:(0,s.jsx)(B.Z,{}),children:(h=r.message)!==null&&h!==void 0&&h.showInTag?(D=r.message)===null||D===void 0?void 0:D.content:r.status})}if(r.status=="exited"||r.status=="dead"||r.status=="removing"||r.status=="restarting"||r.status=="unhealthy"||r.status=="created"){var j,i;o=(0,s.jsx)(l.Z,{icon:(0,s.jsx)(P.Z,{}),color:"warning",children:(j=r.message)!==null&&j!==void 0&&j.showInTag?(i=r.message)===null||i===void 0?void 0:i.content:r.status})}if(r.link&&(o=(0,s.jsx)(p.Link,{to:r.link,children:o})),r.message){var N;o=(0,s.jsx)(m.Z,{placement:(N=r.message.placement)!==null&&N!==void 0?N:"top",title:r.message.content,children:o})}return(0,s.jsx)(s.Fragment,{children:o})}},89063:function(Y,L,e){e.d(L,{Z:function(){return B}});var U=e(24963),u=e(88484),T=e(62370),P=e(31418),g=e(28036),C=e(67294),E=e(85893);function B(l){var m=(0,C.useContext)(U.Z),p=m.message,s=m.notice,A=m.lang,r=(0,C.useRef)(null),o=P.Z.useApp(),x=function(){r.current&&(r.current.click(),r.current.onchange=function(O){if(!O||!O.target)return"";var I=new FileReader;I.onload=function(D){var j,i,N=(j=D.target)===null||j===void 0?void 0:j.result;if(l.onLoad)try{l.onLoad&&l.onLoad(N)}catch(K){s.error(K);return}typeof l.onImport=="function"&&(p.success("\u6210\u529F\u5BFC\u5165 ".concat(l.title)),l.onImport(N)),(i=r.current)!==null&&i!==void 0&&i.value&&(r.current.value="")};var h=O.target;if(h.files)try{I.readAsText(h.files[0])}catch(D){s.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(T.Z,{children:(0,E.jsx)(g.ZP,{icon:(0,E.jsx)(u.Z,{}),block:!0,onClick:x,children:l.title})}),(0,E.jsx)("input",{style:{display:"none"},type:"file",ref:r,name:"importFileInput"})]})}},92754:function(Y,L,e){var U=e(5574),u=e.n(U),T=e(67294),P=e(63713),g=e(38703),C=e(85893),E=(0,T.forwardRef)(function(B,l){var m=(0,T.useState)(""),p=u()(m,2),s=p[0],A=p[1];(0,T.useImperativeHandle)(l,function(){return{setFinish:function(){O({finish:{downloading:100,extracting:100}})},setStart:function(h){h&&A(h),O({start:{downloading:0,extracting:0}})}}});var r=(0,P.useModel)("subscriber");r.addDataHandler("image:pull:"+s,function(I){O(I.data)});var o=(0,T.useState)(),x=u()(o,2),d=x[0],O=x[1];return(0,T.useEffect)(function(){O({start:{downloading:0,extracting:0}})},[]),(0,C.jsx)(C.Fragment,{children:d&&Object.keys(d).map(function(I){return(0,C.jsx)(g.Z,{percent:d[I].downloading,success:{percent:d[I].extracting}},I)})})});L.Z=E},54964:function(Y,L,e){e.d(L,{a:function(){return m}});var U=e(78267),u=e.n(U),T=e(75458),P=e.n(T),g=e(67294),C=e(12320),E=e.n(C),B=e(89629),l=e(85893),m={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},p=new C.Terminal(m),s=new T.SearchAddon,A=new U.FitAddon,r=(0,g.forwardRef)(function(o,x){return(0,g.useEffect)(function(){window.addEventListener("resize",function(){o.showInModal||A.fit()}),o.style&&o.style.fontSize&&(p.options.fontSize=o.style.fontSize),p.loadAddon(A),p.loadAddon(s),p.open(document.getElementById("terminal-container")),o.showInModal||A.fit()},[]),(0,g.useImperativeHandle)(x,function(){return{write:function(O){p.write(O)},clear:function(){p.clear()},getTerminal:function(){return p},findNext:function(O){s.findNext(O)},findPrev:function(O){s.findPrevious(O)},fit:function(){A.fit()},onData:function(O){p.onData(O)}}}),(0,l.jsx)("div",{id:"terminal-container",style:{width:o.width?o.width:"100%",height:o.height?o.height:"500px"}})});L.Z=r},24963:function(Y,L,e){var U=e(67294),u=(0,U.createContext)({});L.Z=u},9740:function(Y,L,e){e.r(L),e.d(L,{default:function(){return Re}});var U=e(15009),u=e.n(U),T=e(99289),P=e.n(T),g=e(5574),C=e.n(g),E=e(80821),B=e(54964),l=e(90098),m=e(43425),p=e(74842),s=e(48689),A=e(33160),r=e(87784),o=e(30159),x=e(86548),d=e(89035),O=e(45742),I=e(90078),h=e(38345),D=e(97269),j=e(62370),i=e(63713),N=e(28036),K=e(42075),ae=e(25593),V=e(84567),k=e(96074),G=e(63490),z=e(83062),F=e(92398),a=e(67294),v=e(99861),R=e(95089),n=e(95213),J=e(24963),q=e(91058),ie=e(12320),S=e(89629),ce=e(78267),t=e(85893),_e=new ie.Terminal(B.a),Ee=new ce.FitAddon;function xe(se){var le=(0,i.useModel)("subscriber");return le.addDataHandler("compose:log:"+se.id,function(me){_e.write(me.data)}),(0,a.useEffect)(function(){return window.addEventListener("resize",function(){Ee.fit()}),_e.options.fontSize=12,_e.loadAddon(Ee),_e.open(document.getElementById("terminal-log")),Ee.fit(),_e.clear(),function(){le.progress.close("compose:log:"+se.id)}},[se.id]),(0,t.jsx)("div",{id:"terminal-log",style:{width:"100%",height:"500px"}})}var ye=e(37413),Te=e(87662),Ie=e(94359),Ae=e(57165),Fe=e(79245);function Re(){var se,le,me,ge=(0,a.useContext)(J.Z),pe=ge.loading,Le=ge.lang,Ge=ge.notice,fe=(0,i.useParams)(),Be=(0,i.useNavigate)(),Ue=(0,a.useState)(),De=C()(Ue,2),c=De[0],Ze=De[1],ee=(0,a.useRef)(),We=(0,a.useState)(0),je=C()(We,2),te=je[0],ue=je[1],Se=(0,a.useState)("default"),Oe=C()(Se,2),be=Oe[0],oe=Oe[1],X=(0,a.useRef)(),Ce=(0,i.useModel)("subscriber"),Ke=(0,a.useState)(""),Me=C()(Ke,2),we=Me[0],Ve=Me[1],he=(0,a.useRef)(),ve=(0,a.useRef)(),Pe=(0,a.useRef)();return Ce.addDataHandler("compose:"+fe.id,function(M){var f;(f=ee.current)===null||f===void 0||f.write(M.data)}),(0,a.useEffect)(function(){var M;return pe.show(),(0,l.Pn)({id:parseInt((M=fe.id)!==null&&M!==void 0?M:"")}).then(function(f){var _=f.data.detail;_.setting.status&&_.setting.status.indexOf("running")>-1&&(_.isRunning=!0),_.setting.status&&_.setting.status.indexOf("paused")>-1&&(_.isPaused=!0),_.setting.status&&_.setting.status.indexOf("exited")>-1&&(_.isExited=!0),_.setting.status&&_.setting.status=="waiting"?_.isDeploy=!1:_.isDeploy=!0,_.setting.status&&_.setting.status.indexOf("created")>-1&&(_.isCreated=!0,_.isDeploy=!1),f.data.project&&(_.imageList=Object.keys(f.data.project.services).map(function(W){var $;return($=f.data.project.services[W].image)!==null&&$!==void 0?$:""}));var y=f.data.project;if((!f.data.containerList||f.data.containerList.length==0)&&y&&y.services&&(f.data.containerList=Object.keys(y.services).map(function(W){return{name:"-",service:W,publishers:y.services[W].ports?y.services[W].ports.map(function($){var w;return{url:"",targetPort:$.target,publishedPort:parseInt($.published),protocol:(w=$.protocol)!==null&&w!==void 0?w:""}}):[],state:"waiting",status:""}})),f.data.containerList){var b;(0,Te.EH)().then(function(W){Ve(W.data.ip)}),_.containerList=f.data.containerList,(b=X.current)===null||b===void 0||b.setFieldValue("deployServiceName",f.data.containerList.map(function(W){return W.service}))}if(_.yamlList=f.data.yaml,Ze(_),y!=null&&y.services&&Object.keys(y.services).map(function(W){var $=[];if(y.services&&y.services[W]&&(y.services[W].environment&&Object.keys(y.services[W].environment).map(function(de){y.services[W].environment&&$.push({name:de,value:y.services[W].environment[de]})}),$.length!=0)){var w;(w=X.current)===null||w===void 0||w.setFieldValue(["environmentService",W],$)}}),f.data.detail.setting.environment){var H;(H=X.current)===null||H===void 0||H.setFieldValue("environment",f.data.detail.setting.environment)}else{var Z,ne=(0,Fe.m)(f.data.yaml[0]);(Z=X.current)===null||Z===void 0||Z.setFieldValue("environment",ne)}if(_.isDeploy){var Q;(0,l.VN)({id:parseInt((Q=fe.id)!==null&&Q!==void 0?Q:"")})}}).catch(function(f){console.log(f),Be("/compose/list")}).finally(function(){pe.destroy()}),function(){Ce.progress.close("compose:log:"+fe.id)}},[te]),(0,t.jsx)(I._z,{header:{extra:[(0,t.jsx)(i.Link,{to:"/compose/create",reloadDocument:location.search.length>0,children:(0,t.jsx)(N.ZP,{type:"primary",children:"\u521B\u5EFA\u4EFB\u52A1"},"createCompose")},"create")]},children:(0,t.jsxs)(h.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,t.jsx)(h.Z,{title:(0,t.jsx)(m.Z,{}),subTitle:"\u64CD\u4F5C - "+(c==null?void 0:c.name),bordered:!0,extra:(0,t.jsx)(t.Fragment,{children:c&&c.imageList&&c.imageList.length>0&&(0,t.jsx)(v.Z,{ref:Pe,image:c.imageList})}),headerBordered:!0,children:c&&(0,t.jsxs)(K.Z,{wrap:!0,children:[(0,t.jsx)(E.Z,{icon:(0,t.jsx)(p.Z,{}),type:"primary",confirm:(0,t.jsxs)(K.Z,{style:{width:300},direction:"vertical",children:[(0,t.jsx)(ae.Z.Text,{children:"\u91CD\u65B0\u521B\u5EFA\u8BE5\u4EFB\u52A1\u4E0B\u7684\u5BB9\u5668\uFF1F"}),(0,t.jsxs)(D.A,{name:"createForm",formRef:ve,layout:"inline",submitter:!1,children:[(0,t.jsx)(j.Z,{initialValue:!1,name:"pullImageUseCommand",valuePropName:"checked",children:(0,t.jsx)(V.Z,{children:"\u4F7F\u7528\u547D\u4EE4\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u547D\u4EE4\u4EE3\u7406\uFF09\uFF1F"})}),(0,t.jsx)(j.Z,{initialValue:!0,name:"pullImageUseDPanel",valuePropName:"checked",children:(0,t.jsx)(V.Z,{defaultChecked:!0,children:"\u4F7F\u7528\u9762\u677F\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u4ED3\u5E93\u52A0\u901F\uFF09\uFF1F"})}),(0,t.jsx)(j.Z,{initialValue:!0,name:"createPath",valuePropName:"checked",children:(0,t.jsx)(V.Z,{defaultChecked:!0,children:"\u521B\u5EFA\u6302\u8F7D\u76EE\u5F55\uFF08\u4EC5\u9762\u677F\u975E\u5BB9\u5668\u90E8\u7F72\u751F\u6548\uFF09\uFF1F"})})]})]}),action:P()(u()().mark(function M(){var f,_,y,b,H,Z,ne,Q,W,$,w,de;return u()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(oe("deploy"),(f=ee.current)===null||f===void 0||f.clear(),Q={id:(_=c==null?void 0:c.id)!==null&&_!==void 0?_:0},!((y=ve.current)!==null&&y!==void 0&&y.getFieldValue&&ve.current.getFieldValue("pullImageUseDPanel"))){re.next=7;break}return re.next=6,(W=Pe.current)===null||W===void 0?void 0:W.start();case 6:($=Pe.current)===null||$===void 0||$.finish();case 7:if(Q.environment=(b=X.current)===null||b===void 0?void 0:b.getFieldValue("environment"),Q.deployServiceName=(H=X.current)===null||H===void 0?void 0:H.getFieldValue("deployServiceName"),Q.createPath=(Z=(ne=ve.current)===null||ne===void 0?void 0:ne.getFieldValue("createPath"))!==null&&Z!==void 0?Z:!0,!(c!=null&&c.isDeploy)){re.next=14;break}if(!((w=ve.current)!==null&&w!==void 0&&w.getFieldValue("pullImageUseCommand"))){re.next=14;break}return re.next=14,(0,l.GG)({id:(de=c==null?void 0:c.id)!==null&&de!==void 0?de:0,op:"pull"});case 14:return re.next=16,(0,l.Oh)(Q);case 16:ue(te+1);case 17:case"end":return re.stop()}},M)})),children:c.isDeploy?"\u66F4\u65B0":"\u542F\u52A8"},"create"),(c.isDeploy||c.isCreated)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.Z,{action:function(){var f,_;return(f=ee.current)===null||f===void 0||f.clear(),oe("destory"),(0,l.mg)({id:(_=c==null?void 0:c.id)!==null&&_!==void 0?_:0,deleteImage:!1,deleteData:!1,deleteVolume:!1,deletePath:!1})},onSuccess:function(){ue(te+1)},confirm:"\u662F\u5426\u8981\u5220\u9664\u5BB9\u5668\uFF1F",type:"primary",danger:!0,messageSuccess:"delete",icon:(0,t.jsx)(s.Z,{}),children:"\u5220\u9664\u5E76\u505C\u6B62"}),(0,t.jsx)(k.Z,{type:"vertical"})]}),c.isDeploy&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.Z,{icon:(0,t.jsx)(A.Z,{}),action:P()(u()().mark(function M(){var f;return u()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return oe("crtl"),y.next=3,(0,l.GG)({id:(f=c==null?void 0:c.id)!==null&&f!==void 0?f:0,op:"restart"});case 3:ue(te+1);case 4:case"end":return y.stop()}},M)})),children:"\u91CD\u542F"},"restart"),(0,t.jsx)(E.Z,{action:function(){var f,_;return(f=ee.current)===null||f===void 0||f.clear(),oe("crtl"),(0,l.GG)({id:(_=c==null?void 0:c.id)!==null&&_!==void 0?_:0,op:"stop"})},messageSuccess:"stop",icon:(0,t.jsx)(r.Z,{}),disabled:c.isExited,onSuccess:function(){ue(te+1)},children:"\u505C\u6B62"}),c.isPaused&&(0,t.jsx)(E.Z,{action:function(){var f,_;return oe("crtl"),(f=ee.current)===null||f===void 0||f.clear(),(0,l.GG)({id:(_=c==null?void 0:c.id)!==null&&_!==void 0?_:0,op:"unpause"})},messageSuccess:"resume",onSuccess:function(){ue(te+1)},icon:(0,t.jsx)(p.Z,{}),children:"\u6062\u590D"}),!c.isPaused&&(0,t.jsx)(E.Z,{action:function(){var f,_;return oe("crtl"),(f=ee.current)===null||f===void 0||f.clear(),(0,l.GG)({id:(_=c==null?void 0:c.id)!==null&&_!==void 0?_:0,op:"pause"})},onSuccess:function(){ue(te+1)},messageSuccess:"pause",icon:(0,t.jsx)(o.Z,{}),disabled:!c.isRunning,children:"\u6682\u505C"})]}),(0,t.jsx)(k.Z,{type:"vertical"}),c.id>0&&(0,t.jsx)(i.Link,{to:"/compose/create?id="+c.id,children:(0,t.jsx)(N.ZP,{icon:(0,t.jsx)(x.Z,{}),children:"\u7F16\u8F91\u4EFB\u52A1"})}),c.isDeploy&&(0,t.jsx)(E.Z,{type:"primary",action:P()(u()().mark(function M(){var f,_,y,b,H,Z,ne,Q,W;return u()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return(f=ee.current)===null||f===void 0||f.clear(),oe("destory"),w.next=4,(0,l.mg)({id:(_=c==null?void 0:c.id)!==null&&_!==void 0?_:0,deleteImage:(y=(b=he.current)===null||b===void 0?void 0:b.getFieldValue("deleteImage"))!==null&&y!==void 0?y:!1,deleteData:!0,deleteVolume:(H=(Z=he.current)===null||Z===void 0?void 0:Z.getFieldValue("deleteVolume"))!==null&&H!==void 0?H:!1,deletePath:(ne=(Q=he.current)===null||Q===void 0?void 0:Q.getFieldValue("deletePath"))!==null&&ne!==void 0?ne:!1});case 4:W=w.sent,ue(te+1);case 6:case"end":return w.stop()}},M)})),danger:!0,confirm:(0,t.jsxs)(K.Z,{style:{width:200},direction:"vertical",children:[(0,t.jsx)(ae.Z.Text,{children:"\u5220\u9664\u5BB9\u5668\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"}),(0,t.jsxs)(D.A,{formRef:he,layout:"inline",submitter:!1,children:[(0,t.jsx)(j.Z,{initialValue:!1,name:"deleteImage",valuePropName:"checked",children:(0,t.jsx)(V.Z,{children:"\u5220\u9664\u955C\u50CF\uFF1F"})}),(0,t.jsx)(j.Z,{initialValue:!1,name:"deleteVolume",valuePropName:"checked",children:(0,t.jsx)(V.Z,{children:"\u5220\u9664\u5B58\u50A8\u5377\uFF1F"})}),(0,t.jsx)(j.Z,{initialValue:!1,name:"deletePath",valuePropName:"checked",children:(0,t.jsx)(V.Z,{children:"\u5220\u9664\u4EFB\u52A1\u76EE\u5F55\uFF1F"})})]})]}),children:"\u5220\u9664\u4EFB\u52A1"})]})},"operator"),(0,t.jsxs)(h.Z,{split:"vertical",children:[(0,t.jsxs)(h.Z,{colSpan:"45%",direction:"column",split:"horizontal",title:"\u542F\u52A8\u914D\u7F6E",subTitle:"\u7F16\u8F91\u540E\u53EA\u5F71\u54CD\u672C\u6B21\u90E8\u7F72",children:[be!="default"&&(0,t.jsx)(h.Z,{title:(0,t.jsx)(d.Z,{}),subTitle:"\u63A7\u5236\u53F0",extra:(0,t.jsx)(K.Z,{children:(0,t.jsx)(E.Z,{action:function(){var f;return(f=ee.current)===null||f===void 0||f.clear(),(0,l.U_)({})},icon:(0,t.jsx)(s.Z,{}),danger:!0,onSuccess:function(){ue(te+1)},children:"\u4E2D\u6B62\u6267\u884C"},"kill")}),children:(0,t.jsx)(B.Z,{height:"300px",style:{fontSize:12},ref:ee})}),c&&(0,t.jsx)(h.Z,{children:(0,t.jsx)(G.Z,{rowKey:"service",pagination:!1,columns:[{title:"\u5BB9\u5668\u540D",dataIndex:"name"},{title:"\u670D\u52A1\u540D",dataIndex:"service"},{title:"\u7AEF\u53E3",render:function(f,_,y){var b=[],H=[];return _.publishers&&_.publishers.map(function(Z){Z.publishedPort?b.push({PrivatePort:Z.targetPort,Type:Z.protocol,IP:Z.url,PublicPort:Z.publishedPort}):Z.publishedPort&&H.push({PrivatePort:Z.targetPort,Type:Z.protocol,IP:Z.url,PublicPort:Z.publishedPort})}),(0,t.jsx)(ye.Z,{publicPort:b,privatePort:H,domain:[],serverIp:we})}},{title:"\u72B6\u6001",render:function(f,_,y){return(0,t.jsx)(Ie.Z,{status:_.state,message:{content:Le("container.status.".concat(_.state)),placement:"top",showInTag:!0}},_.name)}},{title:"\u64CD\u4F5C",render:function(f,_,y){return(0,t.jsxs)(K.Z,{split:(0,t.jsx)(k.Z,{type:"vertical"}),children:[(0,t.jsx)(i.Link,{to:"/app/detail/edit/"+_.name,target:"_blank",children:(0,t.jsx)(z.Z,{title:"\u7BA1\u7406\u5BB9\u5668",children:(0,t.jsx)(m.Z,{})})},"edit"),_.state=="running"&&(0,t.jsx)(Ae.Z,{container:_.name},"console")]})}}],dataSource:c.containerList,rowSelection:c.containerList?{defaultSelectedRowKeys:c.containerList.map(function(M){return M.service}),onChange:function(f,_,y){var b;(b=X.current)===null||b===void 0||b.setFieldValue("deployServiceName",f)}}:null})}),(0,t.jsxs)(D.A,{formRef:X,submitter:!1,children:[(0,t.jsx)(j.Z,{name:"deployServiceName",hidden:!0}),!(c!=null&&c.isDeploy)&&(0,t.jsx)(h.Z,{title:"\u73AF\u5883\u53D8\u91CF",subTitle:"\u9762\u677F\u751F\u6210 .dpanel.env \u6587\u4EF6\uFF0C\u540C\u65F6\u4F1A\u52A0\u8F7D .env",children:(0,t.jsx)(q.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,showInDrawer:!0,requireValue:!0})}),!(c!=null&&c.isDeploy)&&(0,t.jsx)(h.Z,{title:"\u670D\u52A1\u73AF\u5883\u53D8\u91CF",tooltip:"\u4FEE\u6539\u670D\u52A1\u4E2D\u7684\u73AF\u5883\u53D8\u91CF\u65F6\uFF0C\u8BF7\u5728 yaml \u4E2D\u5C06\u503C\u5148\u6620\u5C04\u6210\u81EA\u5B9A\u4E49\u7684\u53D8\u91CF\u540D",children:(0,t.jsx)(F.Z,{indicator:{align:"center"},items:X&&X.current&&((se=X.current)===null||se===void 0?void 0:se.getFieldValue("environmentService"))&&Object.keys((le=X.current)===null||le===void 0?void 0:le.getFieldValue("environmentService")).map(function(M){return{label:M,key:M,children:(0,t.jsx)(q.Z,{showCardGhost:!0,name:["environmentService",M],showDisableName:!0,showDisableValue:!0,showInDrawer:!0,requireValue:!0})}})})})]})]}),c&&!c.isDeploy&&(0,t.jsx)(h.Z,{colSpan:"55%",children:(0,t.jsx)(F.Z,{items:c.yamlList&&c.yamlList.map(function(M,f){var _=[{label:"Yaml \u6587\u4EF6",key:"yaml"},{label:"\u8986\u76D6 Yaml \u6587\u4EF6",key:"yamlOverride"}];return{label:_[f].label,key:_[f].key,disabled:M=="",children:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(R.ZP,{theme:"dark",minHeight:"550px",value:M,readOnly:!0,extensions:[n.RI.yaml()]})})}})})}),c&&c.isDeploy&&(0,t.jsx)(h.Z,{title:(0,t.jsx)(O.Z,{}),subTitle:"\u65E5\u5FD7",colSpan:"55%",children:(0,t.jsx)(xe,{id:(me=fe.id)!==null&&me!==void 0?me:""})})]})]})})}},90098:function(Y,L,e){e.d(L,{CT:function(){return s},GG:function(){return h},MG:function(){return ae},Oh:function(){return x},Pn:function(){return m},U_:function(){return N},VN:function(){return j},iE:function(){return z},ik:function(){return r},im:function(){return C},mg:function(){return O},pm:function(){return B},xC:function(){return k}});var U=e(15009),u=e.n(U),T=e(99289),P=e.n(T),g=e(63713);function C(a){return E.apply(this,arguments)}function E(){return E=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/create",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),E.apply(this,arguments)}function B(a){return l.apply(this,arguments)}function l(){return l=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/get-list",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),l.apply(this,arguments)}function m(a){return p.apply(this,arguments)}function p(){return p=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/get-task",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),p.apply(this,arguments)}function s(a){return A.apply(this,arguments)}function A(){return A=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/get-detail",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),A.apply(this,arguments)}function r(a){return o.apply(this,arguments)}function o(){return o=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/delete",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),o.apply(this,arguments)}function x(a){return d.apply(this,arguments)}function d(){return d=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/container-deploy",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),d.apply(this,arguments)}function O(a){return I.apply(this,arguments)}function I(){return I=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/container-destroy",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),I.apply(this,arguments)}function h(a){return D.apply(this,arguments)}function D(){return D=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/container-ctrl",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),D.apply(this,arguments)}function j(a){return i.apply(this,arguments)}function i(){return i=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/container-log",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),i.apply(this,arguments)}function N(a){return K.apply(this,arguments)}function K(){return K=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/container-process-kill",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),K.apply(this,arguments)}function ae(a){return V.apply(this,arguments)}function V(){return V=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/get-from-uri",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),V.apply(this,arguments)}function k(a){return G.apply(this,arguments)}function G(){return G=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/app/compose/parse",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),G.apply(this,arguments)}function z(a){return F.apply(this,arguments)}function F(){return F=P()(u()().mark(function a(v){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.request)("/api/common/store/deploy",{method:"POST",data:v}));case 1:case"end":return n.stop()}},a)})),F.apply(this,arguments)}},3393:function(Y,L,e){e.d(L,{Gb:function(){return B},Pn:function(){return s},Rb:function(){return r},YU:function(){return C},ZQ:function(){return O},_U:function(){return m},cd:function(){return x}});var U=e(15009),u=e.n(U),T=e(99289),P=e.n(T),g=e(63713);function C(h){return E.apply(this,arguments)}function E(){return E=P()(u()().mark(function h(D){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,g.request)("/api/app/image/get-detail",{method:"POST",data:D}));case 1:case"end":return i.stop()}},h)})),E.apply(this,arguments)}function B(h){return l.apply(this,arguments)}function l(){return l=P()(u()().mark(function h(D){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,g.request)("/api/app/image/tag-remote",{method:"POST",data:D}));case 1:case"end":return i.stop()}},h)})),l.apply(this,arguments)}function m(h){return p.apply(this,arguments)}function p(){return p=P()(u()().mark(function h(D){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,g.request)("/api/app/image/tag-add",{method:"POST",data:D}));case 1:case"end":return i.stop()}},h)})),p.apply(this,arguments)}function s(h){return A.apply(this,arguments)}function A(){return A=P()(u()().mark(function h(D){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,g.request)("/api/app/image/tag-delete",{method:"POST",data:D}));case 1:case"end":return i.stop()}},h)})),A.apply(this,arguments)}function r(h){return o.apply(this,arguments)}function o(){return o=P()(u()().mark(function h(D){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,g.request)("/api/app/image/export",{method:"POST",data:D,responseType:"blob"}));case 1:case"end":return i.stop()}},h)})),o.apply(this,arguments)}function x(h){return d.apply(this,arguments)}function d(){return d=P()(u()().mark(function h(D){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,g.request)("/api/pro/image/get-remote-tag",{method:"POST",data:D}));case 1:case"end":return i.stop()}},h)})),d.apply(this,arguments)}function O(h){return I.apply(this,arguments)}function I(){return I=P()(u()().mark(function h(D){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,g.request)("/api/app/image/check-upgrade",{method:"POST",data:D}));case 1:case"end":return i.stop()}},h)})),I.apply(this,arguments)}},79245:function(Y,L,e){e.d(L,{m:function(){return T}});var U=e(64599),u=e.n(U);function T(P){var g=[];if(!P||P=="")return g;var C=P.matchAll(/\$\{(\w+)[:-]?(.*)\}/g),E=u()(C),B;try{for(E.s();!(B=E.n()).done;){var l=B.value;g.push({name:l[1],value:l[2]?l[2].indexOf("-")==0?l[2].substring(1):l[2]:""})}}catch(m){E.e(m)}finally{E.f()}return g}}}]);
