"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{99861:function(pe,V,n){var Y=n(15009),u=n.n(Y),z=n(64599),m=n.n(z),D=n(99289),w=n.n(D),$=n(5574),y=n.n($),K=n(83062),q=n(14726),E=n(42119),j=n(67294),ee=n(92754),oe=n(3393),ne=n(184),f=n(38345),O=n(85893),ie=(0,j.forwardRef)(function(S,ae){(0,j.useImperativeHandle)(ae,function(){return{}});var U=(0,j.useState)(0),a=y()(U,2),o=a[0],C=a[1],t=(0,j.useRef)();return(0,O.jsxs)(ne.a,{trigger:(0,O.jsx)(K.Z,{title:"\u5F53\u90E8\u7F72\u65F6\u65E0\u6CD5\u6B63\u5E38\u62C9\u53D6\u955C\u50CF\u65F6\uFF0C\u53EF\u4EE5\u624B\u52A8\u4F7F\u7528\u9762\u677F\u7684\u4ED3\u5E93\u52A0\u901F\u529F\u80FD\u62C9\u53D6\u6240\u6709\u955C\u50CF",children:(0,O.jsx)(q.ZP,{children:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF"})}),width:800,submitter:!1,title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",onOpenChange:function(){var ve=w()(u()().mark(function de(Pe){var Ce,ce,me,Fe,he,De,e;return u()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!Pe){k.next=25;break}ce=0,me=m()(S.image),k.prev=3,me.s();case 5:if((Fe=me.n()).done){k.next=15;break}return De=Fe.value,C(ce),(he=t.current)===null||he===void 0||he.setStart(),k.next=11,(0,oe.Gb)({tag:De,type:"pull"});case 11:e=k.sent,ce++;case 13:k.next=5;break;case 15:k.next=20;break;case 17:k.prev=17,k.t0=k.catch(3),me.e(k.t0);case 20:return k.prev=20,me.f(),k.finish(20);case 23:(Ce=t.current)===null||Ce===void 0||Ce.setFinish(),C(ce);case 25:case"end":return k.stop()}},de,null,[[3,17,20,23]])}));return function(de){return ve.apply(this,arguments)}}(),children:[(0,O.jsx)(f.Z,{children:(0,O.jsx)(E.Z,{current:o,items:S.image.map(function(ve,de){return{title:ve,key:de}})})}),(0,O.jsx)(f.Z,{children:(0,O.jsx)(ee.Z,{ref:t})})]})});V.Z=ie},44771:function(pe,V,n){n.d(V,{Z:function(){return D}});var Y=n(34041),u=n(25449),z=n(67294),m=n(85893);function D(w){return(0,m.jsx)(u.Z,{label:w.label,name:"restart",initialValue:w.defaultValue?w.defaultValue:"on-failure",children:(0,m.jsx)(Y.Z,{options:[{value:"no",label:"\u4E0D\u91CD\u542F"},{value:"on-failure",label:"\u5931\u8D25\u540E\u91CD\u542F\uFF08\u9ED8\u8BA45\u6B21\uFF09"},{value:"unless-stopped",label:"\u672A\u624B\u52A8\u505C\u6B62\u5219\u91CD\u542F"},{value:"always",label:"\u4E00\u76F4\u91CD\u542F"}]})})}},78451:function(pe,V,n){n.d(V,{Z:function(){return z}});var Y=n(67294),u=n(85893);function z(m){return(0,u.jsx)("span",{style:{wordBreak:"break-word"},children:m.content})}},29873:function(pe,V,n){n.r(V),n.d(V,{default:function(){return ln}});var Y=n(15009),u=n.n(Y),z=n(99289),m=n.n(z),D=n(5574),w=n.n(D),$=n(90078),y=n(38345),K=n(97269),q=n(2236),E=n(5966),j=n(97462),ee=n(64218),oe=n(92398),ne=n(40056),f=n(67294),O=n(35880),ie=n(10641),S=n(62370),ae=n(85576),U=n(42075),a=n(96074),o=n(14726),C=n(83062),t=n(71230),ve=n(15746),de=n(3393),Pe=n(18148),Ce=n(5251),ce=n(64789),me=n(75162),Fe=n(28307),he=n(78451),De=n(99861),e=n(85893);function Ie(d){var M=(0,f.useState)(!1),I=w()(M,2),R=I[0],p=I[1],B=(0,f.useRef)(),v=(0,f.useContext)(O.Z),x=v.createFormRef,T=v.volumeListRef,F=v.createEnvRef,c=v.domainRef,l=(0,f.useRef)(),A=function(){var P=m()(u()().mark(function _(i){var h,te,N,H,g,X,ue,se,J,L,Z,s;return u()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return p(!1),W.next=3,(0,de.YU)({md5:i});case 3:g=W.sent,d.redeploy||(J=(X=x.current)===null||X===void 0?void 0:X.getFieldsValue(),(ue=x.current)===null||ue===void 0||ue.resetFields(),(se=x.current)===null||se===void 0||se.setFieldsValue({siteName:J.siteName,siteTitle:J.siteTitle})),g.data.info.Config.Env&&g.data.info.Config.Env.map(function(G){var b,re=G.split("=");(b=F.current)===null||b===void 0||b.addEnvItem(re[0],re.slice(1).join("="))}),(h=x.current)===null||h===void 0||h.setFieldValue("imageName",i),(te=x.current)===null||te===void 0||te.setFieldValue("workDir",g.data.info.Config.WorkingDir),(N=c.current)===null||N===void 0||N.setExposePort(g.data.info.Config.ExposedPorts),g.data.info.Config.Volumes?(Z=[],Object.keys(g.data.info.Config.Volumes).map(function(G,b){Z.push(G)}),(L=T.current)===null||L===void 0||L.setDefaultDestPath(Z)):(s=T.current)===null||s===void 0||s.setDefaultDestPath([]),(H=x.current)===null||H===void 0||H.setFieldsValue({workDir:{value:"",useDefault:!0,default:g.data.info.Config.WorkingDir},user:{value:"",useDefault:!0,default:g.data.info.Config.User},command:{value:"",useDefault:!0,default:g.data.info.Config.Cmd.join(" ")},entrypoint:{value:"",useDefault:!0,default:g.data.info.Config.Entrypoint.join(" ")}});case 11:case"end":return W.stop()}},_)}));return function(i){return P.apply(this,arguments)}}();return(0,f.useEffect)(function(){d.fromImageId&&A(d.fromImageId)},[d.fromImageId]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ae.Z,{open:R,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return p(!1)},children:(0,e.jsx)(ie.Z,{scroll:{x:"max-content"},columns:[{title:"Id",dataIndex:"Id",search:!1,width:200,render:function(_,i,h,te,N){return(0,e.jsx)(he.Z,{content:i.Id})}},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",width:200,render:function(_,i,h,te){return(0,e.jsx)(he.Z,{content:i.RepoTags[0]})}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(_,i,h,te){return(0,e.jsx)("div",{children:(0,Ce.ZM)(i.Created*1e3)},i.Id)},sorter:function(_,i){return _.Created-i.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:"100px",render:function(_,i,h,te){return(0,e.jsxs)(U.Z,{split:(0,e.jsx)(a.Z,{type:"vertical"}),children:[(0,e.jsx)(o.ZP,{size:"small",onClick:m()(u()().mark(function N(){return u()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",A(i.RepoTags[0]));case 1:case"end":return g.stop()}},N)})),type:"link",icon:(0,e.jsx)(C.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(ce.Z,{})})},"addImage"),(0,e.jsx)(o.ZP,{size:"small",onClick:m()(u()().mark(function N(){var H;return u()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:i.RepoTags[0]&&((H=l.current)===null||H===void 0||H.setImageName(i.RepoTags[0]));case 1:case"end":return X.stop()}},N)})),type:"link",icon:(0,e.jsx)(C.Z,{title:"\u66F4\u65B0\u7248\u672C",children:(0,e.jsx)(me.Z,{})})},"updateImage")]})}}],request:function(){var P=m()(u()().mark(function _(i,h,te){var N,H,g,X,ue;return u()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return d.redeploy&&(H=(N=x.current)===null||N===void 0?void 0:N.getFieldValue("imageName"),i.tag=H?H.split(":")[0]:i.tag),J.next=3,(0,Pe.KG)({tag:i.tag});case 3:return g=J.sent,X=0,ue=[],g.data.list&&(ue=g.data.list.flatMap(function(L){return L.RepoTags.map(function(Z){return{Key:X++,Id:L.Id,Created:L.Created,RepoTags:[Z]}})})),J.abrupt("return",{data:ue,success:!0,total:ue.length});case 8:case"end":return J.stop()}},_)}));return function(_,i,h){return P.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(Fe.Z,{onClick:function(){p(!1)},buttonType:"primary",ref:l,onFinish:function(i){A(i)}},"remote")]},formRef:B,rowKey:"Key",pagination:{pageSize:5}})},"imageTableList"),(0,e.jsxs)(t.Z,{children:[(0,e.jsx)(ve.Z,{span:14,children:(0,e.jsx)(E.Z,{label:"\u955C\u50CF",tooltip:d.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0})}),(0,e.jsx)(ve.Z,{children:(0,e.jsx)(S.Z,{label:" ",children:(0,e.jsxs)(U.Z,{children:[(0,e.jsx)(o.ZP,{type:"primary",onClick:function(){return p(!0)},children:d.redeploy?"\u66F4\u65B0\u955C\u50CF":"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(j.Z,{name:["imageName"],children:function(_){var i=_.imageName;if(d.redeploy)return(0,e.jsx)(De.Z,{image:[i]})}})]})})})]})]})}var k=n(60335),Me=n(24969),fe=n(24739),Se=n(63434),Ee=n(17186),Re=n(46464),Ne=n(92067),Le=(0,f.forwardRef)(function(d,M){var I=(0,f.useState)(!1),R=w()(I,2),p=R[0],B=R[1],v=(0,f.useRef)(),x=function(c){var l=(0,f.useState)([]),A=w()(l,2),P=A[0],_=A[1];return(0,f.useEffect)(function(){(0,k.jV)({md5:c.name}).then(function(i){var h;return _((h=i.data.info.Config.Env)!==null&&h!==void 0?h:[]),!0})},[]),(0,e.jsxs)(y.Z,{bordered:!0,extra:c.action,style:{marginBottom:10},children:[(0,e.jsx)(y.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(fe.UW,{children:[(0,e.jsx)(E.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(E.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(Se.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(y.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(U.Z,{direction:"vertical",children:P&&P.map(function(i,h){return(0,e.jsx)(Re.Z.Text,{copyable:{icon:(0,e.jsx)(Me.Z,{}),onCopy:function(){var N=i.split("=");d.onAddEnv(N[0],N[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:i},style:{width:300},children:i},h)})},"linkEnv")})]})},T=function(c){var l,A,P=!1,_=(l=(A=v.current)===null||A===void 0?void 0:A.getList())!==null&&l!==void 0?l:[];if(_.map(function(h){h.name==c.name&&(P=!0)}),!P){var i;(i=v.current)===null||i===void 0||i.add(c)}};return(0,f.useImperativeHandle)(M,function(){return{setDefaultLink:function(c){c&&c.map(function(l){l.name!=""&&T(l)})}}}),(0,e.jsxs)(y.Z,{title:"\u5173\u8054\u5BB9\u5668",headerBordered:!0,children:[(0,e.jsx)(Ee.u,{name:"links",actionRef:v,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(c,l){return B(!0),!1}},copyIconProps:!1,min:0,itemRender:function(c,l){return(0,e.jsx)(x,{action:c.action,name:l.record.name})}}),(0,e.jsx)(ae.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:1024,footer:!1,open:p,onCancel:function(){return B(!1)},children:(0,e.jsx)(Ne.Z,{onSelect:function(c){T({name:c.Name,alise:c.Config.Hostname,volume:!1}),B(!1)}})})]})}),Ue=Le,We=n(91058),be=n(86615),we=n(64317),$e=(0,f.forwardRef)(function(d,M){var I=(0,f.useRef)();return(0,f.useImperativeHandle)(M,function(){return{setDefaultDestPath:function(p){var B,v,x=(B=(v=I.current)===null||v===void 0?void 0:v.getList())!==null&&B!==void 0?B:[];p.length!=0&&p.filter(function(T){return T!=""}).map(function(T){var F=!1;if(x.map(function(l){if(l.dest==T){F=!0;return}}),!F){var c;(c=I.current)===null||c===void 0||c.add({dest:T,permission:"write",inImage:!0,edit:!1})}})}}}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(y.Z,{title:"\u9ED8\u8BA4\u5B58\u50A8\uFF08Volume\uFF09",subTitle:"\u9ED8\u8BA4\u5B58\u50A8\u4E0E\u7AD9\u70B9\u6807\u8BC6\u4FDD\u6301\u4E00\u81F4",headerBordered:!0,children:(0,e.jsx)(Ee.u,{name:"volumesDefault",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u76EE\u5F55\u5230\u9ED8\u8BA4\u5B58\u50A8"},actionRef:I,copyIconProps:!1,min:0,children:function(p,B,v){var x=v.getCurrentRowData();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(E.Z,{width:"lg",name:"dest",label:"\u5BB9\u5668\u5185\u8DEF\u5F84",required:!0,rules:[{required:!0}],disabled:x.inImage}),(0,e.jsx)(be.Z.Group,{hidden:!0,name:"inImage",label:"\u955C\u50CF\u5185\u6302\u8F7D",valueEnum:{1:"\u662F",0:"\u5426"}})]})}})}),(0,e.jsx)(y.Z,{title:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u6216\u662F\u5B58\u50A8\u5377",tooltip:"\u6302\u8F7D\u53EF\u4EE5\u662F\u5BBF\u4E3B\u673A\u7684\u76EE\u5F55\u6216\u662F\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u5B58\u50A8\u5377\u540D\uFF08\u81EA\u52A8\u65B0\u5EFA\uFF09\u3002",headerBordered:!0,direction:"column",children:(0,e.jsx)(Ee.u,{name:"volumes",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u6620\u5C04\u76EE\u5F55"},copyIconProps:!1,min:0,children:(0,e.jsxs)(fe.UW,{children:[(0,e.jsxs)(U.Z.Compact,{children:[(0,e.jsx)(E.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u3001\u76EE\u5F55\u6216\u5B58\u50A8\u5377",name:"host",width:"md",required:!0,rules:[{required:!0}]}),(0,e.jsx)(we.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(E.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md",required:!0,rules:[{required:!0}]})]})})})]})}),Ke=$e,He=n(2831),Te=n(86125);function Ve(d){var M,I=(0,f.useState)(),R=w()(I,2),p=R[0],B=R[1];return(0,f.useEffect)(function(){(0,He.a)().then(function(v){return B(v.data.info)})},[]),(0,e.jsxs)(y.Z,{children:[(0,e.jsx)(E.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:"64M",tooltip:"0 \u4E3A\u4F7F\u7528\u9ED8\u8BA464M"}),(0,e.jsx)(S.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Te.Z,{step:.1,max:p==null?void 0:p.NCPU,marks:{0:"0",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(S.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Te.Z,{step:256,max:Math.round(((M=p==null?void 0:p.MemTotal)!==null&&M!==void 0?M:0)/1024/1024),marks:{0:"0",1024:"1G",2048:"2G",3072:"3G",4096:"4G"}})}),(0,e.jsx)(we.Z,{label:"\u65E5\u5FD7\u7C7B\u578B",name:["log","driver"],tooltip:"\u9ED8\u8BA4\u4F7F\u7528 json-file \u9A71\u52A8\u7531 docker \u7EDF\u4E00\u7BA1\u7406\u3002\u91C7\u7528 journal \u65F6\u65E5\u5FD7\u5C06\u6765\u5BBF\u4E3B\u673A\u7BA1\u7406",initialValue:"json-file",valueEnum:{"json-file":"json-file",journald:"journal (\u5BBF\u4E3B\u9700\u8981\u5B89\u88C5journal\u670D\u52A1)"}}),(0,e.jsx)(j.Z,{name:["log"],children:function(x){var T=x.log;if(T.driver=="json-file")return(0,e.jsxs)(fe.UW,{children:[(0,e.jsx)(E.Z,{label:"\u65E5\u5FD7\u5207\u5272\u5C3A\u5BF8",name:["log","maxSize"],placeholder:"\u4F8B\u5982\uFF1A10k,5M",tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u5207\u5272\u65E5\u5FD7"}),(0,e.jsx)(E.Z,{tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u6E05\u7406\u65E5\u5FD7\u6587\u4EF6",label:"\u4FDD\u7559\u65E5\u5FD7\u6587\u4EF6\u6570",name:["log","maxFile"],placeholder:"\u4F8B\u5982\uFF1A10"})]})}})]})}var Ge=n(90672);function Ye(){return(0,e.jsxs)(y.Z,{children:[(0,e.jsx)(Ge.Z,{label:"DNS\u914D\u7F6E",name:"dns",placeholder:"\u8BF7\u6307\u5B9Adns\u5730\u5740\uFF0C\u4F8B\u5982\uFF1A8.8.8.8\uFF0C\u4E00\u884C\u6DFB\u4E00\u6761dns\u5730\u5740"}),(0,e.jsx)(Ee.u,{name:"label",label:"\u5BB9\u5668\u6807\u7B7E",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(fe.UW,{children:[(0,e.jsx)(E.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(E.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})]})}var xe=n(52688),ze=n(44771),on="default",dn="user";function Xe(d){return(0,e.jsx)(S.Z,{label:d.label,tooltip:d.tooltip,children:(0,e.jsxs)(U.Z.Compact,{block:!0,children:[(0,e.jsx)(be.Z.Group,{radioType:"button",name:[d.name,"useDefault"],options:[{label:"\u4F7F\u7528\u9ED8\u8BA4",value:!0},{label:"\u81EA\u5B9A\u4E49",value:!1}]}),(0,e.jsx)(j.Z,{name:[d.name],children:function(I){return I[d.name]&&I[d.name].useDefault?(0,e.jsx)(E.Z,{name:[d.name,"default"],disabled:!0,placeholder:"\u672A\u8BBE\u7F6E"}):(0,e.jsx)(E.Z,{name:[d.name,"value"]})}})]})})}var Be=Xe;function Je(){return(0,e.jsxs)(y.Z,{children:[(0,e.jsx)(ze.Z,{label:"\u91CD\u542F\u7B56\u7565"}),(0,e.jsxs)(fe.UW,{children:[(0,e.jsx)(xe.Z,{name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(xe.Z,{name:"autoRemove",label:"\u505C\u6B62\u540E\u81EA\u52A8\u5220\u9664",initialValue:!1})]}),(0,e.jsx)(Be,{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55",name:"workDir"}),(0,e.jsx)(Be,{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237",name:"user"}),(0,e.jsx)(Be,{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command"}),(0,e.jsx)(Be,{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4",name:"entrypoint"})]})}var Qe=n(91845),Ze=n(62597),Oe=n(54006),qe=n(14946),en=n(93246),nn=n(31418),tn=n(66309),un=(0,f.forwardRef)(function(d,M){var I=(0,f.useState)(!1),R=w()(I,2),p=R[0],B=R[1],v=(0,f.useRef)(),x=nn.Z.useApp();(0,f.useImperativeHandle)(M,function(){return{}});var T=function(c){var l,A,P=!1,_=(l=(A=v.current)===null||A===void 0?void 0:A.getList())!==null&&l!==void 0?l:[];if(_.map(function(h){h.name==c.name&&(P=!0)}),!P){var i;(i=v.current)===null||i===void 0||i.add(c)}};return(0,e.jsxs)(y.Z,{title:"\u5173\u8054\u7F51\u7EDC",headerBordered:!0,children:[(0,e.jsx)(Ee.u,{name:"network",actionRef:v,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u7F51\u7EDC"},actionGuard:{beforeAddRow:function(c,l){return!d.siteName||d.siteName==""||typeof d.siteName=="undefined"?((0,en.YZ)(x,"\u8BF7\u8F93\u5165\u7AD9\u70B9\u6807\u8BC6"),!1):(B(!0),!1)}},copyIconProps:!1,min:0,itemRender:function(c,l){return(0,e.jsxs)(fe.UW,{children:[(0,e.jsx)(E.Z,{label:"\u7F51\u7EDC\u540D\u79F0",name:"name",width:"md",disabled:!0,fieldProps:{value:l.record.name}}),(0,e.jsx)(S.Z,{label:"\u8BBF\u95EEHostname",name:"alise",children:l.record.alise!=""&&(0,e.jsx)(Re.Z.Text,{code:!0,copyable:!0,children:l.record.alise})}),(0,e.jsx)(S.Z,{label:" ",children:c.action})]})}}),(0,e.jsx)(ae.Z,{title:"\u9009\u62E9\u7F51\u7EDC",width:1024,footer:!1,open:p,onCancel:function(){return B(!1)},children:(0,e.jsx)(ie.Z,{rowKey:"Name",columns:[{title:"\u540D\u79F0",dataIndex:"Name",render:function(c,l,A,P,_){return l.Name=="none"||l.Name=="bridge"||l.Name=="host"?(0,e.jsxs)(e.Fragment,{children:[l.Name," ",(0,e.jsx)(tn.Z,{color:"blue",children:"System"})]}):(0,e.jsx)(e.Fragment,{children:c})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,dataIndex:"Driver",search:!1},{title:"IPAM Driver",ellipsis:!0,width:120,search:!1,dataIndex:["IPAM","Driver"]},{title:"IPV4 IPAM Subnet",ellipsis:!0,width:150,search:!1,dataIndex:["IPAM","Config",0,"Subnet"]},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(c,l,A,P,_){return[(0,e.jsx)(o.ZP,{type:"link",onClick:function(){var h;T({name:l.Name,alise:[((h=d.siteName)!==null&&h!==void 0?h:"")+".pod.dpanel.local"]}),B(!1)},children:(0,e.jsx)(ce.Z,{})},l.Id)]}}],request:function(){var F=m()(u()().mark(function c(l,A,P){var _;return u()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,qe.jR)({name:l.Name});case 2:return _=h.sent,h.abrupt("return",{data:_.data.list,success:!0,total:_.data.list.length});case 4:case"end":return h.stop()}},c)}));return function(c,l,A){return F.apply(this,arguments)}}(),pagination:{pageSize:10}})})]})}),rn=un,an=n(82034);function _e(d){return(0,e.jsx)("div",{style:{display:d.show?"block":"none"},children:d.children})}function sn(){var d=(0,f.useRef)(),M=function(p){var B,v,x=!1,T=(B=(v=d.current)===null||v===void 0?void 0:v.getList())!==null&&B!==void 0?B:[];if(T.map(function(c){c.name==p.name&&(x=!0)}),!x){var F;(F=d.current)===null||F===void 0||F.add(p)}},I=function(p){var B,v,x=!1,T=(B=(v=d.current)===null||v===void 0?void 0:v.getList())!==null&&B!==void 0?B:[];T.map(function(F,c){if(F.name==p){var l;(l=d.current)===null||l===void 0||l.remove(c)}})};return(0,e.jsx)(y.Z,{title:"\u5173\u8054\u5BBF\u4E3B\u7F51\u7EDC\u4E3B\u673A",tooltip:"\u5BB9\u5668\u5185\u5982\u679C\u9700\u8981\u8BF7\u6C42\u5BBF\u4E3B\u673A\u6240\u5728\u7684\u7F51\u7EDC\u4E2D\u7684\u4E3B\u673A\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6B64\u914D\u7F6E\u5C06Ip\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D",extra:(0,e.jsx)(U.Z,{children:(0,e.jsx)(xe.Z,{name:"enableBindHost",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",unCheckedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",onChange:function(p){p?M({name:"host.dpanel.local",value:"host-gateway"}):I("host.dpanel.local")}}})}),children:(0,e.jsx)(Ee.u,{name:"extraHosts",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BBF\u4E3B\u673A\u7F51\u7EDC\u5173\u8054"},actionRef:d,copyIconProps:!1,min:0,children:(0,e.jsxs)(fe.UW,{children:[(0,e.jsx)(E.Z,{width:"md",name:"name",label:"Hostname",placeholder:""}),(0,e.jsx)(E.Z,{width:"md",name:"value",label:"ip",placeholder:""})]})})})}var ge="update",ke="copy",ye="new";function ln(){var d,M,I,R=(0,f.useContext)(O.Z),p=R.createFormRef,B=R.volumeListRef,v=R.domainRef,x=R.createEnvRef,T=R.createLinkRef,F=(0,f.useState)(ye),c=w()(F,2),l=c[0],A=c[1],P=(0,Oe.useSearchParams)(),_=w()(P,2),i=_[0],h=_[1],te=(0,Oe.useNavigate)(),N=(0,f.useState)("basic"),H=w()(N,2),g=H[0],X=H[1],ue=parseInt((d=i.get("id"))!==null&&d!==void 0?d:""),se=(M=i.get("containerId"))!==null&&M!==void 0?M:"",J=(I=i.get("imageId"))!==null&&I!==void 0?I:"";return(0,f.useEffect)(function(){if(se||ue)(0,Ze.iE)({md5:se,id:ue}).then(function(){var Z=m()(u()().mark(function s(r){var W,G,b,re,le;return u()().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:if(b={},!r.data.env.imageName){je.next=6;break}return je.next=4,(0,de.YU)({md5:r.data.env.imageName});case 4:re=je.sent,b=re.data;case 6:i.get("op")==ke?A(ke):A(ge),r.data.env.network&&r.data.env.network.map(function(Q){return!Q.alise&&Q.name!="bridge"&&(Q.alise=[r.data.siteName+".pod.dpanel.local"]),Q}),r.data.env.ports&&r.data.env.ports.map(function(Q){return Q.host=="0"&&(Q.host=""),Q}),le=r.data.env.bindIpV6,r.data.containerInfo.Info&&r.data.containerInfo.Info.NetworkSettings.Networks&&Object.keys(r.data.containerInfo.Info.NetworkSettings.Networks).map(function(Q){r.data.containerInfo.Info.NetworkSettings.Networks[Q].IPv6Gateway!=""&&(le=!0)}),r.data.env.extraHosts&&r.data.env.extraHosts.map(function(Q){if(Q.value=="host-gateway"){var Ae;(Ae=p.current)===null||Ae===void 0||Ae.setFieldValue("enableBindHost",!0)}}),(W=p.current)===null||W===void 0||W.setFieldsValue({siteTitle:l==ge?r.data.siteTitle:"",siteName:l==ge?r.data.siteName:"",imageName:r.data.env.imageName,privileged:r.data.env.privileged,bindIpV6:r.data.env.useHostNetwork?!1:le,useHostNetwork:r.data.env.useHostNetwork,publishAllPorts:r.data.env.useHostNetwork?!1:r.data.env.publishAllPorts,workDir:{value:r.data.env.workDir,useDefault:!r.data.env.workDir,default:b&&b.info.Config.WorkingDir},user:{value:r.data.env.user,useDefault:!r.data.env.user,default:b&&b.info.Config.User},command:{value:r.data.env.command,useDefault:!r.data.env.command,default:b&&b.info.Config.Cmd.join(" ")},entrypoint:{value:r.data.env.entrypoint,useDefault:!r.data.env.entrypoint,default:b&&b.info.Config.Entrypoint.join(" ")},shmsize:(G=r.data.env.shmsize)!==null&&G!==void 0?G:"64M",cpus:r.data.env.cpus,memory:r.data.env.memory,environment:r.data.env.environment,label:r.data.env.label,volumesDefault:r.data.env.volumesDefault,volumes:r.data.env.volumes,ports:r.data.env.ports,links:r.data.env.links,network:r.data.env.network,restart:r.data.env.restart,extraHosts:r.data.env.extraHosts,autoRemove:r.data.env.autoRemove,log:r.data.env.log,dns:r.data.env.dns&&r.data.env.dns.join(`
`)});case 13:case"end":return je.stop()}},s)}));return function(s){return Z.apply(this,arguments)}}());else{var L;A(ye),(L=p.current)===null||L===void 0||L.resetFields()}},[i]),(0,e.jsx)($._z,{children:(0,e.jsx)(y.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(K.A,{submitter:{render:function(Z,s){return(0,e.jsx)(q.S,{children:s})}},formRef:p,onFinish:function(){var L=m()(u()().mark(function Z(s){var r,W,G,b;return u()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return b={siteTitle:s.siteTitle,siteName:s.siteName,imageName:s.imageName,environment:s.environment,links:s.links,ports:s.ports,volumes:s.volumes,volumesDefault:s.volumesDefault,network:s.network,privileged:(r=s.privileged)!==null&&r!==void 0?r:!1,autoRemove:(W=s.autoRemove)!==null&&W!==void 0?W:!1,restart:s.restart,cpus:s.cpus,memory:s.memory,shmsize:(G=s.shmsize)!==null&&G!==void 0?G:0,workDir:s.workDir&&!s.workDir.useDefault?s.workDir.value:"",user:s.user&&!s.user.useDefault?s.user.value:"",command:s.command&&!s.command.useDefault?s.command.value:"",entrypoint:s.entrypoint&&!s.entrypoint.useDefault?s.entrypoint.value:"",useHostNetwork:s.useHostNetwork,bindIpV6:s.bindIpV6,log:s.log,dns:s.dns&&s.dns!=""?s.dns.split(`
`):[],label:s.label,publishAllPorts:s.publishAllPorts,extraHosts:s.extraHosts},se&&l==ge&&(b.containerId=se),le.next=4,(0,Ze.$G)(b);case 4:return te("/app/list"),le.abrupt("return",!0);case 6:case"end":return le.stop()}},Z)}));return function(Z){return L.apply(this,arguments)}}(),children:[(0,e.jsxs)(y.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(E.Z,{name:"siteTitle",label:"\u7AD9\u70B9\u540D\u79F0",required:!0,rules:[{required:!0}],fieldProps:{onChange:function(Z){var s="";if(Z.target.value&&l!=ge){var r,W=(0,Qe.N9)(Z.target.value.trim(),{toneType:"none",type:"array"});s=W.join(""),(r=p.current)===null||r===void 0||r.setFieldValue("siteName",s)}}},placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(E.Z,{name:"siteName",label:"\u7AD9\u70B9\u6807\u8BC6",tooltip:"\u7AD9\u70B9\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u7AD9\u70B9\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:l==ge,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(Ie,{redeploy:l!=ye,fromImageId:J})]}),(0,e.jsx)(ee.Z,{offsetTop:50,children:(0,e.jsx)(y.Z,{style:{marginBottom:-20},children:(0,e.jsx)(oe.Z,{activeKey:g,onChange:function(Z){X(Z),window.scrollTo(0,450)},items:[{label:"\u57FA\u672C\u914D\u7F6E",key:"basic"},{label:"\u5173\u8054\u914D\u7F6E",key:"link"},{label:"\u5B58\u50A8\u914D\u7F6E",key:"storage"},{label:"\u542F\u52A8\u914D\u7F6E",key:"run-command"},{label:"\u8D44\u6E90\u914D\u7F6E",key:"resource"},{label:"\u5176\u5B83",key:"other"}]})})}),(0,e.jsxs)(_e,{show:g=="basic",children:[(0,e.jsx)(an.Z,{ref:v,showBindHost:!0,showBindIpV6:!0}),(0,e.jsx)(We.Z,{showAddButton:!0,ref:x})]}),(0,e.jsx)(_e,{show:g=="link",children:(0,e.jsx)(j.Z,{name:["siteName","useHostNetwork"],children:function(Z){var s=Z.siteName,r=Z.useHostNetwork;return r?(0,e.jsx)(ne.Z,{showIcon:!0,description:"\u7ED1\u5B9A\u5230\u5BBF\u4E3B\u673A\u7F51\u7EDC\u65F6\uFF0C\u65E0\u6CD5\u901A\u8FC7 Docker \u5173\u8054\u5176\u5B83\u5BB9\u5668\u3002\u8BF7\u4F7F\u7528\u5BBF\u4E3B\u673A\u5185\u7F51IP\u6216\u662F127.0.0.1\u4E92\u8054\u5BB9\u5668\u66B4\u9732\u7AEF\u53E3\u3002"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ue,{onAddEnv:function(G,b){var re;(re=x.current)===null||re===void 0||re.addEnvItem(G,b)},ref:T}),(0,e.jsx)(rn,{siteName:s}),(0,e.jsx)(sn,{})]})}})}),(0,e.jsx)(_e,{show:g=="storage",children:(0,e.jsx)(Ke,{ref:B})}),(0,e.jsx)(_e,{show:g=="run-command",children:(0,e.jsx)(Je,{})}),(0,e.jsx)(_e,{show:g=="resource",children:(0,e.jsx)(Ve,{})}),(0,e.jsx)(_e,{show:g=="other",children:(0,e.jsx)(Ye,{})})]},"form")})})}},62597:function(pe,V,n){n.d(V,{$G:function(){return w},Ct:function(){return f},Tb:function(){return q},XH:function(){return j},cl:function(){return y},iE:function(){return oe},lK:function(){return ae},xb:function(){return ie}});var Y=n(15009),u=n.n(Y),z=n(99289),m=n.n(z),D=n(54006);function w(a){return $.apply(this,arguments)}function $(){return $=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,D.request)("/api/app/site/create-by-image",{method:"POST",data:o}));case 1:case"end":return t.stop()}},a)})),$.apply(this,arguments)}function y(a){return K.apply(this,arguments)}function K(){return K=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,D.request)("/api/app/site/get-list",{method:"POST",data:o}));case 1:case"end":return t.stop()}},a)})),K.apply(this,arguments)}function q(a){return E.apply(this,arguments)}function E(){return E=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o.download=!1,t.next=3,(0,D.request)("/api/app/log/run",{method:"POST",data:o});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},a)})),E.apply(this,arguments)}function j(a){return ee.apply(this,arguments)}function ee(){return ee=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o.download=!0,t.next=3,(0,D.request)("/api/app/log/run",{method:"POST",data:o,responseType:"blob"});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},a)})),ee.apply(this,arguments)}function oe(a){return ne.apply(this,arguments)}function ne(){return ne=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,D.request)("/api/app/site/get-detail",{data:o,method:"POST"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},a)})),ne.apply(this,arguments)}function f(a){return O.apply(this,arguments)}function O(){return O=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,D.request)("/api/app/container/delete",{method:"POST",data:o}));case 1:case"end":return t.stop()}},a)})),O.apply(this,arguments)}function ie(a){return S.apply(this,arguments)}function S(){return S=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,D.request)("/api/app/site/delete",{method:"POST",data:o}));case 1:case"end":return t.stop()}},a)})),S.apply(this,arguments)}function ae(a){return U.apply(this,arguments)}function U(){return U=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,D.request)("/api/app/site/update-title",{method:"POST",data:o});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},a)})),U.apply(this,arguments)}},2831:function(pe,V,n){n.d(V,{a:function(){return w},d:function(){return y}});var Y=n(15009),u=n.n(Y),z=n(99289),m=n.n(z),D=n(54006);function w(){return $.apply(this,arguments)}function $(){return $=m()(u()().mark(function q(){return u()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,D.request)("/api/common/home/info",{method:"POST"});case 2:return j.abrupt("return",j.sent);case 3:case"end":return j.stop()}},q)})),$.apply(this,arguments)}function y(){return K.apply(this,arguments)}function K(){return K=m()(u()().mark(function q(){return u()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,D.request)("/api/common/home/upgrade-script",{method:"POST"});case 2:return j.abrupt("return",j.sent);case 3:case"end":return j.stop()}},q)})),K.apply(this,arguments)}},14946:function(pe,V,n){n.d(V,{CI:function(){return q},HY:function(){return ie},IS:function(){return w},XY:function(){return oe},_3:function(){return ae},_x:function(){return j},jR:function(){return y},t9:function(){return f}});var Y=n(15009),u=n.n(Y),z=n(99289),m=n.n(z),D=n(54006);function w(a){return $.apply(this,arguments)}function $(){return $=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,D.request)("/api/app/network/get-detail",{method:"POST",data:o}));case 1:case"end":return t.stop()}},a)})),$.apply(this,arguments)}function y(a){return K.apply(this,arguments)}function K(){return K=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,D.request)("/api/app/network/get-list",{method:"POST",data:o}));case 1:case"end":return t.stop()}},a)})),K.apply(this,arguments)}function q(){return E.apply(this,arguments)}function E(){return E=m()(u()().mark(function a(){return u()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,D.request)("/api/app/network/prune",{method:"POST"});case 2:return C.abrupt("return",C.sent);case 3:case"end":return C.stop()}},a)})),E.apply(this,arguments)}function j(a){return ee.apply(this,arguments)}function ee(){return ee=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,D.request)("/api/app/network/delete",{method:"POST",data:o});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},a)})),ee.apply(this,arguments)}function oe(a){return ne.apply(this,arguments)}function ne(){return ne=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,D.request)("/api/app/network/create",{method:"POST",data:o});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},a)})),ne.apply(this,arguments)}function f(a){return O.apply(this,arguments)}function O(){return O=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,D.request)("/api/app/network/disconnect",{method:"POST",data:o});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},a)})),O.apply(this,arguments)}function ie(a){return S.apply(this,arguments)}function S(){return S=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,D.request)("/api/app/network/connect",{method:"POST",data:o});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},a)})),S.apply(this,arguments)}function ae(a){return U.apply(this,arguments)}function U(){return U=m()(u()().mark(function a(o){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,D.request)("/api/app/network/get-container-list",{method:"POST",data:o}));case 1:case"end":return t.stop()}},a)})),U.apply(this,arguments)}}}]);
