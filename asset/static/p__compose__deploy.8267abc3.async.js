"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7667],{99861:function(Y,A,e){var B=e(15009),f=e.n(B),F=e(64599),x=e.n(F),D=e(99289),M=e.n(D),v=e(5574),T=e.n(v),d=e(42119),u=e(67294),E=e(92754),r=e(3393),C=e(184),a=e(38345),i=e(85893),j=(0,u.forwardRef)(function(_,h){(0,u.useImperativeHandle)(h,function(){return{start:function(){return V(!0),te()},finish:function(){V(!1)}}});var y=(0,u.useState)(0),m=T()(y,2),g=m[0],P=m[1],l=(0,u.useRef)(),Q=(0,u.useState)(!1),J=T()(Q,2),de=J[0],V=J[1],te=function(){var N=M()(f()().mark(function G(){var z,Z,b,ce,re,ie,_e;return f()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:Z=0,b=x()(_.image),U.prev=2,b.s();case 4:if((ce=b.n()).done){U.next=14;break}return ie=ce.value,P(Z),(re=l.current)===null||re===void 0||re.setStart(ie),U.next=10,(0,r.Gb)({tag:ie,type:"pull"});case 10:_e=U.sent,Z++;case 12:U.next=4;break;case 14:U.next=19;break;case 16:U.prev=16,U.t0=U.catch(2),b.e(U.t0);case 19:return U.prev=19,b.f(),U.finish(19);case 22:(z=l.current)===null||z===void 0||z.setFinish(),P(Z);case 24:case"end":return U.stop()}},G,null,[[2,16,19,22]])}));return function(){return N.apply(this,arguments)}}();return(0,i.jsxs)(C.a,{trigger:_.trigger,width:800,open:de,submitter:!1,title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",onOpenChange:function(){var N=M()(f()().mark(function G(z){return f()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:V(z),z&&_.trigger&&te();case 2:case"end":return b.stop()}},G)}));return function(G){return N.apply(this,arguments)}}(),drawerProps:{forceRender:!0},children:[(0,i.jsx)(a.Z,{children:(0,i.jsx)(d.Z,{current:g,items:_.image.map(function(N,G){return{title:N,key:G}})})}),(0,i.jsx)(a.Z,{children:(0,i.jsx)(E.Z,{ref:l})})]})});A.Z=j},57165:function(Y,A,e){e.d(A,{Z:function(){return T}});var B=e(5574),f=e.n(B),F=e(89035),x=e(63713),D=e(83062),M=e(67294),v=e(85893);function T(d){var u=(0,M.useState)({height:800,width:1024}),E=f()(u,2),r=E[0],C=E[1],a=function(){var _=window.innerWidth,h=window.innerHeight;C({height:h,width:_})};(0,M.useEffect)(function(){window.addEventListener("resize",function(){a()}),a()},[d]);var i=d.query?Object.keys(d.query).map(function(j){return"".concat(j,"=").concat(d.query[j])}):[];return(0,v.jsx)(x.Link,{target:"_blank",to:"/console/"+d.container+"?width=".concat(r.width,"&height=").concat(r.height,"&").concat(i.join("&")),children:(0,v.jsxs)(D.Z,{title:d.tips?d.tips:"\u7EC8\u7AEF",children:[(0,v.jsx)(F.Z,{})," ",d.content]})})}},80821:function(Y,A,e){e.d(A,{Z:function(){return d}});var B=e(5574),f=e.n(B),F=e(24963),x=e(86738),D=e(28036),M=e(83062),v=e(67294),T=e(85893);function d(u){var E=(0,v.useState)(!1),r=f()(E,2),C=r[0],a=r[1],i=(0,v.useContext)(F.Z),j=i.lang,_=i.notice,h=i.message,y=function(){a(!0),u.action().then(function(g){if(a(!1),typeof u.onSuccess=="function"&&u.onSuccess(g),u.messageSuccess){var P="";typeof u.messageSuccess=="function"?P=u.messageSuccess(g):P=u.messageSuccess,P=j("notification.".concat(P))+j("notification.title.success"),u.asynced?h.info(P):h.success(P)}}).catch(function(g){a(!1),typeof u.onError=="function"&&u.onError(g)})};return u.confirm?(0,T.jsx)(x.Z,{style:{width:500},title:u.confirmTitle?u.confirmTitle:j("notification.title.tip"),description:u.confirm,onConfirm:y,okText:"Yes",cancelText:"No",children:(0,T.jsx)(D.ZP,{disabled:u.disabled,icon:u.icon,loading:C,danger:u.danger,type:u.type,children:u.children})}):(0,T.jsx)(M.Z,{title:u.tips,children:(0,T.jsx)(D.ZP,{disabled:u.disabled,icon:u.icon,loading:C,onClick:y,danger:u.danger,type:u.type,children:u.children})})}},37413:function(Y,A,e){e.d(A,{Z:function(){return C}});var B=e(19632),f=e.n(B),F=e(27496),x=e(35995),D=e(99611),M=e(29158),v=e(38345),T=e(55241),d=e(42075),u=e(66309),E=e(67294),r=e(85893);function C(a){return(0,r.jsx)(T.Z,{placement:"right",content:(0,r.jsxs)(v.Z,{direction:"column",style:{width:500},ghost:!0,children:[(0,r.jsx)(v.Z,{title:"\u7AEF\u53E3",children:[].concat(f()(a.publicPort),f()(a.privatePort)).map(function(i,j){var _=a.serverIp;if(_!=""&&_.indexOf("http")===-1&&_.indexOf(":")>-1&&(_="[".concat(_,"]")),_==""){var h=document.location.protocol+"//"+document.location.hostname;_=h}return _==""&&(_=i.IP),(0,r.jsx)(d.Z,{size:"large",wrap:!0,children:(0,r.jsx)(u.Z,{color:i.PublicPort?"#2db7f5":"warning",icon:i.PublicPort?(0,r.jsx)(F.Z,{}):"",style:{marginBottom:5,width:210},children:i.PublicPort?(0,r.jsx)("a",{href:"".concat(_.indexOf("http")===0?_:"http://"+_,":").concat(i.PublicPort),target:"_blank",children:"".concat(i.PublicPort?i.IP+":"+i.PublicPort+" -> ":"").concat(i.PrivatePort,"/").concat(i.Type)},"link".concat(j)):"".concat(i.PrivatePort,"/").concat(i.Type)})},"space".concat(j))})}),a.domain.length>0&&(0,r.jsx)(v.Z,{title:"\u57DF\u540D",children:(0,r.jsx)(d.Z,{direction:"vertical",style:{textAlign:"left"},children:a.domain.map(function(i,j){return(0,r.jsx)(u.Z,{color:"blue",icon:(0,r.jsx)(F.Z,{}),children:(0,r.jsx)("a",{href:i,target:"_blank",children:i})},"domain".concat(j))})})})]}),children:(0,r.jsxs)(d.Z,{direction:"vertical",children:[a.privatePort.length>0&&(0,r.jsxs)(u.Z,{color:"warning",icon:(0,r.jsx)(x.Z,{}),children:["\u5185\u90E8\u7AEF\u53E3: ",a.privatePort.length]}),a.publicPort.length>0&&(0,r.jsxs)(u.Z,{color:"#2db7f5",icon:(0,r.jsx)(D.Z,{}),children:["\u5BF9\u5916\u7AEF\u53E3: ",a.publicPort.length]}),a.domain.length>0&&(0,r.jsxs)(u.Z,{color:"blue",icon:(0,r.jsx)(M.Z,{}),children:["\u7ED1\u5B9A\u57DF\u540D: ",a.domain.length]})]})})}},94359:function(Y,A,e){e.d(A,{Z:function(){return C}});var B=e(67294),f=e(3089),F=e(98165),x=e(18429),D=e(8751),M=e(14313),v=e(30159),T=e(87740),d=e(66309),u=e(83062),E=e(63713),r=e(85893);function C(a){var i=(0,r.jsx)(r.Fragment,{});if(a.status=="0"&&(i=(0,r.jsx)(d.Z,{icon:(0,r.jsx)(f.Z,{}),color:"default",children:"waiting"})),a.status=="10"&&(i=(0,r.jsx)(d.Z,{icon:(0,r.jsx)(F.Z,{spin:!0}),color:"processing",children:"processing"})),a.status=="20"&&(i=(0,r.jsx)(d.Z,{icon:(0,r.jsx)(x.Z,{}),color:"error",children:"error"})),a.status=="30"&&(i=(0,r.jsx)(d.Z,{icon:(0,r.jsx)(D.Z,{}),color:"success",children:"success"})),a.status=="running"||a.status=="healthy"){var j,_;i=(0,r.jsx)(d.Z,{icon:(0,r.jsx)(M.Z,{}),color:"success",children:(j=a.message)!==null&&j!==void 0&&j.showInTag?(_=a.message)===null||_===void 0?void 0:_.content:a.status})}if(a.status=="paused"){var h,y;i=(0,r.jsx)(d.Z,{icon:(0,r.jsx)(v.Z,{}),children:(h=a.message)!==null&&h!==void 0&&h.showInTag?(y=a.message)===null||y===void 0?void 0:y.content:a.status})}if(a.status=="waiting"||a.status=="starting"){var m,g;i=(0,r.jsx)(d.Z,{icon:(0,r.jsx)(T.Z,{}),children:(m=a.message)!==null&&m!==void 0&&m.showInTag?(g=a.message)===null||g===void 0?void 0:g.content:a.status})}if(a.status=="exited"||a.status=="dead"||a.status=="removing"||a.status=="restarting"||a.status=="unhealthy"||a.status=="created"){var P,l;i=(0,r.jsx)(d.Z,{icon:(0,r.jsx)(x.Z,{}),color:"warning",children:(P=a.message)!==null&&P!==void 0&&P.showInTag?(l=a.message)===null||l===void 0?void 0:l.content:a.status})}if(a.link&&(i=(0,r.jsx)(E.Link,{to:a.link,children:i})),a.message){var Q;i=(0,r.jsx)(u.Z,{placement:(Q=a.message.placement)!==null&&Q!==void 0?Q:"top",title:a.message.content,children:i})}return(0,r.jsx)(r.Fragment,{children:i})}},92754:function(Y,A,e){var B=e(5574),f=e.n(B),F=e(67294),x=e(63713),D=e(38703),M=e(85893),v=(0,F.forwardRef)(function(T,d){var u=(0,F.useState)(""),E=f()(u,2),r=E[0],C=E[1];(0,F.useImperativeHandle)(d,function(){return{setFinish:function(){h({finish:{downloading:100,extracting:100}})},setStart:function(m){m&&C(m),h({start:{downloading:0,extracting:0}})}}});var a=(0,x.useModel)("subscriber");a.addDataHandler("image:pull:"+r,function(y){h(y.data)});var i=(0,F.useState)(),j=f()(i,2),_=j[0],h=j[1];return(0,F.useEffect)(function(){h({start:{downloading:0,extracting:0}})},[]),(0,M.jsx)(M.Fragment,{children:_&&Object.keys(_).map(function(y){return(0,M.jsx)(D.Z,{percent:_[y].downloading,success:{percent:_[y].extracting}},y)})})});A.Z=v},54964:function(Y,A,e){e.d(A,{a:function(){return u}});var B=e(78267),f=e.n(B),F=e(75458),x=e.n(F),D=e(67294),M=e(12320),v=e.n(M),T=e(89629),d=e(85893),u={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},E=new M.Terminal(u),r=new F.SearchAddon,C=new B.FitAddon,a=(0,D.forwardRef)(function(i,j){return(0,D.useEffect)(function(){window.addEventListener("resize",function(){i.showInModal||C.fit()}),i.style&&i.style.fontSize&&(E.options.fontSize=i.style.fontSize),E.loadAddon(C),E.loadAddon(r),E.open(document.getElementById("terminal-container")),i.showInModal||C.fit()},[]),(0,D.useImperativeHandle)(j,function(){return{write:function(h){E.write(h)},clear:function(){E.clear()},getTerminal:function(){return E},findNext:function(h){r.findNext(h)},findPrev:function(h){r.findPrevious(h)},fit:function(){C.fit()},onData:function(h){E.onData(h)}}}),(0,d.jsx)("div",{id:"terminal-container",style:{width:i.width?i.width:"100%",height:i.height?i.height:"500px"}})});A.Z=a},9740:function(Y,A,e){e.r(A),e.d(A,{default:function(){return Ie}});var B=e(15009),f=e.n(B),F=e(99289),x=e.n(F),D=e(5574),M=e.n(D),v=e(80821),T=e(54964),d=e(90098),u=e(43425),E=e(74842),r=e(48689),C=e(33160),a=e(87784),i=e(30159),j=e(86548),_=e(89035),h=e(45742),y=e(90078),m=e(38345),g=e(97269),P=e(62370),l=e(63713),Q=e(28036),J=e(42075),de=e(25593),V=e(84567),te=e(96074),N=e(63490),G=e(83062),z=e(92398),Z=e(67294),b=e(99861),ce=e(95089),re=e(95213),ie=e(24963),_e=e(91058),Ee=e(12320),U=e(89629),Me=e(78267),t=e(85893),se=new Ee.Terminal(T.a),fe=new Me.FitAddon;function Fe(k){var ne=(0,l.useModel)("subscriber");return ne.addDataHandler("compose:log:"+k.id,function(ue){se.write(ue.data)}),(0,Z.useEffect)(function(){return window.addEventListener("resize",function(){fe.fit()}),se.options.fontSize=12,se.loadAddon(fe),se.open(document.getElementById("terminal-log")),fe.fit(),se.clear(),function(){ne.progress.close("compose:log:"+k.id)}},[k.id]),(0,t.jsx)("div",{id:"terminal-log",style:{width:"100%",height:"500px"}})}var Ce=e(37413),ye=e(87662),Te=e(94359),Re=e(57165),Ae=e(79245);function Ie(){var k,ne,ue,ve=(0,Z.useContext)(ie.Z),ge=ve.loading,Ze=ve.lang,Ne=ve.notice,le=(0,l.useParams)(),Le=(0,l.useNavigate)(),Be=(0,Z.useState)(),Pe=M()(Be,2),s=Pe[0],Ue=Pe[1],$=(0,Z.useRef)(),We=(0,Z.useState)(0),je=M()(We,2),w=je[0],X=je[1],Se=(0,Z.useState)("default"),De=M()(Se,2),pe=De[0],q=De[1],K=(0,Z.useRef)(),Oe=(0,l.useModel)("subscriber"),Ke=(0,Z.useState)(""),xe=M()(Ke,2),be=xe[0],Ve=xe[1],me=(0,Z.useRef)(),oe=(0,Z.useRef)(),he=(0,Z.useRef)();return Oe.addDataHandler("compose:"+le.id,function(o){var n;(n=$.current)===null||n===void 0||n.write(o.data)}),(0,Z.useEffect)(function(){return ge.show(),(0,d.Pn)({id:le.id}).then(function(o){var n=o.data.detail;n.setting.status&&n.setting.status.indexOf("running")>-1&&(n.isRunning=!0),n.setting.status&&n.setting.status.indexOf("paused")>-1&&(n.isPaused=!0),n.setting.status&&n.setting.status.indexOf("exited")>-1&&(n.isExited=!0),n.setting.status&&n.setting.status=="waiting"?n.isDeploy=!1:n.isDeploy=!0,n.setting.status&&n.setting.status.indexOf("created")>-1&&(n.isCreated=!0,n.isDeploy=!1),o.data.project&&(n.imageList=Object.keys(o.data.project.services).map(function(O){var I;return(I=o.data.project.services[O].image)!==null&&I!==void 0?I:""}));var c=o.data.project;if((!o.data.containerList||o.data.containerList.length==0)&&c&&c.services&&(o.data.containerList=Object.keys(c.services).map(function(O){return{name:"-",service:O,publishers:c.services[O].ports?c.services[O].ports.map(function(I){var p;return{url:"",targetPort:I.target,publishedPort:parseInt(I.published),protocol:(p=I.protocol)!==null&&p!==void 0?p:""}}):[],state:"waiting",status:""}})),o.data.containerList){var W;(0,ye.EH)().then(function(O){Ve(O.data.ip)}),n.containerList=o.data.containerList,(W=K.current)===null||W===void 0||W.setFieldValue("deployServiceName",o.data.containerList.map(function(O){return O.service}))}if(n.yamlList=o.data.yaml,Ue(n),c!=null&&c.services&&Object.keys(c.services).map(function(O){var I=[];if(c.services&&c.services[O]&&(c.services[O].environment&&Object.keys(c.services[O].environment).map(function(ee){c.services[O].environment&&I.push({name:ee,value:c.services[O].environment[ee]})}),I.length!=0)){var p;(p=K.current)===null||p===void 0||p.setFieldValue(["environmentService",O],I)}}),o.data.detail.setting.environment){var L;(L=K.current)===null||L===void 0||L.setFieldValue("environment",o.data.detail.setting.environment)}else{var S,R=(0,Ae.m)(o.data.yaml[0]);(S=K.current)===null||S===void 0||S.setFieldValue("environment",R)}n.isDeploy&&(0,d.VN)({id:le.id})}).catch(function(o){console.log(o),Le("/compose/list")}).finally(function(){ge.destroy()}),function(){Oe.progress.close("compose:log:"+le.id)}},[w]),(0,t.jsx)(y._z,{header:{extra:[(0,t.jsx)(l.Link,{to:"/compose/create",reloadDocument:location.search.length>0,children:(0,t.jsx)(Q.ZP,{type:"primary",children:"\u521B\u5EFA\u4EFB\u52A1"},"createCompose")},"create")]},children:(0,t.jsxs)(m.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,t.jsx)(m.Z,{title:(0,t.jsx)(u.Z,{}),subTitle:"\u64CD\u4F5C - "+(s==null?void 0:s.name),bordered:!0,extra:(0,t.jsx)(t.Fragment,{children:s&&s.imageList&&s.imageList.length>0&&(0,t.jsx)(b.Z,{ref:he,image:s.imageList})}),headerBordered:!0,children:s&&(0,t.jsxs)(J.Z,{wrap:!0,children:[(0,t.jsx)(v.Z,{icon:(0,t.jsx)(E.Z,{}),type:"primary",confirm:(0,t.jsxs)(J.Z,{style:{width:300},direction:"vertical",children:[(0,t.jsx)(de.Z.Text,{children:"\u91CD\u65B0\u521B\u5EFA\u8BE5\u4EFB\u52A1\u4E0B\u7684\u5BB9\u5668\uFF1F"}),(0,t.jsxs)(g.A,{name:"createForm",formRef:oe,layout:"inline",submitter:!1,children:[(0,t.jsx)(P.Z,{initialValue:!1,name:"pullImageUseCommand",valuePropName:"checked",children:(0,t.jsx)(V.Z,{children:"\u4F7F\u7528\u547D\u4EE4\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u547D\u4EE4\u4EE3\u7406\uFF09\uFF1F"})}),(0,t.jsx)(P.Z,{initialValue:!0,name:"pullImageUseDPanel",valuePropName:"checked",children:(0,t.jsx)(V.Z,{defaultChecked:!0,children:"\u4F7F\u7528\u9762\u677F\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u4ED3\u5E93\u52A0\u901F\uFF09\uFF1F"})}),(0,t.jsx)(P.Z,{initialValue:!0,name:"createPath",valuePropName:"checked",children:(0,t.jsx)(V.Z,{defaultChecked:!0,children:"\u521B\u5EFA\u6302\u8F7D\u76EE\u5F55\uFF08\u4EC5\u9762\u677F\u975E\u5BB9\u5668\u90E8\u7F72\u751F\u6548\uFF09\uFF1F"})})]})]}),action:x()(f()().mark(function o(){var n,c,W,L,S,R,O,I,p,ee;return f()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(q("deploy"),(n=$.current)===null||n===void 0||n.clear(),O={id:s.id||s.name},!((c=oe.current)!==null&&c!==void 0&&c.getFieldValue&&oe.current.getFieldValue("pullImageUseDPanel"))){H.next=7;break}return H.next=6,(I=he.current)===null||I===void 0?void 0:I.start();case 6:(p=he.current)===null||p===void 0||p.finish();case 7:if(O.environment=(W=K.current)===null||W===void 0?void 0:W.getFieldValue("environment"),O.deployServiceName=(L=K.current)===null||L===void 0?void 0:L.getFieldValue("deployServiceName"),O.createPath=(S=(R=oe.current)===null||R===void 0?void 0:R.getFieldValue("createPath"))!==null&&S!==void 0?S:!0,!(s!=null&&s.isDeploy)){H.next=14;break}if(!((ee=oe.current)!==null&&ee!==void 0&&ee.getFieldValue("pullImageUseCommand"))){H.next=14;break}return H.next=14,(0,d.GG)({id:s.id||s.name,op:"pull"});case 14:return H.next=16,(0,d.Oh)(O);case 16:X(w+1);case 17:case"end":return H.stop()}},o)})),children:s.isDeploy?"\u66F4\u65B0":"\u542F\u52A8"},"create"),(s.isDeploy||s.isCreated)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Z,{action:function(){var n;return(n=$.current)===null||n===void 0||n.clear(),q("destory"),(0,d.mg)({id:s.id||s.name,deleteImage:!1,deleteData:!1,deleteVolume:!1,deletePath:!1})},onSuccess:function(){X(w+1)},confirm:"\u662F\u5426\u8981\u5220\u9664\u5BB9\u5668\uFF1F",type:"primary",danger:!0,messageSuccess:"delete",icon:(0,t.jsx)(r.Z,{}),children:"\u5220\u9664\u5BB9\u5668"}),(0,t.jsx)(te.Z,{type:"vertical"})]}),s.isDeploy&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Z,{icon:(0,t.jsx)(C.Z,{}),action:x()(f()().mark(function o(){return f()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return q("crtl"),c.next=3,(0,d.GG)({id:s.id||s.name,op:"restart"});case 3:X(w+1);case 4:case"end":return c.stop()}},o)})),children:"\u91CD\u542F"},"restart"),(0,t.jsx)(v.Z,{action:function(){var n;return(n=$.current)===null||n===void 0||n.clear(),q("crtl"),(0,d.GG)({id:s.id||s.name,op:"stop"})},messageSuccess:"stop",icon:(0,t.jsx)(a.Z,{}),disabled:s.isExited,onSuccess:function(){X(w+1)},children:"\u505C\u6B62"}),s.isPaused&&(0,t.jsx)(v.Z,{action:function(){var n;return q("crtl"),(n=$.current)===null||n===void 0||n.clear(),(0,d.GG)({id:s.id||s.name,op:"unpause"})},messageSuccess:"resume",onSuccess:function(){X(w+1)},icon:(0,t.jsx)(E.Z,{}),children:"\u6062\u590D"}),!s.isPaused&&(0,t.jsx)(v.Z,{action:function(){var n;return q("crtl"),(n=$.current)===null||n===void 0||n.clear(),(0,d.GG)({id:s.id||s.name,op:"pause"})},onSuccess:function(){X(w+1)},messageSuccess:"pause",icon:(0,t.jsx)(i.Z,{}),disabled:!s.isRunning,children:"\u6682\u505C"})]}),(0,t.jsx)(te.Z,{type:"vertical"}),s.isDeploy&&(0,t.jsx)(l.Link,{to:"/compose/create?id="+(s.id||s.name),children:(0,t.jsx)(Q.ZP,{icon:(0,t.jsx)(j.Z,{}),children:"\u7F16\u8F91\u4EFB\u52A1"})}),s.isDeploy&&s.id>0&&(0,t.jsx)(v.Z,{type:"primary",action:x()(f()().mark(function o(){var n,c,W,L,S,R,O,I,p;return f()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return(n=$.current)===null||n===void 0||n.clear(),q("destory"),ae.next=4,(0,d.mg)({id:(c=s==null?void 0:s.id)!==null&&c!==void 0?c:0,deleteImage:(W=(L=me.current)===null||L===void 0?void 0:L.getFieldValue("deleteImage"))!==null&&W!==void 0?W:!1,deleteData:!0,deleteVolume:(S=(R=me.current)===null||R===void 0?void 0:R.getFieldValue("deleteVolume"))!==null&&S!==void 0?S:!1,deletePath:(O=(I=me.current)===null||I===void 0?void 0:I.getFieldValue("deletePath"))!==null&&O!==void 0?O:!1});case 4:p=ae.sent,X(w+1);case 6:case"end":return ae.stop()}},o)})),danger:!0,confirm:(0,t.jsxs)(J.Z,{style:{width:200},direction:"vertical",children:[(0,t.jsx)(de.Z.Text,{children:"\u5220\u9664\u5BB9\u5668\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"}),(0,t.jsxs)(g.A,{formRef:me,layout:"inline",submitter:!1,children:[(0,t.jsx)(P.Z,{initialValue:!1,name:"deleteImage",valuePropName:"checked",children:(0,t.jsx)(V.Z,{children:"\u5220\u9664\u955C\u50CF\uFF1F"})}),(0,t.jsx)(P.Z,{initialValue:!1,name:"deleteVolume",valuePropName:"checked",children:(0,t.jsx)(V.Z,{children:"\u5220\u9664\u5B58\u50A8\u5377\uFF1F"})}),(0,t.jsx)(P.Z,{initialValue:!1,name:"deletePath",valuePropName:"checked",children:(0,t.jsx)(V.Z,{children:"\u5220\u9664\u4EFB\u52A1\u76EE\u5F55\uFF1F"})})]})]}),children:"\u5220\u9664\u4EFB\u52A1"})]})},"operator"),(0,t.jsxs)(m.Z,{split:"vertical",children:[(0,t.jsxs)(m.Z,{colSpan:"45%",direction:"column",split:"horizontal",title:"\u542F\u52A8\u914D\u7F6E",subTitle:"\u7F16\u8F91\u540E\u53EA\u5F71\u54CD\u672C\u6B21\u90E8\u7F72",children:[pe!="default"&&(0,t.jsx)(m.Z,{title:(0,t.jsx)(_.Z,{}),subTitle:"\u63A7\u5236\u53F0",extra:(0,t.jsx)(J.Z,{children:(0,t.jsx)(v.Z,{action:function(){var n;return(n=$.current)===null||n===void 0||n.clear(),(0,d.U_)({})},icon:(0,t.jsx)(r.Z,{}),danger:!0,onSuccess:function(){X(w+1)},children:"\u4E2D\u6B62\u6267\u884C"},"kill")}),children:(0,t.jsx)(T.Z,{height:"300px",style:{fontSize:12},ref:$})}),s&&(0,t.jsx)(m.Z,{children:(0,t.jsx)(N.Z,{rowKey:"service",pagination:!1,columns:[{title:"\u5BB9\u5668\u540D",dataIndex:"name"},{title:"\u670D\u52A1\u540D",dataIndex:"service"},{title:"\u7AEF\u53E3",render:function(n,c,W){var L=[],S=[];return c.publishers&&c.publishers.map(function(R){R.publishedPort?L.push({PrivatePort:R.targetPort,Type:R.protocol,IP:R.url,PublicPort:R.publishedPort}):R.publishedPort&&S.push({PrivatePort:R.targetPort,Type:R.protocol,IP:R.url,PublicPort:R.publishedPort})}),(0,t.jsx)(Ce.Z,{publicPort:L,privatePort:S,domain:[],serverIp:be})}},{title:"\u72B6\u6001",render:function(n,c,W){return(0,t.jsx)(Te.Z,{status:c.state,message:{content:Ze("container.status.".concat(c.state)),placement:"top",showInTag:!0}},c.name)}},{title:"\u64CD\u4F5C",render:function(n,c,W){return(0,t.jsxs)(J.Z,{split:(0,t.jsx)(te.Z,{type:"vertical"}),children:[(0,t.jsx)(l.Link,{to:"/app/detail/edit/"+c.name,target:"_blank",children:(0,t.jsx)(G.Z,{title:"\u7BA1\u7406\u5BB9\u5668",children:(0,t.jsx)(u.Z,{})})},"edit"),c.state=="running"&&(0,t.jsx)(Re.Z,{container:c.name},"console")]})}}],dataSource:s.containerList,rowSelection:s.containerList?{defaultSelectedRowKeys:s.containerList.map(function(o){return o.service}),onChange:function(n,c,W){var L;(L=K.current)===null||L===void 0||L.setFieldValue("deployServiceName",n)}}:null})}),(0,t.jsxs)(g.A,{formRef:K,submitter:!1,children:[(0,t.jsx)(P.Z,{name:"deployServiceName",hidden:!0}),!(s!=null&&s.isDeploy)&&(0,t.jsx)(m.Z,{title:"\u73AF\u5883\u53D8\u91CF",subTitle:"\u9762\u677F\u751F\u6210 .dpanel.env \u6587\u4EF6\uFF0C\u540C\u65F6\u4F1A\u52A0\u8F7D .env",children:(0,t.jsx)(_e.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,showInDrawer:!0,requireValue:!0})}),!(s!=null&&s.isDeploy)&&(0,t.jsx)(m.Z,{title:"\u670D\u52A1\u73AF\u5883\u53D8\u91CF",tooltip:"\u4FEE\u6539\u670D\u52A1\u4E2D\u7684\u73AF\u5883\u53D8\u91CF\u65F6\uFF0C\u8BF7\u5728 yaml \u4E2D\u5C06\u503C\u5148\u6620\u5C04\u6210\u81EA\u5B9A\u4E49\u7684\u53D8\u91CF\u540D",children:(0,t.jsx)(z.Z,{indicator:{align:"center"},items:K&&K.current&&((k=K.current)===null||k===void 0?void 0:k.getFieldValue("environmentService"))&&Object.keys((ne=K.current)===null||ne===void 0?void 0:ne.getFieldValue("environmentService")).map(function(o){return{label:o,key:o,children:(0,t.jsx)(_e.Z,{showCardGhost:!0,name:["environmentService",o],showDisableName:!0,showDisableValue:!0,showInDrawer:!0,requireValue:!0})}})})})]})]}),s&&!s.isDeploy&&(0,t.jsx)(m.Z,{colSpan:"55%",children:(0,t.jsx)(z.Z,{items:s.yamlList&&s.yamlList.map(function(o,n){var c=[{label:"Yaml \u6587\u4EF6",key:"yaml"},{label:"\u8986\u76D6 Yaml \u6587\u4EF6",key:"yamlOverride"}];return{label:c[n].label,key:c[n].key,disabled:o=="",children:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(ce.ZP,{theme:"dark",minHeight:"550px",value:o,readOnly:!0,extensions:[re.RI.yaml()]})})}})})}),s&&s.isDeploy&&(0,t.jsx)(m.Z,{title:(0,t.jsx)(h.Z,{}),subTitle:"\u65E5\u5FD7",colSpan:"55%",children:(0,t.jsx)(Fe,{id:(ue=le.id)!==null&&ue!==void 0?ue:""})})]})]})})}},3393:function(Y,A,e){e.d(A,{Gb:function(){return T},Pn:function(){return r},Rb:function(){return a},YU:function(){return M},ZQ:function(){return h},_U:function(){return u},cd:function(){return j}});var B=e(15009),f=e.n(B),F=e(99289),x=e.n(F),D=e(63713);function M(m){return v.apply(this,arguments)}function v(){return v=x()(f()().mark(function m(g){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,D.request)("/api/app/image/get-detail",{method:"POST",data:g}));case 1:case"end":return l.stop()}},m)})),v.apply(this,arguments)}function T(m){return d.apply(this,arguments)}function d(){return d=x()(f()().mark(function m(g){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,D.request)("/api/app/image/tag-remote",{method:"POST",data:g}));case 1:case"end":return l.stop()}},m)})),d.apply(this,arguments)}function u(m){return E.apply(this,arguments)}function E(){return E=x()(f()().mark(function m(g){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,D.request)("/api/app/image/tag-add",{method:"POST",data:g}));case 1:case"end":return l.stop()}},m)})),E.apply(this,arguments)}function r(m){return C.apply(this,arguments)}function C(){return C=x()(f()().mark(function m(g){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,D.request)("/api/app/image/tag-delete",{method:"POST",data:g}));case 1:case"end":return l.stop()}},m)})),C.apply(this,arguments)}function a(m){return i.apply(this,arguments)}function i(){return i=x()(f()().mark(function m(g){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,D.request)("/api/app/image/export",{method:"POST",data:g,responseType:"blob"}));case 1:case"end":return l.stop()}},m)})),i.apply(this,arguments)}function j(m){return _.apply(this,arguments)}function _(){return _=x()(f()().mark(function m(g){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,D.request)("/api/pro/image/get-remote-tag",{method:"POST",data:g}));case 1:case"end":return l.stop()}},m)})),_.apply(this,arguments)}function h(m){return y.apply(this,arguments)}function y(){return y=x()(f()().mark(function m(g){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,D.request)("/api/app/image/check-upgrade",{method:"POST",data:g}));case 1:case"end":return l.stop()}},m)})),y.apply(this,arguments)}}}]);
