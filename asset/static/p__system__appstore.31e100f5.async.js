"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3917],{80821:function(F,R,e){e.d(R,{Z:function(){return D}});var j=e(5574),o=e.n(j),y=e(24963),m=e(86738),g=e(14726),S=e(83062),A=e(67294),h=e(85893);function D(r){var O=(0,A.useState)(!1),M=o()(O,2),P=M[0],E=M[1],a=(0,A.useContext)(y.Z),B=a.lang,Z=a.notice,s=a.message,d=function(){E(!0),r.action().then(function(t){if(E(!1),typeof r.onSuccess=="function"&&r.onSuccess(t),r.messageSuccess){var C="";typeof r.messageSuccess=="function"?C=r.messageSuccess(t):C=r.messageSuccess,C.indexOf(".")>-1&&(C=B(C)),r.asynced?s.info(C):s.success(C)}}).catch(function(t){E(!1),typeof r.onError=="function"&&r.onError(t)})};return r.confirm?(0,h.jsx)(m.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:B("notification.title.tip"),description:r.confirm,onConfirm:d,okText:"Yes",cancelText:"No",children:(0,h.jsx)(g.ZP,{disabled:r.disabled,icon:r.icon,loading:P,danger:r.danger,type:r.type,children:r.children})}):(0,h.jsx)(S.Z,{title:r.tips,children:(0,h.jsx)(g.ZP,{disabled:r.disabled,icon:r.icon,loading:P,onClick:d,danger:r.danger,type:r.type,children:r.children})})}},24963:function(F,R,e){var j=e(67294),o=(0,j.createContext)({});R.Z=o},29337:function(F,R,e){e.r(R),e.d(R,{default:function(){return Q}});var j=e(15009),o=e.n(j),y=e(99289),m=e.n(y),g=e(5574),S=e.n(g),A=e(24963),h=e(15078),D=e(184),r=e(5966),O=e(97462),M=e(86615),P=e(14726),E=e(67294),a=e(85893),B=(0,E.forwardRef)(function(p,U){var $=(0,E.useState)(!1),T=S()($,2),z=T[0],W=T[1],I=(0,E.useRef)(),L=(0,E.useContext)(A.Z),G=L.message,b=L.notice;return(0,E.useImperativeHandle)(U,function(){return{edit:function(n){var u;(u=I.current)===null||u===void 0||u.setFieldsValue({title:n.title,name:n.name,type:n.setting.type,url:n.setting.url,id:n.id}),W(!0)}}}),(0,a.jsxs)(D.a,{name:"create",title:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97",open:z,onOpenChange:function(n){W(n)},drawerProps:{forceRender:!0},formRef:I,trigger:(0,a.jsx)(P.ZP,{type:"primary",children:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97"}),onFinish:function(){var f=m()(o()().mark(function n(u){var _,c,v;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,h.ks)({name:u.name,url:u.url,type:u.type});case 2:if(_=i.sent,!(_&&_.data)){i.next=12;break}return i.next=6,(0,h.$c)({id:u.id,name:u.name,title:u.title,type:u.type,url:u.url,apps:_.data.list});case 6:if(c=i.sent,!(c&&c.data)){i.next=12;break}return G.success("\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\u6210\u529F"),p.onFinish&&p.onFinish(),(v=I.current)===null||v===void 0||v.resetFields(),i.abrupt("return",!0);case 12:case"end":return i.stop()}},n)}));return function(n){return f.apply(this,arguments)}}(),children:[(0,a.jsx)(r.Z,{name:"id",hidden:!0}),(0,a.jsx)(r.Z,{label:"\u540D\u79F0",name:"title",required:!0,rules:[{required:!0}],placeholder:"\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u5E94\u7528\u5546\u5E97"}),(0,a.jsx)(O.Z,{name:["id"],children:function(n){var u=n.id;return(0,a.jsx)(r.Z,{label:"\u6807\u8BC6",name:"name",required:!0,disabled:!!u,rules:[{required:!0}],placeholder:"\u6307\u5B9A\u5546\u5E97\u6807\u8BC6\uFF0C\u7528\u4E8E\u521B\u5EFA\u5546\u5E97\u6587\u4EF6\u5B58\u50A8\u76EE\u5F55"})}}),(0,a.jsx)(M.Z.Group,{name:"type",label:"\u5546\u5E97\u7C7B\u578B",valueEnum:{casaos:"casaos \u5E94\u7528\u5546\u5E97","1panel":"1panel \u5E94\u7528\u5546\u5E97"}}),(0,a.jsx)(O.Z,{name:["type"],children:function(n){var u=n.type;if(u=="1panel")return[(0,a.jsx)(r.Z,{label:"\u4ED3\u5E93\u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/1Panel-dev/appstore"},"url")];if(u=="portainer")return(0,a.jsx)(r.Z,{label:"template.json \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/Lissy93/portainer-templates/blob/main/templates.json"});if(u=="casaos")return(0,a.jsx)(r.Z,{label:"zip \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://play.cuse.eu.org/Cp0204-AppStore-Play.zip"})}})]})}),Z=B,s=e(80821),d=e(67255),x=e(43425),t=e(98165),C=e(90078),N=e(10641),K=e(54006),J=e(66309),w=e(42075),V=e(96074),H=e(25593),Y=e(83062);function Q(){var p=(0,E.useRef)(),U=(0,K.useAccess)(),$=(0,E.useRef)(),T=(0,K.useModel)("@@initialState"),z=T.initialState,W=T.loading,I=T.error,L=T.refresh,G=T.setInitialState;return(0,a.jsx)(C._z,{header:{extra:[U.canSeeFounder&&(0,a.jsx)(Z,{ref:$,onFinish:function(){var f,n;!((f=p.current)===null||f===void 0)&&f.reloadAndRest&&((n=p.current)===null||n===void 0||n.reloadAndRest())}},"create")]},children:(0,a.jsx)(N.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,d.O)(),columns:[{title:"\u6807\u8BC6",dataIndex:"name",width:200},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u5730\u5740",width:500,search:!1,render:function(f,n,u,_,c){return(0,a.jsx)("a",{href:n.setting.url,target:"_blank",children:(0,a.jsx)(J.Z,{children:n.setting.url})})}},{title:"\u6700\u540E\u66F4\u65B0",render:function(f,n,u,_,c){if(n.setting.updatedAt)return new Date(n.setting.updatedAt*1e3).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(f,n,u,_,c){return(0,a.jsxs)(w.Z,{split:(0,a.jsx)(V.Z,{type:"vertical"}),children:[(0,a.jsx)(H.Z.Link,{onClick:function(){var l;(l=$.current)===null||l===void 0||l.edit(n)},children:(0,a.jsx)(Y.Z,{title:"\u7BA1\u7406",children:(0,a.jsx)(x.Z,{})})}),(0,a.jsx)(s.Z,{type:"link",icon:(0,a.jsx)(t.Z,{}),action:function(){var l,i;return(0,h.ks)({id:n.id,name:n.name,url:(l=n.setting.url)!==null&&l!==void 0?l:"",type:(i=n.setting.type)!==null&&i!==void 0?i:""})},onSuccess:function(){var l,i;return!((l=p.current)===null||l===void 0)&&l.reloadAndRest&&((i=p.current)===null||i===void 0||i.reloadAndRest()),!0},onError:function(){var l,i;return!((l=p.current)===null||l===void 0)&&l.reset&&((i=p.current)===null||i===void 0||i.reset()),!0},messageSuccess:"\u66F4\u65B0\u6210\u529F",children:" "})]})}}],request:function(){var b=m()(o()().mark(function f(n,u,_){var c;return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,h.eO)({name:n.name,title:n.title});case 2:return c=l.sent,L(),l.abrupt("return",{data:c.data.list,success:!0,total:c.data.list.length});case 5:case"end":return l.stop()}},f)}));return function(f,n,u){return b.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:p,tableAlertOptionRender:function(f){var n=f.selectedRowKeys,u=f.selectedRows;return(0,a.jsx)(w.Z,{size:16,children:(0,a.jsx)(s.Z,{danger:!0,type:"primary",action:function(){return(0,h.Me)({id:u.map(function(c){return c.id})})},onSuccess:function(){var c,v;return!((c=p.current)===null||c===void 0)&&c.reloadAndRest&&((v=p.current)===null||v===void 0||v.reloadAndRest()),!0},onError:function(){var c,v;return!((c=p.current)===null||c===void 0)&&c.reset&&((v=p.current)===null||v===void 0||v.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"})})}})})}},15078:function(F,R,e){e.d(R,{$c:function(){return S},Me:function(){return E},eO:function(){return M},ks:function(){return h},yL:function(){return B}});var j=e(15009),o=e.n(j),y=e(99289),m=e.n(y),g=e(54006);function S(s){return A.apply(this,arguments)}function A(){return A=m()(o()().mark(function s(d){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.request)("/api/common/store/create",{method:"POST",data:d}));case 1:case"end":return t.stop()}},s)})),A.apply(this,arguments)}function h(s){return D.apply(this,arguments)}function D(){return D=m()(o()().mark(function s(d){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.request)("/api/common/store/sync",{method:"POST",data:d}));case 1:case"end":return t.stop()}},s)})),D.apply(this,arguments)}function r(s){return O.apply(this,arguments)}function O(){return O=_asyncToGenerator(_regeneratorRuntime().mark(function s(d){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:d}));case 1:case"end":return t.stop()}},s)})),O.apply(this,arguments)}function M(s){return P.apply(this,arguments)}function P(){return P=m()(o()().mark(function s(d){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.request)("/api/common/store/get-list",{method:"POST",data:d}));case 1:case"end":return t.stop()}},s)})),P.apply(this,arguments)}function E(s){return a.apply(this,arguments)}function a(){return a=m()(o()().mark(function s(d){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,g.request)("/api/common/store/delete",{method:"POST",data:d});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},s)})),a.apply(this,arguments)}function B(s){return Z.apply(this,arguments)}function Z(){return Z=m()(o()().mark(function s(d){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.request)(d==null?void 0:d.path,{method:"GET"}));case 1:case"end":return t.stop()}},s)})),Z.apply(this,arguments)}},67255:function(F,R,e){e.d(R,{O:function(){return j},j:function(){return o}});function j(){var y,m=parseInt((y=localStorage.getItem("dpanel-pagesize"))!==null&&y!==void 0?y:"0");return{showSizeChanger:!0,defaultPageSize:m!=null?m:20}}function o(y){var m="dpanel-table-column-".concat(y),g={};if(localStorage.getItem(m)){var S;g=JSON.parse((S=localStorage.getItem(m))!==null&&S!==void 0?S:"{}")}return{defaultValue:g,onChange:function(h){localStorage.setItem("dpanel-table-column-".concat(y),JSON.stringify(h))}}}}}]);
