"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9002],{52645:function(ee,$,r){r.d($,{Z:function(){return H}});var I=r(87462),d=r(67294),U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},y=U,A=r(84089),L=function(z,T){return d.createElement(A.Z,(0,I.Z)({},z,{ref:T,icon:y}))},V=d.forwardRef(L),H=V},60415:function(ee,$,r){r.r($),r.d($,{default:function(){return Oe}});var I=r(15009),d=r.n(I),U=r(99289),y=r.n(U),A=r(1699),L=r(29463),V=r(80821),H=r(98510),b=r(78451),z=r(5574),T=r.n(z),W=r(3616),te=r(24963),O=r(82346);function re(o){return E.apply(this,arguments)}function E(){return E=y()(d()().mark(function o(v){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)("/api/app/volume/get-list",{method:"POST",data:v}));case 1:case"end":return a.stop()}},o)})),E.apply(this,arguments)}function ne(o){return B.apply(this,arguments)}function B(){return B=y()(d()().mark(function o(v){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)("/api/app/volume/create",{method:"POST",data:v}));case 1:case"end":return a.stop()}},o)})),B.apply(this,arguments)}function ae(o){return G.apply(this,arguments)}function G(){return G=y()(d()().mark(function o(v){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,O.request)("/api/app/volume/prune",{method:"POST",data:v});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},o)})),G.apply(this,arguments)}function le(o){return K.apply(this,arguments)}function K(){return K=y()(d()().mark(function o(v){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,O.request)("/api/app/volume/delete",{method:"POST",data:v});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},o)})),K.apply(this,arguments)}function oe(o){return Q.apply(this,arguments)}function Q(){return Q=y()(d()().mark(function o(v){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)("/api/app/volume/get-detail",{method:"POST",data:v}));case 1:case"end":return a.stop()}},o)})),Q.apply(this,arguments)}var c=r(36146),J=r(184),R=r(5966),X=r(62370),ie=r(86615),se=r(97462),ue=r(17186),de=r(24739),ce=r(83622),Y=r(34041),p=r(67294),e=r(85893),me=(0,p.forwardRef)(function(o,v){var j=(0,p.useState)(!1),a=T()(j,2),D=a[0],P=a[1],x=(0,p.useRef)(),m=(0,p.useContext)(te.Z),i=m.message,t=new c.Uo("docker");return(0,p.useImperativeHandle)(v,function(){return{}}),(0,e.jsxs)(J.a,{name:"create",title:t.format("volumeCreateTitle"),drawerProps:{width:W.R_},open:D,onOpenChange:function(n){P(n)},formRef:x,trigger:(0,e.jsx)(ce.ZP,{type:"primary",children:t.format("volumeCreateTitle")}),onFinish:function(){var l=y()(d()().mark(function n(s){var u,f,h,Z,S,g;return d()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return Z=[],s.otherOptions&&s.otherOptions.map(function(_){Z.push(_.name+`
`+_.value)}),F.next=4,ne({name:s.name,driver:"local",type:s.type,nfsUrl:(u=s.nfsUrl)!==null&&u!==void 0?u:"",nfsMountPoint:(f=s.nfsMountPoint)!==null&&f!==void 0?f:"",nfsOptions:(h=s.nfsOptions)!==null&&h!==void 0?h:"",tmpfsOptions:s.tmpfsOptions,otherOptions:Z});case 4:if(S=F.sent,!(S&&S.data&&S.data.info.Name!="")){F.next=10;break}return i.success(c.FD.format("finish")),o.onFinish&&o.onFinish(),(g=x.current)===null||g===void 0||g.resetFields(),F.abrupt("return",!0);case 10:case"end":return F.stop()}},n)}));return function(n){return l.apply(this,arguments)}}(),children:[(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormName"),name:"name",placeholder:t.format("volumeCreateFormNameEmpty")}),(0,e.jsx)(X.Z,{label:t.format("volumeCreateFormDriver"),name:"driver",children:(0,e.jsx)(Y.Z,{defaultValue:"local",children:(0,e.jsx)(Y.Z.Option,{value:"local",children:"local"})})}),(0,e.jsx)(ie.Z.Group,{name:"type",label:t.format("volumeCreateFormType"),options:t.option("volumeCreateFormTypeOption",["default","tmpfs","nfs","nfs4","other"]),initialValue:"default"}),(0,e.jsx)(se.Z,{name:["type"],children:function(n){var s=n.type;if(s=="other")return(0,e.jsx)(ue.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:t.format("volumeCreateFormTypeOptions")},copyIconProps:!1,min:0,children:(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(R.Z,{name:"name",label:t.format("volumeCreateFormTypeOtherName")}),(0,e.jsx)(R.Z,{name:"value",label:t.format("volumeCreateFormTypeOtherValue"),placeholder:"/etc/path"})]})});if(s=="nfs"||s=="nfs4")return[(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormTypeNfsUrl"),name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:t.format("volumeCreateFormTypeNfsUrlEmpty")},"nfsUrl"),(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormTypeNfsMountPoint"),name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"/export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormTypeOptions"),name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(s=="tmpfs")return[(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormTypeOptions"),name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),fe=me,k=r(5251),q=r(38345),C=r(26412),ve=r(60940),w=r(25593),N=r(66309),he=r(47463),pe=(0,p.forwardRef)(function(o,v){var j;(0,p.useImperativeHandle)(v,function(){return{showDetail:function(f){return y()(d()().mark(function h(){var Z;return d()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,oe({name:f});case 2:Z=g.sent,x(!0),l(Z.data);case 5:case"end":return g.stop()}},h)}))()}}});var a=(0,p.useState)(!1),D=T()(a,2),P=D[0],x=D[1],m=(0,p.useState)(),i=T()(m,2),t=i[0],l=i[1],n=new c.Uo("docker"),s=(0,p.useRef)();return(0,e.jsxs)(J.a,{title:n.format("volumeDetailTitle"),open:P,submitter:!1,onOpenChange:function(f){x(f),!f&&l(void 0)},drawerProps:{width:W.R_},children:[(0,e.jsx)(q.Z,{title:n.format("volumeDetailTitle"),ghost:!0,children:(0,e.jsxs)(C.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:[(0,e.jsx)(C.Z.Item,{label:n.format("volumeDetailName"),children:t==null?void 0:t.info.Name}),(0,e.jsx)(C.Z.Item,{label:n.format("volumeDetailCreatedAt"),children:new Date((j=t==null?void 0:t.info.CreatedAt)!==null&&j!==void 0?j:"").toLocaleString()}),(0,e.jsx)(C.Z.Item,{label:n.format("volumeDetailMountpoint"),children:t==null?void 0:t.info.Mountpoint}),(0,e.jsx)(C.Z.Item,{label:n.format("volumeDetailDriver"),children:t==null?void 0:t.info.Driver}),(t==null?void 0:t.info.Labels)&&(0,e.jsx)(C.Z.Item,{label:"Lables",children:(0,e.jsx)(C.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:(t==null?void 0:t.info.Labels)&&Object.keys(t==null?void 0:t.info.Labels).map(function(u){return(0,e.jsx)(C.Z.Item,{label:u,children:t.info.Labels[u]})})})})]})}),(0,e.jsxs)(q.Z,{title:n.format("volumeDetailUseContainer"),ghost:!0,children:[(0,e.jsx)(he.Z,{ref:s}),(0,e.jsx)(ve.Z,{rowKey:"Name",columns:[{title:c.FD.format("listContainerName"),dataIndex:"Name",render:function(f,h,Z){return(0,e.jsx)(w.Z.Link,{onClick:function(){var g;(g=s.current)===null||g===void 0||g.show(h.Id)},children:(0,k.fi)(h.Name,"/")})}},{title:c.FD.format("listContainerPath"),dataIndex:"Mount"},{title:c.FD.format("listPermission"),render:function(f,h,Z){return h.RW?(0,e.jsx)(N.Z,{children:c.FD.format("listPermission.read")}):(0,e.jsx)(N.Z,{children:c.FD.format("listPermission.write")})}}],dataSource:t==null?void 0:t.inUseContainer,pagination:!1})]})]})}),xe=pe,je=r(36693),ge=r(95591),ye=r(52645),Ce=r(82061),Ze=r(74453),Re=r(97269),M=r(42075),De=r(96074),Fe=r(84567);function Oe(){var o=(0,p.useRef)(),v=(0,p.useRef)(),j=(0,p.useRef)(),a=(0,O.useAccess)(),D=(0,p.useRef)(),P=new c.Uo("docker");return(0,e.jsxs)(Ze._z,{header:{extra:[(0,e.jsx)(A.u,{access:"canSeeDockerVolumeManage",children:(0,e.jsx)(fe,{onFinish:function(){var m,i;!((m=o.current)===null||m===void 0)&&m.reloadAndRest&&((i=o.current)===null||i===void 0||i.reloadAndRest())}},"create")},"volumeManage")]},children:[(0,e.jsx)(xe,{ref:v}),(0,e.jsx)(L.Z,{type:"volume",ref:D,onCloseDestroy:!0}),(0,e.jsx)(H.C,{rowKey:"Name",columns:[{title:c.FD.format("listTitle"),dataIndex:"Name",width:300,render:function(m,i,t,l,n){return(0,e.jsx)(w.Z.Link,{onClick:function(){var u;(u=v.current)===null||u===void 0||u.showDetail(i.Name)},children:(0,e.jsx)(b.Z,{content:i.Name})})}},{title:c.FD.format("listContainerName"),ellipsis:!0,search:!1,render:function(m,i,t,l,n){return i.InUse?(0,e.jsx)(M.Z,{direction:"vertical",children:i.InUse.map(function(s,u){return(0,e.jsx)(N.Z,{color:"cyan",icon:(0,e.jsx)(je.Z,{}),children:(0,k.fi)(s.name,"/")},u)})},t):(0,e.jsx)(N.Z,{children:c.FD.format("listNotUse")})}},{title:c.FD.format("listDriver"),ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:c.FD.format("listHostPath"),search:!1,width:250,dataIndex:"Mountpoint",render:function(m,i,t,l,n){return(0,e.jsx)(b.Z,{content:i.Mountpoint})}},{title:c.FD.format("listCreatedAt"),ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(m,i,t,l,n){return new Date(i.CreatedAt).toLocaleString()}},{title:c.FD.format("listManage"),width:100,search:!1,fixed:"right",hidden:!a.canSeeDockerVolumeManage,render:function(m,i,t,l,n){return(0,e.jsx)(M.Z,{split:(0,e.jsx)(De.Z,{type:"vertical"}),children:(0,e.jsx)(w.Z.Link,{onClick:function(){var u;(u=D.current)===null||u===void 0||u.showVolume(i.Name)},children:(0,e.jsx)(ge.Z,{})})})}}],request:function(){var x=y()(d()().mark(function m(i,t,l){var n,s;return d()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,re({name:i.name});case 2:return n=f.sent,s=[],n.data.inUse?s=n.data.list.map(function(h){return n.data.inUse&&n.data.inUse[h.Name]?h.InUse=n.data.inUse[h.Name]:h.InUse=void 0,h}):s=n.data.list,f.abrupt("return",{data:s,success:!0,total:n.data.list.length});case 6:case"end":return f.stop()}},m)}));return function(m,i,t){return x.apply(this,arguments)}}(),rowSelection:a.canSeeDockerVolumeManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:o,quickToolbarRender:function(m){var i=m.selectedRows;return(0,e.jsxs)(M.Z,{size:16,children:[(0,e.jsx)(V.Z,{action:function(){var l,n;return ae({deleteAll:(l=(n=j.current)===null||n===void 0?void 0:n.getFieldValue("deleteAll"))!==null&&l!==void 0?l:!1})},buttonProps:{icon:(0,e.jsx)(ye.Z,{})},onSuccess:function(){var l,n;return!((l=o.current)===null||l===void 0)&&l.reloadAndRest&&((n=o.current)===null||n===void 0||n.reloadAndRest()),!0},onError:function(){var l,n;return!((l=o.current)===null||l===void 0)&&l.reset&&((n=o.current)===null||n===void 0||n.reset()),!0},confirmProps:{description:(0,e.jsx)(Re.A,{formRef:j,submitter:!1,children:(0,e.jsxs)(M.Z,{style:{width:280},direction:"vertical",children:[(0,e.jsx)(w.Z.Text,{children:P.format("volumeListManagePruneTip")}),(0,e.jsx)(X.Z,{name:"deleteAll",valuePropName:"checked",children:(0,e.jsx)(Fe.Z,{children:P.format("volumeListManagePruneNotAnonymous")})})]})})},children:c.FD.format("listManagePrune")},"clear"),(0,e.jsx)(V.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,e.jsx)(Ce.Z,{})},confirmProps:{showCommonConfirm:!0},action:function(){return le({name:i.map(function(l){return l.Name})})},onSuccess:function(){var l,n;return!((l=o.current)===null||l===void 0)&&l.reloadAndRest&&((n=o.current)===null||n===void 0||n.reloadAndRest()),!0},onError:function(){var l,n;return!((l=o.current)===null||l===void 0)&&l.reset&&((n=o.current)===null||n===void 0||n.reset()),!0},children:c.FD.format("listManageDeleteBatch")})]})}},"volume-list")]})}}}]);
