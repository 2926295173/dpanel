"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8022],{91806:function(ne,y,e){e.d(y,{Z:function(){return o}});var x=e(87462),W=e(67294),N={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},b=N,G=e(84089),S=function(R,p){return W.createElement(G.Z,(0,x.Z)({},R,{ref:p,icon:b}))},j=W.forwardRef(S),o=j},44349:function(ne,y,e){var x=e(97857),W=e.n(x),N=e(15009),b=e.n(N),G=e(99289),S=e.n(G),j=e(74763),o=e(17186),P=e(5966),R=e(86250),p=e(67294),L=e(85893),J=(0,p.forwardRef)(function(m,ee){var U=(0,p.useRef)();(0,p.useImperativeHandle)(ee,function(){return{addItem:function(B){function u(O,T,a){return B.apply(this,arguments)}return u.toString=function(){return B.toString()},u}(function(B,u,O){var T,a=(T=U.current)===null||T===void 0?void 0:T.getList(),v;if(a==null||a.forEach(function(w,k){w[B]==u[B]&&(v=k)}),!(0,j.k)(v)&&O){var Q;(Q=U.current)===null||Q===void 0||Q.remove(v),v=void 0}if(!v){var F;(F=U.current)===null||F===void 0||F.add(u)}}),removeItemByKey:function(u,O){return S()(b()().mark(function T(){var a,v;return b()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return v=(a=U.current)===null||a===void 0?void 0:a.getList(),v==null||v.forEach(function(w,k){if(w[u]==O){var X;(X=U.current)===null||X===void 0||X.remove(k);return}}),F.abrupt("return");case 3:case"end":return F.stop()}},T)}))()},clear:function(u){if(!u){var O;u=(O=U.current)===null||O===void 0||(O=O.getList())===null||O===void 0?void 0:O.map(function(a,v){return v})}if(u){var T;(T=U.current)===null||T===void 0||T.remove(u)}},getList:function(){var u;return(u=U.current)===null||u===void 0?void 0:u.getList()}}});var Z={};return m.hideCopyButton===!0&&(Z.copyIconProps=!1),m.hideDeleteButton===!0&&(Z.deleteIconProps=!1),(0,L.jsx)(o.u,W()(W()({initialValue:m.initialValue,label:m.label,name:m.name,actionRef:U,creatorButtonProps:m.showAddButton?{creatorButtonText:m.label?m.label:m.name}:!1,min:m.min?m.min:0},Z),{},{children:function(u,O,T){return(0,L.jsx)(R.Z,{justify:m.justify,gap:m.gap,children:m.items.map(function(a){return a.render?(0,L.jsx)("div",{children:a.render&&a.render(u,O,T)},"".concat(m.name,"-").concat(a.name,"-").concat(u.key)):(0,L.jsx)(P.Z,{width:a.width,name:a.name,label:a.label,required:a.required,rules:[{required:a.required}],disabled:a.disabled,placeholder:a.placeholder},"".concat(m.name,"-").concat(a.name,"-").concat(u.key))})})}}))});y.Z=J},36435:function(ne,y,e){var x=e(15009),W=e.n(x),N=e(64599),b=e.n(N),G=e(99289),S=e.n(G),j=e(9783),o=e.n(j),P=e(5574),R=e.n(P),p=e(67294),L=e(184),J=e(38345),m=e(97269),ee=e(97321),U=e(97462),Z=e(64317),B=e(5966),u=e(86615),O=e(68602),T=e(83622),a=e(83403),v=e(24963),Q=e(1699),F=e(29177),w=e(1883),k=e(43425),X=e(44349),le=e(3616),te=e(36146),s=e(85893),l=(0,p.forwardRef)(function($,se){var ae=(0,p.useState)(!1),_e=R()(ae,2),K=_e[0],q=_e[1],V=(0,p.useRef)(),oe=(0,p.useContext)(v.Z),re=oe.message,I=(0,p.useState)([]),i=R()(I,2),n=i[0],c=i[1],t=new te.Uo("components.permissionButton"),r=o()(o()(o()(o()(o()({},a.W6.CONTAINER,"Id"),a.W6.APPSTORE,"name"),a.W6.COMPOSE,"name"),a.W6.REGISTRY,"serverAddress"),a.W6.DOCKER_ENV,"name"),M=o()(o()(o()(o()(o()({},a.W6.CONTAINER,"name"),a.W6.APPSTORE,"name"),a.W6.COMPOSE,"name"),a.W6.REGISTRY,"title"),a.W6.DOCKER_ENV,"title"),f=r[$.type],Y=M[$.type],d=$.selected.map(function(_){return _[r[$.type]]});return p.useEffect(function(){if(K){if(!$.selected||$.selected.length==0){re.error(te.FD.format("message.noDataSelect")),q(!1);return}(0,O.dP)({permission:{uri:$.type,key:f,value:d}}).then(function(_){var E;(E=V.current)===null||E===void 0||E.setFieldValue("list",Object.keys(_.data.list).map(function(D){return{name:D,type:_.data.list[D].type,users:_.data.list[D].users}}))}),(0,O.lE)().then(function(_){var E,D=(E=_.data)===null||E===void 0||(E=E.list)===null||E===void 0?void 0:E.map(function(h){return{label:h.username,value:h.username}});c(D)})}},[K]),(0,s.jsx)(Q.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,s.jsxs)(L.a,{name:"create",title:t.format("drawerTitle"),open:K,onOpenChange:function(E){if(!E){var D;(D=V.current)===null||D===void 0||D.resetFields()}q(E)},drawerProps:{forceRender:!0,width:le.R_},formRef:V,trigger:(0,s.jsx)(T.ZP,{icon:(0,s.jsx)(F.Z,{}),children:t.format("drawerTriggerButton")}),onFinish:function(){var _=S()(W()().mark(function E(D){var h,A,g;return W()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:h=b()(D.list),C.prev=1,h.s();case 3:if((A=h.n()).done){C.next=9;break}return g=A.value,C.next=7,(0,O.Db)({usernames:g.users,permissionType:g.type,permission:{uri:$.type,key:f,showKey:Y,value:[g.name]}});case 7:C.next=3;break;case 9:C.next=14;break;case 11:C.prev=11,C.t0=C.catch(1),h.e(C.t0);case 14:return C.prev=14,h.f(),C.finish(14);case 17:re.success(te.FD.format("finish")),q(!1),$.onSuccess();case 20:case"end":return C.stop()}},E,null,[[1,11,14,17]])}));return function(E){return _.apply(this,arguments)}}(),children:[(0,s.jsxs)(J.Z,{ghost:!0,title:(0,s.jsx)(w.Z,{}),subTitle:t.format("batchTitle"),children:[(0,s.jsx)(m.A.Item,{name:"type",style:{marginBottom:0},children:(0,s.jsx)(ee.Z.Group,{defaultValue:"admin",onChange:function(E){var D,h,A=(D=V.current)===null||D===void 0?void 0:D.getFieldValue("list");A.forEach(function(g){g.type=E,g.users=[]}),(h=V.current)===null||h===void 0||h.setFieldValue("list",A)},children:["admin","restricted","public"].map(function(_){return(0,s.jsx)(ee.Z,{style:{width:240},title:t.format("dataTypeOption.".concat(_)),description:t.format("dataTypeOptionDesc.".concat(_)),value:_},_)})})}),(0,s.jsx)(U.Z,{name:["type"],children:function(E){var D=E.type;if(D==="restricted")return(0,s.jsx)(Z.Z,{mode:"multiple",name:"usernames",label:t.format("formUsernames"),onChange:function(A){var g,z,C=(g=V.current)===null||g===void 0?void 0:g.getFieldValue("list");C.forEach(function(H){H.users=A}),(z=V.current)===null||z===void 0||z.setFieldValue("list",C)},rules:[{required:!0}],request:S()(W()().mark(function h(){var A,g,z;return W()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!(n.length>0)){H.next=2;break}return H.abrupt("return",n);case 2:return H.next=4,(0,O.lE)();case 4:return g=H.sent,z=(A=g.data)===null||A===void 0||(A=A.list)===null||A===void 0?void 0:A.map(function(ie){return{label:ie.username,value:ie.username}}),c(z),H.abrupt("return",z);case 8:case"end":return H.stop()}},h)}))})}})]}),(0,s.jsx)(J.Z,{ghost:!0,title:(0,s.jsx)(k.Z,{}),subTitle:t.format("dataTitle"),children:(0,s.jsx)(X.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:t.format("dataName"),render:function(E,D,h){var A=h.getCurrentRowData();return(0,s.jsx)(B.Z,{disabled:!0,label:t.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:t.format("dataType"),render:function(E,D,h){var A=h.getCurrentRowData();return(0,s.jsx)(u.Z.Group,{label:t.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(g){return{label:t.format("dataTypeOption.".concat(g)),value:g}})})}},{name:"users",label:t.format("dataUsers"),render:function(E,D,h){return(0,s.jsx)(U.Z,{name:["type"],children:function(g){var z=g.type;if(z=="restricted")return(0,s.jsx)(Z.Z,{width:"sm",mode:"tags",name:"users",label:t.format("dataUsers"),options:n})}})}}]})})]})})});y.Z=l},96781:function(ne,y,e){var x=e(67294),W=(0,x.createContext)({});y.Z=W},92922:function(ne,y,e){e.r(y),e.d(y,{default:function(){return $}});var x=e(64599),W=e.n(x),N=e(15009),b=e.n(N),G=e(99289),S=e.n(G),j=e(80821),o=e(90098),P=e(43425),R=e(86548),p=e(23430),L=e(90078),J=e(56729),m=e(82346),ee=e(83622),U=e(25593),Z=e(83062),B=e(66309),u=e(42075),O=e(96074),T=e(67294),a=e(94359),v=e(67255),Q=e(93162),F=e.n(Q),w=e(96781),k=e(69626),X=e(1699),le=e(83403),te=e(36435),s=e(36146),l=e(85893);function $(){var se,ae,_e=(0,T.useContext)(w.Z),K=_e.listTableRef,q=(0,T.useRef)(),V=(0,m.useAccess)(),oe=(0,m.useLocation)(),re=new s.Uo("compose");return(0,l.jsxs)(L._z,{header:{extra:[(0,l.jsx)(X.u,{access:"canSeeComposeListManageCreate",children:(0,l.jsx)(m.Link,{to:"/compose/create",reloadDocument:oe.search.length>0,children:(0,l.jsx)(ee.ZP,{type:"primary",children:s.Ob.format("compose.create")},"createCompose")},"create")},"create")]},children:[(0,l.jsx)(k.Z,{ref:q,onClose:function(){var i;!((i=K.current)===null||i===void 0)&&i.reloadAndRest&&K.current.reloadAndRest()}}),(0,l.jsx)(J.Z,{scroll:{x:"max-content"},request:function(){var I=S()(b()().mark(function i(n){var c;return b()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,o.pm)({title:n.title,name:n.name});case 2:return c=r.sent,r.abrupt("return",{data:c.data.list,success:!0,total:c.data.list.length});case 4:case"end":return r.stop()}},i)}));return function(i){return I.apply(this,arguments)}}(),onChange:v.nX,rowKey:"name",columns:[{key:"name",title:s.FD.format("listName"),dataIndex:"name",width:200,render:function(i,n,c,t,r){return(0,l.jsx)(U.Z.Link,{onClick:function(){var f;(f=q.current)===null||f===void 0||f.show(n.id||n.name)},children:n.name})},sorter:function(i,n){return i.name.localeCompare(n.name)},defaultSortOrder:(0,v.O$)("compose-list","name"),sortDirections:["descend","ascend"]},{title:s.FD.format("listTitle"),dataIndex:"title",width:200},{title:s.FD.format("listType"),width:150,search:!1,render:function(i,n,c,t,r){var M,f=n.setting&&n.setting.type?n.setting.type:"default";return(0,l.jsx)(Z.Z,{title:(M=n.setting.uri)!==null&&M!==void 0?M:"",children:(0,l.jsx)(B.Z,{color:re.format("listTypeColor.".concat(f)),children:re.format("listType.".concat(f))})})}},{title:s.FD.format("listStatus"),dataIndex:"status",search:!1,width:300,key:"status",render:function(i,n,c,t,r){return(0,l.jsx)(u.Z,{children:n.setting.status.split(", ").map(function(M,f){var Y,d="running",_=M.indexOf("(");return _>-1?d=M.slice(0,_):d=M,(0,l.jsx)(a.Z,{status:"compose.".concat(d),statusValue:{count:M.slice(_+1,M.length-1)},tip:"".concat(M," ").concat((Y=n.setting.message)!==null&&Y!==void 0?Y:"")},f)})})},sorter:function(i,n){return i.setting.status.localeCompare(n.setting.status)},defaultSortOrder:(0,v.O$)("compose-list","status")},{title:s.FD.format("listCreatedAt"),dataIndex:"",search:!1,width:150,key:"created",render:function(i,n,c,t,r){return n.setting.createdAt?new Date(n.setting.createdAt).toLocaleString():"-"},sorter:function(i,n){var c,t;return new Date((c=i.setting.createdAt)!==null&&c!==void 0?c:"").toLocaleString().localeCompare(new Date((t=n.setting.createdAt)!==null&&t!==void 0?t:"").toLocaleString())},defaultSortOrder:(0,v.O$)("compose-list","created")},{title:s.FD.format("listUpdatedAt"),dataIndex:"",search:!1,width:150,render:function(i,n,c,t,r){return n.setting.updatedAt?new Date(n.setting.updatedAt).toLocaleString():"-"},sorter:function(i,n){var c,t;return new Date((c=i.setting.updatedAt)!==null&&c!==void 0?c:"").toLocaleString().localeCompare(new Date((t=n.setting.updatedAt)!==null&&t!==void 0?t:"").toLocaleString())},key:"updated",defaultSortOrder:(0,v.O$)("compose-list","updated")},{title:s.FD.format("listManage"),width:80,valueType:"option",fixed:"right",key:"option",hidden:!V.canSeeComposeListManage,render:function(i,n,c,t,r){return n.setting.type!="dangling"&&(0,l.jsxs)(u.Z,{split:(0,l.jsx)(O.Z,{type:"vertical"}),children:[(0,l.jsx)(U.Z.Link,{onClick:function(){var f;(f=q.current)===null||f===void 0||f.show(n.id||n.name)},children:(0,l.jsx)(Z.Z,{title:s.FD.format("listManageDetail"),children:(0,l.jsx)(P.Z,{})})},"3"),(0,l.jsx)(m.Link,{to:"/compose/create?id=".concat(n.id||n.name),children:(0,l.jsx)(Z.Z,{title:s.FD.format("listManageEdit"),children:(0,l.jsx)(R.Z,{})})}),(0,l.jsx)(U.Z.Link,{onClick:S()(b()().mark(function M(){var f,Y;return b()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,o.tw)({id:n.id||n.name});case 2:f=_.sent,Y=new Blob([f],{type:"application/zip"}),(0,Q.saveAs)(Y,"compose-"+n.name+".zip");case 5:case"end":return _.stop()}},M)})),children:(0,l.jsx)(Z.Z,{title:s.FD.format("listManageDownload"),children:(0,l.jsx)(p.Z,{})})},"2")]})}}],rowSelection:V.canSeeComposeListManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0,getCheckboxProps:function(i){return{disabled:i.setting.type=="dangling"||i.setting.type=="outPath"}}}:void 0,tableAlertOptionRender:function(i){var n=i.selectedRows;return(0,l.jsxs)(u.Z,{size:16,children:[(0,l.jsx)(te.Z,{type:le.W6.COMPOSE,selected:n,onSuccess:function(){var t,r;return!((t=K.current)===null||t===void 0)&&t.reloadAndRest&&((r=K.current)===null||r===void 0||r.reloadAndRest()),!0}}),(0,l.jsx)(X.u,{access:"canSeeComposeListManageDelete",children:(0,l.jsx)(j.Z,{danger:!0,type:"primary",action:S()(b()().mark(function c(){var t,r,M,f;return b()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:d.prev=0,r=W()(n),d.prev=2,r.s();case 4:if((M=r.n()).done){d.next=11;break}return f=M.value,d.next=8,(0,o.mg)({id:f.id||f.name});case 8:t=d.sent;case 9:d.next=4;break;case 11:d.next=16;break;case 13:d.prev=13,d.t0=d.catch(2),r.e(d.t0);case 16:return d.prev=16,r.f(),d.finish(16);case 19:d.next=23;break;case 21:d.prev=21,d.t1=d.catch(0);case 23:return d.abrupt("return",(0,o.ik)({id:n.map(function(_){return _.id})}));case 24:case"end":return d.stop()}},c,null,[[0,21],[2,13,16,19]])})),onSuccess:function(){var t,r;return!((t=K.current)===null||t===void 0)&&t.reloadAndRest&&((r=K.current)===null||r===void 0||r.reloadAndRest()),!0},onError:function(){var t,r;return!((t=K.current)===null||t===void 0)&&t.reset&&((r=K.current)===null||r===void 0||r.reset()),!0},confirm:"notification.confirm.title",children:s.FD.format("listManageDeleteBatch")})})]})},pagination:(0,v.Oh)({page:(se=(ae=oe.state)===null||ae===void 0?void 0:ae.page)!==null&&se!==void 0?se:1}),search:{collapsed:!1},actionRef:K,columnsState:(0,v.j_)("compose-list")})]})}},67255:function(ne,y,e){e.d(y,{O$:function(){return S},Oh:function(){return N},j_:function(){return b},nX:function(){return G}});var x=e(5574),W=e.n(x);function N(j){var o=localStorage.getItem("dpanel-pagesize");if(o=="all")return!1;var P=location.pathname.split("/").slice(-2).join("-");return{defaultCurrent:j==null?void 0:j.page,showSizeChanger:!0,defaultPageSize:parseInt(o!=null?o:"20"),onChange:function(p,L){["app-list","compose-list"].includes(P)&&localStorage.setItem("dpanel-page-"+P,"".concat(p))}}}function b(j){var o="dpanel-table-column-".concat(j),P={};if(localStorage.getItem(o)){var R;P=JSON.parse((R=localStorage.getItem(o))!==null&&R!==void 0?R:"{}")}return{defaultValue:P,onChange:function(L){localStorage.setItem("dpanel-table-column-".concat(j),JSON.stringify(L))}}}function G(j,o,P){var R=location.pathname.split("/").slice(-2).join("-");P.columnKey&&localStorage.setItem("dpanel-table-sort-".concat(R),"".concat(P.columnKey,"|").concat(P.order))}function S(j,o){var P=localStorage.getItem("dpanel-table-sort-".concat(j));if(P){var R=P.split("|"),p=W()(R,2),L=p[0],J=p[1];if(L==o)return J}}}}]);
