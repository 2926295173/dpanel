"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9170],{1699:function(rn,Z,n){n.d(Z,{u:function(){return v}});var A=n(9783),o=n.n(A),I=n(97857),_=n.n(I),E=n(67294),R=n(82346),u=n(42075),x=n(85893),v=function(h){var s=(0,R.useAccess)(),P=Array.isArray(h.access)?h.access:[h.access],t;return typeof h.children=="function"?t=h.children(P.reduce(function(f,i){return _()(_()({},f),{},o()({},i,s[i]))},{})):P.every(function(f){return s[f]})?t=h.children:t=h.fallback,h.space?(0,x.jsx)(u.Z,_()(_()({},h.space),{},{children:t})):t}},37767:function(rn,Z,n){n.d(Z,{Z:function(){return on}});var A=n(15009),o=n.n(A),I=n(99289),_=n.n(I),E=n(5574),R=n.n(E),u=n(45605),x=n(38345),v=n(97269),j=n(26412),h=n(42075),s=n(96074),P=n(25593),t=n(2487),f=n(67294),i=n(76428),D=n(78498),a=n(44771),d=n(60335),M=n(24963),T=n(37413),m=n(87662),g=n(5251),L=n(82346),r=n(85893);function on(c){var K,tn,dn,Q,an,vn,cn,z,hn,e,q=(0,f.useState)(""),S=R()(q,2),nn=S[0],w=S[1],_n=(0,L.useAccess)(),G=(0,f.useContext)(M.Z),Cn=G.message,mn=G.notice,On=G.loading,Pn=G.lang,B=(0,f.useRef)(),sn=[],Dn=[],ln=[],un=(0,f.useState)(""),H=R()(un,2),J=H[0],En=H[1];return(0,f.useEffect)(function(){if(c.data){var $;($=B.current)===null||$===void 0||$.setFieldValue("restart",c.data.info.HostConfig.RestartPolicy.Name),(0,m.EH)().then(function(W){En(W.data.ip)}),w(c.data.info.Name)}},[c.data]),c.data&&c.data.domain&&c.data.domain.map(function($){ln.push($.serverName)}),c.data&&c.data.info.NetworkSettings&&c.data.info.NetworkSettings.Ports&&Object.keys(c.data.info.NetworkSettings.Ports).map(function($){var W,b,Y=(W=(b=c.data.info)===null||b===void 0?void 0:b.NetworkSettings.Ports[$])!==null&&W!==void 0?W:[{HostPort:null,HostIp:""}],en=$.split("/"),gn=R()(en,2),X=gn[0],k=gn[1];Y.map(function(fn){fn.HostPort?sn.push({PrivatePort:X,Type:k,IP:fn.HostIp,PublicPort:fn.HostPort}):Dn.push({PrivatePort:X,Type:k,IP:"",PublicPort:""})})}),(0,r.jsxs)(r.Fragment,{children:[c.data&&c.data.info.State.Running&&(0,r.jsx)(T.Z,{publicPort:sn,privatePort:Dn,domain:ln,serverIp:J,showInDetail:!0,ghost:c.ghost,layout:"inline"}),(0,r.jsx)(x.Z,{title:(0,r.jsx)(u.Z,{}),subTitle:"\u5BB9\u5668\u72B6\u6001",ghost:c.ghost,children:(0,r.jsxs)(j.Z,{column:1,bordered:!0,children:[(0,r.jsx)(j.Z.Item,{label:"Hostname",children:(0,r.jsx)(h.Z,{split:(0,r.jsx)(s.Z,{type:"vertical"}),children:(0,r.jsx)(i.Z,{title:(K=c.data.info)===null||K===void 0?void 0:K.Config.Hostname})})}),(0,r.jsx)(j.Z.Item,{label:"\u5BB9\u5668\u540D\u79F0",children:(0,r.jsxs)(h.Z,{split:(0,r.jsx)(s.Z,{type:"vertical"}),children:[(0,r.jsx)(i.Z,{title:(tn=c.data.info)===null||tn===void 0?void 0:tn.Id.substring(0,12)}),(0,r.jsx)(P.Z.Text,{copyable:!0,editable:{tooltip:"\u4FEE\u6539\u5BB9\u5668\u540D\u79F0",onChange:function(){var $=_()(o()().mark(function b(Y){var en,gn;return o()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if((en=c.data.info)!==null&&en!==void 0&&en.Id){k.next=2;break}return k.abrupt("return");case 2:return k.next=4,(0,d.eE)({md5:c.data.info.Id,name:Y});case 4:gn=k.sent,w(Y),Cn.success(Pn("notification.finish"));case 7:case"end":return k.stop()}},b)}));function W(b){return $.apply(this,arguments)}return W}()},children:(0,g.fi)(nn,"/")})]})}),(0,r.jsx)(j.Z.Item,{label:(0,r.jsx)(D.Z,{title:"\u7F51\u7EDC",help:"\u9ED8\u8BA4\u7F51\u7EDC\u53EA\u652F\u6301\u901A\u8FC7ip\u8BBF\u95EE,ip\u4F1A\u968F\u7740\u5BB9\u5668\u542F\u52A8\u505C\u6B62\u6539\u53D8.\u5982\u679C\u9700\u8981\u5728\u5BB9\u5668\u5185\u4E92\u8054,\u8BF7\u901A\u8FC7\u3010\u7F16\u8F91\u7AD9\u70B9\u3011-\u3010\u6DFB\u52A0\u5173\u8054\u3011"}),children:((dn=c.data.info)===null||dn===void 0?void 0:dn.State.Running)&&(0,r.jsxs)(j.Z,{column:1,bordered:!0,children:[c.data.info.NetworkSettings.Networks&&Object.keys(c.data.info.NetworkSettings.Networks).map(function($,W){var b,Y,en;return(0,r.jsx)(j.Z.Item,{label:$,children:$=="host"?" Host \u7F51\u7EDC\uFF0C\u4E0E\u5BBF\u4E3B\u673A\u5171\u7528\u540C\u4E00\u7F51\u7EDC":(0,r.jsxs)(h.Z,{direction:"vertical",children:[(0,r.jsx)(i.Z,{title:(b=c.data.info)===null||b===void 0?void 0:b.NetworkSettings.Networks[$].IPAddress}),(Y=c.data.info)===null||Y===void 0?void 0:Y.NetworkSettings.Networks[$].Gateway,(en=c.data.info)===null||en===void 0?void 0:en.NetworkSettings.Networks[$].MacAddress]})},"1")}),c.data.info.HostConfig.ExtraHosts&&(0,r.jsx)(j.Z.Item,{label:"\u5BBF\u4E3B\u673A\u7F51\u7EDC",children:(0,r.jsx)(h.Z,{direction:"vertical",children:c.data.info.HostConfig.ExtraHosts.map(function($){if($.indexOf(":")>-1){var W=$.split(":");return(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(i.Z,{title:W[0]})," - ",W[1]]})}})})},"1")]})}),(0,r.jsxs)(j.Z.Item,{label:"\u8FD0\u884C\u65F6\u95F4",children:["\u521B\u5EFA\u4E8E: ",new Date((Q=(an=c.data.info)===null||an===void 0?void 0:an.Created)!==null&&Q!==void 0?Q:"").toLocaleString()," / \u66F4\u65B0\u4E8E: ",new Date((vn=(cn=c.data.info)===null||cn===void 0?void 0:cn.State.StartedAt)!==null&&vn!==void 0?vn:"").toLocaleString()]}),_n.canSeeContainerListManage&&(0,r.jsx)(j.Z.Item,{label:"\u91CD\u542F\u7B56\u7565",children:(0,r.jsx)(v.A,{name:"container-restart",submitter:!1,onValuesChange:function(){var $=_()(o()().mark(function W(b){var Y,en;return o()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if((Y=c.data.info)!==null&&Y!==void 0&&Y.Id){X.next=2;break}return X.abrupt("return");case 2:return X.next=4,(0,d.eE)({md5:c.data.info.Id,restart:b.restart});case 4:return en=X.sent,Cn.success("\u4FEE\u6539\u91CD\u542F\u7B56\u7565\u6210\u529F"),X.abrupt("return");case 7:case"end":return X.stop()}},W)}));return function(W){return $.apply(this,arguments)}}(),layout:"inline",formRef:B,children:(0,r.jsx)(a.Z,{defaultValue:(z=c.data.info)===null||z===void 0?void 0:z.HostConfig.RestartPolicy.Name})})}),(0,r.jsx)(j.Z.Item,{label:"\u73AF\u5883\u53D8\u91CF",children:(0,r.jsx)(t.Z,{dataSource:(hn=(e=c.data.info)===null||e===void 0?void 0:e.Config.Env)!==null&&hn!==void 0?hn:[],renderItem:function(W){var b=W.split("=");return(0,r.jsxs)(t.Z.Item,{children:[(0,r.jsx)(P.Z.Text,{code:!0,children:b[0]})," = ",(0,r.jsx)(P.Z.Text,{copyable:!0,children:b.slice(1).join("=")})]})}})})]})})]})}},57716:function(rn,Z,n){n.d(Z,{Z:function(){return L}});var A=n(5574),o=n.n(A),I=n(15009),_=n.n(I),E=n(99289),R=n.n(E),u=n(67294),x=n(184),v=n(38345),j=n(64317),h=n(5966),s=n(62370),P=n(97462),t=n(42075),f=n(89035),i=n(82346),D=n(28036),a=n(85893);function d(r){var on=(0,u.useState)({height:800,width:1024}),c=o()(on,2),K=c[0],tn=c[1],dn=function(){var vn=window.innerWidth,cn=window.innerHeight;tn({height:cn,width:vn})};(0,u.useEffect)(function(){window.addEventListener("resize",function(){dn()}),dn()},[r]);var Q=r.query?Object.keys(r.query).map(function(an){if(r.query)return"".concat(an,"=").concat(r.query[an])}):[];return(0,a.jsx)(i.Link,{target:"_blank",onClick:r.onOpen,to:"/console/"+r.container+"?width=".concat(K.width,"&height=").concat(K.height,"&").concat(Q.join("&")),children:(0,a.jsx)(D.ZP,{type:"primary",icon:(0,a.jsx)(f.Z,{}),children:r.content})})}var M=n(60335),T=n(5251),m=n(49610),g=(0,u.forwardRef)(function(r,on){(0,u.useImperativeHandle)(on,function(){return{show:function(q,S){return R()(_()().mark(function nn(){var w,_n,G;return _()().wrap(function(mn){for(;;)switch(mn.prev=mn.next){case 0:return mn.next=2,(0,M.jV)({md5:q});case 2:G=mn.sent,S&&S!=""&&(G.data.info.Config.WorkingDir=S),hn(G.data.info),an(!0),(w=c.current)===null||w===void 0||w.resetFields(),(_n=c.current)===null||_n===void 0||_n.setFieldsValue({workDir:G.data.info.Config.WorkingDir});case 8:case"end":return mn.stop()}},nn)}))()}}});var c=(0,u.useRef)(),K=(0,u.useRef)(),tn=(0,u.useState)(!1),dn=o()(tn,2),Q=dn[0],an=dn[1],vn=(0,u.useState)(),cn=o()(vn,2),z=cn[0],hn=cn[1];return(0,u.useEffect)(function(){return z&&setTimeout(function(){var e;(e=K.current)===null||e===void 0||e.start(z.Id,{width:"800",height:"".concat(window.innerHeight),cmd:"/bin/sh",workDir:z.Config.WorkingDir})},1e3),function(){var e;(e=K.current)===null||e===void 0||e.close()}},[z,Q]),(0,a.jsxs)(x.a,{drawerProps:{forceRender:!0},onFinish:function(){var e=R()(_()().mark(function q(S){var nn,w;return _()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(z){G.next=2;break}return G.abrupt("return",!1);case 2:return(nn=K.current)===null||nn===void 0||nn.close(),(w=K.current)===null||w===void 0||w.start(z.Id,{width:"800",height:"".concat(window.innerHeight),cmd:S.entryCmd,workDir:S.workDir}),G.abrupt("return",!1);case 5:case"end":return G.stop()}},q)}));return function(q){return e.apply(this,arguments)}}(),onValuesChange:function(q,S){if(S.entryCmd){var nn;(nn=c.current)===null||nn===void 0||nn.submit()}},isKeyPressSubmit:!0,open:Q,formRef:c,onOpenChange:function(q){if(an(q),q){var S;(S=K.current)===null||S===void 0||S.fit()}},submitter:!1,title:(0,T.fi)(z?z.Name:"","/")+" \u63A7\u5236\u53F0",children:[(0,a.jsx)(v.Z,{ghost:!0,children:(0,a.jsxs)(t.Z.Compact,{children:[(0,a.jsx)(j.Z,{label:"shell",width:"sm",name:"entryCmd",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,a.jsx)(h.Z,{width:"sm",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",disabled:!0}),(0,a.jsx)(s.Z,{label:" ",children:(0,a.jsx)(P.Z,{name:["entryCmd","workDir"],children:function(q){var S=q.entryCmd;return(!S||S=="")&&(S="/bin/sh"),z&&(0,a.jsx)(d,{container:z.Id,query:{cmd:encodeURIComponent(S),workDir:encodeURIComponent(z.Config.WorkingDir)},onOpen:function(){var w;(w=K.current)===null||w===void 0||w.close(),an(!1)},content:"\u65B0\u7A97\u53E3\u6253\u5F00"})}})})]})}),Q&&(0,a.jsx)(m.Z,{showInDrawer:!0,ref:K})]})}),L=g},14245:function(rn,Z,n){n.d(Z,{Z:function(){return R}});var A=n(60433),o=n(38345),I=n(26412),_=n(25593),E=n(85893);function R(u){return(0,E.jsx)(o.Z,{ghost:u.ghost,title:(0,E.jsx)(A.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",children:(0,E.jsxs)(I.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,E.jsx)(I.Z.Item,{label:"Image Tag",children:(0,E.jsx)(_.Z.Text,{copyable:!0,children:u.data.Config.Image})}),(0,E.jsx)(I.Z.Item,{label:"Image",children:u.data.Image}),(0,E.jsx)(I.Z.Item,{label:"CMD",children:u.data.Config.Cmd&&u.data.Config.Cmd.join(" ")}),(0,E.jsx)(I.Z.Item,{label:"ENTRYPOINT",children:u.data.Config.Entrypoint}),(0,E.jsx)(I.Z.Item,{label:"Labels",children:(0,E.jsx)(I.Z,{column:1,bordered:!0,children:u.data&&Object.keys(u.data.Config.Labels).map(function(x){return(0,E.jsx)(I.Z.Item,{label:x,children:u.data.Config.Labels[x]},x)})})})]})})}},72409:function(rn,Z,n){n.d(Z,{Z:function(){return Pn}});var A=n(15009),o=n.n(A),I=n(99289),_=n.n(I),E=n(5574),R=n.n(E),u=n(67294),x=n(80821),v=n(62597),j=n(60335),h=n(43425),s=n(58638),P=n(60219),t=n(86548),f=n(57132),i=n(87784),D=n(25035),a=n(38345),d=n(97269),M=n(62370),T=n(5966),m=n(52688),g=n(82346),L=n(42075),r=n(65233),on=n(96074),c=n(28036),K=n(25593),tn=n(85418),dn=n(40411),Q=n(84567),an=n(83062),vn=n(93162),cn=n(24739),z=n(97462),hn=n(70146),e=n(85893);function q(B){var sn=(0,u.useRef)(),Dn=(0,g.useAccess)();return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(x.Z,{icon:(0,e.jsx)(P.Z,{}),action:_()(o()().mark(function ln(){var un,H,J,En;return o()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,(0,hn.yB)({id:B.container.Name,enableImage:(un=sn.current)===null||un===void 0?void 0:un.getFieldValue("enableImage"),volume:Object.keys((H=(J=sn.current)===null||J===void 0?void 0:J.getFieldValue("volume"))!==null&&H!==void 0?H:{}).filter(function(b){return b}),enableCommitImage:(En=sn.current)===null||En===void 0?void 0:En.getFieldValue("enableCommitImage")});case 2:case"end":return W.stop()}},ln)})),confirmOnOpenChange:function(un){var H,J;!((H=sn.current)===null||H===void 0)&&H.resetFields&&((J=sn.current)===null||J===void 0||J.resetFields())},confirm:(0,e.jsxs)(L.Z,{style:{width:600,marginTop:"10px",paddingRight:"10px"},direction:"vertical",size:20,children:[(0,e.jsx)(K.Z.Text,{children:(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:"\u5FEB\u7167\u529F\u80FD\u4F1A\u5C06\u3010\u5FEB\u7167\u6570\u636E\u3011\u4FDD\u5B58\u81F3 /dpanel/backup \u76EE\u5F55\u3002"}),(0,e.jsx)("li",{children:"\u5FEB\u7167\u540C\u65F6\u5907\u4EFD\u5BB9\u5668\u955C\u50CF\u5728\u6062\u590D\u540E\u65E0\u6CD5\u68C0\u6D4B\u66F4\u65B0\uFF0C\u5426\u5219\u6062\u590D\u65F6\u4F1A\u5148\u5C1D\u8BD5\u62C9\u53D6\u955C\u50CF"}),(0,e.jsx)("li",{children:"\u6062\u590D\u5FEB\u7167\u65F6\uFF0C\u5982\u679C\u76EE\u6807\u5BB9\u5668\u5DF2\u5B58\u5728\u5219\u53EA\u6062\u590D\u5BB9\u5668\u6570\u636E\u3002"}),(0,e.jsxs)("li",{children:["\u8BE5\u64CD\u4F5C\u53EF\u80FD\u4F1A\u6D88\u8017\u8F83\u957F\u65F6\u95F4\uFF0C\u8BF7\u5728 ",(0,e.jsx)(g.Link,{to:"/app/backup",children:"\u5BB9\u5668\u5FEB\u7167"})," \u67E5\u770B\u5FEB\u7167\u7ED3\u679C\u3002"]})]})}),(0,e.jsxs)(d.A,{layout:"horizontal",formRef:sn,submitter:!1,children:[(0,e.jsxs)(cn.UW,{children:[(0,e.jsx)(M.Z,{valuePropName:"checked",name:"enableSelectVolume",children:(0,e.jsx)(Q.Z,{disabled:!B.container.Mounts||B.container.Mounts.length==0,children:"\u9009\u62E9\u5907\u4EFD\u76EE\u5F55\uFF1F"})}),(0,e.jsx)(M.Z,{valuePropName:"checked",name:"enableImage",children:(0,e.jsx)(Q.Z,{children:"\u5907\u4EFD\u5BB9\u5668\u955C\u50CF\uFF1F"})}),(0,e.jsx)(z.Z,{name:["enableImage"],children:function(un){var H=un.enableImage;if(H)return(0,e.jsx)(M.Z,{valuePropName:"checked",name:"enableCommitImage",children:(0,e.jsx)(Q.Z,{children:"\u4FDD\u5B58\u5F53\u524D\u5BB9\u5668\u4E3A\u955C\u50CF\uFF1F"})})}})]}),(0,e.jsx)(z.Z,{name:["enableSelectVolume"],children:function(un){var H=un.enableSelectVolume;return H&&(0,e.jsx)(L.Z,{wrap:!0,children:B.container.Mounts.map(function(J,En){return(0,e.jsx)(M.Z,{valuePropName:"checked",name:["volume",J.Destination],children:(0,e.jsx)(Q.Z,{children:J.Destination})},"volume-".concat(En))})})}})]})]}),children:"\u5BB9\u5668\u5FEB\u7167"})})}var S=n(24963),nn=n(99861),w=n(3393),_n=n(50888),G=n(16596),Cn=n(1699),mn=n(5251),On=(0,u.forwardRef)(function(B,sn){var Dn;(0,u.useImperativeHandle)(sn,function(){return{}});var ln=(0,u.useRef)(),un=(0,u.useRef)(),H=(0,u.useRef)(),J=(0,u.useContext)(S.Z),En=J.message,$=J.notice,W=J.loading,b=J.lang,Y=(0,u.useRef)(),en=(0,u.useRef)(),gn=(0,u.useState)(0),X=R()(gn,2),k=X[0],fn=X[1],In=function(){var N=_()(o()().mark(function C(l){var F,O,y;return o()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(O=-2,!l.ignore){U.next=6;break}if(!(l.ignore.indexOf("".concat(l.info.Name,"@*"))>-1)){U.next=4;break}return U.abrupt("return",-2);case 4:if(!(l.ignore.indexOf("".concat(l.info.Name,"@").concat(l.info.Image))>-1)){U.next=6;break}return U.abrupt("return",-2);case 6:return U.next=8,(0,w.ZQ)({tag:(F=l.info.Config.Image)!==null&&F!==void 0?F:"",md5:l.info.Image,cacheTime:3600}).catch(function(p){O=-1});case 8:return y=U.sent,y&&(y.data.digestLocal&&y.data.digestLocal.length>0?O=y.data.upgrade?1:2:O=-2),U.abrupt("return",O);case 11:case"end":return U.stop()}},C)}));return function(l){return N.apply(this,arguments)}}();return(0,u.useEffect)(function(){B.checkContainerUpgrade&&(fn(0),In(B.data).then(function(N){fn(N)}))},[B.data]),(0,e.jsx)(a.Z,{ghost:B.ghost,title:(0,e.jsx)(h.Z,{}),subTitle:"\u5BB9\u5668\u7BA1\u7406",children:(0,e.jsxs)(L.Z,{wrap:!0,children:[(0,e.jsx)(x.Z,{icon:(0,e.jsx)(s.Z,{}),action:function(){var C,l;return(0,j.LJ)({md5:(C=(l=B.data)===null||l===void 0?void 0:l.info.Id)!==null&&C!==void 0?C:""})},confirm:"\u5BFC\u51FA\u5BB9\u5668\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u4E0D\u5305\u542B\u6302\u8F7D\u76EE\u5F55\u7684\u6570\u636E\uFF0C\u786E\u5B9A\u5417\uFF1F",onSuccess:function(C){var l,F=new Blob([C],{type:"application/tar"});(0,vn.saveAs)(F,(0,mn.fi)((l=B.data)===null||l===void 0?void 0:l.info.Name,"/")+".tar")},children:"\u5BFC\u51FA\u5BB9\u5668"}),(0,e.jsx)(x.Z,{icon:(0,e.jsx)(P.Z,{}),action:_()(o()().mark(function N(){var C,l,F,O,y;return o()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,(0,j.Re)({md5:(C=(l=B.data)===null||l===void 0?void 0:l.info.Id)!==null&&C!==void 0?C:"",name:(F=(O=un.current)===null||O===void 0?void 0:O.getFieldValue("saveImageName"))!==null&&F!==void 0?F:(y=B.data)===null||y===void 0?void 0:y.info.Name});case 2:case"end":return U.stop()}},N)})),confirmTitle:"\u5C06\u5F53\u524D\u5BB9\u5668\u4FDD\u5B58\u4E3A\u955C\u50CF",confirm:(0,e.jsx)(L.Z,{style:{width:400,marginTop:"10px",paddingRight:"10px"},direction:"vertical",children:(0,e.jsx)(d.A,{formRef:un,submitter:!1,children:(0,e.jsx)(M.Z,{name:"saveImageName",children:(0,e.jsx)(r.Z,{addonBefore:"\u955C\u50CF\u540D\u79F0"})})})}),children:"\u53E6\u5B58\u4E3A\u955C\u50CF"}),B.data&&(0,e.jsx)(Cn.u,{access:"canSeeContainerBackup",children:(0,e.jsx)(q,{container:B.data.info})}),(0,e.jsx)(on.Z,{type:"vertical"}),(0,e.jsx)(g.Link,{to:"/app/create/image?id=".concat((Dn=B.data)===null||Dn===void 0?void 0:Dn.info.Id,"&op=update"),children:(0,e.jsx)(c.ZP,{type:"primary",icon:(0,e.jsx)(t.Z,{}),children:"\u7F16\u8F91\u5BB9\u5668"})}),(0,e.jsx)(x.Z,{icon:(0,e.jsx)(f.Z,{}),action:_()(o()().mark(function N(){var C,l,F,O,y,V;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,j.aF)({md5:(C=(l=B.data)===null||l===void 0?void 0:l.info.Id)!==null&&C!==void 0?C:"",copyName:(F=(O=H.current)===null||O===void 0?void 0:O.getFieldValue("copyName"))!==null&&F!==void 0?F:"",enableRandomPort:(y=(V=H.current)===null||V===void 0?void 0:V.getFieldValue("enableRandomPort"))!==null&&y!==void 0?y:!1});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},N)})),confirm:(0,e.jsxs)(L.Z,{style:{width:400,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(K.Z.Text,{children:"\u9ED8\u8BA4\u60C5\u51B5\u4E0B, \u590D\u5236\u7684\u76EE\u6807\u5BB9\u5668\u4E0E\u5F53\u524D\u5BB9\u5668\u5177\u6709\u76F8\u540C\u7684\u914D\u7F6E\u65E0\u6CD5\u542F\u52A8\u3002 \u5982\u679C\u4F60\u5E0C\u671B\u76EE\u6807\u5BB9\u5668\u6B63\u5E38\u8FD0\u884C\uFF0C\u8BF7\u5F00\u542F\u3010\u7ED1\u5B9A\u968F\u673A\u7AEF\u53E3\u3011"}),(0,e.jsxs)(d.A,{formRef:H,submitter:!1,layout:"horizontal",children:[(0,e.jsx)("br",{}),(0,e.jsx)(T.Z,{label:"\u590D\u5236\u5BB9\u5668\u540D\u79F0",name:"copyName"}),(0,e.jsx)(m.Z,{label:"\u7ED1\u5B9A\u968F\u673A\u7AEF\u53E3",name:"enableRandomPort"})]})]}),onSuccess:function(C){var l;(l=H.current)===null||l===void 0||l.resetFields()},children:"\u590D\u5236\u5BB9\u5668"}),B.data&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(nn.Z,{image:[B.data.info.Config.Image],ref:Y}),(0,e.jsx)(tn.Z,{placement:"bottomLeft",menu:{items:[{key:"1",label:(0,e.jsx)(x.Z,{action:_()(o()().mark(function N(){var C,l,F,O,y,V;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,v.ze)({md5:(C=(l=B.data.info)===null||l===void 0?void 0:l.Name)!==null&&C!==void 0?C:"",imageId:""});case 2:return fn(0),p.next=5,(0,w.ZQ)({tag:(F=(O=B.data.info)===null||O===void 0?void 0:O.Config.Image)!==null&&F!==void 0?F:"",md5:(y=(V=B.data.info)===null||V===void 0?void 0:V.Image)!==null&&y!==void 0?y:"",cacheTime:0}).then(function(jn){jn.data.digestLocal&&jn.data.digestLocal.length>0?fn(jn.data.upgrade?1:2):fn(-2)}).catch(function(jn){fn(-1)});case 5:return p.abrupt("return",p.sent);case 6:case"end":return p.stop()}},N)})),type:"link",children:"\u81EA\u52A8\u68C0\u6D4B"})},{key:"2",label:(0,e.jsx)(x.Z,{action:_()(o()().mark(function N(){var C,l,F,O;return o()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,(0,v.ze)({md5:(C=(l=B.data.info)===null||l===void 0?void 0:l.Name)!==null&&C!==void 0?C:"",imageId:(F=(O=B.data.info)===null||O===void 0?void 0:O.Image)!==null&&F!==void 0?F:""});case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},N)})),type:"link",children:"\u5FFD\u7565\u672C\u6B21"})},{key:"3",label:(0,e.jsx)(x.Z,{action:_()(o()().mark(function N(){var C,l;return o()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,v.ze)({md5:(C=(l=B.data.info)===null||l===void 0?void 0:l.Name)!==null&&C!==void 0?C:"",imageId:"*"});case 2:return O.abrupt("return",O.sent);case 3:case"end":return O.stop()}},N)})),type:"link",children:"\u6C38\u4E45\u5FFD\u7565"})}]},children:(0,e.jsx)(dn.Z,{count:b("app.detail.checkImageUpgrade."+k),color:b("app.detail.checkImageUpgradeColor."+k),children:(0,e.jsx)(x.Z,{disabled:k===0,icon:k===0?(0,e.jsx)(_n.Z,{}):(0,e.jsx)(G.Z,{}),action:_()(o()().mark(function N(){var C,l,F,O,y;return o()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,(C=Y.current)===null||C===void 0?void 0:C.start();case 2:return W.show(),(l=Y.current)===null||l===void 0||l.finish(),U.next=6,(0,j.RF)({md5:(F=B.data.info.Id)!==null&&F!==void 0?F:"",imageTag:"",enableBak:(O=(y=en.current)===null||y===void 0?void 0:y.getFieldValue("enableBak"))!==null&&O!==void 0?O:!0});case 6:return U.abrupt("return",U.sent);case 7:case"end":return U.stop()}},N)})),confirm:(0,e.jsxs)(L.Z,{style:{width:280,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(K.Z.Text,{children:"\u66F4\u65B0\u5BB9\u5668\u524D\u8BF7\u786E\u4FDD\u8FDC\u7A0B Docker \u7248\u672C\u4E0E\u9762\u677F\u73AF\u5883\u4E00\u81F4\u3002\u6B64\u64CD\u4F5C\u5C06\u4F1A\u91CD\u65B0\u62C9\u53D6\u955C\u50CF\u5E76\u91CD\u5EFA\u5BB9\u5668\u3002\u786E\u5B9A\u5417\uFF1F"}),(0,e.jsx)(d.A,{formRef:en,submitter:!1,layout:"inline",children:(0,e.jsx)(M.Z,{name:"enableBak",initialValue:!0,valuePropName:"checked",children:(0,e.jsx)(Q.Z,{children:"\u5907\u4EFD\u65E7\u5BB9\u5668\uFF1F"})})})]}),onSuccess:function(C){W.destroy(),B.checkContainerUpgrade&&B.checkContainerUpgrade()},children:"\u5FEB\u901F\u5347\u7EA7\u5BB9\u5668"})})})]}),(0,e.jsx)(on.Z,{type:"vertical"}),B.data&&(0,e.jsx)(x.Z,{action:function(){var C,l,F,O,y,V;return(0,v.Ct)({md5:(C=(l=B.data)===null||l===void 0?void 0:l.info.Id)!==null&&C!==void 0?C:"",deleteImage:(F=(O=ln.current)===null||O===void 0?void 0:O.getFieldValue("deleteImage"))!==null&&F!==void 0?F:!1,deleteVolume:(y=(V=ln.current)===null||V===void 0?void 0:V.getFieldValue("deleteVolume"))!==null&&y!==void 0?y:!1})},danger:!0,type:"primary",icon:(0,e.jsx)(i.Z,{}),onSuccess:function(){W.destroy(),B.checkContainerUpgrade&&B.checkContainerUpgrade()},confirm:(0,e.jsxs)(L.Z,{style:{width:200},direction:"vertical",children:[(0,e.jsx)(K.Z.Text,{children:b("notification.confirm.title")}),(0,e.jsxs)(d.A,{formRef:ln,layout:"inline",submitter:!1,children:[(0,e.jsx)(M.Z,{addonAfter:(0,e.jsx)(an.Z,{title:"\u672A\u6302\u8F7D\u955C\u50CF\u5185\u58F0\u660E\u7684\u76EE\u5F55\u5E76\u7531 docker \u81EA\u52A8\u521B\u5EFA\u7684\u5B58\u50A8\u5377",children:(0,e.jsx)(D.Z,{})}),name:"deleteVolume",valuePropName:"checked",children:(0,e.jsx)(Q.Z,{children:"\u5220\u9664\u533F\u540D\u5B58\u50A8\u5377\uFF1F"})}),(0,e.jsx)(M.Z,{name:"deleteImage",valuePropName:"checked",children:(0,e.jsx)(Q.Z,{children:"\u5220\u9664\u955C\u50CF\uFF1F"})})]})]}),children:"\u5220\u9664"})]})})}),Pn=On},14189:function(rn,Z,n){var A=n(43425),o=n(74842),I=n(87784),_=n(33160),E=n(30159),R=n(89035),u=n(38345),x=n(42075),v=n(96074),j=n(28036),h=n(67294),s=n(94359),P=n(80821),t=n(60335),f=n(57716),i=n(85893),D=(0,h.forwardRef)(function(a,d){(0,h.useImperativeHandle)(d,function(){return{}});var M=(0,h.useRef)();return(0,i.jsx)(u.Z,{title:(0,i.jsx)(A.Z,{}),ghost:a.ghost,subTitle:(0,i.jsxs)(x.Z,{children:["\u72B6\u6001\u7BA1\u7406 - ",a.data&&(0,i.jsx)(s.Z,{status:a.data.State.Status,message:{content:a.data.State.Status,placement:"top"}})]}),children:(0,i.jsxs)(x.Z,{wrap:!0,children:[(0,i.jsx)(P.Z,{icon:(0,i.jsx)(o.Z,{}),action:function(){var m,g;return(0,t.IW)({md5:(m=(g=a.data)===null||g===void 0?void 0:g.Id)!==null&&m!==void 0?m:"",operate:"start"})},onSuccess:function(){return a.onFinish&&a.onFinish()},disabled:a.data&&a.data.State.Running||a.data&&a.data.State.Paused,children:"\u542F\u52A8"}),(0,i.jsx)(P.Z,{action:function(){var m,g;return(0,t.IW)({md5:(m=(g=a.data)===null||g===void 0?void 0:g.Id)!==null&&m!==void 0?m:"",operate:"stop"})},icon:(0,i.jsx)(I.Z,{}),onSuccess:function(){return a.onFinish&&a.onFinish()},disabled:a.data&&a.data.State.Dead,children:"\u505C\u6B62"}),(0,i.jsx)(P.Z,{action:function(){var m,g;return(0,t.IW)({md5:(m=(g=a.data)===null||g===void 0?void 0:g.Id)!==null&&m!==void 0?m:"",operate:"restart"})},onSuccess:function(){return a.onFinish&&a.onFinish()},icon:(0,i.jsx)(_.Z,{}),children:"\u91CD\u542F"}),(0,i.jsx)(P.Z,{action:function(){var m,g;return(0,t.IW)({md5:(m=(g=a.data)===null||g===void 0?void 0:g.Id)!==null&&m!==void 0?m:"",operate:"pause"})},onSuccess:function(){return a.onFinish&&a.onFinish()},icon:(0,i.jsx)(E.Z,{}),disabled:a.data&&a.data&&!a.data.State.Running,children:"\u6682\u505C"}),(0,i.jsx)(P.Z,{action:function(){var m,g;return(0,t.IW)({md5:(m=(g=a.data)===null||g===void 0?void 0:g.Id)!==null&&m!==void 0?m:"",operate:"unpause"})},onSuccess:function(){return a.onFinish&&a.onFinish()},icon:(0,i.jsx)(o.Z,{}),disabled:a.data&&!a.data.State.Paused,children:"\u6062\u590D"}),(0,i.jsx)(v.Z,{type:"vertical"}),a.data&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{ref:M}),(0,i.jsx)(j.ZP,{type:"dashed",onClick:function(){var m;a.data&&((m=M.current)===null||m===void 0||m.show(a.data.Id))},icon:(0,i.jsx)(R.Z,{}),children:"Console"})]}),(0,i.jsx)(v.Z,{type:"vertical"}),a.extra&&a.extra.map(function(T,m){return(0,i.jsx)("span",{children:T},m)})]})})});Z.Z=D},52031:function(rn,Z,n){n.d(Z,{Z:function(){return x}});var A=n(31574),o=n(95591),I=n(38345),_=n(26412),E=n(78451),R=n(82346),u=n(85893);function x(v){var j,h=(0,R.useAccess)();return v.data&&v.data.Mounts&&v.data.Mounts.length>0&&(0,u.jsx)(I.Z,{ghost:v.ghost,title:(0,u.jsx)(A.Z,{}),subTitle:"\u6302\u8F7D\u76EE\u5F55\u8BE6\u60C5",children:(0,u.jsx)(_.Z,{column:1,bordered:!0,children:(j=v.data)===null||j===void 0?void 0:j.Mounts.map(function(s,P){var t;return(0,u.jsx)(_.Z.Item,{labelStyle:{width:"30%"},label:s.Type=="volume"?(0,u.jsx)(E.Z,{content:s.Name}):s.Source,children:h.canSeeContainerListManage?(0,u.jsxs)(R.Link,{target:"_blank",to:"/app/detail/file/".concat((t=v.data)===null||t===void 0?void 0:t.Id,"?tab=file&path=").concat(encodeURIComponent(s.Destination)),children:[s.Destination," ",(0,u.jsx)(o.Z,{})]}):s.Destination},P)})})})}},49610:function(rn,Z,n){var A=n(67294),o=n(54964),I=n(52626),_=n(12320),E=n.n(_),R=n(78267),u=n.n(R),x=n(85893),v,j=new _.Terminal(o.a),h=new R.FitAddon,s=(0,A.forwardRef)(function(P,t){var f,i=function(){j.reset(),f&&f.dispose(),v&&(v.close(),v=null)},D=function(){j.reset(),h.fit(),j.focus(),f&&f.dispose(),f=j.onData(function(d){var M={content:{command:d},type:"console"};v&&v.send(JSON.stringify(M))})};return(0,A.useImperativeHandle)(t,function(){return{start:function(d,M){var T=M?Object.keys(M).map(function(m){if(M&&M[m])return"".concat(m,"=").concat(M[m])}):[];v=new WebSocket((0,I.R)("/console/"+d+"?"+T.join("&"))),v.addEventListener("message",function(m){var g=JSON.parse(m.data),L=g.type;if(L=="console:"+d&&(j.write(g.data),g.data.indexOf("exec failed")!=-1)){i();return}}),D()},close:function(){i()},fit:function(){h.fit()}}}),(0,A.useEffect)(function(){return j.loadAddon(h),j.open(document.getElementById("terminal-container-console")),h.fit(),function(){i()}},[]),(0,x.jsx)("div",{style:{height:P.showInDrawer?"75vh":"100vh"},id:"terminal-container-console"})});Z.Z=s},94359:function(rn,Z,n){n.d(Z,{Z:function(){return P}});var A=n(3089),o=n(98165),I=n(18429),_=n(8751),E=n(14313),R=n(30159),u=n(87740),x=n(50888),v=n(66309),j=n(83062),h=n(82346),s=n(85893);function P(t){var f=(0,s.jsx)(s.Fragment,{});if(t.status=="0"&&(f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(A.Z,{}),color:"default",children:"waiting"})),t.status=="10"&&(f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(o.Z,{spin:!0}),color:"processing",children:"processing"})),t.status=="20"&&(f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(I.Z,{}),color:"error",children:"error"})),t.status=="30"&&(f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(_.Z,{}),color:"success",children:"success"})),t.status=="running"||t.status=="healthy"){var i,D;f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(E.Z,{}),color:"success",children:(i=t.message)!==null&&i!==void 0&&i.showInTag?(D=t.message)===null||D===void 0?void 0:D.content:t.status})}if(t.status=="paused"){var a,d;f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(R.Z,{}),children:(a=t.message)!==null&&a!==void 0&&a.showInTag?(d=t.message)===null||d===void 0?void 0:d.content:t.status})}if(t.status=="waiting"||t.status=="starting"){var M,T;f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(u.Z,{}),children:(M=t.message)!==null&&M!==void 0&&M.showInTag?(T=t.message)===null||T===void 0?void 0:T.content:t.status})}if(t.status=="deploying"){var m,g;f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(x.Z,{}),color:"processing",children:(m=t.message)!==null&&m!==void 0&&m.showInTag?(g=t.message)===null||g===void 0?void 0:g.content:t.status})}if(t.status=="error"){var L,r;f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(I.Z,{}),color:"error",children:(L=t.message)!==null&&L!==void 0&&L.showInTag?(r=t.message)===null||r===void 0?void 0:r.content:t.status})}if(t.status=="exited"||t.status=="dead"||t.status=="removing"||t.status=="restarting"||t.status=="unhealthy"||t.status=="created"){var on,c;f=(0,s.jsx)(v.Z,{icon:(0,s.jsx)(I.Z,{}),color:"warning",children:(on=t.message)!==null&&on!==void 0&&on.showInTag?(c=t.message)===null||c===void 0?void 0:c.content:t.status})}if(t.link)return(0,s.jsx)(h.Link,{to:t.link,children:f});if(t.message){var K,tn;return(0,s.jsx)(j.Z,{placement:(K=t.message.placement)!==null&&K!==void 0?K:"top",title:(tn=t.message.title)!==null&&tn!==void 0?tn:t.message.content,children:f})}return f}},76428:function(rn,Z,n){n.d(Z,{Z:function(){return _}});var A=n(25593),o=n(67294),I=n(85893);function _(E){return(0,I.jsx)(A.Z.Text,{copyable:!0,children:E.title})}},78498:function(rn,Z,n){n.d(Z,{Z:function(){return R}});var A=n(25035),o=n(42075),I=n(83062),_=n(67294),E=n(85893);function R(u){return(0,E.jsxs)(o.Z,{children:[u.title,(0,E.jsx)(I.Z,{title:u.help,children:(0,E.jsx)(A.Z,{})})]})}},54964:function(rn,Z,n){n.d(Z,{a:function(){return s}});var A=n(5574),o=n.n(A),I=n(78267),_=n.n(I),E=n(75458),R=n.n(E),u=n(67294),x=n(12320),v=n.n(x),j=n(89629),h=n(85893),s={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},P=new x.Terminal(s),t=new E.SearchAddon,f=new I.FitAddon,i=(0,u.forwardRef)(function(D,a){var d,M=(0,u.useState)(!0),T=o()(M,2),m=T[0],g=T[1];return(0,u.useEffect)(function(){return window.addEventListener("resize",function(){D.showInModal||f.fit()}),D.style&&D.style.fontSize&&(P.options.fontSize=D.style.fontSize),P.loadAddon(f),P.loadAddon(t),P.open(document.getElementById(D.id?D.id:"terminal-container")),D.showInModal||f.fit(),function(){P.reset(),g(!0)}},[]),(0,u.useImperativeHandle)(a,function(){return{write:function(r){m&&(f.fit(),g(!1)),P.write(r)},clear:function(){P.clear()},getTerminal:function(){return P},findNext:function(r){t.findNext(r)},findPrev:function(r){t.findPrevious(r)},fit:function(){f.fit()},onData:function(r){return P.onData(r)}}}),(0,h.jsx)("div",{id:D.id?D.id:"terminal-container",style:{width:D.width?D.width:"100%",height:D.height?D.height:"500px",marginTop:(d=D.style)===null||d===void 0?void 0:d.marginTop}})});Z.Z=i},70146:function(rn,Z,n){n.d(Z,{SR:function(){return s},VE:function(){return j},Zy:function(){return x},iD:function(){return t},yB:function(){return R}});var A=n(15009),o=n.n(A),I=n(99289),_=n.n(I),E=n(82346);function R(i){return u.apply(this,arguments)}function u(){return u=_()(o()().mark(function i(D){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,E.request)("/api/app/container-backup/create",{data:D,method:"POST"});case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},i)})),u.apply(this,arguments)}function x(i){return v.apply(this,arguments)}function v(){return v=_()(o()().mark(function i(D){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,E.request)("/api/app/container-backup/get-list",{method:"POST",data:D}));case 1:case"end":return d.stop()}},i)})),v.apply(this,arguments)}function j(i){return h.apply(this,arguments)}function h(){return h=_()(o()().mark(function i(D){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,E.request)("/api/app/container-backup/delete",{method:"POST",data:D}));case 1:case"end":return d.stop()}},i)})),h.apply(this,arguments)}function s(i){return P.apply(this,arguments)}function P(){return P=_()(o()().mark(function i(D){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,E.request)("/api/app/container-backup/restore",{method:"POST",data:D}));case 1:case"end":return d.stop()}},i)})),P.apply(this,arguments)}function t(i){return f.apply(this,arguments)}function f(){return f=_()(o()().mark(function i(D){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,E.request)("/api/app/container-backup/get-detail",{method:"POST",data:D}));case 1:case"end":return d.stop()}},i)})),f.apply(this,arguments)}}}]);
