"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8195],{77273:function(z,O,r){var M=r(15009),E=r.n(M),j=r(99289),U=r.n(j),g=r(5574),A=r.n(g),J=r(184),m=r(5966),H=r(86615),D=r(97462),w=r(64317),K=r(52688),c=r(62370),i=r(38345),Q=r(31199),d=r(90672),x=r(71230),p=r(15746),$=r(42075),T=r(86250),X=r(40056),C=r(67294),k=r(91845),R=r(87662),y=r(12491),N=r(89035),W=r(36146),Z=r(3616),e=r(85893),L=(0,C.forwardRef)(function(P,G){var I,B;(0,C.useImperativeHandle)(G,function(){return{edit:function(a){var n,s=a.address.split("://"),l=A()(s,2),v=l[0],h=l[1];(n=_.current)===null||n===void 0||n.setFieldsValue({name:a.name,title:a.title,addressType:"".concat(v,"://"),address:h,serverUrl:a.serverUrl,enableTLS:a.enableTLS,tlsCa:a.tlsCa,tlsCert:a.tlsCert,tlsKey:a.tlsKey,enableComposePath:a.enableComposePath,enableSSH:a.enableSSH,sshServerInfo:a.sshServerInfo,remoteType:a.remoteType?a.remoteType:"docker"}),Y(!0),re(a.name)}}});var t=new W.Uo("components.dockerEnvCreate"),F=(0,C.useState)(!1),b=A()(F,2),V=b[0],Y=b[1],_=(0,C.useRef)(),ne=(0,C.useState)(""),q=A()(ne,2),ee=q[0],re=q[1];return(0,e.jsxs)(J.a,{drawerProps:{forceRender:!0,width:Z.R_},onOpenChange:function(a){if(!a){var n;re(""),(n=_.current)===null||n===void 0||n.resetFields()}Y(a)},open:V,width:800,trigger:P.trigger,formRef:_,title:t.format((I=_.current)!==null&&I!==void 0&&I.getFieldValue&&_.current.getFieldValue("name")=="local"?"drawerTitleDefault":"drawerTitle"),onFinish:function(){var S=U()(E()().mark(function a(n){var s,l,v,h;return E()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return l="",n.remoteType&&n.remoteType=="ssh"?l="ssh://":l=(v=n.addressType)!==null&&v!==void 0?v:"unix://",o.next=4,(0,R.ad)({name:n.name,title:n.title,address:"".concat(l).concat((s=n.address)!==null&&s!==void 0?s:n.sshServerInfo.address),serverUrl:n.serverUrl,enableTLS:n.enableTLS,tlsCa:n.tlsCa,tlsCert:n.tlsCert,tlsKey:n.tlsKey,enableComposePath:n.enableComposePath,composePath:n.enableComposePath?n.composePath:"",enableSSH:n.enableSSH||n.remoteType=="ssh",sshServerInfo:n.sshServerInfo,remoteType:n.remoteType});case 4:return h=o.sent,P.onFinish&&P.onFinish(),o.abrupt("return",!0);case 7:case"end":return o.stop()}},a)}));return function(a){return S.apply(this,arguments)}}(),children:[(0,e.jsx)(m.Z,{label:t.format("formTitle"),name:"title",required:!0,rules:[{required:!0}],fieldProps:{id:"envTitle",onChange:function(a){var n="";if(a.target.value&&!ee){var s,l=(0,k.N9)(a.target.value.trim(),{toneType:"none",type:"array"});n=l.join(""),(s=_.current)===null||s===void 0||s.setFieldValue("name",n)}}}},"envTitle"),(0,e.jsx)(m.Z,{label:t.format("formName"),name:"name",required:!0,disabled:ee!="",rules:[{required:!0}],placeholder:t.format("formNameEmpty")}),(0,e.jsx)(m.Z,{tooltip:t.format("formServerUrlTip"),label:t.format("formServerUrl"),name:"serverUrl",placeholder:t.format("formServerUrlEmpty")}),(0,e.jsx)(H.Z.Group,{label:t.format("formRemoteType"),name:"remoteType",options:[{label:"DockerApi",value:"docker"},{label:"SSH",value:"ssh",disabled:((B=_.current)===null||B===void 0?void 0:B.getFieldValue("name"))=="local"}]}),(0,e.jsx)(D.Z,{name:["remoteType","name"],children:function(a){var n=a.remoteType,s=a.name;return(0,e.jsxs)(e.Fragment,{children:[n=="docker"&&(0,e.jsx)(x.Z,{children:(0,e.jsx)(p.Z,{span:24,children:(0,e.jsxs)($.Z.Compact,{children:[(0,e.jsx)(w.Z,{name:"addressType",label:t.format("formAddressType"),valueEnum:{"unix://":"unix://","tcp://":"tcp://"},initialValue:"tcp://",fieldProps:{defaultValue:"tcp://"},width:"sm",tooltip:t.format("formAddressTypeTip")}),(0,e.jsx)(m.Z,{label:" ",name:"address",required:!0,width:"xl",rules:[{required:!0}],placeholder:t.format("formAddressEmpty")})]})})}),(0,e.jsxs)(x.Z,{gutter:[15,0],children:[n=="docker"&&(0,e.jsx)(p.Z,{children:(0,e.jsx)(K.Z,{label:t.format("formEnableTLS"),name:"enableTLS",tooltip:t.format("formEnableTLSTip")})}),s!="local"&&typeof n!="undefined"&&(0,e.jsx)(p.Z,{children:(0,e.jsx)(K.Z,{label:t.format("formEnableComposePath"),name:"enableComposePath",tooltip:t.format("formEnableComposePathTip")})}),n=="docker"&&(0,e.jsx)(p.Z,{children:(0,e.jsx)(K.Z,{label:t.format("formEnableSSH"),name:"enableSSH"})})]})]})}}),(0,e.jsx)(D.Z,{name:["enableTLS","remoteType"],children:function(a){var n=a.enableTLS,s=a.remoteType;if(n&&s=="docker"){var l,v,h;return(0,e.jsxs)(T.Z,{gap:10,justify:"start",children:[(0,e.jsx)(c.Z,{name:"tlsCa",label:t.format("formTlsCa"),children:(0,e.jsx)(y.Z,{showPaset:!0,data:(l=_.current)===null||l===void 0?void 0:l.getFieldValue("tlsCa"),title:"ca.pem",onImport:function(o){var f;return(f=_.current)===null||f===void 0||f.setFieldValue("tlsCa",o),!0},onLoad:function(o){if(o.indexOf("CERTIFICATE")<0)throw new Error(t.format("formEnableTLSMessageUploadError",{name:"ca.pem"}));return!0}})}),(0,e.jsx)(c.Z,{name:"tlsCert",label:" ",children:(0,e.jsx)(y.Z,{showPaset:!0,data:(v=_.current)===null||v===void 0?void 0:v.getFieldValue("tlsCert"),title:"cert.pem",onImport:function(o){var f;return(f=_.current)===null||f===void 0||f.setFieldValue("tlsCert",o),!0},onLoad:function(o){if(o.indexOf("CERTIFICATE")<0)throw new Error(t.format("formEnableTLSMessageUploadError",{name:"cert.pem"}));return!0}})}),(0,e.jsx)(c.Z,{label:" ",name:"tlsKey",children:(0,e.jsx)(y.Z,{showPaset:!0,data:(h=_.current)===null||h===void 0?void 0:h.getFieldValue("tlsKey"),title:"key.pem",onImport:function(o){var f;return(f=_.current)===null||f===void 0||f.setFieldValue("tlsKey",o),!0},onLoad:function(o){if(o.indexOf("PRIVATE")<0)throw new Error(t.format("formEnableTLSMessageUploadError",{name:"key.pem"}));return!0}})})]})}}}),(0,e.jsx)(D.Z,{name:["enableComposePath","name"],children:function(a){var n=a.enableComposePath,s=a.name;if(n)return(0,e.jsx)(m.Z,{label:t.format("formComposePath"),name:"composePath",disabled:!0,fieldProps:{value:"/dpanel/compose/compose-".concat(s!=null?s:"")}})}}),(0,e.jsx)(D.Z,{name:["enableSSH","sshServerInfo","remoteType","address"],children:function(a){var n=a.enableSSH,s=a.sshServerInfo,l=a.remoteType,v=a.address;return(n||l=="ssh")&&[(0,e.jsxs)(i.Z,{title:(0,e.jsx)(N.Z,{}),subTitle:t.format("formEnableSSHTitle"),ghost:!0,children:[(0,e.jsxs)(e.Fragment,{children:[l=="ssh"&&(0,e.jsx)(c.Z,{children:(0,e.jsx)(X.Z,{message:(0,e.jsxs)(e.Fragment,{children:[t.format("formEnableSSHAlert")," \xA0",(0,e.jsx)("a",{href:"https://dpanel.cc/manual/system-env#ssh",target:"_blank",children:W.FD.format("help")})]})})}),(0,e.jsx)(m.Z,{label:t.format("formSshServerInfoAddress"),placeholder:t.format("formSshServerInfoAddressEmpty"),name:["sshServerInfo","address"],required:!0,rules:[{required:!0}]})]}),(0,e.jsxs)(x.Z,{children:[(0,e.jsx)(p.Z,{children:(0,e.jsx)(Q.Z,{initialValue:22,label:t.format("formSshServerInfoPort"),name:["sshServerInfo","port"]})}),(0,e.jsx)(p.Z,{offset:2,children:(0,e.jsx)(H.Z.Group,{label:t.format("formSshServerInfoAuthType"),name:["sshServerInfo","authType"],valueEnum:{basic:t.format("formSshServerInfoAuthTypeBasic"),pem:t.format("formSshServerInfoAuthTypePem")},fieldProps:{onChange:function(){var u;(u=_.current)===null||u===void 0||u.setFieldValue(["sshServerInfo","password"],"")}},required:!0,rules:[{required:!0}]})})]}),s&&s.authType=="basic"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(m.Z,{label:t.format("formSshServerInfoUsername"),name:["sshServerInfo","username"],required:!0,rules:[{required:!0}]}),(0,e.jsx)(m.Z.Password,{label:t.format("formSshServerInfoPassword"),name:["sshServerInfo","password"],required:!0,rules:[{required:!0}]})]}),s&&s.authType=="pem"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(m.Z,{label:t.format("formSshServerInfoUsername"),name:["sshServerInfo","username"],required:!0,rules:[{required:!0}]}),(0,e.jsx)(y.Z,{title:t.format("formSshServerInfoPrivateKeyImport"),onImport:function(u){var o;return(o=_.current)===null||o===void 0||o.setFieldValue(["sshServerInfo","privateKey"],u),!0},onLoad:function(u){if(!u.includes("PRIVATE KEY"))throw new Error(t.format("formEnableTLSMessageUploadError",{name:"private.key"}));return!0}}),(0,e.jsx)(d.Z,{name:["sshServerInfo","privateKey"],label:t.format("formSshServerInfoPrivateKey"),required:!0,rules:[{required:!0}]}),(0,e.jsx)(m.Z.Password,{name:["sshServerInfo","password"],label:t.format("formSshServerInfoPrivateKeyPassword")})]})]},"sshSetting")]}})]})});O.Z=L},12491:function(z,O,r){r.d(O,{Z:function(){return Q}});var M=r(5574),E=r.n(M),j=r(3616),U=r(24963),g=r(36146),A=r(88484),J=r(57546),m=r(62370),H=r(11106),D=r(42075),w=r(83622),K=r(85576),c=r(67294),i=r(85893);function Q(d){var x=(0,c.useContext)(U.Z),p=x.message,$=x.notice,T=(0,c.useRef)(null),X=(0,c.useState)(!1),C=E()(X,2),k=C[0],R=C[1],y=(0,c.useState)(""),N=E()(y,2),W=N[0],Z=N[1];(0,c.useEffect)(function(){d.data&&Z(d.data)},[d.data]);var e=function(){T.current&&(T.current.click(),T.current.onchange=function(P){if(!P||!P.target)return"";var G=new FileReader;G.onload=function(t){var F,b,V=(F=t.target)===null||F===void 0?void 0:F.result;if(d.onLoad)try{d.onLoad&&d.onLoad(V)}catch(Y){$.error(Y);return}Z(V),typeof d.onImport=="function"&&(p.success(g.FD.format("finish")),d.onImport(V)),(b=T.current)!==null&&b!==void 0&&b.value&&(T.current.value="")};var I=P.target;if(I.files&&I.files[0]){var B=I.files[0];try{G.readAsText(B)}catch(t){$.error(g.FD.format("commonContentIncorrectFormat",{name:I.files[0].name}))}}})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.Z,{children:(0,i.jsxs)(D.Z.Compact,{block:!0,children:[(0,i.jsx)(w.ZP,{icon:(0,i.jsx)(A.Z,{}),block:!0,onClick:e,children:d.title}),d.showPaset&&(0,i.jsx)(w.ZP,{icon:(0,i.jsx)(J.Z,{}),onClick:function(){R(!0)}})]})}),(0,i.jsx)("input",{style:{display:"none"},type:"file",ref:T,name:"importFileInput"}),(0,i.jsx)(K.Z,{width:j.ob,open:k,onCancel:function(){R(!1)},onOk:function(){typeof d.onImport=="function"&&(p.success(g.FD.format("finish")),d.onImport(W)),R(!1)},children:(0,i.jsx)(H.ZP,{height:j.Ed,theme:"dark",value:W,onChange:function(P){Z(P)}})})]})}},3616:function(z,O,r){r.d(O,{Ed:function(){return U},FK:function(){return E},R_:function(){return M},ob:function(){return j}});var M=window.innerWidth<=1024?"90vw":"65vw",E="90vw",j="60vw",U="50vh"},24963:function(z,O,r){var M=r(67294),E=(0,M.createContext)({});O.Z=E}}]);
