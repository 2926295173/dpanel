"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3158],{99922:function(ce,K,e){var S=e(97857),r=e.n(S),L=e(15009),d=e.n(L),R=e(99289),U=e.n(R),D=e(5574),x=e.n(D),C=e(67294),N=e(184),m=e(42075),a=e(49610),j=e(3616),M=e(93362),w=e(90581),I=e(85893),c=(0,C.forwardRef)(function(b,v){var l,B,re=(0,C.useRef)(),g=(0,C.useRef)(),O=(0,C.useState)(!1),A=x()(O,2),de=A[0],ne=A[1],ae=(0,C.useState)(),Q=x()(ae,2),f=Q[0],ue=Q[1];return(0,C.useImperativeHandle)(v,function(){return{show:function(o){return U()(d()().mark(function $(){var le;return d()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:ue(o),ne(!0),(le=re.current)===null||le===void 0||le.resetFields();case 3:case"end":return oe.stop()}},$)}))()}}}),(0,C.useEffect)(function(){return setTimeout(function(){var Z;f&&((Z=g.current)===null||Z===void 0||Z.start(f.url,{cmd:f&&f.cmd,workDir:f&&f.workDir}))},500),function(){var Z;(Z=g.current)===null||Z===void 0||Z.close()}},[f,de]),(0,I.jsxs)(N.a,{drawerProps:{forceRender:!0,width:j.FK,extra:(0,I.jsx)(m.Z,{children:(0,I.jsx)(M.Z,{apiPrefix:"container",workDir:f&&f.workDir,title:(l=f==null?void 0:f.title)!==null&&l!==void 0?l:"",name:f&&f.url&&(B=f.url.split("/").pop())!==null&&B!==void 0?B:""})})},onFinish:function(){var Z=U()(d()().mark(function o($){var le;return d()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(f){oe.next=2;break}return oe.abrupt("return",!1);case 2:return(le=g.current)===null||le===void 0||le.close(),$.entryCmd!=(f==null?void 0:f.cmd)&&ue(r()(r()({},f),{cmd:$.entryCmd})),oe.abrupt("return",!1);case 5:case"end":return oe.stop()}},o)}));return function(o){return Z.apply(this,arguments)}}(),onValuesChange:function(o,$){if($.entryCmd){var le;(le=re.current)===null||le===void 0||le.submit()}},isKeyPressSubmit:!0,open:de,formRef:re,onOpenChange:function(o){if(ne(o),!o){var $;($=g.current)===null||$===void 0||$.close()}},submitter:!1,title:(f==null?void 0:f.title)+" - \u63A7\u5236\u53F0",children:[(0,I.jsx)(w.Z,{onOpenNewWindow:function(o){return f?(o.workDir=f&&f.workDir?f.workDir:"","".concat(f.url,"?").concat(Object.keys(o).map(function($){return"".concat($,"=").concat(encodeURIComponent(o[$]))}).join("&"))):""},onOpenNewWindowFinish:function(){var o;(o=g.current)===null||o===void 0||o.close(),ne(!1)},onBatchCommandFinish:function(o){g.current&&g.current.run(o)}}),de&&(0,I.jsx)(a.Z,{height:"80vh",ref:g})]})});K.Z=c},93362:function(ce,K,e){var S=e(97857),r=e.n(S),L=e(5574),d=e.n(L),R=e(67294),U=e(4459),D=e(25593),x=e(85265),C=e(95591),N=e(3616),m=e(82346),a=e(85893),j=(0,R.forwardRef)(function(M,w){var I=(0,R.useState)(!1),c=d()(I,2),b=c[0],v=c[1],l=(0,m.useSearchParams)(),B=d()(l,2),re=B[0],g=B[1];return(0,R.useImperativeHandle)(w,function(){return{}}),(0,a.jsxs)(a.Fragment,{children:[M.trigger?R.cloneElement(M.trigger,{onClick:function(){v(!0)}}):(0,a.jsx)(D.Z.Link,{onClick:function(){v(!0)},children:(0,a.jsx)(C.Z,{})},"file"),(0,a.jsx)(x.Z,{width:N.R_,title:"".concat(M.title," - \u6587\u4EF6\u7BA1\u7406"),onClose:function(){g([]),v(!1)},open:b,children:b&&(0,a.jsx)(U.Z,r()({},M))})]})});K.Z=j},80821:function(ce,K,e){e.d(K,{Z:function(){return m}});var S=e(97857),r=e.n(S),L=e(5574),d=e.n(L),R=e(24963),U=e(86738),D=e(28036),x=e(83062),C=e(67294),N=e(85893);function m(a){var j=(0,C.useState)(!1),M=d()(j,2),w=M[0],I=M[1],c=(0,C.useContext)(R.Z),b=c.lang,v=c.message,l=function(){I(!0);var re=a.action();re instanceof Promise?re.then(function(g){if(I(!1),g){typeof a.onSuccess=="function"&&a.onSuccess(g);var O="";a.messageSuccess?typeof a.messageSuccess=="function"?O=a.messageSuccess(g):O=a.messageSuccess.indexOf("notification.")==0?b(a.messageSuccess):a.messageSuccess:O=b("notification.finish"),a.asynced?v.info(O):v.success(O)}}).catch(function(g){I(!1),typeof a.onError=="function"&&a.onError(g)}):I(!1)};return a.confirm?(0,N.jsx)(U.Z,r()(r()({style:{width:500},title:a.confirmTitle?a.confirmTitle:b("notification.title.tip"),description:typeof a.confirm=="string"&&a.confirm.indexOf("notification.")==0?b(a.confirm):a.confirm,onConfirm:l,okText:"Yes",cancelText:"No",onOpenChange:a.confirmOnOpenChange},a.confirmProps),{},{children:(0,N.jsx)(D.ZP,{block:a.block,disabled:a.disabled,icon:!a.children&&w?void 0:a.icon,loading:w,danger:a.danger,type:a.type,children:a.children})})):(0,N.jsx)(x.Z,{title:a.tips,children:(0,N.jsx)(D.ZP,{block:a.block,style:a.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:a.disabled,icon:!a.children&&w?void 0:a.icon,loading:w,onClick:l,danger:a.danger,type:a.type,children:a.children})})}},90581:function(ce,K,e){e.d(K,{Z:function(){return l}});var S=e(15009),r=e.n(S),L=e(99289),d=e.n(L),R=e(5574),U=e.n(R),D=e(3616),x=e(38345),C=e(64317),N=e(37476),m=e(62370),a=e(97462),j=e(95089),M=e(42075),w=e(28036),I=e(67294),c=e(89035),b=e(82346),v=e(85893);function l(B){var re=(0,I.useState)(!1),g=U()(re,2),O=g[0],A=g[1],de=(0,I.useRef)();return(0,v.jsx)(x.Z,{ghost:!0,children:(0,v.jsxs)(M.Z.Compact,{children:[(0,v.jsx)(C.Z,{width:"sm",name:"entryCmd",placeholder:"\u5207\u6362 shell \u73AF\u5883",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,v.jsx)(N.Y,{modalProps:{width:D.ob,height:D.Ed},title:"\u6279\u91CF\u6267\u884C\u811A\u672C",name:"batchCommand",open:O,trigger:(0,v.jsx)(w.ZP,{children:"\u6279\u91CF\u6267\u884C\u811A\u672C"}),formKey:"batchCommand",formRef:de,isKeyPressSubmit:!0,onFinish:function(){var ne=d()(r()().mark(function ae(Q){return r()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:B.onBatchCommandFinish&&B.onBatchCommandFinish(Q.shell.split(`
`)),A(!1);case 2:case"end":return ue.stop()}},ae)}));return function(ae){return ne.apply(this,arguments)}}(),onOpenChange:function(ae){A(ae),ae&&de.current&&de.current.resetFields()},children:(0,v.jsx)(m.Z,{name:"shell",children:(0,v.jsx)(j.ZP,{theme:"dark",height:D.Ed})})}),(0,v.jsx)(m.Z,{children:(0,v.jsx)(a.Z,{name:["entryCmd"],children:function(ae){var Q=ae.entryCmd;return(!Q||Q=="")&&(Q="/bin/sh"),B.onOpenNewWindow&&(0,v.jsx)(b.Link,{onClick:function(){B.onOpenNewWindowFinish&&B.onOpenNewWindowFinish()},target:"_blank",to:B.onOpenNewWindow({cmd:Q}),children:(0,v.jsx)(w.ZP,{type:"dashed",icon:(0,v.jsx)(c.Z,{}),children:"\u65B0\u7A97\u53E3\u6253\u5F00"})})}})})]})})}},49610:function(ce,K,e){var S=e(5574),r=e.n(S),L=e(67294),d=e(54964),R=e(52626),U=e(12320),D=e.n(U),x=e(78267),C=e.n(x),N=e(85893),m,a=new U.Terminal(d.a),j=new x.FitAddon,M,w=(0,L.forwardRef)(function(I,c){var b,v=(0,L.useState)(),l=r()(v,2),B=l[0],re=l[1],g=(0,L.useState)(""),O=r()(g,2),A=O[0],de=O[1];(0,L.useImperativeHandle)(c,function(){return{start:function(Q,f){ne(),f.width=a.cols,f.height=a.rows;var ue=f?Object.keys(f).filter(function(Z){return f&&f[Z]}).map(function(Z){if(f&&f[Z])return"".concat(Z,"=").concat(f[Z])}):[];m=new WebSocket((0,R.R)(Q+"?"+ue.join("&"))),m.addEventListener("message",function(Z){var o=JSON.parse(Z.data),$=o.type;if($==Q&&(a.write(o.data),o.data.indexOf("exec failed")!=-1)){ne();return}}),M=a.onData(function(Z){var o={content:{command:Z},type:Q};m&&m.send(JSON.stringify(o))}),de(Q),re(f)},close:function(){ne()},fit:function(){return j.fit(),{width:a.cols,height:a.rows}},run:function(Q){B&&Q&&Q.forEach(function(f){var ue={content:{command:f+`
`},type:A};m&&m.send(JSON.stringify(ue))})}}}),(0,L.useEffect)(function(){return a.loadAddon(j),a.open(document.getElementById("terminal-container-console")),j.fit(),function(){ne()}},[]),(0,L.useEffect)(function(){window.addEventListener("resize",function(){j.fit();var ae={size:{width:a.cols,height:a.rows},type:A};A&&m&&m.send(JSON.stringify(ae))})},[A]);function ne(){a.reset(),j.fit(),a.focus(),M&&M.dispose(),m&&(m.close(),m=null)}return(0,N.jsx)("div",{style:{height:(b=I.height)!==null&&b!==void 0?b:"100vh"},id:"terminal-container-console"})});K.Z=w},81366:function(ce,K,e){var S=e(19632),r=e.n(S),L=e(5574),d=e.n(L),R=e(27254),U=e(42075),D=e(28036),x=e(25593),C=e(67294),N=e(31112),m=e(85893),a={title:"ROOT",path:"/"},j=(0,C.forwardRef)(function(M,w){var I=(0,C.useContext)(N.Z),c=I.showPath,b=(0,C.useState)([a]),v=d()(b,2),l=v[0],B=v[1];(0,C.useImperativeHandle)(w,function(){return{addHistory:function(O,A){A=="/"?B([a]):B([].concat(r()(l),[{title:O,path:A}]))},initHistory:function(O){B([a].concat(r()(O)))}}});var re=function(O){c?c(l[O].title,l[O].path):M.showPath&&M.showPath(l[O].title,l[O].path);var A=l.filter(function(de,ne){return ne<=O});B(r()(A))};return(0,m.jsxs)(U.Z,{children:[(0,m.jsx)(U.Z.Compact,{children:l.map(function(g,O){return(0,m.jsx)(D.ZP,{icon:(0,m.jsx)(R.Z,{}),type:"dashed",onClick:function(){re(O)},children:g.title},O)})}),l.length>=2&&(0,m.jsx)(x.Z.Text,{copyable:{text:l[l.length-1].path}})]})});K.Z=j},31112:function(ce,K,e){var S=e(67294),r=(0,S.createContext)({});K.Z=r},4459:function(ce,K,e){e.d(K,{Z:function(){return an}});var S=e(15009),r=e.n(S),L=e(99289),d=e.n(L),R=e(5574),U=e.n(R),D=e(82346);function x(t,i){return C.apply(this,arguments)}function C(){return C=d()(r()().mark(function t(i,_){var E;return r()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return E="/api/".concat(i,"/explorer/get-path-list"),H.next=3,(0,D.request)(E,{data:_,method:"POST"});case 3:return H.abrupt("return",H.sent);case 4:case"end":return H.stop()}},t)})),C.apply(this,arguments)}function N(t,i){return m.apply(this,arguments)}function m(){return m=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/export"),{data:_,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),m.apply(this,arguments)}function a(t,i){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function t(i,_){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return _.enableExportHost=!0,n.next=3,request("/api/".concat(i,"/explorer/export"),{data:_,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},t)})),j.apply(this,arguments)}function M(t,i){return w.apply(this,arguments)}function w(){return w=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/import"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),w.apply(this,arguments)}function I(t,i){return c.apply(this,arguments)}function c(){return c=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/delete"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),c.apply(this,arguments)}function b(t,i){return v.apply(this,arguments)}function v(){return v=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/unzip"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),v.apply(this,arguments)}function l(t,i){return B.apply(this,arguments)}function B(){return B=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/get-content"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),B.apply(this,arguments)}function re(t,i){return g.apply(this,arguments)}function g(){return g=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/import-file-content"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),g.apply(this,arguments)}function O(t,i){return A.apply(this,arguments)}function A(){return A=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/mkdir"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),A.apply(this,arguments)}function de(t,i){return ne.apply(this,arguments)}function ne(){return ne=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/chmod"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),ne.apply(this,arguments)}function ae(t,i){return Q.apply(this,arguments)}function Q(){return Q=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/get-user-list"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),Q.apply(this,arguments)}function f(t,i){return ue.apply(this,arguments)}function ue(){return ue=d()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,D.request)("/api/".concat(i,"/explorer/get-file-stat"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),ue.apply(this,arguments)}var Z=e(41482),o=e(67294),$=e(31112),le=e(51042),Te=e(48689),oe=e(42075),je=e(28036),Re=e(80821),Ae=e(88484),Be=e(37476),We=e(91604),Le=e(97961),ge=e(3616),s=e(85893);function Ue(){var t=(0,o.useRef)(),i=(0,o.useContext)($.Z),_=i.refresh,E=i.name,n=i.apiPrefix,H=i.currentPath;return(0,s.jsx)(Be.Y,{modalProps:{width:ge.ob},formRef:t,trigger:(0,s.jsx)(je.ZP,{icon:(0,s.jsx)(Ae.Z,{}),children:"\u4E0A\u4F20"}),title:"\u4E0A\u4F20\u6587\u4EF6\u5230\u5BB9\u5668",onFinish:function(){var V=d()(r()().mark(function te(G){var se,X;return r()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return X=[],G.importFileList&&G.importFileList.map(function(q){X.push({name:q.name,path:q.response.data.path})}),M(n,{fileList:X,name:E,destPath:H}),(se=t.current)===null||se===void 0||se.resetFields(),_(),ie.abrupt("return",!0);case 6:case"end":return ie.stop()}},te)}));return function(te){return V.apply(this,arguments)}}(),children:(0,s.jsx)(We.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(te){return new Promise(function(G){var se;(0,Le._2)({path:(se=te.response.data.path)!==null&&se!==void 0?se:""}).then(function(X){G(!0)})})}}})})}var we=e(23430),Ie=e(93162),Oe=e(24963);function Ze(t){var i=(0,o.useContext)($.Z),_=i.name,E=i.apiPrefix,n=(0,o.useContext)(Oe.Z),H=n.message;return(0,s.jsx)(Re.Z,{action:function(){return!t.selectFileList||t.selectFileList.length==0?(H.info("\u8BF7\u9009\u62E9\u8981\u4E0B\u8F7D\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):N(E,{name:_,fileList:t.selectFileList})},onSuccess:function(te){var G=new Blob([te],{type:"application/zip"});(0,Ie.saveAs)(G,"export.zip")},icon:(0,s.jsx)(we.Z,{}),children:"\u4E0B\u8F7D"})}var De=e(38345),fe=e(63434),Ke=e(24739),Ce=e(5966);function Se(t){var i=(0,o.useContext)(Oe.Z),_=i.notice,E=(0,o.useRef)(),n=(0,o.useContext)($.Z),H=n.currentPath,V=n.refresh,te=n.name,G=n.apiPrefix,se=(0,o.useState)(!1),X=U()(se,2),_e=X[0],ie=X[1],q=function(F){var P=F.split(""),W=0,y=0,T=0;return P[1]=="r"&&(W+=4),P[2]=="w"&&(W+=2),P[3]=="x"&&(W+=1),P[4]=="r"&&(y+=4),P[5]=="w"&&(y+=2),P[6]=="x"&&(y+=1),P[7]=="r"&&(T+=4),P[8]=="w"&&(T+=2),P[9]=="x"&&(T+=1),"".concat(W).concat(y).concat(T)},Ee=function(F){var P;if((P=E.current)===null||P===void 0||P.setFieldValue("permission",F),F.length>=1){var W;(W=E.current)===null||W===void 0||W.setFieldsValue({ownerRead:Number(F[0])&4,ownerWrite:Number(F[0])&2,ownerExec:Number(F[0])&1})}if(F.length>=2){var y;(y=E.current)===null||y===void 0||y.setFieldsValue({groupRead:Number(F[1])&4,groupWrite:Number(F[1])&2,groupExec:Number(F[1])&1})}if(F.length>=3){var T;(T=E.current)===null||T===void 0||T.setFieldsValue({everyoneRead:Number(F[2])&4,everyoneWrite:Number(F[2])&2,everyoneExec:Number(F[2])&1})}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(je.ZP,{onClick:d()(r()().mark(function me(){var F;return r()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!(!t.selectFileObject||t.selectFileObject.length==0)){W.next=7;break}return(F=E.current)===null||F===void 0||F.resetFields(),_.error("\u8BF7\u5148\u9009\u62E9\u8981\u4FEE\u6539\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),ie(!1),W.abrupt("return",!1);case 7:ie(!0);case 8:case"end":return W.stop()}},me)})),children:"\u6743\u9650"}),(0,s.jsxs)(Be.Y,{modalProps:{forceRender:!0,width:ge.ob},title:t.selectFileObject.length==1?"\u4FEE\u6539 ".concat(t.selectFileObject[0].name," \u6743\u9650"):"\u6279\u91CF\u6587\u4EF6\u4FEE\u6539\u6743\u9650",layout:"horizontal",open:_e,onOpenChange:function(F){ie(F),t.selectFileObject.length==1&&Ee(q(t.selectFileObject[0].modStr))},formRef:E,onValuesChange:function(F,P){if(F.permission)Ee(F.permission);else{var W=["-",P.ownerRead?"r":"-",P.ownerWrite?"w":"-",P.ownerExec?"x":"-",P.groupRead?"r":"-",P.groupWrite?"w":"-",P.groupExec?"x":"-",P.everyoneRead?"r":"-",P.everyoneWrite?"w":"-",P.everyoneExec?"x":"-"];Ee(q(W.join("")))}},onFinish:function(){var me=d()(r()().mark(function F(P){var W,y,T,he;return r()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return T=[],t.selectFileObject.map(function(u){T.push(u.path)}),h.next=4,de(G,{name:te,fileList:T,mod:(W=P.permission)!==null&&W!==void 0?W:"600",hasChildren:(y=P.hasChildren)!==null&&y!==void 0?y:!0,user:P.user});case 4:return he=h.sent,V(),h.abrupt("return",!0);case 7:case"end":return h.stop()}},F)}));return function(F){return me.apply(this,arguments)}}(),children:[(0,s.jsxs)(De.Z,{direction:"row",gutter:[20,10],children:[(0,s.jsxs)(De.Z,{bordered:!0,title:"\u6240\u6709\u8005",headerBordered:!0,children:[(0,s.jsx)(fe.Z,{label:"\u8BFB\u53D6",name:"ownerRead"}),(0,s.jsx)(fe.Z,{label:"\u5199\u5165",name:"ownerWrite"}),(0,s.jsx)(fe.Z,{label:"\u6267\u884C",name:"ownerExec"})]}),(0,s.jsxs)(De.Z,{bordered:!0,title:"\u7528\u6237\u7EC4",headerBordered:!0,children:[(0,s.jsx)(fe.Z,{label:"\u8BFB\u53D6",name:"groupRead"}),(0,s.jsx)(fe.Z,{label:"\u5199\u5165",name:"groupWrite"}),(0,s.jsx)(fe.Z,{label:"\u6267\u884C",name:"groupExec"})]}),(0,s.jsxs)(De.Z,{bordered:!0,title:"\u516C\u5171",headerBordered:!0,children:[(0,s.jsx)(fe.Z,{label:"\u8BFB\u53D6",name:"everyoneRead"}),(0,s.jsx)(fe.Z,{label:"\u5199\u5165",name:"everyoneWrite"}),(0,s.jsx)(fe.Z,{label:"\u6267\u884C",name:"everyoneExec"})]})]}),(0,s.jsx)(De.Z,{children:(0,s.jsxs)(Ke.UW,{children:[(0,s.jsx)(Ce.Z,{label:"\u6743\u9650",name:"permission",fieldProps:{maxLength:3},width:"xs"}),(0,s.jsxs)(oe.Z.Compact,{children:[(0,s.jsx)(Ce.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237",label:"\u6240\u6709\u8005",name:"user",fieldProps:{addonAfter:":"}}),(0,s.jsx)(Ce.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237\u7EC4",name:"group"})]}),(0,s.jsx)(fe.Z,{label:"\u5E94\u7528\u5230\u5B50\u76EE\u5F55",name:"hasChildren",initialValue:!0})]})})]})]})}var Ne=e(27461);function $e(t){var i=(0,o.useContext)($.Z),_=i.currentPath,E=i.refresh,n=i.name,H=i.apiPrefix,V=(0,o.useContext)(Oe.Z),te=V.notice;return(0,s.jsx)(Re.Z,{icon:(0,s.jsx)(Ne.Z,{}),action:d()(r()().mark(function G(){return r()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(t.selectFileObject.length!=0){X.next=3;break}return te.error("\u8BF7\u5148\u9009\u62E9\u8981\u89E3\u538B\u7684 .zip .tar .tar.gz \u6587\u4EF6"),X.abrupt("return",!1);case 3:return X.abrupt("return",b(H,{name:n,file:t.selectFileObject.map(function(_e){return _e.path}),path:_}));case 4:case"end":return X.stop()}},G)})),onSuccess:function(){E()},children:"\u89E3\u538B"})}function sn(t){var i=useContext(FileExplorerContext),_=i.name,E=i.apiPrefix,n=useContext(AppContext),H=n.message,V=useRef();return _jsx(RequestButton,{confirm:_jsx(Space,{children:_jsx(ProForm,{layout:"inline",submitter:!1,formRef:V,children:_jsx(ProFormText,{width:"md",label:"\u5BFC\u51FA\u5230\u4E3B\u673A\u76EE\u5F55",name:"hostPath"})})}),action:function(){var G;return!t.selectFileList||t.selectFileList.length==0?(H.info("\u8BF7\u9009\u62E9\u8981\u5BFC\u51FA\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):exportFileList(E,{name:_,hostPath:(G=V.current)===null||G===void 0?void 0:G.getFieldValue("hostPath"),enableExportHost:!0,fileList:t.selectFileList})},icon:_jsx(ExportOutlined,{}),children:"\u5BFC\u51FA\u5230\u4E3B\u673A"})}function ze(t){var i=(0,o.useContext)($.Z),_=i.refresh,E=i.name,n=i.apiPrefix,H=i.currentPath,V=i.newFile;return(0,s.jsxs)(oe.Z,{size:16,wrap:!0,children:[(0,s.jsx)(Ze,{selectFileList:t.selectFileList}),!1,(0,s.jsx)(Ue,{}),(0,s.jsx)(Se,{selectFileObject:t.selectFileObject}),(0,s.jsx)($e,{selectFileObject:t.selectFileObject}),(0,s.jsx)(je.ZP,{icon:(0,s.jsx)(le.Z,{}),onClick:function(){V()},type:"primary",children:"\u65B0\u5EFA"}),(0,s.jsx)(Re.Z,{danger:!0,type:"default",icon:(0,s.jsx)(Te.Z,{}),action:function(){return I(n,{name:E,fileList:t.selectFileList})},onSuccess:function(){_()},confirm:"notification.confirm.title",children:"\u5220\u9664"})]})}var xe=e(83062),Me=e(66309);function ke(t){return t.change==0?(0,s.jsx)(xe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u4FEE\u6539",children:(0,s.jsx)(Me.Z,{color:"blue",children:"MODIFIED"})}):t.change==1?(0,s.jsx)(xe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u65B0\u589E\u7684\u6587\u4EF6",children:(0,s.jsx)(Me.Z,{color:"green",children:"ADD"})}):t.change==2?(0,s.jsx)(xe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u5220\u9664\u6587\u4EF6",children:(0,s.jsx)(Me.Z,{color:"error",children:"DELETED"})}):t.change==100?(0,s.jsx)(xe.Z,{title:"\u6302\u8F7D\u7684\u6301\u4E45\u5316\u76EE\u5F55",children:(0,s.jsx)(Me.Z,{color:"cyan",children:"VOLUME"})}):(0,s.jsx)(s.Fragment,{})}var He=e(81366),Ve=e(97269),Ge=e(86615),Je=e(97462),Ye=e(62370),Qe=e(85576),Xe=e(95089),be=e(5251),qe=(0,o.forwardRef)(function(t,i){var _,E,n,H=(0,o.useContext)(Oe.Z),V=H.message,te=H.notice,G=(0,o.useContext)($.Z),se=G.currentPath,X=G.refresh,_e=G.name,ie=G.apiPrefix,q=(0,o.useRef)(),Ee=(0,o.useState)(!1),me=U()(Ee,2),F=me[0],P=me[1];return(0,o.useImperativeHandle)(i,function(){return{newFile:function(){var y,T;P(!0),(y=q.current)===null||y===void 0||y.resetFields(),(T=q.current)===null||T===void 0||T.setFieldValue("type","newFile")},editFile:function(y,T,he){return d()(r()().mark(function p(){var h,u,z,k,J;return r()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return(h=q.current)===null||h===void 0||h.resetFields(),V.loading("\u6B63\u5728\u83B7\u53D6\u6587\u4EF6\u5185\u5BB9"),Y.next=4,l(ie,{name:_e,file:T}).finally(function(){V.destroy()});case 4:if(J=Y.sent,!(J.data.content==""&&he!="0")){Y.next=9;break}return V.error("\u4E0D\u652F\u6301\u7F16\u8F91\u7684\u6587\u4EF6\u7C7B\u578B"),P(!1),Y.abrupt("return");case 9:return(u=q.current)===null||u===void 0||u.setFieldValue("newValue",J.data.content),(z=q.current)===null||z===void 0||z.setFieldValue("newName",y),(k=q.current)===null||k===void 0||k.setFieldValue("type","editFile"),P(!0),Y.abrupt("return");case 14:case"end":return Y.stop()}},p)}))()}}}),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(Qe.Z,{width:ge.ob,title:(_=q.current)!==null&&_!==void 0&&_.getFieldValue("newName")?"\u7F16\u8F91\u6587\u4EF6":"\u65B0\u5EFA\u6587\u4EF6",open:F,onCancel:function(){var y;P(!1),(y=q.current)===null||y===void 0||y.resetFields()},footer:!1,forceRender:!0,children:(0,s.jsxs)(Ve.A,{formRef:q,onFinish:function(){var W=d()(r()().mark(function y(T){return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(T.type!="newDir"){p.next=13;break}return p.prev=1,p.next=4,O(ie,{name:_e,destPath:"".concat(se,"/").concat((0,be.fi)(T.newPath,"/"))});case 4:return X(),P(!1),p.abrupt("return",!0);case 9:p.prev=9,p.t0=p.catch(1);case 11:p.next=23;break;case 13:return p.prev=13,p.next=16,re(ie,{destPath:se,file:T.newName,content:T.newValue,name:_e});case 16:return X(),P(!1),p.abrupt("return",!0);case 21:p.prev=21,p.t1=p.catch(13);case 23:return p.abrupt("return",!1);case 24:case"end":return p.stop()}},y,null,[[1,9],[13,21]])}));return function(y){return W.apply(this,arguments)}}(),children:[(0,s.jsx)(Ge.Z.Group,{name:"type",options:[{label:"\u7F16\u8F91\u6587\u4EF6",value:"editFile",disabled:((E=q.current)===null||E===void 0?void 0:E.getFieldValue("type"))!="editFile"},{label:"\u65B0\u5EFA\u6587\u4EF6",value:"newFile"},{label:"\u65B0\u5EFA\u76EE\u5F55",value:"newDir"}],disabled:((n=q.current)===null||n===void 0?void 0:n.getFieldValue("type"))=="editFile"}),(0,s.jsx)(Je.Z,{name:["type"],children:function(y){var T=y.type;return T!="newDir"?[(0,s.jsx)(Ce.Z,{label:"\u6587\u4EF6\u540D",tooltip:"\u7F16\u8F91\u6587\u4EF6\u65F6\u4FEE\u6539\u6587\u4EF6\u540D\u53EF\u5B9E\u73B0\u590D\u5236\u529F\u80FD",name:"newName",fieldProps:{addonBefore:"".concat(se,"/")},placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D",disabled:T=="editFile"},"fileName"),(0,s.jsx)(Ye.Z,{label:"\u5185\u5BB9",name:"newValue",children:(0,s.jsx)(Xe.ZP,{theme:"dark",height:ge.Ed,onChange:function(p){var h;(h=q.current)===null||h===void 0||h.setFieldValue("newValue",p)}})},"fileContent")]:(0,s.jsx)(Ce.Z,{name:"newPath",label:"\u76EE\u5F55\u540D",placeholder:"\u8F93\u5165\u76EE\u5F55\u540D\u79F0\uFF0C\u652F\u6301\u591A\u7EA7"})}})]})})})}),en=qe,nn=e(99922),ye=e(68536),tn=e(87662),un=null;function rn(t){var i=(0,o.useRef)(),_=(0,o.useRef)(),E=(0,o.useRef)(),n=(0,o.useState)(""),H=U()(n,2),V=H[0],te=H[1],G=(0,o.useRef)(),se=(0,D.useSearchParams)(),X=U()(se,2),_e=X[0],ie=X[1],q=(0,o.useState)(),Ee=U()(q,2),me=Ee[0],F=Ee[1],P=(0,o.useContext)(Oe.Z),W=P.lang,y=P.message,T=t.apiPrefix=="host"?"common":"app";(0,o.useEffect)(function(){var p=_e.get("path");if(p){for(var h,u=p.split("/"),z=[],k="",J=1;J<u.length;J++)k+="/"+u[J],z.push({title:u[J],path:k});he(u[u.length-1],p),(h=i.current)===null||h===void 0||h.initHistory([].concat(z))}(0,tn.K3)().then(function(ve){!ve.data.enableSSH&&y.info(W("app.detail.createExplorerPlugin"))})},[t.name,_e]);var he=function(h,u){var z,k;if((z=i.current)===null||z===void 0||z.addHistory(h,u),te(u),E.current&&(k=E.current)!==null&&k!==void 0&&k.reloadAndRest){var J;(J=E.current)===null||J===void 0||J.reloadAndRest()}u=="/"?ie([]):(_e.set("path",u),ie(_e))};return(0,s.jsxs)($.Z.Provider,{value:{apiPrefix:T,name:t.name,currentPath:V,showPath:he,refresh:function(){var h;if(E&&typeof((h=E.current)===null||h===void 0?void 0:h.reloadAndRest)=="function"){var u;(u=E.current)===null||u===void 0||u.reloadAndRest()}},editFile:function(h,u,z){_.current&&_.current.editFile(h,u,z)},newFile:function(){_.current&&_.current.newFile()}},children:[(0,s.jsx)(Z.Z,{scroll:{x:"max-content"},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},toolBarRender:function(){var h=[];return t.onConsole&&h.push((0,s.jsx)(je.ZP,{type:"dashed",onClick:function(){t.onConsole&&t.onConsole(V)},children:"Console"},"fileConsole")),[].concat(h)},tableAlertOptionRender:function(h){var u=h.selectedRowKeys,z=h.selectedRows,k=[];return z.map(function(J){k.push(J.path)}),[(0,s.jsx)(ze,{selectFileList:k,selectFileObject:z,enableExportHost:t.apiPrefix=="container"},"1")]},headerTitle:(0,s.jsx)(He.Z,{ref:i}),actionRef:E,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:d()(r()().mark(function p(){var h,u,z,k,J;return r()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.next=2,x(T,{name:t.name,path:V});case 2:if(h=Y.sent,V==""&&h.data.currentPath!=""&&(z=[],te(h.data.currentPath),(u=i.current)===null||u===void 0||u.initHistory(h.data.currentPath.split("/").filter(function(ee){return ee!=""}).map(function(ee){return z.push(ee),{title:ee,path:"/".concat(z.join("/"))}}))),k=me,k){Y.next=11;break}return Y.next=8,ae(T,{name:t.name});case 8:J=Y.sent,F(J.data),k=J.data;case 11:return Y.abrupt("return",{data:h.data.list.map(function(ee){if(k){var pe,Fe;ee.group=(pe=(Fe=k.group.find(function(Pe){return Pe.gid==ee.group}))===null||Fe===void 0?void 0:Fe.name)!==null&&pe!==void 0?pe:ee.group}return ee}),success:!0,total:h.data.list.length});case 12:case"end":return Y.stop()}},p)})),columns:[{title:"\u540D\u79F0",dataIndex:"name",key:"name",render:function(ve,u,z,k,J){var ve;return u.isDir?ve=(0,s.jsx)(ye.Z,{isDir:!0,onClick:function(){return he(u.name,u.path)},showName:u.name}):u.isSymlink?ve=(0,s.jsx)(ye.Z,{isLink:!0,showName:"".concat(u.name," -> ").concat(u.linkName),onClick:d()(r()().mark(function Y(){var ee,pe;return r()().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return Pe.next=2,f(T,{name:t.name,path:u.path});case 2:ee=Pe.sent,ee.data.info.isDir?he(u.name,ee.data.info.target):(pe=_.current)===null||pe===void 0||pe.editFile(ee.data.info.name,ee.data.info.target,u.size);case 4:case"end":return Pe.stop()}},Y)}))}):ve=(0,s.jsx)(ye.Z,{showName:u.name,onClick:function(){var ee;(ee=_.current)===null||ee===void 0||ee.editFile(u.name,u.path,u.size)}}),ve}},{title:"\u72B6\u6001",key:"status",width:110,render:function(h,u,z,k,J){return(0,s.jsx)(ke,{change:u.change})}},{title:"\u6743\u9650",dataIndex:"modStr",key:"mod"},{title:"\u7528\u6237",dataIndex:"user"},{title:"\u7528\u6237\u7EC4",dataIndex:"group"},{title:"\u5927\u5C0F",dataIndex:"size",key:"size",render:function(h,u,z,k,J){return(0,be.FI)(u.size)}},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"modTime",key:"modTime",sorter:function(h,u){return new Date(h.modTime).getTime()-new Date(u.modTime).getTime()},render:function(h,u,z,k,J){return(0,be.NF)(u.modTime)}}],cardProps:{ghost:!0}}),(0,s.jsx)(en,{ref:_}),(0,s.jsx)(nn.Z,{ref:G})]})}var an=rn},68536:function(ce,K,e){e.d(K,{Z:function(){return N}});var S=e(24963),r=e(93613),L=e(36693),d=e(2741),R=e(25593),U=e(42075),D=e(67294),x=e(85893),C=0;function N(m){var a=(0,D.useContext)(S.Z),j=a.message;return m.isDir?(0,x.jsx)(R.Z.Link,{onClick:function(){m.onClick&&m.onClick()},children:(0,x.jsxs)(U.Z,{children:[(0,x.jsx)(r.Z,{}),m.showName]})}):m.isLink?(0,x.jsx)(R.Z.Link,{onClick:function(){m.onClick&&m.onClick()},children:(0,x.jsxs)(U.Z,{children:[(0,x.jsx)(L.Z,{}),m.showName]})}):(0,x.jsx)(R.Z.Text,{onClick:function(){if(C++,C==2){C=0,m.onClick&&m.onClick();return}setTimeout(function(){C==1&&j.info("\u53CC\u51FB\u67E5\u770B\u6587\u4EF6\u5185\u5BB9"),C=0},400)},style:{cursor:"pointer"},children:(0,x.jsxs)(U.Z,{children:[(0,x.jsx)(d.Z,{}),m.showName]})})}},54964:function(ce,K,e){e.d(K,{a:function(){return a}});var S=e(5574),r=e.n(S),L=e(78267),d=e.n(L),R=e(75458),U=e.n(R),D=e(67294),x=e(12320),C=e.n(x),N=e(89629),m=e(85893),a={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},j=new x.Terminal(a),M=new R.SearchAddon,w=new L.FitAddon,I=(0,D.forwardRef)(function(c,b){var v,l=(0,D.useState)(!0),B=r()(l,2),re=B[0],g=B[1];return(0,D.useEffect)(function(){return window.addEventListener("resize",function(){c.showInModal||w.fit()}),c.style&&c.style.fontSize&&(j.options.fontSize=c.style.fontSize),j.loadAddon(w),j.loadAddon(M),j.open(document.getElementById(c.id?c.id:"terminal-container")),c.showInModal||w.fit(),function(){j.reset(),g(!0)}},[]),(0,D.useImperativeHandle)(b,function(){return{write:function(A){re&&(w.fit(),g(!1)),j.write(A)},clear:function(){j.clear()},getTerminal:function(){return j},findNext:function(A){M.findNext(A)},findPrev:function(A){M.findPrevious(A)},fit:function(){w.fit()},onData:function(A){return j.onData(A)}}}),(0,m.jsx)("div",{id:c.id?c.id:"terminal-container",style:{width:c.width?c.width:"100%",height:c.height?c.height:"500px",marginTop:(v=c.style)===null||v===void 0?void 0:v.marginTop}})});K.Z=I},3616:function(ce,K,e){e.d(K,{Ed:function(){return d},FK:function(){return r},R_:function(){return S},ob:function(){return L}});var S=window.innerWidth<=1024?"90vw":"65vw",r="90vw",L="60vw",d="50vh"},24963:function(ce,K,e){var S=e(67294),r=(0,S.createContext)({});K.Z=r},97961:function(ce,K,e){e.d(K,{GH:function(){return m},MF:function(){return w},_2:function(){return j},fN:function(){return D},ii:function(){return U},vC:function(){return C}});var S=e(15009),r=e.n(S),L=e(99289),d=e.n(L),R=e(82346),U=[{name:"amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"i386",arch:"386",search:[]},{name:"arm/v6",arch:"arm",search:[]},{name:"arm/v7",arch:"arm",search:[]},{name:"arm/v8",arch:"arm64",search:[]},{name:"ppc64le",arch:"ppc64le",search:[]},{name:"riscv64",arch:"riscv64",search:[]}];function D(c){return x.apply(this,arguments)}function x(){return x=d()(r()().mark(function c(b){return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,R.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:b}));case 1:case"end":return l.stop()}},c)})),x.apply(this,arguments)}function C(c){return N.apply(this,arguments)}function N(){return N=d()(r()().mark(function c(b){return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,R.request)("/api/app/image/import-by-container-tar",{method:"POST",data:b}));case 1:case"end":return l.stop()}},c)})),N.apply(this,arguments)}function m(c){return a.apply(this,arguments)}function a(){return a=d()(r()().mark(function c(b){return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,R.request)("/api/app/image/import-by-image-tar",{method:"POST",data:b}));case 1:case"end":return l.stop()}},c)})),a.apply(this,arguments)}function j(c){return M.apply(this,arguments)}function M(){return M=d()(r()().mark(function c(b){return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,R.request)("/api/common/attach/delete",{method:"POST",data:b});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},c)})),M.apply(this,arguments)}function w(){return I.apply(this,arguments)}function I(){return I=d()(r()().mark(function c(){return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,R.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return v.stop()}},c)})),I.apply(this,arguments)}}}]);
