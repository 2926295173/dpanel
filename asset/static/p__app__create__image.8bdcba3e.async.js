"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{23430:function(ve,V,t){t.d(V,{Z:function(){return p}});var x=t(87462),E=t(67294),z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},T=z,N=t(84089),A=function(Z,i){return E.createElement(N.Z,(0,x.Z)({},Z,{ref:i,icon:T}))},I=E.forwardRef(A),p=I},64789:function(ve,V,t){t.d(V,{Z:function(){return p}});var x=t(87462),E=t(67294),z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},T=z,N=t(84089),A=function(Z,i){return E.createElement(N.Z,(0,x.Z)({},Z,{ref:i,icon:T}))},I=E.forwardRef(A),p=I},63434:function(ve,V,t){var x=t(1413),E=t(45987),z=t(22270),T=t(84567),N=t(67294),A=t(90789),I=t(34692),p=t(85893),F=["options","fieldProps","proFieldProps","valueEnum"],Z=N.forwardRef(function(a,b){var r=a.options,l=a.fieldProps,Q=a.proFieldProps,$=a.valueEnum,J=(0,E.Z)(a,F);return(0,p.jsx)(I.Z,(0,x.Z)({ref:b,valueType:"checkbox",valueEnum:(0,z.h)($,void 0),fieldProps:(0,x.Z)({options:r},l),lightProps:(0,x.Z)({labelFormatter:function(){return(0,p.jsx)(I.Z,(0,x.Z)({ref:b,valueType:"checkbox",mode:"read",valueEnum:(0,z.h)($,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,x.Z)({options:r},l),proFieldProps:Q},J))}},J.lightProps),proFieldProps:Q},J))}),i=N.forwardRef(function(a,b){var r=a.fieldProps,l=a.children;return(0,p.jsx)(T.Z,(0,x.Z)((0,x.Z)({ref:b},r),{},{children:l}))}),P=(0,A.G)(i,{valuePropName:"checked"}),Y=P;Y.Group=Z,V.Z=Y},31199:function(ve,V,t){var x=t(1413),E=t(45987),z=t(67294),T=t(34692),N=t(85893),A=["fieldProps","min","proFieldProps","max"],I=function(Z,i){var P=Z.fieldProps,Y=Z.min,a=Z.proFieldProps,b=Z.max,r=(0,E.Z)(Z,A);return(0,N.jsx)(T.Z,(0,x.Z)({valueType:"digit",fieldProps:(0,x.Z)({min:Y,max:b},P),ref:i,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:a},r))},p=z.forwardRef(I);V.Z=p},86615:function(ve,V,t){var x=t(1413),E=t(45987),z=t(22270),T=t(78045),N=t(67294),A=t(90789),I=t(34692),p=t(85893),F=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],Z=N.forwardRef(function(a,b){var r=a.fieldProps,l=a.options,Q=a.radioType,$=a.layout,J=a.proFieldProps,k=a.valueEnum,ue=(0,E.Z)(a,F);return(0,p.jsx)(I.Z,(0,x.Z)((0,x.Z)({valueType:Q==="button"?"radioButton":"radio",ref:b,valueEnum:(0,z.h)(k,void 0)},ue),{},{fieldProps:(0,x.Z)({options:l,layout:$},r),proFieldProps:J,filedConfig:{customLightMode:!0}}))}),i=N.forwardRef(function(a,b){var r=a.fieldProps,l=a.children;return(0,p.jsx)(T.ZP,(0,x.Z)((0,x.Z)({},r),{},{ref:b,children:l}))}),P=(0,A.G)(i,{valuePropName:"checked",ignoreWidth:!0}),Y=P;Y.Group=Z,Y.Button=T.ZP.Button,Y.displayName="ProFormComponent",V.Z=Y},99861:function(ve,V,t){var x=t(15009),E=t.n(x),z=t(64599),T=t.n(z),N=t(99289),A=t.n(N),I=t(5574),p=t.n(I),F=t(42119),Z=t(67294),i=t(92754),P=t(3393),Y=t(184),a=t(38345),b=t(85893),r=(0,Z.forwardRef)(function(l,Q){(0,Z.useImperativeHandle)(Q,function(){return{start:function(){xe(!0)}}});var $=(0,Z.useState)(0),J=p()($,2),k=J[0],ue=J[1],w=(0,Z.useRef)(),me=(0,Z.useState)(!1),fe=p()(me,2),Be=fe[0],xe=fe[1];return(0,b.jsxs)(Y.a,{trigger:l.trigger,width:800,open:Be,submitter:!1,title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",onOpenChange:function(){var he=A()(E()().mark(function Ee(ge){var U,_,K,q,H,se,pe;return E()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(xe(ge),!ge){S.next=26;break}_=0,K=T()(l.image),S.prev=4,K.s();case 6:if((q=K.n()).done){S.next=16;break}return se=q.value,ue(_),(H=w.current)===null||H===void 0||H.setStart(se),S.next=12,(0,P.Gb)({tag:se,type:"pull"});case 12:pe=S.sent,_++;case 14:S.next=6;break;case 16:S.next=21;break;case 18:S.prev=18,S.t0=S.catch(4),K.e(S.t0);case 21:return S.prev=21,K.f(),S.finish(21);case 24:(U=w.current)===null||U===void 0||U.setFinish(),ue(_);case 26:case"end":return S.stop()}},Ee,null,[[4,18,21,24]])}));return function(Ee){return he.apply(this,arguments)}}(),children:[(0,b.jsx)(a.Z,{children:(0,b.jsx)(F.Z,{current:k,items:l.image.map(function(he,Ee){return{title:he,key:Ee}})})}),(0,b.jsx)(a.Z,{children:(0,b.jsx)(i.Z,{ref:w})})]})});V.Z=r},91058:function(ve,V,t){var x=t(5574),E=t.n(x),z=t(89035),T=t(38345),N=t(17186),A=t(24739),I=t(5966),p=t(42075),F=t(14726),Z=t(85576),i=t(67294),P=t(95089),Y=t(89063),a=t(85893),b="docker-image",r=(0,i.forwardRef)(function(l,Q){var $=(0,i.useState)(b),J=E()($,2),k=J[0],ue=J[1],w=(0,i.useRef)(),me=(0,i.useState)(""),fe=E()(me,2),Be=fe[0],xe=fe[1],he=function(){k!="code"?ue("code"):ue(b)};(0,i.useImperativeHandle)(Q,function(){return{addEnvItem:function(_,K){var q,H=(q=w.current)===null||q===void 0?void 0:q.getList(),se=!1;if(H==null||H.map(function(Pe){if(Pe.name==_){se=!0;return}}),!se){var pe;(pe=w.current)===null||pe===void 0||pe.add({name:_,value:K})}},clear:function(){var _;(_=w.current)===null||_===void 0||(_=_.getList())===null||_===void 0||_.map(function(K,q){var H;(H=w.current)===null||H===void 0||H.remove(q)})}}});function Ee(U){try{var _,K;U==""&&(U=ge());for(var q=(_=(K=w.current)===null||K===void 0||(K=K.getList())===null||K===void 0?void 0:K.length)!==null&&_!==void 0?_:0,H=q;H>=0;H--){var se;(se=w.current)===null||se===void 0||se.remove(H)}var pe=U.split(`
`),Pe=0;pe.map(function(S){var Te,Ze=S.split("=");Ze.length<2||((Te=w.current)===null||Te===void 0||Te.add({name:Ze[0],value:Ze.slice(1).join("=")},Pe),Pe++)})}catch(S){console.log(S)}}function ge(){if(w&&w.current&&w.current.getList){var U,_=(U=w.current)===null||U===void 0?void 0:U.getList();if(_){var K=[];return _.map(function(q){K.push("".concat(q.name,"=").concat(q.value))}),K.join(`
`)}else return""}else return""}return(0,a.jsxs)(T.Z,{ghost:l.showCardGhost,title:l.label?l.label:null,headerBordered:!0,extra:(l.showCodeMode||l.showImportButton)&&(0,a.jsxs)(p.Z,{children:[l.showImportButton&&(0,a.jsx)("div",{style:{marginBottom:"-25px"},children:(0,a.jsx)(Y.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(_){return Ee(_),!0},onLoad:function(_){if(_.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),l.showCodeMode?(0,a.jsx)(F.ZP,{icon:(0,a.jsx)(z.Z,{}),type:k=="code"?"primary":"default",onClick:he,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,a.jsx)(N.u,{name:l.name?l.name:"environment",actionRef:w,creatorButtonProps:l.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,min:100,children:function(_,K,q){var H=q.getCurrentRowData();return(0,a.jsxs)(A.UW,{children:[(0,a.jsx)(I.Z,{width:l.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:l.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),(0,a.jsx)(I.Z,{width:l.showInDrawer?"sm":"md",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:!!l.requireValue}],disabled:l.showDisableValue,placeholder:H&&H.label?H.label:"\u8F93\u5165\u53D8\u91CF\u503C"})]})}}),(0,a.jsx)(Z.Z,{width:"800px",open:k=="code",onCancel:function(){return ue("docker-image")},onOk:function(){Ee(Be),ue("docker-image")},children:(0,a.jsx)(P.ZP,{onChange:function(_){return xe(_)},value:ge(),height:"680px",theme:"light"})})]})});V.Z=r},44349:function(ve,V,t){var x=t(97857),E=t.n(x),z=t(17186),T=t(5966),N=t(86250),A=t(67294),I=t(85893),p=(0,A.forwardRef)(function(F,Z){var i=(0,A.useRef)();(0,A.useImperativeHandle)(Z,function(){return{addItem:function(a,b){var r,l=(r=i.current)===null||r===void 0?void 0:r.getList(),Q=!1;if(l==null||l.map(function(J){if(J.name==a){Q=!0;return}}),!Q){var $;($=i.current)===null||$===void 0||$.add({name:a,value:b})}},clear:function(){var a;(a=i.current)===null||a===void 0||(a=a.getList())===null||a===void 0||a.map(function(b,r){var l;(l=i.current)===null||l===void 0||l.remove(r)})}}});var P={};return F.hideCopyButton===!0&&(P.copyIconProps=!1),F.hideDeleteButton===!0&&(P.deleteIconProps=!1),(0,I.jsx)(z.u,E()(E()({initialValue:F.initialValue,label:F.label,name:F.name,actionRef:i,creatorButtonProps:F.showAddButton?{creatorButtonText:"\u6DFB\u52A0"+(F.label?F.label:F.name)}:!1,min:F.min?F.min:0},P),{},{children:function(a,b,r){return(0,I.jsx)(N.Z,{justify:F.justify,gap:F.gap,children:F.items.map(function(l){return l.render?(0,I.jsx)("div",{children:l.render&&l.render(a,b,r)},"".concat(F.name,"-").concat(l.name,"-").concat(a.key)):(0,I.jsx)(T.Z,{width:l.width,name:l.name,label:l.label,required:l.required,rules:[{required:l.required}],disabled:l.disabled,placeholder:l.placeholder},"".concat(F.name,"-").concat(l.name,"-").concat(a.key))})})}}))});V.Z=p},89063:function(ve,V,t){t.d(V,{Z:function(){return p}});var x=t(24963),E=t(88484),z=t(62370),T=t(31418),N=t(14726),A=t(67294),I=t(85893);function p(F){var Z=(0,A.useContext)(x.Z),i=Z.message,P=Z.notice,Y=Z.lang,a=(0,A.useRef)(null),b=T.Z.useApp(),r=function(){a.current&&(a.current.click(),a.current.onchange=function(Q){if(!Q||!Q.target)return"";var $=new FileReader;$.onload=function(k){var ue,w,me=(ue=k.target)===null||ue===void 0?void 0:ue.result;if(F.onLoad)try{F.onLoad&&F.onLoad(me)}catch(fe){P.error(fe);return}typeof F.onImport=="function"&&(i.success("\u6210\u529F\u5BFC\u5165 ".concat(F.title)),F.onImport(me)),(w=a.current)!==null&&w!==void 0&&w.value&&(a.current.value="")};var J=Q.target;if(J.files)try{$.readAsText(J.files[0])}catch(k){P.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(z.Z,{children:(0,I.jsx)(N.ZP,{icon:(0,I.jsx)(E.Z,{}),block:!0,onClick:r,children:F.title})}),(0,I.jsx)("input",{style:{display:"none"},type:"file",ref:a,name:"importFileInput"})]})}},35880:function(ve,V,t){var x=t(67294),E=(0,x.createContext)({});V.Z=E},85864:function(ve,V,t){t.r(V),t.d(V,{default:function(){return gt}});var x=t(15009),E=t.n(x),z=t(99289),T=t.n(z),N=t(5574),A=t.n(N),I=t(90078),p=t(38345),F=t(97269),Z=t(2236),i=t(5966),P=t(97462),Y=t(64218),a=t(92398),b=t(38925),r=t(67294),l=t(35880),Q=t(10641),$=t(62370),J=t(85576),k=t(42075),ue=t(96074),w=t(25593),me=t(83062),fe=t(71230),Be=t(15746),xe=t(14726),he=t(3393),Ee=t(18148),ge=t(5251),U=t(64789),_=t(87462),K={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M885 780H165c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM400 325.7h73.9V664c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V325.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 171a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13z"}}]},name:"to-top",theme:"outlined"},q=K,H=t(84089),se=function(R,j){return r.createElement(H.Z,(0,_.Z)({},R,{ref:j,icon:q}))},pe=r.forwardRef(se),Pe=pe,S=t(23430),Te=t(28307),Ze=t(78451),Ye=t(99861),e=t(85893);function Je(s){var R=(0,r.useState)(!1),j=A()(R,2),v=j[0],h=j[1],C=(0,r.useRef)(),o=(0,r.useContext)(l.Z),c=o.createFormRef,D=o.volumeListRef,B=o.createEnvRef,d=o.domainRef,m=(0,r.useRef)(),M=function(){var g=T()(E()().mark(function O(f){var y,X,ne,L,ae,le,ee,Re,ie,de,Ae,oe;return E()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return h(!1),u.next=3,(0,he.YU)({md5:f});case 3:L=u.sent,s.redeploy||(Re=(ae=c.current)===null||ae===void 0?void 0:ae.getFieldsValue(),(le=c.current)===null||le===void 0||le.resetFields(),(ee=c.current)===null||ee===void 0||ee.setFieldsValue({siteName:Re.siteName,siteTitle:Re.siteTitle})),L.data.info.Config.Env&&L.data.info.Config.Env.map(function(n){var re,ce=n.split("=");(re=B.current)===null||re===void 0||re.addEnvItem(ce[0],ce.slice(1).join("="))}),(y=c.current)===null||y===void 0||y.setFieldValue("imageName",f),(X=c.current)===null||X===void 0||X.setFieldValue("workDir",L.data.info.Config.WorkingDir),(ne=d.current)===null||ne===void 0||ne.setExposePort(L.data.info.Config.ExposedPorts),s.redeploy||(L.data.info.Config.Volumes?(Ae=[],Object.keys(L.data.info.Config.Volumes).map(function(n,re){Ae.push(n)}),(de=D.current)===null||de===void 0||de.setDefaultDestPath(Ae)):(oe=D.current)===null||oe===void 0||oe.setDefaultDestPath([]),(ie=c.current)===null||ie===void 0||ie.setFieldsValue({workDir:{value:"",useDefault:!0,default:L.data.info.Config.WorkingDir},user:{value:"",useDefault:!0,default:L.data.info.Config.User},command:{value:"",useDefault:!0,default:L.data.info.Config.Cmd&&L.data.info.Config.Cmd.join(" ")},entrypoint:{value:"",useDefault:!0,default:L.data.info.Config.Entrypoint&&L.data.info.Config.Entrypoint.join(" ")}}));case 10:case"end":return u.stop()}},O)}));return function(f){return g.apply(this,arguments)}}();return(0,r.useEffect)(function(){s.fromImageId&&M(s.fromImageId)},[s.fromImageId]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(J.Z,{open:v,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return h(!1)},children:(0,e.jsx)(Q.Z,{scroll:{x:"max-content"},columns:[{title:"Id",dataIndex:"Id",search:!1,width:200,render:function(O,f,y,X,ne){return(0,e.jsx)(Ze.Z,{content:f.Id})}},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",width:200,render:function(O,f,y,X){return(0,e.jsx)(Ze.Z,{content:f.RepoTags[0]})}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(O,f,y,X){return(0,e.jsx)("div",{children:(0,ge.ZM)(f.Created*1e3)},f.Id)},sorter:function(O,f){return O.Created-f.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:80,render:function(O,f,y,X){return(0,e.jsxs)(k.Z,{split:(0,e.jsx)(ue.Z,{type:"vertical"}),children:[(0,e.jsx)(w.Z.Link,{onClick:T()(E()().mark(function ne(){return E()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.abrupt("return",M(f.RepoTags[0]));case 1:case"end":return ae.stop()}},ne)})),children:(0,e.jsx)(me.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(U.Z,{})})},"addImage"),(0,e.jsx)(w.Z.Link,{onClick:T()(E()().mark(function ne(){var L;return E()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:f.RepoTags[0]&&((L=m.current)===null||L===void 0||L.setImageName(f.RepoTags[0]));case 1:case"end":return le.stop()}},ne)})),children:(0,e.jsx)(me.Z,{title:"\u66F4\u65B0\u955C\u50CF",children:(0,e.jsx)(Pe,{})})},"updateImage")]})}}],request:function(){var g=T()(E()().mark(function O(f,y,X){var ne,L,ae,le,ee;return E()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return s.redeploy&&(L=(ne=c.current)===null||ne===void 0?void 0:ne.getFieldValue("imageName"),f.tag=L?L.split(":")[0]:f.tag),ie.next=3,(0,Ee.KG)({tag:f.tag});case 3:return ae=ie.sent,le=0,ee=[],ae.data.list&&(ee=ae.data.list.flatMap(function(de){return de.RepoTags.map(function(Ae){return{Key:le++,Id:de.Id,Created:de.Created,RepoTags:[Ae]}})})),ie.abrupt("return",{data:ee,success:!0,total:ee.length});case 8:case"end":return ie.stop()}},O)}));return function(O,f,y){return g.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(Te.Z,{onClick:function(){h(!1)},buttonType:"primary",ref:m,onFinish:function(f){M(f)}},"remote")]},formRef:C,rowKey:"Key",pagination:{pageSize:5}})},"imageTableList"),(0,e.jsxs)(fe.Z,{children:[(0,e.jsx)(Be.Z,{span:14,children:(0,e.jsx)(i.Z,{label:"\u955C\u50CF",tooltip:s.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0})}),(0,e.jsx)(Be.Z,{children:(0,e.jsx)($.Z,{label:" ",children:(0,e.jsxs)(k.Z,{children:[(0,e.jsx)(xe.ZP,{type:"primary",onClick:function(){return h(!0)},children:s.redeploy?"\u66F4\u65B0\u955C\u50CF":"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(P.Z,{name:["imageName"],children:function(O){var f=O.imageName;if(s.redeploy)return(0,e.jsx)(Ye.Z,{image:[f],trigger:(0,e.jsx)(me.Z,{title:"\u5FEB\u901F\u91CD\u65B0\u62C9\u53D6\u955C\u50CF\uFF0C\u66F4\u65B0\u5BB9\u5668",children:(0,e.jsx)(xe.ZP,{icon:(0,e.jsx)(S.Z,{}),children:"\u66F4\u65B0\u6216\u662F\u62C9\u53D6\u5F53\u524D\u955C\u50CF"})})})}})]})})})]})]})}var Le=t(60335),Qe=t(24969),Fe=t(24739),Xe=t(63434),Oe=t(17186),qe=t(27496),et=t(66309);function tt(s){return(0,e.jsx)(Q.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"names",render:function(j,v,h,C){return(0,e.jsx)(k.Z,{direction:"vertical",style:{textAlign:"left"},children:v==null?void 0:v.Names.map(function(o){return o})},v.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(j,v,h,C){return v!=null&&v.Ports?(0,e.jsx)(k.Z,{direction:"vertical",style:{textAlign:"left"},children:v==null?void 0:v.Ports.map(function(o,c){return(0,e.jsx)(et.Z,{color:"#2db7f5",icon:o.PublicPort?(0,e.jsx)(qe.Z,{}):"",children:"".concat(o.PublicPort?o.IP+":"+o.PublicPort+"->":"").concat(o.PrivatePort,"/").concat(o.Type)},c)})},v.Id):(0,e.jsx)(e.Fragment,{})}},{title:"\u8FD0\u884C\u5BB9\u5668",search:!1,render:function(j,v,h,C){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(w.Z.Text,{ellipsis:{tooltip:v.Image},children:v.Image},v.Id)})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(j,v,h,C){return[(0,e.jsx)(xe.ZP,{type:"link",onClick:function(){(0,Le.jV)({md5:v.Id}).then(function(c){return s.onSelect&&s.onSelect(c.data.info),!0})},children:(0,e.jsx)(U.Z,{})},v.Id)]}}],rowKey:"Id",request:function(){var R=T()(E()().mark(function j(v,h,C){return E()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",new Promise(function(D,B){(0,Le.IE)({tag:v.names}).then(function(d){var m={data:d.data.list,success:!0,total:d.data.list.length};D(m)})}));case 1:case"end":return c.stop()}},j)}));return function(j,v,h){return R.apply(this,arguments)}}(),pagination:{pageSize:5}})}var nt=(0,r.forwardRef)(function(s,R){var j=(0,r.useState)(!1),v=A()(j,2),h=v[0],C=v[1],o=(0,r.useRef)(),c=function(d){var m=(0,r.useState)([]),M=A()(m,2),g=M[0],O=M[1];return(0,r.useEffect)(function(){(0,Le.jV)({md5:d.name}).then(function(f){var y;return O((y=f.data.info.Config.Env)!==null&&y!==void 0?y:[]),!0})},[]),(0,e.jsxs)(p.Z,{bordered:!0,extra:d.action,style:{marginBottom:10},children:[(0,e.jsx)(p.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(Fe.UW,{children:[(0,e.jsx)(i.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(i.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(Xe.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(p.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(k.Z,{direction:"vertical",children:g&&g.map(function(f,y){return(0,e.jsx)(w.Z.Text,{copyable:{icon:(0,e.jsx)(Qe.Z,{}),onCopy:function(){var ne=f.split("=");s.onAddEnv(ne[0],ne[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:f},style:{width:300},children:f},y)})},"linkEnv")})]})},D=function(d){var m,M,g=!1,O=(m=(M=o.current)===null||M===void 0?void 0:M.getList())!==null&&m!==void 0?m:[];if(O.map(function(y){y.name==d.name&&(g=!0)}),!g){var f;(f=o.current)===null||f===void 0||f.add(d)}};return(0,r.useImperativeHandle)(R,function(){return{setDefaultLink:function(d){d&&d.map(function(m){m.name!=""&&D(m)})}}}),(0,e.jsxs)(p.Z,{title:"\u5173\u8054\u5BB9\u5668",headerBordered:!0,children:[(0,e.jsx)(Oe.u,{name:"links",actionRef:o,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(d,m){return C(!0),!1}},copyIconProps:!1,min:0,itemRender:function(d,m){return(0,e.jsx)(c,{action:d.action,name:m.record.name})}}),(0,e.jsx)(J.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:1024,footer:!1,open:h,onCancel:function(){return C(!1)},children:(0,e.jsx)(tt,{onSelect:function(d){D({name:d.Name,alise:d.Config.Hostname,volume:!1}),C(!1)}})})]})}),ut=nt,at=t(91058),ke=t(86615),Me=t(64317),rt=(0,r.forwardRef)(function(s,R){var j=(0,r.useRef)(),v=(0,r.useRef)();return(0,r.useImperativeHandle)(R,function(){return{setDefaultDestPath:function(C){var o,c,D=(o=(c=j.current)===null||c===void 0?void 0:c.getList())!==null&&o!==void 0?o:[];C.length!=0&&C.filter(function(B){return B!=""}).map(function(B){var d=!1;if(D.map(function(M){if(M.dest==B){d=!0;return}}),!d){var m;(m=j.current)===null||m===void 0||m.add({dest:B,permission:"write",inImage:!0,edit:!1})}})},addUserVolumeItem:function(C,o){var c,D=(c=v.current)===null||c===void 0?void 0:c.getList(),B=!1;if(D==null||D.map(function(m){if(m.dest==o){B=!0;return}}),!B){var d;(d=v.current)===null||d===void 0||d.add({host:C,dest:o})}}}}),(0,e.jsxs)(e.Fragment,{children:[s.showDefault&&(0,e.jsx)(p.Z,{title:"\u9ED8\u8BA4\u5B58\u50A8\uFF08Volume\uFF09",subTitle:"\u9ED8\u8BA4\u5B58\u50A8\u4E0E\u7AD9\u70B9\u6807\u8BC6\u4FDD\u6301\u4E00\u81F4",headerBordered:!0,children:(0,e.jsx)(Oe.u,{name:"volumesDefault",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u76EE\u5F55\u5230\u9ED8\u8BA4\u5B58\u50A8"},actionRef:j,copyIconProps:!1,min:0,children:function(C,o,c){var D=c.getCurrentRowData();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(i.Z,{width:"lg",name:"dest",label:"\u5BB9\u5668\u5185\u8DEF\u5F84",required:!0,rules:[{required:!0}],disabled:D.inImage}),(0,e.jsx)(ke.Z.Group,{hidden:!0,name:"inImage",label:"\u955C\u50CF\u5185\u6302\u8F7D",valueEnum:{1:"\u662F",0:"\u5426"}})]})}})}),(0,e.jsx)(p.Z,{title:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u6216\u662F\u5B58\u50A8\u5377",tooltip:"\u6302\u8F7D\u53EF\u4EE5\u662F\u5BBF\u4E3B\u673A\u7684\u76EE\u5F55\u6216\u662F\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u5B58\u50A8\u5377\u540D\uFF08\u81EA\u52A8\u65B0\u5EFA\uFF09\u3002",headerBordered:!0,direction:"column",children:(0,e.jsx)(Oe.u,{actionRef:v,name:"volumes",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u6620\u5C04\u76EE\u5F55"},copyIconProps:!1,min:0,children:(0,e.jsxs)(Fe.UW,{children:[(0,e.jsxs)(k.Z.Compact,{children:[(0,e.jsx)(i.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u3001\u76EE\u5F55\u6216\u5B58\u50A8\u5377",name:"host",width:s.showInDrawer?"sm":"md",required:!0,rules:[{required:!0}]}),(0,e.jsx)(Me.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(i.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:s.showInDrawer?"sm":"md",required:!0,rules:[{required:!0}],disabled:s.disabledUserVolumeDest})]})})})]})}),ot=rt,lt=t(2831),je=t(52688),Ke=t(86125),it=t(44349);function st(s){var R,j=(0,r.useState)(),v=A()(j,2),h=v[0],C=v[1];return(0,r.useEffect)(function(){(0,lt.aF)().then(function(o){return C(o.data.info)})},[]),(0,e.jsxs)(p.Z,{children:[(0,e.jsx)(i.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:"64M",tooltip:"0 \u4E3A\u4F7F\u7528\u9ED8\u8BA464M"}),(0,e.jsx)($.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Ke.Z,{step:.1,max:h==null?void 0:h.NCPU,marks:{0:"0",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)($.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Ke.Z,{step:256,max:Math.round(((R=h==null?void 0:h.MemTotal)!==null&&R!==void 0?R:0)/1024/1024),marks:{0:"0",1024:"1G",2048:"2G",3072:"3G",4096:"4G"}})}),(0,e.jsx)(Me.Z,{label:"\u65E5\u5FD7\u7C7B\u578B",name:["log","driver"],tooltip:"\u9ED8\u8BA4\u4F7F\u7528 json-file \u9A71\u52A8\u7531 docker \u7EDF\u4E00\u7BA1\u7406\u3002\u91C7\u7528 journal \u65F6\u65E5\u5FD7\u5C06\u6765\u5BBF\u4E3B\u673A\u7BA1\u7406",initialValue:"json-file",valueEnum:{"json-file":"json-file",journald:"journal (\u5BBF\u4E3B\u9700\u8981\u5B89\u88C5journal\u670D\u52A1)"}}),(0,e.jsx)(P.Z,{name:["log"],children:function(c){var D=c.log;if(D.driver=="json-file")return(0,e.jsxs)(Fe.UW,{children:[(0,e.jsx)(i.Z,{label:"\u65E5\u5FD7\u5207\u5272\u5C3A\u5BF8",name:["log","maxSize"],placeholder:"\u4F8B\u5982\uFF1A10k,5M",tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u5207\u5272\u65E5\u5FD7"}),(0,e.jsx)(i.Z,{tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u6E05\u7406\u65E5\u5FD7\u6587\u4EF6",label:"\u4FDD\u7559\u65E5\u5FD7\u6587\u4EF6\u6570",name:["log","maxFile"],placeholder:"\u4F8B\u5982\uFF1A10"})]})}}),(0,e.jsx)(it.Z,{name:"device",label:"\u5173\u8054\u8BBE\u5907",hideCopyButton:!0,showAddButton:!0,items:[{label:"\u5BBF\u4E3B\u673A\u8DEF\u5F84",name:"host",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"},{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"}]}),(0,e.jsxs)(fe.Z,{children:[(0,e.jsx)(Be.Z,{span:4,children:(0,e.jsx)(je.Z,{label:"\u4F7F\u7528 Gpu",name:["gpus","enable"]})}),(0,e.jsx)(Be.Z,{span:20,children:(0,e.jsx)(P.Z,{name:["gpus"],children:function(c){var D=c.gpus;if(D&&D.enable)return(0,e.jsx)(Me.Z,{mode:"tags",label:"\u8BBE\u5907\u5217\u8868",name:["gpus","device"],placeholder:"\u914D\u7F6E\u4F7F\u7528\u8BBE\u5907id\u6216\u662Fuuid\uFF0C\u4E0D\u586B\u6240\u4E3A\u6240\u6709\u8BBE\u5907"})}})})]}),(0,e.jsx)(P.Z,{name:["gpus"],children:function(c){var D=c.gpus;if(D&&D.enable)return(0,e.jsx)(Me.Z,{label:"\u8BA1\u7B97\u80FD\u529B",name:["gpus","capabilities"],mode:"multiple",fieldProps:{allowClear:!0},options:[{label:"compute - \u8BA1\u7B97\u80FD\u529B",value:"compute"},{label:"compat32 - \u517C\u5BB932\u4F4D",value:"compat32"},{label:"graphics - \u56FE\u5F62\u5904\u7406\u80FD\u529B",value:"graphics"},{label:"utility - \u76D1\u63A7\u548C\u7BA1\u7406\u80FD\u529B",value:"utility"},{label:"video - \u89C6\u9891\u5904\u7406\u80FD\u529B",value:"video"},{label:"display - \u663E\u793A\u56FE\u5F62\u754C\u9762\u80FD\u529B",value:"display"}]})}})]})}function dt(){return(0,e.jsx)(p.Z,{title:"\u5BB9\u5668\u6807\u7B7E",children:(0,e.jsx)(Oe.u,{name:"label",label:"",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(Fe.UW,{children:[(0,e.jsx)(i.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(i.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var ct=t(44771),Pt="default",_t="user";function vt(s){return(0,e.jsx)($.Z,{label:s.label,tooltip:s.tooltip,children:(0,e.jsxs)(k.Z.Compact,{block:!0,children:[(0,e.jsx)(ke.Z.Group,{radioType:"button",name:[s.name,"useDefault"],options:[{label:"\u4F7F\u7528\u9ED8\u8BA4",value:!0},{label:"\u81EA\u5B9A\u4E49",value:!1}]}),(0,e.jsx)(P.Z,{name:[s.name],children:function(j){return j[s.name]&&j[s.name].useDefault?(0,e.jsx)(i.Z,{name:[s.name,"default"],disabled:!0,placeholder:"\u672A\u8BBE\u7F6E"}):(0,e.jsx)(i.Z,{name:[s.name,"value"]})}})]})})}var we=vt;function mt(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(p.Z,{children:[(0,e.jsx)(ct.Z,{label:"\u91CD\u542F\u7B56\u7565"}),(0,e.jsxs)(Fe.UW,{children:[(0,e.jsx)(je.Z,{name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(je.Z,{name:"autoRemove",label:"\u505C\u6B62\u540E\u81EA\u52A8\u5220\u9664",initialValue:!1})]}),(0,e.jsx)(we,{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55",name:"workDir"}),(0,e.jsx)(we,{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237",name:"user"}),(0,e.jsx)(we,{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command"}),(0,e.jsx)(we,{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4",name:"entrypoint"})]})})}var ft=t(91845),He=t(62597),Ge=t(54006),ht=t(4798),Et=(0,r.forwardRef)(function(s,R){var j=(0,r.useState)(""),v=A()(j,2),h=v[0],C=v[1],o=(0,r.useRef)(),c=(0,r.useContext)(l.Z),D=c.createFormRef;return(0,r.useImperativeHandle)(R,function(){return{setExposePort:function(d){if(d){var m,M,g=(m=(M=o.current)===null||M===void 0?void 0:M.getList())!==null&&m!==void 0?m:[];Object.keys(d).map(function(O){var f=!1;if(g.map(function(X){X.dest==O&&(f=!0)}),!f){var y;(y=o.current)===null||y===void 0||y.add({host:"",dest:O})}})}},setHostname:function(d){C(d)},addPortItem:function(d,m){var M,g=(M=o.current)===null||M===void 0?void 0:M.getList(),O=!1;if(g==null||g.map(function(y){if(y.host==d){O=!0;return}}),!O){var f;(f=o.current)===null||f===void 0||f.add({host:String(d),dest:String(m)})}}}}),(0,e.jsx)(p.Z,{title:"\u7ED1\u5B9A\u7AEF\u53E3",tooltip:"\u8BBF\u95EE\u7AEF\u53E3\u7559\u7A7A\u65F6\u968F\u673A\u751F\u6210\u7AEF\u53E3\uFF0C\u5168\u90E8\u5220\u9664\u5219\u8868\u793A\u4E0D\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,extra:(0,e.jsxs)(k.Z,{children:[s.showBindHost&&(0,e.jsx)(je.Z,{name:"useHostNetwork",fieldProps:{checkedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",unCheckedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",onChange:function(d){if(d){var m;(m=D.current)===null||m===void 0||m.setFieldsValue({bindIpV6:!1,publishAllPorts:!1})}}}}),s.showBindIpV6&&(0,e.jsx)(P.Z,{name:["siteName","useHostNetwork"],children:function(d){var m=d.useHostNetwork;return(0,e.jsx)(je.Z,{name:"publishAllPorts",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3",unCheckedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3"},disabled:m},"publishAllPorts")}}),s.showBindIpV6&&(0,e.jsx)(P.Z,{name:["siteName","useHostNetwork"],children:function(d){var m=d.useHostNetwork;return(0,e.jsx)(je.Z,{name:"bindIpV6",fieldProps:{checkedChildren:"IpV6",unCheckedChildren:"IpV6"},disabled:m},"bindIpV6")}})]}),children:(0,e.jsx)(P.Z,{name:["useHostNetwork","bindIpV6","publishAllPorts"],children:function(d){var m=d.useHostNetwork,M=d.bindIpV6,g=d.publishAllPorts;if(!m&&!g)return(0,e.jsx)(Oe.u,{name:"ports",actionRef:o,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(Fe.UW,{children:[(0,e.jsx)(i.Z,{width:s.showInDrawer?"sm":"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u6DFB\u52A0\u8BBF\u95EE\u7AEF\u53E3\u6216\u662F\u521B\u5EFA\u5B8C\u6210\u540E\u5BF9\u5BB9\u5668\u7ED1\u5B9A\u57DF\u540D",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3\uFF0C\u7ED1\u5B9AIpV6\u5FC5\u586B",required:M,rules:[{required:M}]}),(0,e.jsx)(i.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:s.showInDrawer?"sm":"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3",required:!0,rules:[{required:!0}]})]})})}})})}),pt=Et;function _e(s){return(0,e.jsx)("div",{style:{display:s.show?"block":"none"},children:s.children})}function Ft(){var s=(0,r.useRef)(),R=function(h){var C,o,c=!1,D=(C=(o=s.current)===null||o===void 0?void 0:o.getList())!==null&&C!==void 0?C:[];if(D.map(function(d){d.name==h.name&&(c=!0)}),!c){var B;(B=s.current)===null||B===void 0||B.add(h)}},j=function(h){var C,o,c=!1,D=(C=(o=s.current)===null||o===void 0?void 0:o.getList())!==null&&C!==void 0?C:[];D.map(function(B,d){if(B.name==h){var m;(m=s.current)===null||m===void 0||m.remove(d)}})};return(0,e.jsx)(p.Z,{title:"\u5173\u8054\u5BBF\u4E3B\u7F51\u7EDC\u4E3B\u673A",tooltip:"\u5BB9\u5668\u5185\u5982\u679C\u9700\u8981\u8BF7\u6C42\u5BBF\u4E3B\u673A\u6240\u5728\u7684\u7F51\u7EDC\u4E2D\u7684\u4E3B\u673A\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6B64\u914D\u7F6E\u5C06Ip\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D",extra:(0,e.jsx)(k.Z,{children:(0,e.jsx)(je.Z,{name:"enableBindHost",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",unCheckedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",onChange:function(h){h?R({name:"host.dpanel.local",value:"host-gateway"}):j("host.dpanel.local")}}})}),children:(0,e.jsx)(Oe.u,{name:"extraHosts",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BBF\u4E3B\u673A\u7F51\u7EDC\u5173\u8054"},actionRef:s,copyIconProps:!1,min:0,children:(0,e.jsxs)(Fe.UW,{children:[(0,e.jsx)(i.Z,{width:"md",name:"name",label:"Hostname",placeholder:""}),(0,e.jsx)(i.Z,{width:"md",name:"value",label:"ip",placeholder:""})]})})})}var Ue=t(90672),Ct=(0,r.forwardRef)(function(s,R){return(0,r.useImperativeHandle)(R,function(){return{}}),(0,e.jsxs)(p.Z,{title:"\u7F51\u7EDC\u914D\u7F6E",children:[(0,e.jsxs)(Fe.UW,{children:[(0,e.jsx)(i.Z,{label:"\u914D\u7F6E ipV4 \u5730\u5740",name:["ipV4","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u5730\u5740\uFF0C\u4F8B\u5982 192.168.1.5",placeholder:"192.168.1.5"}),(0,e.jsx)(P.Z,{name:["ipV4"],children:function(v){var h=v.ipV4;return(0,e.jsx)(i.Z,{label:"\u914D\u7F6E ipV4 \u5B50\u7F51",name:["ipV4","subnet"],width:"md",required:h&&h.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 192.168.1.0/24",placeholder:"192.168.1.0/24",rules:[{required:h&&h.address}]})}}),(0,e.jsx)(i.Z,{label:"\u914D\u7F6E ipV4 \u7F51\u5173",name:["ipV4","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 192.168.1.1",placeholder:"192.168.1.1"}),(0,e.jsx)(je.Z,{label:"\u81EA\u5B9A\u4E49ipV6",name:"enableIpV6Address"})]}),(0,e.jsx)(P.Z,{name:["enableIpV6Address"],children:function(v){var h=v.enableIpV6Address;if(h)return(0,e.jsxs)(Fe.UW,{children:[(0,e.jsx)(i.Z,{label:"\u914D\u7F6E ipV6 \u5730\u5740",name:["ipV6","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u5730\u5740\uFF0C\u4F8B\u5982 2001:db8::5",placeholder:"2001:db8::5"}),(0,e.jsx)(P.Z,{name:["ipV6"],children:function(o){var c=o.ipV6;return(0,e.jsx)(i.Z,{label:"\u914D\u7F6E ipV6 \u5B50\u7F51",name:["ipV6","subnet"],width:"md",required:c&&c.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 2001:db8::/48",placeholder:"2001:db8::/48",rules:[{required:c&&c.address}]})}}),(0,e.jsx)(i.Z,{label:"\u914D\u7F6E ipV6 \u7F51\u5173",name:["ipV6","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 2001:db8::1",placeholder:"2001:db8::1"})]})}}),(0,e.jsx)(Ue.Z,{label:"DNS\u914D\u7F6E",name:"dns",placeholder:"\u8BF7\u6307\u5B9Adns\u5730\u5740\uFF0C\u4F8B\u5982\uFF1A8.8.8.8\uFF0C\u4E00\u884C\u6DFB\u4E00\u6761dns\u5730\u5740"})]})}),Bt=Ct,xt=t(24963),We=t(31199),jt=t(86250);function Dt(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(p.Z,{title:"\u9644\u52A0\u6267\u884C\u811A\u672C",headerBordered:!0,subTitle:"",children:(0,e.jsx)(Ue.Z,{label:"\u5BB9\u5668\u521B\u5EFA\u540E\u6267\u884C\u811A\u672C",name:["hook","containerCreate"],placeholder:"\u5BB9\u5668\u5728\u521B\u5EFA\u540E\u6267\u884C\u7684\u811A\u672C\uFF0C\u6B64\u811A\u672C\u5E76\u4E0D\u4F1A\u5F71\u54CD entrypoint \u53CA command\u3002\u4F8B\u5982\uFF1Als -al && touch abc.txt && apt update"})}),(0,e.jsxs)(p.Z,{title:"\u5065\u5EB7\u68C0\u67E5",headerBordered:!0,children:[(0,e.jsxs)(jt.Z,{gap:20,justify:"start",children:[(0,e.jsx)(We.Z,{label:"\u91CD\u590D\u95F4\u9694\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","interval"],initialValue:30}),(0,e.jsx)(We.Z,{label:"\u8D85\u65F6\u5931\u8D25\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","timeout"],initialValue:10}),(0,e.jsx)(We.Z,{label:"\u5931\u8D25\u91CD\u590D\u6B21\u6570",name:["healthcheck","retries"],initialValue:3}),(0,e.jsx)(Me.Z,{width:"sm",label:"\u811A\u672C\u6267\u884C\u73AF\u5883",initialValue:"CMD",name:["healthcheck","shellType"],valueEnum:{CMD:"\u5728 Docker \u73AF\u5883\u6267\u884C","CMD-SHELL":"\u5728\u5BB9\u5668\u5185\u6267\u884C"}})]}),(0,e.jsx)(Ue.Z,{label:"\u6267\u884C\u811A\u672C",name:["healthcheck","cmd"],placeholder:"\u914D\u7F6E\u5BB9\u5668\u5065\u5EB7\u68C0\u67E5\u811A\u672C\uFF0C\u4F8B\u5982\uFF1Acurl -f http://localhost:8080/ || exit 1"})]})]})}var ye="update",ze="copy",Ve="new";function gt(){var s,R,j,v=(0,r.useContext)(xt.Z),h=v.loading,C=(0,r.useContext)(l.Z),o=C.createFormRef,c=C.volumeListRef,D=C.domainRef,B=C.createEnvRef,d=C.createLinkRef,m=(0,r.useState)(Ve),M=A()(m,2),g=M[0],O=M[1],f=(0,Ge.useSearchParams)(),y=A()(f,2),X=y[0],ne=y[1],L=(0,Ge.useNavigate)(),ae=(0,r.useState)("basic"),le=A()(ae,2),ee=le[0],Re=le[1],ie=parseInt((s=X.get("id"))!==null&&s!==void 0?s:""),de=(R=X.get("containerId"))!==null&&R!==void 0?R:"",Ae=(j=X.get("imageId"))!==null&&j!==void 0?j:"";return(0,r.useEffect)(function(){if(de||ie)h.show(),(0,He.iE)({md5:de,id:ie}).then(function(){var te=T()(E()().mark(function u(n){var re,ce,W,De,Ce,Se,Ne,$e;return E()().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:if(W={info:{},layer:[]},X.get("op")==ze?O(ze):O(ye),n.data.env.network&&n.data.env.network.map(function(G){return!G.alise&&G.name!="bridge"&&(G.alise=[n.data.siteName+".pod.dpanel.local"]),G}),n.data.env.ports&&n.data.env.ports.map(function(G){return G.host=="0"&&(G.host=""),G}),De=n.data.env.bindIpV6,n.data.containerInfo.Info&&n.data.containerInfo.Info.NetworkSettings.Networks&&Object.keys(n.data.containerInfo.Info.NetworkSettings.Networks).map(function(G){n.data.env.network&&(n.data.env.network=n.data.env.network.map(function(Ie){return G==Ie.name&&(Ie.subnet=n.data.containerInfo.Info.NetworkSettings.Networks[G].IPAddress+"/"+n.data.containerInfo.Info.NetworkSettings.Networks[G].IPPrefixLen),Ie})),n.data.containerInfo.Info.NetworkSettings.Networks[G].IPv6Gateway!=""&&(De=!0)}),n.data.env.extraHosts&&n.data.env.extraHosts.map(function(G){if(G.value=="host-gateway"){var Ie;(Ie=o.current)===null||Ie===void 0||Ie.setFieldValue("enableBindHost",!0)}}),Ce=n.data.env.ports,n.data.env.ports&&(Ce=n.data.env.ports.map(function(G){return G.host=(G.hostIp?G.hostIp+":":"")+G.host,G})),(re=o.current)===null||re===void 0||re.setFieldsValue({imageName:n.data.env.imageName,privileged:n.data.env.privileged,bindIpV6:n.data.env.useHostNetwork?!1:De,useHostNetwork:n.data.env.useHostNetwork,publishAllPorts:n.data.env.useHostNetwork?!1:n.data.env.publishAllPorts,workDir:{value:n.data.env.workDir,useDefault:!n.data.env.workDir,default:W&&W.info.Config&&W.info.Config.WorkingDir},user:{value:n.data.env.user,useDefault:!n.data.env.user,default:W&&W.info.Config&&W.info.Config.User},command:{value:n.data.env.command,useDefault:!n.data.env.command,default:W&&W.info.Config&&W.info.Config.Cmd&&W.info.Config.Cmd.join(" ")},entrypoint:{value:n.data.env.entrypoint,useDefault:!n.data.env.entrypoint,default:W&&W.info.Config&&W.info.Config.Entrypoint&&W.info.Config.Entrypoint.join(" ")},shmsize:(ce=n.data.env.shmsize)!==null&&ce!==void 0?ce:"64M",cpus:n.data.env.cpus,memory:n.data.env.memory,environment:n.data.env.environment,label:n.data.env.label,volumesDefault:n.data.env.volumesDefault,volumes:n.data.env.volumes,ports:Ce,links:n.data.env.links,network:n.data.env.network,restart:n.data.env.restart,extraHosts:n.data.env.extraHosts,autoRemove:n.data.env.autoRemove,log:n.data.env.log,dns:n.data.env.dns&&n.data.env.dns.join(`
`),ipV4:n.data.env.ipV4,ipV6:n.data.env.ipV6,gpus:n.data.env.gpus,device:n.data.env.device,hook:n.data.env.hook}),n.data.env.healthcheck&&n.data.env.healthcheck.cmd&&n.data.env.healthcheck.cmd!=""&&((Se=o.current)===null||Se===void 0||Se.setFieldsValue({healthcheck:n.data.env.healthcheck})),X.get("op")==ye&&((Ne=o.current)===null||Ne===void 0||Ne.setFieldsValue({siteTitle:n.data.siteTitle,siteName:n.data.siteName})),!n.data.env.imageName){be.next=17;break}return be.next=15,(0,he.YU)({md5:n.data.env.imageName});case 15:$e=be.sent,W=$e.data;case 17:case"end":return be.stop()}},u)}));return function(u){return te.apply(this,arguments)}}()).finally(function(){h.destroy()});else{var oe;O(Ve),(oe=o.current)===null||oe===void 0||oe.resetFields()}},[X]),(0,e.jsx)(I._z,{children:(0,e.jsx)(p.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(F.A,{submitter:{render:function(te,u){return(0,e.jsx)(Z.S,{children:u})}},formRef:o,onFinish:function(){var oe=T()(E()().mark(function te(u){var n,re,ce,W;return E()().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return console.log(u),W={siteTitle:u.siteTitle,siteName:u.siteName,imageName:u.imageName,environment:u.environment,links:u.links,ports:u.ports,volumes:u.volumes,volumesDefault:u.volumesDefault,network:u.network,privileged:(n=u.privileged)!==null&&n!==void 0?n:!1,autoRemove:(re=u.autoRemove)!==null&&re!==void 0?re:!1,restart:u.restart,cpus:u.cpus,memory:u.memory,shmsize:(ce=u.shmsize)!==null&&ce!==void 0?ce:0,workDir:u.workDir&&!u.workDir.useDefault?u.workDir.value:"",user:u.user&&!u.user.useDefault?u.user.value:"",command:u.command&&!u.command.useDefault?u.command.value:"",entrypoint:u.entrypoint&&!u.entrypoint.useDefault?u.entrypoint.value:"",useHostNetwork:u.useHostNetwork,bindIpV6:u.bindIpV6,log:u.log,dns:u.dns&&u.dns!=""?u.dns.split(`
`):[],label:u.label,publishAllPorts:u.publishAllPorts,extraHosts:u.extraHosts,ipV4:u.ipV4,ipV6:u.ipV6,device:u.device,gpus:u.gpus,hook:u.hook},u.healthcheck&&u.healthcheck.cmd&&u.healthcheck.cmd!=""&&(W.healthcheck=u.healthcheck),de&&g==ye&&(W.containerId=de),Ce.next=6,(0,He.$G)(W);case 6:return L("/app/list"),Ce.abrupt("return",!0);case 8:case"end":return Ce.stop()}},te)}));return function(te){return oe.apply(this,arguments)}}(),children:[(0,e.jsxs)(p.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(i.Z,{name:"siteTitle",label:"\u7AD9\u70B9\u540D\u79F0",required:!0,rules:[{required:!0}],fieldProps:{onChange:function(te){var u="";if(te.target.value&&g!=ye){var n,re=(0,ft.N9)(te.target.value.trim(),{toneType:"none",type:"array"});u=re.join(""),(n=o.current)===null||n===void 0||n.setFieldValue("siteName",u)}}},placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(i.Z,{name:"siteName",label:"\u7AD9\u70B9\u6807\u8BC6",tooltip:"\u7AD9\u70B9\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u7AD9\u70B9\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:g==ye,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(Je,{redeploy:g!=Ve,fromImageId:Ae})]}),(0,e.jsx)(Y.Z,{offsetTop:50,children:(0,e.jsx)(p.Z,{style:{marginBottom:-20},children:(0,e.jsx)(a.Z,{activeKey:ee,onChange:function(te){Re(te),window.scrollTo(0,450)},items:[{label:"\u57FA\u672C\u914D\u7F6E",key:"basic"},{label:"\u5173\u8054\u914D\u7F6E",key:"link"},{label:"\u5B58\u50A8\u914D\u7F6E",key:"storage"},{label:"\u8FD0\u884C\u914D\u7F6E",key:"run-command"},{label:"\u8D44\u6E90\u914D\u7F6E",key:"resource"},{label:"Hook",key:"hook"},{label:"\u5176\u5B83",key:"other"}]})})}),(0,e.jsxs)(_e,{show:ee=="basic",children:[(0,e.jsx)(pt,{ref:D,showBindHost:!0,showBindIpV6:!0}),(0,e.jsx)(at.Z,{showAddButton:!0,showImportButton:!0,showCodeMode:!0,label:"\u73AF\u5883\u53D8\u91CF",ref:B}),(0,e.jsx)(P.Z,{name:["siteName","useHostNetwork"],children:function(te){var u=te.siteName,n=te.useHostNetwork;if(!n)return(0,e.jsx)(Bt,{})}})]}),(0,e.jsx)(_e,{show:ee=="link",children:(0,e.jsx)(P.Z,{name:["siteName","useHostNetwork"],children:function(te){var u=te.siteName,n=te.useHostNetwork;return n?(0,e.jsx)(b.Z,{showIcon:!0,description:"\u7ED1\u5B9A\u5230\u5BBF\u4E3B\u673A\u7F51\u7EDC\u65F6\uFF0C\u65E0\u6CD5\u901A\u8FC7 Docker \u5173\u8054\u5176\u5B83\u5BB9\u5668\u3002\u8BF7\u4F7F\u7528\u5BBF\u4E3B\u673A\u5185\u7F51IP\u6216\u662F127.0.0.1\u4E92\u8054\u5BB9\u5668\u66B4\u9732\u7AEF\u53E3\u3002"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ut,{onAddEnv:function(ce,W){var De;(De=B.current)===null||De===void 0||De.addEnvItem(ce,W)},ref:d}),(0,e.jsx)(ht.Z,{siteName:u}),(0,e.jsx)(Ft,{})]})}})}),(0,e.jsx)(_e,{show:ee=="storage",children:(0,e.jsx)(ot,{showDefault:!0,ref:c})}),(0,e.jsx)(_e,{show:ee=="run-command",children:(0,e.jsx)(mt,{})}),(0,e.jsx)(_e,{show:ee=="resource",children:(0,e.jsx)(st,{})}),(0,e.jsx)(_e,{show:ee=="hook",children:(0,e.jsx)(Dt,{})}),(0,e.jsx)(_e,{show:ee=="other",children:(0,e.jsx)(dt,{})})]},"form")})})}}}]);
