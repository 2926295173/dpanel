"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8714],{68714:function(le,F,e){e.d(F,{Z:function(){return m}});var K=e(5574),_=e.n(K),y=e(15009),i=e.n(y),$=e(99289),g=e.n($),o=e(67294),H=e(37767),I=e(60335),L=e(82346),N=e(58638),B=e(85265),V=e(96074),x=e(83062),R=e(86250),z=e(52031),ae=e(14189),te=e(72409),re=e(21393),J=e(184),Q=e(25593),Y=e(95591),b=e(5251),a=e(85893),ue=(0,o.forwardRef)(function(r,u){var c,f=(0,o.useState)(!1),j=_()(f,2),M=j[0],Z=j[1];return(0,o.useImperativeHandle)(u,function(){return{}}),(0,a.jsx)(J.a,{submitter:!1,title:(0,b.fi)(r.containerInfo.Name,"/")+" - \u6587\u4EF6\u7BA1\u7406",onOpenChange:function(O){Z(O)},trigger:(0,a.jsx)(Q.Z.Link,{children:(0,a.jsx)(Y.Z,{})},"file"),children:M&&(0,a.jsx)(re.Z,{md5:r.containerInfo.Id,initPath:(c=r.containerInfo.Config.WorkingDir)!==null&&c!==void 0?c:"/"})})}),q=ue,de=e(43831),ee=e(52209),ce=(0,o.forwardRef)(function(r,u){(0,o.useImperativeHandle)(u,function(){return{}});var c=(0,o.useState)(!1),f=_()(c,2),j=f[0],M=f[1];return(0,a.jsx)(J.a,{submitter:!1,title:(0,b.fi)(r.containerInfo.Name,"/")+" - \u7F51\u7EDC\u7BA1\u7406",onOpenChange:function(n){M(n)},open:j,trigger:(0,a.jsx)(Q.Z.Link,{children:(0,a.jsx)(ee.Z,{})},"file"),children:(0,a.jsx)(de.Z,{ghost:!0,containerInfo:r.containerInfo})})}),t=ce,P=e(81146),S=e(45742),G=e(62597),se=(0,o.forwardRef)(function(r,u){(0,o.useImperativeHandle)(u,function(){return{show:function(h){return g()(i()().mark(function d(){var l;return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,I.jV)({md5:h});case 2:l=s.sent,l.data&&ne(l.data.info),M(!0);case 5:case"end":return s.stop()}},d)}))()}}});var c=(0,o.useState)(!1),f=_()(c,2),j=f[0],M=f[1],Z=(0,o.useState)(),n=_()(Z,2),O=n[0],ne=n[1],U=(0,o.useRef)();return(0,a.jsxs)(a.Fragment,{children:[r.showTriggerButton&&(0,a.jsx)(Q.Z.Link,{onClick:g()(i()().mark(function p(){return i()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:ne(r.containerInfo),M(!0);case 2:case"end":return d.stop()}},p)})),children:(0,a.jsx)(x.Z,{title:"\u8FD0\u884C\u65E5\u5FD7",children:(0,a.jsx)(S.Z,{})})},"log"),(0,a.jsx)(B.Z,{title:"\u5BB9\u5668\u65E5\u5FD7",open:j,forceRender:!0,onClose:function(){M(!1)},afterOpenChange:function(h){if(h)setTimeout(function(){var l,v;(l=U.current)===null||l===void 0||l.start(),(v=U.current)===null||v===void 0||v.fit()},1e3);else{var d;(d=U.current)===null||d===void 0||d.close()}},width:800,children:O&&j&&(0,a.jsx)(P.Z,{ref:U,showInDrawer:!0,id:"container:log:".concat(O==null?void 0:O.Id),request:function(){var p=g()(i()().mark(function h(d){var l;return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,G.Tb)({id:(l=O.Id)!==null&&l!==void 0?l:"",lineTotal:d.lineTotal,download:d.download,showTime:d.showTime});case 2:case"end":return s.stop()}},h)}));return function(h){return p.apply(this,arguments)}}(),download:function(){var p=g()(i()().mark(function h(d){var l,v,s,w;return i()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,G.XH)({id:(l=O.Id)!==null&&l!==void 0?l:"",lineTotal:d.lineTotal,showTime:d.showTime});case 2:return s=T.sent,T.next=5,(0,I.jV)({md5:(v=O.Id)!==null&&v!==void 0?v:""});case 5:return w=T.sent,T.abrupt("return",{data:new Blob([s],{type:"text/plain"}),name:w.data.info.Name.replaceAll("/","")+"_"+new Date().toLocaleDateString()+".log"});case 7:case"end":return T.stop()}},h)}));return function(h){return p.apply(this,arguments)}}()})})]})}),C=se,oe=e(65913),k=e(14245),A=e(1699);function ie(){return _jsx(ProCard,{ghost:!0,title:_jsx(TagOutlined,{}),subTitle:"\u5BB9\u5668\u6807\u7B7E",extra:_jsx(ProFormSelect,{width:300,mode:"tags",placeholder:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"}),children:_jsx(Space,{wrap:!0,children:_jsx(Tag,{color:"blue",closable:!0,style:{height:35,display:"flex",borderRadius:20,justifyContent:"center",alignItems:"center"},children:_jsx("span",{style:{paddingLeft:10,paddingRight:3},children:"\u6548\u7387"})})})})}var E=(0,o.forwardRef)(function(r,u){var c;(0,o.useImperativeHandle)(u,function(){return{show:function(v){return g()(i()().mark(function s(){return i()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return h(!0),D.next=3,d(v);case 3:case"end":return D.stop()}},s)}))()}}});var f=(0,L.useAccess)(),j=(0,o.useRef)(),M=(0,o.useState)(),Z=_()(M,2),n=Z[0],O=Z[1],ne=(0,o.useState)(!1),U=_()(ne,2),p=U[0],h=U[1],d=function(){var l=g()(i()().mark(function v(s){var w,D;return i()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return(w=j.current)===null||w===void 0||w.show(),X.next=3,(0,I.jV)({md5:s}).finally(function(){var W;(W=j.current)===null||W===void 0||W.destroy()});case 3:D=X.sent,D.data&&(D.data.info.HostConfig.NetworkMode=="host"&&D.data.info.Config.ExposedPorts&&Object.keys(D.data.info.Config.ExposedPorts).map(function(W){D.data.info.NetworkSettings.Ports[W]=[{HostIp:"0.0.0.0",HostPort:W.substring(0,W.indexOf("/"))}]}),O(D.data));case 5:case"end":return X.stop()}},v)}));return function(s){return l.apply(this,arguments)}}();return(0,a.jsx)(B.Z,{title:"\u5FEB\u6377\u67E5\u770B\u5BB9\u5668 - ".concat((0,b.fi)((c=n==null?void 0:n.info.Name)!==null&&c!==void 0?c:"","/")),open:p,onClose:function(){h(!1),r.onFinish&&r.onFinish()},width:800,extra:(0,a.jsxs)(A.u,{access:"canSeeContainerList",space:{split:(0,a.jsx)(V.Z,{type:"vertical"})},children:[(n==null?void 0:n.info)&&n.info.State.Running&&(0,a.jsx)(q,{containerInfo:n.info}),(n==null?void 0:n.info)&&f.canSeeContainerListManageOp&&(0,a.jsx)(t,{containerInfo:n.info}),(n==null?void 0:n.info)&&n.info.State.Running&&(0,a.jsx)(C,{containerInfo:n.info,showTriggerButton:!0}),(0,a.jsx)(A.u,{access:"canSeeContainerListManage",children:(0,a.jsx)(x.Z,{title:"\u67E5\u770B\u5B8C\u6574\u4FE1\u606F",children:(0,a.jsx)(L.Link,{to:"/app/detail/edit/"+(n==null?void 0:n.info.Id),children:(0,a.jsx)(N.Z,{})},"detail")})})]}),children:(0,a.jsx)(oe.Z,{ref:j,children:(0,a.jsxs)(R.Z,{vertical:!0,gap:20,children:[n&&(0,a.jsx)(A.u,{access:"canSeeContainerList",children:(0,a.jsx)(ae.Z,{ghost:!0,data:n==null?void 0:n.info,onFinish:g()(i()().mark(function l(){return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,d(n.info.Id);case 2:return s.t0=s.sent,s.abrupt("return",[s.t0]);case 4:case"end":return s.stop()}},l)}))})}),n&&(0,a.jsx)(A.u,{access:["canSeeContainerListManage","canSeeContainerListManageOp"],children:(0,a.jsx)(te.Z,{ghost:!0,data:n,checkContainerUpgrade:function(){h(!1),r.onUpgradeFinish&&r.onUpgradeFinish()}})}),!1,n&&(0,a.jsx)(H.Z,{data:n,ghost:!0}),(0,a.jsx)(z.Z,{data:n==null?void 0:n.info,ghost:!0}),n&&(0,a.jsx)(k.Z,{data:n.info,ghost:!0})]})})})}),m=E},81146:function(le,F,e){var K=e(15009),_=e.n(K),y=e(99289),i=e.n(y),$=e(97857),g=e.n($),o=e(67294),H=e(97269),I=e(62370),L=e(5966),N=e(97462),B=e(82346),V=e(71230),x=e(15746),R=e(34041),z=e(28036),ae=e(84567),te=e(42075),re=e(54964),J=e(80821),Q=e(23430),Y=e(93162),b=e.n(Y),a=e(12320),ue=e.n(a),q=e(78267),de=e.n(q),ee=e(75458),ce=e.n(ee),t=e(85893),P=new a.Terminal(g()(g()({},re.a),{},{fontSize:12})),S=new q.FitAddon,G=new ee.SearchAddon,se=(0,o.forwardRef)(function(C,oe){(0,o.useImperativeHandle)(oe,function(){return{fit:function(){P.clear(),S.fit()},start:function(){return i()(_()().mark(function m(){return _()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,ie({lineTotal:500});case 2:case"end":return u.stop()}},m)}))()},close:function(){A.progress.close(C.id)}}});var k=(0,o.useRef)(),A=(0,B.useModel)("subscriber");A.addDataHandler(C.id,function(E){P.write(E.data.replaceAll(`
`,`

`))});var ie=function(){var E=i()(_()().mark(function m(r){return _()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return P.clear(),r.download=!1,c.next=4,C.request(r);case 4:case"end":return c.stop()}},m)}));return function(r){return E.apply(this,arguments)}}();return(0,o.useEffect)(function(){return window.addEventListener("resize",function(){S.fit()}),P.loadAddon(S),P.open(document.getElementById("terminal-container-log")),S.fit(),function(){P.clear(),P.reset(),A.progress.close(C.id)}},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H.A,{submitter:!1,layout:"horizontal",onValuesChange:function(m,r){ie({id:C.id,lineTotal:parseInt(r.lineTotal),showTime:r.showTime})},formRef:k,children:(0,t.jsxs)(V.Z,{gutter:[10,0],children:[(0,t.jsx)(x.Z,{span:8,children:(0,t.jsx)(I.Z,{name:"lineTotal",initialValue:"500",label:"\u83B7\u53D6\u65E5\u5FD7\u6761\u6570",children:(0,t.jsxs)(R.Z,{defaultValue:"500",children:[(0,t.jsx)(R.Z.Option,{value:"100",children:"100\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(R.Z.Option,{value:"200",children:"200\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(R.Z.Option,{value:"500",children:"500\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(R.Z.Option,{value:"1000",children:"1000\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(R.Z.Option,{value:"-1",children:"\u5168\u90E8\uFF08\u4E0B\u8F7D\u53EF\u89C1\uFF09"})]})})}),(0,t.jsx)(x.Z,{children:(0,t.jsx)(z.ZP,{onClick:function(){P.clear()},children:"\u6E05\u5C4F"})}),(0,t.jsx)(x.Z,{children:(0,t.jsx)(I.Z,{name:"showTime",valuePropName:"checked",children:(0,t.jsx)(ae.Z,{children:"\u663E\u793A\u65F6\u95F4"})})}),(0,t.jsx)(x.Z,{children:(0,t.jsx)(L.Z,{label:"\u67E5\u627E",name:"keywork"})}),(0,t.jsx)(x.Z,{children:(0,t.jsx)(N.Z,{name:["keywork"],children:function(m){var r=m.keywork;return(0,t.jsxs)(te.Z,{size:10,children:[(0,t.jsx)(z.ZP,{onClick:function(){G.findNext(r)},children:"\u4E0B\u4E00\u4E2A"},"next"),(0,t.jsx)(z.ZP,{onClick:function(){G.findPrevious(r)},children:"\u4E0A\u4E00\u4E2A"},"prev")]})}})}),(0,t.jsx)(x.Z,{children:(0,t.jsx)(J.Z,{icon:(0,t.jsx)(Q.Z,{}),action:i()(_()().mark(function E(){var m,r,u;return _()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!C.download){f.next=5;break}return f.next=3,C.download({lineTotal:parseInt((m=k.current)===null||m===void 0?void 0:m.getFieldValue("lineTotal")),showTime:(r=k.current)===null||r===void 0?void 0:r.getFieldValue("showTime")});case 3:u=f.sent,(0,Y.saveAs)(u.data,u.name);case 5:case"end":return f.stop()}},E)})),children:"\u4E0B\u8F7D\u65E5\u5FD7"})})]})}),(0,t.jsx)("div",{style:{marginTop:"20px",height:C.showInDrawer?"75vh":"580px"},id:"terminal-container-log"})]})});F.Z=se},65913:function(le,F,e){var K=e(5574),_=e.n(K),y=e(74330),i=e(67294),$=e(85893),g=(0,i.forwardRef)(function(o,H){(0,i.useImperativeHandle)(H,function(){return{show:function(){B(!0)},destroy:function(){B(!1)}}});var I=(0,i.useState)(!1),L=_()(I,2),N=L[0],B=L[1];return(0,$.jsx)(y.Z,{spinning:N,size:"default",children:o.children})});F.Z=g}}]);
