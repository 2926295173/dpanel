"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9626],{69626:function(Ee,ye,n){n.d(ye,{Z:function(){return pn}});var Ce=n(19632),v=n.n(Ce),je=n(5574),j=n.n(je),k=n(15009),d=n.n(k),pe=n(99289),T=n.n(pe),u=n(67294),_=n(80821),O=n(90098),xe=n(52209),b=n(86548),re=n(43425),Q=n(74842),ve=n(48689),L=n(33160),we=n(87784),ie=n(30159),Se=n(25035),W=n(38345),ue=n(97269),oe=n(86615),V=n(62370),B=n(82346),Fe=n(85265),H=n(42075),he=n(96074),q=n(25593),ce=n(83062),Re=n(40056),le=n(84567),Pe=n(28036),c=n(99861),s=n(91058),N=n(79245),r=n(60940),Be=n(55241),be=n(78451),We=n(37413),Ke=n(94359),Ge=n(91806),Ne=n(60433),Ue=n(89035),Qe=n(99922),ze=n(46357),Ye=n(87662),He=n(5251),K=n(36146),e=n(85893);function Xe(o){var ee=(0,u.useState)(""),z=j()(ee,2),U=z[0],X=z[1],E=(0,u.useRef)(),Z=(0,u.useRef)(),$=(0,u.useState)(!1),f=j()($,2),x=f[0],t=f[1],M=new K.Uo("components.appCompose");return(0,u.useEffect)(function(){(0,Ye.K3)().then(function(g){var h;X((h=g.data.serverUrl)!==null&&h!==void 0?h:"")}),t(!1)},[o.containerList]),o.containerList&&(0,e.jsxs)(W.Z,{ghost:!0,title:(0,e.jsx)(Ge.Z,{}),subTitle:M.format("detailContainerTitle"),extra:o.enableSelectService&&(0,e.jsx)(le.Z,{onChange:function(h){t(h.target.checked)},children:M.format("selectService")},"selectService"),children:[(0,e.jsx)(Qe.Z,{showFileExplorer:!0,ref:E}),(0,e.jsx)(ze.Z,{ref:Z}),(0,e.jsx)(r.Z,{scroll:{x:"max-content"},rowKey:"service",pagination:!1,columns:[{title:K.FD.format("listName"),dataIndex:"name",width:200,render:function(h,a,y){return(0,e.jsx)(ce.Z,{title:a.service,children:(0,e.jsx)(be.Z,{content:a.name?(0,He.fi)(a.name,"/"):a.service})})}},{title:K.FD.format("listPort"),render:function(h,a,y){var P=[],R=[];return a.publishers&&a.publishers.map(function(D){D.publishedPort?P.push({PrivatePort:D.targetPort,Type:D.protocol,IP:D.url,PublicPort:D.publishedPort}):D.publishedPort&&R.push({PrivatePort:D.targetPort,Type:D.protocol,IP:D.url,PublicPort:D.publishedPort})}),(0,e.jsx)(We.Z,{publicPort:P,privatePort:R,domain:[],serverIp:U})}},{title:K.FD.format("listStatus"),render:function(h,a,y){return(0,e.jsx)(Ke.Z,{status:"container.".concat(a.state),tip:"".concat(a.state," ").concat(a.status)},a.name)}},{title:K.FD.format("listManage"),fixed:"right",render:function(h,a,y){return(0,e.jsxs)(H.Z,{split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[a.name==""&&(0,e.jsx)(Be.Z,{placement:"left",content:(0,e.jsx)(W.Z,{ghost:!0,title:K.FD.format("listManageShowContainerEnv"),children:(0,e.jsx)(H.Z,{direction:"vertical",children:a.environment&&Object.keys(a.environment).map(function(P){if(a.environment&&a.environment[P])return(0,e.jsx)(q.Z.Text,{code:!0,children:"".concat(P,"=").concat(a.environment[P])},P)})})}),children:(0,e.jsx)(Ne.Z,{})}),a.name!=""&&(0,e.jsx)(q.Z.Link,{onClick:function(){var R;(R=Z.current)===null||R===void 0||R.show(a.name)},children:(0,e.jsx)(re.Z,{})},"container"),a.state=="running"&&(0,e.jsx)(q.Z.Link,{onClick:function(){var R;(R=E.current)===null||R===void 0||R.show({url:"/console/container/".concat(a.name),title:a.name})},children:(0,e.jsx)(Ue.Z,{})},"console")]})}}],dataSource:o.containerList,rowSelection:x&&o.containerList?{defaultSelectedRowKeys:o.containerList.map(function(g){return g.service}),onChange:function(h,a,y){o.selectServiceFinish&&o.selectServiceFinish(h)}}:void 0})]})}var Je=n(81146),_e=n(45742),Ze=n(3616),qe=(0,u.forwardRef)(function(o,ee){(0,u.useImperativeHandle)(ee,function(){return{show:function(h){return T()(d()().mark(function a(){return d()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:x(o.composeItem),E(!0);case 2:case"end":return P.stop()}},a)}))()}}});var z=(0,u.useState)(!1),U=j()(z,2),X=U[0],E=U[1],Z=(0,u.useState)(),$=j()(Z,2),f=$[0],x=$[1],t=(0,u.useRef)(),M=new K.Uo("components.appCompose");return(0,e.jsxs)(e.Fragment,{children:[o.showTriggerButton&&(0,e.jsx)(q.Z.Link,{onClick:T()(d()().mark(function g(){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:x(o.composeItem),E(!0);case 2:case"end":return a.stop()}},g)})),children:(0,e.jsx)(ce.Z,{title:K.FD.format("listManageLog"),children:(0,e.jsx)(_e.Z,{})})},"log"),(0,e.jsx)(Fe.Z,{title:M.format("logDrawerTitle"),open:X,forceRender:!0,onClose:function(){E(!1)},afterOpenChange:function(h){if(h)setTimeout(function(){var y,P;(y=t.current)===null||y===void 0||y.start(),(P=t.current)===null||P===void 0||P.fit()},1e3);else{var a;(a=t.current)===null||a===void 0||a.close()}},width:Ze.FK,children:f&&X&&(0,e.jsx)(Je.Z,{ref:t,showInDrawer:!0,id:"compose:log:".concat(String(f.id||f.name)),request:function(){var g=T()(d()().mark(function h(a){var y;return d()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,(0,O.Yz)({id:f.id||f.name,lineTotal:a.lineTotal,download:(y=a.download)!==null&&y!==void 0?y:!1,showTime:a.showTime});case 2:case"end":return R.stop()}},h)}));return function(h){return g.apply(this,arguments)}}(),download:function(){var g=T()(d()().mark(function h(a){var y;return d()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,(0,O.vf)({id:f.id||f.name,lineTotal:a.lineTotal,showTime:a.showTime,download:!0});case 2:return y=R.sent,R.abrupt("return",{data:new Blob([y],{type:"text/plain"}),name:o.composeItem.name+"_"+new Date().toLocaleDateString()+".log"});case 4:case"end":return R.stop()}},h)}));return function(h){return g.apply(this,arguments)}}()})})]})}),en=qe,Me=n(24963),Ae=n(184),nn=n(95213),tn=n(95089),rn=n(92398),an=n(40411);function sn(o){var ee=(0,u.useContext)(Me.Z),z=ee.message,U=(0,u.useRef)(),X=new K.Uo("components.appCompose"),E=new K.Uo("compose");return o.composeItem.yamlList&&(0,e.jsx)(Ae.a,{drawerProps:{width:Ze.R_,destroyOnClose:!0},title:X.format("yamlDrawerTitle"),formRef:U,trigger:(0,e.jsx)(q.Z.Link,{children:(0,e.jsx)(ce.Z,{title:"Yaml",children:"Yaml"})}),onFinish:function(){var Z=T()(d()().mark(function $(f){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,O.im)({id:String(o.composeItem.id?o.composeItem.id:o.composeItem.name),name:o.composeItem.name,type:o.composeItem.setting.type,yaml:f.yaml,yamlOverride:f.yamlOverride});case 2:return t.next=4,(0,O.xC)({yaml:[f.yaml,f.yamlOverride],environment:o.composeItem.setting.environment,id:o.composeItem.id||o.composeItem.name});case 4:return o.onFinish&&o.onFinish(),t.abrupt("return",!0);case 6:case"end":return t.stop()}},$)}));return function($){return Z.apply(this,arguments)}}(),children:(0,e.jsx)(W.Z,{ghost:!0,children:(0,e.jsx)(rn.Z,{items:o.composeItem.yamlList.map(function(Z,$){var f=[{label:E.format("createYaml"),key:"yaml"},{label:(0,e.jsx)(an.Z,{count:Z&&K.FD.format("listInUse"),offset:[15,-5],children:E.format("createYamlOverride")}),key:"yamlOverride"}];return{label:f[$].label,key:f[$].key,children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(V.Z,{hidden:!0,name:f[$].key}),(0,e.jsx)(V.Z,{shouldUpdate:!0,children:function(t){return(0,e.jsx)(tn.ZP,{onFocus:function(){if(f[$].key=="yaml"&&o.composeItem.setting.type=="remoteUrl"){z.error(E.format("createYamlDisableEdit"));return}},readOnly:f[$].key=="yaml"&&o.composeItem.setting.type=="remoteUrl",theme:"dark",minHeight:"550px",value:Z,onChange:function(g){t.setFieldValue(f[$].key,g)},extensions:[nn.RI.yaml()]})}})]})}})})})})}var on=n(65913),Te=n(1699),ln=n(16970),un=n(35887),cn=(0,u.forwardRef)(function(o,ee){(0,u.useImperativeHandle)(ee,function(){return{show:function(){return T()(d()().mark(function x(){var t;return d()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return $(!0),(t=U.current)===null||t===void 0||t.clear(),g.next=4,new Promise(function(h){return setTimeout(function(){var a;(a=U.current)===null||a===void 0||a.fit(),h(!0)},1e3)});case 4:case"end":return g.stop()}},x)}))()},close:function(){var x;$(!1),(x=U.current)===null||x===void 0||x.clear()}}});var z=(0,B.useModel)("subscriber"),U=(0,u.useRef)(),X=(0,u.useState)(!1),E=j()(X,2),Z=E[0],$=E[1];return z.addDataHandler("compose:"+o.id,function(f){var x;(x=U.current)===null||x===void 0||x.write(f.data)}),(0,e.jsx)(W.Z,{hidden:!Z,ghost:!0,title:(0,e.jsx)(Ue.Z,{}),subTitle:"Console",extra:(0,e.jsx)(H.Z,{children:(0,e.jsx)(_.Z,{action:function(){var x;return(x=U.current)===null||x===void 0||x.clear(),(0,O.U_)({})},icon:(0,e.jsx)(ve.Z,{}),danger:!0,onSuccess:function(){},children:K.FD.format("listManageKill")},"kill")}),children:(0,e.jsx)(un.Z,{id:"create-log-".concat(o.id),height:"200px",style:{fontSize:12},ref:U})})}),ke=cn,dn=(0,u.forwardRef)(function(o,ee){var z=(0,u.useState)(!1),U=j()(z,2),X=U[0],E=U[1],Z=new K.Uo("components.appCompose"),$=(0,u.useState)(),f=j()($,2),x=f[0],t=f[1],M=(0,u.useRef)(),g=(0,u.useRef)();return(0,u.useImperativeHandle)(ee,function(){return{show:function(a){var y;E(!0),t(a),(y=M.current)===null||y===void 0||y.setFieldsValue({environment:a.detail.setting.environment})}}}),(0,e.jsxs)(Ae.a,{formRef:M,open:X,drawerProps:{forceRender:!0},title:Z.format("taskDrawerTitle",{name:""}),onOpenChange:function(a){E(a)},children:[(0,e.jsx)(W.Z,{title:(0,e.jsx)(re.Z,{}),subTitle:Z.format("managerTitle"),ghost:!0,children:x&&(0,e.jsx)(H.Z,{wrap:!0,split:(0,e.jsx)(he.Z,{type:"vertical"}),children:(0,e.jsx)(_.Z,{icon:(0,e.jsx)(Q.Z,{}),type:"primary",confirmOnOpenChange:function(a){var y;a&&(!((y=M.current)===null||y===void 0)&&y.resetFields)&&M.current.resetFields()},action:T()(d()().mark(function h(){var a,y,P;return d()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return(a=g.current)===null||a===void 0||a.show(),P=(y=M.current)===null||y===void 0?void 0:y.getFieldValue("environment"),D.next=4,(0,O.Oh)({id:x.detail.name,environment:P,autoRemove:!0});case 4:E(!1),o.onFinish&&o.onFinish(P);case 6:case"end":return D.stop()}},h)})),children:Z.format("managerCreateButton")},"create")})},"operator"),x&&(0,e.jsx)(ke,{ref:g,id:x.detail.name}),(0,e.jsx)(W.Z,{title:Z.format("envTitle"),subTitle:Z.format("envSubTitle"),tooltip:Z.format("envTip"),ghost:!0,children:(0,e.jsx)(s.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,requireValue:!0,showDeleteButton:!1})})]})}),mn=dn,fn=(0,u.forwardRef)(function(o,ee){var z;(0,u.useImperativeHandle)(ee,function(){return{show:function(l){return T()(d()().mark(function m(){var w;return d()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(w=se.current)===null||w===void 0||w.close(),Z(!0),i.prev=2,i.next=5,Ve(l);case 5:i.next=12;break;case 7:i.prev=7,i.t0=i.catch(2),Z(!1),M(void 0),o.onClose&&o.onClose();case 12:case"end":return i.stop()}},m,null,[[2,7]])}))()}}});var U=(0,u.useState)(!1),X=j()(U,2),E=X[0],Z=X[1],$=(0,B.useNavigate)(),f=(0,u.useState)(),x=j()(f,2),t=x[0],M=x[1],g=(0,u.useState)(),h=j()(g,2),a=h[0],y=h[1],P=(0,u.useState)(0),R=j()(P,2),D=R[0],de=R[1],ne=(0,u.useRef)(),ge=(0,u.useRef)(),ae=(0,u.useRef)(),Oe=(0,u.useRef)(),se=(0,u.useRef)(),Le=(0,u.useRef)(),vn=(0,u.useContext)(Me.Z),hn=vn.message,De=(0,B.useAccess)(),F=new K.Uo("components.appCompose"),gn=(0,u.useRef)();function yn(C){return $e.apply(this,arguments)}function $e(){return $e=T()(d()().mark(function C(l){var m,w,S;return d()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(m=se.current)===null||m===void 0?void 0:m.show();case 2:if(!l.pullImageUseDPanel){p.next=6;break}return p.next=5,(w=Oe.current)===null||w===void 0?void 0:w.start();case 5:(S=Oe.current)===null||S===void 0||S.finish();case 6:return p.prev=6,p.next=9,(0,O.Oh)(l);case 9:o.onDeployFinish&&o.onDeployFinish(),p.next=15;break;case 12:p.prev=12,p.t0=p.catch(6),o.onDeployFailed&&o.onDeployFailed(t);case 15:de(D+1);case 16:case"end":return p.stop()}},C,null,[[6,12]])})),$e.apply(this,arguments)}function Ve(C){return Ie.apply(this,arguments)}function Ie(){return Ie=T()(d()().mark(function C(l){var m,w,S,i,p,J,Y;return d()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return(m=Le.current)===null||m===void 0||m.show(),(w=ne.current)===null||w===void 0||w.resetFields(),I.next=4,(0,O.Pn)({id:l}).finally(T()(d()().mark(function G(){var A;return d()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:(A=Le.current)===null||A===void 0||A.destroy();case 1:case"end":return te.stop()}},G)}))).catch(function(G){throw G});case 4:S=I.sent,i=S.data.detail,i.setting.status&&i.setting.status.indexOf("running")>-1&&(i.isRunning=!0),i.setting.status&&i.setting.status.indexOf("paused")>-1&&(i.isPaused=!0),i.setting.status&&i.setting.status.indexOf("exited")>-1&&(i.isExited=!0),i.setting.status&&i.setting.status=="waiting"?i.isDeploy=!1:i.isDeploy=!0,i.setting.status&&i.setting.status.indexOf("created")>-1&&(i.isCreated=!0,i.isDeploy=!1),p=S.data.project,p&&(i.imageList=v()(new Set(Object.keys(p.services).map(function(G){var A;return(A=p.services[G].image)!==null&&A!==void 0?A:""})))),i.containerList=S.data.containerList,(!i.containerList||i.containerList.length==0)&&p&&p.services&&(i.containerList=Object.keys(p.services).map(function(G){return{name:"",service:G,publishers:p.services[G].ports?p.services[G].ports.map(function(A){var fe;return{url:"",targetPort:A.target,publishedPort:parseInt(A.published),protocol:(fe=A.protocol)!==null&&fe!==void 0?fe:""}}):[],state:"waiting",status:"",environment:p.services[G].environment}})),i.containerList&&((J=ne.current)===null||J===void 0||J.setFieldValue("deployServiceName",S.data.detail.setting.deployServiceName)),i.yamlList=S.data.yaml,M(i),y(S.data.task),S.data.yaml&&S.data.yaml.map(function(G){(0,N.m)(G).map(function(A){i.setting.environment&&!i.setting.environment.find(function(fe){return fe.name==A.name})&&i.setting.environment.push(A)})}),S.data.detail.setting.environment&&((Y=ne.current)===null||Y===void 0||Y.setFieldValue("environment",S.data.detail.setting.environment));case 21:case"end":return I.stop()}},C)})),Ie.apply(this,arguments)}return(0,u.useEffect)(function(){D>0&&t&&Ve(t.id||t.name).catch(function(C){Z(!1)})},[D]),(0,e.jsxs)(Fe.Z,{width:Ze.R_,forceRender:!0,extra:t&&t.setting.type!="dangling"&&(0,e.jsxs)(H.Z,{split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[t.isDeploy&&(0,e.jsx)(en,{composeItem:t,showTriggerButton:!0}),De.canSeeComposeListManage&&(0,e.jsx)(ln.Z,{trigger:(0,e.jsx)(q.Z.Link,{children:(0,e.jsx)(xe.Z,{})},"network")},"network-create"),De.canSeeComposeListManage&&(0,e.jsx)(sn,{composeItem:t,onFinish:T()(d()().mark(function C(){return d()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:hn.info(F.format("messageYamlEditFinish")),de(D+1);case 2:case"end":return m.stop()}},C)}))}),De.canSeeComposeListManageCreate&&(0,e.jsx)(B.Link,{to:"/compose/create?id="+(t.id||t.name),children:(0,e.jsx)(ce.Z,{title:F.format("drawerEditButtonTip"),children:(0,e.jsx)(b.Z,{})})})]}),title:(0,e.jsx)(H.Z,{children:F.format("drawerTitle",{name:(z=t==null?void 0:t.name)!==null&&z!==void 0?z:""})}),open:E,onClose:function(){Z(!1),M(void 0),o.onClose&&o.onClose()},children:[(0,e.jsx)(mn,{onFinish:function(l){var m,w,S,i=((m=ne.current)===null||m===void 0?void 0:m.getFieldFormatValue)&&((w=ne.current)===null||w===void 0?void 0:w.getFieldFormatValue("environment"));i==null||i.forEach(function(p,J){var Y=l.find(function(me){return me.name==p.name});Y&&(i[J].value=Y.value)}),!((S=ne.current)===null||S===void 0)&&S.setFieldValue&&ne.current.setFieldValue("environment",i)},ref:gn}),(0,e.jsx)(on.Z,{ref:Le,children:(0,e.jsxs)(W.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,e.jsxs)(W.Z,{title:(0,e.jsx)(re.Z,{}),subTitle:F.format("managerTitle"),ghost:!0,extra:(0,e.jsx)(e.Fragment,{children:t&&t.imageList&&t.imageList.length>0&&(0,e.jsx)(c.Z,{ref:Oe,image:t.imageList})}),children:[t&&t.setting.type=="dangling"&&(0,e.jsx)(Re.Z,{type:"warning",showIcon:!0,description:(0,e.jsxs)("div",{children:[F.format("managerStatusDanglingAlert",{name:t.name})," ",(0,e.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/compose/external",target:"_blank",children:K.FD.format("help")})]})}),t&&t.setting.type!="dangling"&&(0,e.jsxs)(H.Z,{wrap:!0,split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[(0,e.jsx)(Te.u,{access:"canSeeComposeList",children:(0,e.jsx)(_.Z,{icon:(0,e.jsx)(Q.Z,{}),type:"primary",confirmOnOpenChange:function(l){var m;l&&(!((m=ae.current)===null||m===void 0)&&m.resetFields)&&ae.current.resetFields()},confirm:(0,e.jsxs)(H.Z,{style:{width:300},direction:"vertical",children:[(0,e.jsx)(q.Z.Text,{children:F.format("managerCreateTip")}),(0,e.jsxs)(ue.A,{name:"createForm",formRef:ae,layout:"inline",submitter:!1,children:[(0,e.jsx)(oe.Z.Group,{name:"pullImageUse",layout:"vertical",fieldProps:{style:{display:"flex",flexDirection:"column",gap:8}},valueEnum:{useCommand:F.format("managerCreatePullImageUseCommand"),useDPanel:F.format("managerCreatePullImageUseDPanel")}}),(0,e.jsx)(V.Z,{initialValue:!0,name:"createPath",valuePropName:"checked",children:(0,e.jsx)(le.Z,{defaultChecked:!0,children:F.format("managerCreateCreatePath")})}),(0,e.jsx)(V.Z,{initialValue:!0,name:"removeOrphans",valuePropName:"checked",children:(0,e.jsx)(le.Z,{defaultChecked:!0,children:F.format("managerCreateRemoveOrphans")})})]})]}),action:T()(d()().mark(function C(){var l,m,w,S,i,p,J,Y,me,I,G,A;return d()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(I={id:t.id||t.name},(l=ae.current)!==null&&l!==void 0&&l.getFieldValue&&((m=ae.current)===null||m===void 0?void 0:m.getFieldValue("pullImageUse"))=="useDPanel"&&(I.pullImage=!1,I.pullImageUseDPanel=!0),(w=ae.current)!==null&&w!==void 0&&w.getFieldValue&&((S=ae.current)===null||S===void 0?void 0:S.getFieldValue("pullImageUse"))=="useCommand"&&(I.pullImage=!0),G=((i=ne.current)===null||i===void 0?void 0:i.getFieldsFormatValue)&&ne.current.getFieldsFormatValue(),I.environment=G.environment,I.deployServiceName=G.deployServiceName,I.createPath=(p=(J=ae.current)===null||J===void 0?void 0:J.getFieldValue("createPath"))!==null&&p!==void 0?p:!0,I.removeOrphans=(Y=(me=ae.current)===null||me===void 0?void 0:me.getFieldValue("removeOrphans"))!==null&&Y!==void 0?Y:!0,!(t!=null&&t.isDeploy)){te.next=12;break}if(!((A=ae.current)!==null&&A!==void 0&&A.getFieldValue("pullImageUseCommand"))){te.next=12;break}return te.next=12,(0,O.GG)({id:t.id||t.name,op:"pull"});case 12:return te.abrupt("return",yn(I));case 13:case"end":return te.stop()}},C)})),children:F.format(t.isDeploy?"managerUpgradeButton":"managerCreateButton")},"create")}),(t.isDeploy||t.isCreated)&&De.canSeeComposeListManage&&(0,e.jsx)(_.Z,{action:function(){var l;return(l=se.current)===null||l===void 0||l.show(),(0,O.mg)({id:t.id||t.name,deleteImage:!1,deleteData:!1,deleteVolume:!1,deletePath:!1})},onSuccess:function(){de(D+1)},type:"primary",danger:!0,confirm:"notification.confirm.title",icon:(0,e.jsx)(ve.Z,{}),children:F.format("managerDeleteContainerButton")}),t.isDeploy&&(0,e.jsxs)(Te.u,{access:"canSeeComposeList",space:{direction:"horizontal"},children:[(0,e.jsx)(_.Z,{icon:(0,e.jsx)(L.Z,{}),action:T()(d()().mark(function C(){var l;return d()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return(l=se.current)===null||l===void 0||l.show(),w.abrupt("return",(0,O.GG)({id:t.id||t.name,op:"restart"}));case 2:case"end":return w.stop()}},C)})),onSuccess:function(){de(D+1)},children:F.format("managerRestartButton")},"restart"),(0,e.jsx)(_.Z,{action:function(){var l;return(l=se.current)===null||l===void 0||l.show(),(0,O.GG)({id:t.id||t.name,op:"stop"})},icon:(0,e.jsx)(we.Z,{}),disabled:t.isExited,onSuccess:function(){de(D+1)},children:F.format("managerStopButton")}),t.isPaused&&(0,e.jsx)(_.Z,{action:function(){var l;return(l=se.current)===null||l===void 0||l.show(),(0,O.GG)({id:t.id||t.name,op:"unpause"})},onSuccess:function(){de(D+1)},icon:(0,e.jsx)(Q.Z,{}),children:F.format("managerUnpauseButton")}),!t.isPaused&&(0,e.jsx)(_.Z,{action:function(){var l;return(l=se.current)===null||l===void 0||l.show(),(0,O.GG)({id:t.id||t.name,op:"pause"})},onSuccess:function(){de(D+1)},icon:(0,e.jsx)(ie.Z,{}),disabled:!t.isRunning,children:F.format("managerPauseButton")})]}),t.id>0&&De.canSeeComposeListManageDelete&&(0,e.jsx)(_.Z,{type:"primary",action:T()(d()().mark(function C(){var l,m,w,S,i,p,J,Y;return d()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return(l=se.current)===null||l===void 0||l.show(),I.next=3,(0,O.mg)({id:(m=t==null?void 0:t.id)!==null&&m!==void 0?m:t.name,deleteImage:(w=(S=ge.current)===null||S===void 0?void 0:S.getFieldValue("deleteImage"))!==null&&w!==void 0?w:!1,deleteVolume:(i=(p=ge.current)===null||p===void 0?void 0:p.getFieldValue("deleteVolume"))!==null&&i!==void 0?i:!1,deletePath:(J=(Y=ge.current)===null||Y===void 0?void 0:Y.getFieldValue("deletePath"))!==null&&J!==void 0?J:!1,deleteData:!0});case 3:Z(!1),M(void 0),o.onClose&&o.onClose();case 6:case"end":return I.stop()}},C)})),danger:!0,onSuccess:function(){},confirmOnOpenChange:function(){var l;!((l=ge.current)===null||l===void 0)&&l.resetFields&&ge.current.resetFields()},confirm:(0,e.jsxs)(H.Z,{style:{width:240},direction:"vertical",children:[(0,e.jsx)(q.Z.Text,{children:F.format("managerDeleteTaskTip")}),(0,e.jsxs)(ue.A,{formRef:ge,layout:"inline",submitter:!1,children:[(0,e.jsx)(V.Z,{initialValue:!1,name:"deleteImage",valuePropName:"checked",children:(0,e.jsx)(le.Z,{children:F.format("managerDeleteTaskDeleteImage")})}),(0,e.jsx)(V.Z,{addonAfter:(0,e.jsx)(ce.Z,{title:F.format("managerDeleteTaskDeleteVolumeTip"),children:(0,e.jsx)(Se.Z,{})}),initialValue:!1,name:"deleteVolume",valuePropName:"checked",children:(0,e.jsx)(le.Z,{children:F.format("managerDeleteTaskDeleteVolume")})}),(0,e.jsx)(V.Z,{initialValue:!1,name:"deletePath",valuePropName:"checked",children:(0,e.jsx)(le.Z,{children:F.format("managerDeleteTaskDeletePath")})})]})]}),children:F.format("managerDeleteTaskButton")}),o.showBackListButton&&(0,e.jsx)(B.Link,{to:"/compose/list",children:(0,e.jsx)(Pe.ZP,{children:K.Ob.format("compose.list")})})]})]},"operator"),t&&(0,e.jsx)(ke,{ref:se,id:t.id||t.name}),t&&(0,e.jsx)(Xe,{containerList:t.containerList,enableSelectService:!t.isDeploy,selectServiceFinish:function(l){var m;(m=ne.current)===null||m===void 0||m.setFieldValue("deployServiceName",l)}}),(0,e.jsx)(Te.u,{access:"canSeeComposeList",children:(0,e.jsxs)(ue.A,{submitter:!1,formRef:ne,children:[(0,e.jsx)(V.Z,{name:"deployServiceName",hidden:!0}),t&&t.setting.type!="dangling"&&(0,e.jsx)(W.Z,{title:F.format("envTitle"),subTitle:F.format("envSubTitle"),tooltip:F.format("envTip"),ghost:!0,children:(0,e.jsx)(s.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,requireValue:!0,showDeleteButton:!1})})]})})]})})]})}),pn=fn},35887:function(Ee,ye,n){var Ce=n(5574),v=n.n(Ce),je=n(12323),j=n(78267),k=n.n(j),d=n(75458),pe=n.n(d),T=n(67294),u=n(4244),_=n.n(u),O=n(24078),xe=n(85893),b,re,Q,ve=(0,T.forwardRef)(function(L,we){var ie,Se=(0,T.useState)(!0),W=v()(Se,2),ue=W[0],oe=W[1];return(0,T.useEffect)(function(){return b=new u.Terminal(je.X),re=new d.SearchAddon,Q=new j.FitAddon,window.addEventListener("resize",function(){L.showInModal||Q.fit()}),L.style&&L.style.fontSize&&(b.options.fontSize=L.style.fontSize),b.loadAddon(Q),b.loadAddon(re),b.open(document.getElementById(L.id?L.id:"terminal-container")),L.showInModal||Q.fit(),function(){b.reset(),oe(!0)}},[]),(0,T.useImperativeHandle)(we,function(){return{write:function(B){ue&&(Q.fit(),oe(!1)),b.write(B)},clear:function(){b.clear()},getTerminal:function(){return b},findNext:function(B){re.findNext(B)},findPrev:function(B){re.findPrevious(B)},fit:function(){Q.fit()},onData:function(B){return b.onData(B)}}}),(0,xe.jsx)("div",{id:L.id?L.id:"terminal-container",style:{width:L.width?L.width:"100%",height:L.height?L.height:"500px",marginTop:(ie=L.style)===null||ie===void 0?void 0:ie.marginTop}})});ye.Z=ve},90098:function(Ee,ye,n){n.d(ye,{GG:function(){return we},MG:function(){return Fe},Oh:function(){return re},Pn:function(){return _},U_:function(){return V},Yz:function(){return Se},iE:function(){return ce},ik:function(){return xe},im:function(){return d},mg:function(){return ve},pm:function(){return T},tw:function(){return le},vf:function(){return ue},xC:function(){return he}});var Ce=n(15009),v=n.n(Ce),je=n(99289),j=n.n(je),k=n(82346);function d(c){return pe.apply(this,arguments)}function pe(){return pe=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/create",{method:"POST",data:s}));case 1:case"end":return r.stop()}},c)})),pe.apply(this,arguments)}function T(c){return u.apply(this,arguments)}function u(){return u=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/get-list",{method:"POST",data:s}));case 1:case"end":return r.stop()}},c)})),u.apply(this,arguments)}function _(c){return O.apply(this,arguments)}function O(){return O=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/get-task",{method:"POST",data:s}));case 2:case"end":return r.stop()}},c)})),O.apply(this,arguments)}function xe(c){return b.apply(this,arguments)}function b(){return b=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/delete",{method:"POST",data:s}));case 1:case"end":return r.stop()}},c)})),b.apply(this,arguments)}function re(c){return Q.apply(this,arguments)}function Q(){return Q=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/container-deploy",{method:"POST",data:s}));case 2:case"end":return r.stop()}},c)})),Q.apply(this,arguments)}function ve(c){return L.apply(this,arguments)}function L(){return L=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/container-destroy",{method:"POST",data:s}));case 2:case"end":return r.stop()}},c)})),L.apply(this,arguments)}function we(c){return ie.apply(this,arguments)}function ie(){return ie=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/container-ctrl",{method:"POST",data:s}));case 2:case"end":return r.stop()}},c)})),ie.apply(this,arguments)}function Se(c){return W.apply(this,arguments)}function W(){return W=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/container-log",{method:"POST",data:s}));case 2:case"end":return r.stop()}},c)})),W.apply(this,arguments)}function ue(c){return oe.apply(this,arguments)}function oe(){return oe=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.download=!0,s.id=String(s.id),r.next=4,(0,k.request)("/api/app/compose/container-log",{method:"POST",data:s,responseType:"blob"});case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}},c)})),oe.apply(this,arguments)}function V(c){return B.apply(this,arguments)}function B(){return B=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/container-process-kill",{method:"POST",data:s}));case 1:case"end":return r.stop()}},c)})),B.apply(this,arguments)}function Fe(c){return H.apply(this,arguments)}function H(){return H=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/app/compose/get-from-uri",{method:"POST",data:s}));case 1:case"end":return r.stop()}},c)})),H.apply(this,arguments)}function he(c){return q.apply(this,arguments)}function q(){return q=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/parse",{method:"POST",data:s}));case 2:case"end":return r.stop()}},c)})),q.apply(this,arguments)}function ce(c){return Re.apply(this,arguments)}function Re(){return Re=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,k.request)("/api/common/store/deploy",{method:"POST",data:s}));case 1:case"end":return r.stop()}},c)})),Re.apply(this,arguments)}function le(c){return Pe.apply(this,arguments)}function Pe(){return Pe=j()(v()().mark(function c(s){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.id=String(s.id),r.abrupt("return",(0,k.request)("/api/app/compose/download",{method:"POST",data:s,responseType:"blob"}));case 2:case"end":return r.stop()}},c)})),Pe.apply(this,arguments)}}}]);
