"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3917],{80821:function(w,x,e){e.d(x,{Z:function(){return m}});var b=e(5574),c=e.n(b),h=e(24963),v=e(86738),g=e(28036),P=e(83062),r=e(67294),t=e(85893);function m(n){var E=(0,r.useState)(!1),D=c()(E,2),C=D[0],_=D[1],M=(0,r.useContext)(h.Z),O=M.lang,$=M.notice,d=M.message,s=function(){_(!0);var u=n.action();u instanceof Promise?u.then(function(I){if(_(!1),I){typeof n.onSuccess=="function"&&n.onSuccess(I);var U="";n.messageSuccess?typeof n.messageSuccess=="function"?U=n.messageSuccess(I):U=n.messageSuccess.indexOf("notification.")==0?O(n.messageSuccess):n.messageSuccess:U=O("notification.finish"),n.asynced?d.info(U):d.success(U)}}).catch(function(I){_(!1),typeof n.onError=="function"&&n.onError(I)}):_(!1)};return n.confirm?(0,t.jsx)(v.Z,{style:{width:500},title:n.confirmTitle?n.confirmTitle:O("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?O(n.confirm):n.confirm,onConfirm:s,okText:"Yes",cancelText:"No",children:(0,t.jsx)(g.ZP,{disabled:n.disabled,icon:n.icon,loading:C,danger:n.danger,type:n.type,children:n.children})}):(0,t.jsx)(P.Z,{title:n.tips,children:(0,t.jsx)(g.ZP,{style:n.ghost?{padding:0,height:"auto"}:{},disabled:n.disabled,icon:n.icon,loading:C,onClick:s,danger:n.danger,type:n.type,children:n.children})})}},24963:function(w,x,e){var b=e(67294),c=(0,b.createContext)({});x.Z=c},29337:function(w,x,e){e.r(x),e.d(x,{default:function(){return te}});var b=e(15009),c=e.n(b),h=e(99289),v=e.n(h),g=e(5574),P=e.n(g),r=e(24963),t=e(15078),m=e(184),n=e(5966),E=e(97462),D=e(86615),C=e(62370),_=e(82346),M=e(28036),O=e(42075),$=e(25593),d=e(66309),s=e(67294),a=e(85893),u=(0,s.forwardRef)(function(y,G){var z=(0,s.useState)(!1),F=P()(z,2),R=F[0],i=F[1],A=(0,s.useRef)(),Z=(0,s.useContext)(r.Z),f=Z.message,j=Z.notice,l=(0,_.useSearchParams)(),S=P()(l,2),ne=S[0],re=S[1];return(0,s.useImperativeHandle)(G,function(){return{edit:function(p){var o;(o=A.current)===null||o===void 0||o.setFieldsValue({title:p.title,name:p.name,type:p.setting.type,url:p.setting.url,id:p.id}),i(!0)}}}),(0,s.useEffect)(function(){ne.get("op")=="create"&&i(!0)},[]),(0,a.jsxs)(m.a,{name:"create",title:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97",open:R,onOpenChange:function(p){i(p)},drawerProps:{forceRender:!0},formRef:A,trigger:(0,a.jsx)(M.ZP,{type:"primary",children:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97"}),onFinish:function(){var W=v()(c()().mark(function p(o){var B,L,K;return c()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,t.ks)({name:o.name,url:o.url,type:o.type});case 2:if(B=T.sent,!(B&&B.data)){T.next=12;break}return T.next=6,(0,t.$c)({id:o.id,name:o.name,title:o.title,type:o.type,url:o.url,apps:B.data.list});case 6:if(L=T.sent,!(L&&L.data)){T.next=12;break}return f.success("\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\u6210\u529F"),y.onFinish&&y.onFinish(),(K=A.current)===null||K===void 0||K.resetFields(),T.abrupt("return",!0);case 12:case"end":return T.stop()}},p)}));return function(p){return W.apply(this,arguments)}}(),children:[(0,a.jsx)(n.Z,{name:"id",hidden:!0}),(0,a.jsx)(n.Z,{label:"\u540D\u79F0",name:"title",required:!0,rules:[{required:!0}],placeholder:"\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u5E94\u7528\u5546\u5E97"}),(0,a.jsx)(E.Z,{name:["id"],children:function(p){var o=p.id;return(0,a.jsx)(n.Z,{label:"\u6807\u8BC6",name:"name",required:!0,disabled:!!o,rules:[{required:!0}],placeholder:"\u6307\u5B9A\u5546\u5E97\u6807\u8BC6\uFF0C\u7528\u4E8E\u521B\u5EFA\u5546\u5E97\u6587\u4EF6\u5B58\u50A8\u76EE\u5F55"})}}),(0,a.jsx)(D.Z.Group,{name:"type",label:"\u5546\u5E97\u7C7B\u578B",valueEnum:{casaos:"casaos \u5E94\u7528\u5546\u5E97","1panel":"1panel \u5E94\u7528\u5546\u5E97"},fieldProps:{onChange:function(p){var o;(o=A.current)===null||o===void 0||o.resetFields(["url"])}}}),(0,a.jsx)(E.Z,{name:["type"],children:function(p){var o=p.type,B=[],L=[];if(o=="1panel"&&(L=["https://gitee.com/qyg2297248353/appstore-dpanel","https://github.com/1Panel-dev/appstore","https://github.com/okxlin/appstore"],B=[(0,a.jsx)(n.Z,{label:"\u4ED3\u5E93\u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B git \u4ED3\u5E93\u5730\u5740"},"gitUrl")]),o=="portainer"&&(B=[(0,a.jsx)(n.Z,{label:"template.json \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/Lissy93/portainer-templates/blob/main/templates.json"},"jsonUrl")]),o=="casaos"&&(L=["https://play.cuse.eu.org/Cp0204-AppStore-Play.zip"],B=[(0,a.jsx)(n.Z,{label:"zip \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B zip \u5730\u5740"},"zipUrl")]),o&&o!="")return[B,(0,a.jsx)(C.Z,{label:(0,a.jsxs)(O.Z,{children:["\u63A8\u8350\u5546\u5E97",(0,a.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/setting/store?id=%e6%94%af%e6%8c%81%e7%b1%bb%e5%9e%8b",target:"_blank",children:"\u4E09\u65B9\u5546\u5E97\u63A5\u5165\u8BF4\u660E"})]}),children:(0,a.jsx)(O.Z,{wrap:!0,children:L.map(function(K,N){return(0,a.jsx)($.Z.Link,{onClick:function(){var H;(H=A.current)===null||H===void 0||H.setFieldValue("url",K)},children:(0,a.jsx)(d.Z,{color:"cyan",children:K})},N)})})},"recommend")]}})]})}),I=u,U=e(80821),Y=e(5251),V=e(67255),J=e(43425),Q=e(98165),X=e(90078),k=e(10641),q=e(96074),ee=e(83062);function te(){var y=(0,s.useRef)(),G=(0,_.useAccess)(),z=(0,s.useRef)();return(0,a.jsx)(X._z,{header:{extra:[G.canSeeFounder&&(0,a.jsx)(I,{ref:z,onFinish:function(){var R,i;!((R=y.current)===null||R===void 0)&&R.reloadAndRest&&((i=y.current)===null||i===void 0||i.reloadAndRest())}},"create")]},children:(0,a.jsx)(k.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,V.O)(),columns:[{title:"\u6807\u8BC6",dataIndex:"name",width:200},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u5730\u5740",width:500,search:!1,render:function(R,i,A,Z,f){return(0,a.jsx)("a",{href:i.setting.url,target:"_blank",children:(0,a.jsx)(d.Z,{children:i.setting.url})})}},{title:"\u6700\u540E\u66F4\u65B0",width:180,render:function(R,i,A,Z,f){if(i.setting.updatedAt)return(0,Y.ZM)(i.setting.updatedAt*1e3)}},{title:"\u64CD\u4F5C",width:100,search:!1,fixed:"right",render:function(R,i,A,Z,f){return(0,a.jsxs)(O.Z,{split:(0,a.jsx)(q.Z,{type:"vertical"}),children:[(0,a.jsx)($.Z.Link,{onClick:function(){var l;(l=z.current)===null||l===void 0||l.edit(i)},children:(0,a.jsx)(ee.Z,{title:"\u7BA1\u7406",children:(0,a.jsx)(J.Z,{})})},"manage"),(0,a.jsx)(U.Z,{type:"link",icon:(0,a.jsx)(Q.Z,{}),action:function(){var l,S;return(0,t.ks)({id:i.id,name:i.name,url:(l=i.setting.url)!==null&&l!==void 0?l:"",type:(S=i.setting.type)!==null&&S!==void 0?S:""})},onSuccess:function(){var l,S;return!((l=y.current)===null||l===void 0)&&l.reloadAndRest&&((S=y.current)===null||S===void 0||S.reloadAndRest()),!0},onError:function(){var l,S;return!((l=y.current)===null||l===void 0)&&l.reloadAndRest&&((S=y.current)===null||S===void 0||S.reloadAndRest()),!0},children:" "},"upgrade")]})}}],request:function(){var F=v()(c()().mark(function R(i,A,Z){var f;return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,t.eO)({name:i.name,title:i.title});case 2:return f=l.sent,l.abrupt("return",{data:f.data.list,success:!0,total:f.data.list.length});case 4:case"end":return l.stop()}},R)}));return function(R,i,A){return F.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:y,tableAlertOptionRender:function(R){var i=R.selectedRowKeys,A=R.selectedRows;return(0,a.jsx)(O.Z,{size:16,children:(0,a.jsx)(U.Z,{danger:!0,type:"primary",action:function(){return(0,t.Me)({id:A.map(function(f){return f.id})})},onSuccess:function(){var f,j;return!((f=y.current)===null||f===void 0)&&f.reloadAndRest&&((j=y.current)===null||j===void 0||j.reloadAndRest()),!0},onError:function(){var f,j;return!((f=y.current)===null||f===void 0)&&f.reset&&((j=y.current)===null||j===void 0||j.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"},"delete")})}})})}},15078:function(w,x,e){e.d(x,{$c:function(){return P},Me:function(){return _},eO:function(){return D},ks:function(){return t},yL:function(){return O}});var b=e(15009),c=e.n(b),h=e(99289),v=e.n(h),g=e(82346);function P(d){return r.apply(this,arguments)}function r(){return r=v()(c()().mark(function d(s){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,g.request)("/api/common/store/create",{method:"POST",data:s}));case 1:case"end":return u.stop()}},d)})),r.apply(this,arguments)}function t(d){return m.apply(this,arguments)}function m(){return m=v()(c()().mark(function d(s){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,g.request)("/api/common/store/sync",{method:"POST",data:s}));case 1:case"end":return u.stop()}},d)})),m.apply(this,arguments)}function n(d){return E.apply(this,arguments)}function E(){return E=_asyncToGenerator(_regeneratorRuntime().mark(function d(s){return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:s}));case 1:case"end":return u.stop()}},d)})),E.apply(this,arguments)}function D(d){return C.apply(this,arguments)}function C(){return C=v()(c()().mark(function d(s){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,g.request)("/api/common/store/get-list",{method:"POST",data:s}));case 1:case"end":return u.stop()}},d)})),C.apply(this,arguments)}function _(d){return M.apply(this,arguments)}function M(){return M=v()(c()().mark(function d(s){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,g.request)("/api/common/store/delete",{method:"POST",data:s});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},d)})),M.apply(this,arguments)}function O(d){return $.apply(this,arguments)}function $(){return $=v()(c()().mark(function d(s){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,g.request)(s==null?void 0:s.path,{method:"GET"}));case 1:case"end":return u.stop()}},d)})),$.apply(this,arguments)}},5251:function(w,x,e){e.d(x,{FI:function(){return c},NF:function(){return v},ZM:function(){return h},fi:function(){return g}});function b(r){return r.trim()}function c(r){var t="";r<.1*1024?t=r.toFixed(2)+"B":r<.1*1024*1024?t=(r/1024).toFixed(2)+"KB":r<1*1024*1024*1024?t=(r/(1024*1024)).toFixed(2)+"MB":t=(r/(1024*1024*1024)).toFixed(2)+"GB";var m=t+"",n=m.indexOf("."),E=m.substring(n+1,n+3);return E=="00"?m.substring(0,n)+m.substr(n+3,2):t}function h(r){if(r){var t=new Date(r),m=t.getFullYear()+"-",n=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",E=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",D=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",C=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",_=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return m+n+E+D+C+_}}function v(r){if(!r||r=="")return"-";var t=new Date(r),m=t.getUTCFullYear(),n=String(t.getUTCMonth()+1).padStart(2,"0"),E=String(t.getUTCDate()).padStart(2,"0"),D=String(t.getUTCHours()).padStart(2,"0"),C=String(t.getUTCMinutes()).padStart(2,"0"),_=String(t.getUTCSeconds()).padStart(2,"0");return"".concat(m,"-").concat(n,"-").concat(E," ").concat(D,":").concat(C,":").concat(_)}function g(r,t){if(!r||r.length===0)return"";if(t.length===0)return r;for(;r.startsWith(t);)r=r.slice(t.length);return r}function P(r,t){if(!r||r.length===0)return"";if(t.length===0)return r;for(;r.endsWith(t);)r=r.slice(0,r.length-t.length);return r}},67255:function(w,x,e){e.d(x,{O:function(){return b},j:function(){return c}});function b(){var h=localStorage.getItem("dpanel-pagesize");return h=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(h!=null?h:"20")}}function c(h){var v="dpanel-table-column-".concat(h),g={};if(localStorage.getItem(v)){var P;g=JSON.parse((P=localStorage.getItem(v))!==null&&P!==void 0?P:"{}")}return{defaultValue:g,onChange:function(t){localStorage.setItem("dpanel-table-column-".concat(h),JSON.stringify(t))}}}}}]);
