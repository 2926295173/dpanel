"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8022],{91806:function(Y,I,e){e.d(I,{Z:function(){return m}});var B=e(87462),C=e(67294),T={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},f=T,K=e(84089),P=function(V,R){return C.createElement(K.Z,(0,B.Z)({},V,{ref:R,icon:f}))},L=C.forwardRef(P),m=L},44349:function(Y,I,e){var B=e(97857),C=e.n(B),T=e(17186),f=e(5966),K=e(86250),P=e(67294),L=e(85893),m=(0,P.forwardRef)(function(E,V){var R=(0,P.useRef)();(0,P.useImperativeHandle)(V,function(){return{addItem:function(v,Z){var A,_=(A=R.current)===null||A===void 0?void 0:A.getList(),Q=!1;if(_==null||_.map(function(z){if(z.name==v){Q=!0;return}}),!Q){var $;($=R.current)===null||$===void 0||$.add({name:v,value:Z})}},clear:function(){var v;(v=R.current)===null||v===void 0||(v=v.getList())===null||v===void 0||v.map(function(Z,A){var _;(_=R.current)===null||_===void 0||_.remove(A)})}}});var H={};return E.hideCopyButton===!0&&(H.copyIconProps=!1),E.hideDeleteButton===!0&&(H.deleteIconProps=!1),(0,L.jsx)(T.u,C()(C()({initialValue:E.initialValue,label:E.label,name:E.name,actionRef:R,creatorButtonProps:E.showAddButton?{creatorButtonText:E.label?E.label:E.name}:!1,min:E.min?E.min:0},H),{},{children:function(v,Z,A){return(0,L.jsx)(K.Z,{justify:E.justify,gap:E.gap,children:E.items.map(function(_){return _.render?(0,L.jsx)("div",{children:_.render&&_.render(v,Z,A)},"".concat(E.name,"-").concat(_.name,"-").concat(v.key)):(0,L.jsx)(f.Z,{width:_.width,name:_.name,label:_.label,required:_.required,rules:[{required:_.required}],disabled:_.disabled,placeholder:_.placeholder},"".concat(E.name,"-").concat(_.name,"-").concat(v.key))})})}}))});I.Z=m},36435:function(Y,I,e){var B=e(15009),C=e.n(B),T=e(64599),f=e.n(T),K=e(99289),P=e.n(K),L=e(9783),m=e.n(L),E=e(5574),V=e.n(E),R=e(67294),H=e(184),N=e(38345),v=e(97269),Z=e(97321),A=e(97462),_=e(64317),Q=e(5966),$=e(86615),z=e(68602),k=e(28036),U=e(83403),q=e(24963),ee=e(1699),le=e(29177),se=e(1883),_e=e(43425),ne=e(44349),oe=e(3616),J=e(36146),r=e(85893),o=(0,R.forwardRef)(function(b,te){var X=(0,R.useState)(!1),ae=V()(X,2),W=ae[0],G=ae[1],y=(0,R.useRef)(),re=(0,R.useContext)(q.Z),w=re.message,j=(0,R.useState)([]),l=V()(j,2),n=l[0],d=l[1],t=new J.Uo("components.permissionButton"),a=m()(m()(m()(m()(m()({},U.W6.CONTAINER,"Id"),U.W6.APPSTORE,"name"),U.W6.COMPOSE,"name"),U.W6.REGISTRY,"serverAddress"),U.W6.DOCKER_ENV,"name"),O=m()(m()(m()(m()(m()({},U.W6.CONTAINER,"name"),U.W6.APPSTORE,"name"),U.W6.COMPOSE,"name"),U.W6.REGISTRY,"title"),U.W6.DOCKER_ENV,"title"),c=a[b.type],F=O[b.type],i=b.selected.map(function(s){return s[a[b.type]]});return R.useEffect(function(){if(W){if(!b.selected||b.selected.length==0){w.error(J.FD.format("message.noDataSelect")),G(!1);return}(0,z.dP)({permission:{uri:b.type,key:c,value:i}}).then(function(s){var u;(u=y.current)===null||u===void 0||u.setFieldValue("list",Object.keys(s.data.list).map(function(p){return{name:p,type:s.data.list[p].type,users:s.data.list[p].users}}))}),(0,z.lE)().then(function(s){var u,p=(u=s.data)===null||u===void 0||(u=u.list)===null||u===void 0?void 0:u.map(function(D){return{label:D.username,value:D.username}});d(p)})}},[W]),(0,r.jsx)(ee.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,r.jsxs)(H.a,{name:"create",title:t.format("drawerTitle"),open:W,onOpenChange:function(u){if(!u){var p;(p=y.current)===null||p===void 0||p.resetFields()}G(u)},drawerProps:{forceRender:!0,width:oe.R_},formRef:y,trigger:(0,r.jsx)(k.ZP,{icon:(0,r.jsx)(le.Z,{}),children:t.format("drawerTriggerButton")}),onFinish:function(){var s=P()(C()().mark(function u(p){var D,g,h;return C()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:D=f()(p.list),M.prev=1,D.s();case 3:if((g=D.n()).done){M.next=9;break}return h=g.value,M.next=7,(0,z.Db)({usernames:h.users,permissionType:h.type,permission:{uri:b.type,key:c,showKey:F,value:[h.name]}});case 7:M.next=3;break;case 9:M.next=14;break;case 11:M.prev=11,M.t0=M.catch(1),D.e(M.t0);case 14:return M.prev=14,D.f(),M.finish(14);case 17:w.success(J.FD.format("finish")),G(!1),b.onSuccess();case 20:case"end":return M.stop()}},u,null,[[1,11,14,17]])}));return function(u){return s.apply(this,arguments)}}(),children:[(0,r.jsxs)(N.Z,{ghost:!0,title:(0,r.jsx)(se.Z,{}),subTitle:t.format("batchTitle"),children:[(0,r.jsx)(v.A.Item,{name:"type",style:{marginBottom:0},children:(0,r.jsx)(Z.Z.Group,{defaultValue:"admin",onChange:function(u){var p,D,g=(p=y.current)===null||p===void 0?void 0:p.getFieldValue("list");g.forEach(function(h){h.type=u,h.users=[]}),(D=y.current)===null||D===void 0||D.setFieldValue("list",g)},children:["admin","restricted","public"].map(function(s){return(0,r.jsx)(Z.Z,{style:{width:240},title:t.format("dataTypeOption.".concat(s)),description:t.format("dataTypeOptionDesc.".concat(s)),value:s},s)})})}),(0,r.jsx)(A.Z,{name:["type"],children:function(u){var p=u.type;if(p==="restricted")return(0,r.jsx)(_.Z,{mode:"multiple",name:"usernames",label:t.format("formUsernames"),onChange:function(g){var h,x,M=(h=y.current)===null||h===void 0?void 0:h.getFieldValue("list");M.forEach(function(S){S.users=g}),(x=y.current)===null||x===void 0||x.setFieldValue("list",M)},rules:[{required:!0}],request:P()(C()().mark(function D(){var g,h,x;return C()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(n.length>0)){S.next=2;break}return S.abrupt("return",n);case 2:return S.next=4,(0,z.lE)();case 4:return h=S.sent,x=(g=h.data)===null||g===void 0||(g=g.list)===null||g===void 0?void 0:g.map(function(ie){return{label:ie.username,value:ie.username}}),d(x),S.abrupt("return",x);case 8:case"end":return S.stop()}},D)}))})}})]}),(0,r.jsx)(N.Z,{ghost:!0,title:(0,r.jsx)(_e.Z,{}),subTitle:t.format("dataTitle"),children:(0,r.jsx)(ne.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:t.format("dataName"),render:function(u,p,D){var g=D.getCurrentRowData();return(0,r.jsx)(Q.Z,{disabled:!0,label:t.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:t.format("dataType"),render:function(u,p,D){var g=D.getCurrentRowData();return(0,r.jsx)($.Z.Group,{label:t.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(h){return{label:t.format("dataTypeOption.".concat(h)),value:h}})})}},{name:"users",label:t.format("dataUsers"),render:function(u,p,D){return(0,r.jsx)(A.Z,{name:["type"],children:function(h){var x=h.type;if(x=="restricted")return(0,r.jsx)(_.Z,{width:"sm",mode:"tags",name:"users",label:t.format("dataUsers"),options:n})}})}}]})})]})})});I.Z=o},96781:function(Y,I,e){var B=e(67294),C=(0,B.createContext)({});I.Z=C},92922:function(Y,I,e){e.r(I),e.d(I,{default:function(){return b}});var B=e(64599),C=e.n(B),T=e(15009),f=e.n(T),K=e(99289),P=e.n(K),L=e(80821),m=e(90098),E=e(43425),V=e(86548),R=e(23430),H=e(90078),N=e(78099),v=e(82346),Z=e(28036),A=e(25593),_=e(83062),Q=e(66309),$=e(42075),z=e(96074),k=e(67294),U=e(94359),q=e(67255),ee=e(93162),le=e.n(ee),se=e(96781),_e=e(69626),ne=e(1699),oe=e(83403),J=e(36435),r=e(36146),o=e(85893);function b(){var te,X,ae=(0,k.useContext)(se.Z),W=ae.listTableRef,G=(0,k.useRef)(),y=(0,v.useAccess)(),re=(0,v.useLocation)(),w=new r.Uo("compose");return(0,o.jsxs)(H._z,{header:{extra:[(0,o.jsx)(ne.u,{access:"canSeeComposeListManageCreate",children:(0,o.jsx)(v.Link,{to:"/compose/create",reloadDocument:re.search.length>0,children:(0,o.jsx)(Z.ZP,{type:"primary",children:r.Ob.format("compose.create")},"createCompose")},"create")},"create")]},children:[(0,o.jsx)(_e.Z,{ref:G,onClose:function(){var l;!((l=W.current)===null||l===void 0)&&l.reloadAndRest&&W.current.reloadAndRest()}}),(0,o.jsx)(N.Z,{scroll:{x:"max-content"},request:function(){var j=P()(f()().mark(function l(n){var d;return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,m.pm)({title:n.title,name:n.name});case 2:return d=a.sent,a.abrupt("return",{data:d.data.list,success:!0,total:d.data.list.length});case 4:case"end":return a.stop()}},l)}));return function(l){return j.apply(this,arguments)}}(),rowKey:"name",columns:[{title:r.FD.format("listName"),dataIndex:"name",width:200,render:function(l,n,d,t,a){return(0,o.jsx)(A.Z.Link,{onClick:function(){var c;(c=G.current)===null||c===void 0||c.show(n.id||n.name)},children:n.name})},sorter:function(l,n){return l.name.localeCompare(n.name)},sortDirections:["descend","ascend"]},{title:r.FD.format("listTitle"),dataIndex:"title",width:200},{title:r.FD.format("listType"),width:150,search:!1,render:function(l,n,d,t,a){var O,c=n.setting&&n.setting.type?n.setting.type:"default";return(0,o.jsx)(_.Z,{title:(O=n.setting.uri)!==null&&O!==void 0?O:"",children:(0,o.jsx)(Q.Z,{color:w.format("listTypeColor.".concat(c)),children:w.format("listType.".concat(c))})})}},{title:r.FD.format("listStatus"),dataIndex:"status",search:!1,width:300,render:function(l,n,d,t,a){return(0,o.jsx)($.Z,{children:n.setting.status.split(", ").map(function(O,c){var F,i="running",s=O.indexOf("(");return s>-1?i=O.slice(0,s):i=O,(0,o.jsx)(U.Z,{status:"compose.".concat(i),statusValue:{count:O.slice(s+1,O.length-1)},tip:"".concat(O," ").concat((F=n.setting.message)!==null&&F!==void 0?F:"")},c)})})},sorter:function(l,n){return l.setting.status.localeCompare(n.setting.status)}},{title:r.FD.format("listCreatedAt"),dataIndex:"",search:!1,width:150,render:function(l,n,d,t,a){return n.setting.createdAt?new Date(n.setting.createdAt).toLocaleString():"-"},sorter:function(l,n){var d,t;return new Date((d=l.setting.createdAt)!==null&&d!==void 0?d:"").toLocaleString().localeCompare(new Date((t=n.setting.createdAt)!==null&&t!==void 0?t:"").toLocaleString())}},{title:r.FD.format("listUpdatedAt"),dataIndex:"",search:!1,width:150,render:function(l,n,d,t,a){return n.setting.updatedAt?new Date(n.setting.updatedAt).toLocaleString():"-"},sorter:function(l,n){var d,t;return new Date((d=l.setting.updatedAt)!==null&&d!==void 0?d:"").toLocaleString().localeCompare(new Date((t=n.setting.updatedAt)!==null&&t!==void 0?t:"").toLocaleString())}},{title:r.FD.format("listManage"),width:80,valueType:"option",fixed:"right",key:"option",hidden:!y.canSeeComposeListManage,render:function(l,n,d,t,a){return n.setting.type!="dangling"&&(0,o.jsxs)($.Z,{split:(0,o.jsx)(z.Z,{type:"vertical"}),children:[(0,o.jsx)(A.Z.Link,{onClick:function(){var c;(c=G.current)===null||c===void 0||c.show(n.id||n.name)},children:(0,o.jsx)(_.Z,{title:r.FD.format("listManageDetail"),children:(0,o.jsx)(E.Z,{})})},"3"),(0,o.jsx)(v.Link,{to:"/compose/create?id=".concat(n.id||n.name),children:(0,o.jsx)(_.Z,{title:r.FD.format("listManageEdit"),children:(0,o.jsx)(V.Z,{})})}),(0,o.jsx)(A.Z.Link,{onClick:P()(f()().mark(function O(){var c,F;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,m.tw)({id:n.id||n.name});case 2:c=s.sent,F=new Blob([c],{type:"application/zip"}),(0,ee.saveAs)(F,"compose-"+n.name+".zip");case 5:case"end":return s.stop()}},O)})),children:(0,o.jsx)(_.Z,{title:r.FD.format("listManageDownload"),children:(0,o.jsx)(R.Z,{})})},"2")]})}}],rowSelection:y.canSeeComposeListManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0,getCheckboxProps:function(l){return{disabled:l.setting.type=="dangling"||l.setting.type=="outPath"}}}:void 0,tableAlertOptionRender:function(l){var n=l.selectedRows;return(0,o.jsxs)($.Z,{size:16,children:[(0,o.jsx)(J.Z,{type:oe.W6.COMPOSE,selected:n,onSuccess:function(){var t,a;return!((t=W.current)===null||t===void 0)&&t.reloadAndRest&&((a=W.current)===null||a===void 0||a.reloadAndRest()),!0}}),(0,o.jsx)(ne.u,{access:"canSeeComposeListManageDelete",children:(0,o.jsx)(L.Z,{danger:!0,type:"primary",action:P()(f()().mark(function d(){var t,a,O,c;return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.prev=0,a=C()(n),i.prev=2,a.s();case 4:if((O=a.n()).done){i.next=11;break}return c=O.value,i.next=8,(0,m.mg)({id:c.id||c.name});case 8:t=i.sent;case 9:i.next=4;break;case 11:i.next=16;break;case 13:i.prev=13,i.t0=i.catch(2),a.e(i.t0);case 16:return i.prev=16,a.f(),i.finish(16);case 19:i.next=23;break;case 21:i.prev=21,i.t1=i.catch(0);case 23:return i.abrupt("return",(0,m.ik)({id:n.map(function(s){return s.id})}));case 24:case"end":return i.stop()}},d,null,[[0,21],[2,13,16,19]])})),onSuccess:function(){var t,a;return!((t=W.current)===null||t===void 0)&&t.reloadAndRest&&((a=W.current)===null||a===void 0||a.reloadAndRest()),!0},onError:function(){var t,a;return!((t=W.current)===null||t===void 0)&&t.reset&&((a=W.current)===null||a===void 0||a.reset()),!0},confirm:"notification.confirm.title",children:r.FD.format("listManageDeleteBatch")})})]})},pagination:(0,q.O)({page:(te=(X=re.state)===null||X===void 0?void 0:X.page)!==null&&te!==void 0?te:1}),search:{collapsed:!1},actionRef:W,columnsState:(0,q.j)("compose-list")})]})}},67255:function(Y,I,e){e.d(I,{O:function(){return B},j:function(){return C}});function B(T){var f=localStorage.getItem("dpanel-pagesize");return f=="all"?!1:{defaultCurrent:T==null?void 0:T.page,showSizeChanger:!0,defaultPageSize:parseInt(f!=null?f:"20"),onChange:function(P,L){localStorage.setItem("dpanel-page-"+location.pathname.split("/").slice(-2).join("-"),"".concat(P))}}}function C(T){var f="dpanel-table-column-".concat(T),K={};if(localStorage.getItem(f)){var P;K=JSON.parse((P=localStorage.getItem(f))!==null&&P!==void 0?P:"{}")}return{defaultValue:K,onChange:function(m){localStorage.setItem("dpanel-table-column-".concat(T),JSON.stringify(m))}}}}}]);
