"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4202],{45742:function(y,M,e){e.d(M,{Z:function(){return P}});var C=e(87462),i=e(67294),v={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656zM492 400h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zM340 368a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"profile",theme:"outlined"},c=v,m=e(84089),T=function(r,L){return i.createElement(m.Z,(0,C.Z)({},r,{ref:L,icon:c}))},j=i.forwardRef(T),P=j},80821:function(y,M,e){e.d(M,{Z:function(){return D}});var C=e(5574),i=e.n(C),v=e(24963),c=e(86738),m=e(28036),T=e(83062),j=e(67294),P=e(85893);function D(r){var L=(0,j.useState)(!1),u=i()(L,2),O=u[0],a=u[1],s=(0,j.useContext)(v.Z),A=s.lang,f=s.notice,B=s.message,R=function(){a(!0);var g=r.action();g instanceof Promise?g.then(function(h){if(a(!1),h){typeof r.onSuccess=="function"&&r.onSuccess(h);var _="";r.messageSuccess?typeof r.messageSuccess=="function"?_=r.messageSuccess(h):_=r.messageSuccess.indexOf("notification.")==0?A(r.messageSuccess):r.messageSuccess:_=A("notification.finish"),r.asynced?B.info(_):B.success(_)}}).catch(function(h){a(!1),typeof r.onError=="function"&&r.onError(h)}):a(!1)};return r.confirm?(0,P.jsx)(c.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:A("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?A(r.confirm):r.confirm,onConfirm:R,okText:"Yes",cancelText:"No",children:(0,P.jsx)(m.ZP,{disabled:r.disabled,icon:r.icon,loading:O,danger:r.danger,type:r.type,children:r.children})}):(0,P.jsx)(T.Z,{title:r.tips,children:(0,P.jsx)(m.ZP,{style:r.ghost?{padding:0,height:"auto"}:{},disabled:r.disabled,icon:r.icon,loading:O,onClick:R,danger:r.danger,type:r.type,children:r.children})})}},94359:function(y,M,e){e.d(M,{Z:function(){return O}});var C=e(67294),i=e(3089),v=e(98165),c=e(18429),m=e(8751),T=e(14313),j=e(30159),P=e(87740),D=e(66309),r=e(83062),L=e(82346),u=e(85893);function O(a){var s=(0,u.jsx)(u.Fragment,{});if(a.status=="0"&&(s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(i.Z,{}),color:"default",children:"waiting"})),a.status=="10"&&(s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(v.Z,{spin:!0}),color:"processing",children:"processing"})),a.status=="20"&&(s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(c.Z,{}),color:"error",children:"error"})),a.status=="30"&&(s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(m.Z,{}),color:"success",children:"success"})),a.status=="running"||a.status=="healthy"){var A,f;s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(T.Z,{}),color:"success",children:(A=a.message)!==null&&A!==void 0&&A.showInTag?(f=a.message)===null||f===void 0?void 0:f.content:a.status})}if(a.status=="paused"){var B,R;s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(j.Z,{}),children:(B=a.message)!==null&&B!==void 0&&B.showInTag?(R=a.message)===null||R===void 0?void 0:R.content:a.status})}if(a.status=="waiting"||a.status=="starting"){var W,g;s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(P.Z,{}),children:(W=a.message)!==null&&W!==void 0&&W.showInTag?(g=a.message)===null||g===void 0?void 0:g.content:a.status})}if(a.status=="exited"||a.status=="dead"||a.status=="removing"||a.status=="restarting"||a.status=="unhealthy"||a.status=="created"){var h,_;s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(c.Z,{}),color:"warning",children:(h=a.message)!==null&&h!==void 0&&h.showInTag?(_=a.message)===null||_===void 0?void 0:_.content:a.status})}if(a.link&&(s=(0,u.jsx)(L.Link,{to:a.link,children:s})),a.message){var t;s=(0,u.jsx)(r.Z,{placement:(t=a.message.placement)!==null&&t!==void 0?t:"top",title:a.message.content,children:s})}return(0,u.jsx)(u.Fragment,{children:s})}},74344:function(y,M,e){var C=e(5574),i=e.n(C),v=e(37476),c=e(38345),m=e(82346),T=e(67294),j=e(54964),P=e(85893),D=(0,T.forwardRef)(function(r,L){(0,T.useImperativeHandle)(L,function(){return{start:function(){for(var _=arguments.length,t=new Array(_),E=0;E<_;E++)t[E]=arguments[E];R(t.join(":")),s(!0)},reset:function(){var _;(_=g.current)===null||_===void 0||_.clear(),s(!1)},show:function(_){var t,E;(t=g.current)===null||t===void 0||t.clear(),(E=g.current)===null||E===void 0||E.write(_),s(!0)}}});var u=(0,T.useState)(!1),O=i()(u,2),a=O[0],s=O[1],A=(0,T.useState)(""),f=i()(A,2),B=f[0],R=f[1],W=(0,m.useModel)("subscriber"),g=(0,T.useRef)();return W.addDataHandler("image:"+B,function(h){var _;(_=g.current)===null||_===void 0||_.write(h.data)}),(0,T.useEffect)(function(){var h;(h=g.current)===null||h===void 0||h.fit()},[]),(0,P.jsx)(v.Y,{modalProps:{forceRender:!0},title:"\u6784\u5EFA\u65E5\u5FD7",submitter:!1,width:1e3,onOpenChange:function(_){if(s(_),_){var t,E;(t=g.current)===null||t===void 0||t.clear(),(E=g.current)===null||E===void 0||E.fit()}},open:a,children:(0,P.jsx)(c.Z,{ghost:!0,children:(0,P.jsx)(j.Z,{showInModal:!0,width:"960px",height:"500px",ref:g})})})});M.Z=D},78451:function(y,M,e){e.d(M,{Z:function(){return v}});var C=e(67294),i=e(85893);function v(c){return(0,i.jsx)("span",{style:{width:c.width?c.width:"auto",wordBreak:"break-word"},children:c.content})}},54964:function(y,M,e){e.d(M,{a:function(){return u}});var C=e(5574),i=e.n(C),v=e(78267),c=e.n(v),m=e(75458),T=e.n(m),j=e(67294),P=e(12320),D=e.n(P),r=e(89629),L=e(85893),u={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},O=new P.Terminal(u),a=new m.SearchAddon,s=new v.FitAddon,A=(0,j.forwardRef)(function(f,B){var R,W=(0,j.useState)(!0),g=i()(W,2),h=g[0],_=g[1];return(0,j.useEffect)(function(){return window.addEventListener("resize",function(){f.showInModal||s.fit()}),f.style&&f.style.fontSize&&(O.options.fontSize=f.style.fontSize),O.loadAddon(s),O.loadAddon(a),O.open(document.getElementById(f.id?f.id:"terminal-container")),f.showInModal||s.fit(),function(){O.reset(),_(!0)}},[]),(0,j.useImperativeHandle)(B,function(){return{write:function(E){h&&(s.fit(),_(!1)),O.write(E)},clear:function(){O.clear()},getTerminal:function(){return O},findNext:function(E){a.findNext(E)},findPrev:function(E){a.findPrevious(E)},fit:function(){s.fit()},onData:function(E){return O.onData(E)}}}),(0,L.jsx)("div",{id:f.id?f.id:"terminal-container",style:{width:f.width?f.width:"100%",height:f.height?f.height:"500px",marginTop:(R=f.style)===null||R===void 0?void 0:R.marginTop}})});M.Z=A},24963:function(y,M,e){var C=e(67294),i=(0,C.createContext)({});M.Z=i},52548:function(y,M,e){e.r(M),e.d(M,{default:function(){return E}});var C=e(15009),i=e.n(C),v=e(99289),c=e.n(v),m=e(90078),T=e(10641),j=e(28036),P=e(42075),D=e(83062),r=e(66309),L=e(96074),u=e(25593),O=e(50136),a=e(82346),s=e(18148),A=e(94359),f=e(43425),B=e(45742),R=e(80821),W=e(67294),g=e(67255),h=e(78451),_=e(74344),t=e(85893);function E(){var l=(0,W.useRef)(),I=(0,W.useRef)();return(0,t.jsxs)(m._z,{header:{extra:[(0,t.jsx)(j.ZP,{type:"primary",children:(0,t.jsx)(a.Link,{to:"/image/create",children:"\u521B\u5EFA\u955C\u50CF"})},"create"),(0,t.jsx)(j.ZP,{children:"\u62C9\u53D6\u955C\u50CF"},"pull")]},children:[(0,t.jsx)(T.Z,{scroll:{x:"max-content"},actionRef:l,rowKey:"id",columns:[{title:"\u540D\u79F0",render:function(n,d,K,U){return(0,t.jsx)(P.Z,{direction:"vertical",style:{textAlign:"left"},children:d.imageInfo&&d.imageInfo.info.Id?(0,t.jsx)(a.Link,{to:"/image/detail/".concat(d.imageInfo.info.Id),children:(0,t.jsxs)(D.Z,{title:"\u67E5\u770B\u955C\u50CF",children:[" ",d.title]})},"detail"):d.title},d.id)}},{title:"\u6700\u65B0Tag",dataIndex:"tag",search:!1,render:function(n,d,K,U){return d.imageInfo?d.imageInfo.info.Id==""?(0,t.jsx)(r.Z,{children:"none"},"none"):(0,t.jsx)(P.Z,{direction:"vertical",style:{textAlign:"left"},children:d.imageInfo.info.RepoTags.map(function(x,S){return(0,t.jsx)(r.Z,{color:"#2db7f5",children:x},S)})},d.id):(0,t.jsx)(r.Z,{color:"#2db7f5",children:d.tag},d.id)}},{title:"\u955C\u50CFId",search:!1,copyable:!0,width:300,render:function(n,d,K,U,x){return(0,t.jsx)(h.Z,{content:d.imageInfo&&d.imageInfo.info.Id})}},{title:"\u6784\u5EFA\u72B6\u6001",width:150,ellipsis:!0,search:!1,render:function(n,d,K,U){return[(0,t.jsx)("div",{children:(0,t.jsx)(A.Z,{status:d.status},d.id)},d.id)]}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,fixed:"right",render:function(n,d,K,U){return(0,t.jsxs)(P.Z,{split:(0,t.jsx)(L.Z,{type:"vertical"}),children:[(0,t.jsx)(a.Link,{to:"/image/create?id="+d.id,type:"link",children:(0,t.jsx)(D.Z,{title:"\u518D\u6B21\u6784\u5EFA",children:(0,t.jsx)(f.Z,{})})},"rebuild"),(0,t.jsx)(u.Z.Link,{onClick:function(){var S;(S=I.current)===null||S===void 0||S.show(d.message)},children:(0,t.jsx)(D.Z,{title:"\u6784\u5EFA\u65E5\u5FD7",children:(0,t.jsx)(B.Z,{})})},"logs")]})}}],request:function(){var o=c()(i()().mark(function n(d,K,U){var x,S,b;return i()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,s.Xn)({page:(x=d.current)!==null&&x!==void 0?x:1,pageSize:(S=d.pageSize)!==null&&S!==void 0?S:10});case 2:return b=Z.sent,Z.abrupt("return",{data:b.data.list,success:!0,total:b.data.total});case 4:case"end":return Z.stop()}},n)}));return function(n,d,K){return o.apply(this,arguments)}}(),pagination:(0,g.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(n){var d=n.selectedRowKeys;return(0,t.jsx)(P.Z,{size:16,children:(0,t.jsx)(R.Z,{danger:!0,type:"primary",action:function(){return(0,s.$q)({id:d})},onSuccess:function(){var U,x;return!((U=l.current)===null||U===void 0)&&U.reloadAndRest&&((x=l.current)===null||x===void 0||x.reloadAndRest()),!0},onError:function(){var U,x;return!((U=l.current)===null||U===void 0)&&U.reset&&((x=l.current)===null||x===void 0||x.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"})})},tableExtraRender:function(){return(0,t.jsx)(O.Z,{mode:"horizontal",selectedKeys:["build"],items:[{label:(0,t.jsx)(a.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,t.jsx)(a.Link,{to:"/image/list/build",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})}}),(0,t.jsx)(_.Z,{ref:I})]})}},18148:function(y,M,e){e.d(M,{$q:function(){return a},Fj:function(){return h},KG:function(){return T},KX:function(){return t},T8:function(){return u},Xn:function(){return r},ao:function(){return A},c5:function(){return W},c7:function(){return B}});var C=e(15009),i=e.n(C),v=e(99289),c=e.n(v),m=e(82346);function T(l){return j.apply(this,arguments)}function j(){return j=c()(i()().mark(function l(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/app/image/get-list",{method:"POST",data:I}));case 1:case"end":return n.stop()}},l)})),j.apply(this,arguments)}function P(l){return D.apply(this,arguments)}function D(){return D=_asyncToGenerator(_regeneratorRuntime().mark(function l(I){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,request("/api/app/log/image-build",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},l)})),D.apply(this,arguments)}function r(l){return L.apply(this,arguments)}function L(){return L=c()(i()().mark(function l(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/app/image/get-list-build",{method:"POST",data:I}));case 1:case"end":return n.stop()}},l)})),L.apply(this,arguments)}function u(l){return O.apply(this,arguments)}function O(){return O=c()(i()().mark(function l(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,m.request)("/api/app/image/get-build-task",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},l)})),O.apply(this,arguments)}function a(l){return s.apply(this,arguments)}function s(){return s=c()(i()().mark(function l(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,m.request)("/api/app/image/delete-build-task",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},l)})),s.apply(this,arguments)}function A(l){return f.apply(this,arguments)}function f(){return f=c()(i()().mark(function l(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,m.request)("/api/app/image/image-delete",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},l)})),f.apply(this,arguments)}function B(){return R.apply(this,arguments)}function R(){return R=c()(i()().mark(function l(){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,m.request)("/api/app/image/image-prune",{method:"POST"});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},l)})),R.apply(this,arguments)}function W(){return g.apply(this,arguments)}function g(){return g=c()(i()().mark(function l(){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,m.request)("/api/app/image/build-prune",{method:"POST"});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},l)})),g.apply(this,arguments)}function h(l){return _.apply(this,arguments)}function _(){return _=c()(i()().mark(function l(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,m.request)("/api/app/image/update-title",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},l)})),_.apply(this,arguments)}function t(l){return E.apply(this,arguments)}function E(){return E=c()(i()().mark(function l(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/app/image/tag-sync",{method:"POST",data:I}));case 1:case"end":return n.stop()}},l)})),E.apply(this,arguments)}},67255:function(y,M,e){e.d(M,{O:function(){return C},j:function(){return i}});function C(){var v=localStorage.getItem("dpanel-pagesize");return v=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(v!=null?v:"20")}}function i(v){var c="dpanel-table-column-".concat(v),m={};if(localStorage.getItem(c)){var T;m=JSON.parse((T=localStorage.getItem(c))!==null&&T!==void 0?T:"{}")}return{defaultValue:m,onChange:function(P){localStorage.setItem("dpanel-table-column-".concat(v),JSON.stringify(P))}}}}}]);
