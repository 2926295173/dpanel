"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7667],{99861:function(H,y,e){var L=e(15009),s=e.n(L),T=e(64599),p=e.n(T),c=e(99289),h=e.n(c),E=e(5574),K=e.n(E),m=e(83062),C=e(14726),P=e(42119),j=e(67294),g=e(92754),M=e(3393),f=e(184),i=e(38345),l=e(85893),B=(0,j.forwardRef)(function(o,F){(0,j.useImperativeHandle)(F,function(){return{}});var b=(0,j.useState)(0),Z=K()(b,2),S=Z[0],G=Z[1],W=(0,j.useRef)();return(0,l.jsxs)(f.a,{trigger:(0,l.jsx)(m.Z,{title:"\u5F53\u90E8\u7F72\u65F6\u65E0\u6CD5\u6B63\u5E38\u62C9\u53D6\u955C\u50CF\u65F6\uFF0C\u53EF\u4EE5\u624B\u52A8\u4F7F\u7528\u9762\u677F\u7684\u4ED3\u5E93\u52A0\u901F\u529F\u80FD\u62C9\u53D6\u6240\u6709\u955C\u50CF",children:(0,l.jsx)(C.ZP,{children:o.title?o.title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF"})}),width:800,submitter:!1,title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",onOpenChange:function(){var u=h()(s()().mark(function d(R){var n,w,$,Y,N,z,Q;return s()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(!R){O.next=25;break}w=0,$=p()(o.image),O.prev=3,$.s();case 5:if((Y=$.n()).done){O.next=15;break}return z=Y.value,G(w),(N=W.current)===null||N===void 0||N.setStart(),O.next=11,(0,M.Gb)({tag:z,type:"pull"});case 11:Q=O.sent,w++;case 13:O.next=5;break;case 15:O.next=20;break;case 17:O.prev=17,O.t0=O.catch(3),$.e(O.t0);case 20:return O.prev=20,$.f(),O.finish(20);case 23:(n=W.current)===null||n===void 0||n.setFinish(),G(w);case 25:case"end":return O.stop()}},d,null,[[3,17,20,23]])}));return function(d){return u.apply(this,arguments)}}(),children:[(0,l.jsx)(i.Z,{children:(0,l.jsx)(P.Z,{current:S,items:o.image.map(function(u,d){return{title:u,key:d}})})}),(0,l.jsx)(i.Z,{children:(0,l.jsx)(g.Z,{ref:W})})]})});y.Z=B},92754:function(H,y,e){var L=e(5574),s=e.n(L),T=e(67294),p=e(54006),c=e(38703),h=e(85893),E=(0,T.forwardRef)(function(K,m){(0,T.useImperativeHandle)(m,function(){return{setFinish:function(){M({finish:{downloading:100,extracting:100}})},setStart:function(){M({start:{downloading:0,extracting:0}})}}});var C=(0,p.useModel)("subscriber");C.addDataHandler("imageDownload",function(){var f=C.getDataByType("imageDownload"),i=f.pop();i&&M(i.data)});var P=(0,T.useState)(),j=s()(P,2),g=j[0],M=j[1];return(0,T.useEffect)(function(){M({start:{downloading:0,extracting:0}})},[]),(0,h.jsx)(h.Fragment,{children:g&&Object.keys(g).map(function(f){return(0,h.jsx)(c.Z,{percent:g[f].downloading,success:{percent:g[f].extracting}},f)})})});y.Z=E},54964:function(H,y,e){var L=e(78267),s=e.n(L),T=e(75458),p=e.n(T),c=e(67294),h=e(12320),E=e.n(h),K=e(89629),m=e(85893),C=new h.Terminal({convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}}),P=new T.SearchAddon,j=new L.FitAddon,g=(0,c.forwardRef)(function(M,f){return(0,c.useEffect)(function(){C.loadAddon(j),C.loadAddon(P),C.open(document.getElementById("terminal-container")),j.fit()},[]),(0,c.useImperativeHandle)(f,function(){return{write:function(l){C.write(l)},clear:function(){C.clear()},getTerminal:function(){return C},findNext:function(l){P.findNext(l)},findPrev:function(l){P.findPrevious(l)}}}),(0,m.jsx)("div",{id:"terminal-container",style:{width:M.width?M.width:"100%",height:M.height?M.height:"500px"}})});y.Z=g},97964:function(H,y,e){e.r(y),e.d(y,{default:function(){return O}});var L=e(15009),s=e.n(L),T=e(99289),p=e.n(T),c=e(5574),h=e.n(c),E=e(80821),K=e(54964),m=e(90098),C=e(43425),P=e(74842),j=e(87784),g=e(33160),M=e(30159),f=e(45742),i=e(86548),l=e(91806),B=e(38345),o=e(184),F=e(54006),b=e(42075),Z=e(96074),S=e(60922),G=e(84567),W=e(14726),u=e(40056),d=e(32983),R=e(85265),n=e(67294),w=e(7297),$=e(99861),Y=e(1272),N=e(95089),z=e(95213),Q=e(24963),a=e(85893);function O(){var V=(0,n.useContext)(Q.Z),q=V.loading,Pe=V.message,ge=V.notice,ue=(0,F.useParams)(),oe=(0,F.useNavigate)(),ie=(0,n.useState)(),ee=h()(ie,2),t=ee[0],le=ee[1],de=(0,n.useState)([]),ne=h()(de,2),ce=ne[0],me=ne[1],pe=(0,n.useState)({deleteImage:!1,deleteData:!1}),te=h()(pe,2),J=te[0],Ee=te[1],I=(0,n.useRef)(),fe=(0,n.useState)(0),re=h()(fe,2),ae=re[0],ve=re[1],De=(0,n.useState)(!1),se=h()(De,2),he=se[0],A=se[1],X=(0,n.useRef)(),_e=(0,F.useModel)("subscriber");return _e.addDataHandler("composeUp",function(){var D=_e.getDataByType("composeUp"),r=D.pop();if(r){var _;(_=I.current)===null||_===void 0||_.write(r.data)}}),(0,n.useEffect)(function(){var D,r;q.show(),(D=I.current)===null||D===void 0||D.clear(),(0,m.YZ)({name:(r=ue.name)!==null&&r!==void 0?r:""}).then(function(_){var x,v=_.data.detail;if(v.setting.status&&v.setting.status.indexOf("running")>-1&&(v.isRunning=!0),v.setting.status&&v.setting.status.indexOf("paused")>-1&&(v.isPaused=!0),v.setting.status&&v.setting.status=="waiting"||v.yaml==""?v.isDeploy=!1:v.isDeploy=!0,v.yaml){var k=Y.ZP.load(v.yaml);v.imageList=Object.keys(k.services).map(function(U){return k.services[U].image}),_.data.containerList&&me(_.data.containerList.map(function(U){return"/"+U.name}))}le(v),(x=X.current)===null||x===void 0||x.reload()}).finally(function(){q.destroy()})},[ae]),(0,a.jsxs)(B.Z,{direction:"column",gutter:[10,10],children:[(0,a.jsx)(B.Z,{title:(0,a.jsx)(C.Z,{}),subTitle:"\u64CD\u4F5C - "+(t==null?void 0:t.name),ghost:!0,children:t!=null&&t.id?(0,a.jsxs)(b.Z,{wrap:!0,children:[t.isDeploy&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.Z,{icon:(0,a.jsx)(P.Z,{}),action:function(){var r,_;return(r=I.current)===null||r===void 0||r.clear(),A(!0),(0,m.GG)({id:(_=t==null?void 0:t.id)!==null&&_!==void 0?_:0,op:"start"})},disabled:(t==null?void 0:t.isRunning)||t.isPaused,messageSuccess:"\u542F\u52A8\u6210\u529F",children:"\u542F\u52A8"}),(0,a.jsx)(E.Z,{action:function(){var r,_;return(r=I.current)===null||r===void 0||r.clear(),A(!0),(0,m.GG)({id:(_=t==null?void 0:t.id)!==null&&_!==void 0?_:0,op:"stop"})},messageSuccess:"\u505C\u6B62\u6210\u529F",icon:(0,a.jsx)(j.Z,{}),disabled:!t.isRunning,children:"\u505C\u6B62"}),(0,a.jsx)(E.Z,{action:function(){var r,_;return(r=I.current)===null||r===void 0||r.clear(),A(!0),(0,m.GG)({id:(_=t==null?void 0:t.id)!==null&&_!==void 0?_:0,op:"restart"})},messageSuccess:"\u91CD\u542F\u6210\u529F",icon:(0,a.jsx)(g.Z,{}),children:"\u91CD\u542F"}),(0,a.jsx)(E.Z,{action:function(){var r,_;return(r=I.current)===null||r===void 0||r.clear(),A(!0),(0,m.GG)({id:(_=t==null?void 0:t.id)!==null&&_!==void 0?_:0,op:"pause"})},messageSuccess:"\u6682\u505C\u6210\u529F",icon:(0,a.jsx)(M.Z,{}),disabled:!t.isRunning,children:"\u6682\u505C"}),(0,a.jsx)(E.Z,{action:function(){var r,_;return(r=I.current)===null||r===void 0||r.clear(),A(!0),(0,m.GG)({id:(_=t==null?void 0:t.id)!==null&&_!==void 0?_:0,op:"unpause"})},messageSuccess:"\u6062\u590D\u6210\u529F",icon:(0,a.jsx)(P.Z,{}),disabled:!(t!=null&&t.isPaused),children:"\u6062\u590D"}),(0,a.jsx)(E.Z,{action:function(){var r,_;return(r=I.current)===null||r===void 0||r.clear(),A(!0),(0,m.GG)({id:(_=t==null?void 0:t.id)!==null&&_!==void 0?_:0,op:"logs"})},messageSuccess:"\u83B7\u53D6\u6210\u529F",icon:(0,a.jsx)(f.Z,{}),children:"\u65E5\u5FD7"}),(0,a.jsx)(Z.Z,{type:"vertical"})]}),(0,a.jsx)($.Z,{title:t.isDeploy?"\u4E00\u952E\u66F4\u65B0\u955C\u50CF":"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",image:t.imageList}),(0,a.jsx)(E.Z,{type:"primary",action:p()(s()().mark(function D(){var r,_,x,v;return s()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if((r=I.current)===null||r===void 0||r.clear(),A(!0),!t.isDeploy){U.next=6;break}return U.next=5,(0,m.mg)({id:(x=t==null?void 0:t.id)!==null&&x!==void 0?x:0,deleteImage:!1,deleteData:!1});case 5:v=U.sent;case 6:return U.next=8,(0,m.Oh)({id:(_=t==null?void 0:t.id)!==null&&_!==void 0?_:0});case 8:return U.abrupt("return",U.sent);case 9:case"end":return U.stop()}},D)})),messageSuccess:"\u6267\u884C\u6210\u529F\uFF0C\u8BF7\u5728\u63A7\u5236\u53F0\u4E2D\u7ED3\u679C\u7ED3\u679C",children:t.isDeploy?"\u91CD\u65B0\u90E8\u7F72":"\u90E8\u7F72\u5BB9\u5668"}),t.isDeploy&&(0,a.jsx)(E.Z,{type:"primary",action:p()(s()().mark(function D(){var r,_;return s()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:(r=I.current)===null||r===void 0||r.clear(),A(!0),(0,m.mg)({id:(_=t==null?void 0:t.id)!==null&&_!==void 0?_:0,deleteImage:J.deleteImage,deleteData:J.deleteData}),J.deleteData&&oe("/compose/list");case 4:case"end":return v.stop()}},D)})),danger:!0,confirm:(0,a.jsxs)(b.Z,{style:{width:280},direction:"vertical",children:[(0,a.jsx)(S.Z.Text,{children:"\u5220\u9664\u5BB9\u5668\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"}),(0,a.jsx)(G.Z,{name:"deleteImage",onChange:function(r){return Ee({deleteImage:r.target.checked,deleteData:J.deleteData})},children:"\u5220\u9664\u955C\u50CF\uFF1F"})]}),children:"\u9500\u6BC1\u5BB9\u5668"}),(0,a.jsx)(Z.Z,{type:"vertical"}),(0,a.jsx)(W.ZP,{onClick:function(){A(!0)},children:"\u63A7\u5236\u53F0"}),(0,a.jsx)(o.a,{drawerProps:{forceRender:!0},submitter:!1,trigger:(0,a.jsx)(W.ZP,{children:"Yaml"}),title:(0,a.jsxs)(b.Z,{children:[(0,a.jsx)("span",{children:"Compose Yaml"}),(0,a.jsx)("div",{})]}),children:(0,a.jsx)(N.ZP,{theme:"dark",minHeight:"550px",value:t.yaml,extensions:[z.RI.yaml()]})}),(0,a.jsx)(F.Link,{to:"/compose/create?id="+t.id+"&name="+t.name,children:(0,a.jsx)(W.ZP,{icon:(0,a.jsx)(i.Z,{}),children:"\u7F16\u8F91"})})]}):(0,a.jsx)(u.Z,{showIcon:!0,type:"info",message:"\u65E0\u6CD5\u83B7\u53D6\u8BE5\u4EFB\u52A1\u7684 compose.yaml \u6587\u4EF6\uFF0C\u65E0\u7BA1\u7406\u6743\u9650\u3002".concat(t&&t.setting&&t.setting.uri?"\u8BF7\u6302\u8F7D\u6587\u4EF6 "+t.setting.uri:"")})},"operator"),(0,a.jsx)(B.Z,{ghost:!0,title:(0,a.jsx)(l.Z,{}),subTitle:"\u5BB9\u5668\u7EC4",children:t!=null&&t.isDeploy?(0,a.jsx)(w.Z,{showLite:!0,searchNameList:ce,ref:X}):(0,a.jsx)(d.Z,{image:d.Z.PRESENTED_IMAGE_SIMPLE})}),(0,a.jsxs)(R.Z,{open:he,width:850,title:"\u63A7\u5236\u53F0\u65E5\u5FD7",forceRender:!0,onClose:function(){var r;A(!1),ve(ae+1),(r=X.current)===null||r===void 0||r.reload()},extra:(0,a.jsx)(E.Z,{type:"primary",action:function(){var r;return(r=I.current)===null||r===void 0||r.clear(),(0,m.U_)({})},danger:!0,children:"\u4E2D\u6B62\u6267\u884C"}),footer:!1,children:[(0,a.jsx)(u.Z,{showIcon:!0,style:{marginBottom:"20px"},message:"\u5982\u679C\u62C9\u53D6\u955C\u50CF\u5931\u8D25\uFF0C\u8BF7\u914D\u7F6E\u4ED3\u5E93\u52A0\u901F\u5730\u5740\uFF0C\u4F7F\u7528\u3010\u4E00\u952E\u62C9\u53D6\u955C\u50CF\u3011\u529F\u80FD\u540E\u518D\u5C1D\u8BD5\u90E8\u7F72\u3002"}),(0,a.jsx)(K.Z,{ref:I})]})]})}},90098:function(H,y,e){e.d(y,{GG:function(){return B},MG:function(){return Z},Oh:function(){return M},U_:function(){return F},YZ:function(){return C},ik:function(){return j},im:function(){return h},mg:function(){return i},pm:function(){return K},xC:function(){return G}});var L=e(15009),s=e.n(L),T=e(99289),p=e.n(T),c=e(54006);function h(u){return E.apply(this,arguments)}function E(){return E=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/create",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),E.apply(this,arguments)}function K(u){return m.apply(this,arguments)}function m(){return m=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-list",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),m.apply(this,arguments)}function C(u){return P.apply(this,arguments)}function P(){return P=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-detail",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),P.apply(this,arguments)}function j(u){return g.apply(this,arguments)}function g(){return g=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/delete",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),g.apply(this,arguments)}function M(u){return f.apply(this,arguments)}function f(){return f=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-deploy",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),f.apply(this,arguments)}function i(u){return l.apply(this,arguments)}function l(){return l=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-destroy",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),l.apply(this,arguments)}function B(u){return o.apply(this,arguments)}function o(){return o=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-ctrl",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),o.apply(this,arguments)}function F(u){return b.apply(this,arguments)}function b(){return b=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-process-kill",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),b.apply(this,arguments)}function Z(u){return S.apply(this,arguments)}function S(){return S=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-from-uri",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),S.apply(this,arguments)}function G(u){return W.apply(this,arguments)}function W(){return W=p()(s()().mark(function u(d){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/parse",{method:"POST",data:d}));case 1:case"end":return n.stop()}},u)})),W.apply(this,arguments)}},3393:function(H,y,e){e.d(y,{Gb:function(){return K},Pn:function(){return j},Rb:function(){return M},YU:function(){return h},_U:function(){return C}});var L=e(15009),s=e.n(L),T=e(99289),p=e.n(T),c=e(54006);function h(i){return E.apply(this,arguments)}function E(){return E=p()(s()().mark(function i(l){return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,c.request)("/api/app/image/get-detail",{method:"POST",data:l}));case 1:case"end":return o.stop()}},i)})),E.apply(this,arguments)}function K(i){return m.apply(this,arguments)}function m(){return m=p()(s()().mark(function i(l){return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,c.request)("/api/app/image/tag-remote",{method:"POST",data:l}));case 1:case"end":return o.stop()}},i)})),m.apply(this,arguments)}function C(i){return P.apply(this,arguments)}function P(){return P=p()(s()().mark(function i(l){return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,c.request)("/api/app/image/tag-add",{method:"POST",data:l}));case 1:case"end":return o.stop()}},i)})),P.apply(this,arguments)}function j(i){return g.apply(this,arguments)}function g(){return g=p()(s()().mark(function i(l){return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,c.request)("/api/app/image/tag-delete",{method:"POST",data:l}));case 1:case"end":return o.stop()}},i)})),g.apply(this,arguments)}function M(i){return f.apply(this,arguments)}function f(){return f=p()(s()().mark(function i(l){return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,c.request)("/api/app/image/export",{method:"POST",data:l,responseType:"blob"}));case 1:case"end":return o.stop()}},i)})),f.apply(this,arguments)}}}]);
