"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{1699:function(k,y,e){e.d(y,{u:function(){return C}});var Z=e(9783),M=e.n(Z),F=e(97857),I=e.n(F),N=e(67294),B=e(82346),U=e(40411),O=e(42075),a=e(85893),C=function(n){var j=(0,B.useAccess)(),r=Array.isArray(n.access)?n.access:[n.access],t,i=n.fallback;if(typeof n.children=="function"?(t=n.children(r.reduce(function(_,A){return I()(I()({},_),{},M()({},A,j[A]))},{})),t||(t=i)):r.every(function(_){return j[_]})?t=n.children:t=i,!i&&t&&n.showProTips&&j.canSeeEnableCe){if(j.canSeeEnableHiddenProTips)return null;t=(0,a.jsx)(U.Z,{offset:n.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:t})}if(!i&&t&&n.showProRibbonTips&&j.canSeeEnableCe){if(j.canSeeEnableHiddenProTips)return null;t=(0,a.jsx)(U.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:t})}return n.space?(0,a.jsx)(O.Z,I()(I()({},n.space),{},{children:t})):t}},80821:function(k,y,e){e.d(y,{Z:function(){return d}});var Z=e(97857),M=e.n(Z),F=e(5574),I=e.n(F),N=e(24963),B=e(86738),U=e(28036),O=e(83062),a=e(67294),C=e(85893);function d(n){var j=(0,a.useState)(!1),r=I()(j,2),t=r[0],i=r[1],_=(0,a.useContext)(N.Z),A=_.lang,p=_.message,K=function(){i(!0);var s=n.action();s instanceof Promise?s.then(function($){if(i(!1),$){typeof n.onSuccess=="function"&&n.onSuccess($);var h="";n.messageSuccess?typeof n.messageSuccess=="function"?h=n.messageSuccess($):h=n.messageSuccess.indexOf("notification.")==0?A(n.messageSuccess):n.messageSuccess:h=A("notification.finish"),n.asynced?p.info(h):p.success(h)}}).catch(function($){i(!1),typeof n.onError=="function"&&n.onError($)}):i(!1)};return n.confirm?(0,C.jsx)(B.Z,M()(M()({style:{width:500},title:n.confirmTitle?n.confirmTitle:A("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?A(n.confirm):n.confirm,onConfirm:K,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,C.jsx)(U.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&t?void 0:n.icon,loading:t,danger:n.danger,type:n.type,children:n.children})})):(0,C.jsx)(O.Z,{title:n.tips,children:(0,C.jsx)(U.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&t?void 0:n.icon,loading:t,onClick:K,danger:n.danger,type:n.type,children:n.children})})}},44349:function(k,y,e){var Z=e(97857),M=e.n(Z),F=e(17186),I=e(5966),N=e(86250),B=e(67294),U=e(85893),O=(0,B.forwardRef)(function(a,C){var d=(0,B.useRef)();(0,B.useImperativeHandle)(C,function(){return{addItem:function(r,t){var i,_=(i=d.current)===null||i===void 0?void 0:i.getList(),A=!1;if(_==null||_.map(function(K){if(K.name==r){A=!0;return}}),!A){var p;(p=d.current)===null||p===void 0||p.add({name:r,value:t})}},clear:function(){var r;(r=d.current)===null||r===void 0||(r=r.getList())===null||r===void 0||r.map(function(t,i){var _;(_=d.current)===null||_===void 0||_.remove(i)})}}});var n={};return a.hideCopyButton===!0&&(n.copyIconProps=!1),a.hideDeleteButton===!0&&(n.deleteIconProps=!1),(0,U.jsx)(F.u,M()(M()({initialValue:a.initialValue,label:a.label,name:a.name,actionRef:d,creatorButtonProps:a.showAddButton?{creatorButtonText:"\u6DFB\u52A0"+(a.label?a.label:a.name)}:!1,min:a.min?a.min:0},n),{},{children:function(r,t,i){return(0,U.jsx)(N.Z,{justify:a.justify,gap:a.gap,children:a.items.map(function(_){return _.render?(0,U.jsx)("div",{children:_.render&&_.render(r,t,i)},"".concat(a.name,"-").concat(_.name,"-").concat(r.key)):(0,U.jsx)(I.Z,{width:_.width,name:_.name,label:_.label,required:_.required,rules:[{required:_.required}],disabled:_.disabled,placeholder:_.placeholder},"".concat(a.name,"-").concat(_.name,"-").concat(r.key))})})}}))});y.Z=O},36435:function(k,y,e){var Z=e(15009),M=e.n(Z),F=e(64599),I=e.n(F),N=e(99289),B=e.n(N),U=e(9783),O=e.n(U),a=e(5574),C=e.n(a),d=e(67294),n=e(184),j=e(38345),r=e(97269),t=e(97321),i=e(97462),_=e(64317),A=e(5966),p=e(86615),K=e(68602),G=e(28036),s=e(83403),$=e(24963),h=e(1699),J=e(29177),H=e(45742),ee=e(43425),ne=e(44349),_e=e(3616),Q=e(36146),E=e(85893),w=(0,d.forwardRef)(function(L,X){var q=(0,d.useState)(!1),Y=C()(q,2),g=Y[0],f=Y[1],P=(0,d.useRef)(),W=(0,d.useContext)($.Z),V=W.message,l=(0,d.useState)([]),T=C()(l,2),z=T[0],te=T[1],b=new Q.Uo("components.permissionButton"),ae=O()(O()(O()(O()(O()({},s.W6.CONTAINER,"Id"),s.W6.APPSTORE,"name"),s.W6.COMPOSE,"name"),s.W6.REGISTRY,"serverAddress"),s.W6.DOCKER_ENV,"name"),le=O()(O()(O()(O()(O()({},s.W6.CONTAINER,"name"),s.W6.APPSTORE,"name"),s.W6.COMPOSE,"name"),s.W6.REGISTRY,"title"),s.W6.DOCKER_ENV,"title"),se=ae[L.type],oe=le[L.type],ie=L.selected.map(function(u){return u[ae[L.type]]});return d.useEffect(function(){if(g){if(!L.selected||L.selected.length==0){V.error(Q.FD.format("message.noDataSelect")),f(!1);return}(0,K.dP)({permission:{uri:L.type,key:se,value:ie}}).then(function(u){var o;(o=P.current)===null||o===void 0||o.setFieldValue("list",Object.keys(u.data.list).map(function(c){return{name:c,type:u.data.list[c].type,users:u.data.list[c].users}}))}),(0,K.lE)().then(function(u){var o,c=(o=u.data)===null||o===void 0||(o=o.list)===null||o===void 0?void 0:o.map(function(m){return{label:m.username,value:m.username}});te(c)})}},[g]),(0,E.jsx)(h.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,E.jsxs)(n.a,{name:"create",title:b.format("drawerTitle"),open:g,onOpenChange:function(o){if(!o){var c;(c=P.current)===null||c===void 0||c.resetFields()}f(o)},drawerProps:{forceRender:!0,width:_e.R_},formRef:P,trigger:(0,E.jsx)(G.ZP,{icon:(0,E.jsx)(J.Z,{}),children:b.format("drawerTriggerButton")}),onFinish:function(){var u=B()(M()().mark(function o(c){var m,R,v;return M()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:m=I()(c.list),D.prev=1,m.s();case 3:if((R=m.n()).done){D.next=9;break}return v=R.value,D.next=7,(0,K.Db)({usernames:v.users,permissionType:v.type,permission:{uri:L.type,key:se,showKey:oe,value:[v.name]}});case 7:D.next=3;break;case 9:D.next=14;break;case 11:D.prev=11,D.t0=D.catch(1),m.e(D.t0);case 14:return D.prev=14,m.f(),D.finish(14);case 17:V.success(Q.FD.format("finish")),f(!1),L.onSuccess();case 20:case"end":return D.stop()}},o,null,[[1,11,14,17]])}));return function(o){return u.apply(this,arguments)}}(),children:[(0,E.jsxs)(j.Z,{ghost:!0,title:(0,E.jsx)(H.Z,{}),subTitle:b.format("batchTitle"),children:[(0,E.jsx)(r.A.Item,{name:"type",style:{marginBottom:0},children:(0,E.jsx)(t.Z.Group,{defaultValue:"admin",onChange:function(o){var c,m,R=(c=P.current)===null||c===void 0?void 0:c.getFieldValue("list");R.forEach(function(v){v.type=o,v.users=[]}),(m=P.current)===null||m===void 0||m.setFieldValue("list",R)},children:["admin","restricted","public"].map(function(u){return(0,E.jsx)(t.Z,{style:{width:240},title:b.format("dataTypeOption.".concat(u)),description:b.format("dataTypeOptionDesc.".concat(u)),value:u},u)})})}),(0,E.jsx)(i.Z,{name:["type"],children:function(o){var c=o.type;if(c==="restricted")return(0,E.jsx)(_.Z,{mode:"multiple",name:"usernames",label:b.format("formUsernames"),onChange:function(R){var v,x,D=(v=P.current)===null||v===void 0?void 0:v.getFieldValue("list");D.forEach(function(S){S.users=R}),(x=P.current)===null||x===void 0||x.setFieldValue("list",D)},rules:[{required:!0}],request:B()(M()().mark(function m(){var R,v,x;return M()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(z.length>0)){S.next=2;break}return S.abrupt("return",z);case 2:return S.next=4,(0,K.lE)();case 4:return v=S.sent,x=(R=v.data)===null||R===void 0||(R=R.list)===null||R===void 0?void 0:R.map(function(re){return{label:re.username,value:re.username}}),te(x),S.abrupt("return",x);case 8:case"end":return S.stop()}},m)}))})}})]}),(0,E.jsx)(j.Z,{ghost:!0,title:(0,E.jsx)(ee.Z,{}),subTitle:b.format("dataTitle"),children:(0,E.jsx)(ne.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:b.format("dataName"),render:function(o,c,m){var R=m.getCurrentRowData();return(0,E.jsx)(A.Z,{disabled:!0,label:b.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:b.format("dataType"),render:function(o,c,m){var R=m.getCurrentRowData();return(0,E.jsx)(p.Z.Group,{label:b.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(v){return{label:b.format("dataTypeOption.".concat(v)),value:v}})})}},{name:"users",label:b.format("dataUsers"),render:function(o,c,m){return(0,E.jsx)(i.Z,{name:["type"],children:function(v){var x=v.type;if(x=="restricted")return(0,E.jsx)(_.Z,{width:"sm",mode:"tags",name:"users",label:b.format("dataUsers"),options:z})}})}}]})})]})})});y.Z=w},64312:function(k,y,e){e.r(y),e.d(y,{default:function(){return $}});var Z=e(15009),M=e.n(Z),F=e(99289),I=e.n(F),N=e(80821),B=e(77273),U=e(36435),O=e(83403),a=e(24963),C=e(87662),d=e(36146),n=e(86548),j=e(90078),r=e(41482),t=e(82346),i=e(28036),_=e(42075),A=e(96074),p=e(25593),K=e(83062),G=e(67294),s=e(85893);function $(){var h=(0,G.useRef)(),J=(0,G.useRef)(),H=(0,t.useModel)("@@initialState"),ee=H.initialState,ne=H.loading,_e=H.error,Q=H.refresh,E=H.setInitialState,w=(0,G.useContext)(a.Z),L=w.message,X=(0,t.useLocation)(),q=(0,t.useNavigate)(),Y=new d.Uo("system.env");return(0,G.useEffect)(function(){var g=X.state;if(g&&g.item){var f;(f=J.current)===null||f===void 0||f.edit(g.item)}},[X.state]),(0,s.jsx)(j._z,{header:{extra:[(0,s.jsx)(B.Z,{trigger:(0,s.jsx)(i.ZP,{type:"primary",children:Y.format("createButton")}),ref:J,onFinish:I()(M()().mark(function g(){var f,P,W;return M()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(W=X.state,!(W&&W.item)){l.next=6;break}return l.next=4,(0,C.vC)({name:W.item.name});case 4:return q(X.pathname,{replace:!0,state:null}),l.abrupt("return");case 6:Q(),!((f=h.current)===null||f===void 0)&&f.reloadAndRest&&((P=h.current)===null||P===void 0||P.reloadAndRest());case 8:case"end":return l.stop()}},g)}))},"dockerEnvCreate")]},children:(0,s.jsx)(r.Z,{rowKey:"name",columns:[{title:Y.format("listName"),dataIndex:"name"},{title:Y.format("listTitle"),dataIndex:"title"},{title:Y.format("listAddress"),dataIndex:"address"},{title:d.FD.format("operation"),width:100,search:!1,render:function(f,P,W,V,l){return(0,s.jsx)(_.Z,{split:(0,s.jsx)(A.Z,{type:"vertical"}),children:(0,s.jsx)(p.Z.Link,{onClick:function(){var z;(z=J.current)===null||z===void 0||z.edit(P)},children:(0,s.jsx)(K.Z,{title:d.FD.format("edit"),children:(0,s.jsx)(n.Z,{})})},P.name)})}}],pagination:!1,request:I()(M()().mark(function g(){var f;return M()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,(0,C.Kg)();case 2:return f=W.sent,W.abrupt("return",{data:f.data.list,total:f.data.list.length});case 4:case"end":return W.stop()}},g)})),search:!1,rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:h,tableAlertOptionRender:function(f){var P=f.selectedRows,W=f.selectedRowKeys;return(0,s.jsxs)(_.Z,{size:16,children:[(0,s.jsx)(U.Z,{type:O.W6.DOCKER_ENV,selected:P,onSuccess:function(){var l,T;return!((l=h.current)===null||l===void 0)&&l.reloadAndRest&&((T=h.current)===null||T===void 0||T.reloadAndRest()),!0}},"permissionButton"),(0,s.jsx)(N.Z,{danger:!0,type:"primary",action:function(){return P.find(function(l){return l.default})?(L.warning(d.FD.format("systemEnvDefaultCannotDelete")),!1):(0,C._g)({name:W})},onSuccess:function(){var l,T;return!((l=h.current)===null||l===void 0)&&l.reloadAndRest&&((T=h.current)===null||T===void 0||T.reloadAndRest()),!0},onError:function(){var l,T;return!((l=h.current)===null||l===void 0)&&l.reset&&((T=h.current)===null||T===void 0||T.reset()),!0},confirm:"notification.confirm.title",children:d.FD.format("deleteBatch")})]})}})})}}}]);
