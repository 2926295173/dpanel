"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3158],{99922:function(oe,L,e){var U=e(97857),r=e.n(U),I=e(15009),d=e.n(I),A=e(99289),K=e.n(A),j=e(5574),y=e.n(j),p=e(67294),Y=e(85265),O=e(42075),i=e(28036),C=e(49610),F=e(3616),R=e(93362),S=e(90581),g=e(5251),D=e(85893),B=(0,p.forwardRef)(function(c,ne){var T,w,v=(0,p.useRef)(),Q=(0,p.useRef)(),de=(0,p.useState)(!1),ie=y()(de,2),me=ie[0],ae=ie[1],te=(0,p.useState)(),Z=y()(te,2),l=Z[0],P=Z[1];return(0,p.useImperativeHandle)(ne,function(){return{show:function(k){return K()(d()().mark(function ce(){var Ce;return d()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:P(k),ae(!0),(Ce=v.current)===null||Ce===void 0||Ce.resetFields();case 3:case"end":return pe.stop()}},ce)}))()}}}),(0,p.useEffect)(function(){return setTimeout(function(){var E;l&&((E=Q.current)===null||E===void 0||E.start(l.url,{cmd:l&&l.cmd,workDir:l&&l.workDir}))},1e3),function(){var E;(E=Q.current)===null||E===void 0||E.close()}},[l,me]),(0,D.jsxs)(Y.Z,{forceRender:!0,width:F.FK,open:me,onClose:function(){return[ae(!1)]},title:(l==null?void 0:l.title)+" - \u63A7\u5236\u53F0",children:[(0,D.jsxs)(O.Z,{style:{marginBottom:20},children:[(0,D.jsx)(R.Z,{trigger:(0,D.jsx)(i.ZP,{type:"primary",children:"\u6587\u4EF6\u7BA1\u7406"}),apiPrefix:"container",workDir:l&&l.workDir,title:(0,g.fi)((T=l==null?void 0:l.title)!==null&&T!==void 0?T:"","/"),name:l&&l.url&&(w=l.url.split("/").pop())!==null&&w!==void 0?w:""}),(0,D.jsx)(S.Z,{onChangeShell:function(k){var ce;if(!l)return!1;(ce=Q.current)===null||ce===void 0||ce.close(),k!=(l==null?void 0:l.cmd)&&P(r()(r()({},l),{cmd:k}))},onOpenNewWindow:function(k){return l?(k.workDir=l&&l.workDir?l.workDir:"","".concat(l.url,"?").concat(Object.keys(k).map(function(ce){return"".concat(ce,"=").concat(encodeURIComponent(k[ce]))}).join("&"))):""},onOpenNewWindowFinish:function(){var k;(k=Q.current)===null||k===void 0||k.close(),ae(!1)},onBatchCommandFinish:function(k){Q.current&&Q.current.run(k)}})]}),me&&(0,D.jsx)(C.Z,{height:"80vh",ref:Q})]})});L.Z=B},93362:function(oe,L,e){var U=e(97857),r=e.n(U),I=e(5574),d=e.n(I),A=e(67294),K=e(4459),j=e(25593),y=e(85265),p=e(95591),Y=e(3616),O=e(82346),i=e(85893),C=(0,A.forwardRef)(function(F,R){var S=(0,A.useState)(!1),g=d()(S,2),D=g[0],B=g[1],c=(0,O.useSearchParams)(),ne=d()(c,2),T=ne[0],w=ne[1];return(0,A.useImperativeHandle)(R,function(){return{}}),(0,i.jsxs)(i.Fragment,{children:[F.trigger?A.cloneElement(F.trigger,{onClick:function(){B(!0)}}):(0,i.jsx)(j.Z.Link,{onClick:function(){B(!0)},children:(0,i.jsx)(p.Z,{})},"file"),(0,i.jsx)(y.Z,{width:Y.R_,title:"".concat(F.title," - \u6587\u4EF6\u7BA1\u7406"),onClose:function(){w([]),B(!1)},open:D,children:D&&(0,i.jsx)(K.Z,r()({},F))})]})});L.Z=C},80821:function(oe,L,e){e.d(L,{Z:function(){return O}});var U=e(97857),r=e.n(U),I=e(5574),d=e.n(I),A=e(24963),K=e(86738),j=e(28036),y=e(83062),p=e(67294),Y=e(85893);function O(i){var C=(0,p.useState)(!1),F=d()(C,2),R=F[0],S=F[1],g=(0,p.useContext)(A.Z),D=g.lang,B=g.message,c=function(){S(!0);var T=i.action();T instanceof Promise?T.then(function(w){if(S(!1),w){typeof i.onSuccess=="function"&&i.onSuccess(w);var v="";i.messageSuccess?typeof i.messageSuccess=="function"?v=i.messageSuccess(w):v=i.messageSuccess.indexOf("notification.")==0?D(i.messageSuccess):i.messageSuccess:v=D("notification.finish"),i.asynced?B.info(v):B.success(v)}}).catch(function(w){S(!1),typeof i.onError=="function"&&i.onError(w)}):S(!1)};return i.confirm?(0,Y.jsx)(K.Z,r()(r()({style:{width:500},title:i.confirmTitle?i.confirmTitle:D("notification.title.tip"),description:typeof i.confirm=="string"&&i.confirm.indexOf("notification.")==0?D(i.confirm):i.confirm,onConfirm:c,okText:"Yes",cancelText:"No",onOpenChange:i.confirmOnOpenChange},i.confirmProps),{},{children:(0,Y.jsx)(j.ZP,{block:i.block,disabled:i.disabled,icon:!i.children&&R?void 0:i.icon,loading:R,danger:i.danger,type:i.type,children:i.children})})):(0,Y.jsx)(y.Z,{title:i.tips,children:(0,Y.jsx)(j.ZP,{block:i.block,style:i.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:i.disabled,icon:!i.children&&R?void 0:i.icon,loading:R,onClick:c,danger:i.danger,type:i.type,children:i.children})})}},90581:function(oe,L,e){e.d(L,{Z:function(){return w}});var U=e(15009),r=e.n(U),I=e(99289),d=e.n(I),A=e(5574),K=e.n(A),j=e(3616),y=e(97269),p=e(38345),Y=e(64317),O=e(37476),i=e(62370),C=e(97462),F=e(95089),R=e(42075),S=e(28036),g=e(83062),D=e(67294),B=e(58638),c=e(82346),ne=e(69938),T=e(85893);function w(v){var Q=(0,D.useState)(!1),de=K()(Q,2),ie=de[0],me=de[1],ae=(0,D.useRef)();return(0,T.jsx)(y.A,{layout:"inline",submitter:!1,children:(0,T.jsx)(p.Z,{ghost:!0,children:(0,T.jsxs)(R.Z,{children:[(0,T.jsx)(Y.Z,{label:" ",width:"sm",name:"entryCmd",placeholder:"\u5207\u6362 shell \u73AF\u5883",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(Z){v.onChangeShell&&v.onChangeShell(Z)}}),(0,T.jsx)(O.Y,{modalProps:{width:j.ob,height:j.Ed},title:"\u6279\u91CF\u6267\u884C\u811A\u672C",name:"batchCommand",open:ie,trigger:(0,T.jsx)(S.ZP,{children:"\u6279\u91CF\u6267\u884C"}),formKey:"batchCommand",formRef:ae,isKeyPressSubmit:!0,onFinish:function(){var te=d()(r()().mark(function Z(l){return r()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:v.onBatchCommandFinish&&v.onBatchCommandFinish(l.shell.split(`
`)),me(!1);case 2:case"end":return E.stop()}},Z)}));return function(Z){return te.apply(this,arguments)}}(),onOpenChange:function(Z){me(Z),Z&&ae.current&&ae.current.resetFields()},children:(0,T.jsx)(i.Z,{name:"shell",children:(0,T.jsx)(F.ZP,{theme:"dark",height:j.Ed})})}),(0,T.jsx)(C.Z,{name:["entryCmd"],children:function(Z){var l=Z.entryCmd;return(!l||l=="")&&(l="/bin/sh"),v.onOpenNewWindow&&(0,T.jsx)(c.Link,{onClick:function(){v.onOpenNewWindowFinish&&v.onOpenNewWindowFinish()},target:"_blank",to:v.onOpenNewWindow({cmd:l}),children:(0,T.jsx)(g.Z,{title:"\u65B0\u7A97\u53E3\u6253\u5F00",children:(0,T.jsx)(S.ZP,{type:"dashed",icon:(0,T.jsx)(B.Z,{})})})})}}),(0,T.jsx)(ne.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})}},49610:function(oe,L,e){var U=e(5574),r=e.n(U),I=e(67294),d=e(52626),A=e(78267),K=e.n(A),j=e(12323),y=e(87662),p=e(4244),Y=e.n(p),O=e(24078),i=e(85893),C,F,R,S,g=(0,I.forwardRef)(function(D,B){var c,ne=(0,I.useState)(),T=r()(ne,2),w=T[0],v=T[1],Q=(0,I.useState)(""),de=r()(Q,2),ie=de[0],me=de[1];(0,I.useImperativeHandle)(B,function(){return{start:function(Z,l){ae(),l.width=C.cols,l.height=C.rows;var P=l?Object.keys(l).filter(function(E){return l&&l[E]}).map(function(E){if(l&&l[E])return"".concat(E,"=").concat(l[E])}):[];R=new WebSocket((0,d.R)(Z+"?"+P.join("&"))),R.addEventListener("message",function(E){var k=JSON.parse(E.data),ce=k.type;if(ce==Z&&(C.write(k.data),k.data.indexOf("exec failed")!=-1)){ae();return}}),S=C.onData(function(E){var k={content:{command:E},type:Z};R&&R.send(JSON.stringify(k))}),me(Z),v(l)},close:function(){ae()},fit:function(){return F.fit(),{width:C.cols,height:C.rows}},run:function(Z){w&&Z&&Z.forEach(function(l){var P={content:{command:l+`
`},type:ie};R&&R.send(JSON.stringify(P))})}}}),(0,I.useEffect)(function(){return C=new p.Terminal(j.X),F=new A.FitAddon,C.loadAddon(F),C.open(document.getElementById("terminal-container-console")),F.fit(),(0,y.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(te){te.data&&te.data.fontSize&&Object.assign(C.options,te.data)}),function(){ae()}},[]),(0,I.useEffect)(function(){window.addEventListener("resize",function(){F.fit();var te={size:{width:C.cols,height:C.rows},type:ie};ie&&R&&R.send(JSON.stringify(te))})},[ie]);function ae(){C.reset(),F.fit(),C.focus(),S&&S.dispose(),R&&(R.close(),R=null)}return(0,i.jsx)("div",{style:{height:(c=D.height)!==null&&c!==void 0?c:"100vh"},id:"terminal-container-console"})});L.Z=g},81366:function(oe,L,e){var U=e(19632),r=e.n(U),I=e(5574),d=e.n(I),A=e(27254),K=e(42075),j=e(28036),y=e(25593),p=e(67294),Y=e(31112),O=e(85893),i={title:"ROOT",path:"/"},C=(0,p.forwardRef)(function(F,R){var S=(0,p.useContext)(Y.Z),g=S.showPath,D=(0,p.useState)([i]),B=d()(D,2),c=B[0],ne=B[1];(0,p.useImperativeHandle)(R,function(){return{addHistory:function(v,Q){Q=="/"?ne([i]):ne([].concat(r()(c),[{title:v,path:Q}]))},initHistory:function(v){ne([i].concat(r()(v)))}}});var T=function(v){g?g(c[v].title,c[v].path):F.showPath&&F.showPath(c[v].title,c[v].path);var Q=c.filter(function(de,ie){return ie<=v});ne(r()(Q))};return(0,O.jsxs)(K.Z,{children:[(0,O.jsx)(K.Z.Compact,{children:c.map(function(w,v){return(0,O.jsx)(j.ZP,{icon:(0,O.jsx)(A.Z,{}),type:"dashed",onClick:function(){T(v)},children:w.title},v)})}),c.length>=2&&(0,O.jsx)(y.Z.Text,{copyable:{text:c[c.length-1].path}})]})});L.Z=C},31112:function(oe,L,e){var U=e(67294),r=(0,U.createContext)({});L.Z=r},4459:function(oe,L,e){e.d(L,{Z:function(){return an}});var U=e(15009),r=e.n(U),I=e(99289),d=e.n(I),A=e(5574),K=e.n(A),j=e(82346);function y(t,s){return p.apply(this,arguments)}function p(){return p=d()(r()().mark(function t(s,o){var m;return r()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return m="/api/".concat(s,"/explorer/get-path-list"),H.next=3,(0,j.request)(m,{data:o,method:"POST"});case 3:return H.abrupt("return",H.sent);case 4:case"end":return H.stop()}},t)})),p.apply(this,arguments)}function Y(t,s){return O.apply(this,arguments)}function O(){return O=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/export"),{data:o,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),O.apply(this,arguments)}function i(t,s){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function t(s,o){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o.enableExportHost=!0,n.next=3,request("/api/".concat(s,"/explorer/export"),{data:o,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},t)})),C.apply(this,arguments)}function F(t,s){return R.apply(this,arguments)}function R(){return R=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/import"),{data:o,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),R.apply(this,arguments)}function S(t,s){return g.apply(this,arguments)}function g(){return g=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/delete"),{data:o,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),g.apply(this,arguments)}function D(t,s){return B.apply(this,arguments)}function B(){return B=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/unzip"),{data:o,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),B.apply(this,arguments)}function c(t,s){return ne.apply(this,arguments)}function ne(){return ne=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/get-content"),{data:o,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),ne.apply(this,arguments)}function T(t,s){return w.apply(this,arguments)}function w(){return w=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/import-file-content"),{data:o,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),w.apply(this,arguments)}function v(t,s){return Q.apply(this,arguments)}function Q(){return Q=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/mkdir"),{data:o,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),Q.apply(this,arguments)}function de(t,s){return ie.apply(this,arguments)}function ie(){return ie=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/chmod"),{data:o,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),ie.apply(this,arguments)}function me(t,s){return ae.apply(this,arguments)}function ae(){return ae=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/get-user-list"),{data:o,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),ae.apply(this,arguments)}function te(t,s){return Z.apply(this,arguments)}function Z(){return Z=d()(r()().mark(function t(s,o){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/get-file-stat"),{data:o,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),Z.apply(this,arguments)}var l=e(41482),P=e(67294),E=e(31112),k=e(51042),ce=e(48689),Ce=e(42075),ge=e(28036),pe=e(80821),We=e(88484),Be=e(37476),Ae=e(91604),Le=e(97961),Me=e(3616),a=e(85893);function Ue(){var t=(0,P.useRef)(),s=(0,P.useContext)(E.Z),o=s.refresh,m=s.name,n=s.apiPrefix,H=s.currentPath;return(0,a.jsx)(Be.Y,{modalProps:{width:Me.ob},formRef:t,trigger:(0,a.jsx)(ge.ZP,{icon:(0,a.jsx)(We.Z,{}),children:"\u4E0A\u4F20"}),title:"\u4E0A\u4F20\u6587\u4EF6\u5230\u5BB9\u5668",onFinish:function(){var z=d()(r()().mark(function re(V){var se,X;return r()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return X=[],V.importFileList&&V.importFileList.map(function(q){X.push({name:q.name,path:q.response.data.path})}),F(n,{fileList:X,name:m,destPath:H}),(se=t.current)===null||se===void 0||se.resetFields(),o(),ue.abrupt("return",!0);case 6:case"end":return ue.stop()}},re)}));return function(re){return z.apply(this,arguments)}}(),children:(0,a.jsx)(Ae.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(re){return new Promise(function(V){var se;(0,Le._2)({path:(se=re.response.data.path)!==null&&se!==void 0?se:""}).then(function(X){V(!0)})})}}})})}var Ie=e(23430),we=e(93162),De=e(24963);function Ze(t){var s=(0,P.useContext)(E.Z),o=s.name,m=s.apiPrefix,n=(0,P.useContext)(De.Z),H=n.message;return(0,a.jsx)(pe.Z,{action:function(){return!t.selectFileList||t.selectFileList.length==0?(H.info("\u8BF7\u9009\u62E9\u8981\u4E0B\u8F7D\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):Y(m,{name:o,fileList:t.selectFileList})},onSuccess:function(re){var V=new Blob([re],{type:"application/zip"});(0,we.saveAs)(V,"export.zip")},icon:(0,a.jsx)(Ie.Z,{}),children:"\u4E0B\u8F7D"})}var je=e(38345),fe=e(63434),Ke=e(24739),xe=e(5966);function Se(t){var s=(0,P.useContext)(De.Z),o=s.notice,m=(0,P.useRef)(),n=(0,P.useContext)(E.Z),H=n.currentPath,z=n.refresh,re=n.name,V=n.apiPrefix,se=(0,P.useState)(!1),X=K()(se,2),le=X[0],ue=X[1],q=function(x){var h=x.split(""),W=0,b=0,M=0;return h[1]=="r"&&(W+=4),h[2]=="w"&&(W+=2),h[3]=="x"&&(W+=1),h[4]=="r"&&(b+=4),h[5]=="w"&&(b+=2),h[6]=="x"&&(b+=1),h[7]=="r"&&(M+=4),h[8]=="w"&&(M+=2),h[9]=="x"&&(M+=1),"".concat(W).concat(b).concat(M)},Ee=function(x){var h;if((h=m.current)===null||h===void 0||h.setFieldValue("permission",x),x.length>=1){var W;(W=m.current)===null||W===void 0||W.setFieldsValue({ownerRead:Number(x[0])&4,ownerWrite:Number(x[0])&2,ownerExec:Number(x[0])&1})}if(x.length>=2){var b;(b=m.current)===null||b===void 0||b.setFieldsValue({groupRead:Number(x[1])&4,groupWrite:Number(x[1])&2,groupExec:Number(x[1])&1})}if(x.length>=3){var M;(M=m.current)===null||M===void 0||M.setFieldsValue({everyoneRead:Number(x[2])&4,everyoneWrite:Number(x[2])&2,everyoneExec:Number(x[2])&1})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ge.ZP,{onClick:d()(r()().mark(function _e(){var x;return r()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!(!t.selectFileObject||t.selectFileObject.length==0)){W.next=7;break}return(x=m.current)===null||x===void 0||x.resetFields(),o.error("\u8BF7\u5148\u9009\u62E9\u8981\u4FEE\u6539\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),ue(!1),W.abrupt("return",!1);case 7:ue(!0);case 8:case"end":return W.stop()}},_e)})),children:"\u6743\u9650"}),(0,a.jsxs)(Be.Y,{modalProps:{forceRender:!0,width:Me.ob},title:t.selectFileObject.length==1?"\u4FEE\u6539 ".concat(t.selectFileObject[0].name," \u6743\u9650"):"\u6279\u91CF\u6587\u4EF6\u4FEE\u6539\u6743\u9650",layout:"horizontal",open:le,onOpenChange:function(x){ue(x),t.selectFileObject.length==1&&Ee(q(t.selectFileObject[0].modStr))},formRef:m,onValuesChange:function(x,h){if(x.permission)Ee(x.permission);else{var W=["-",h.ownerRead?"r":"-",h.ownerWrite?"w":"-",h.ownerExec?"x":"-",h.groupRead?"r":"-",h.groupWrite?"w":"-",h.groupExec?"x":"-",h.everyoneRead?"r":"-",h.everyoneWrite?"w":"-",h.everyoneExec?"x":"-"];Ee(q(W.join("")))}},onFinish:function(){var _e=d()(r()().mark(function x(h){var W,b,M,he;return r()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return M=[],t.selectFileObject.map(function(u){M.push(u.path)}),_.next=4,de(V,{name:re,fileList:M,mod:(W=h.permission)!==null&&W!==void 0?W:"600",hasChildren:(b=h.hasChildren)!==null&&b!==void 0?b:!0,user:h.user});case 4:return he=_.sent,z(),_.abrupt("return",!0);case 7:case"end":return _.stop()}},x)}));return function(x){return _e.apply(this,arguments)}}(),children:[(0,a.jsxs)(je.Z,{direction:"row",gutter:[20,10],children:[(0,a.jsxs)(je.Z,{bordered:!0,title:"\u6240\u6709\u8005",headerBordered:!0,children:[(0,a.jsx)(fe.Z,{label:"\u8BFB\u53D6",name:"ownerRead"}),(0,a.jsx)(fe.Z,{label:"\u5199\u5165",name:"ownerWrite"}),(0,a.jsx)(fe.Z,{label:"\u6267\u884C",name:"ownerExec"})]}),(0,a.jsxs)(je.Z,{bordered:!0,title:"\u7528\u6237\u7EC4",headerBordered:!0,children:[(0,a.jsx)(fe.Z,{label:"\u8BFB\u53D6",name:"groupRead"}),(0,a.jsx)(fe.Z,{label:"\u5199\u5165",name:"groupWrite"}),(0,a.jsx)(fe.Z,{label:"\u6267\u884C",name:"groupExec"})]}),(0,a.jsxs)(je.Z,{bordered:!0,title:"\u516C\u5171",headerBordered:!0,children:[(0,a.jsx)(fe.Z,{label:"\u8BFB\u53D6",name:"everyoneRead"}),(0,a.jsx)(fe.Z,{label:"\u5199\u5165",name:"everyoneWrite"}),(0,a.jsx)(fe.Z,{label:"\u6267\u884C",name:"everyoneExec"})]})]}),(0,a.jsx)(je.Z,{children:(0,a.jsxs)(Ke.UW,{children:[(0,a.jsx)(xe.Z,{label:"\u6743\u9650",name:"permission",fieldProps:{maxLength:3},width:"xs"}),(0,a.jsxs)(Ce.Z.Compact,{children:[(0,a.jsx)(xe.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237",label:"\u6240\u6709\u8005",name:"user",fieldProps:{addonAfter:":"}}),(0,a.jsx)(xe.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237\u7EC4",name:"group"})]}),(0,a.jsx)(fe.Z,{label:"\u5E94\u7528\u5230\u5B50\u76EE\u5F55",name:"hasChildren",initialValue:!0})]})})]})]})}var Ne=e(27461);function $e(t){var s=(0,P.useContext)(E.Z),o=s.currentPath,m=s.refresh,n=s.name,H=s.apiPrefix,z=(0,P.useContext)(De.Z),re=z.notice;return(0,a.jsx)(pe.Z,{icon:(0,a.jsx)(Ne.Z,{}),action:d()(r()().mark(function V(){return r()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(t.selectFileObject.length!=0){X.next=3;break}return re.error("\u8BF7\u5148\u9009\u62E9\u8981\u89E3\u538B\u7684 .zip .tar .tar.gz \u6587\u4EF6"),X.abrupt("return",!1);case 3:return X.abrupt("return",D(H,{name:n,file:t.selectFileObject.map(function(le){return le.path}),path:o}));case 4:case"end":return X.stop()}},V)})),onSuccess:function(){m()},children:"\u89E3\u538B"})}function sn(t){var s=useContext(FileExplorerContext),o=s.name,m=s.apiPrefix,n=useContext(AppContext),H=n.message,z=useRef();return _jsx(RequestButton,{confirm:_jsx(Space,{children:_jsx(ProForm,{layout:"inline",submitter:!1,formRef:z,children:_jsx(ProFormText,{width:"md",label:"\u5BFC\u51FA\u5230\u4E3B\u673A\u76EE\u5F55",name:"hostPath"})})}),action:function(){var V;return!t.selectFileList||t.selectFileList.length==0?(H.info("\u8BF7\u9009\u62E9\u8981\u5BFC\u51FA\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):exportFileList(m,{name:o,hostPath:(V=z.current)===null||V===void 0?void 0:V.getFieldValue("hostPath"),enableExportHost:!0,fileList:t.selectFileList})},icon:_jsx(ExportOutlined,{}),children:"\u5BFC\u51FA\u5230\u4E3B\u673A"})}function ke(t){var s=(0,P.useContext)(E.Z),o=s.refresh,m=s.name,n=s.apiPrefix,H=s.currentPath,z=s.newFile;return(0,a.jsxs)(Ce.Z,{size:16,wrap:!0,children:[(0,a.jsx)(Ze,{selectFileList:t.selectFileList}),!1,(0,a.jsx)(Ue,{}),(0,a.jsx)(Se,{selectFileObject:t.selectFileObject}),(0,a.jsx)($e,{selectFileObject:t.selectFileObject}),(0,a.jsx)(ge.ZP,{icon:(0,a.jsx)(k.Z,{}),onClick:function(){z()},type:"primary",children:"\u65B0\u5EFA"}),(0,a.jsx)(pe.Z,{danger:!0,type:"default",icon:(0,a.jsx)(ce.Z,{}),action:function(){return S(n,{name:m,fileList:t.selectFileList})},onSuccess:function(){o()},confirm:"notification.confirm.title",children:"\u5220\u9664"})]})}var Fe=e(83062),Re=e(66309);function He(t){return t.change==0?(0,a.jsx)(Fe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u4FEE\u6539",children:(0,a.jsx)(Re.Z,{color:"blue",children:"MODIFIED"})}):t.change==1?(0,a.jsx)(Fe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u65B0\u589E\u7684\u6587\u4EF6",children:(0,a.jsx)(Re.Z,{color:"green",children:"ADD"})}):t.change==2?(0,a.jsx)(Fe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u5220\u9664\u6587\u4EF6",children:(0,a.jsx)(Re.Z,{color:"error",children:"DELETED"})}):t.change==100?(0,a.jsx)(Fe.Z,{title:"\u6302\u8F7D\u7684\u6301\u4E45\u5316\u76EE\u5F55",children:(0,a.jsx)(Re.Z,{color:"cyan",children:"VOLUME"})}):(0,a.jsx)(a.Fragment,{})}var ze=e(81366),Ve=e(97269),Ge=e(86615),Je=e(97462),Ye=e(62370),Qe=e(85576),Xe=e(95089),be=e(5251),qe=(0,P.forwardRef)(function(t,s){var o,m,n,H=(0,P.useContext)(De.Z),z=H.message,re=H.notice,V=(0,P.useContext)(E.Z),se=V.currentPath,X=V.refresh,le=V.name,ue=V.apiPrefix,q=(0,P.useRef)(),Ee=(0,P.useState)(!1),_e=K()(Ee,2),x=_e[0],h=_e[1];return(0,P.useImperativeHandle)(s,function(){return{newFile:function(){var b,M;h(!0),(b=q.current)===null||b===void 0||b.resetFields(),(M=q.current)===null||M===void 0||M.setFieldValue("type","newFile")},editFile:function(b,M,he){return d()(r()().mark(function f(){var _,u,N,$,G;return r()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return(_=q.current)===null||_===void 0||_.resetFields(),z.loading("\u6B63\u5728\u83B7\u53D6\u6587\u4EF6\u5185\u5BB9"),J.next=4,c(ue,{name:le,file:M}).finally(function(){z.destroy()});case 4:if(G=J.sent,!(G.data.content==""&&he!="0")){J.next=9;break}return z.error("\u4E0D\u652F\u6301\u7F16\u8F91\u7684\u6587\u4EF6\u7C7B\u578B"),h(!1),J.abrupt("return");case 9:return(u=q.current)===null||u===void 0||u.setFieldValue("newValue",G.data.content),(N=q.current)===null||N===void 0||N.setFieldValue("newName",b),($=q.current)===null||$===void 0||$.setFieldValue("type","editFile"),h(!0),J.abrupt("return");case 14:case"end":return J.stop()}},f)}))()}}}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Qe.Z,{width:Me.ob,title:(o=q.current)!==null&&o!==void 0&&o.getFieldValue("newName")?"\u7F16\u8F91\u6587\u4EF6":"\u65B0\u5EFA\u6587\u4EF6",open:x,onCancel:function(){var b;h(!1),(b=q.current)===null||b===void 0||b.resetFields()},footer:!1,forceRender:!0,children:(0,a.jsxs)(Ve.A,{formRef:q,onFinish:function(){var W=d()(r()().mark(function b(M){return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(M.type!="newDir"){f.next=13;break}return f.prev=1,f.next=4,v(ue,{name:le,destPath:"".concat(se,"/").concat((0,be.fi)(M.newPath,"/"))});case 4:return X(),h(!1),f.abrupt("return",!0);case 9:f.prev=9,f.t0=f.catch(1);case 11:f.next=23;break;case 13:return f.prev=13,f.next=16,T(ue,{destPath:se,file:M.newName,content:M.newValue,name:le});case 16:return X(),h(!1),f.abrupt("return",!0);case 21:f.prev=21,f.t1=f.catch(13);case 23:return f.abrupt("return",!1);case 24:case"end":return f.stop()}},b,null,[[1,9],[13,21]])}));return function(b){return W.apply(this,arguments)}}(),children:[(0,a.jsx)(Ge.Z.Group,{name:"type",options:[{label:"\u7F16\u8F91\u6587\u4EF6",value:"editFile",disabled:((m=q.current)===null||m===void 0?void 0:m.getFieldValue("type"))!="editFile"},{label:"\u65B0\u5EFA\u6587\u4EF6",value:"newFile"},{label:"\u65B0\u5EFA\u76EE\u5F55",value:"newDir"}],disabled:((n=q.current)===null||n===void 0?void 0:n.getFieldValue("type"))=="editFile"}),(0,a.jsx)(Je.Z,{name:["type"],children:function(b){var M=b.type;return M!="newDir"?[(0,a.jsx)(xe.Z,{label:"\u6587\u4EF6\u540D",tooltip:"\u7F16\u8F91\u6587\u4EF6\u65F6\u4FEE\u6539\u6587\u4EF6\u540D\u53EF\u5B9E\u73B0\u590D\u5236\u529F\u80FD",name:"newName",fieldProps:{addonBefore:"".concat(se,"/")},placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D",disabled:M=="editFile"},"fileName"),(0,a.jsx)(Ye.Z,{label:"\u5185\u5BB9",name:"newValue",children:(0,a.jsx)(Xe.ZP,{theme:"dark",height:Me.Ed,onChange:function(f){var _;(_=q.current)===null||_===void 0||_.setFieldValue("newValue",f)}})},"fileContent")]:(0,a.jsx)(xe.Z,{name:"newPath",label:"\u76EE\u5F55\u540D",placeholder:"\u8F93\u5165\u76EE\u5F55\u540D\u79F0\uFF0C\u652F\u6301\u591A\u7EA7"})}})]})})})}),en=qe,nn=e(99922),ye=e(68536),tn=e(87662),un=null;function rn(t){var s=(0,P.useRef)(),o=(0,P.useRef)(),m=(0,P.useRef)(),n=(0,P.useState)(""),H=K()(n,2),z=H[0],re=H[1],V=(0,P.useRef)(),se=(0,j.useSearchParams)(),X=K()(se,2),le=X[0],ue=X[1],q=(0,P.useState)(),Ee=K()(q,2),_e=Ee[0],x=Ee[1],h=(0,P.useContext)(De.Z),W=h.lang,b=h.message,M=t.apiPrefix=="host"?"common":"app";(0,P.useEffect)(function(){var f=le.get("path");if(f){for(var _,u=f.split("/"),N=[],$="",G=1;G<u.length;G++)$+="/"+u[G],N.push({title:u[G],path:$});he(u[u.length-1],f),(_=s.current)===null||_===void 0||_.initHistory([].concat(N))}(0,tn.K3)().then(function(ve){!ve.data.enableSSH&&b.info(W("app.detail.createExplorerPlugin"))})},[t.name,le]);var he=function(_,u){var N,$;if((N=s.current)===null||N===void 0||N.addHistory(_,u),re(u),m.current&&($=m.current)!==null&&$!==void 0&&$.reloadAndRest){var G;(G=m.current)===null||G===void 0||G.reloadAndRest()}u=="/"?ue([]):(le.set("path",u),ue(le))};return(0,a.jsxs)(E.Z.Provider,{value:{apiPrefix:M,name:t.name,currentPath:z,showPath:he,refresh:function(){var _;if(m&&typeof((_=m.current)===null||_===void 0?void 0:_.reloadAndRest)=="function"){var u;(u=m.current)===null||u===void 0||u.reloadAndRest()}},editFile:function(_,u,N){o.current&&o.current.editFile(_,u,N)},newFile:function(){o.current&&o.current.newFile()}},children:[(0,a.jsx)(l.Z,{scroll:{x:"max-content"},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},toolBarRender:function(){var _=[];return t.onConsole&&_.push((0,a.jsx)(ge.ZP,{type:"dashed",onClick:function(){t.onConsole&&t.onConsole(z)},children:"Console"},"fileConsole")),[].concat(_)},tableAlertOptionRender:function(_){var u=_.selectedRowKeys,N=_.selectedRows,$=[];return N.map(function(G){$.push(G.path)}),[(0,a.jsx)(ke,{selectFileList:$,selectFileObject:N,enableExportHost:t.apiPrefix=="container"},"1")]},headerTitle:(0,a.jsx)(ze.Z,{ref:s}),actionRef:m,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:d()(r()().mark(function f(){var _,u,N,$,G;return r()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,y(M,{name:t.name,path:z});case 2:if(_=J.sent,z==""&&_.data.currentPath!=""&&(N=[],re(_.data.currentPath),(u=s.current)===null||u===void 0||u.initHistory(_.data.currentPath.split("/").filter(function(ee){return ee!=""}).map(function(ee){return N.push(ee),{title:ee,path:"/".concat(N.join("/"))}}))),$=_e,$){J.next=11;break}return J.next=8,me(M,{name:t.name});case 8:G=J.sent,x(G.data),$=G.data;case 11:return J.abrupt("return",{data:_.data.list.map(function(ee){if($){var Pe,Te;ee.group=(Pe=(Te=$.group.find(function(Oe){return Oe.gid==ee.group}))===null||Te===void 0?void 0:Te.name)!==null&&Pe!==void 0?Pe:ee.group}return ee}),success:!0,total:_.data.list.length});case 12:case"end":return J.stop()}},f)})),columns:[{title:"\u540D\u79F0",dataIndex:"name",key:"name",render:function(ve,u,N,$,G){var ve;return u.isDir?ve=(0,a.jsx)(ye.Z,{isDir:!0,onClick:function(){return he(u.name,u.path)},showName:u.name}):u.isSymlink?ve=(0,a.jsx)(ye.Z,{isLink:!0,showName:"".concat(u.name," -> ").concat(u.linkName),onClick:d()(r()().mark(function J(){var ee,Pe;return r()().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:return Oe.next=2,te(M,{name:t.name,path:u.path});case 2:ee=Oe.sent,ee.data.info.isDir?he(u.name,ee.data.info.target):(Pe=o.current)===null||Pe===void 0||Pe.editFile(ee.data.info.name,ee.data.info.target,u.size);case 4:case"end":return Oe.stop()}},J)}))}):ve=(0,a.jsx)(ye.Z,{showName:u.name,onClick:function(){var ee;(ee=o.current)===null||ee===void 0||ee.editFile(u.name,u.path,u.size)}}),ve}},{title:"\u72B6\u6001",key:"status",width:110,render:function(_,u,N,$,G){return(0,a.jsx)(He,{change:u.change})}},{title:"\u6743\u9650",dataIndex:"modStr",key:"mod"},{title:"\u7528\u6237",dataIndex:"user"},{title:"\u7528\u6237\u7EC4",dataIndex:"group"},{title:"\u5927\u5C0F",dataIndex:"size",key:"size",render:function(_,u,N,$,G){return(0,be.FI)(u.size)}},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"modTime",key:"modTime",sorter:function(_,u){return new Date(_.modTime).getTime()-new Date(u.modTime).getTime()},render:function(_,u,N,$,G){return(0,be.NF)(u.modTime)}}],cardProps:{ghost:!0}}),(0,a.jsx)(en,{ref:o}),(0,a.jsx)(nn.Z,{ref:V})]})}var an=rn},68536:function(oe,L,e){e.d(L,{Z:function(){return Y}});var U=e(24963),r=e(93613),I=e(36693),d=e(2741),A=e(25593),K=e(42075),j=e(67294),y=e(85893),p=0;function Y(O){var i=(0,j.useContext)(U.Z),C=i.message;return O.isDir?(0,y.jsx)(A.Z.Link,{onClick:function(){O.onClick&&O.onClick()},children:(0,y.jsxs)(K.Z,{children:[(0,y.jsx)(r.Z,{}),O.showName]})}):O.isLink?(0,y.jsx)(A.Z.Link,{onClick:function(){O.onClick&&O.onClick()},children:(0,y.jsxs)(K.Z,{children:[(0,y.jsx)(I.Z,{}),O.showName]})}):(0,y.jsx)(A.Z.Text,{onClick:function(){if(p++,p==2){p=0,O.onClick&&O.onClick();return}setTimeout(function(){p==1&&C.info("\u53CC\u51FB\u67E5\u770B\u6587\u4EF6\u5185\u5BB9"),p=0},400)},style:{cursor:"pointer"},children:(0,y.jsxs)(K.Z,{children:[(0,y.jsx)(d.Z,{}),O.showName]})})}},3616:function(oe,L,e){e.d(L,{Ed:function(){return d},FK:function(){return r},R_:function(){return U},ob:function(){return I}});var U=window.innerWidth<=1024?"90vw":"65vw",r="90vw",I="60vw",d="50vh"},12323:function(oe,L,e){e.d(L,{X:function(){return U},n:function(){return r}});var U={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},r=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},24963:function(oe,L,e){var U=e(67294),r=(0,U.createContext)({});L.Z=r},97961:function(oe,L,e){e.d(L,{GH:function(){return O},MF:function(){return R},_2:function(){return C},fN:function(){return j},ii:function(){return K},vC:function(){return p}});var U=e(15009),r=e.n(U),I=e(99289),d=e.n(I),A=e(82346),K=[{name:"amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"i386",arch:"386",search:[]},{name:"arm/v6",arch:"arm",search:[]},{name:"arm/v7",arch:"arm",search:[]},{name:"arm/v8",arch:"arm64",search:[]},{name:"ppc64le",arch:"ppc64le",search:[]},{name:"riscv64",arch:"riscv64",search:[]}];function j(g){return y.apply(this,arguments)}function y(){return y=d()(r()().mark(function g(D){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,A.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:D}));case 1:case"end":return c.stop()}},g)})),y.apply(this,arguments)}function p(g){return Y.apply(this,arguments)}function Y(){return Y=d()(r()().mark(function g(D){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,A.request)("/api/app/image/import-by-container-tar",{method:"POST",data:D}));case 1:case"end":return c.stop()}},g)})),Y.apply(this,arguments)}function O(g){return i.apply(this,arguments)}function i(){return i=d()(r()().mark(function g(D){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,A.request)("/api/app/image/import-by-image-tar",{method:"POST",data:D}));case 1:case"end":return c.stop()}},g)})),i.apply(this,arguments)}function C(g){return F.apply(this,arguments)}function F(){return F=d()(r()().mark(function g(D){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,A.request)("/api/common/attach/delete",{method:"POST",data:D});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},g)})),F.apply(this,arguments)}function R(){return S.apply(this,arguments)}function S(){return S=d()(r()().mark(function g(){return r()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.abrupt("return",(0,A.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return B.stop()}},g)})),S.apply(this,arguments)}}}]);
