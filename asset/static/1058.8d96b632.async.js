"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1058],{91058:function(S,M,e){var C=e(9783),_=e.n(C),W=e(19632),m=e.n(W),i=e(97857),s=e.n(i),v=e(5574),j=e.n(v),f=e(89035),p=e(64317),U=e(5966),B=e(38345),x=e(17186),P=e(24739),Z=e(42075),R=e(28036),F=e(85576),E=e(67294),K=e(95089),A=e(12491),T=e(62597),h=e(79245),a=e(3616),r=e(85893),D="docker-image",n=(0,E.forwardRef)(function(l,X){var Y=(0,E.useState)(D),G=j()(Y,2),k=G[0],V=G[1],O=(0,E.useRef)(),J=(0,E.useState)(""),N=j()(J,2),Q=N[0],q=N[1],ee=function(){k!="code"?V("code"):V(D)};(0,E.useImperativeHandle)(X,function(){return{addEnvItem:function(u,d){var c,o=(c=O.current)===null||c===void 0?void 0:c.getList(),g=!1;if(o==null||o.map(function(I){if(I.name==u){g=!0;return}}),!g){var b;(b=O.current)===null||b===void 0||b.add({name:u,value:d})}},clear:function(){var u;(u=O.current)===null||u===void 0||(u=u.getList())===null||u===void 0||u.map(function(d,c){var o;(o=O.current)===null||o===void 0||o.remove(c)})}}});function $(t){try{var u,d;t==""&&(t=z());for(var c=(u=(d=O.current)===null||d===void 0||(d=d.getList())===null||d===void 0?void 0:d.length)!==null&&u!==void 0?u:0,o=c;o>=0;o--){var g;(g=O.current)===null||g===void 0||g.remove(o)}var b=t.split(`
`),I=0;b.map(function(L){var w,y=L.split("=");y.length<2||((w=O.current)===null||w===void 0||w.add({name:y[0],value:y.slice(1).join("=")},I),I++)})}catch(L){console.log(L)}}function z(){if(O&&O.current&&O.current.getList){var t,u=(t=O.current)===null||t===void 0?void 0:t.getList();if(u){var d=[];return u.map(function(c){d.push("".concat(c.name,"=").concat(c.value))}),d.join(`
`)}else return""}else return""}function ne(t){var u,d,c,o,g,b={},I={help:t&&t.label?t.label:"",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:l.requireValue?!0:(0,h.y)((u=t.rule)===null||u===void 0?void 0:u.kind,T.fp.EnvValueRuleRequired)}],disabled:l.showDisableValue||(0,h.y)((d=t.rule)===null||d===void 0?void 0:d.kind,T.fp.EnvValueRuleDisabled)};if((0,h.y)((c=t.rule)===null||c===void 0?void 0:c.kind,T.fp.EnvValueTypeSelect)){var L;return(0,r.jsx)(p.Z,s()(s()({fieldProps:b},I),{},{initialValue:t.value,width:l.showInDrawer?"sm":"md",options:((L=t.rule)===null||L===void 0?void 0:L.option)&&t.rule.option.map(function(y){return{label:y.name,value:y.value}})}))}else if((0,h.y)((o=t.rule)===null||o===void 0?void 0:o.kind,T.fp.EnvValueTypeSelectMultiple)){var w;return(0,r.jsx)(p.Z,s()(s()({mode:"multiple"},I),{},{fieldProps:b,convertValue:function(H){return Array.isArray(H)?H:H.split(",")},width:l.showInDrawer?"sm":"md",options:((w=t.rule)===null||w===void 0?void 0:w.option)&&t.rule.option.map(function(y){return{label:y.name,value:y.value}})}))}else return(0,h.y)((g=t.rule)===null||g===void 0?void 0:g.kind,T.fp.EnvValueTypeNumber)?(0,r.jsx)(U.Z,s()(s()({fieldProps:b},I),{},{width:l.showInDrawer?"sm":"md",rules:[].concat(m()(I.rules),[{pattern:new RegExp("^[0-9]*$")}]),help:I.help+",\u6570\u503C\u7C7B\u578B"})):(0,r.jsx)(U.Z,s()(s()({fieldProps:b},I),{},{width:l.showInDrawer?"sm":"md"}))}return(0,r.jsxs)(B.Z,{ghost:l.showCardGhost,title:l.label?l.label:null,headerBordered:!0,extra:(l.showCodeMode||l.showImportButton)&&(0,r.jsxs)(Z.Z,{children:[l.showImportButton&&(0,r.jsx)("div",{style:{marginBottom:"-25px"},children:(0,r.jsx)(A.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(u){return $(u),!0},onLoad:function(u){if(u.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),l.showCodeMode?(0,r.jsx)(R.ZP,{icon:(0,r.jsx)(f.Z,{}),type:k=="code"?"primary":"default",onClick:ee,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,r.jsx)(x.u,{name:l.name?l.name:"environment",actionRef:O,creatorButtonProps:l.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,deleteIconProps:l.showDeleteButton,min:100,label:l.listLabel,transform:function(u,d,c){return _()({},d,u.map(function(o){return Array.isArray(o.value)&&(o.value=o.value.filter(function(g){return g!=""}).join(",")),o}))},children:function(u,d,c){var o=c.getCurrentRowData();return(0,r.jsxs)(P.UW,{style:{marginBottom:"5px"},children:[(0,r.jsx)(U.Z,{width:l.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:l.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),ne(o)]})}}),l.showCodeMode&&(0,r.jsx)(F.Z,{width:a.ob,open:k=="code",onCancel:function(){return V("docker-image")},onOk:function(){$(Q),V("docker-image")},children:(0,r.jsx)(K.ZP,{onChange:function(u){return q(u)},value:z(),height:a.Ed,theme:"dark"})})]})});M.Z=n},12491:function(S,M,e){e.d(M,{Z:function(){return j}});var C=e(24963),_=e(88484),W=e(62370),m=e(31418),i=e(28036),s=e(67294),v=e(85893);function j(f){var p=(0,s.useContext)(C.Z),U=p.message,B=p.notice,x=p.lang,P=(0,s.useRef)(null),Z=m.Z.useApp(),R=function(){P.current&&(P.current.click(),P.current.onchange=function(E){if(!E||!E.target)return"";var K=new FileReader;K.onload=function(T){var h,a,r=(h=T.target)===null||h===void 0?void 0:h.result;if(f.onLoad)try{f.onLoad&&f.onLoad(r)}catch(D){B.error(D);return}typeof f.onImport=="function"&&(U.success("\u6210\u529F\u5BFC\u5165 ".concat(f.title)),f.onImport(r)),(a=P.current)!==null&&a!==void 0&&a.value&&(P.current.value="")};var A=E.target;if(A.files)try{K.readAsText(A.files[0])}catch(T){B.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(W.Z,{children:(0,v.jsx)(i.ZP,{icon:(0,v.jsx)(_.Z,{}),block:!0,onClick:R,children:f.title})}),(0,v.jsx)("input",{style:{display:"none"},type:"file",ref:P,name:"importFileInput"})]})}},3616:function(S,M,e){e.d(M,{Ed:function(){return m},FK:function(){return _},R_:function(){return C},ob:function(){return W}});var C=window.innerWidth<=1024?"90vw":"65vw",_="90vw",W="60vw",m="50vh"},24963:function(S,M,e){var C=e(67294),_=(0,C.createContext)({});M.Z=_},62597:function(S,M,e){e.d(M,{$G:function(){return s},Ct:function(){return F},Tb:function(){return U},XH:function(){return x},cl:function(){return f},fp:function(){return j},iE:function(){return Z},xb:function(){return K},ze:function(){return T}});var C=e(15009),_=e.n(C),W=e(99289),m=e.n(W),i=e(82346);function s(a){return v.apply(this,arguments)}function v(){return v=m()(_()().mark(function a(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/site/create-by-image",{method:"POST",data:r}));case 1:case"end":return n.stop()}},a)})),v.apply(this,arguments)}var j={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192};function f(a){return p.apply(this,arguments)}function p(){return p=m()(_()().mark(function a(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/site/get-list",{method:"POST",data:r}));case 1:case"end":return n.stop()}},a)})),p.apply(this,arguments)}function U(a){return B.apply(this,arguments)}function B(){return B=m()(_()().mark(function a(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.download=!1,n.next=3,(0,i.request)("/api/app/log/run",{method:"POST",data:r});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},a)})),B.apply(this,arguments)}function x(a){return P.apply(this,arguments)}function P(){return P=m()(_()().mark(function a(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.download=!0,n.next=3,(0,i.request)("/api/app/log/run",{method:"POST",data:r,responseType:"blob"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},a)})),P.apply(this,arguments)}function Z(a){return R.apply(this,arguments)}function R(){return R=m()(_()().mark(function a(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.id=String(r.id),n.next=3,(0,i.request)("/api/app/site/get-detail",{data:r,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},a)})),R.apply(this,arguments)}function F(a){return E.apply(this,arguments)}function E(){return E=m()(_()().mark(function a(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/container/delete",{method:"POST",data:r}));case 1:case"end":return n.stop()}},a)})),E.apply(this,arguments)}function K(a){return A.apply(this,arguments)}function A(){return A=m()(_()().mark(function a(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/site/delete",{method:"POST",data:r}));case 1:case"end":return n.stop()}},a)})),A.apply(this,arguments)}function T(a){return h.apply(this,arguments)}function h(){return h=m()(_()().mark(function a(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/container/ignore",{method:"POST",data:r}));case 1:case"end":return n.stop()}},a)})),h.apply(this,arguments)}},79245:function(S,M,e){e.d(M,{m:function(){return W},y:function(){return m}});var C=e(64599),_=e.n(C);function W(i){var s=[];if(!i||i=="")return s;var v=i.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),j=_()(v),f;try{for(j.s();!(f=j.n()).done;){var p=f.value;s.push({name:p[1],value:p[2]?p[2].indexOf("-")==0?p[2].substring(1):p[2]:""})}}catch(U){j.e(U)}finally{j.f()}return s}function m(i,s){return!i||!s?!1:(i&s)!==0}}}]);
