"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9969],{49610:function(B,h,n){var C=n(5574),a=n.n(C),f=n(67294),l=n(54964),u=n(52626),D=n(12320),m=n.n(D),P=n(78267),A=n.n(P),M=n(85893),o,i=new D.Terminal(l.a),s=new P.FitAddon,E,d=(0,f.forwardRef)(function(T,_){var W,v=(0,f.useState)(),R=a()(v,2),g=R[0],I=R[1],y=(0,f.useState)(""),t=a()(y,2),r=t[0],c=t[1];(0,f.useImperativeHandle)(_,function(){return{start:function(U,p){e(),p.width=i.cols,p.height=i.rows;var K=p?Object.keys(p).filter(function(O){return p&&p[O]}).map(function(O){if(p&&p[O])return"".concat(O,"=").concat(p[O])}):[];o=new WebSocket((0,u.R)(U+"?"+K.join("&"))),o.addEventListener("message",function(O){var L=JSON.parse(O.data),S=L.type;if(S==U&&(i.write(L.data),L.data.indexOf("exec failed")!=-1)){e();return}}),E=i.onData(function(O){var L={content:{command:O},type:U};o&&o.send(JSON.stringify(L))}),c(U),I(p)},close:function(){e()},fit:function(){return s.fit(),{width:i.cols,height:i.rows}},run:function(U){g&&U&&U.forEach(function(p){var K={content:{command:p+`
`},type:r};o&&o.send(JSON.stringify(K))})}}}),(0,f.useEffect)(function(){return i.loadAddon(s),i.open(document.getElementById("terminal-container-console")),s.fit(),function(){e()}},[]),(0,f.useEffect)(function(){window.addEventListener("resize",function(){s.fit();var j={size:{width:i.cols,height:i.rows},type:r};r&&o&&o.send(JSON.stringify(j))})},[r]);function e(){i.reset(),s.fit(),i.focus(),E&&E.dispose(),o&&(o.close(),o=null)}return(0,M.jsx)("div",{style:{height:(W=T.height)!==null&&W!==void 0?W:"100vh"},id:"terminal-container-console"})});h.Z=d},54964:function(B,h,n){n.d(h,{a:function(){return i}});var C=n(5574),a=n.n(C),f=n(78267),l=n.n(f),u=n(75458),D=n.n(u),m=n(67294),P=n(12320),A=n.n(P),M=n(89629),o=n(85893),i={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},s=new P.Terminal(i),E=new u.SearchAddon,d=new f.FitAddon,T=(0,m.forwardRef)(function(_,W){var v,R=(0,m.useState)(!0),g=a()(R,2),I=g[0],y=g[1];return(0,m.useEffect)(function(){return window.addEventListener("resize",function(){_.showInModal||d.fit()}),_.style&&_.style.fontSize&&(s.options.fontSize=_.style.fontSize),s.loadAddon(d),s.loadAddon(E),s.open(document.getElementById(_.id?_.id:"terminal-container")),_.showInModal||d.fit(),function(){s.reset(),y(!0)}},[]),(0,m.useImperativeHandle)(W,function(){return{write:function(r){I&&(d.fit(),y(!1)),s.write(r)},clear:function(){s.clear()},getTerminal:function(){return s},findNext:function(r){E.findNext(r)},findPrev:function(r){E.findPrevious(r)},fit:function(){d.fit()},onData:function(r){return s.onData(r)}}}),(0,o.jsx)("div",{id:_.id?_.id:"terminal-container",style:{width:_.width?_.width:"100%",height:_.height?_.height:"500px",marginTop:(v=_.style)===null||v===void 0?void 0:v.marginTop}})});h.Z=T},15563:function(B,h,n){n.r(h),n.d(h,{default:function(){return A}});var C=n(5574),a=n.n(C),f=n(49610),l=n(60335),u=n(5251),D=n(82346),m=n(67294),P=n(85893);function A(){var M=(0,D.useParams)(),o=(0,D.useSearchParams)(),i=a()(o,2),s=i[0],E=i[1],d=(0,m.useRef)();return(0,m.useEffect)(function(){M.id&&(0,l.jV)({md5:M.id}).then(function(T){var _;window.document.title="console - ".concat((0,u.fi)(T.data.info.Name,"/")),M.id&&((_=d.current)===null||_===void 0||_.start("/console/container/".concat(T.data.info.Id),{cmd:s.get("cmd"),workDir:s.get("workDir")}))}),document.body.style.overflow="hidden"},[]),(0,P.jsx)(f.Z,{ref:d})}},60335:function(B,h,n){n.d(h,{IE:function(){return P},IW:function(){return D},KK:function(){return E},LJ:function(){return T},RF:function(){return R},Re:function(){return W},aF:function(){return I},eE:function(){return i},jV:function(){return M}});var C=n(15009),a=n.n(C),f=n(99289),l=n.n(f),u=n(82346);function D(t){return m.apply(this,arguments)}function m(){return m=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/app/container/status",{method:"POST",data:r}));case 1:case"end":return e.stop()}},t)})),m.apply(this,arguments)}function P(t){return A.apply(this,arguments)}function A(){return A=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/app/container/get-list",{data:r,method:"POST"}));case 1:case"end":return e.stop()}},t)})),A.apply(this,arguments)}function M(t){return o.apply(this,arguments)}function o(){return o=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/app/container/get-detail",{data:r,method:"POST"}));case 1:case"end":return e.stop()}},t)})),o.apply(this,arguments)}function i(t){return s.apply(this,arguments)}function s(){return s=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/app/container/update",{data:r,method:"POST"}));case 1:case"end":return e.stop()}},t)})),s.apply(this,arguments)}function E(){return d.apply(this,arguments)}function d(){return d=l()(a()().mark(function t(){return a()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,u.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return c.stop()}},t)})),d.apply(this,arguments)}function T(t){return _.apply(this,arguments)}function _(){return _=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/app/container/export",{method:"POST",data:r,responseType:"blob"}));case 1:case"end":return e.stop()}},t)})),_.apply(this,arguments)}function W(t){return v.apply(this,arguments)}function v(){return v=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/app/container/commit",{method:"POST",data:r}));case 1:case"end":return e.stop()}},t)})),v.apply(this,arguments)}function R(t){return g.apply(this,arguments)}function g(){return g=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/app/container/upgrade",{method:"POST",data:r}));case 1:case"end":return e.stop()}},t)})),g.apply(this,arguments)}function I(t){return y.apply(this,arguments)}function y(){return y=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/app/container/copy",{method:"POST",data:r}));case 1:case"end":return e.stop()}},t)})),y.apply(this,arguments)}}}]);
