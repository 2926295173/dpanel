"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9170],{37767:function(on,W,n){n.d(W,{Z:function(){return rn}});var y=n(15009),d=n.n(y),O=n(99289),h=n.n(O),_=n(5574),U=n.n(_),u=n(45605),x=n(38345),v=n(97269),j=n(26412),M=n(42075),l=n(96074),I=n(25593),t=n(2487),g=n(67294),i=n(76428),m=n(78498),a=n(44771),o=n(60335),$=n(24963),F=n(37413),f=n(5251),E=n(82346),S=n(87662),r=n(85893);function rn(c){var K,tn,dn,G,an,cn,fn,z,hn,e,q=(0,g.useState)(""),b=U()(q,2),nn=b[0],Q=b[1],mn=(0,E.useAccess)(),w=(0,g.useContext)($.Z),Cn=w.message,En=w.notice,In=w.loading,Pn=w.lang,P=(0,g.useRef)(),ln=[],Dn=[],sn=[],un=(0,g.useState)(""),H=U()(un,2),J=H[0],_n=H[1];return(0,g.useEffect)(function(){if(c.data){var R;(R=P.current)===null||R===void 0||R.setFieldValue("restart",c.data.info.HostConfig.RestartPolicy.Name),(0,S.K3)().then(function(L){var A;_n((A=L.data.serverUrl)!==null&&A!==void 0?A:"")}),Q(c.data.info.Name)}},[c.data]),c.data&&c.data.domain&&c.data.domain.map(function(R){sn.push(R.setting.enableSSL?"https://"+R.serverName:"http://"+R.serverName)}),c.data&&c.data.info.NetworkSettings&&c.data.info.NetworkSettings.Ports&&Object.keys(c.data.info.NetworkSettings.Ports).map(function(R){var L,A,Y=(L=(A=c.data.info)===null||A===void 0?void 0:A.NetworkSettings.Ports[R])!==null&&L!==void 0?L:[{HostPort:null,HostIp:""}],en=R.split("/"),gn=U()(en,2),X=gn[0],k=gn[1];Y.map(function(vn){vn.HostPort?ln.push({PrivatePort:X,Type:k,IP:vn.HostIp,PublicPort:vn.HostPort}):Dn.push({PrivatePort:X,Type:k,IP:"",PublicPort:""})})}),(0,r.jsxs)(r.Fragment,{children:[c.data&&c.data.info.State.Running&&(0,r.jsx)(F.Z,{publicPort:ln,privatePort:Dn,domain:sn,serverIp:J,showInDetail:!0,ghost:c.ghost,layout:"inline"}),(0,r.jsx)(x.Z,{title:(0,r.jsx)(u.Z,{}),subTitle:"\u5BB9\u5668\u72B6\u6001",ghost:c.ghost,children:(0,r.jsxs)(j.Z,{column:1,bordered:!0,children:[(0,r.jsx)(j.Z.Item,{label:"Hostname",children:(0,r.jsx)(M.Z,{split:(0,r.jsx)(l.Z,{type:"vertical"}),children:(0,r.jsx)(i.Z,{title:(K=c.data.info)===null||K===void 0?void 0:K.Config.Hostname})})}),(0,r.jsx)(j.Z.Item,{label:"\u5BB9\u5668\u540D\u79F0",children:(0,r.jsxs)(M.Z,{split:(0,r.jsx)(l.Z,{type:"vertical"}),children:[(0,r.jsx)(i.Z,{title:(tn=c.data.info)===null||tn===void 0?void 0:tn.Id.substring(0,12)}),(0,r.jsx)(I.Z.Text,{copyable:!0,editable:{tooltip:"\u4FEE\u6539\u5BB9\u5668\u540D\u79F0",onChange:function(){var R=h()(d()().mark(function A(Y){var en,gn;return d()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if((en=c.data.info)!==null&&en!==void 0&&en.Id){k.next=2;break}return k.abrupt("return");case 2:return k.next=4,(0,o.eE)({md5:c.data.info.Id,name:Y});case 4:gn=k.sent,Q(Y),Cn.success(Pn("notification.finish"));case 7:case"end":return k.stop()}},A)}));function L(A){return R.apply(this,arguments)}return L}()},children:(0,f.fi)(nn,"/")})]})}),(0,r.jsx)(j.Z.Item,{label:(0,r.jsx)(m.Z,{title:"\u7F51\u7EDC",help:"\u9ED8\u8BA4\u7F51\u7EDC\u53EA\u652F\u6301\u901A\u8FC7ip\u8BBF\u95EE,ip\u4F1A\u968F\u7740\u5BB9\u5668\u542F\u52A8\u505C\u6B62\u6539\u53D8.\u5982\u679C\u9700\u8981\u5728\u5BB9\u5668\u5185\u4E92\u8054,\u8BF7\u901A\u8FC7\u3010\u7F16\u8F91\u7AD9\u70B9\u3011-\u3010\u6DFB\u52A0\u5173\u8054\u3011"}),children:((dn=c.data.info)===null||dn===void 0?void 0:dn.State.Running)&&(0,r.jsxs)(j.Z,{column:1,bordered:!0,children:[c.data.info.NetworkSettings.Networks&&Object.keys(c.data.info.NetworkSettings.Networks).map(function(R,L){var A,Y,en;return(0,r.jsx)(j.Z.Item,{label:R,children:R=="host"?" Host \u7F51\u7EDC\uFF0C\u4E0E\u5BBF\u4E3B\u673A\u5171\u7528\u540C\u4E00\u7F51\u7EDC":(0,r.jsxs)(M.Z,{direction:"vertical",children:[(0,r.jsx)(i.Z,{title:(A=c.data.info)===null||A===void 0?void 0:A.NetworkSettings.Networks[R].IPAddress}),(Y=c.data.info)===null||Y===void 0?void 0:Y.NetworkSettings.Networks[R].Gateway,(en=c.data.info)===null||en===void 0?void 0:en.NetworkSettings.Networks[R].MacAddress]})},"1")}),c.data.info.HostConfig.ExtraHosts&&(0,r.jsx)(j.Z.Item,{label:"\u5BBF\u4E3B\u673A\u7F51\u7EDC",children:(0,r.jsx)(M.Z,{direction:"vertical",children:c.data.info.HostConfig.ExtraHosts.map(function(R){if(R.indexOf(":")>-1){var L=R.split(":");return(0,r.jsxs)(M.Z,{children:[(0,r.jsx)(i.Z,{title:L[0]})," - ",L[1]]})}})})},"1")]})}),(0,r.jsxs)(j.Z.Item,{label:"\u8FD0\u884C\u65F6\u95F4",children:["\u521B\u5EFA\u4E8E: ",new Date((G=(an=c.data.info)===null||an===void 0?void 0:an.Created)!==null&&G!==void 0?G:"").toLocaleString()," / \u66F4\u65B0\u4E8E: ",new Date((cn=(fn=c.data.info)===null||fn===void 0?void 0:fn.State.StartedAt)!==null&&cn!==void 0?cn:"").toLocaleString()]}),mn.canSeeContainerListManage&&(0,r.jsx)(j.Z.Item,{label:"\u91CD\u542F\u7B56\u7565",children:(0,r.jsx)(v.A,{name:"container-restart",submitter:!1,onValuesChange:function(){var R=h()(d()().mark(function L(A){var Y,en;return d()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if((Y=c.data.info)!==null&&Y!==void 0&&Y.Id){X.next=2;break}return X.abrupt("return");case 2:return X.next=4,(0,o.eE)({md5:c.data.info.Id,restart:A.restart});case 4:return en=X.sent,Cn.success("\u4FEE\u6539\u91CD\u542F\u7B56\u7565\u6210\u529F"),X.abrupt("return");case 7:case"end":return X.stop()}},L)}));return function(L){return R.apply(this,arguments)}}(),layout:"inline",formRef:P,children:(0,r.jsx)(a.Z,{defaultValue:(z=c.data.info)===null||z===void 0?void 0:z.HostConfig.RestartPolicy.Name})})}),(0,r.jsx)(j.Z.Item,{label:"\u73AF\u5883\u53D8\u91CF",children:(0,r.jsx)(t.Z,{dataSource:(hn=(e=c.data.info)===null||e===void 0?void 0:e.Config.Env)!==null&&hn!==void 0?hn:[],renderItem:function(L){var A=L.split("=");return(0,r.jsxs)(t.Z.Item,{children:[(0,r.jsx)(I.Z.Text,{code:!0,children:A[0]})," = ",(0,r.jsx)(I.Z.Text,{copyable:!0,children:A.slice(1).join("=")})]})}})})]})})]})}},57716:function(on,W,n){n.d(W,{Z:function(){return S}});var y=n(5574),d=n.n(y),O=n(15009),h=n.n(O),_=n(99289),U=n.n(_),u=n(67294),x=n(184),v=n(38345),j=n(64317),M=n(5966),l=n(62370),I=n(97462),t=n(42075),g=n(89035),i=n(82346),m=n(28036),a=n(85893);function o(r){var rn=(0,u.useState)({height:210,width:57}),c=d()(rn,2),K=c[0],tn=c[1],dn=function(){var cn=window.innerWidth,fn=window.innerHeight;console.log(cn),tn({height:Math.ceil(fn/16),width:Math.ceil(cn/8)})};(0,u.useEffect)(function(){window.addEventListener("resize",function(){dn()}),dn()},[r]);var G=r.query?Object.keys(r.query).map(function(an){if(r.query)return"".concat(an,"=").concat(r.query[an])}):[];return(0,a.jsx)(i.Link,{target:"_blank",onClick:r.onOpen,to:"/console/"+r.container+"?width=".concat(K.width,"&height=").concat(K.height,"&").concat(G.join("&")),children:(0,a.jsx)(m.ZP,{type:"primary",icon:(0,a.jsx)(g.Z,{}),children:r.content})})}var $=n(60335),F=n(5251),f=n(49610),E=(0,u.forwardRef)(function(r,rn){(0,u.useImperativeHandle)(rn,function(){return{show:function(q,b){return U()(h()().mark(function nn(){var Q,mn,w;return h()().wrap(function(En){for(;;)switch(En.prev=En.next){case 0:return En.next=2,(0,$.jV)({md5:q});case 2:w=En.sent,b&&b!=""&&(w.data.info.Config.WorkingDir=b),hn(w.data.info),an(!0),(Q=c.current)===null||Q===void 0||Q.resetFields(),(mn=c.current)===null||mn===void 0||mn.setFieldsValue({workDir:w.data.info.Config.WorkingDir});case 8:case"end":return En.stop()}},nn)}))()}}});var c=(0,u.useRef)(),K=(0,u.useRef)(),tn=(0,u.useState)(!1),dn=d()(tn,2),G=dn[0],an=dn[1],cn=(0,u.useState)(),fn=d()(cn,2),z=fn[0],hn=fn[1];return(0,u.useEffect)(function(){return z&&setTimeout(function(){var e;(e=K.current)===null||e===void 0||e.start(z.Id,{width:"90",height:"".concat(Math.ceil(window.innerHeight/16)),cmd:"/bin/sh",workDir:z.Config.WorkingDir})},1e3),function(){var e;(e=K.current)===null||e===void 0||e.close()}},[z,G]),(0,a.jsxs)(x.a,{drawerProps:{forceRender:!0},onFinish:function(){var e=U()(h()().mark(function q(b){var nn,Q;return h()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(z){w.next=2;break}return w.abrupt("return",!1);case 2:return(nn=K.current)===null||nn===void 0||nn.close(),(Q=K.current)===null||Q===void 0||Q.start(z.Id,{width:"800",height:"".concat(window.innerHeight),cmd:b.entryCmd,workDir:b.workDir}),w.abrupt("return",!1);case 5:case"end":return w.stop()}},q)}));return function(q){return e.apply(this,arguments)}}(),onValuesChange:function(q,b){if(b.entryCmd){var nn;(nn=c.current)===null||nn===void 0||nn.submit()}},isKeyPressSubmit:!0,open:G,formRef:c,onOpenChange:function(q){if(an(q),!q){var b;(b=K.current)===null||b===void 0||b.close()}},submitter:!1,title:(0,F.fi)(z?z.Name:"","/")+" \u63A7\u5236\u53F0",children:[(0,a.jsx)(v.Z,{ghost:!0,children:(0,a.jsxs)(t.Z.Compact,{children:[(0,a.jsx)(j.Z,{label:"shell",width:"sm",name:"entryCmd",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,a.jsx)(M.Z,{width:"sm",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",disabled:!0}),(0,a.jsx)(l.Z,{label:" ",children:(0,a.jsx)(I.Z,{name:["entryCmd","workDir"],children:function(q){var b=q.entryCmd;return(!b||b=="")&&(b="/bin/sh"),z&&(0,a.jsx)(o,{container:z.Id,query:{cmd:encodeURIComponent(b),workDir:encodeURIComponent(z.Config.WorkingDir)},onOpen:function(){var Q;(Q=K.current)===null||Q===void 0||Q.close(),an(!1)},content:"\u65B0\u7A97\u53E3\u6253\u5F00"})}})})]})}),G&&(0,a.jsx)(f.Z,{showInDrawer:!0,ref:K})]})}),S=E},14245:function(on,W,n){n.d(W,{Z:function(){return U}});var y=n(60433),d=n(38345),O=n(26412),h=n(25593),_=n(85893);function U(u){return(0,_.jsx)(d.Z,{ghost:u.ghost,title:(0,_.jsx)(y.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",children:(0,_.jsxs)(O.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,_.jsx)(O.Z.Item,{label:"Image Tag",children:(0,_.jsx)(h.Z.Text,{copyable:!0,children:u.data.Config.Image})}),(0,_.jsx)(O.Z.Item,{label:"Image",children:u.data.Image}),(0,_.jsx)(O.Z.Item,{label:"CMD",children:u.data.Config.Cmd&&u.data.Config.Cmd.join(" ")}),(0,_.jsx)(O.Z.Item,{label:"ENTRYPOINT",children:u.data.Config.Entrypoint}),(0,_.jsx)(O.Z.Item,{label:"Labels",children:(0,_.jsx)(O.Z,{column:1,bordered:!0,children:u.data&&Object.keys(u.data.Config.Labels).map(function(x){return(0,_.jsx)(O.Z.Item,{label:x,children:u.data.Config.Labels[x]},x)})})})]})})}},72409:function(on,W,n){n.d(W,{Z:function(){return Pn}});var y=n(15009),d=n.n(y),O=n(99289),h=n.n(O),_=n(5574),U=n.n(_),u=n(67294),x=n(80821),v=n(62597),j=n(60335),M=n(43425),l=n(58638),I=n(60219),t=n(86548),g=n(57132),i=n(87784),m=n(25035),a=n(38345),o=n(97269),$=n(62370),F=n(5966),f=n(52688),E=n(82346),S=n(42075),r=n(65233),rn=n(96074),c=n(28036),K=n(25593),tn=n(85418),dn=n(40411),G=n(84567),an=n(83062),cn=n(93162),fn=n(24739),z=n(97462),hn=n(70146),e=n(85893);function q(P){var ln=(0,u.useRef)(),Dn=(0,E.useAccess)();return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(x.Z,{icon:(0,e.jsx)(I.Z,{}),action:h()(d()().mark(function sn(){var un,H,J,_n;return d()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,hn.yB)({id:P.container.Name,enableImage:(un=ln.current)===null||un===void 0?void 0:un.getFieldValue("enableImage"),volume:Object.keys((H=(J=ln.current)===null||J===void 0?void 0:J.getFieldValue("volume"))!==null&&H!==void 0?H:{}).filter(function(A){return A}),enableCommitImage:(_n=ln.current)===null||_n===void 0?void 0:_n.getFieldValue("enableCommitImage")});case 2:case"end":return L.stop()}},sn)})),confirmOnOpenChange:function(un){var H,J;!((H=ln.current)===null||H===void 0)&&H.resetFields&&((J=ln.current)===null||J===void 0||J.resetFields())},confirm:(0,e.jsxs)(S.Z,{style:{width:650,marginTop:"10px",paddingRight:"10px"},direction:"vertical",size:20,children:[(0,e.jsx)(K.Z.Text,{children:(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:"\u5FEB\u7167\u529F\u80FD\u4F1A\u5C06\u3010\u5FEB\u7167\u6570\u636E\u3011\u4FDD\u5B58\u81F3 /dpanel/backup \u76EE\u5F55\u3002"}),(0,e.jsx)("li",{children:"\u5FEB\u7167\u540C\u65F6\u5907\u4EFD\u5BB9\u5668\u955C\u50CF\u5728\u6062\u590D\u540E\u65E0\u6CD5\u68C0\u6D4B\u66F4\u65B0\uFF0C\u5426\u5219\u6062\u590D\u65F6\u4F1A\u5148\u5C1D\u8BD5\u62C9\u53D6\u955C\u50CF"}),(0,e.jsx)("li",{children:"\u6062\u590D\u5FEB\u7167\u65F6\uFF0C\u5982\u679C\u76EE\u6807\u5BB9\u5668\u5DF2\u5B58\u5728\u5219\u53EA\u6062\u590D\u5BB9\u5668\u6570\u636E\u3002"}),(0,e.jsxs)("li",{children:["\u8BE5\u64CD\u4F5C\u53EF\u80FD\u4F1A\u6D88\u8017\u8F83\u957F\u65F6\u95F4\uFF0C\u8BF7\u5728 ",(0,e.jsx)(E.Link,{to:"/app/backup",children:"\u5BB9\u5668\u5FEB\u7167"})," \u67E5\u770B\u5FEB\u7167\u7ED3\u679C\u3002"]})]})}),(0,e.jsxs)(o.A,{layout:"horizontal",formRef:ln,submitter:!1,children:[(0,e.jsxs)(fn.UW,{children:[(0,e.jsx)($.Z,{valuePropName:"checked",name:"enableSelectVolume",children:(0,e.jsx)(G.Z,{disabled:!P.container.Mounts||P.container.Mounts.length==0,children:"\u9009\u62E9\u5907\u4EFD\u76EE\u5F55\uFF1F"})}),(0,e.jsx)($.Z,{valuePropName:"checked",name:"enableImage",children:(0,e.jsx)(G.Z,{children:"\u5907\u4EFD\u5BB9\u5668\u955C\u50CF\uFF1F"})}),(0,e.jsx)(z.Z,{name:["enableImage"],children:function(un){var H=un.enableImage;if(H)return(0,e.jsx)($.Z,{valuePropName:"checked",name:"enableCommitImage",children:(0,e.jsx)(G.Z,{children:"\u4FDD\u5B58\u5F53\u524D\u5BB9\u5668\u4E3A\u65B0\u955C\u50CF (docker commit)\uFF1F"})})}})]}),(0,e.jsx)(z.Z,{name:["enableSelectVolume"],children:function(un){var H=un.enableSelectVolume;return H&&(0,e.jsx)(S.Z,{wrap:!0,children:P.container.Mounts.map(function(J,_n){return(0,e.jsx)($.Z,{valuePropName:"checked",name:["volume",J.Destination],children:(0,e.jsx)(G.Z,{children:J.Destination})},"volume-".concat(_n))})})}})]})]}),children:"\u5BB9\u5668\u5FEB\u7167"})})}var b=n(24963),nn=n(99861),Q=n(3393),mn=n(50888),w=n(16596),Cn=n(1699),En=n(5251),In=(0,u.forwardRef)(function(P,ln){var Dn;(0,u.useImperativeHandle)(ln,function(){return{}});var sn=(0,u.useRef)(),un=(0,u.useRef)(),H=(0,u.useRef)(),J=(0,u.useContext)(b.Z),_n=J.message,R=J.notice,L=J.loading,A=J.lang,Y=(0,u.useRef)(),en=(0,u.useRef)(),gn=(0,u.useState)(0),X=U()(gn,2),k=X[0],vn=X[1],On=function(){var N=h()(d()().mark(function D(s){var B,C,Z;return d()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(C=-2,!s.ignore){T.next=6;break}if(!(s.ignore.indexOf("".concat(s.info.Name,"@*"))>-1)){T.next=4;break}return T.abrupt("return",-2);case 4:if(!(s.ignore.indexOf("".concat(s.info.Name,"@").concat(s.info.Image))>-1)){T.next=6;break}return T.abrupt("return",-2);case 6:return T.next=8,(0,Q.ZQ)({tag:(B=s.info.Config.Image)!==null&&B!==void 0?B:"",md5:s.info.Image,cacheTime:3600}).catch(function(p){C=-1});case 8:return Z=T.sent,Z&&(Z.data.digestLocal&&Z.data.digestLocal.length>0?C=Z.data.upgrade?1:2:C=-2),T.abrupt("return",C);case 11:case"end":return T.stop()}},D)}));return function(s){return N.apply(this,arguments)}}();return(0,u.useEffect)(function(){P.checkContainerUpgrade&&(vn(0),On(P.data).then(function(N){vn(N)}))},[P.data]),(0,e.jsx)(a.Z,{ghost:P.ghost,title:(0,e.jsx)(M.Z,{}),subTitle:"\u5BB9\u5668\u7BA1\u7406",children:(0,e.jsxs)(S.Z,{wrap:!0,children:[(0,e.jsx)(x.Z,{icon:(0,e.jsx)(l.Z,{}),action:function(){var D,s;return(0,j.LJ)({md5:(D=(s=P.data)===null||s===void 0?void 0:s.info.Id)!==null&&D!==void 0?D:""})},confirm:"\u5BFC\u51FA\u5BB9\u5668\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u4E0D\u5305\u542B\u6302\u8F7D\u76EE\u5F55\u7684\u6570\u636E\uFF0C\u786E\u5B9A\u5417\uFF1F",onSuccess:function(D){var s,B=new Blob([D],{type:"application/tar"});(0,cn.saveAs)(B,(0,En.fi)((s=P.data)===null||s===void 0?void 0:s.info.Name,"/")+".tar")},children:"\u5BFC\u51FA\u5BB9\u5668"}),(0,e.jsx)(x.Z,{icon:(0,e.jsx)(I.Z,{}),action:h()(d()().mark(function N(){var D,s,B,C,Z;return d()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,j.Re)({md5:(D=(s=P.data)===null||s===void 0?void 0:s.info.Id)!==null&&D!==void 0?D:"",name:(B=(C=un.current)===null||C===void 0?void 0:C.getFieldValue("saveImageName"))!==null&&B!==void 0?B:(Z=P.data)===null||Z===void 0?void 0:Z.info.Name});case 2:case"end":return T.stop()}},N)})),confirmTitle:"\u5C06\u5F53\u524D\u5BB9\u5668\u4FDD\u5B58\u4E3A\u955C\u50CF",confirm:(0,e.jsx)(S.Z,{style:{width:400,marginTop:"10px",paddingRight:"10px"},direction:"vertical",children:(0,e.jsx)(o.A,{formRef:un,submitter:!1,children:(0,e.jsx)($.Z,{name:"saveImageName",children:(0,e.jsx)(r.Z,{addonBefore:"\u955C\u50CF\u540D\u79F0"})})})}),children:"\u53E6\u5B58\u4E3A\u955C\u50CF"}),P.data&&(0,e.jsx)(Cn.u,{access:"canSeeContainerBackup",children:(0,e.jsx)(q,{container:P.data.info})}),(0,e.jsx)(rn.Z,{type:"vertical"}),(0,e.jsx)(E.Link,{to:"/app/create/image?id=".concat((Dn=P.data)===null||Dn===void 0?void 0:Dn.info.Id,"&op=update"),children:(0,e.jsx)(c.ZP,{type:"primary",icon:(0,e.jsx)(t.Z,{}),children:"\u7F16\u8F91\u5BB9\u5668"})}),(0,e.jsx)(x.Z,{icon:(0,e.jsx)(g.Z,{}),action:h()(d()().mark(function N(){var D,s,B,C,Z,V;return d()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,j.aF)({md5:(D=(s=P.data)===null||s===void 0?void 0:s.info.Id)!==null&&D!==void 0?D:"",copyName:(B=(C=H.current)===null||C===void 0?void 0:C.getFieldValue("copyName"))!==null&&B!==void 0?B:"",enableRandomPort:(Z=(V=H.current)===null||V===void 0?void 0:V.getFieldValue("enableRandomPort"))!==null&&Z!==void 0?Z:!1});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},N)})),confirm:(0,e.jsxs)(S.Z,{style:{width:400,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(K.Z.Text,{children:"\u9ED8\u8BA4\u60C5\u51B5\u4E0B, \u590D\u5236\u7684\u76EE\u6807\u5BB9\u5668\u4E0E\u5F53\u524D\u5BB9\u5668\u5177\u6709\u76F8\u540C\u7684\u914D\u7F6E\u65E0\u6CD5\u542F\u52A8\u3002 \u5982\u679C\u4F60\u5E0C\u671B\u76EE\u6807\u5BB9\u5668\u6B63\u5E38\u8FD0\u884C\uFF0C\u8BF7\u5F00\u542F\u3010\u7ED1\u5B9A\u968F\u673A\u7AEF\u53E3\u3011"}),(0,e.jsxs)(o.A,{formRef:H,submitter:!1,layout:"horizontal",children:[(0,e.jsx)("br",{}),(0,e.jsx)(F.Z,{label:"\u590D\u5236\u5BB9\u5668\u540D\u79F0",name:"copyName"}),(0,e.jsx)(f.Z,{label:"\u7ED1\u5B9A\u968F\u673A\u7AEF\u53E3",name:"enableRandomPort"})]})]}),onSuccess:function(D){var s;(s=H.current)===null||s===void 0||s.resetFields()},children:"\u590D\u5236\u5BB9\u5668"}),P.data&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(nn.Z,{image:[P.data.info.Config.Image],ref:Y}),(0,e.jsx)(tn.Z,{placement:"bottomLeft",menu:{items:[{key:"1",label:(0,e.jsx)(x.Z,{action:h()(d()().mark(function N(){var D,s,B,C,Z,V;return d()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,v.ze)({md5:(D=(s=P.data.info)===null||s===void 0?void 0:s.Name)!==null&&D!==void 0?D:"",imageId:""});case 2:return vn(0),p.next=5,(0,Q.ZQ)({tag:(B=(C=P.data.info)===null||C===void 0?void 0:C.Config.Image)!==null&&B!==void 0?B:"",md5:(Z=(V=P.data.info)===null||V===void 0?void 0:V.Image)!==null&&Z!==void 0?Z:"",cacheTime:0}).then(function(jn){jn.data.digestLocal&&jn.data.digestLocal.length>0?vn(jn.data.upgrade?1:2):vn(-2)}).catch(function(jn){vn(-1)});case 5:return p.abrupt("return",p.sent);case 6:case"end":return p.stop()}},N)})),type:"link",children:"\u81EA\u52A8\u68C0\u6D4B"})},{key:"2",label:(0,e.jsx)(x.Z,{action:h()(d()().mark(function N(){var D,s,B,C;return d()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,(0,v.ze)({md5:(D=(s=P.data.info)===null||s===void 0?void 0:s.Name)!==null&&D!==void 0?D:"",imageId:(B=(C=P.data.info)===null||C===void 0?void 0:C.Image)!==null&&B!==void 0?B:""});case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},N)})),type:"link",children:"\u5FFD\u7565\u672C\u6B21"})},{key:"3",label:(0,e.jsx)(x.Z,{action:h()(d()().mark(function N(){var D,s;return d()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,v.ze)({md5:(D=(s=P.data.info)===null||s===void 0?void 0:s.Name)!==null&&D!==void 0?D:"",imageId:"*"});case 2:return C.abrupt("return",C.sent);case 3:case"end":return C.stop()}},N)})),type:"link",children:"\u6C38\u4E45\u5FFD\u7565"})}]},children:(0,e.jsx)(dn.Z,{count:A("app.detail.checkImageUpgrade."+k),color:A("app.detail.checkImageUpgradeColor."+k),children:(0,e.jsx)(x.Z,{disabled:k===0,icon:k===0?(0,e.jsx)(mn.Z,{}):(0,e.jsx)(w.Z,{}),action:h()(d()().mark(function N(){var D,s,B,C,Z;return d()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(D=Y.current)===null||D===void 0?void 0:D.start();case 2:return L.show(),(s=Y.current)===null||s===void 0||s.finish(),T.next=6,(0,j.RF)({md5:(B=P.data.info.Id)!==null&&B!==void 0?B:"",imageTag:"",enableBak:(C=(Z=en.current)===null||Z===void 0?void 0:Z.getFieldValue("enableBak"))!==null&&C!==void 0?C:!1});case 6:return T.abrupt("return",T.sent);case 7:case"end":return T.stop()}},N)})),confirm:(0,e.jsxs)(S.Z,{style:{width:280,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(K.Z.Text,{children:A("app.detail.upgradeConfirm")}),(0,e.jsx)(o.A,{formRef:en,submitter:!1,layout:"inline",children:(0,e.jsx)($.Z,{name:"enableBak",valuePropName:"checked",children:(0,e.jsx)(G.Z,{children:"\u5907\u4EFD\u65E7\u5BB9\u5668\uFF1F"})})})]}),onSuccess:function(D){L.destroy(),P.checkContainerUpgrade&&P.checkContainerUpgrade()},children:"\u5FEB\u901F\u5347\u7EA7\u5BB9\u5668"})})})]}),(0,e.jsx)(rn.Z,{type:"vertical"}),P.data&&(0,e.jsx)(x.Z,{action:function(){var D,s,B,C,Z,V;return(0,v.Ct)({md5:(D=(s=P.data)===null||s===void 0?void 0:s.info.Id)!==null&&D!==void 0?D:"",deleteImage:(B=(C=sn.current)===null||C===void 0?void 0:C.getFieldValue("deleteImage"))!==null&&B!==void 0?B:!1,deleteVolume:(Z=(V=sn.current)===null||V===void 0?void 0:V.getFieldValue("deleteVolume"))!==null&&Z!==void 0?Z:!1})},danger:!0,type:"primary",icon:(0,e.jsx)(i.Z,{}),onSuccess:function(){L.destroy(),P.checkContainerUpgrade&&P.checkContainerUpgrade()},confirm:(0,e.jsxs)(S.Z,{style:{width:200},direction:"vertical",children:[(0,e.jsx)(K.Z.Text,{children:A("notification.confirm.title")}),(0,e.jsxs)(o.A,{formRef:sn,layout:"inline",submitter:!1,children:[(0,e.jsx)($.Z,{addonAfter:(0,e.jsx)(an.Z,{title:"\u672A\u6302\u8F7D\u955C\u50CF\u5185\u58F0\u660E\u7684\u76EE\u5F55\u5E76\u7531 docker \u81EA\u52A8\u521B\u5EFA\u7684\u5B58\u50A8\u5377",children:(0,e.jsx)(m.Z,{})}),name:"deleteVolume",valuePropName:"checked",children:(0,e.jsx)(G.Z,{children:"\u5220\u9664\u533F\u540D\u5B58\u50A8\u5377\uFF1F"})}),(0,e.jsx)($.Z,{name:"deleteImage",valuePropName:"checked",children:(0,e.jsx)(G.Z,{children:"\u5220\u9664\u955C\u50CF\uFF1F"})})]})]}),children:"\u5220\u9664"})]})})}),Pn=In},14189:function(on,W,n){var y=n(43425),d=n(74842),O=n(87784),h=n(33160),_=n(30159),U=n(89035),u=n(38345),x=n(42075),v=n(96074),j=n(28036),M=n(67294),l=n(94359),I=n(80821),t=n(60335),g=n(57716),i=n(85893),m=(0,M.forwardRef)(function(a,o){(0,M.useImperativeHandle)(o,function(){return{}});var $=(0,M.useRef)();return(0,i.jsx)(u.Z,{title:(0,i.jsx)(y.Z,{}),ghost:a.ghost,subTitle:(0,i.jsxs)(x.Z,{children:["\u72B6\u6001\u7BA1\u7406 - ",a.data&&(0,i.jsx)(l.Z,{status:a.data.State.Status,message:{content:a.data.State.Status,placement:"top"}})]}),children:(0,i.jsxs)(x.Z,{wrap:!0,children:[(0,i.jsx)(I.Z,{icon:(0,i.jsx)(d.Z,{}),action:function(){var f,E;return(0,t.IW)({md5:(f=(E=a.data)===null||E===void 0?void 0:E.Id)!==null&&f!==void 0?f:"",operate:"start"})},onSuccess:function(){return a.onFinish&&a.onFinish()},disabled:a.data&&a.data.State.Running||a.data&&a.data.State.Paused,children:"\u542F\u52A8"}),(0,i.jsx)(I.Z,{action:function(){var f,E;return(0,t.IW)({md5:(f=(E=a.data)===null||E===void 0?void 0:E.Id)!==null&&f!==void 0?f:"",operate:"stop"})},icon:(0,i.jsx)(O.Z,{}),onSuccess:function(){return a.onFinish&&a.onFinish()},disabled:a.data&&a.data.State.Dead,children:"\u505C\u6B62"}),(0,i.jsx)(I.Z,{action:function(){var f,E;return(0,t.IW)({md5:(f=(E=a.data)===null||E===void 0?void 0:E.Id)!==null&&f!==void 0?f:"",operate:"restart"})},onSuccess:function(){return a.onFinish&&a.onFinish()},icon:(0,i.jsx)(h.Z,{}),children:"\u91CD\u542F"}),(0,i.jsx)(I.Z,{action:function(){var f,E;return(0,t.IW)({md5:(f=(E=a.data)===null||E===void 0?void 0:E.Id)!==null&&f!==void 0?f:"",operate:"pause"})},onSuccess:function(){return a.onFinish&&a.onFinish()},icon:(0,i.jsx)(_.Z,{}),disabled:a.data&&a.data&&!a.data.State.Running,children:"\u6682\u505C"}),(0,i.jsx)(I.Z,{action:function(){var f,E;return(0,t.IW)({md5:(f=(E=a.data)===null||E===void 0?void 0:E.Id)!==null&&f!==void 0?f:"",operate:"unpause"})},onSuccess:function(){return a.onFinish&&a.onFinish()},icon:(0,i.jsx)(d.Z,{}),disabled:a.data&&!a.data.State.Paused,children:"\u6062\u590D"}),(0,i.jsx)(v.Z,{type:"vertical"}),a.data&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g.Z,{ref:$}),(0,i.jsx)(j.ZP,{type:"dashed",onClick:function(){var f;a.data&&((f=$.current)===null||f===void 0||f.show(a.data.Id))},icon:(0,i.jsx)(U.Z,{}),children:"Console"})]}),(0,i.jsx)(v.Z,{type:"vertical"}),a.extra&&a.extra.map(function(F,f){return(0,i.jsx)("span",{children:F},f)})]})})});W.Z=m},52031:function(on,W,n){n.d(W,{Z:function(){return x}});var y=n(31574),d=n(95591),O=n(38345),h=n(26412),_=n(78451),U=n(82346),u=n(85893);function x(v){var j,M=(0,U.useAccess)();return v.data&&v.data.Mounts&&v.data.Mounts.length>0&&(0,u.jsx)(O.Z,{ghost:v.ghost,title:(0,u.jsx)(y.Z,{}),subTitle:"\u6302\u8F7D\u76EE\u5F55\u8BE6\u60C5",children:(0,u.jsx)(h.Z,{column:1,bordered:!0,children:(j=v.data)===null||j===void 0?void 0:j.Mounts.map(function(l,I){var t;return(0,u.jsx)(h.Z.Item,{labelStyle:{width:"30%"},label:l.Type=="volume"?(0,u.jsx)(_.Z,{content:l.Name}):l.Source,children:M.canSeeContainerListManage?(0,u.jsxs)(U.Link,{target:"_blank",to:"/app/detail/file/".concat((t=v.data)===null||t===void 0?void 0:t.Id,"?tab=file&path=").concat(encodeURIComponent(l.Destination)),children:[l.Destination," ",(0,u.jsx)(d.Z,{})]}):l.Destination},I)})})})}},49610:function(on,W,n){var y=n(67294),d=n(54964),O=n(52626),h=n(12320),_=n.n(h),U=n(78267),u=n.n(U),x=n(85893),v,j=new h.Terminal(d.a),M=new U.FitAddon,l,I=(0,y.forwardRef)(function(t,g){var i=function(){j.reset(),M.fit(),j.focus(),l&&l.dispose(),v&&(v.close(),v=null)};return(0,y.useImperativeHandle)(g,function(){return{start:function(a,o){var $="console:"+a,F=o?Object.keys(o).map(function(f){if(o&&o[f])return"".concat(f,"=").concat(o[f])}):[];i(),v=new WebSocket((0,O.R)("/console/"+a+"?"+F.join("&"))),v.addEventListener("message",function(f){var E=JSON.parse(f.data),S=E.type;if(S==$&&(j.write(E.data),E.data.indexOf("exec failed")!=-1)){i();return}}),l=j.onData(function(f){var E={content:{command:f},type:$};v&&v.send(JSON.stringify(E))})},close:function(){i()},fit:function(){M.fit()}}}),(0,y.useEffect)(function(){return j.loadAddon(M),j.open(document.getElementById("terminal-container-console")),M.fit(),function(){i()}},[]),(0,x.jsx)("div",{style:{height:t.showInDrawer?"75vh":"100vh"},id:"terminal-container-console"})});W.Z=I},94359:function(on,W,n){n.d(W,{Z:function(){return I}});var y=n(3089),d=n(98165),O=n(18429),h=n(8751),_=n(14313),U=n(30159),u=n(87740),x=n(50888),v=n(66309),j=n(83062),M=n(82346),l=n(85893);function I(t){var g=(0,l.jsx)(l.Fragment,{});if(t.status=="0"&&(g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(y.Z,{}),color:"default",children:"waiting"})),t.status=="10"&&(g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(d.Z,{spin:!0}),color:"processing",children:"processing"})),t.status=="20"&&(g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(O.Z,{}),color:"error",children:"error"})),t.status=="30"&&(g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(h.Z,{}),color:"success",children:"success"})),t.status=="running"||t.status=="healthy"){var i,m;g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(_.Z,{}),color:"success",children:(i=t.message)!==null&&i!==void 0&&i.showInTag?(m=t.message)===null||m===void 0?void 0:m.content:t.status})}if(t.status=="paused"){var a,o;g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(U.Z,{}),children:(a=t.message)!==null&&a!==void 0&&a.showInTag?(o=t.message)===null||o===void 0?void 0:o.content:t.status})}if(t.status=="waiting"||t.status=="starting"){var $,F;g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(u.Z,{}),children:($=t.message)!==null&&$!==void 0&&$.showInTag?(F=t.message)===null||F===void 0?void 0:F.content:t.status})}if(t.status=="deploying"){var f,E;g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(x.Z,{}),color:"processing",children:(f=t.message)!==null&&f!==void 0&&f.showInTag?(E=t.message)===null||E===void 0?void 0:E.content:t.status})}if(t.status=="error"){var S,r;g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(O.Z,{}),color:"error",children:(S=t.message)!==null&&S!==void 0&&S.showInTag?(r=t.message)===null||r===void 0?void 0:r.content:t.status})}if(t.status=="exited"||t.status=="dead"||t.status=="removing"||t.status=="restarting"||t.status=="unhealthy"||t.status=="created"){var rn,c;g=(0,l.jsx)(v.Z,{icon:(0,l.jsx)(O.Z,{}),color:"warning",children:(rn=t.message)!==null&&rn!==void 0&&rn.showInTag?(c=t.message)===null||c===void 0?void 0:c.content:t.status})}if(t.link)return(0,l.jsx)(M.Link,{to:t.link,children:g});if(t.message){var K,tn;return(0,l.jsx)(j.Z,{placement:(K=t.message.placement)!==null&&K!==void 0?K:"top",title:(tn=t.message.title)!==null&&tn!==void 0?tn:t.message.content,children:g})}return g}},76428:function(on,W,n){n.d(W,{Z:function(){return h}});var y=n(25593),d=n(67294),O=n(85893);function h(_){return(0,O.jsx)(y.Z.Text,{copyable:!0,children:_.title})}},78498:function(on,W,n){n.d(W,{Z:function(){return U}});var y=n(25035),d=n(42075),O=n(83062),h=n(67294),_=n(85893);function U(u){return(0,_.jsxs)(d.Z,{children:[u.title,(0,_.jsx)(O.Z,{title:u.help,children:(0,_.jsx)(y.Z,{})})]})}},54964:function(on,W,n){n.d(W,{a:function(){return l}});var y=n(5574),d=n.n(y),O=n(78267),h=n.n(O),_=n(75458),U=n.n(_),u=n(67294),x=n(12320),v=n.n(x),j=n(89629),M=n(85893),l={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},I=new x.Terminal(l),t=new _.SearchAddon,g=new O.FitAddon,i=(0,u.forwardRef)(function(m,a){var o,$=(0,u.useState)(!0),F=d()($,2),f=F[0],E=F[1];return(0,u.useEffect)(function(){return window.addEventListener("resize",function(){m.showInModal||g.fit()}),m.style&&m.style.fontSize&&(I.options.fontSize=m.style.fontSize),I.loadAddon(g),I.loadAddon(t),I.open(document.getElementById(m.id?m.id:"terminal-container")),m.showInModal||g.fit(),function(){I.reset(),E(!0)}},[]),(0,u.useImperativeHandle)(a,function(){return{write:function(r){f&&(g.fit(),E(!1)),I.write(r)},clear:function(){I.clear()},getTerminal:function(){return I},findNext:function(r){t.findNext(r)},findPrev:function(r){t.findPrevious(r)},fit:function(){g.fit()},onData:function(r){return I.onData(r)}}}),(0,M.jsx)("div",{id:m.id?m.id:"terminal-container",style:{width:m.width?m.width:"100%",height:m.height?m.height:"500px",marginTop:(o=m.style)===null||o===void 0?void 0:o.marginTop}})});W.Z=i},70146:function(on,W,n){n.d(W,{SR:function(){return l},VE:function(){return j},Zy:function(){return x},iD:function(){return t},yB:function(){return U}});var y=n(15009),d=n.n(y),O=n(99289),h=n.n(O),_=n(82346);function U(i){return u.apply(this,arguments)}function u(){return u=h()(d()().mark(function i(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,_.request)("/api/app/container-backup/create",{data:m,method:"POST"});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},i)})),u.apply(this,arguments)}function x(i){return v.apply(this,arguments)}function v(){return v=h()(d()().mark(function i(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,_.request)("/api/app/container-backup/get-list",{method:"POST",data:m}));case 1:case"end":return o.stop()}},i)})),v.apply(this,arguments)}function j(i){return M.apply(this,arguments)}function M(){return M=h()(d()().mark(function i(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,_.request)("/api/app/container-backup/delete",{method:"POST",data:m}));case 1:case"end":return o.stop()}},i)})),M.apply(this,arguments)}function l(i){return I.apply(this,arguments)}function I(){return I=h()(d()().mark(function i(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,_.request)("/api/app/container-backup/restore",{method:"POST",data:m}));case 1:case"end":return o.stop()}},i)})),I.apply(this,arguments)}function t(i){return g.apply(this,arguments)}function g(){return g=h()(d()().mark(function i(m){return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,_.request)("/api/app/container-backup/get-detail",{method:"POST",data:m}));case 1:case"end":return o.stop()}},i)})),g.apply(this,arguments)}}}]);
