"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8272],{85578:function(oe,X,e){var Y=e(15009),h=e.n(Y),J=e(99289),O=e.n(J),q=e(97857),U=e.n(q),o=e(67294),w=e(62597),k=e(97269),b=e(62370),H=e(5966),V=e(97462),W=e(82346),G=e(71230),B=e(15746),u=e(34041),N=e(28036),z=e(84567),ee=e(42075),ne=e(54964),y=e(80821),$=e(23430),K=e(93162),l=e.n(K),n=e(60335),f=e(12320),s=e.n(f),L=e(78267),C=e.n(L),x=e(75458),te=e.n(x),t=e(85893),T=new f.Terminal(U()(U()({},ne.a),{},{fontSize:12})),Q=new L.FitAddon,g=new x.SearchAddon,I=(0,o.forwardRef)(function(r,A){(0,o.useImperativeHandle)(A,function(){return{fit:function(){T.clear(),Q.fit()},start:function(){return O()(h()().mark(function v(){return h()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,F({md5:r.id,lineTotal:500});case 2:case"end":return m.stop()}},v)}))()},close:function(){S.progress.close("container:log:"+r.id)}}});var i=(0,o.useRef)(),E=(0,W.useModel)("@@initialState"),M=E.initialState,d=E.loading,c=E.error,Z=E.refresh,a=E.setInitialState,S=(0,W.useModel)("subscriber");S.addDataHandler("container:log:"+r.id,function(R){T.write(R.data.replaceAll(`
`,`

`))});var F=function(){var R=O()(h()().mark(function v(_){var m;return h()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return T.clear(),_.md5=r.id,_.download=!1,P.next=5,(0,w.Tb)(_);case 5:m=P.sent;case 6:case"end":return P.stop()}},v)}));return function(_){return R.apply(this,arguments)}}();return(0,o.useEffect)(function(){return T.loadAddon(Q),T.open(document.getElementById("terminal-container-log")),Q.fit(),function(){T.clear(),T.reset(),S.progress.close("container:log:"+r.id)}},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.A,{submitter:!1,layout:"horizontal",onValuesChange:function(v,_){F({md5:r.id,lineTotal:parseInt(_.lineTotal),showTime:_.showTime})},formRef:i,children:(0,t.jsxs)(G.Z,{gutter:[10,0],children:[(0,t.jsx)(B.Z,{span:8,children:(0,t.jsx)(b.Z,{name:"lineTotal",initialValue:"500",label:"\u83B7\u53D6\u65E5\u5FD7\u6761\u6570",children:(0,t.jsxs)(u.Z,{defaultValue:"500",children:[(0,t.jsx)(u.Z.Option,{value:"100",children:"100\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(u.Z.Option,{value:"200",children:"200\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(u.Z.Option,{value:"500",children:"500\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(u.Z.Option,{value:"1000",children:"1000\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(u.Z.Option,{value:"-1",children:"\u5168\u90E8\uFF08\u4E0B\u8F7D\u53EF\u89C1\uFF09"})]})})}),(0,t.jsx)(B.Z,{children:(0,t.jsx)(N.ZP,{onClick:function(){T.clear()},children:"\u6E05\u5C4F"})}),(0,t.jsx)(B.Z,{children:(0,t.jsx)(b.Z,{name:"showTime",valuePropName:"checked",children:(0,t.jsx)(z.Z,{children:"\u663E\u793A\u65F6\u95F4"})})}),(0,t.jsx)(B.Z,{children:(0,t.jsx)(H.Z,{label:"\u67E5\u627E",name:"keywork"})}),(0,t.jsx)(B.Z,{children:(0,t.jsx)(V.Z,{name:["keywork"],children:function(v){var _=v.keywork;return(0,t.jsxs)(ee.Z,{size:10,children:[(0,t.jsx)(N.ZP,{onClick:function(){g.findNext(_)},children:"\u4E0B\u4E00\u4E2A"},"next"),(0,t.jsx)(N.ZP,{onClick:function(){g.findPrevious(_)},children:"\u4E0A\u4E00\u4E2A"},"prev")]})}})}),(0,t.jsx)(B.Z,{children:(0,t.jsx)(y.Z,{icon:(0,t.jsx)($.Z,{}),action:function(){var v,_,m;return(0,w.XH)({md5:(v=r.id)!==null&&v!==void 0?v:"",lineTotal:parseInt((_=i.current)===null||_===void 0?void 0:_.getFieldValue("lineTotal")),showTime:(m=i.current)===null||m===void 0?void 0:m.getFieldValue("showTime")})},onSuccess:function(v){var _;(0,n.jV)({md5:(_=r.id)!==null&&_!==void 0?_:""}).then(function(m){var D=new Blob([v],{type:"text/plain"});(0,K.saveAs)(D,m.data.info.Name.replaceAll("/","")+"_"+new Date().toLocaleDateString()+".log")})},children:"\u4E0B\u8F7D\u65E5\u5FD7"})})]})}),(0,t.jsx)("div",{style:{marginTop:"20px",height:r.showInDrawer?"75vh":"580px"},id:"terminal-container-log"})]})});X.Z=I},43831:function(oe,X,e){var Y=e(15009),h=e.n(Y),J=e(99289),O=e.n(J),q=e(5574),U=e.n(q),o=e(67294),w=e(14946),k=e(43425),b=e(48689),H=e(38345),V=e(10641),W=e(42075),G=e(25593),B=e(83062),u=e(60335),N=e(78498),z=e(80821),ee=e(10032),ne=e(5251),y=e(28230),$=e(46442),K=e(78451),l=e(85893),n=(0,o.forwardRef)(function(f,s){var L;(0,o.useImperativeHandle)(s,function(){return{}});var C=(0,o.useRef)(),x=(0,o.useRef)(),te=(0,o.useState)(),t=U()(te,2),T=t[0],Q=t[1];return(0,o.useEffect)(function(){var g,I;Q(f.containerInfo),!((g=C.current)===null||g===void 0)&&g.reloadAndRest&&((I=C.current)===null||I===void 0||I.reloadAndRest())},[f.containerInfo]),(0,l.jsxs)(H.Z,{ghost:f.ghost,children:[(0,l.jsx)(ee.Z,{ref:x}),(0,l.jsx)(V.Z,{scroll:{x:"max-content"},rowKey:"key",actionRef:C,pagination:!1,columns:[{title:"\u6240\u5C5E\u7F51\u7EDC",key:"name",dataIndex:"networkName"},{title:"\u5BB9\u5668\u540D\u79F0",key:"containerName",dataIndex:"containerName",width:100,render:function(I,r,A,i,E){return(0,l.jsx)(K.Z,{content:(0,ne.fi)(r.containerName,"/")})}},{title:(0,l.jsx)(N.Z,{title:"hostname",help:"\u63D0\u4F9B\u5BB9\u5668\u5185\u90E8\u8BBF\u95EE"}),key:"hostName",render:function(I,r,A){return r.hostName?(0,l.jsx)(W.Z,{direction:"vertical",children:r.hostName.map(function(i){if(i)return(0,l.jsx)(G.Z.Text,{copyable:!0,keyboard:!0,children:i},i)})}):(0,l.jsx)(l.Fragment,{})}},{title:"Ip",key:"ip",render:function(I,r,A,i,E){return(0,l.jsxs)(W.Z,{direction:"vertical",children:[(0,l.jsx)("span",{children:r.networkInfo.IPv4Address}),r.networkInfo.IPv6Address&&(0,l.jsx)("span",{children:r.networkInfo.IPv6Address})]})}},{title:"\u64CD\u4F5C",key:"option",width:50,fixed:"right",render:function(I,r,A,i,E){return(0,l.jsxs)(W.Z,{children:[r.networkName!=""&&(0,l.jsx)(G.Z.Link,{onClick:function(){var d;(d=x.current)===null||d===void 0||d.show(r.networkName)},children:(0,l.jsx)(B.Z,{title:"\u7BA1\u7406",children:(0,l.jsx)(k.Z,{})})}),r.key!="bridge"&&r.key!="none"&&r.key!="host"&&r.networkName!=""&&(0,l.jsx)(z.Z,{type:"link",action:function(){return(0,w.t9)({name:r.networkName,containerName:f.containerInfo.Name})},onSuccess:function(){var d,c;!((d=C.current)===null||d===void 0)&&d.reloadAndRest&&((c=C.current)===null||c===void 0||c.reloadAndRest())},tips:"\u9000\u51FA\u8BE5\u7F51\u7EDC",children:(0,l.jsx)(b.Z,{})})]})}}],request:function(){var g=O()(h()().mark(function I(r,A,i){var E,M;return h()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,u.jV)({md5:f.containerInfo.Name});case 2:return E=c.sent,Q(E.data.info),c.next=6,(0,w._3)({name:Object.keys(E.data.info.NetworkSettings.Networks)});case 6:return M=c.sent,c.abrupt("return",{data:M.data.list,success:!0,total:M.data.list.length});case 8:case"end":return c.stop()}},I)}));return function(I,r,A){return g.apply(this,arguments)}}(),toolBarRender:function(){return[(0,l.jsx)($.Z,{showTriggerButton:!0,onSelect:function(){var I=O()(h()().mark(function r(A){var i,E;return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,w.HY)({name:A.Name,containerName:f.containerInfo.Name,ipV4:""});case 2:E=d.sent,!((i=C.current)===null||i===void 0)&&i.reloadAndRest&&C.current.reloadAndRest();case 4:case"end":return d.stop()}},r)}));return function(r){return I.apply(this,arguments)}}()},"joinNetwork"),(0,l.jsx)(y.Z,{onFinish:function(){var r,A;!((r=C.current)===null||r===void 0)&&r.reloadAndRest&&((A=C.current)===null||A===void 0||A.reloadAndRest())}},"create")]},search:!1,expandable:{expandRowByClick:!1,expandedRowKeys:Object.keys((L=T==null?void 0:T.NetworkSettings.Networks)!==null&&L!==void 0?L:{bridge:[]})}})]})});X.Z=n},78272:function(oe,X,e){e.d(X,{Z:function(){return A}});var Y=e(5574),h=e.n(Y),J=e(15009),O=e.n(J),q=e(99289),U=e.n(q),o=e(67294),w=e(37767),k=e(60335),b=e(82346),H=e(58638),V=e(85265),W=e(42075),G=e(96074),B=e(83062),u=e(86250),N=e(52031),z=e(14189),ee=e(27813),ne=e(46934),y=e(184),$=e(25593),K=e(95591),l=e(5251),n=e(85893),f=(0,o.forwardRef)(function(i,E){var M,d=(0,o.useState)(!1),c=h()(d,2),Z=c[0],a=c[1];return(0,o.useImperativeHandle)(E,function(){return{}}),(0,n.jsx)(y.a,{submitter:!1,title:(0,l.fi)(i.containerInfo.Name,"/")+" - \u6587\u4EF6\u7BA1\u7406",onOpenChange:function(F){a(F)},trigger:(0,n.jsx)($.Z.Link,{children:(0,n.jsx)(K.Z,{})},"file"),children:Z&&(0,n.jsx)(ne.Z,{md5:i.containerInfo.Id,initPath:(M=i.containerInfo.Config.WorkingDir)!==null&&M!==void 0?M:"/"})})}),s=f,L=e(24963),C=e(43831),x=e(52209),te=(0,o.forwardRef)(function(i,E){(0,o.useImperativeHandle)(E,function(){return{}});var M=(0,o.useState)(!1),d=h()(M,2),c=d[0],Z=d[1];return(0,n.jsx)(y.a,{submitter:!1,title:(0,l.fi)(i.containerInfo.Name,"/")+" - \u7F51\u7EDC\u7BA1\u7406",onOpenChange:function(S){Z(S)},open:c,trigger:(0,n.jsx)($.Z.Link,{children:(0,n.jsx)(x.Z,{})},"file"),children:(0,n.jsx)(C.Z,{ghost:!0,containerInfo:i.containerInfo})})}),t=te,T=e(85578),Q=e(45742),g=(0,o.forwardRef)(function(i,E){(0,o.useImperativeHandle)(E,function(){return{show:function(m){return U()(O()().mark(function D(){var P;return O()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,k.jV)({md5:m});case 2:P=p.sent,P.data&&R(P.data.info),Z(!0);case 5:case"end":return p.stop()}},D)}))()}}});var M=(0,o.useState)(!1),d=h()(M,2),c=d[0],Z=d[1],a=(0,o.useState)(),S=h()(a,2),F=S[0],R=S[1],v=(0,o.useRef)();return(0,n.jsxs)(n.Fragment,{children:[i.showTriggerButton&&(0,n.jsx)($.Z.Link,{onClick:U()(O()().mark(function _(){return O()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:R(i.containerInfo),Z(!0);case 2:case"end":return D.stop()}},_)})),children:(0,n.jsx)(B.Z,{title:"\u8FD0\u884C\u65E5\u5FD7",children:(0,n.jsx)(Q.Z,{})})},"log"),(0,n.jsx)(V.Z,{title:"\u5BB9\u5668\u65E5\u5FD7",open:c,forceRender:!0,onClose:function(){Z(!1)},afterOpenChange:function(m){if(m)setTimeout(function(){var P,j;(P=v.current)===null||P===void 0||P.start(),(j=v.current)===null||j===void 0||j.fit()},1e3);else{var D;(D=v.current)===null||D===void 0||D.close()}},width:800,children:F&&c&&(0,n.jsx)(T.Z,{ref:v,showInDrawer:!0,id:F==null?void 0:F.Id})})]})}),I=g,r=(0,o.forwardRef)(function(i,E){(0,o.useImperativeHandle)(E,function(){return{show:function(P){return U()(O()().mark(function j(){return O()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return _(!0),re.next=3,m(P);case 3:case"end":return re.stop()}},j)}))()}}});var M=(0,o.useContext)(L.Z),d=M.loading,c=(0,o.useState)(),Z=h()(c,2),a=Z[0],S=Z[1],F=(0,o.useState)(!1),R=h()(F,2),v=R[0],_=R[1],m=function(){var D=U()(O()().mark(function P(j){var p;return O()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,(0,k.jV)({md5:j});case 2:p=ae.sent,p.data&&(p.data.info.HostConfig.NetworkMode=="host"&&p.data.info.Config.ExposedPorts&&Object.keys(p.data.info.Config.ExposedPorts).map(function(se){p.data.info.NetworkSettings.Ports[se]=[{HostIp:"0.0.0.0",HostPort:se.substring(0,se.indexOf("/"))}]}),S(p.data));case 4:case"end":return ae.stop()}},P)}));return function(j){return D.apply(this,arguments)}}();return(0,n.jsx)(V.Z,{loading:!a,title:"\u5FEB\u6377\u67E5\u770B\u5BB9\u5668",open:v,onClose:function(){_(!1),i.onFinish&&i.onFinish()},width:800,extra:(0,n.jsxs)(W.Z,{split:(0,n.jsx)(G.Z,{type:"vertical"}),children:[(a==null?void 0:a.info)&&(0,n.jsx)(s,{containerInfo:a.info}),(a==null?void 0:a.info)&&(0,n.jsx)(t,{containerInfo:a.info}),(a==null?void 0:a.info)&&(0,n.jsx)(I,{containerInfo:a.info,showTriggerButton:!0}),(0,n.jsx)(B.Z,{title:"\u67E5\u770B\u5B8C\u6574\u4FE1\u606F",children:(0,n.jsx)(b.Link,{to:"/app/detail/edit/"+(a==null?void 0:a.info.Id),children:(0,n.jsx)(H.Z,{})},"detail")})]}),children:(0,n.jsxs)(u.Z,{vertical:!0,gap:20,children:[a&&(0,n.jsx)(z.Z,{ghost:!0,data:a==null?void 0:a.info,onFinish:U()(O()().mark(function D(){return O()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,m(a.info.Id);case 2:return j.t0=j.sent,j.abrupt("return",[j.t0]);case 4:case"end":return j.stop()}},D)}))}),a&&(0,n.jsx)(ee.Z,{ghost:!0,data:a,checkContainerUpgrade:function(){_(!1),i.onUpgradeFinish&&i.onUpgradeFinish()}}),a&&(0,n.jsx)(w.Z,{data:a,ghost:!0}),(0,n.jsx)(N.Z,{data:a==null?void 0:a.info,ghost:!0})]})})}),A=r},46442:function(oe,X,e){var Y=e(15009),h=e.n(Y),J=e(99289),O=e.n(J),q=e(5574),U=e.n(q),o=e(67294),w=e(14946),k=e(64789),b=e(10641),H=e(28036),V=e(85265),W=e(42075),G=e(66309),B=e(28230),u=e(85893),N=(0,o.forwardRef)(function(z,ee){(0,o.useImperativeHandle)(ee,function(){return{show:function(){K(!0)}}});var ne=(0,o.useState)(!1),y=U()(ne,2),$=y[0],K=y[1],l=(0,o.useRef)();return(0,u.jsxs)(u.Fragment,{children:[z.showTriggerButton&&(0,u.jsx)(H.ZP,{onClick:function(){K(!0)},children:"\u52A0\u5165\u7F51\u7EDC"}),(0,u.jsx)(V.Z,{title:"\u9009\u62E9\u7F51\u7EDC",width:800,footer:!1,open:$,onClose:function(){return K(!1)},extra:(0,u.jsx)(W.Z,{children:(0,u.jsx)(B.Z,{onFinish:function(){var f,s;!((f=l.current)===null||f===void 0)&&f.reloadAndRest&&((s=l.current)===null||s===void 0||s.reloadAndRest())}},"create")}),children:(0,u.jsx)(b.Z,{rowKey:"Name",toolBarRender:!1,actionRef:l,columns:[{title:"\u540D\u79F0",dataIndex:"Name",render:function(f,s,L,C,x){return s.Name=="none"||s.Name=="bridge"||s.Name=="host"?(0,u.jsxs)(u.Fragment,{children:[s.Name," ",(0,u.jsx)(G.Z,{color:"blue",children:"System"})]}):(0,u.jsx)(u.Fragment,{children:f})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,dataIndex:"Driver",search:!1},{title:"IPAM Driver",ellipsis:!0,width:120,search:!1,dataIndex:["IPAM","Driver"]},{title:"IPV4 IPAM Network",search:!1,dataIndex:["IPAM","Config",0,"Subnet"],render:function(f,s,L,C,x){return(0,u.jsxs)(W.Z,{children:[s.IPAM.Config&&s.IPAM.Config[0]&&"".concat(s.IPAM.Config[0].Subnet," - ").concat(s.IPAM.Config[0].Gateway),s.IPAM.Config&&s.IPAM.Config[1]&&"".concat(s.IPAM.Config[1].Subnet," - ").concat(s.IPAM.Config[1].Gateway)]})}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(f,s,L,C,x){return[s.Name!="none"&&s.Name!="bridge"&&s.Name!="host"&&(0,u.jsx)(H.ZP,{type:"link",onClick:function(){z.onSelect(s),K(!1)},children:(0,u.jsx)(k.Z,{})},s.Id)]}}],request:function(){var n=O()(h()().mark(function f(s,L,C){var x;return h()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,w.jR)({name:s.Name});case 2:return x=t.sent,t.abrupt("return",{data:x.data.list,success:!0,total:x.data.list.length});case 4:case"end":return t.stop()}},f)}));return function(f,s,L){return n.apply(this,arguments)}}(),pagination:{pageSize:10}})})]})});X.Z=N}}]);
