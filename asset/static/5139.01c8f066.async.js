"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5139],{78914:function(G,I,t){t.d(I,{Z:function(){return Fe}});var T=t(5574),d=t.n(T),m=t(15009),i=t.n(m),b=t(99289),g=t.n(b),V=t(80271),N=t(65913),R=t(3393),le=t(95591),oe=t(40666),se=t(1912),ue=t(77171),de=t(48689),H=t(45742),A=t(38345),ce=t(91708),J=t(82346),ve=t(85265),Q=t(42075),fe=t(96074),Y=t(28036),X=t(66309),k=t(25593),o=t(26412),he=t(60940),s=t(67294),q=t(80821),te=t(5251),ge=t(18148),ae=t(184),me=t(97269),re=t(62370),xe=t(65233),ie=t(2487),je=t(4393),_=t(3616),n=t(85893),Ce=(0,s.forwardRef)(function(E,D){(0,s.useImperativeHandle)(D,function(){return{show:function(f){return g()(i()().mark(function M(){var $,z;return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return L(!0),($=w.current)===null||$===void 0||$.show(),a.prev=2,a.next=5,(0,R.cd)({imageName:f}).finally(function(){var l;(l=w.current)===null||l===void 0||l.destroy()});case 5:z=a.sent,e(z.data.list),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(2),L(!1);case 12:case"end":return a.stop()}},M,null,[[2,9]])}))()}}});var F=(0,J.useAccess)(),Z=(0,s.useState)(),P=d()(Z,2),v=P[0],e=P[1],p=(0,s.useState)(""),S=d()(p,2),j=S[0],y=S[1],O=(0,s.useState)(!1),B=d()(O,2),C=B[0],L=B[1],w=(0,s.useRef)();return(0,n.jsx)(ae.a,{open:C,onOpenChange:function(f){L(f),!f&&e(void 0)},title:"\u8FDC\u7A0B Tag \u5217\u8868",isKeyPressSubmit:!0,submitter:!1,drawerProps:{width:_.R_,extra:(0,n.jsx)(me.A,{isKeyPressSubmit:!0,onFinish:function(f){y(f.search)},submitter:!1,children:(0,n.jsx)(Q.Z.Compact,{children:(0,n.jsx)(re.Z,{style:{margin:0},name:"search",children:(0,n.jsx)(xe.Z,{allowClear:!0,addonBefore:"\u641C\u7D22Tag",placeholder:"\u6309\u56DE\u8F66\u67E5\u8BE2",onClear:function(){y("")}})})})})},children:(0,n.jsx)(N.Z,{ref:w,children:(0,n.jsx)(ie.Z,{rowKey:function(f){return"".concat(f)},pagination:{pageSize:50},grid:{gutter:10,column:2},dataSource:v&&v.filter(function(x){return!j||x.toLocaleLowerCase().indexOf(j.toLocaleLowerCase())!==-1}),loading:!v||(v==null?void 0:v.length)<=0,renderItem:function(f,M){return(0,n.jsx)(ie.Z.Item,{children:(0,n.jsx)(je.Z,{style:{height:"80px"},children:(0,n.jsx)(k.Z.Text,{copyable:!0,children:f})})},M)}})})},"form")}),Ze=Ce,pe=t(64789),Se=t(5966),ye=t(83062),Ie=t(96042);function Te(E){var D=(0,s.useRef)(),F=(0,s.useState)(!1),Z=d()(F,2),P=Z[0],v=Z[1];return(0,n.jsxs)(ae.a,{drawerProps:{width:_.R_},open:P,title:"\u589E\u52A0\u955C\u50CF Tag",onOpenChange:function(p){v(p)},formRef:D,onFinish:function(){var e=g()(i()().mark(function p(S){var j,y,O;return i()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,R._U)({md5:(j=E.imageInfo.info.Id)!==null&&j!==void 0?j:"",tag:(S.imageRespo?S.imageRespo.serverAddress+"/":"")+S.imageTag});case 2:O=C.sent,v(!1),(y=D.current)===null||y===void 0||y.resetFields(),E.onFinish&&E.onFinish();case 6:case"end":return C.stop()}},p)}));return function(p){return e.apply(this,arguments)}}(),trigger:(0,n.jsx)(ye.Z,{title:"\u589E\u52A0\u955C\u50CFTag",children:(0,n.jsx)(Y.ZP,{type:"link",icon:(0,n.jsx)(pe.Z,{})})}),children:[(0,n.jsx)(re.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,n.jsxs)(n.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,n.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,n.jsx)(Ie.Z,{})}),(0,n.jsx)(Se.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],required:!0,placeholder:"\u53EA\u80FD\u4F7F\u7528\u5C0F\u5199\u82F1\u6587\u5B57\u7B26\u3001\u6570\u5B57\u3001_\u3001-\u3001",label:"\u955C\u50CF\u540D\u79F0",name:"imageTag",tooltip:"\u4F8B\u5982: name:tag\u3001namespace/name:tag\u3001registry/namespace/name:tag"})]})}var Ee=t(24963),ee=t(1699),Re=t(78451),De=(0,s.forwardRef)(function(E,D){var F;(0,s.useImperativeHandle)(D,function(){return{show:function(l){return g()(i()().mark(function r(){return i()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return O(!0),u.next=3,K(l);case 3:case"end":return u.stop()}},r)}))()}}});var Z=(0,s.useRef)(),P=(0,s.useState)(),v=d()(P,2),e=v[0],p=v[1],S=(0,s.useState)(!1),j=d()(S,2),y=j[0],O=j[1],B=(0,s.useContext)(Ee.Z),C=B.message,L=(0,s.useState)(0),w=d()(L,2),x=w[0],f=w[1],M=(0,J.useNavigate)(),$=(0,J.useAccess)(),z=(0,s.useRef)(),K=function(){var a=g()(i()().mark(function l(r){var h,u;return i()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return(h=Z.current)===null||h===void 0||h.show(),c.next=3,(0,R.YU)({md5:r,showLayer:!0}).finally(function(){var W;(W=Z.current)===null||W===void 0||W.destroy()});case 3:u=c.sent,p(u.data);case 5:case"end":return c.stop()}},l)}));return function(r){return a.apply(this,arguments)}}();return(0,s.useEffect)(function(){e&&K(e==null?void 0:e.info.Id)},[x]),(0,n.jsx)(ve.Z,{title:"\u5FEB\u6377\u67E5\u770B\u955C\u50CF",open:y,onClose:function(){O(!1),E.onClose&&E.onClose()},width:_.R_,extra:(0,n.jsxs)(Q.Z,{split:(0,n.jsx)(fe.Z,{type:"vertical"}),children:[(e==null?void 0:e.info)&&(0,n.jsx)(ee.u,{access:"canSeeEnableCe",showProTips:!0,children:function(l){var r=l.canSeeEnableCe;return(0,n.jsx)(V.Z,{trigger:(0,n.jsx)(Y.ZP,{type:"link",disabled:r,icon:(0,n.jsx)(le.Z,{})}),imageId:e.info.Id})}}),(e==null?void 0:e.info)&&(0,n.jsx)(Te,{imageInfo:e,onFinish:function(){K(e.info.Id)}})]}),children:(0,n.jsxs)(N.Z,{ref:Z,children:[!$.canSeeEnableCe&&(0,n.jsx)(Ze,{ref:z}),(0,n.jsxs)(A.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,n.jsx)(A.Z,{title:(0,n.jsx)(oe.Z,{}),subTitle:"Tag \u5217\u8868",ghost:!0,children:(0,n.jsx)(ce.Rs,{grid:{gutter:40,column:2},headerTitle:!1,metas:{content:{render:function(l,r,h){return(0,n.jsx)(X.Z,{color:"blue",children:(0,n.jsx)(k.Z.Text,{copyable:!0,children:r})},h)}},title:{render:function(l,r,h){return(0,n.jsxs)(Q.Z,{children:[(0,n.jsxs)(q.Z,{action:function(){return(0,R.Gb)({tag:r,type:"push"})},children:[(0,n.jsx)(se.Z,{})," Push"]}),(0,n.jsxs)(q.Z,{action:function(){return(0,R.Gb)({tag:r,type:"pull"})},children:[(0,n.jsx)(ue.Z,{})," Pull"]}),(0,n.jsx)(ee.u,{access:"canSeeEnableCe",showProTips:!0,showProTipsOffset:[-15,9],children:function(U){var c=U.canSeeEnableCe;return(0,n.jsx)(Y.ZP,{disabled:c,onClick:function(){var ne;(ne=z.current)===null||ne===void 0||ne.show(r)},children:"\u8FDC\u7A0BTag"})}}),(0,n.jsx)(ee.u,{access:"canSeeImageListManage",children:(0,n.jsx)(q.Z,{action:function(){return(0,R.Pn)({tag:r})},danger:!0,onSuccess:function(U){return f(x+1),!0},confirm:"notification.confirm.title",children:(0,n.jsx)(de.Z,{})})})]},h)}}},dataSource:e==null?void 0:e.info.RepoTags})}),e&&(0,n.jsx)(A.Z,{title:(0,n.jsx)(H.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",ghost:!0,children:(0,n.jsxs)(o.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,n.jsx)(o.Z.Item,{label:"ID",children:(0,n.jsx)(k.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u955C\u50CF\u5907\u6CE8\u540D\u79F0",onChange:function(){var a=g()(i()().mark(function r(h){var u;return i()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,ge.Fj)({tag:e==null?void 0:e.info.RepoTags[0],title:h});case 2:u=c.sent,K(e.info.Id),C.success("\u4FEE\u6539\u955C\u50CF\u540D\u79F0\u6210\u529F");case 5:case"end":return c.stop()}},r)}));function l(r){return a.apply(this,arguments)}return l}()},children:e==null?void 0:e.info.Id})}),(0,n.jsx)(o.Z.Item,{label:"Parent",children:e==null?void 0:e.info.Parent}),(0,n.jsx)(o.Z.Item,{label:"Size",children:(0,te.FI)((F=e==null?void 0:e.info.Size)!==null&&F!==void 0?F:0)}),(0,n.jsx)(o.Z.Item,{label:"Created",children:e==null?void 0:e.info.Created}),(0,n.jsxs)(o.Z.Item,{label:"Build",children:["Docker ",e==null?void 0:e.info.DockerVersion," ",e==null?void 0:e.info.Os," ",e==null?void 0:e.info.Architecture]}),(0,n.jsx)(o.Z.Item,{label:"Labels",children:(0,n.jsx)(o.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Labels)&&Object.keys(e==null?void 0:e.info.Config.Labels).map(function(a){return(0,n.jsx)(o.Z.Item,{label:a,children:e==null?void 0:e.info.Config.Labels[a]},a)})})})]})}),(0,n.jsx)(A.Z,{title:(0,n.jsx)(H.Z,{}),subTitle:"Dockerfile \u8BE6\u60C5",ghost:!0,children:(0,n.jsxs)(o.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,n.jsx)(o.Z.Item,{label:"CMD",children:e==null?void 0:e.info.Config.Cmd}),(0,n.jsx)(o.Z.Item,{label:"ENTRYPOINT",children:e==null?void 0:e.info.Config.Entrypoint}),(0,n.jsx)(o.Z.Item,{label:"EXPOSE",children:(e==null?void 0:e.info.Config.ExposedPorts)&&Object.keys(e==null?void 0:e.info.Config.ExposedPorts).map(function(a){return(0,n.jsx)(X.Z,{color:"gray",children:a},a)})}),(0,n.jsx)(o.Z.Item,{label:"VOLUME",children:(e==null?void 0:e.info.Config.Volumes)&&Object.keys(e==null?void 0:e.info.Config.Volumes).map(function(a){return(0,n.jsx)(X.Z,{color:"gray",children:a},a)})}),(0,n.jsx)(o.Z.Item,{label:"Env",children:(0,n.jsx)(o.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Env)&&(e==null?void 0:e.info.Config.Env.map(function(a,l){var r=a.split("=");return(0,n.jsx)(o.Z.Item,{label:r[0],children:r[1]},l)}))})})]})}),(e==null?void 0:e.layer)&&(0,n.jsx)(A.Z,{title:(0,n.jsx)(H.Z,{}),subTitle:"Layers",ghost:!0,children:(0,n.jsx)(he.Z,{rowKey:"CreatedBy",dataSource:e.layer.reverse(),columns:[{title:"\u5927\u5C0F",key:"size",render:function(l,r,h){return(0,te.FI)(r.Size)}},{title:"Layer",dataIndex:"CreatedBy",key:"CreatedBy",render:function(l,r,h){return(0,n.jsx)(Re.Z,{content:r.CreatedBy})}}]})})]})]})})}),Fe=De},3616:function(G,I,t){t.d(I,{Ed:function(){return i},FK:function(){return d},R_:function(){return T},ob:function(){return m}});var T=window.innerWidth<=1024?"90vw":"65vw",d="90vw",m="60vw",i="50vh"},24963:function(G,I,t){var T=t(67294),d=(0,T.createContext)({});I.Z=d},67255:function(G,I,t){t.d(I,{O:function(){return T},j:function(){return d}});function T(m){var i=localStorage.getItem("dpanel-pagesize");return i=="all"?!1:{defaultCurrent:m==null?void 0:m.page,showSizeChanger:!0,defaultPageSize:parseInt(i!=null?i:"20"),onChange:function(g,V){localStorage.setItem("dpanel-page-"+location.pathname.split("/").slice(-2).join("-"),"".concat(g))}}}function d(m){var i="dpanel-table-column-".concat(m),b={};if(localStorage.getItem(i)){var g;b=JSON.parse((g=localStorage.getItem(i))!==null&&g!==void 0?g:"{}")}return{defaultValue:b,onChange:function(N){localStorage.setItem("dpanel-table-column-".concat(m),JSON.stringify(N))}}}}}]);
