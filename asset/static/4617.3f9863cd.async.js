"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4617],{80821:function(ue,N,e){e.d(N,{Z:function(){return L}});var H=e(97857),i=e.n(H),J=e(5574),_=e.n(J),v=e(24963),B=e(36146),V=e(86738),k=e(83062),y=e(28036),w=e(67294),s=e(85893);function L(r){var K=(0,w.useState)(!1),t=_()(K,2),U=t[0],g=t[1],R=(0,w.useContext)(v.Z),E=R.message,z=new B.Uo,G=function(){g(!0);var b=r.action();b instanceof Promise?b.then(function(h){if(g(!1),h){typeof r.onSuccess=="function"&&r.onSuccess(h);var c="";r.messageSuccess?typeof r.messageSuccess=="function"?c=r.messageSuccess(h):c=r.messageSuccess.indexOf("notification.")==0?z.format(r.messageSuccess):r.messageSuccess:c=z.format("notification.finish"),r.asynced?E.info(c):E.success(c)}}).catch(function(h){g(!1),typeof r.onError=="function"&&r.onError(h)}):g(!1)};return r.confirm?(0,s.jsx)(V.Z,i()(i()({style:{width:500},title:r.confirmTitle?r.confirmTitle:z.format("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?z.format(r.confirm):r.confirm,onConfirm:G,okText:"Yes",cancelText:"No",onOpenChange:r.confirmOnOpenChange},r.confirmProps),{},{children:(0,s.jsx)(k.Z,{title:r.tips,children:(0,s.jsx)(y.ZP,{block:r.block,disabled:r.disabled,icon:!r.children&&U?void 0:r.icon,loading:U,danger:r.danger,type:r.type,children:r.children})})})):(0,s.jsx)(k.Z,{title:r.tips,children:(0,s.jsx)(y.ZP,{block:r.block,style:r.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:r.disabled,icon:!r.children&&U?void 0:r.icon,loading:U,onClick:G,danger:r.danger,type:r.type,children:r.children})})}},81146:function(ue,N,e){var H=e(97857),i=e.n(H),J=e(15009),_=e.n(J),v=e(99289),B=e.n(v),V=e(67294),k=e(97269),y=e(62370),w=e(5966),s=e(97462),L=e(82346),r=e(71230),K=e(15746),t=e(34041),U=e(28036),g=e(84567),R=e(42075),E=e(80821),z=e(23430),G=e(93162),T=e.n(G),b=e(78267),h=e.n(b),c=e(75458),A=e.n(c),ce=e(12323),_e=e(4244),ve=e.n(_e),m=e(24078),P=e(36146),l=e(85893),a,le,me,Ee={decorations:{matchBackground:"",matchBorder:"#FFFF00",activeMatchBackground:"#FFFF0066",matchOverviewRuler:"",activeMatchColorOverviewRuler:""}},de=(0,V.forwardRef)(function(q,xe){var n=(0,V.useRef)(),fe=(0,L.useModel)("subscriber"),Y=new P.Uo("components.containerLog");(0,V.useImperativeHandle)(xe,function(){return{fit:function(){a.clear(),me.fit()},start:function(){return B()(_()().mark(function Z(){return _()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,Pe({lineTotal:500});case 2:case"end":return x.stop()}},Z)}))()},close:function(){fe.progress.close(q.id)}}});function Pe($){return Oe.apply(this,arguments)}function Oe(){return Oe=B()(_()().mark(function $(Z){return _()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:fe.progress.close(q.id),a.clear(),Z.download=!1,q.request(Z);case 4:case"end":return x.stop()}},$)})),Oe.apply(this,arguments)}return(0,V.useEffect)(function(){return window.addEventListener("resize",function(){me.fit()}),a=new _e.Terminal(i()(i()({},ce.X),{},{fontSize:12,lineHeight:1.2,allowProposedApi:!0})),me=new b.FitAddon,le=new c.SearchAddon({}),a.loadAddon(me),a.loadAddon(le),a.open(document.getElementById("terminal-container-log")),me.fit(),fe.addDataHandler(q.id,function($){a.write($.data)}),function(){a.clear(),a.reset(),fe.progress.close(q.id)}},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.A,{submitter:!1,layout:"horizontal",onFinish:function(Z){var d;Pe({id:q.id,lineTotal:parseInt(Z.lineTotal),showTime:(d=Z.showTime)!==null&&d!==void 0?d:!1})},formRef:n,children:(0,l.jsxs)(r.Z,{gutter:[10,0],children:[(0,l.jsx)(K.Z,{span:8,children:(0,l.jsx)(y.Z,{name:"lineTotal",initialValue:"500",label:Y.format("formLineTotal"),children:(0,l.jsxs)(t.Z,{defaultValue:"500",onChange:function(Z){var d;(d=n.current)===null||d===void 0||d.submit()},children:[(0,l.jsx)(t.Z.Option,{value:"100",children:Y.format("formLineTotalOption",{number:"100"})}),(0,l.jsx)(t.Z.Option,{value:"200",children:Y.format("formLineTotalOption",{number:"200"})}),(0,l.jsx)(t.Z.Option,{value:"500",children:Y.format("formLineTotalOption",{number:"500"})}),(0,l.jsx)(t.Z.Option,{value:"1000",children:Y.format("formLineTotalOption",{number:"1000"})}),(0,l.jsx)(t.Z.Option,{value:"-1",children:Y.format("formLineTotalOptionAll")})]})})}),(0,l.jsx)(K.Z,{children:(0,l.jsx)(U.ZP,{onClick:function(){a.clear()},children:Y.format("clearButton")})}),(0,l.jsx)(K.Z,{children:(0,l.jsx)(y.Z,{name:"showTime",valuePropName:"checked",children:(0,l.jsx)(g.Z,{onChange:function(Z){var d;(d=n.current)===null||d===void 0||d.submit()},children:Y.format("formShowTime")})})}),(0,l.jsx)(K.Z,{children:(0,l.jsx)(w.Z,{label:Y.format("formKeywork"),name:"keywork",fieldProps:{onPressEnter:function(){var Z;le.findNext((Z=n.current)===null||Z===void 0?void 0:Z.getFieldValue("keywork"),Ee)},onChange:function(Z){le.findNext(Z.target.value,Ee)}},placeholder:Y.format("formKeyworkEmpty")})}),(0,l.jsx)(K.Z,{children:(0,l.jsx)(s.Z,{name:["keywork"],children:function(Z){var d=Z.keywork;return(0,l.jsxs)(R.Z,{size:10,children:[(0,l.jsx)(U.ZP,{onClick:function(){le.findNext(d,Ee)},children:Y.format("formKeyworkNext")},"next"),(0,l.jsx)(U.ZP,{onClick:function(){le.findPrevious(d,Ee)},children:Y.format("formKeyworkPrev")},"prev")]})}})}),(0,l.jsx)(K.Z,{children:(0,l.jsx)(E.Z,{icon:(0,l.jsx)(z.Z,{}),action:B()(_()().mark(function $(){var Z,d,x;return _()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!q.download){W.next=5;break}return W.next=3,q.download({lineTotal:parseInt((Z=n.current)===null||Z===void 0?void 0:Z.getFieldValue("lineTotal")),showTime:(d=n.current)===null||d===void 0?void 0:d.getFieldValue("showTime")});case 3:x=W.sent,(0,G.saveAs)(x.data,x.name);case 5:case"end":return W.stop()}},$)})),children:Y.format("downloadButton")})})]})}),(0,l.jsx)("div",{style:{marginTop:"20px",height:q.showInDrawer?"75vh":"85vh"},id:"terminal-container-log"})]})});N.Z=de},37413:function(ue,N,e){e.d(N,{Z:function(){return K}});var H=e(19632),i=e.n(H),J=e(36146),_=e(85577),v=e(58638),B=e(36693),V=e(35995),k=e(99611),y=e(38345),w=e(42075),s=e(66309),L=e(55241),r=e(85893);function K(t){var U,g=new J.Uo("components.containerPort"),R=[];t.publicPort&&(R=i()(t.publicPort)),t.privatePort&&(R=[].concat(i()(R),i()(t.privatePort)));var E=(U=t.serverIp)!==null&&U!==void 0?U:"localhost";if(E!=""&&E.indexOf("http")===-1&&E.indexOf(":")>-1&&(E="[".concat(E,"]")),E==""||E=="127.0.0.1"){var z=document.location.protocol+"//"+document.location.hostname;E=z}var G=(0,r.jsxs)(y.Z,{direction:t.layout=="inline"?"row":"column",style:{width:t.layout!="inline"?750:"auto"},ghost:!0,children:[R.length>0&&(0,r.jsx)(y.Z,{title:(0,r.jsx)(_.Z,{}),subTitle:g.format("cardPortTitle"),ghost:t.ghost,children:R.map(function(T,b){return E==""&&(E=T.IP),(0,r.jsx)(w.Z,{size:"large",wrap:!0,children:(0,r.jsx)(s.Z,{color:T.PublicPort?"#2db7f5":"warning",icon:T.PublicPort?(0,r.jsx)(v.Z,{}):"",style:{marginBottom:10,marginRight:15},children:T.PublicPort?(0,r.jsx)("a",{href:"".concat(E.indexOf("http")===0?E:"http://"+E,":").concat(T.PublicPort),target:"_blank",children:"".concat(T.PublicPort?T.IP+":"+T.PublicPort+" -> ":"").concat(T.PrivatePort,"/").concat(T.Type)},"link".concat(b)):"".concat(T.PrivatePort,"/").concat(T.Type)})},"space".concat(b))})}),t.domain&&t.domain.length>0&&(0,r.jsx)(y.Z,{title:(0,r.jsx)(B.Z,{}),subTitle:g.format("cardDomainTitle"),ghost:t.ghost,children:(0,r.jsx)(w.Z,{wrap:!0,style:{textAlign:"left"},children:t.domain&&t.domain.map(function(T,b){return(0,r.jsx)(s.Z,{color:"blue",icon:(0,r.jsx)(v.Z,{}),children:(0,r.jsx)("a",{href:T,target:"_blank",children:T})},"domain".concat(b))})})})]});return t.showInDetail?G:(0,r.jsx)(L.Z,{placement:"bottom",content:G,children:(0,r.jsxs)(w.Z,{direction:"vertical",children:[t.privatePort&&t.privatePort.length>0&&(0,r.jsxs)(s.Z,{color:"warning",icon:(0,r.jsx)(V.Z,{}),children:[g.format("portPrivate"),": ",t.privatePort.length]}),t.publicPort&&t.publicPort.length>0&&(0,r.jsxs)(s.Z,{color:"#2db7f5",icon:(0,r.jsx)(k.Z,{}),children:[g.format("protPublic"),": ",t.publicPort.length]}),t.domain&&t.domain.length>0&&(0,r.jsx)(s.Z,{color:"blue",icon:(0,r.jsx)(B.Z,{}),children:t.domainTitle?t.domainTitle:"".concat(g.format("domain"),": ").concat(t.domain.length)})]})})}},94359:function(ue,N,e){e.d(N,{Z:function(){return U}});var H=e(5574),i=e.n(H),J=e(3089),_=e(98165),v=e(18429),B=e(8751),V=e(66212),k=e(14313),y=e(30159),w=e(87740),s=e(50888),L=e(66309),r=e(83062),K=e(36146),t=e(85893);function U(g){var R,E,z=new K.Uo("components.containerStatus"),G=g.status.split("."),T=i()(G,2),b=T[0],h=T[1],c="";c=z.format(g.status,(R=g.statusValue)!==null&&R!==void 0?R:{});var A=(0,t.jsx)(t.Fragment,{});return h=="0"&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(J.Z,{}),color:"default",children:c})),h=="10"&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(_.Z,{spin:!0}),color:"processing",children:c})),h=="20"&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(v.Z,{}),color:"error",children:c})),h=="30"&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(B.Z,{}),color:"success",children:c})),h=="new"&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(V.Z,{}),children:c})),(h=="running"||h=="healthy"||h=="active"||h=="ready")&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(k.Z,{}),color:"success",children:c})),(h=="paused"||h=="pause"||h=="rollback_paused")&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(y.Z,{}),children:c})),(h=="waiting"||h=="starting"||h=="accepted")&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(w.Z,{}),children:c})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(h)&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(s.Z,{}),color:"processing",children:c})),(h=="error"||h=="down"||h=="failed")&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(v.Z,{}),color:"error",children:c})),["complete","completed","rollback_completed"].includes(h)&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(B.Z,{}),color:"success",children:c})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(h)&&(A=(0,t.jsx)(L.Z,{icon:(0,t.jsx)(v.Z,{}),color:"warning",children:c})),(0,t.jsx)(r.Z,{placement:"top",title:(E=g.tip)!==null&&E!==void 0?E:"",children:A})}},94617:function(ue,N,e){e.d(N,{Z:function(){return Z}});var H=e(15009),i=e.n(H),J=e(99289),_=e.n(J),v=e(97857),B=e.n(v),V=e(5574),k=e.n(V),y=e(24494),w=e(5251),s=e(36146),L=e(91806),r=e(86548),K=e(1883),t=e(38345),U=e(78099),g=e(42075),R=e(66309),E=e(25593),z=e(96074),G=e(83062),T=e(60940),b=e(37413),h=e(94359),c=e(67294),A=e(87662),ce=e(78451),_e=e(3616),ve=e(43425),m=e(87740),P=e(48689),l=e(45605),a=e(60433),le=e(85265),me=e(86250),Ee=e(28036),de=e(26412),q=e(80821),xe=e(76428),n=e(85893);function fe(d){var x,X,W=new s.Uo("swarm"),re=d.detail;if((x=re.Spec)!==null&&x!==void 0&&(x=x.Mode)!==null&&x!==void 0&&x.Replicated)return(0,n.jsxs)(g.Z,{children:[(0,n.jsx)(R.Z,{children:W.format("listServiceMode.replicated")}),(0,n.jsx)(R.Z,{color:"gold",bordered:!1,children:re.Spec.Mode.Replicated.Replicas})]});if((X=re.Spec)!==null&&X!==void 0&&(X=X.Mode)!==null&&X!==void 0&&X.Global)return(0,n.jsx)(R.Z,{children:W.format("listServiceMode.global")})}var Y=e(81146);function Pe(d){var x=(0,c.useState)(!1),X=k()(x,2),W=X[0],re=X[1],se=(0,c.useRef)();return(0,n.jsxs)(n.Fragment,{children:[d.trigger?c.cloneElement(d.trigger,{onClick:function(){re(!0)}}):null,(0,n.jsx)(le.Z,{title:"".concat(s.FD.format("listLog")," - ").concat(d.detail.name),open:W,forceRender:!0,onClose:function(){re(!1)},afterOpenChange:function(Q){if(Q)setTimeout(function(){var u,f;(u=se.current)===null||u===void 0||u.start(),(f=se.current)===null||f===void 0||f.fit()},1e3);else{var p;(p=se.current)===null||p===void 0||p.close()}},width:_e.FK,children:W&&(0,n.jsx)(Y.Z,{ref:se,showInDrawer:!0,id:"swarm:log:".concat(d.type,":").concat(d.detail.id),request:function(){var ee=_()(i()().mark(function Q(p){var u;return i()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,y.m8)({id:d.detail.id,type:d.type,lineTotal:p.lineTotal,download:(u=p.download)!==null&&u!==void 0?u:!1,showTime:p.showTime});case 2:case"end":return D.stop()}},Q)}));return function(Q){return ee.apply(this,arguments)}}(),download:function(){var ee=_()(i()().mark(function Q(p){var u;return i()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,y.Id)({id:d.detail.id,type:d.type,lineTotal:p.lineTotal,showTime:p.showTime,download:!0});case 2:return u=D.sent,D.abrupt("return",{data:new Blob([u],{type:"text/plain"}),name:d.detail.name+"_"+new Date().toLocaleDateString()+".log"});case 4:case"end":return D.stop()}},Q)}));return function(Q){return ee.apply(this,arguments)}}()})})]})}var Oe=(0,c.forwardRef)(function(d,x){var X,W,re,se,ee,Q,p,u;(0,c.useImperativeHandle)(x,function(){return{show:function(M){ne(M),F(!0)}}});var f=(0,c.useState)(!1),D=k()(f,2),C=D[0],F=D[1],j=(0,c.useState)(),O=k()(j,2),o=O[0],ne=O[1],oe=new s.Uo("swarm"),ge=(0,c.useState)(""),De=k()(ge,2),Te=De[0],Ie=De[1];return(0,c.useEffect)(function(){(0,A.K3)().then(function(S){var M;Ie((M=S.data.serverUrl)!==null&&M!==void 0?M:"")})},[]),(0,n.jsx)(le.Z,{title:"\u670D\u52A1\u8BE6\u60C5",open:C,forceRender:!0,width:_e.R_,onClose:function(){F(!1),ne(void 0),d.onFinish&&d.onFinish()},children:(0,n.jsxs)(me.Z,{vertical:!0,gap:20,children:[(0,n.jsx)(t.Z,{title:(0,n.jsx)(ve.Z,{}),ghost:!0,subTitle:(0,n.jsx)(g.Z,{children:"\u670D\u52A1\u7BA1\u7406"}),children:(0,n.jsxs)(g.Z,{wrap:!0,children:[(0,n.jsx)(q.Z,{type:"primary",icon:(0,n.jsx)(m.Z,{}),children:"\u66F4\u65B0"}),(0,n.jsx)(q.Z,{icon:(0,n.jsx)(m.Z,{}),children:"\u8C03\u6574\u526F\u672C"}),o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.Z,{type:"vertical"}),(0,n.jsx)(Pe,{type:"service",detail:{id:(X=o.ID)!==null&&X!==void 0?X:"",name:(W=(re=o.Spec)===null||re===void 0?void 0:re.Name)!==null&&W!==void 0?W:""},trigger:(0,n.jsx)(Ee.ZP,{icon:(0,n.jsx)(K.Z,{}),children:s.FD.format("listManageLog")},"log")})]}),(0,n.jsx)(z.Z,{type:"vertical"}),(0,n.jsx)(q.Z,{action:_()(i()().mark(function S(){return i()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:case"end":return I.stop()}},S)})),type:"primary",danger:!0,onSuccess:function(M){F(!1),d.onFinish&&d.onFinish()},confirm:"notification.confirm.title",icon:(0,n.jsx)(P.Z,{}),children:"\u5220\u9664\u670D\u52A1"})]})}),o&&(0,n.jsx)(b.Z,{publicPort:((se=o.Endpoint)===null||se===void 0?void 0:se.Ports)&&((ee=o.Endpoint)===null||ee===void 0?void 0:ee.Ports.map(function(S){var M,I,te;return{PrivatePort:(M=S.TargetPort)!==null&&M!==void 0?M:0,Type:(I=S.Protocol)!==null&&I!==void 0?I:"tcp",IP:"",PublicPort:(te=S.PublishedPort)!==null&&te!==void 0?te:0}})),serverIp:Te,showInDetail:!0,ghost:!0,layout:"inline"}),(0,n.jsx)(t.Z,{title:(0,n.jsx)(l.Z,{}),subTitle:"\u8BE6\u60C5",ghost:!0,children:(0,n.jsxs)(de.Z,{column:1,bordered:!0,labelStyle:{width:150},children:[(0,n.jsxs)(de.Z.Item,{label:s.FD.format("listTitle"),children:[(0,n.jsx)(xe.Z,{title:o==null?void 0:o.ID})," - ",o==null||(Q=o.Spec)===null||Q===void 0?void 0:Q.Name," - ",o&&(0,n.jsx)(h.Z,{status:"service.".concat((p=o.UpdateStatus)===null||p===void 0?void 0:p.State)})]}),(0,n.jsx)(de.Z.Item,{label:s.FD.format("listRunTask"),children:(0,n.jsx)(g.Z,{children:(o==null?void 0:o.ServiceStatus)&&Object.keys(o.ServiceStatus).map(function(S){var M=S;return(o==null?void 0:o.ServiceStatus)&&(0,n.jsx)(G.Z,{title:oe.format("listServiceStatusTip.".concat(M)),children:(0,n.jsxs)(R.Z,{color:oe.format("listServiceStatusColor.".concat(M)),bordered:!1,children:[oe.format("listServiceStatus.".concat(M))," ",o==null?void 0:o.ServiceStatus[M]]})})})})}),(0,n.jsx)(de.Z.Item,{label:s.FD.format("listServiceMode"),children:o&&(0,n.jsx)(fe,{detail:o})}),(0,n.jsx)(de.Z.Item,{label:s.FD.format("listImageName"),children:o==null||(u=o.Spec)===null||u===void 0||(u=u.TaskTemplate)===null||u===void 0||(u=u.ContainerSpec)===null||u===void 0?void 0:u.Image}),(0,n.jsx)(de.Z.Item,{label:s.FD.format("listCreatedAt"),children:(0,w.NF)(o==null?void 0:o.CreatedAt)}),(0,n.jsx)(de.Z.Item,{label:s.FD.format("listUpdatedAt"),children:(0,w.NF)(o==null?void 0:o.UpdatedAt)})]})}),o&&(0,n.jsx)(t.Z,{title:(0,n.jsx)(a.Z,{}),subTitle:"\u4EFB\u52A1",ghost:!0,children:(0,n.jsx)(U.Z,{scroll:{x:"max-content"},rowKey:"ID",columns:[{search:!1,title:s.FD.format("listName"),render:function(M,I,te,ae,pe){return I.ID}},{search:!1,width:200,title:s.FD.format("listNodeName"),render:function(M,I,te,ae,pe){return I.NodeID}},{search:!1,width:50,title:s.FD.format("listSlot"),render:function(M,I,te,ae,pe){return I.Slot}},{key:"status",valueEnum:Object.fromEntries(oe.option("listTaskStatusOption",["running","shutdown","accepted"]).map(function(S){return[S.value,S.label]})),width:120,title:s.FD.format("listRunStatus"),render:function(M,I,te){var ae;return(0,n.jsx)(h.Z,{status:"task.".concat(I.Status.State),tip:(ae=I.Status.Err)!==null&&ae!==void 0?ae:I.Status.Message})}},{search:!1,width:180,title:s.FD.format("listUpdatedAt"),render:function(M,I,te,ae,pe){return(0,w.NF)(I.UpdatedAt)}},{search:!1,width:100,title:s.FD.format("listManage"),fixed:"right",render:function(M,I,te,ae,pe){var ie,he;return(0,n.jsx)(g.Z,{children:(0,n.jsx)(Pe,{type:"node",detail:{id:(ie=I.ID)!==null&&ie!==void 0?ie:"",name:(he=I.ID)!==null&&he!==void 0?he:""},trigger:(0,n.jsx)(E.Z.Link,{children:(0,n.jsx)(K.Z,{})})})})}}],request:function(){var S=_()(i()().mark(function M(I){var te,ae;return i()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,(0,y.XX)({serviceName:o==null?void 0:o.ID,status:I.status});case 2:return te=ie.sent,ie.next=5,(0,y.HN)();case 5:return ae=ie.sent,ie.abrupt("return",{data:te.data.list.map(function(he){var je,Me=ae&&((je=ae.data.list.find(function(Ze){return Ze.ID==he.NodeID}))===null||je===void 0||(je=je.Description)===null||je===void 0?void 0:je.Hostname);return Me&&(he.NodeID=Me),he}),success:!0,total:te.data.list.length});case 7:case"end":return ie.stop()}},M)}));return function(M){return S.apply(this,arguments)}}()})})]})})}),$=Oe;function Z(d){var x=new s.Uo("swarm"),X=(0,c.useState)(""),W=k()(X,2),re=W[0],se=W[1],ee=(0,c.useRef)();(0,c.useEffect)(function(){(0,A.K3)().then(function(p){var u;se((u=p.data.serverUrl)!==null&&u!==void 0?u:"")})},[]);var Q={};return d.showManage||(Q=B()(B()({},Q),{search:!1})),(0,n.jsxs)(t.Z,{title:(0,n.jsx)(L.Z,{}),subTitle:"\u670D\u52A1\u5217\u8868",headStyle:{paddingBottom:0},children:[(0,n.jsx)($,{ref:ee}),(0,n.jsx)(U.Z,B()(B()({},Q),{},{ghost:!0,scroll:{x:"max-content"},rowKey:"ID",columns:[{key:"serviceName",title:s.FD.format("listServiceName"),render:function(u,f,D,C,F){var j,O=0;return f.Task&&f.Task.forEach(function(o){o.Status.State=="running"&&(O+=1)}),(0,n.jsxs)(g.Z,{children:[f.Task&&(0,n.jsx)(R.Z,{color:"success",bordered:!1,children:O}),(0,n.jsx)(E.Z.Link,{onClick:function(){var ne;(ne=ee.current)===null||ne===void 0||ne.show(f)},children:(j=f.Spec)===null||j===void 0?void 0:j.Name})]})}},{width:150,search:!1,title:s.FD.format("listPort"),render:function(u,f,D,C,F){var j,O,o=[];return!((j=f.Endpoint)===null||j===void 0)&&j.Ports&&((O=f.Endpoint)===null||O===void 0||O.Ports.map(function(ne){var oe,ge,De;o.push({PrivatePort:(oe=ne.TargetPort)!==null&&oe!==void 0?oe:0,Type:(ge=ne.Protocol)!==null&&ge!==void 0?ge:"tcp",IP:"",PublicPort:(De=ne.PublishedPort)!==null&&De!==void 0?De:0})})),(0,n.jsx)(b.Z,{ghost:!0,publicPort:o,serverIp:re})}},{width:150,search:!1,title:s.FD.format("listServiceMode"),render:function(u,f,D,C,F){return(0,n.jsx)(fe,{detail:f})}},{hidden:!d.showImageName,width:400,search:!1,title:s.FD.format("listImageName"),render:function(u,f,D,C,F){var j,O=((j=f.Spec)===null||j===void 0||(j=j.TaskTemplate)===null||j===void 0||(j=j.ContainerSpec)===null||j===void 0?void 0:j.Image)||"",o=O.includes("@")?O.split("@"):[O,null],ne=k()(o,2),oe=ne[0],ge=ne[1];return(0,n.jsx)(ce.Z,{children:oe})}},{search:!1,width:180,title:s.FD.format("listCreatedAt"),render:function(u,f,D,C,F){return(0,w.NF)(f.CreatedAt)}},{search:!1,width:180,title:s.FD.format("listUpdatedAt"),render:function(u,f,D,C,F){return(0,w.NF)(f.UpdatedAt)}},{hidden:!d.showManage,search:!1,title:s.FD.format("listManage"),width:100,fixed:"right",render:function(u,f,D,C,F){return(0,n.jsx)(g.Z,{split:(0,n.jsx)(z.Z,{type:"vertical"}),children:(0,n.jsx)(E.Z.Link,{onClick:function(){},children:(0,n.jsx)(G.Z,{title:s.FD.format("listManageEdit"),children:(0,n.jsx)(r.Z,{})})},"edit")})}}],request:function(){var p=_()(i()().mark(function u(f){var D,C,F;return i()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(!d.showWithNodeName){O.next=7;break}return O.next=3,(0,y.rN)({nodeName:(D=d.showWithNodeName)!==null&&D!==void 0?D:""});case 3:return C=O.sent,O.abrupt("return",{data:C.data.list,total:C.data.list.length,success:!0});case 7:return O.next=9,(0,y.kM)({name:f.serviceName});case 9:return F=O.sent,O.abrupt("return",{data:F.data.list,total:F.data.list.length,success:!0});case 11:case"end":return O.stop()}},u)}));return function(u){return p.apply(this,arguments)}}(),expandable:d.showWithNodeName?{expandRowByClick:!0,rowExpandable:function(u){return u.Task&&u.Task.length>0&&u.Task.filter(function(f){return f.Status.State=="running"}).length>0},expandedRowRender:function(u){return(0,n.jsx)(T.Z,{rowKey:"ID",columns:[{title:s.FD.format("listName"),render:function(D,C,F){return C.ID}},{width:120,title:s.FD.format("listRunStatus"),render:function(D,C,F){var j;return(0,n.jsx)(h.Z,{status:"task.".concat(C.Status.State),tip:(j=C.Status.Err)!==null&&j!==void 0?j:C.Status.Message})}},{title:s.FD.format("listUpdatedAt"),width:180,render:function(D,C,F){return(0,w.NF)(C.UpdatedAt)}},{width:100,title:s.FD.format("listManage"),fixed:"right",render:function(D,C,F){var j,O;return(0,n.jsx)(g.Z,{children:(0,n.jsx)(Pe,{type:"node",detail:{id:(j=C.ID)!==null&&j!==void 0?j:"",name:(O=C.ID)!==null&&O!==void 0?O:""},trigger:(0,n.jsx)(E.Z.Link,{children:(0,n.jsx)(K.Z,{})})})})}}],pagination:!1,dataSource:u.Task.filter(function(f){return f.Status.State=="running"})})}}:void 0}))]})}},76428:function(ue,N,e){e.d(N,{Z:function(){return _}});var H=e(25593),i=e(67294),J=e(85893);function _(v){return(0,J.jsx)(H.Z.Text,{copyable:!0,children:v.title})}},78451:function(ue,N,e){e.d(N,{Z:function(){return J}});var H=e(67294),i=e(85893);function J(_){var v;return(0,i.jsx)("span",{style:{width:_.width?_.width:"auto",wordBreak:"break-word"},children:(v=_.content)!==null&&v!==void 0?v:_.children})}},12323:function(ue,N,e){e.d(N,{X:function(){return H},n:function(){return i}});var H={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},i=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},24494:function(ue,N,e){e.d(N,{HN:function(){return K},Id:function(){return L},JC:function(){return B},QB:function(){return z},UK:function(){return k},XX:function(){return h},Zc:function(){return U},c7:function(){return R},kM:function(){return _e},kp:function(){return T},m8:function(){return w},rN:function(){return A}});var H=e(15009),i=e.n(H),J=e(99289),_=e.n(J),v=e(82346);function B(){return V.apply(this,arguments)}function V(){return V=_()(i()().mark(function m(){return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,v.request)("/api/app/swarm/info",{method:"POST"}));case 1:case"end":return l.stop()}},m)})),V.apply(this,arguments)}function k(m){return y.apply(this,arguments)}function y(){return y=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.request)("/api/app/swarm/init",{method:"POST",data:P}));case 1:case"end":return a.stop()}},m)})),y.apply(this,arguments)}function w(m){return s.apply(this,arguments)}function s(){return s=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return P.id=String(P.id),a.abrupt("return",(0,v.request)("/api/app/swarm/log",{method:"POST",data:P}));case 2:case"end":return a.stop()}},m)})),s.apply(this,arguments)}function L(m){return r.apply(this,arguments)}function r(){return r=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return P.download=!0,P.id=String(P.id),a.next=4,(0,v.request)("/api/app/swarm/log",{method:"POST",data:P,responseType:"blob"});case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},m)})),r.apply(this,arguments)}function K(m){return t.apply(this,arguments)}function t(){return t=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.request)("/api/app/swarm/node-list",{method:"POST",data:P}));case 1:case"end":return a.stop()}},m)})),t.apply(this,arguments)}function U(m){return g.apply(this,arguments)}function g(){return g=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.request)("/api/app/swarm/node-update",{method:"POST",data:P}));case 1:case"end":return a.stop()}},m)})),g.apply(this,arguments)}function R(m){return E.apply(this,arguments)}function E(){return E=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.request)("/api/app/swarm/node-join",{method:"POST",data:P}));case 1:case"end":return a.stop()}},m)})),E.apply(this,arguments)}function z(m){return G.apply(this,arguments)}function G(){return G=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.request)("/api/app/swarm/node-remove",{method:"POST",data:P}));case 1:case"end":return a.stop()}},m)})),G.apply(this,arguments)}function T(m){return b.apply(this,arguments)}function b(){return b=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.request)("/api/app/swarm/node-prune",{method:"POST",data:P}));case 1:case"end":return a.stop()}},m)})),b.apply(this,arguments)}function h(m){return c.apply(this,arguments)}function c(){return c=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.request)("/api/app/swarm/task-list",{method:"POST",data:P}));case 1:case"end":return a.stop()}},m)})),c.apply(this,arguments)}function A(m){return ce.apply(this,arguments)}function ce(){return ce=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.request)("/api/app/swarm/task-list-in-node",{method:"POST",data:P}));case 1:case"end":return a.stop()}},m)})),ce.apply(this,arguments)}function _e(m){return ve.apply(this,arguments)}function ve(){return ve=_()(i()().mark(function m(P){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.request)("/api/app/swarm/service-list",{method:"POST",data:P}));case 1:case"end":return a.stop()}},m)})),ve.apply(this,arguments)}}}]);
