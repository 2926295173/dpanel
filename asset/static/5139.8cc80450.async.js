"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5139],{78914:function(ae,U,t){t.d(U,{Z:function(){return Re}});var V=t(5574),g=t.n(V),m=t(15009),u=t.n(m),$=t(99289),x=t.n($),_=t(80271),z=t(65913),T=t(3393),le=t(95591),ie=t(40666),oe=t(1912),se=t(77171),ue=t(48689),M=t(45742),O=t(38345),de=t(91708),H=t(82346),ce=t(85265),J=t(42075),fe=t(96074),Q=t(28036),Y=t(66309),X=t(25593),i=t(26412),ve=t(60940),o=t(67294),W=t(80821),ee=t(5251),he=t(18148),ne=t(184),ge=t(97269),te=t(62370),me=t(65233),re=t(2487),xe=t(4393),n=t(85893),je=(0,o.forwardRef)(function(I,E){(0,o.useImperativeHandle)(E,function(){return{show:function(f){return x()(u()().mark(function K(){var A,L;return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return b(!0),(A=P.current)===null||A===void 0||A.show(),r.prev=2,r.next=5,(0,T.cd)({imageName:f}).finally(function(){var l;(l=P.current)===null||l===void 0||l.destroy()});case 5:L=r.sent,e(L.data.list),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(2),b(!1);case 12:case"end":return r.stop()}},K,null,[[2,9]])}))()}}});var F=(0,H.useAccess)(),Z=(0,o.useState)(),R=g()(Z,2),c=R[0],e=R[1],S=(0,o.useState)(""),p=g()(S,2),j=p[0],y=p[1],D=(0,o.useState)(!1),B=g()(D,2),C=B[0],b=B[1],P=(0,o.useRef)();return(0,n.jsx)(ne.a,{open:C,onOpenChange:function(f){b(f),!f&&e(void 0)},title:"\u8FDC\u7A0B Tag \u5217\u8868",isKeyPressSubmit:!0,submitter:!1,drawerProps:{extra:(0,n.jsx)(ge.A,{isKeyPressSubmit:!0,onFinish:function(f){y(f.search)},submitter:!1,children:(0,n.jsx)(J.Z.Compact,{children:(0,n.jsx)(te.Z,{style:{margin:0},name:"search",children:(0,n.jsx)(me.Z,{allowClear:!0,addonBefore:"\u641C\u7D22Tag",placeholder:"\u6309\u56DE\u8F66\u67E5\u8BE2",onClear:function(){y("")}})})})})},children:(0,n.jsx)(z.Z,{ref:P,children:(0,n.jsx)(re.Z,{rowKey:function(f){return"".concat(f)},pagination:{pageSize:50},grid:{gutter:10,column:2},dataSource:c&&c.filter(function(h){return!j||h.toLocaleLowerCase().indexOf(j.toLocaleLowerCase())!==-1}),loading:!c||(c==null?void 0:c.length)<=0,renderItem:function(f,K){return(0,n.jsx)(re.Z.Item,{children:(0,n.jsx)(xe.Z,{style:{height:"80px"},children:(0,n.jsx)(X.Z.Text,{copyable:!0,children:f})})},K)}})})},"form")}),Ce=je,Ze=t(64789),Se=t(5966),pe=t(83062),ye=t(96042);function Ie(I){var E=(0,o.useRef)(),F=(0,o.useState)(!1),Z=g()(F,2),R=Z[0],c=Z[1];return(0,n.jsxs)(ne.a,{open:R,title:"\u589E\u52A0\u955C\u50CF Tag",onOpenChange:function(S){c(S)},formRef:E,onFinish:function(){var e=x()(u()().mark(function S(p){var j,y,D;return u()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,T._U)({md5:(j=I.imageInfo.info.Id)!==null&&j!==void 0?j:"",tag:(p.imageRespo?p.imageRespo.serverAddress+"/":"")+p.imageTag});case 2:D=C.sent,c(!1),(y=E.current)===null||y===void 0||y.resetFields(),I.onFinish&&I.onFinish();case 6:case"end":return C.stop()}},S)}));return function(S){return e.apply(this,arguments)}}(),trigger:(0,n.jsx)(pe.Z,{title:"\u589E\u52A0\u955C\u50CFTag",children:(0,n.jsx)(Q.ZP,{type:"link",icon:(0,n.jsx)(Ze.Z,{})})}),children:[(0,n.jsx)(te.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,n.jsxs)(n.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,n.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,n.jsx)(ye.Z,{})}),(0,n.jsx)(Se.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],required:!0,placeholder:"\u53EA\u80FD\u4F7F\u7528\u5C0F\u5199\u82F1\u6587\u5B57\u7B26\u3001\u6570\u5B57\u3001_\u3001-\u3001",label:"\u955C\u50CF\u540D\u79F0",name:"imageTag",tooltip:"\u4F8B\u5982: name:tag\u3001namespace/name:tag\u3001registry/namespace/name:tag"})]})}var Te=t(24963),k=t(1699),Ee=t(78451),Fe=(0,o.forwardRef)(function(I,E){var F;(0,o.useImperativeHandle)(E,function(){return{show:function(l){return x()(u()().mark(function a(){return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return D(!0),s.next=3,w(l);case 3:case"end":return s.stop()}},a)}))()}}});var Z=(0,o.useRef)(),R=(0,o.useState)(),c=g()(R,2),e=c[0],S=c[1],p=(0,o.useState)(!1),j=g()(p,2),y=j[0],D=j[1],B=(0,o.useContext)(Te.Z),C=B.message,b=(0,o.useState)(0),P=g()(b,2),h=P[0],f=P[1],K=(0,H.useNavigate)(),A=(0,H.useAccess)(),L=(0,o.useRef)(),w=function(){var r=x()(u()().mark(function l(a){var v,s;return u()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return(v=Z.current)===null||v===void 0||v.show(),d.next=3,(0,T.YU)({md5:a,showLayer:!0}).finally(function(){var G;(G=Z.current)===null||G===void 0||G.destroy()});case 3:s=d.sent,S(s.data);case 5:case"end":return d.stop()}},l)}));return function(a){return r.apply(this,arguments)}}();return(0,o.useEffect)(function(){e&&w(e==null?void 0:e.info.Id)},[h]),(0,n.jsx)(ce.Z,{title:"\u5FEB\u6377\u67E5\u770B\u955C\u50CF",open:y,onClose:function(){D(!1),I.onClose&&I.onClose()},width:800,extra:(0,n.jsxs)(J.Z,{split:(0,n.jsx)(fe.Z,{type:"vertical"}),children:[(e==null?void 0:e.info)&&(0,n.jsx)(k.u,{access:"canSeeEnableCe",showProTips:!0,children:function(l){var a=l.canSeeEnableCe;return(0,n.jsx)(_.Z,{trigger:(0,n.jsx)(Q.ZP,{type:"link",disabled:a,icon:(0,n.jsx)(le.Z,{})}),imageId:e.info.Id})}}),(e==null?void 0:e.info)&&(0,n.jsx)(Ie,{imageInfo:e,onFinish:function(){w(e.info.Id)}})]}),children:(0,n.jsxs)(z.Z,{ref:Z,children:[!A.canSeeEnableCe&&(0,n.jsx)(Ce,{ref:L}),(0,n.jsxs)(O.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,n.jsx)(O.Z,{title:(0,n.jsx)(ie.Z,{}),subTitle:"Tag \u5217\u8868",ghost:!0,children:(0,n.jsx)(de.Rs,{grid:{gutter:40,column:2},headerTitle:!1,metas:{content:{render:function(l,a,v){return(0,n.jsx)(Y.Z,{color:"blue",children:(0,n.jsx)(X.Z.Text,{copyable:!0,children:a})},v)}},title:{render:function(l,a,v){return(0,n.jsxs)(J.Z,{children:[(0,n.jsxs)(W.Z,{action:function(){return(0,T.Gb)({tag:a,type:"push"})},children:[(0,n.jsx)(oe.Z,{})," Push"]}),(0,n.jsxs)(W.Z,{action:function(){return(0,T.Gb)({tag:a,type:"pull"})},children:[(0,n.jsx)(se.Z,{})," Pull"]}),(0,n.jsx)(k.u,{access:"canSeeEnableCe",showProTips:!0,showProTipsOffset:[-15,9],children:function(N){var d=N.canSeeEnableCe;return(0,n.jsx)(Q.ZP,{disabled:d,onClick:function(){var q;(q=L.current)===null||q===void 0||q.show(a)},children:"\u8FDC\u7A0BTag"})}}),(0,n.jsx)(k.u,{access:"canSeeImageListManage",children:(0,n.jsx)(W.Z,{action:function(){return(0,T.Pn)({tag:a})},danger:!0,onSuccess:function(N){return f(h+1),!0},confirm:"notification.confirm.title",children:(0,n.jsx)(ue.Z,{})})})]},v)}}},dataSource:e==null?void 0:e.info.RepoTags})}),e&&(0,n.jsx)(O.Z,{title:(0,n.jsx)(M.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",ghost:!0,children:(0,n.jsxs)(i.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,n.jsx)(i.Z.Item,{label:"ID",children:(0,n.jsx)(X.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u955C\u50CF\u5907\u6CE8\u540D\u79F0",onChange:function(){var r=x()(u()().mark(function a(v){var s;return u()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,he.Fj)({tag:e==null?void 0:e.info.RepoTags[0],title:v});case 2:s=d.sent,w(e.info.Id),C.success("\u4FEE\u6539\u955C\u50CF\u540D\u79F0\u6210\u529F");case 5:case"end":return d.stop()}},a)}));function l(a){return r.apply(this,arguments)}return l}()},children:e==null?void 0:e.info.Id})}),(0,n.jsx)(i.Z.Item,{label:"Parent",children:e==null?void 0:e.info.Parent}),(0,n.jsx)(i.Z.Item,{label:"Size",children:(0,ee.FI)((F=e==null?void 0:e.info.Size)!==null&&F!==void 0?F:0)}),(0,n.jsx)(i.Z.Item,{label:"Created",children:e==null?void 0:e.info.Created}),(0,n.jsxs)(i.Z.Item,{label:"Build",children:["Docker ",e==null?void 0:e.info.DockerVersion," ",e==null?void 0:e.info.Os," ",e==null?void 0:e.info.Architecture]}),(0,n.jsx)(i.Z.Item,{label:"Labels",children:(0,n.jsx)(i.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Labels)&&Object.keys(e==null?void 0:e.info.Config.Labels).map(function(r){return(0,n.jsx)(i.Z.Item,{label:r,children:e==null?void 0:e.info.Config.Labels[r]},r)})})})]})}),(0,n.jsx)(O.Z,{title:(0,n.jsx)(M.Z,{}),subTitle:"Dockerfile \u8BE6\u60C5",ghost:!0,children:(0,n.jsxs)(i.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,n.jsx)(i.Z.Item,{label:"CMD",children:e==null?void 0:e.info.Config.Cmd}),(0,n.jsx)(i.Z.Item,{label:"ENTRYPOINT",children:e==null?void 0:e.info.Config.Entrypoint}),(0,n.jsx)(i.Z.Item,{label:"EXPOSE",children:(e==null?void 0:e.info.Config.ExposedPorts)&&Object.keys(e==null?void 0:e.info.Config.ExposedPorts).map(function(r){return(0,n.jsx)(Y.Z,{color:"gray",children:r},r)})}),(0,n.jsx)(i.Z.Item,{label:"VOLUME",children:(e==null?void 0:e.info.Config.Volumes)&&Object.keys(e==null?void 0:e.info.Config.Volumes).map(function(r){return(0,n.jsx)(Y.Z,{color:"gray",children:r},r)})}),(0,n.jsx)(i.Z.Item,{label:"Env",children:(0,n.jsx)(i.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Env)&&(e==null?void 0:e.info.Config.Env.map(function(r,l){var a=r.split("=");return(0,n.jsx)(i.Z.Item,{label:a[0],children:a[1]},l)}))})})]})}),(e==null?void 0:e.layer)&&(0,n.jsx)(O.Z,{title:(0,n.jsx)(M.Z,{}),subTitle:"Layers",ghost:!0,children:(0,n.jsx)(ve.Z,{rowKey:"CreatedBy",dataSource:e.layer.reverse(),columns:[{title:"\u5927\u5C0F",key:"size",render:function(l,a,v){return(0,ee.FI)(a.Size)}},{title:"Layer",dataIndex:"CreatedBy",key:"CreatedBy",render:function(l,a,v){return(0,n.jsx)(Ee.Z,{content:a.CreatedBy})}}]})})]})]})})}),Re=Fe},67255:function(ae,U,t){t.d(U,{O:function(){return V},j:function(){return g}});function V(){var m=localStorage.getItem("dpanel-pagesize");return m=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(m!=null?m:"20")}}function g(m){var u="dpanel-table-column-".concat(m),$={};if(localStorage.getItem(u)){var x;$=JSON.parse((x=localStorage.getItem(u))!==null&&x!==void 0?x:"{}")}return{defaultValue:$,onChange:function(z){localStorage.setItem("dpanel-table-column-".concat(m),JSON.stringify(z))}}}}}]);
