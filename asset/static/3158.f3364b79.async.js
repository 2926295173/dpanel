"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3158],{99922:function(_e,Z,e){var N=e(97857),r=e.n(N),K=e(15009),m=e.n(K),y=e(99289),L=e.n(y),C=e(5574),x=e.n(C),D=e(67294),H=e(184),f=e(42075),s=e(49610),j=e(3616),T=e(93362),I=e(90581),B=e(85893),c=(0,D.forwardRef)(function(W,h){var l,w,ee=(0,D.useRef)(),g=(0,D.useRef)(),O=(0,D.useState)(!1),$=x()(O,2),ce=$[0],re=$[1],fe=(0,D.useState)(),ne=x()(fe,2),d=ne[0],ue=ne[1];return(0,D.useImperativeHandle)(h,function(){return{show:function(u){return L()(m()().mark(function F(){var se;return m()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:ue(u),re(!0),(se=ee.current)===null||se===void 0||se.resetFields();case 3:case"end":return le.stop()}},F)}))()}}}),(0,D.useEffect)(function(){return setTimeout(function(){var M;d&&((M=g.current)===null||M===void 0||M.start(d.url,{width:"".concat(Math.ceil(window.innerWidth*.8/8)),height:"".concat(Math.ceil(window.innerHeight/16)),cmd:d&&d.cmd,workDir:d&&d.workDir}))},500),function(){var M;(M=g.current)===null||M===void 0||M.close()}},[d,ce]),(0,B.jsxs)(H.a,{drawerProps:{forceRender:!0,width:j.FK,extra:(0,B.jsx)(f.Z,{children:(0,B.jsx)(T.Z,{title:(l=d==null?void 0:d.title)!==null&&l!==void 0?l:"",enableContainer:d==null?void 0:d.url.includes("/container"),enableHost:d==null?void 0:d.url.includes("/host"),name:d&&d.url&&(w=d.url.split("/").pop())!==null&&w!==void 0?w:""})})},onFinish:function(){var M=L()(m()().mark(function u(F){var se;return m()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(d){le.next=2;break}return le.abrupt("return",!1);case 2:return(se=g.current)===null||se===void 0||se.close(),F.entryCmd!=(d==null?void 0:d.cmd)&&ue(r()(r()({},d),{cmd:F.entryCmd})),le.abrupt("return",!1);case 5:case"end":return le.stop()}},u)}));return function(u){return M.apply(this,arguments)}}(),onValuesChange:function(u,F){if(F.entryCmd){var se;(se=ee.current)===null||se===void 0||se.submit()}},isKeyPressSubmit:!0,open:ce,formRef:ee,onOpenChange:function(u){if(re(u),!u){var F;(F=g.current)===null||F===void 0||F.close()}},submitter:!1,title:(d==null?void 0:d.title)+" - \u63A7\u5236\u53F0",children:[(0,B.jsx)(I.Z,{onOpenNewWindow:function(u){return d?(u.workDir=d&&d.workDir?d.workDir:"","".concat(d.url,"?").concat(Object.keys(u).map(function(F){return"".concat(F,"=").concat(encodeURIComponent(u[F]))}).join("&"))):""},onOpenNewWindowFinish:function(){var u;(u=g.current)===null||u===void 0||u.close(),re(!1)},onBatchCommandFinish:function(u){g.current&&g.current.run(u)}}),ce&&(0,B.jsx)(s.Z,{height:"80vh",ref:g})]})});Z.Z=c},93362:function(_e,Z,e){var N=e(97857),r=e.n(N),K=e(5574),m=e.n(K),y=e(67294),L=e(4459),C=e(25593),x=e(85265),D=e(95591),H=e(3616),f=e(82346),s=e(85893),j=(0,y.forwardRef)(function(T,I){var B=(0,y.useState)(!1),c=m()(B,2),W=c[0],h=c[1],l=(0,f.useSearchParams)(),w=m()(l,2),ee=w[0],g=w[1];return(0,y.useImperativeHandle)(I,function(){return{}}),(0,s.jsxs)(s.Fragment,{children:[T.trigger?y.cloneElement(T.trigger,{onClick:function(){h(!0)}}):(0,s.jsx)(C.Z.Link,{onClick:function(){h(!0)},children:(0,s.jsx)(D.Z,{})},"file"),(0,s.jsx)(x.Z,{width:H.R_,title:"".concat(T.title," - \u6587\u4EF6\u7BA1\u7406"),onClose:function(){g([]),h(!1)},open:W,children:W&&(0,s.jsx)(L.Z,r()({},T))})]})});Z.Z=j},80821:function(_e,Z,e){e.d(Z,{Z:function(){return f}});var N=e(97857),r=e.n(N),K=e(5574),m=e.n(K),y=e(24963),L=e(86738),C=e(28036),x=e(83062),D=e(67294),H=e(85893);function f(s){var j=(0,D.useState)(!1),T=m()(j,2),I=T[0],B=T[1],c=(0,D.useContext)(y.Z),W=c.lang,h=c.message,l=function(){B(!0);var ee=s.action();ee instanceof Promise?ee.then(function(g){if(B(!1),g){typeof s.onSuccess=="function"&&s.onSuccess(g);var O="";s.messageSuccess?typeof s.messageSuccess=="function"?O=s.messageSuccess(g):O=s.messageSuccess.indexOf("notification.")==0?W(s.messageSuccess):s.messageSuccess:O=W("notification.finish"),s.asynced?h.info(O):h.success(O)}}).catch(function(g){B(!1),typeof s.onError=="function"&&s.onError(g)}):B(!1)};return s.confirm?(0,H.jsx)(L.Z,r()(r()({style:{width:500},title:s.confirmTitle?s.confirmTitle:W("notification.title.tip"),description:typeof s.confirm=="string"&&s.confirm.indexOf("notification.")==0?W(s.confirm):s.confirm,onConfirm:l,okText:"Yes",cancelText:"No",onOpenChange:s.confirmOnOpenChange},s.confirmProps),{},{children:(0,H.jsx)(C.ZP,{block:s.block,disabled:s.disabled,icon:!s.children&&I?void 0:s.icon,loading:I,danger:s.danger,type:s.type,children:s.children})})):(0,H.jsx)(x.Z,{title:s.tips,children:(0,H.jsx)(C.ZP,{block:s.block,style:s.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:s.disabled,icon:!s.children&&I?void 0:s.icon,loading:I,onClick:l,danger:s.danger,type:s.type,children:s.children})})}},90581:function(_e,Z,e){e.d(Z,{Z:function(){return l}});var N=e(15009),r=e.n(N),K=e(99289),m=e.n(K),y=e(5574),L=e.n(y),C=e(3616),x=e(38345),D=e(64317),H=e(37476),f=e(62370),s=e(97462),j=e(95089),T=e(42075),I=e(28036),B=e(67294),c=e(89035),W=e(82346),h=e(85893);function l(w){var ee=(0,B.useState)(!1),g=L()(ee,2),O=g[0],$=g[1],ce=(0,B.useRef)(),re=(0,B.useState)({height:210,width:57}),fe=L()(re,2),ne=fe[0],d=fe[1],ue=function(){var u=window.innerWidth,F=window.innerHeight;d({height:Math.ceil(F/16),width:Math.ceil(u/8)})};return(0,B.useEffect)(function(){window.addEventListener("resize",function(){ue()}),ue()},[]),(0,h.jsx)(x.Z,{ghost:!0,children:(0,h.jsxs)(T.Z.Compact,{children:[(0,h.jsx)(D.Z,{width:"sm",name:"entryCmd",placeholder:"\u5207\u6362 shell \u73AF\u5883",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,h.jsx)(H.Y,{modalProps:{width:C.ob,height:C.Ed},title:"\u6279\u91CF\u6267\u884C\u811A\u672C",name:"batchCommand",open:O,trigger:(0,h.jsx)(I.ZP,{children:"\u6279\u91CF\u6267\u884C\u811A\u672C"}),formKey:"batchCommand",formRef:ce,isKeyPressSubmit:!0,onFinish:function(){var M=m()(r()().mark(function u(F){return r()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:w.onBatchCommandFinish&&w.onBatchCommandFinish(F.shell.split(`
`)),$(!1);case 2:case"end":return pe.stop()}},u)}));return function(u){return M.apply(this,arguments)}}(),onOpenChange:function(u){$(u),u&&ce.current&&ce.current.resetFields()},children:(0,h.jsx)(f.Z,{name:"shell",children:(0,h.jsx)(j.ZP,{theme:"dark",height:C.Ed})})}),(0,h.jsx)(f.Z,{children:(0,h.jsx)(s.Z,{name:["entryCmd"],children:function(u){var F=u.entryCmd;return(!F||F=="")&&(F="/bin/sh"),w.onOpenNewWindow&&(0,h.jsx)(W.Link,{onClick:function(){w.onOpenNewWindowFinish&&w.onOpenNewWindowFinish()},target:"_blank",to:w.onOpenNewWindow({width:ne.width,height:ne.height,cmd:F}),children:(0,h.jsx)(I.ZP,{type:"dashed",icon:(0,h.jsx)(c.Z,{}),children:"\u65B0\u7A97\u53E3\u6253\u5F00"})})}})})]})})}},49610:function(_e,Z,e){var N=e(5574),r=e.n(N),K=e(67294),m=e(54964),y=e(52626),L=e(12320),C=e.n(L),x=e(78267),D=e.n(x),H=e(85893),f,s=new L.Terminal(m.a),j=new x.FitAddon,T,I=(0,K.forwardRef)(function(B,c){var W,h=(0,K.useState)(),l=r()(h,2),w=l[0],ee=l[1],g=(0,K.useState)(""),O=r()(g,2),$=O[0],ce=O[1];(0,K.useImperativeHandle)(c,function(){return{start:function(ne,d){var ue=d?Object.keys(d).filter(function(M){return d&&d[M]}).map(function(M){if(d&&d[M])return"".concat(M,"=").concat(d[M])}):[];re(),f=new WebSocket((0,y.R)(ne+"?"+ue.join("&"))),f.addEventListener("message",function(M){var u=JSON.parse(M.data),F=u.type;if(F==ne&&(s.write(u.data),u.data.indexOf("exec failed")!=-1)){re();return}}),T=s.onData(function(M){var u={content:{command:M},type:ne};f&&f.send(JSON.stringify(u))}),ce(ne),ee(d)},close:function(){re()},fit:function(){j.fit()},run:function(ne){w&&ne&&ne.forEach(function(d){var ue={content:{command:d+`
`},type:$};f&&f.send(JSON.stringify(ue))})}}}),(0,K.useEffect)(function(){return window.addEventListener("resize",function(){j.fit()}),s.loadAddon(j),s.open(document.getElementById("terminal-container-console")),j.fit(),function(){re()}},[]);function re(){s.reset(),j.fit(),s.focus(),T&&T.dispose(),f&&(f.close(),f=null)}return(0,H.jsx)("div",{style:{height:(W=B.height)!==null&&W!==void 0?W:"100vh"},id:"terminal-container-console"})});Z.Z=I},81366:function(_e,Z,e){var N=e(19632),r=e.n(N),K=e(5574),m=e.n(K),y=e(27254),L=e(42075),C=e(28036),x=e(25593),D=e(67294),H=e(31112),f=e(85893),s={title:"ROOT",path:"/"},j=(0,D.forwardRef)(function(T,I){var B=(0,D.useContext)(H.Z),c=B.showPath,W=(0,D.useState)([s]),h=m()(W,2),l=h[0],w=h[1];(0,D.useImperativeHandle)(I,function(){return{addHistory:function(O,$){$=="/"?w([s]):w([].concat(r()(l),[{title:O,path:$}]))},initHistory:function(O){w([s].concat(r()(O)))}}});var ee=function(O){c?c(l[O].title,l[O].path):T.showPath&&T.showPath(l[O].title,l[O].path);var $=l.filter(function(ce,re){return re<=O});w(r()($))};return(0,f.jsxs)(L.Z,{children:[(0,f.jsx)(L.Z.Compact,{children:l.map(function(g,O){return(0,f.jsx)(C.ZP,{icon:(0,f.jsx)(y.Z,{}),type:"dashed",onClick:function(){ee(O)},children:g.title},O)})}),l.length>=2&&(0,f.jsx)(x.Z.Text,{copyable:{text:l[l.length-1].path}})]})});Z.Z=j},31112:function(_e,Z,e){var N=e(67294),r=(0,N.createContext)({});Z.Z=r},4459:function(_e,Z,e){e.d(Z,{Z:function(){return an}});var N=e(15009),r=e.n(N),K=e(99289),m=e.n(K),y=e(5574),L=e.n(y),C=e(82346);function x(t,i){return D.apply(this,arguments)}function D(){return D=m()(r()().mark(function t(i,_){var E;return r()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return E="/api/".concat(i,"/explorer/get-path-list"),k.next=3,(0,C.request)(E,{data:_,method:"POST"});case 3:return k.abrupt("return",k.sent);case 4:case"end":return k.stop()}},t)})),D.apply(this,arguments)}function H(t,i){return f.apply(this,arguments)}function f(){return f=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/export"),{data:_,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),f.apply(this,arguments)}function s(t,i){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function t(i,_){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return _.enableExportHost=!0,n.next=3,request("/api/".concat(i,"/explorer/export"),{data:_,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},t)})),j.apply(this,arguments)}function T(t,i){return I.apply(this,arguments)}function I(){return I=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/import"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),I.apply(this,arguments)}function B(t,i){return c.apply(this,arguments)}function c(){return c=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/delete"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),c.apply(this,arguments)}function W(t,i){return h.apply(this,arguments)}function h(){return h=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/unzip"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),h.apply(this,arguments)}function l(t,i){return w.apply(this,arguments)}function w(){return w=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/get-content"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),w.apply(this,arguments)}function ee(t,i){return g.apply(this,arguments)}function g(){return g=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/import-file-content"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),g.apply(this,arguments)}function O(t,i){return $.apply(this,arguments)}function $(){return $=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/mkdir"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),$.apply(this,arguments)}function ce(t,i){return re.apply(this,arguments)}function re(){return re=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/chmod"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),re.apply(this,arguments)}function fe(t,i){return ne.apply(this,arguments)}function ne(){return ne=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/get-user-list"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),ne.apply(this,arguments)}function d(t,i){return ue.apply(this,arguments)}function ue(){return ue=m()(r()().mark(function t(i,_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.request)("/api/".concat(i,"/explorer/get-file-stat"),{data:_,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),ue.apply(this,arguments)}var M=e(41482),u=e(67294),F=e(31112),se=e(51042),pe=e(48689),le=e(42075),ge=e(28036),Re=e(80821),We=e(88484),Be=e(37476),Ae=e(91604),Le=e(97961),xe=e(3616),a=e(85893);function we(){var t=(0,u.useRef)(),i=(0,u.useContext)(F.Z),_=i.refresh,E=i.name,n=i.apiPrefix,k=i.currentPath;return(0,a.jsx)(Be.Y,{modalProps:{width:xe.ob},formRef:t,trigger:(0,a.jsx)(ge.ZP,{icon:(0,a.jsx)(We.Z,{}),children:"\u4E0A\u4F20"}),title:"\u4E0A\u4F20\u6587\u4EF6\u5230\u5BB9\u5668",onFinish:function(){var G=m()(r()().mark(function te(J){var ae,Y;return r()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return Y=[],J.importFileList&&J.importFileList.map(function(Q){Y.push({name:Q.name,path:Q.response.data.path})}),T(n,{fileList:Y,name:E,destPath:k}),(ae=t.current)===null||ae===void 0||ae.resetFields(),_(),ie.abrupt("return",!0);case 6:case"end":return ie.stop()}},te)}));return function(te){return G.apply(this,arguments)}}(),children:(0,a.jsx)(Ae.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(te){return new Promise(function(J){var ae;(0,Le._2)({path:(ae=te.response.data.path)!==null&&ae!==void 0?ae:""}).then(function(Y){J(!0)})})}}})})}var Ue=e(23430),Ie=e(93162),Ce=e(24963);function Ze(t){var i=(0,u.useContext)(F.Z),_=i.name,E=i.apiPrefix,n=(0,u.useContext)(Ce.Z),k=n.message;return(0,a.jsx)(Re.Z,{action:function(){return!t.selectFileList||t.selectFileList.length==0?(k.info("\u8BF7\u9009\u62E9\u8981\u4E0B\u8F7D\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):H(E,{name:_,fileList:t.selectFileList})},onSuccess:function(te){var J=new Blob([te],{type:"application/zip"});(0,Ie.saveAs)(J,"export.zip")},icon:(0,a.jsx)(Ue.Z,{}),children:"\u4E0B\u8F7D"})}var De=e(38345),he=e(63434),Ke=e(24739),je=e(5966);function Se(t){var i=(0,u.useContext)(Ce.Z),_=i.notice,E=(0,u.useRef)(),n=(0,u.useContext)(F.Z),k=n.currentPath,G=n.refresh,te=n.name,J=n.apiPrefix,ae=(0,u.useState)(!1),Y=L()(ae,2),oe=Y[0],ie=Y[1],Q=function(R){var P=R.split(""),U=0,A=0,b=0;return P[1]=="r"&&(U+=4),P[2]=="w"&&(U+=2),P[3]=="x"&&(U+=1),P[4]=="r"&&(A+=4),P[5]=="w"&&(A+=2),P[6]=="x"&&(A+=1),P[7]=="r"&&(b+=4),P[8]=="w"&&(b+=2),P[9]=="x"&&(b+=1),"".concat(U).concat(A).concat(b)},Ee=function(R){var P;if((P=E.current)===null||P===void 0||P.setFieldValue("permission",R),R.length>=1){var U;(U=E.current)===null||U===void 0||U.setFieldsValue({ownerRead:Number(R[0])&4,ownerWrite:Number(R[0])&2,ownerExec:Number(R[0])&1})}if(R.length>=2){var A;(A=E.current)===null||A===void 0||A.setFieldsValue({groupRead:Number(R[1])&4,groupWrite:Number(R[1])&2,groupExec:Number(R[1])&1})}if(R.length>=3){var b;(b=E.current)===null||b===void 0||b.setFieldsValue({everyoneRead:Number(R[2])&4,everyoneWrite:Number(R[2])&2,everyoneExec:Number(R[2])&1})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ge.ZP,{onClick:m()(r()().mark(function de(){var R;return r()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!(!t.selectFileObject||t.selectFileObject.length==0)){U.next=7;break}return(R=E.current)===null||R===void 0||R.resetFields(),_.error("\u8BF7\u5148\u9009\u62E9\u8981\u4FEE\u6539\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),ie(!1),U.abrupt("return",!1);case 7:ie(!0);case 8:case"end":return U.stop()}},de)})),children:"\u6743\u9650"}),(0,a.jsxs)(Be.Y,{modalProps:{forceRender:!0,width:xe.ob},title:t.selectFileObject.length==1?"\u4FEE\u6539 ".concat(t.selectFileObject[0].name," \u6743\u9650"):"\u6279\u91CF\u6587\u4EF6\u4FEE\u6539\u6743\u9650",layout:"horizontal",open:oe,onOpenChange:function(R){ie(R),t.selectFileObject.length==1&&Ee(Q(t.selectFileObject[0].modStr))},formRef:E,onValuesChange:function(R,P){if(R.permission)Ee(R.permission);else{var U=["-",P.ownerRead?"r":"-",P.ownerWrite?"w":"-",P.ownerExec?"x":"-",P.groupRead?"r":"-",P.groupWrite?"w":"-",P.groupExec?"x":"-",P.everyoneRead?"r":"-",P.everyoneWrite?"w":"-",P.everyoneExec?"x":"-"];Ee(Q(U.join("")))}},onFinish:function(){var de=m()(r()().mark(function R(P){var U,A,b,ve;return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return b=[],t.selectFileObject.map(function(o){b.push(o.path)}),v.next=4,ce(J,{name:te,fileList:b,mod:(U=P.permission)!==null&&U!==void 0?U:"600",hasChildren:(A=P.hasChildren)!==null&&A!==void 0?A:!0,user:P.user});case 4:return ve=v.sent,G(),v.abrupt("return",!0);case 7:case"end":return v.stop()}},R)}));return function(R){return de.apply(this,arguments)}}(),children:[(0,a.jsxs)(De.Z,{direction:"row",gutter:[20,10],children:[(0,a.jsxs)(De.Z,{bordered:!0,title:"\u6240\u6709\u8005",headerBordered:!0,children:[(0,a.jsx)(he.Z,{label:"\u8BFB\u53D6",name:"ownerRead"}),(0,a.jsx)(he.Z,{label:"\u5199\u5165",name:"ownerWrite"}),(0,a.jsx)(he.Z,{label:"\u6267\u884C",name:"ownerExec"})]}),(0,a.jsxs)(De.Z,{bordered:!0,title:"\u7528\u6237\u7EC4",headerBordered:!0,children:[(0,a.jsx)(he.Z,{label:"\u8BFB\u53D6",name:"groupRead"}),(0,a.jsx)(he.Z,{label:"\u5199\u5165",name:"groupWrite"}),(0,a.jsx)(he.Z,{label:"\u6267\u884C",name:"groupExec"})]}),(0,a.jsxs)(De.Z,{bordered:!0,title:"\u516C\u5171",headerBordered:!0,children:[(0,a.jsx)(he.Z,{label:"\u8BFB\u53D6",name:"everyoneRead"}),(0,a.jsx)(he.Z,{label:"\u5199\u5165",name:"everyoneWrite"}),(0,a.jsx)(he.Z,{label:"\u6267\u884C",name:"everyoneExec"})]})]}),(0,a.jsx)(De.Z,{children:(0,a.jsxs)(Ke.UW,{children:[(0,a.jsx)(je.Z,{label:"\u6743\u9650",name:"permission",fieldProps:{maxLength:3},width:"xs"}),(0,a.jsxs)(le.Z.Compact,{children:[(0,a.jsx)(je.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237",label:"\u6240\u6709\u8005",name:"user",fieldProps:{addonAfter:":"}}),(0,a.jsx)(je.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237\u7EC4",name:"group"})]}),(0,a.jsx)(he.Z,{label:"\u5E94\u7528\u5230\u5B50\u76EE\u5F55",name:"hasChildren",initialValue:!0})]})})]})]})}var Ne=e(27461);function $e(t){var i=(0,u.useContext)(F.Z),_=i.currentPath,E=i.refresh,n=i.name,k=i.apiPrefix,G=(0,u.useContext)(Ce.Z),te=G.notice;return(0,a.jsx)(Re.Z,{icon:(0,a.jsx)(Ne.Z,{}),action:m()(r()().mark(function J(){return r()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(t.selectFileObject.length!=0){Y.next=3;break}return te.error("\u8BF7\u5148\u9009\u62E9\u8981\u89E3\u538B\u7684 .zip .tar .tar.gz \u6587\u4EF6"),Y.abrupt("return",!1);case 3:return Y.abrupt("return",W(k,{name:n,file:t.selectFileObject.map(function(oe){return oe.path}),path:_}));case 4:case"end":return Y.stop()}},J)})),onSuccess:function(){E()},children:"\u89E3\u538B"})}function sn(t){var i=useContext(FileExplorerContext),_=i.name,E=i.apiPrefix,n=useContext(AppContext),k=n.message,G=useRef();return _jsx(RequestButton,{confirm:_jsx(Space,{children:_jsx(ProForm,{layout:"inline",submitter:!1,formRef:G,children:_jsx(ProFormText,{width:"md",label:"\u5BFC\u51FA\u5230\u4E3B\u673A\u76EE\u5F55",name:"hostPath"})})}),action:function(){var J;return!t.selectFileList||t.selectFileList.length==0?(k.info("\u8BF7\u9009\u62E9\u8981\u5BFC\u51FA\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):exportFileList(E,{name:_,hostPath:(J=G.current)===null||J===void 0?void 0:J.getFieldValue("hostPath"),enableExportHost:!0,fileList:t.selectFileList})},icon:_jsx(ExportOutlined,{}),children:"\u5BFC\u51FA\u5230\u4E3B\u673A"})}function ze(t){var i=(0,u.useContext)(F.Z),_=i.refresh,E=i.name,n=i.apiPrefix,k=i.currentPath,G=i.newFile;return(0,a.jsxs)(le.Z,{size:16,wrap:!0,children:[(0,a.jsx)(Ze,{selectFileList:t.selectFileList}),!1,(0,a.jsx)(we,{}),(0,a.jsx)(Se,{selectFileObject:t.selectFileObject}),(0,a.jsx)($e,{selectFileObject:t.selectFileObject}),(0,a.jsx)(ge.ZP,{icon:(0,a.jsx)(se.Z,{}),onClick:function(){G()},type:"primary",children:"\u65B0\u5EFA"}),(0,a.jsx)(Re.Z,{danger:!0,type:"default",icon:(0,a.jsx)(pe.Z,{}),action:function(){return B(n,{name:E,fileList:t.selectFileList})},onSuccess:function(){_()},confirm:"notification.confirm.title",children:"\u5220\u9664"})]})}var Me=e(83062),Fe=e(66309);function He(t){return t.change==0?(0,a.jsx)(Me.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u4FEE\u6539",children:(0,a.jsx)(Fe.Z,{color:"blue",children:"MODIFIED"})}):t.change==1?(0,a.jsx)(Me.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u65B0\u589E\u7684\u6587\u4EF6",children:(0,a.jsx)(Fe.Z,{color:"green",children:"ADD"})}):t.change==2?(0,a.jsx)(Me.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u5220\u9664\u6587\u4EF6",children:(0,a.jsx)(Fe.Z,{color:"error",children:"DELETED"})}):t.change==100?(0,a.jsx)(Me.Z,{title:"\u6302\u8F7D\u7684\u6301\u4E45\u5316\u76EE\u5F55",children:(0,a.jsx)(Fe.Z,{color:"cyan",children:"VOLUME"})}):(0,a.jsx)(a.Fragment,{})}var Ve=e(81366),ke=e(97269),Ge=e(86615),Je=e(97462),Ye=e(62370),Qe=e(85576),Xe=e(95089),be=e(5251),qe=(0,u.forwardRef)(function(t,i){var _,E,n,k=(0,u.useContext)(Ce.Z),G=k.message,te=k.notice,J=(0,u.useContext)(F.Z),ae=J.currentPath,Y=J.refresh,oe=J.name,ie=J.apiPrefix,Q=(0,u.useRef)(),Ee=(0,u.useState)(!1),de=L()(Ee,2),R=de[0],P=de[1];return(0,u.useImperativeHandle)(i,function(){return{newFile:function(){var A,b;P(!0),(A=Q.current)===null||A===void 0||A.resetFields(),(b=Q.current)===null||b===void 0||b.setFieldValue("type","newFile")},editFile:function(A,b,ve){return m()(r()().mark(function p(){var v,o,S,V,X;return r()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return(v=Q.current)===null||v===void 0||v.resetFields(),G.loading("\u6B63\u5728\u83B7\u53D6\u6587\u4EF6\u5185\u5BB9"),z.next=4,l(ie,{name:oe,file:b}).finally(function(){G.destroy()});case 4:if(X=z.sent,!(X.data.content==""&&ve!="0")){z.next=9;break}return G.error("\u4E0D\u652F\u6301\u7F16\u8F91\u7684\u6587\u4EF6\u7C7B\u578B"),P(!1),z.abrupt("return");case 9:return(o=Q.current)===null||o===void 0||o.setFieldValue("newValue",X.data.content),(S=Q.current)===null||S===void 0||S.setFieldValue("newName",A),(V=Q.current)===null||V===void 0||V.setFieldValue("type","editFile"),P(!0),z.abrupt("return");case 14:case"end":return z.stop()}},p)}))()}}}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Qe.Z,{width:xe.ob,title:(_=Q.current)!==null&&_!==void 0&&_.getFieldValue("newName")?"\u7F16\u8F91\u6587\u4EF6":"\u65B0\u5EFA\u6587\u4EF6",open:R,onCancel:function(){var A;P(!1),(A=Q.current)===null||A===void 0||A.resetFields()},footer:!1,forceRender:!0,children:(0,a.jsxs)(ke.A,{formRef:Q,onFinish:function(){var U=m()(r()().mark(function A(b){return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(b.type!="newDir"){p.next=13;break}return p.prev=1,p.next=4,O(ie,{name:oe,destPath:"".concat(ae,"/").concat((0,be.fi)(b.newPath,"/"))});case 4:return Y(),P(!1),p.abrupt("return",!0);case 9:p.prev=9,p.t0=p.catch(1);case 11:p.next=23;break;case 13:return p.prev=13,p.next=16,ee(ie,{destPath:ae,file:b.newName,content:b.newValue,name:oe});case 16:return Y(),P(!1),p.abrupt("return",!0);case 21:p.prev=21,p.t1=p.catch(13);case 23:return p.abrupt("return",!1);case 24:case"end":return p.stop()}},A,null,[[1,9],[13,21]])}));return function(A){return U.apply(this,arguments)}}(),children:[(0,a.jsx)(Ge.Z.Group,{name:"type",options:[{label:"\u7F16\u8F91\u6587\u4EF6",value:"editFile",disabled:((E=Q.current)===null||E===void 0?void 0:E.getFieldValue("type"))!="editFile"},{label:"\u65B0\u5EFA\u6587\u4EF6",value:"newFile"},{label:"\u65B0\u5EFA\u76EE\u5F55",value:"newDir"}],disabled:((n=Q.current)===null||n===void 0?void 0:n.getFieldValue("type"))=="editFile"}),(0,a.jsx)(Je.Z,{name:["type"],children:function(A){var b=A.type;return b!="newDir"?[(0,a.jsx)(je.Z,{label:"\u6587\u4EF6\u540D",tooltip:"\u7F16\u8F91\u6587\u4EF6\u65F6\u4FEE\u6539\u6587\u4EF6\u540D\u53EF\u5B9E\u73B0\u590D\u5236\u529F\u80FD",name:"newName",fieldProps:{addonBefore:"".concat(ae,"/")},placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D",disabled:b=="editFile"},"fileName"),(0,a.jsx)(Ye.Z,{label:"\u5185\u5BB9",name:"newValue",children:(0,a.jsx)(Xe.ZP,{theme:"dark",height:xe.Ed,onChange:function(p){var v;(v=Q.current)===null||v===void 0||v.setFieldValue("newValue",p)}})},"fileContent")]:(0,a.jsx)(je.Z,{name:"newPath",label:"\u76EE\u5F55\u540D",placeholder:"\u8F93\u5165\u76EE\u5F55\u540D\u79F0\uFF0C\u652F\u6301\u591A\u7EA7"})}})]})})})}),en=qe,nn=e(99922),ye=e(68536),tn=e(87662),un=null;function rn(t){var i=(0,u.useRef)(),_=(0,u.useRef)(),E=(0,u.useRef)(),n=(0,u.useState)(""),k=L()(n,2),G=k[0],te=k[1],J=(0,u.useRef)(),ae=(0,C.useSearchParams)(),Y=L()(ae,2),oe=Y[0],ie=Y[1],Q=(0,u.useState)(),Ee=L()(Q,2),de=Ee[0],R=Ee[1],P=(0,u.useContext)(Ce.Z),U=P.lang,A=P.message,b=t.apiPrefix=="host"?"common":"app";(0,u.useEffect)(function(){var p,v=(p=oe.get("path"))!==null&&p!==void 0?p:t.workDir;if(v){for(var o,S=v.split("/"),V=[],X="",me=1;me<S.length;me++)X+="/"+S[me],V.push({title:S[me],path:X});ve(S[S.length-1],v),(o=i.current)===null||o===void 0||o.initHistory([].concat(V))}(0,tn.K3)().then(function(z){!z.data.enableSSH&&A.info(U("app.detail.createExplorerPlugin"))})},[t.name,oe]);var ve=function(v,o){var S,V;if((S=i.current)===null||S===void 0||S.addHistory(v,o),te(o),E.current&&(V=E.current)!==null&&V!==void 0&&V.reloadAndRest){var X;(X=E.current)===null||X===void 0||X.reloadAndRest()}o=="/"?ie([]):(oe.set("path",o),ie(oe))};return(0,a.jsxs)(F.Z.Provider,{value:{apiPrefix:b,name:t.name,currentPath:G,showPath:ve,refresh:function(){var v;if(E&&typeof((v=E.current)===null||v===void 0?void 0:v.reloadAndRest)=="function"){var o;(o=E.current)===null||o===void 0||o.reloadAndRest()}},editFile:function(v,o,S){_.current&&_.current.editFile(v,o,S)},newFile:function(){_.current&&_.current.newFile()}},children:[(0,a.jsx)(M.Z,{scroll:{x:"max-content"},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},toolBarRender:function(){var v=[];return t.onConsole&&v.push((0,a.jsx)(ge.ZP,{type:"dashed",onClick:function(){t.onConsole&&t.onConsole(G)},children:"Console"},"fileConsole")),[].concat(v)},tableAlertOptionRender:function(v){var o=v.selectedRowKeys,S=v.selectedRows,V=[];return S.map(function(X){V.push(X.path)}),[(0,a.jsx)(ze,{selectFileList:V,selectFileObject:S,enableExportHost:t.apiPrefix=="container"},"1")]},headerTitle:(0,a.jsx)(Ve.Z,{ref:i}),actionRef:E,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:m()(r()().mark(function p(){var v,o,S,V,X;return r()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,x(b,{name:t.name,path:G});case 2:if(v=z.sent,G==""&&v.data.currentPath!=""&&(S=[],(o=i.current)===null||o===void 0||o.initHistory(v.data.currentPath.split("/").filter(function(q){return q!=""}).map(function(q){return S.push(q),{title:q,path:"/".concat(S.join("/"))}}))),V=de,V){z.next=11;break}return z.next=8,fe(b,{name:t.name});case 8:X=z.sent,R(X.data),V=X.data;case 11:return z.abrupt("return",{data:v.data.list.map(function(q){if(V){var Pe,Te;q.group=(Pe=(Te=V.group.find(function(Oe){return Oe.gid==q.group}))===null||Te===void 0?void 0:Te.name)!==null&&Pe!==void 0?Pe:q.group}return q}),success:!0,total:v.data.list.length});case 12:case"end":return z.stop()}},p)})),columns:[{title:"\u540D\u79F0",dataIndex:"name",key:"name",render:function(me,o,S,V,X){var me;return o.isDir?me=(0,a.jsx)(ye.Z,{isDir:!0,onClick:function(){return ve(o.name,o.path)},showName:o.name}):o.isSymlink?me=(0,a.jsx)(ye.Z,{isLink:!0,showName:"".concat(o.name," -> ").concat(o.linkName),onClick:m()(r()().mark(function z(){var q,Pe;return r()().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:return Oe.next=2,d(b,{name:t.name,path:o.path});case 2:q=Oe.sent,q.data.info.isDir?ve(o.name,q.data.info.target):(Pe=_.current)===null||Pe===void 0||Pe.editFile(q.data.info.name,q.data.info.target,o.size);case 4:case"end":return Oe.stop()}},z)}))}):me=(0,a.jsx)(ye.Z,{showName:o.name,onClick:function(){var q;(q=_.current)===null||q===void 0||q.editFile(o.name,o.path,o.size)}}),me}},{title:"\u72B6\u6001",key:"status",width:110,render:function(v,o,S,V,X){return(0,a.jsx)(He,{change:o.change})}},{title:"\u6743\u9650",dataIndex:"modStr",key:"mod"},{title:"\u7528\u6237",dataIndex:"user"},{title:"\u7528\u6237\u7EC4",dataIndex:"group"},{title:"\u5927\u5C0F",dataIndex:"size",key:"size",render:function(v,o,S,V,X){return(0,be.FI)(o.size)}},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"modTime",key:"modTime",sorter:function(v,o){return new Date(v.modTime).getTime()-new Date(o.modTime).getTime()},render:function(v,o,S,V,X){return(0,be.NF)(o.modTime)}}],cardProps:{ghost:!0}}),(0,a.jsx)(en,{ref:_}),(0,a.jsx)(nn.Z,{ref:J})]})}var an=rn},68536:function(_e,Z,e){e.d(Z,{Z:function(){return H}});var N=e(24963),r=e(93613),K=e(36693),m=e(2741),y=e(25593),L=e(42075),C=e(67294),x=e(85893),D=0;function H(f){var s=(0,C.useContext)(N.Z),j=s.message;return f.isDir?(0,x.jsx)(y.Z.Link,{onClick:function(){f.onClick&&f.onClick()},children:(0,x.jsxs)(L.Z,{children:[(0,x.jsx)(r.Z,{}),f.showName]})}):f.isLink?(0,x.jsx)(y.Z.Link,{onClick:function(){f.onClick&&f.onClick()},children:(0,x.jsxs)(L.Z,{children:[(0,x.jsx)(K.Z,{}),f.showName]})}):(0,x.jsx)(y.Z.Text,{onClick:function(){if(D++,D==2){D=0,f.onClick&&f.onClick();return}setTimeout(function(){D==1&&j.info("\u53CC\u51FB\u67E5\u770B\u6587\u4EF6\u5185\u5BB9"),D=0},400)},style:{cursor:"pointer"},children:(0,x.jsxs)(L.Z,{children:[(0,x.jsx)(m.Z,{}),f.showName]})})}},54964:function(_e,Z,e){e.d(Z,{a:function(){return s}});var N=e(5574),r=e.n(N),K=e(78267),m=e.n(K),y=e(75458),L=e.n(y),C=e(67294),x=e(12320),D=e.n(x),H=e(89629),f=e(85893),s={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},j=new x.Terminal(s),T=new y.SearchAddon,I=new K.FitAddon,B=(0,C.forwardRef)(function(c,W){var h,l=(0,C.useState)(!0),w=r()(l,2),ee=w[0],g=w[1];return(0,C.useEffect)(function(){return window.addEventListener("resize",function(){c.showInModal||I.fit()}),c.style&&c.style.fontSize&&(j.options.fontSize=c.style.fontSize),j.loadAddon(I),j.loadAddon(T),j.open(document.getElementById(c.id?c.id:"terminal-container")),c.showInModal||I.fit(),function(){j.reset(),g(!0)}},[]),(0,C.useImperativeHandle)(W,function(){return{write:function($){ee&&(I.fit(),g(!1)),j.write($)},clear:function(){j.clear()},getTerminal:function(){return j},findNext:function($){T.findNext($)},findPrev:function($){T.findPrevious($)},fit:function(){I.fit()},onData:function($){return j.onData($)}}}),(0,f.jsx)("div",{id:c.id?c.id:"terminal-container",style:{width:c.width?c.width:"100%",height:c.height?c.height:"500px",marginTop:(h=c.style)===null||h===void 0?void 0:h.marginTop}})});Z.Z=B},3616:function(_e,Z,e){e.d(Z,{Ed:function(){return m},FK:function(){return r},R_:function(){return N},ob:function(){return K}});var N=window.innerWidth<=1024?"90vw":"65vw",r="90vw",K="60vw",m="50vh"},24963:function(_e,Z,e){var N=e(67294),r=(0,N.createContext)({});Z.Z=r},97961:function(_e,Z,e){e.d(Z,{GH:function(){return f},MF:function(){return I},_2:function(){return j},fN:function(){return C},ii:function(){return L},vC:function(){return D}});var N=e(15009),r=e.n(N),K=e(99289),m=e.n(K),y=e(82346),L=[{name:"linux/amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"linux/arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"linux/i386",arch:"386",search:[]},{name:"linux/arm/v6",arch:"arm",search:[]},{name:"linux/arm/v7",arch:"arm",search:[]},{name:"linux/arm/v8",arch:"arm64",search:[]},{name:"linux/ppc64le",arch:"ppc64le",search:[]},{name:"linux/riscv64",arch:"riscv64",search:[]}];function C(c){return x.apply(this,arguments)}function x(){return x=m()(r()().mark(function c(W){return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,y.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:W}));case 1:case"end":return l.stop()}},c)})),x.apply(this,arguments)}function D(c){return H.apply(this,arguments)}function H(){return H=m()(r()().mark(function c(W){return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,y.request)("/api/app/image/import-by-container-tar",{method:"POST",data:W}));case 1:case"end":return l.stop()}},c)})),H.apply(this,arguments)}function f(c){return s.apply(this,arguments)}function s(){return s=m()(r()().mark(function c(W){return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,y.request)("/api/app/image/import-by-image-tar",{method:"POST",data:W}));case 1:case"end":return l.stop()}},c)})),s.apply(this,arguments)}function j(c){return T.apply(this,arguments)}function T(){return T=m()(r()().mark(function c(W){return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,y.request)("/api/common/attach/delete",{method:"POST",data:W});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},c)})),T.apply(this,arguments)}function I(){return B.apply(this,arguments)}function B(){return B=m()(r()().mark(function c(){return r()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,y.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return h.stop()}},c)})),B.apply(this,arguments)}}}]);
