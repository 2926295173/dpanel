"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9170],{37767:function(on,$,n){n.d($,{Z:function(){return rn}});var U=n(15009),o=n.n(U),O=n(99289),_=n.n(O),E=n(5574),L=n.n(E),u=n(45605),x=n(38345),v=n(97269),C=n(26412),M=n(42075),c=n(96074),I=n(25593),a=n(2487),m=n(67294),r=n(76428),h=n(78498),t=n(44771),d=n(60335),F=n(24963),R=n(37413),f=n(5251),D=n(82346),S=n(87662),i=n(85893);function rn(s){var K,tn,dn,G,an,vn,cn,z,hn,e,q=(0,m.useState)(""),b=L()(q,2),nn=b[0],Q=b[1],mn=(0,D.useAccess)(),w=(0,m.useContext)(F.Z),Cn=w.message,En=w.notice,In=w.loading,Pn=w.lang,P=(0,m.useRef)(),ln=[],Dn=[],sn=[],un=(0,m.useState)(""),H=L()(un,2),J=H[0],_n=H[1];return(0,m.useEffect)(function(){if(s.data){var A;(A=P.current)===null||A===void 0||A.setFieldValue("restart",s.data.info.HostConfig.RestartPolicy.Name),(0,S.K3)().then(function(W){var Z;_n((Z=W.data.serverUrl)!==null&&Z!==void 0?Z:"")}),Q(s.data.info.Name)}},[s.data]),s.data&&s.data.domain&&s.data.domain.map(function(A){sn.push(A.setting.enableSSL?"https://"+A.serverName:"http://"+A.serverName)}),s.data&&s.data.info.NetworkSettings&&s.data.info.NetworkSettings.Ports&&Object.keys(s.data.info.NetworkSettings.Ports).map(function(A){var W,Z,Y=(W=(Z=s.data.info)===null||Z===void 0?void 0:Z.NetworkSettings.Ports[A])!==null&&W!==void 0?W:[{HostPort:null,HostIp:""}],en=A.split("/"),gn=L()(en,2),X=gn[0],k=gn[1];Y.map(function(fn){fn.HostPort?ln.push({PrivatePort:X,Type:k,IP:fn.HostIp,PublicPort:fn.HostPort}):Dn.push({PrivatePort:X,Type:k,IP:"",PublicPort:""})})}),(0,i.jsxs)(i.Fragment,{children:[s.data&&s.data.info.State.Running&&(0,i.jsx)(R.Z,{publicPort:ln,privatePort:Dn,domain:sn,serverIp:J,showInDetail:!0,ghost:s.ghost,layout:"inline"}),(0,i.jsx)(x.Z,{title:(0,i.jsx)(u.Z,{}),subTitle:"\u5BB9\u5668\u72B6\u6001",ghost:s.ghost,children:(0,i.jsxs)(C.Z,{column:1,bordered:!0,children:[(0,i.jsx)(C.Z.Item,{label:"Hostname",children:(0,i.jsx)(M.Z,{split:(0,i.jsx)(c.Z,{type:"vertical"}),children:(0,i.jsx)(r.Z,{title:(K=s.data.info)===null||K===void 0?void 0:K.Config.Hostname})})}),(0,i.jsx)(C.Z.Item,{label:"\u5BB9\u5668\u540D\u79F0",children:(0,i.jsxs)(M.Z,{split:(0,i.jsx)(c.Z,{type:"vertical"}),children:[(0,i.jsx)(r.Z,{title:(tn=s.data.info)===null||tn===void 0?void 0:tn.Id.substring(0,12)}),(0,i.jsx)(I.Z.Text,{copyable:!0,editable:{tooltip:"\u4FEE\u6539\u5BB9\u5668\u540D\u79F0",onChange:function(){var A=_()(o()().mark(function Z(Y){var en,gn;return o()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if((en=s.data.info)!==null&&en!==void 0&&en.Id){k.next=2;break}return k.abrupt("return");case 2:return k.next=4,(0,d.eE)({md5:s.data.info.Id,name:Y});case 4:gn=k.sent,Q(Y),Cn.success(Pn("notification.finish"));case 7:case"end":return k.stop()}},Z)}));function W(Z){return A.apply(this,arguments)}return W}()},children:(0,f.fi)(nn,"/")})]})}),(0,i.jsx)(C.Z.Item,{label:(0,i.jsx)(h.Z,{title:"\u7F51\u7EDC",help:"\u9ED8\u8BA4\u7F51\u7EDC\u53EA\u652F\u6301\u901A\u8FC7ip\u8BBF\u95EE,ip\u4F1A\u968F\u7740\u5BB9\u5668\u542F\u52A8\u505C\u6B62\u6539\u53D8.\u5982\u679C\u9700\u8981\u5728\u5BB9\u5668\u5185\u4E92\u8054,\u8BF7\u901A\u8FC7\u3010\u7F16\u8F91\u7AD9\u70B9\u3011-\u3010\u6DFB\u52A0\u5173\u8054\u3011"}),children:((dn=s.data.info)===null||dn===void 0?void 0:dn.State.Running)&&(0,i.jsxs)(C.Z,{column:1,bordered:!0,children:[s.data.info.NetworkSettings.Networks&&Object.keys(s.data.info.NetworkSettings.Networks).map(function(A,W){var Z,Y,en;return(0,i.jsx)(C.Z.Item,{label:A,children:A=="host"?" Host \u7F51\u7EDC\uFF0C\u4E0E\u5BBF\u4E3B\u673A\u5171\u7528\u540C\u4E00\u7F51\u7EDC":(0,i.jsxs)(M.Z,{direction:"vertical",children:[(0,i.jsx)(r.Z,{title:(Z=s.data.info)===null||Z===void 0?void 0:Z.NetworkSettings.Networks[A].IPAddress}),(Y=s.data.info)===null||Y===void 0?void 0:Y.NetworkSettings.Networks[A].Gateway,(en=s.data.info)===null||en===void 0?void 0:en.NetworkSettings.Networks[A].MacAddress]})},"1")}),s.data.info.HostConfig.ExtraHosts&&(0,i.jsx)(C.Z.Item,{label:"\u5BBF\u4E3B\u673A\u7F51\u7EDC",children:(0,i.jsx)(M.Z,{direction:"vertical",children:s.data.info.HostConfig.ExtraHosts.map(function(A){if(A.indexOf(":")>-1){var W=A.split(":");return(0,i.jsxs)(M.Z,{children:[(0,i.jsx)(r.Z,{title:W[0]})," - ",W[1]]})}})})},"1")]})}),(0,i.jsxs)(C.Z.Item,{label:"\u8FD0\u884C\u65F6\u95F4",children:["\u521B\u5EFA\u4E8E: ",new Date((G=(an=s.data.info)===null||an===void 0?void 0:an.Created)!==null&&G!==void 0?G:"").toLocaleString()," / \u66F4\u65B0\u4E8E: ",new Date((vn=(cn=s.data.info)===null||cn===void 0?void 0:cn.State.StartedAt)!==null&&vn!==void 0?vn:"").toLocaleString()]}),mn.canSeeContainerListManage&&(0,i.jsx)(C.Z.Item,{label:"\u91CD\u542F\u7B56\u7565",children:(0,i.jsx)(v.A,{name:"container-restart",submitter:!1,onValuesChange:function(){var A=_()(o()().mark(function W(Z){var Y,en;return o()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if((Y=s.data.info)!==null&&Y!==void 0&&Y.Id){X.next=2;break}return X.abrupt("return");case 2:return X.next=4,(0,d.eE)({md5:s.data.info.Id,restart:Z.restart});case 4:return en=X.sent,Cn.success("\u4FEE\u6539\u91CD\u542F\u7B56\u7565\u6210\u529F"),X.abrupt("return");case 7:case"end":return X.stop()}},W)}));return function(W){return A.apply(this,arguments)}}(),layout:"inline",formRef:P,children:(0,i.jsx)(t.Z,{defaultValue:(z=s.data.info)===null||z===void 0?void 0:z.HostConfig.RestartPolicy.Name})})}),(0,i.jsx)(C.Z.Item,{label:"\u73AF\u5883\u53D8\u91CF",children:(0,i.jsx)(a.Z,{dataSource:(hn=(e=s.data.info)===null||e===void 0?void 0:e.Config.Env)!==null&&hn!==void 0?hn:[],renderItem:function(W){var Z=W.split("=");return(0,i.jsxs)(a.Z.Item,{children:[(0,i.jsx)(I.Z.Text,{code:!0,children:Z[0]})," = ",(0,i.jsx)(I.Z.Text,{copyable:!0,children:Z.slice(1).join("=")})]})}})})]})})]})}},57716:function(on,$,n){n.d($,{Z:function(){return S}});var U=n(5574),o=n.n(U),O=n(15009),_=n.n(O),E=n(99289),L=n.n(E),u=n(67294),x=n(184),v=n(38345),C=n(64317),M=n(5966),c=n(62370),I=n(97462),a=n(42075),m=n(89035),r=n(82346),h=n(28036),t=n(85893);function d(i){var rn=(0,u.useState)({height:800,width:1024}),s=o()(rn,2),K=s[0],tn=s[1],dn=function(){var vn=window.innerWidth,cn=window.innerHeight;tn({height:cn,width:vn})};(0,u.useEffect)(function(){window.addEventListener("resize",function(){dn()}),dn()},[i]);var G=i.query?Object.keys(i.query).map(function(an){if(i.query)return"".concat(an,"=").concat(i.query[an])}):[];return(0,t.jsx)(r.Link,{target:"_blank",onClick:i.onOpen,to:"/console/"+i.container+"?width=".concat(K.width,"&height=").concat(K.height,"&").concat(G.join("&")),children:(0,t.jsx)(h.ZP,{type:"primary",icon:(0,t.jsx)(m.Z,{}),children:i.content})})}var F=n(60335),R=n(5251),f=n(49610),D=(0,u.forwardRef)(function(i,rn){(0,u.useImperativeHandle)(rn,function(){return{show:function(q,b){return L()(_()().mark(function nn(){var Q,mn,w;return _()().wrap(function(En){for(;;)switch(En.prev=En.next){case 0:return En.next=2,(0,F.jV)({md5:q});case 2:w=En.sent,b&&b!=""&&(w.data.info.Config.WorkingDir=b),hn(w.data.info),an(!0),(Q=s.current)===null||Q===void 0||Q.resetFields(),(mn=s.current)===null||mn===void 0||mn.setFieldsValue({workDir:w.data.info.Config.WorkingDir});case 8:case"end":return En.stop()}},nn)}))()}}});var s=(0,u.useRef)(),K=(0,u.useRef)(),tn=(0,u.useState)(!1),dn=o()(tn,2),G=dn[0],an=dn[1],vn=(0,u.useState)(),cn=o()(vn,2),z=cn[0],hn=cn[1];return(0,u.useEffect)(function(){return z&&setTimeout(function(){var e;(e=K.current)===null||e===void 0||e.start(z.Id,{width:"800",height:"".concat(window.innerHeight),cmd:"/bin/sh",workDir:z.Config.WorkingDir})},1e3),function(){var e;(e=K.current)===null||e===void 0||e.close()}},[z,G]),(0,t.jsxs)(x.a,{drawerProps:{forceRender:!0},onFinish:function(){var e=L()(_()().mark(function q(b){var nn,Q;return _()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(z){w.next=2;break}return w.abrupt("return",!1);case 2:return(nn=K.current)===null||nn===void 0||nn.close(),(Q=K.current)===null||Q===void 0||Q.start(z.Id,{width:"800",height:"".concat(window.innerHeight),cmd:b.entryCmd,workDir:b.workDir}),w.abrupt("return",!1);case 5:case"end":return w.stop()}},q)}));return function(q){return e.apply(this,arguments)}}(),onValuesChange:function(q,b){if(b.entryCmd){var nn;(nn=s.current)===null||nn===void 0||nn.submit()}},isKeyPressSubmit:!0,open:G,formRef:s,onOpenChange:function(q){if(an(q),q){var b;(b=K.current)===null||b===void 0||b.fit()}},submitter:!1,title:(0,R.fi)(z?z.Name:"","/")+" \u63A7\u5236\u53F0",children:[(0,t.jsx)(v.Z,{ghost:!0,children:(0,t.jsxs)(a.Z.Compact,{children:[(0,t.jsx)(C.Z,{label:"shell",width:"sm",name:"entryCmd",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,t.jsx)(M.Z,{width:"sm",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",disabled:!0}),(0,t.jsx)(c.Z,{label:" ",children:(0,t.jsx)(I.Z,{name:["entryCmd","workDir"],children:function(q){var b=q.entryCmd;return(!b||b=="")&&(b="/bin/sh"),z&&(0,t.jsx)(d,{container:z.Id,query:{cmd:encodeURIComponent(b),workDir:encodeURIComponent(z.Config.WorkingDir)},onOpen:function(){var Q;(Q=K.current)===null||Q===void 0||Q.close(),an(!1)},content:"\u65B0\u7A97\u53E3\u6253\u5F00"})}})})]})}),G&&(0,t.jsx)(f.Z,{showInDrawer:!0,ref:K})]})}),S=D},14245:function(on,$,n){n.d($,{Z:function(){return L}});var U=n(60433),o=n(38345),O=n(26412),_=n(25593),E=n(85893);function L(u){return(0,E.jsx)(o.Z,{ghost:u.ghost,title:(0,E.jsx)(U.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",children:(0,E.jsxs)(O.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,E.jsx)(O.Z.Item,{label:"Image Tag",children:(0,E.jsx)(_.Z.Text,{copyable:!0,children:u.data.Config.Image})}),(0,E.jsx)(O.Z.Item,{label:"Image",children:u.data.Image}),(0,E.jsx)(O.Z.Item,{label:"CMD",children:u.data.Config.Cmd&&u.data.Config.Cmd.join(" ")}),(0,E.jsx)(O.Z.Item,{label:"ENTRYPOINT",children:u.data.Config.Entrypoint}),(0,E.jsx)(O.Z.Item,{label:"Labels",children:(0,E.jsx)(O.Z,{column:1,bordered:!0,children:u.data&&Object.keys(u.data.Config.Labels).map(function(x){return(0,E.jsx)(O.Z.Item,{label:x,children:u.data.Config.Labels[x]},x)})})})]})})}},72409:function(on,$,n){n.d($,{Z:function(){return Pn}});var U=n(15009),o=n.n(U),O=n(99289),_=n.n(O),E=n(5574),L=n.n(E),u=n(67294),x=n(80821),v=n(62597),C=n(60335),M=n(43425),c=n(58638),I=n(60219),a=n(86548),m=n(57132),r=n(87784),h=n(25035),t=n(38345),d=n(97269),F=n(62370),R=n(5966),f=n(52688),D=n(82346),S=n(42075),i=n(65233),rn=n(96074),s=n(28036),K=n(25593),tn=n(85418),dn=n(40411),G=n(84567),an=n(83062),vn=n(93162),cn=n(24739),z=n(97462),hn=n(70146),e=n(85893);function q(P){var ln=(0,u.useRef)(),Dn=(0,D.useAccess)();return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(x.Z,{icon:(0,e.jsx)(I.Z,{}),action:_()(o()().mark(function sn(){var un,H,J,_n;return o()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,(0,hn.yB)({id:P.container.Name,enableImage:(un=ln.current)===null||un===void 0?void 0:un.getFieldValue("enableImage"),volume:Object.keys((H=(J=ln.current)===null||J===void 0?void 0:J.getFieldValue("volume"))!==null&&H!==void 0?H:{}).filter(function(Z){return Z}),enableCommitImage:(_n=ln.current)===null||_n===void 0?void 0:_n.getFieldValue("enableCommitImage")});case 2:case"end":return W.stop()}},sn)})),confirmOnOpenChange:function(un){var H,J;!((H=ln.current)===null||H===void 0)&&H.resetFields&&((J=ln.current)===null||J===void 0||J.resetFields())},confirm:(0,e.jsxs)(S.Z,{style:{width:650,marginTop:"10px",paddingRight:"10px"},direction:"vertical",size:20,children:[(0,e.jsx)(K.Z.Text,{children:(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:"\u5FEB\u7167\u529F\u80FD\u4F1A\u5C06\u3010\u5FEB\u7167\u6570\u636E\u3011\u4FDD\u5B58\u81F3 /dpanel/backup \u76EE\u5F55\u3002"}),(0,e.jsx)("li",{children:"\u5FEB\u7167\u540C\u65F6\u5907\u4EFD\u5BB9\u5668\u955C\u50CF\u5728\u6062\u590D\u540E\u65E0\u6CD5\u68C0\u6D4B\u66F4\u65B0\uFF0C\u5426\u5219\u6062\u590D\u65F6\u4F1A\u5148\u5C1D\u8BD5\u62C9\u53D6\u955C\u50CF"}),(0,e.jsx)("li",{children:"\u6062\u590D\u5FEB\u7167\u65F6\uFF0C\u5982\u679C\u76EE\u6807\u5BB9\u5668\u5DF2\u5B58\u5728\u5219\u53EA\u6062\u590D\u5BB9\u5668\u6570\u636E\u3002"}),(0,e.jsxs)("li",{children:["\u8BE5\u64CD\u4F5C\u53EF\u80FD\u4F1A\u6D88\u8017\u8F83\u957F\u65F6\u95F4\uFF0C\u8BF7\u5728 ",(0,e.jsx)(D.Link,{to:"/app/backup",children:"\u5BB9\u5668\u5FEB\u7167"})," \u67E5\u770B\u5FEB\u7167\u7ED3\u679C\u3002"]})]})}),(0,e.jsxs)(d.A,{layout:"horizontal",formRef:ln,submitter:!1,children:[(0,e.jsxs)(cn.UW,{children:[(0,e.jsx)(F.Z,{valuePropName:"checked",name:"enableSelectVolume",children:(0,e.jsx)(G.Z,{disabled:!P.container.Mounts||P.container.Mounts.length==0,children:"\u9009\u62E9\u5907\u4EFD\u76EE\u5F55\uFF1F"})}),(0,e.jsx)(F.Z,{valuePropName:"checked",name:"enableImage",children:(0,e.jsx)(G.Z,{children:"\u5907\u4EFD\u5BB9\u5668\u955C\u50CF\uFF1F"})}),(0,e.jsx)(z.Z,{name:["enableImage"],children:function(un){var H=un.enableImage;if(H)return(0,e.jsx)(F.Z,{valuePropName:"checked",name:"enableCommitImage",children:(0,e.jsx)(G.Z,{children:"\u4FDD\u5B58\u5F53\u524D\u5BB9\u5668\u4E3A\u65B0\u955C\u50CF (docker commit)\uFF1F"})})}})]}),(0,e.jsx)(z.Z,{name:["enableSelectVolume"],children:function(un){var H=un.enableSelectVolume;return H&&(0,e.jsx)(S.Z,{wrap:!0,children:P.container.Mounts.map(function(J,_n){return(0,e.jsx)(F.Z,{valuePropName:"checked",name:["volume",J.Destination],children:(0,e.jsx)(G.Z,{children:J.Destination})},"volume-".concat(_n))})})}})]})]}),children:"\u5BB9\u5668\u5FEB\u7167"})})}var b=n(24963),nn=n(99861),Q=n(3393),mn=n(50888),w=n(16596),Cn=n(1699),En=n(5251),In=(0,u.forwardRef)(function(P,ln){var Dn;(0,u.useImperativeHandle)(ln,function(){return{}});var sn=(0,u.useRef)(),un=(0,u.useRef)(),H=(0,u.useRef)(),J=(0,u.useContext)(b.Z),_n=J.message,A=J.notice,W=J.loading,Z=J.lang,Y=(0,u.useRef)(),en=(0,u.useRef)(),gn=(0,u.useState)(0),X=L()(gn,2),k=X[0],fn=X[1],On=function(){var N=_()(o()().mark(function g(l){var B,j,T;return o()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(j=-2,!l.ignore){y.next=6;break}if(!(l.ignore.indexOf("".concat(l.info.Name,"@*"))>-1)){y.next=4;break}return y.abrupt("return",-2);case 4:if(!(l.ignore.indexOf("".concat(l.info.Name,"@").concat(l.info.Image))>-1)){y.next=6;break}return y.abrupt("return",-2);case 6:return y.next=8,(0,Q.ZQ)({tag:(B=l.info.Config.Image)!==null&&B!==void 0?B:"",md5:l.info.Image,cacheTime:3600}).catch(function(p){j=-1});case 8:return T=y.sent,T&&(T.data.digestLocal&&T.data.digestLocal.length>0?j=T.data.upgrade?1:2:j=-2),y.abrupt("return",j);case 11:case"end":return y.stop()}},g)}));return function(l){return N.apply(this,arguments)}}();return(0,u.useEffect)(function(){P.checkContainerUpgrade&&(fn(0),On(P.data).then(function(N){fn(N)}))},[P.data]),(0,e.jsx)(t.Z,{ghost:P.ghost,title:(0,e.jsx)(M.Z,{}),subTitle:"\u5BB9\u5668\u7BA1\u7406",children:(0,e.jsxs)(S.Z,{wrap:!0,children:[(0,e.jsx)(x.Z,{icon:(0,e.jsx)(c.Z,{}),action:function(){var g,l;return(0,C.LJ)({md5:(g=(l=P.data)===null||l===void 0?void 0:l.info.Id)!==null&&g!==void 0?g:""})},confirm:"\u5BFC\u51FA\u5BB9\u5668\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u4E0D\u5305\u542B\u6302\u8F7D\u76EE\u5F55\u7684\u6570\u636E\uFF0C\u786E\u5B9A\u5417\uFF1F",onSuccess:function(g){var l,B=new Blob([g],{type:"application/tar"});(0,vn.saveAs)(B,(0,En.fi)((l=P.data)===null||l===void 0?void 0:l.info.Name,"/")+".tar")},children:"\u5BFC\u51FA\u5BB9\u5668"}),(0,e.jsx)(x.Z,{icon:(0,e.jsx)(I.Z,{}),action:_()(o()().mark(function N(){var g,l,B,j,T;return o()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,(0,C.Re)({md5:(g=(l=P.data)===null||l===void 0?void 0:l.info.Id)!==null&&g!==void 0?g:"",name:(B=(j=un.current)===null||j===void 0?void 0:j.getFieldValue("saveImageName"))!==null&&B!==void 0?B:(T=P.data)===null||T===void 0?void 0:T.info.Name});case 2:case"end":return y.stop()}},N)})),confirmTitle:"\u5C06\u5F53\u524D\u5BB9\u5668\u4FDD\u5B58\u4E3A\u955C\u50CF",confirm:(0,e.jsx)(S.Z,{style:{width:400,marginTop:"10px",paddingRight:"10px"},direction:"vertical",children:(0,e.jsx)(d.A,{formRef:un,submitter:!1,children:(0,e.jsx)(F.Z,{name:"saveImageName",children:(0,e.jsx)(i.Z,{addonBefore:"\u955C\u50CF\u540D\u79F0"})})})}),children:"\u53E6\u5B58\u4E3A\u955C\u50CF"}),P.data&&(0,e.jsx)(Cn.u,{access:"canSeeContainerBackup",children:(0,e.jsx)(q,{container:P.data.info})}),(0,e.jsx)(rn.Z,{type:"vertical"}),(0,e.jsx)(D.Link,{to:"/app/create/image?id=".concat((Dn=P.data)===null||Dn===void 0?void 0:Dn.info.Id,"&op=update"),children:(0,e.jsx)(s.ZP,{type:"primary",icon:(0,e.jsx)(a.Z,{}),children:"\u7F16\u8F91\u5BB9\u5668"})}),(0,e.jsx)(x.Z,{icon:(0,e.jsx)(m.Z,{}),action:_()(o()().mark(function N(){var g,l,B,j,T,V;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,C.aF)({md5:(g=(l=P.data)===null||l===void 0?void 0:l.info.Id)!==null&&g!==void 0?g:"",copyName:(B=(j=H.current)===null||j===void 0?void 0:j.getFieldValue("copyName"))!==null&&B!==void 0?B:"",enableRandomPort:(T=(V=H.current)===null||V===void 0?void 0:V.getFieldValue("enableRandomPort"))!==null&&T!==void 0?T:!1});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},N)})),confirm:(0,e.jsxs)(S.Z,{style:{width:400,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(K.Z.Text,{children:"\u9ED8\u8BA4\u60C5\u51B5\u4E0B, \u590D\u5236\u7684\u76EE\u6807\u5BB9\u5668\u4E0E\u5F53\u524D\u5BB9\u5668\u5177\u6709\u76F8\u540C\u7684\u914D\u7F6E\u65E0\u6CD5\u542F\u52A8\u3002 \u5982\u679C\u4F60\u5E0C\u671B\u76EE\u6807\u5BB9\u5668\u6B63\u5E38\u8FD0\u884C\uFF0C\u8BF7\u5F00\u542F\u3010\u7ED1\u5B9A\u968F\u673A\u7AEF\u53E3\u3011"}),(0,e.jsxs)(d.A,{formRef:H,submitter:!1,layout:"horizontal",children:[(0,e.jsx)("br",{}),(0,e.jsx)(R.Z,{label:"\u590D\u5236\u5BB9\u5668\u540D\u79F0",name:"copyName"}),(0,e.jsx)(f.Z,{label:"\u7ED1\u5B9A\u968F\u673A\u7AEF\u53E3",name:"enableRandomPort"})]})]}),onSuccess:function(g){var l;(l=H.current)===null||l===void 0||l.resetFields()},children:"\u590D\u5236\u5BB9\u5668"}),P.data&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(nn.Z,{image:[P.data.info.Config.Image],ref:Y}),(0,e.jsx)(tn.Z,{placement:"bottomLeft",menu:{items:[{key:"1",label:(0,e.jsx)(x.Z,{action:_()(o()().mark(function N(){var g,l,B,j,T,V;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,v.ze)({md5:(g=(l=P.data.info)===null||l===void 0?void 0:l.Name)!==null&&g!==void 0?g:"",imageId:""});case 2:return fn(0),p.next=5,(0,Q.ZQ)({tag:(B=(j=P.data.info)===null||j===void 0?void 0:j.Config.Image)!==null&&B!==void 0?B:"",md5:(T=(V=P.data.info)===null||V===void 0?void 0:V.Image)!==null&&T!==void 0?T:"",cacheTime:0}).then(function(jn){jn.data.digestLocal&&jn.data.digestLocal.length>0?fn(jn.data.upgrade?1:2):fn(-2)}).catch(function(jn){fn(-1)});case 5:return p.abrupt("return",p.sent);case 6:case"end":return p.stop()}},N)})),type:"link",children:"\u81EA\u52A8\u68C0\u6D4B"})},{key:"2",label:(0,e.jsx)(x.Z,{action:_()(o()().mark(function N(){var g,l,B,j;return o()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,(0,v.ze)({md5:(g=(l=P.data.info)===null||l===void 0?void 0:l.Name)!==null&&g!==void 0?g:"",imageId:(B=(j=P.data.info)===null||j===void 0?void 0:j.Image)!==null&&B!==void 0?B:""});case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},N)})),type:"link",children:"\u5FFD\u7565\u672C\u6B21"})},{key:"3",label:(0,e.jsx)(x.Z,{action:_()(o()().mark(function N(){var g,l;return o()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,v.ze)({md5:(g=(l=P.data.info)===null||l===void 0?void 0:l.Name)!==null&&g!==void 0?g:"",imageId:"*"});case 2:return j.abrupt("return",j.sent);case 3:case"end":return j.stop()}},N)})),type:"link",children:"\u6C38\u4E45\u5FFD\u7565"})}]},children:(0,e.jsx)(dn.Z,{count:Z("app.detail.checkImageUpgrade."+k),color:Z("app.detail.checkImageUpgradeColor."+k),children:(0,e.jsx)(x.Z,{disabled:k===0,icon:k===0?(0,e.jsx)(mn.Z,{}):(0,e.jsx)(w.Z,{}),action:_()(o()().mark(function N(){var g,l,B,j,T;return o()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,(g=Y.current)===null||g===void 0?void 0:g.start();case 2:return W.show(),(l=Y.current)===null||l===void 0||l.finish(),y.next=6,(0,C.RF)({md5:(B=P.data.info.Id)!==null&&B!==void 0?B:"",imageTag:"",enableBak:(j=(T=en.current)===null||T===void 0?void 0:T.getFieldValue("enableBak"))!==null&&j!==void 0?j:!1});case 6:return y.abrupt("return",y.sent);case 7:case"end":return y.stop()}},N)})),confirm:(0,e.jsxs)(S.Z,{style:{width:280,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(K.Z.Text,{children:Z("app.detail.upgradeConfirm")}),(0,e.jsx)(d.A,{formRef:en,submitter:!1,layout:"inline",children:(0,e.jsx)(F.Z,{name:"enableBak",valuePropName:"checked",children:(0,e.jsx)(G.Z,{children:"\u5907\u4EFD\u65E7\u5BB9\u5668\uFF1F"})})})]}),onSuccess:function(g){W.destroy(),P.checkContainerUpgrade&&P.checkContainerUpgrade()},children:"\u5FEB\u901F\u5347\u7EA7\u5BB9\u5668"})})})]}),(0,e.jsx)(rn.Z,{type:"vertical"}),P.data&&(0,e.jsx)(x.Z,{action:function(){var g,l,B,j,T,V;return(0,v.Ct)({md5:(g=(l=P.data)===null||l===void 0?void 0:l.info.Id)!==null&&g!==void 0?g:"",deleteImage:(B=(j=sn.current)===null||j===void 0?void 0:j.getFieldValue("deleteImage"))!==null&&B!==void 0?B:!1,deleteVolume:(T=(V=sn.current)===null||V===void 0?void 0:V.getFieldValue("deleteVolume"))!==null&&T!==void 0?T:!1})},danger:!0,type:"primary",icon:(0,e.jsx)(r.Z,{}),onSuccess:function(){W.destroy(),P.checkContainerUpgrade&&P.checkContainerUpgrade()},confirm:(0,e.jsxs)(S.Z,{style:{width:200},direction:"vertical",children:[(0,e.jsx)(K.Z.Text,{children:Z("notification.confirm.title")}),(0,e.jsxs)(d.A,{formRef:sn,layout:"inline",submitter:!1,children:[(0,e.jsx)(F.Z,{addonAfter:(0,e.jsx)(an.Z,{title:"\u672A\u6302\u8F7D\u955C\u50CF\u5185\u58F0\u660E\u7684\u76EE\u5F55\u5E76\u7531 docker \u81EA\u52A8\u521B\u5EFA\u7684\u5B58\u50A8\u5377",children:(0,e.jsx)(h.Z,{})}),name:"deleteVolume",valuePropName:"checked",children:(0,e.jsx)(G.Z,{children:"\u5220\u9664\u533F\u540D\u5B58\u50A8\u5377\uFF1F"})}),(0,e.jsx)(F.Z,{name:"deleteImage",valuePropName:"checked",children:(0,e.jsx)(G.Z,{children:"\u5220\u9664\u955C\u50CF\uFF1F"})})]})]}),children:"\u5220\u9664"})]})})}),Pn=In},14189:function(on,$,n){var U=n(43425),o=n(74842),O=n(87784),_=n(33160),E=n(30159),L=n(89035),u=n(38345),x=n(42075),v=n(96074),C=n(28036),M=n(67294),c=n(94359),I=n(80821),a=n(60335),m=n(57716),r=n(85893),h=(0,M.forwardRef)(function(t,d){(0,M.useImperativeHandle)(d,function(){return{}});var F=(0,M.useRef)();return(0,r.jsx)(u.Z,{title:(0,r.jsx)(U.Z,{}),ghost:t.ghost,subTitle:(0,r.jsxs)(x.Z,{children:["\u72B6\u6001\u7BA1\u7406 - ",t.data&&(0,r.jsx)(c.Z,{status:t.data.State.Status,message:{content:t.data.State.Status,placement:"top"}})]}),children:(0,r.jsxs)(x.Z,{wrap:!0,children:[(0,r.jsx)(I.Z,{icon:(0,r.jsx)(o.Z,{}),action:function(){var f,D;return(0,a.IW)({md5:(f=(D=t.data)===null||D===void 0?void 0:D.Id)!==null&&f!==void 0?f:"",operate:"start"})},onSuccess:function(){return t.onFinish&&t.onFinish()},disabled:t.data&&t.data.State.Running||t.data&&t.data.State.Paused,children:"\u542F\u52A8"}),(0,r.jsx)(I.Z,{action:function(){var f,D;return(0,a.IW)({md5:(f=(D=t.data)===null||D===void 0?void 0:D.Id)!==null&&f!==void 0?f:"",operate:"stop"})},icon:(0,r.jsx)(O.Z,{}),onSuccess:function(){return t.onFinish&&t.onFinish()},disabled:t.data&&t.data.State.Dead,children:"\u505C\u6B62"}),(0,r.jsx)(I.Z,{action:function(){var f,D;return(0,a.IW)({md5:(f=(D=t.data)===null||D===void 0?void 0:D.Id)!==null&&f!==void 0?f:"",operate:"restart"})},onSuccess:function(){return t.onFinish&&t.onFinish()},icon:(0,r.jsx)(_.Z,{}),children:"\u91CD\u542F"}),(0,r.jsx)(I.Z,{action:function(){var f,D;return(0,a.IW)({md5:(f=(D=t.data)===null||D===void 0?void 0:D.Id)!==null&&f!==void 0?f:"",operate:"pause"})},onSuccess:function(){return t.onFinish&&t.onFinish()},icon:(0,r.jsx)(E.Z,{}),disabled:t.data&&t.data&&!t.data.State.Running,children:"\u6682\u505C"}),(0,r.jsx)(I.Z,{action:function(){var f,D;return(0,a.IW)({md5:(f=(D=t.data)===null||D===void 0?void 0:D.Id)!==null&&f!==void 0?f:"",operate:"unpause"})},onSuccess:function(){return t.onFinish&&t.onFinish()},icon:(0,r.jsx)(o.Z,{}),disabled:t.data&&!t.data.State.Paused,children:"\u6062\u590D"}),(0,r.jsx)(v.Z,{type:"vertical"}),t.data&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{ref:F}),(0,r.jsx)(C.ZP,{type:"dashed",onClick:function(){var f;t.data&&((f=F.current)===null||f===void 0||f.show(t.data.Id))},icon:(0,r.jsx)(L.Z,{}),children:"Console"})]}),(0,r.jsx)(v.Z,{type:"vertical"}),t.extra&&t.extra.map(function(R,f){return(0,r.jsx)("span",{children:R},f)})]})})});$.Z=h},52031:function(on,$,n){n.d($,{Z:function(){return x}});var U=n(31574),o=n(95591),O=n(38345),_=n(26412),E=n(78451),L=n(82346),u=n(85893);function x(v){var C,M=(0,L.useAccess)();return v.data&&v.data.Mounts&&v.data.Mounts.length>0&&(0,u.jsx)(O.Z,{ghost:v.ghost,title:(0,u.jsx)(U.Z,{}),subTitle:"\u6302\u8F7D\u76EE\u5F55\u8BE6\u60C5",children:(0,u.jsx)(_.Z,{column:1,bordered:!0,children:(C=v.data)===null||C===void 0?void 0:C.Mounts.map(function(c,I){var a;return(0,u.jsx)(_.Z.Item,{labelStyle:{width:"30%"},label:c.Type=="volume"?(0,u.jsx)(E.Z,{content:c.Name}):c.Source,children:M.canSeeContainerListManage?(0,u.jsxs)(L.Link,{target:"_blank",to:"/app/detail/file/".concat((a=v.data)===null||a===void 0?void 0:a.Id,"?tab=file&path=").concat(encodeURIComponent(c.Destination)),children:[c.Destination," ",(0,u.jsx)(o.Z,{})]}):c.Destination},I)})})})}},49610:function(on,$,n){var U=n(67294),o=n(54964),O=n(52626),_=n(12320),E=n.n(_),L=n(78267),u=n.n(L),x=n(85893),v,C=new _.Terminal(o.a),M=new L.FitAddon,c=(0,U.forwardRef)(function(I,a){var m,r=function(){C.reset(),m&&m.dispose(),v&&(v.close(),v=null)},h=function(){C.reset(),M.fit(),C.focus(),m&&m.dispose(),m=C.onData(function(d){var F={content:{command:d},type:"console"};v&&v.send(JSON.stringify(F))})};return(0,U.useImperativeHandle)(a,function(){return{start:function(d,F){var R=F?Object.keys(F).map(function(f){if(F&&F[f])return"".concat(f,"=").concat(F[f])}):[];v=new WebSocket((0,O.R)("/console/"+d+"?"+R.join("&"))),v.addEventListener("message",function(f){var D=JSON.parse(f.data),S=D.type;if(S=="console:"+d&&(C.write(D.data),D.data.indexOf("exec failed")!=-1)){r();return}}),h()},close:function(){r()},fit:function(){M.fit()}}}),(0,U.useEffect)(function(){return C.loadAddon(M),C.open(document.getElementById("terminal-container-console")),M.fit(),function(){r()}},[]),(0,x.jsx)("div",{style:{height:I.showInDrawer?"75vh":"100vh"},id:"terminal-container-console"})});$.Z=c},94359:function(on,$,n){n.d($,{Z:function(){return I}});var U=n(3089),o=n(98165),O=n(18429),_=n(8751),E=n(14313),L=n(30159),u=n(87740),x=n(50888),v=n(66309),C=n(83062),M=n(82346),c=n(85893);function I(a){var m=(0,c.jsx)(c.Fragment,{});if(a.status=="0"&&(m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(U.Z,{}),color:"default",children:"waiting"})),a.status=="10"&&(m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(o.Z,{spin:!0}),color:"processing",children:"processing"})),a.status=="20"&&(m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(O.Z,{}),color:"error",children:"error"})),a.status=="30"&&(m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(_.Z,{}),color:"success",children:"success"})),a.status=="running"||a.status=="healthy"){var r,h;m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(E.Z,{}),color:"success",children:(r=a.message)!==null&&r!==void 0&&r.showInTag?(h=a.message)===null||h===void 0?void 0:h.content:a.status})}if(a.status=="paused"){var t,d;m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(L.Z,{}),children:(t=a.message)!==null&&t!==void 0&&t.showInTag?(d=a.message)===null||d===void 0?void 0:d.content:a.status})}if(a.status=="waiting"||a.status=="starting"){var F,R;m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(u.Z,{}),children:(F=a.message)!==null&&F!==void 0&&F.showInTag?(R=a.message)===null||R===void 0?void 0:R.content:a.status})}if(a.status=="deploying"){var f,D;m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(x.Z,{}),color:"processing",children:(f=a.message)!==null&&f!==void 0&&f.showInTag?(D=a.message)===null||D===void 0?void 0:D.content:a.status})}if(a.status=="error"){var S,i;m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(O.Z,{}),color:"error",children:(S=a.message)!==null&&S!==void 0&&S.showInTag?(i=a.message)===null||i===void 0?void 0:i.content:a.status})}if(a.status=="exited"||a.status=="dead"||a.status=="removing"||a.status=="restarting"||a.status=="unhealthy"||a.status=="created"){var rn,s;m=(0,c.jsx)(v.Z,{icon:(0,c.jsx)(O.Z,{}),color:"warning",children:(rn=a.message)!==null&&rn!==void 0&&rn.showInTag?(s=a.message)===null||s===void 0?void 0:s.content:a.status})}if(a.link)return(0,c.jsx)(M.Link,{to:a.link,children:m});if(a.message){var K,tn;return(0,c.jsx)(C.Z,{placement:(K=a.message.placement)!==null&&K!==void 0?K:"top",title:(tn=a.message.title)!==null&&tn!==void 0?tn:a.message.content,children:m})}return m}},76428:function(on,$,n){n.d($,{Z:function(){return _}});var U=n(25593),o=n(67294),O=n(85893);function _(E){return(0,O.jsx)(U.Z.Text,{copyable:!0,children:E.title})}},78498:function(on,$,n){n.d($,{Z:function(){return L}});var U=n(25035),o=n(42075),O=n(83062),_=n(67294),E=n(85893);function L(u){return(0,E.jsxs)(o.Z,{children:[u.title,(0,E.jsx)(O.Z,{title:u.help,children:(0,E.jsx)(U.Z,{})})]})}},54964:function(on,$,n){n.d($,{a:function(){return c}});var U=n(5574),o=n.n(U),O=n(78267),_=n.n(O),E=n(75458),L=n.n(E),u=n(67294),x=n(12320),v=n.n(x),C=n(89629),M=n(85893),c={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},I=new x.Terminal(c),a=new E.SearchAddon,m=new O.FitAddon,r=(0,u.forwardRef)(function(h,t){var d,F=(0,u.useState)(!0),R=o()(F,2),f=R[0],D=R[1];return(0,u.useEffect)(function(){return window.addEventListener("resize",function(){h.showInModal||m.fit()}),h.style&&h.style.fontSize&&(I.options.fontSize=h.style.fontSize),I.loadAddon(m),I.loadAddon(a),I.open(document.getElementById(h.id?h.id:"terminal-container")),h.showInModal||m.fit(),function(){I.reset(),D(!0)}},[]),(0,u.useImperativeHandle)(t,function(){return{write:function(i){f&&(m.fit(),D(!1)),I.write(i)},clear:function(){I.clear()},getTerminal:function(){return I},findNext:function(i){a.findNext(i)},findPrev:function(i){a.findPrevious(i)},fit:function(){m.fit()},onData:function(i){return I.onData(i)}}}),(0,M.jsx)("div",{id:h.id?h.id:"terminal-container",style:{width:h.width?h.width:"100%",height:h.height?h.height:"500px",marginTop:(d=h.style)===null||d===void 0?void 0:d.marginTop}})});$.Z=r},70146:function(on,$,n){n.d($,{SR:function(){return c},VE:function(){return C},Zy:function(){return x},iD:function(){return a},yB:function(){return L}});var U=n(15009),o=n.n(U),O=n(99289),_=n.n(O),E=n(82346);function L(r){return u.apply(this,arguments)}function u(){return u=_()(o()().mark(function r(h){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,E.request)("/api/app/container-backup/create",{data:h,method:"POST"});case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},r)})),u.apply(this,arguments)}function x(r){return v.apply(this,arguments)}function v(){return v=_()(o()().mark(function r(h){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,E.request)("/api/app/container-backup/get-list",{method:"POST",data:h}));case 1:case"end":return d.stop()}},r)})),v.apply(this,arguments)}function C(r){return M.apply(this,arguments)}function M(){return M=_()(o()().mark(function r(h){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,E.request)("/api/app/container-backup/delete",{method:"POST",data:h}));case 1:case"end":return d.stop()}},r)})),M.apply(this,arguments)}function c(r){return I.apply(this,arguments)}function I(){return I=_()(o()().mark(function r(h){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,E.request)("/api/app/container-backup/restore",{method:"POST",data:h}));case 1:case"end":return d.stop()}},r)})),I.apply(this,arguments)}function a(r){return m.apply(this,arguments)}function m(){return m=_()(o()().mark(function r(h){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,E.request)("/api/app/container-backup/get-detail",{method:"POST",data:h}));case 1:case"end":return d.stop()}},r)})),m.apply(this,arguments)}}}]);
