"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7523],{86615:function(re,w,e){var D=e(1413),n=e(45987),U=e(22270),m=e(78045),p=e(67294),O=e(90789),F=e(73552),r=e(85893),M=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],b=p.forwardRef(function(l,o){var E=l.fieldProps,t=l.options,s=l.radioType,B=l.layout,d=l.proFieldProps,k=l.valueEnum,x=(0,n.Z)(l,M);return(0,r.jsx)(F.Z,(0,D.Z)((0,D.Z)({valueType:s==="button"?"radioButton":"radio",ref:o,valueEnum:(0,U.h)(k,void 0)},x),{},{fieldProps:(0,D.Z)({options:t,layout:B},E),proFieldProps:d,filedConfig:{customLightMode:!0}}))}),P=p.forwardRef(function(l,o){var E=l.fieldProps,t=l.children;return(0,r.jsx)(m.ZP,(0,D.Z)((0,D.Z)({},E),{},{ref:o,children:t}))}),c=(0,O.G)(P,{valuePropName:"checked",ignoreWidth:!0}),R=c;R.Group=b,R.Button=m.ZP.Button,R.displayName="ProFormComponent",w.Z=R},37476:function(re,w,e){e.d(w,{Y:function(){return t}});var D=e(74165),n=e(15861),U=e(1413),m=e(97685),p=e(45987),O=e(73177),F=e(28459),r=e(85576),M=e(55917),b=e(21770),P=e(80334),c=e(67294),R=e(73935),l=e(89671),o=e(85893),E=["children","trigger","onVisibleChange","onOpenChange","modalProps","onFinish","submitTimeout","title","width","visible","open"];function t(s){var B,d,k=s.children,x=s.trigger,h=s.onVisibleChange,$=s.onOpenChange,i=s.modalProps,_=s.onFinish,C=s.submitTimeout,I=s.title,u=s.width,te=s.visible,le=s.open,N=(0,p.Z)(s,E);(0,P.ET)(!N.footer||!(i!=null&&i.footer),"ModalForm \u662F\u4E00\u4E2A ProForm \u7684\u7279\u6B8A\u5E03\u5C40\uFF0C\u5982\u679C\u60F3\u81EA\u5B9A\u4E49\u6309\u94AE\uFF0C\u8BF7\u4F7F\u7528 submit.render \u81EA\u5B9A\u4E49\u3002");var oe=(0,c.useContext)(F.ZP.ConfigContext),he=(0,c.useState)([]),ge=(0,m.Z)(he,2),Fe=ge[1],me=(0,c.useState)(!1),pe=(0,m.Z)(me,2),de=pe[0],ae=pe[1],fe=(0,b.Z)(!!te,{value:le||te,onChange:$||h}),_e=(0,m.Z)(fe,2),se=_e[0],q=_e[1],z=(0,c.useRef)(null),L=(0,c.useCallback)(function(f){z.current===null&&f&&Fe([]),z.current=f},[]),Z=(0,c.useRef)(),K=(0,c.useCallback)(function(){var f,v,g,A=(f=(v=N.form)!==null&&v!==void 0?v:(g=N.formRef)===null||g===void 0?void 0:g.current)!==null&&f!==void 0?f:Z.current;A&&i!==null&&i!==void 0&&i.destroyOnClose&&A.resetFields()},[i==null?void 0:i.destroyOnClose,N.form,N.formRef]);(0,c.useImperativeHandle)(N.formRef,function(){return Z.current},[Z.current]),(0,c.useEffect)(function(){(le||te)&&($==null||$(!0),h==null||h(!0))},[te,le]);var j=(0,c.useMemo)(function(){return x?c.cloneElement(x,(0,U.Z)((0,U.Z)({key:"trigger"},x.props),{},{onClick:function(){var f=(0,n.Z)((0,D.Z)().mark(function g(A){var T,y;return(0,D.Z)().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:q(!se),(T=x.props)===null||T===void 0||(y=T.onClick)===null||y===void 0||y.call(T,A);case 2:case"end":return W.stop()}},g)}));function v(g){return f.apply(this,arguments)}return v}()})):null},[q,x,se]),X=(0,c.useMemo)(function(){var f,v,g,A,T,y;return N.submitter===!1?!1:(0,M.Z)({searchConfig:{submitText:(f=(v=i==null?void 0:i.okText)!==null&&v!==void 0?v:(g=oe.locale)===null||g===void 0||(g=g.Modal)===null||g===void 0?void 0:g.okText)!==null&&f!==void 0?f:"\u786E\u8BA4",resetText:(A=(T=i==null?void 0:i.cancelText)!==null&&T!==void 0?T:(y=oe.locale)===null||y===void 0||(y=y.Modal)===null||y===void 0?void 0:y.cancelText)!==null&&A!==void 0?A:"\u53D6\u6D88"},resetButtonProps:{preventDefault:!0,disabled:C?de:void 0,onClick:function(W){var S;q(!1),i==null||(S=i.onCancel)===null||S===void 0||S.call(i,W)}}},N.submitter)},[(B=oe.locale)===null||B===void 0||(B=B.Modal)===null||B===void 0?void 0:B.cancelText,(d=oe.locale)===null||d===void 0||(d=d.Modal)===null||d===void 0?void 0:d.okText,i,N.submitter,q,de,C]),H=(0,c.useCallback)(function(f,v){return(0,o.jsxs)(o.Fragment,{children:[f,z.current&&v?(0,o.jsx)(c.Fragment,{children:(0,R.createPortal)(v,z.current)},"submitter"):v]})},[]),J=(0,c.useCallback)(function(){var f=(0,n.Z)((0,D.Z)().mark(function v(g){var A,T,y;return(0,D.Z)().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return A=_==null?void 0:_(g),C&&A instanceof Promise&&(ae(!0),T=setTimeout(function(){return ae(!1)},C),A.finally(function(){clearTimeout(T),ae(!1)})),W.next=4,A;case 4:return y=W.sent,y&&q(!1),W.abrupt("return",y);case 7:case"end":return W.stop()}},v)}));return function(v){return f.apply(this,arguments)}}(),[_,q,C]),Y=(0,O.X)(se);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.Z,(0,U.Z)((0,U.Z)((0,U.Z)({title:I,width:u||800},i),Y),{},{onCancel:function(v){var g;C&&de||(q(!1),i==null||(g=i.onCancel)===null||g===void 0||g.call(i,v))},afterClose:function(){var v;K(),se&&q(!1),i==null||(v=i.afterClose)===null||v===void 0||v.call(i)},footer:N.submitter!==!1?(0,o.jsx)("div",{ref:L,style:{display:"flex",justifyContent:"flex-end"}}):null,children:(0,o.jsx)(l.I,(0,U.Z)((0,U.Z)({formComponentType:"ModalForm",layout:"vertical"},N),{},{onInit:function(v,g){var A;N.formRef&&(N.formRef.current=g),N==null||(A=N.onInit)===null||A===void 0||A.call(N,v,g),Z.current=g},formRef:Z,submitter:X,onFinish:function(){var f=(0,n.Z)((0,D.Z)().mark(function v(g){var A;return(0,D.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,J(g);case 2:return A=y.sent,y.abrupt("return",A);case 4:case"end":return y.stop()}},v)}));return function(v){return f.apply(this,arguments)}}(),contentRender:H,children:k}))})),j]})}},74344:function(re,w,e){var D=e(5574),n=e.n(D),U=e(37476),m=e(38345),p=e(54006),O=e(67294),F=e(54964),r=e(85893),M=(0,O.forwardRef)(function(b,P){(0,O.useImperativeHandle)(P,function(){return{start:function(){for(var h=arguments.length,$=new Array(h),i=0;i<h;i++)$[i]=arguments[i];B($.join(":")),o(!0)},reset:function(){var h;(h=k.current)===null||h===void 0||h.clear()},show:function(h){var $,i;($=k.current)===null||$===void 0||$.clear(),(i=k.current)===null||i===void 0||i.write(h),o(!0)}}});var c=(0,O.useState)(!1),R=n()(c,2),l=R[0],o=R[1],E=(0,O.useState)(""),t=n()(E,2),s=t[0],B=t[1],d=(0,p.useModel)("subscriber"),k=(0,O.useRef)();return d.addDataHandler("image:"+s,function(x){var h;(h=k.current)===null||h===void 0||h.write(x.data)}),(0,O.useEffect)(function(){var x;(x=k.current)===null||x===void 0||x.fit()},[]),(0,r.jsx)(U.Y,{modalProps:{forceRender:!0},title:"\u6784\u5EFA\u65E5\u5FD7",submitter:!1,width:1e3,onOpenChange:function(h){if(o(h),h){var $,i;($=k.current)===null||$===void 0||$.clear(),(i=k.current)===null||i===void 0||i.fit()}},open:l,children:(0,r.jsx)(m.Z,{ghost:!0,children:(0,r.jsx)(F.Z,{showInModal:!0,width:"960px",height:"500px",ref:k})})})});w.Z=M},89063:function(re,w,e){e.d(w,{Z:function(){return r}});var D=e(24963),n=e(88484),U=e(31418),m=e(72723),p=e(14726),O=e(67294),F=e(85893);function r(M){var b=(0,O.useContext)(D.Z),P=b.message,c=b.notice,R=b.lang,l=(0,O.useRef)(null),o=U.Z.useApp(),E=function(){l.current&&(l.current.click(),l.current.onchange=function(s){if(!s||!s.target)return"";var B=new FileReader;B.onload=function(k){var x,h,$=(x=k.target)===null||x===void 0?void 0:x.result;if(M.onLoad)try{M.onLoad&&M.onLoad($)}catch(i){c.error(i);return}typeof M.onImport=="function"&&M.onImport($),(h=l.current)!==null&&h!==void 0&&h.value&&(l.current.value="")};var d=s.target;if(d.files)try{B.readAsText(d.files[0])}catch(k){c.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(m.Z.Item,{name:"importFile",label:M.label,children:(0,F.jsx)(p.ZP,{icon:(0,F.jsx)(n.Z,{}),block:!0,onClick:E,children:M.title})}),(0,F.jsx)("input",{style:{display:"none"},type:"file",ref:l,name:"importFileInput"})]})}},54964:function(re,w,e){e.d(w,{a:function(){return b}});var D=e(78267),n=e.n(D),U=e(75458),m=e.n(U),p=e(67294),O=e(12320),F=e.n(O),r=e(89629),M=e(85893),b={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},P=new O.Terminal(b),c=new U.SearchAddon,R=new D.FitAddon,l=(0,p.forwardRef)(function(o,E){return(0,p.useEffect)(function(){window.addEventListener("resize",function(){o.showInModal||R.fit()}),o.style&&o.style.fontSize&&(P.options.fontSize=o.style.fontSize),P.loadAddon(R),P.loadAddon(c),P.open(document.getElementById("terminal-container")),R.fit()},[]),(0,p.useImperativeHandle)(E,function(){return{write:function(s){P.write(s)},clear:function(){P.clear()},getTerminal:function(){return P},findNext:function(s){c.findNext(s)},findPrev:function(s){c.findPrevious(s)},fit:function(){R.fit()},onData:function(s){P.onData(s)}}}),(0,M.jsx)("div",{id:"terminal-container",style:{width:o.width?o.width:"100%",height:o.height?o.height:"500px"}})});w.Z=l},24963:function(re,w,e){var D=e(67294),n=(0,D.createContext)({});w.Z=n},90128:function(re,w,e){e.r(w),e.d(w,{default:function(){return q}});var D=e(15009),n=e.n(D),U=e(99289),m=e.n(U),p=e(5574),O=e.n(p),F=e(5966),r=e(85893);function M(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(F.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],required:!0,placeholder:"\u6307\u5B9AGit\u5730\u5740\uFF0C\u79C1\u6709\u4ED3\u5E93\u8BF7\u9644\u52A0\u6743\u9650\u3002\u4EC5\u652F\u6301Master\u5206\u652F",label:"Git\u4ED3\u5E93\u5730\u5740",name:"buildGit"})})}var b=e(97961),P=e(1413),c=e(45987),R=e(88484),l=e(31365),o=e(14726),E=e(67294),t=e(9105),s=e(90789),B=["fieldProps","action","accept","listType","title","max","icon","buttonProps","disabled","proFieldProps"],d=function(L,Z){var K,j=L.fieldProps,X=L.action,H=L.accept,J=L.listType,Y=L.title,f=Y===void 0?"\u5355\u51FB\u4E0A\u4F20":Y,v=L.max,g=L.icon,A=g===void 0?(0,r.jsx)(R.Z,{}):g,T=L.buttonProps,y=L.disabled,ee=L.proFieldProps,W=(0,c.Z)(L,B),S=(0,E.useMemo)(function(){var ue;return(ue=W.fileList)!==null&&ue!==void 0?ue:W.value},[W.fileList,W.value]),G=(0,E.useContext)(t.A),a=(ee==null?void 0:ee.mode)||G.mode||"edit",V=(v===void 0||!S||(S==null?void 0:S.length)<v)&&a!=="read",ne=(J!=null?J:j==null?void 0:j.listType)==="picture-card";return(0,r.jsx)(l.Z,(0,P.Z)((0,P.Z)({action:X,accept:H,ref:Z,listType:J||"picture",fileList:S},j),{},{name:(K=j==null?void 0:j.name)!==null&&K!==void 0?K:"file",onChange:function(ce){var ie;j==null||(ie=j.onChange)===null||ie===void 0||ie.call(j,ce)},children:V&&(ne?(0,r.jsxs)("span",{children:[A," ",f]}):(0,r.jsxs)(o.ZP,(0,P.Z)((0,P.Z)({disabled:y||(j==null?void 0:j.disabled)},T),{},{children:[A,f]})))}))},k=(0,s.G)(E.forwardRef(d),{getValueFromEvent:function(L){return L.fileList}}),x=k;function h(z){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(x,{max:1,title:z.title,label:z.label,required:!0,rules:[{required:!0}],fieldProps:{name:"file",accept:z.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(Z){return new Promise(function(K){var j;(0,b._2)({path:(j=Z.response.data.path)!==null&&j!==void 0?j:""}).then(function(X){K(!0)})})}},name:z.name})})}var $=e(74344),i=e(89063),_=e(95089),C=e(62370),I=e(184),u=e(86615),te=e(97462),le=e(34041);function N(z){var L=(0,E.useState)([]),Z=O()(L,2),K=Z[0],j=Z[1];return(0,E.useEffect)(function(){(0,b.MF)().then(function(X){var H=Object.keys(X.data).map(function(J){return X.data[J]});j(H)})},[]),(0,r.jsx)(C.Z,{children:(0,r.jsxs)(I.a,{trigger:(0,r.jsx)(o.ZP,{block:!0,children:"\u4F7F\u7528\u6A21\u677F\u751F\u6210"}),onFinish:function(H){return new Promise(function(J,Y){var f=H[H.language+"EnvVersion"].split("|"),v=O()(f,2),g=v[0],A=v[1],T="FROM ".concat(g,`
# \u5E94\u7528\u76EE\u5F55\u4F4D\u4E8E /app
# \u53EF\u901A\u7BA1\u5BB9\u5668 - \u6587\u4EF6\u7BA1\u7406, \u4E0A\u4F20\u4EE3\u7801\u81F3\u6B64\u76EE\u5F55\u5E76\u4FEE\u6539\u6743\u9650

WORKDIR /app
VOLUME [ "/app" ]
EXPOSE 80

# \u81EA\u5B9A\u4E49\u5B89\u88C5\u7EC4\u4EF6\u3001\u6269\u5C55\u6216\u662F\u5E93, \u4F8B\u5982:
# RUN apk add --no-cache --update vim
`);switch(H.language){case"php":T+=`
                
# \u7AD9\u70B9\u76EE\u5F55\u4F4D\u4E8E /app/wwwroot \u53EF\u4E0A\u4F20\u6216\u662F\u4FEE\u6539\u7AD9\u70B9\u6587\u4EF6
# nginx \u914D\u7F6E\u4F4D\u4E8E /app/nginx/ \u53EF\u4FEE\u6539\u589E\u52A0\u81EA\u5B9A\u4E49\u914D\u7F6E
# \u901A\u8FC7\u8BBF\u95EE\u5BB9\u5668\u8FD0\u884C\u6620\u5C04\u7AEF\u53E3\uFF0C\u67E5\u770B\u73AF\u5883\u53CA\u6269\u5C55\u4FE1\u606F

`,H.language=="php"&&H.phpExt&&(T+="RUN apk add --no-cache --update ",H.phpExt.map(function(y){T+="php".concat(A,"-").concat(y," ")}));break;case"golang":T+=`
# \u53EF\u4EE5\u4FEE\u6539 RUN_COMMAND \u73AF\u5883\u53D8\u91CF, \u66F4\u6539\u542F\u52A8\u6267\u884C\u547D\u4EE4
ENV RUN_COMMAND="go version"`;break;default:break}z.onFinish(T),J(!0)})},children:[(0,r.jsx)(u.Z.Group,{radioType:"button",name:"language",label:"\u7A0B\u5E8F\u8BED\u8A00",options:K.map(function(X){return{label:X.name,value:X.name}}),required:!0}),(0,r.jsx)(te.Z,{name:["language"],children:function(H){var J=H.language;return J?(0,r.jsx)(r.Fragment,{children:K.map(function(Y){if(Y.name==J)return(0,r.jsxs)("div",{children:[(0,r.jsx)(C.Z,{name:"".concat(Y.name,"EnvVersion"),label:"\u73AF\u5883\u7248\u672C",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7A0B\u5E8F\u8FD0\u884C\u7684\u73AF\u5883"}],children:(0,r.jsx)(le.Z,{options:Y.env.map(function(f){return{label:f.name,value:f.baseImage}}),placeholder:"\u8BF7\u9009\u62E9\u5177\u4F53\u7684\u73AF\u5883\u7248\u672C"},"".concat(Y.name,"Select"))},Y.name),Y.name=="php"&&(0,r.jsx)(C.Z,{label:"php\u6269\u5C55",name:"phpExt",children:(0,r.jsx)(le.Z,{options:Y.ext.map(function(f){return{label:f,value:f}}),mode:"multiple",placeholder:"\u8BF7\u9009\u62E9\u8981\u5B89\u88C5\u7684php\u6269\u5C55"},"phpExtSelect")},"phpExt")]},"envSelect")})}):(0,r.jsx)(r.Fragment,{})}})]})})}function oe(z){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{title:"\u5BFC\u5165\u672C\u5730Dockerfile\u6587\u4EF6",onImport:function(Z){var K;return(K=z.createFormRef.current)===null||K===void 0||K.setFieldValue("buildDockerfile",Z),!0},onLoad:function(Z){if(Z.indexOf("FROM ")<0)throw new Error("\u5BFC\u5165Dockerfile\u6587\u4EF6\u9519\u8BEF");return!0}}),(0,r.jsx)(N,{onFinish:function(Z){var K;(K=z.createFormRef.current)===null||K===void 0||K.setFieldValue("buildDockerfile",Z)}}),(0,r.jsx)(C.Z,{shouldUpdate:!0,children:function(Z){var K=Z.getFieldValue;return(0,r.jsx)(C.Z,{name:"buildDockerfile",children:(0,r.jsx)(_.ZP,{value:K("buildDockerfile"),onChange:function(X){var H;(H=z.createFormRef.current)===null||H===void 0||H.setFieldValue("buildDockerfile",X)},height:"600px",theme:"dark",style:{marginBottom:"20px"}})})}})]})}var he=e(24963),ge=e(18148),Fe=e(75870),me=e(38345),pe=e(97269),de=e(64317),ae=e(90672),fe=e(54006),_e=e(42075),se=e(91845);function q(){var z=(0,E.useContext)(he.Z),L=z.loading,Z=(0,E.useRef)(),K=(0,E.useState)([]),j=O()(K,2),X=j[0],H=j[1],J=(0,fe.useSearchParams)(),Y=O()(J,2),f=Y[0],v=Y[1],g=(0,E.useState)("dockerfile"),A=O()(g,2),T=A[0],y=A[1],ee=(0,fe.useNavigate)(),W=(0,E.useRef)();return(0,E.useEffect)(function(){var S,G=(S=f.get("id"))!==null&&S!==void 0?S:0;G&&(L.show(),(0,ge.T8)({id:parseInt(G)}).then(function(a){var V;y(a.data.task.buildType),(V=Z.current)===null||V===void 0||V.setFieldsValue({title:a.data.task.title,imageTag:a.data.task.tag,imageRegistry:a.data.task.setting.registry,uploadType:a.data.task.buildType,buildRoot:a.data.task.setting.buildRoot,buildGit:a.data.task.setting.buildGit,buildDockerfile:a.data.task.setting.buildDockerfile,platform:a.data.task.setting.platform})}).finally(function(){L.destroy()}))},[]),(0,r.jsxs)(me.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,r.jsx)(me.Z,{bordered:!0,headerBordered:!0,children:(0,r.jsxs)(pe.A,{submitter:{render:function(G,a){return(0,r.jsx)(_e.Z,{children:a})}},onFinish:function(){var S=m()(n()().mark(function G(a){var V,ne,ue,ce,ie,ye,Pe,Ce,Te,De,ve,Ee,Oe,Be,Me;return n()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(T!="containerTar"){Q.next=8;break}return Q.next=3,(0,b.vC)({tag:a.imageTag,registry:a.imageRegistry,tar:(V=a.containerTar[0].response.data.path)!==null&&V!==void 0?V:"",cmd:a.cmd,workDir:a.workDir,expose:a.expose?a.expose.split(`
`):[],env:a.env?a.env.split(`
`):[],volume:a.volume?a.volume.split(`
`):[]});case 3:return ne=Q.sent,ee("/image/list"),Q.abrupt("return",!0);case 8:if(T!="imageTar"){Q.next=18;break}return(ue=W.current)===null||ue===void 0||ue.start("import",a.imageTag),Q.next=12,(0,b.hG)({tag:a.imageTag,registry:a.imageRegistry,tar:(ce=a.imageTar[0].response.data.path)!==null&&ce!==void 0?ce:""});case 12:return ye=Q.sent,(ie=W.current)===null||ie===void 0||ie.reset(),ee("/image/list"),Q.abrupt("return",!0);case 18:return De=(Pe=f.get("id"))!==null&&Pe!==void 0?Pe:"0",ve=X&&X[0]?X[0].fileName:"",Ee={name:"",arch:""},b.ii.map(function(Ae){Ae.name==a.platform&&(Ee=Ae)}),Oe={id:parseInt(De),tag:a.imageTag,title:a.title,registry:a.imageRegistry,buildRoot:a.buildRoot,buildDockerfile:a.buildDockerfile,buildZip:ve!=null?ve:"",buildGit:a.buildGit,buildType:T,platform:Ee.name,PlatformArch:Ee.arch},a.buildZip&&a.buildZip.length>0&&(Oe.buildZip=(Be=a.buildZip[0].response.data.path)!==null&&Be!==void 0?Be:""),(Ce=W.current)===null||Ce===void 0||Ce.start("build",De),Q.next=27,(0,b.fN)(Oe);case 27:return Me=Q.sent,(Te=W.current)===null||Te===void 0||Te.reset(),ee("/image/list/recycle"),Q.abrupt("return",!0);case 31:case"end":return Q.stop()}},G)}));return function(G){return S.apply(this,arguments)}}(),formRef:Z,children:[(0,r.jsx)(F.Z,{label:"\u955C\u50CF\u540D\u79F0",name:"title",fieldProps:{onChange:function(G){var a="";if(G.target.value){var V,ne=(0,se.N9)(G.target.value.trim(),{toneType:"none",type:"array"});a=ne.join(""),(V=Z.current)===null||V===void 0||V.setFieldValue("imageTag",a)}}}}),(0,r.jsx)(de.Z,{label:"\u955C\u50CF\u4ED3\u5E93",tooltip:(0,r.jsxs)(r.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,r.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),name:"imageRegistry",request:m()(n()().mark(function S(){var G;return n()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,(0,Fe.Ot)();case 2:return G=V.sent,V.abrupt("return",G.data.list.map(function(ne){return{value:ne.serverAddress,label:ne.title+"("+ne.serverAddress+")"}}));case 4:case"end":return V.stop()}},S)}))}),(0,r.jsx)(te.Z,{name:["imageRegistry"],children:function(G){var a=G.imageRegistry;return(0,r.jsx)(F.Z,{fieldProps:{min:2,max:255,addonBefore:"".concat(a||"","/")},rules:[{required:!0}],required:!0,tooltip:"\u4F8B\u5982: name:tag\u3001namespace/name:tag\u3001registry/namespace/name:tag",placeholder:"\u53EA\u80FD\u4F7F\u7528\u5C0F\u5199\u82F1\u6587\u5B57\u7B26\u3001\u6570\u5B57\u3001_\u3001-\u3001",label:"\u955C\u50CFTag",name:"imageTag"})}}),(0,r.jsx)(u.Z.Group,{name:"uploadType",label:"\u6784\u5EFA\u65B9\u5F0F",initialValue:T,options:[{label:"Dockerfile",value:"dockerfile"},{label:"Zip\u6E90\u7801\u5305",value:"zip"},{label:"Git\u6E90\u7801\u4ED3\u5E93",value:"git"},{label:"\u5BFC\u5165\u5BB9\u5668Tar\u5305",value:"containerTar"},{label:"\u5BFC\u5165\u955C\u50CFTar\u5305",value:"imageTar"}],fieldProps:{onChange:function(G){y(G.target.value)}}}),(0,r.jsx)(te.Z,{name:["uploadType"],children:function(G){var a=G.uploadType;if(a=="containerTar")return[(0,r.jsx)(F.Z,{tooltip:"\u6307\u5B9A\u5BFC\u5165\u540E\u7684\u955C\u50CF\u5DE5\u4F5C\u76EE\u5F55\uFF0C\u4E00\u822C\u6307\u5411\u4EE3\u7801\u7684\u6240\u5728\u76EE\u5F55",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",placeholder:"\u9ED8\u8BA4\u4E3A / \u76EE\u5F55"},"workDir"),(0,r.jsx)(F.Z,{required:!0,tooltip:"\u901A\u8FC7\u5BB9\u5668\u5BFC\u5165\u955C\u50CF\u65F6\uFF0C\u5FC5\u987B\u6307\u5B9A\u542F\u52A8\u547D\u4EE4\uFF0C\u5426\u5219\u518D\u521B\u5EFA\u65F6\u65E0\u6CD5\u542F\u52A8",rules:[{required:!0}],label:"CMD",name:"cmd"},"cmd"),(0,r.jsx)(ae.Z,{tooltip:"\u6307\u5B9A\u5BFC\u5165\u540E\u7684\u955C\u50CF\u5BF9\u5916\u66B4\u9732\u7684\u7AEF\u53E3\uFF0C\u4E00\u884C\u6307\u5B9A\u4E00\u4E2A\u7AEF\u53E3",label:"\u66B4\u9732\u7AEF\u53E3",name:"expose",placeholder:`80 
9000`},"expose"),(0,r.jsx)(ae.Z,{tooltip:"\u6307\u5B9A\u5BFC\u5165\u540E\u7684\u955C\u50CF\u9700\u8981\u914D\u7F6E\u7684\u73AF\u5883\u53D8\u91CF\uFF0C\u4E00\u884C\u6307\u5B9A\u4E00\u4E2A\u73AF\u5883\u53D8\u91CF",label:"\u73AF\u5883\u53D8\u91CF",name:"env",placeholder:`TEST_VALUE=123 
TEST_NO_VALUE=`},"env"),(0,r.jsx)(ae.Z,{tooltip:"\u6307\u5B9A\u5BFC\u5165\u540E\u7684\u955C\u50CF\u9700\u8981\u6301\u4E45\u5316\u7684\u76EE\u5F55\uFF0C\u4E00\u884C\u6307\u5B9A\u4E00\u4E2A\u76EE\u5F55",label:"\u5B58\u50A8\u5377\u76EE\u5F55",name:"volume",placeholder:`/app 
/home`},"volume")];if(a!="imageTar"){if(a=="zip"||a=="git")return(0,r.jsx)(F.Z,{name:"buildRoot",label:"Dockerfile\u6587\u4EF6\u4F4D\u7F6E",tooltip:"\u6307\u5B9ADockerfile\u6240\u5728\u7684\u76EE\u5F55",fieldProps:{addonBefore:"\u9ED8\u8BA4\u4EE5\u5305\u6216\u662F\u4ED3\u5E93\u76EE\u5F55\u5F00\u59CB\uFF08/\uFF09"},placeholder:"/Dockerfile"})}}}),T=="zip"&&(0,r.jsx)(h,{label:"\u4E0A\u4F20\u6784\u5EFA\u5305 (\u53EA\u5141\u8BB8\u4E0A\u4F20 .zip \u6587\u4EF6\uFF0C\u4E14\u4E0E\u5305\u4E2D\u7684 Dockerfile \u6307\u5B9A\u7684\u76EE\u5F55\u4FDD\u6301\u4E00\u81F4)",name:"buildZip",accept:".zip"}),T=="containerTar"&&(0,r.jsx)(h,{label:"\u5BFC\u5165\u5BB9\u5668\u5305\uFF08\u53EA\u5141\u8BB8\u4E0A\u4F20 .tar \u6587\u4EF6\uFF0C\u901A\u8FC7\u5BFC\u51FA\u5BB9\u5668\u751F\u6210\uFF09",name:"containerTar",accept:".tar"}),T=="imageTar"&&(0,r.jsx)(h,{label:"\u5BFC\u5165\u955C\u50CF\u5305\uFF08\u53EA\u5141\u8BB8\u4E0A\u4F20 .tar \u6587\u4EF6\uFF0C\u901A\u8FC7\u5BFC\u51FA\u955C\u50CF\u751F\u6210\uFF09",name:"imageTar",accept:".tar"}),T=="git"&&(0,r.jsx)(M,{}),T=="dockerfile"&&(0,r.jsx)(oe,{createFormRef:Z})]})}),(0,r.jsx)($.Z,{ref:W})]})}},97961:function(re,w,e){e.d(w,{MF:function(){return o},_2:function(){return R},fN:function(){return F},hG:function(){return P},ii:function(){return O},vC:function(){return M}});var D=e(15009),n=e.n(D),U=e(99289),m=e.n(U),p=e(54006),O=[{name:"amd64",arch:"amd64"},{name:"arm64",arch:"arm64"},{name:"i386",arch:"386"},{name:"arm/v6",arch:"arm"},{name:"arm/v7",arch:"arm"},{name:"arm/v8",arch:"arm64"},{name:"ppc64le",arch:"ppc64le"},{name:"riscv64",arch:"riscv64"}];function F(t){return r.apply(this,arguments)}function r(){return r=m()(n()().mark(function t(s){return n()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,p.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:s}));case 1:case"end":return d.stop()}},t)})),r.apply(this,arguments)}function M(t){return b.apply(this,arguments)}function b(){return b=m()(n()().mark(function t(s){return n()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,p.request)("/api/app/image/import-by-container-tar",{method:"POST",data:s}));case 1:case"end":return d.stop()}},t)})),b.apply(this,arguments)}function P(t){return c.apply(this,arguments)}function c(){return c=m()(n()().mark(function t(s){return n()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,p.request)("/api/app/image/import-by-image-tar",{method:"POST",data:s}));case 1:case"end":return d.stop()}},t)})),c.apply(this,arguments)}function R(t){return l.apply(this,arguments)}function l(){return l=m()(n()().mark(function t(s){return n()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,p.request)("/api/common/attach/delete",{method:"POST",data:s});case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},t)})),l.apply(this,arguments)}function o(){return E.apply(this,arguments)}function E(){return E=m()(n()().mark(function t(){return n()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.abrupt("return",(0,p.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return B.stop()}},t)})),E.apply(this,arguments)}},18148:function(re,w,e){e.d(w,{$q:function(){return l},Fj:function(){return x},KG:function(){return O},KX:function(){return $},T8:function(){return c},Xn:function(){return b},ao:function(){return E},c5:function(){return d},c7:function(){return s}});var D=e(15009),n=e.n(D),U=e(99289),m=e.n(U),p=e(54006);function O(_){return F.apply(this,arguments)}function F(){return F=m()(n()().mark(function _(C){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,p.request)("/api/app/image/get-list",{method:"POST",data:C}));case 1:case"end":return u.stop()}},_)})),F.apply(this,arguments)}function r(_){return M.apply(this,arguments)}function M(){return M=_asyncToGenerator(_regeneratorRuntime().mark(function _(C){return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,request("/api/app/log/image-build",{method:"POST",data:C});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},_)})),M.apply(this,arguments)}function b(_){return P.apply(this,arguments)}function P(){return P=m()(n()().mark(function _(C){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,p.request)("/api/app/image/get-list-build",{method:"POST",data:C}));case 1:case"end":return u.stop()}},_)})),P.apply(this,arguments)}function c(_){return R.apply(this,arguments)}function R(){return R=m()(n()().mark(function _(C){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,p.request)("/api/app/image/get-build-task",{method:"POST",data:C});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},_)})),R.apply(this,arguments)}function l(_){return o.apply(this,arguments)}function o(){return o=m()(n()().mark(function _(C){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,p.request)("/api/app/image/delete-build-task",{method:"POST",data:C});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},_)})),o.apply(this,arguments)}function E(_){return t.apply(this,arguments)}function t(){return t=m()(n()().mark(function _(C){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,p.request)("/api/app/image/image-delete",{method:"POST",data:C});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},_)})),t.apply(this,arguments)}function s(){return B.apply(this,arguments)}function B(){return B=m()(n()().mark(function _(){return n()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,(0,p.request)("/api/app/image/image-prune",{method:"POST"});case 2:return I.abrupt("return",I.sent);case 3:case"end":return I.stop()}},_)})),B.apply(this,arguments)}function d(){return k.apply(this,arguments)}function k(){return k=m()(n()().mark(function _(){return n()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,(0,p.request)("/api/app/image/build-prune",{method:"POST"});case 2:return I.abrupt("return",I.sent);case 3:case"end":return I.stop()}},_)})),k.apply(this,arguments)}function x(_){return h.apply(this,arguments)}function h(){return h=m()(n()().mark(function _(C){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,p.request)("/api/app/image/update-title",{method:"POST",data:C});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},_)})),h.apply(this,arguments)}function $(_){return i.apply(this,arguments)}function i(){return i=m()(n()().mark(function _(C){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,p.request)("/api/app/image/tag-sync",{method:"POST",data:C}));case 1:case"end":return u.stop()}},_)})),i.apply(this,arguments)}},75870:function(re,w,e){e.d(w,{Ot:function(){return O},ZH:function(){return r},ix:function(){return b},t1:function(){return c}});var D=e(15009),n=e.n(D),U=e(99289),m=e.n(U),p=e(54006);function O(l){return F.apply(this,arguments)}function F(){return F=m()(n()().mark(function l(o){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/common/registry/get-list",{method:"POST",data:o}));case 1:case"end":return t.stop()}},l)})),F.apply(this,arguments)}function r(l){return M.apply(this,arguments)}function M(){return M=m()(n()().mark(function l(o){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/common/registry/create",{method:"POST",data:o}));case 1:case"end":return t.stop()}},l)})),M.apply(this,arguments)}function b(l){return P.apply(this,arguments)}function P(){return P=m()(n()().mark(function l(o){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/common/registry/delete",{method:"POST",data:o}));case 1:case"end":return t.stop()}},l)})),P.apply(this,arguments)}function c(l){return R.apply(this,arguments)}function R(){return R=m()(n()().mark(function l(o){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/common/registry/get-detail",{method:"POST",data:o}));case 1:case"end":return t.stop()}},l)})),R.apply(this,arguments)}}}]);
