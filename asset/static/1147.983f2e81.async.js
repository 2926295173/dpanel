"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1147],{99922:function(N,T,e){var U=e(97857),h=e.n(U),P=e(15009),A=e.n(P),g=e(99289),w=e.n(g),B=e(5574),I=e.n(B),s=e(67294),Z=e(85265),F=e(42075),K=e(28036),a=e(49610),O=e(3616),m=e(93362),C=e(90581),y=e(5251),v=e(36146),M=e(85893),c=new v.Uo("components.appDetail.appDetailQuickConsole"),x=(0,s.forwardRef)(function(j,l){var W,E,p=(0,s.useRef)(),f=(0,s.useRef)(),L=(0,s.useState)(!1),d=I()(L,2),t=d[0],i=d[1],r=(0,s.useState)(),u=I()(r,2),_=u[0],D=u[1];return(0,s.useImperativeHandle)(l,function(){return{show:function(n){return w()(A()().mark(function R(){var S;return A()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:D(n),i(!0),(S=p.current)===null||S===void 0||S.resetFields();case 3:case"end":return b.stop()}},R)}))()}}}),(0,s.useEffect)(function(){return setTimeout(function(){var o;_&&((o=f.current)===null||o===void 0||o.start(_.url,{cmd:_&&_.cmd,workDir:_&&_.workDir}))},1e3),function(){var o;(o=f.current)===null||o===void 0||o.close()}},[_,t]),(0,M.jsxs)(Z.Z,{forceRender:!0,width:O.FK,open:t,onClose:function(){return[i(!1)]},title:c.format("drawerTitle",{name:_==null?void 0:_.title}),children:[(0,M.jsxs)(F.Z,{style:{marginBottom:20},children:[j.showFileExplorer&&(0,M.jsx)(m.Z,{trigger:(0,M.jsx)(K.ZP,{type:"primary",children:c.format("fileExplorerButton")}),type:"container",title:(0,y.fi)((W=_==null?void 0:_.title)!==null&&W!==void 0?W:"","/"),name:_&&_.url&&(E=_.url.split("/").pop())!==null&&E!==void 0?E:""}),(0,M.jsx)(C.Z,{onChangeShell:function(n){var R;if(!_)return!1;(R=f.current)===null||R===void 0||R.close(),n!=(_==null?void 0:_.cmd)&&D(h()(h()({},_),{cmd:n}))},onOpenNewWindow:function(n){return _?(n.workDir=_&&_.workDir?_.workDir:"","".concat(_.url,"?").concat(Object.keys(n).map(function(R){return"".concat(R,"=").concat(encodeURIComponent(n[R]))}).join("&"))):""},onOpenNewWindowFinish:function(){var n;(n=f.current)===null||n===void 0||n.close(),i(!1)},onBatchCommandFinish:function(n){f.current&&f.current.run(n)}})]}),t&&(0,M.jsx)(a.Z,{height:"80vh",ref:f})]})});T.Z=x},93362:function(N,T,e){var U=e(97857),h=e.n(U),P=e(15009),A=e.n(P),g=e(99289),w=e.n(g),B=e(5574),I=e.n(B),s=e(67294),Z=e(57221),F=e(85265),K=e(3616),a=e(5251),O=e(36146),m=e(28031),C=e(24963),y=e(99922),v=e(85893),M=(0,s.forwardRef)(function(c,x){var j,l=(0,s.useState)(!1),W=I()(l,2),E=W[0],p=W[1],f=(0,s.useState)(),L=I()(f,2),d=L[0],t=L[1],i=(0,s.useRef)(),r=new O.Uo("components.appDetail.appDetailQuickFile"),u=(0,s.useContext)(C.Z),_=u.loading,D=(0,s.useRef)();return(0,s.useImperativeHandle)(x,function(){return{showContainer:function(n){t({name:(0,a.fi)(n,"/"),type:"container"}),p(!0)},showHost:function(n){t({name:n,type:"host"}),p(!0)},showVolume:function(n){return w()(A()().mark(function R(){var S;return A()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return _.show(),b.next=3,(0,m.Ak)("app",{name:n}).finally(function(){_.destroy()});case 3:S=b.sent,t({name:S.data.containerName,type:"container",workDir:S.data.path}),p(!0);case 6:case"end":return b.stop()}},R)}))()}}}),(0,v.jsxs)(v.Fragment,{children:[c.trigger?s.cloneElement(c.trigger,{onClick:function(){c.name&&c.type&&(t(c),p(!0))}}):null,(0,v.jsxs)(F.Z,{width:K.R_,title:r.format("drawerTitle",{name:(j=c.title)!==null&&j!==void 0?j:d==null?void 0:d.name}),onClose:function(){var n;(n=i.current)===null||n===void 0||n.close(),p(!1),t(void 0)},open:E,children:[c.showConsole&&(0,v.jsx)(y.Z,{showFileExplorer:!1,ref:D}),E&&d&&(0,v.jsx)(Z.Z,h()(h()({ref:i},d),{},{onConsole:c.showConsole?function(o){var n;(n=D.current)===null||n===void 0||n.show({url:"/console/container/".concat(d.name),title:d.name,workDir:o})}:void 0}))]})]})});T.Z=M},90581:function(N,T,e){e.d(T,{Z:function(){return W}});var U=e(15009),h=e.n(U),P=e(99289),A=e.n(P),g=e(5574),w=e.n(g),B=e(3616),I=e(97269),s=e(38345),Z=e(64317),F=e(37476),K=e(62370),a=e(97462),O=e(95089),m=e(42075),C=e(28036),y=e(83062),v=e(67294),M=e(58638),c=e(82346),x=e(69938),j=e(36146),l=e(85893);function W(E){var p=(0,v.useState)(!1),f=w()(p,2),L=f[0],d=f[1],t=(0,v.useRef)(),i=new j.Uo("components.console");return(0,l.jsx)(I.A,{layout:"inline",submitter:!1,children:(0,l.jsx)(s.Z,{ghost:!0,children:(0,l.jsxs)(m.Z,{children:[(0,l.jsx)(Z.Z,{label:" ",width:"sm",name:"entryCmd",placeholder:i.format("toolbarEntryCmdEmpty"),valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(u){E.onChangeShell&&E.onChangeShell(u)}}),(0,l.jsx)(F.Y,{modalProps:{width:B.ob,height:B.Ed},title:i.format("toolbarBatchCommandTitle"),name:"batchCommand",open:L,trigger:(0,l.jsx)(C.ZP,{children:i.format("toolbarBatchCommandTitle")}),formKey:"batchCommand",formRef:t,isKeyPressSubmit:!0,onFinish:function(){var r=A()(h()().mark(function u(_){return h()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:E.onBatchCommandFinish&&E.onBatchCommandFinish(_.shell.split(`
`)),d(!1);case 2:case"end":return o.stop()}},u)}));return function(u){return r.apply(this,arguments)}}(),onOpenChange:function(u){d(u),u&&t.current&&t.current.resetFields()},children:(0,l.jsx)(K.Z,{name:"shell",children:(0,l.jsx)(O.ZP,{theme:"dark",height:B.Ed})})}),(0,l.jsx)(a.Z,{name:["entryCmd"],children:function(u){var _=u.entryCmd;return(!_||_=="")&&(_="/bin/sh"),E.onOpenNewWindow&&(0,l.jsx)(c.Link,{onClick:function(){E.onOpenNewWindowFinish&&E.onOpenNewWindowFinish()},target:"_blank",to:E.onOpenNewWindow({cmd:_}),children:(0,l.jsx)(y.Z,{title:i.format("toolbarOpenInNewWindowTip"),children:(0,l.jsx)(C.ZP,{type:"dashed",icon:(0,l.jsx)(M.Z,{})})})})}}),(0,l.jsx)(x.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})}},49610:function(N,T,e){var U=e(5574),h=e.n(U),P=e(67294),A=e(52626),g=e(78267),w=e.n(g),B=e(12323),I=e(87662),s=e(4244),Z=e.n(s),F=e(24078),K=e(85893),a,O,m,C,y=(0,P.forwardRef)(function(v,M){var c,x=(0,P.useState)(),j=h()(x,2),l=j[0],W=j[1],E=(0,P.useState)(""),p=h()(E,2),f=p[0],L=p[1];(0,P.useImperativeHandle)(M,function(){return{start:function(i,r){d(),O.fit(),r.width=a.cols,r.height=a.rows;var u=r?Object.keys(r).filter(function(_){return r&&r[_]}).map(function(_){if(r&&r[_])return"".concat(_,"=").concat(r[_])}):[];m=new WebSocket((0,A.R)(i+"?"+u.join("&"))),m.addEventListener("message",function(_){var D=JSON.parse(_.data),o=D.type;if(o==i&&(a.write(D.data),D.data.indexOf("exec failed")!=-1)){d();return}}),C=a.onData(function(_){var D={content:{command:_},type:i};m&&m.send(JSON.stringify(D))}),L(i),W(r)},close:function(){d()},fit:function(){return O.fit(),{width:a.cols,height:a.rows}},run:function(i){l&&i&&i.forEach(function(r){var u={content:{command:r+`
`},type:f};m&&m.send(JSON.stringify(u))})}}}),(0,P.useEffect)(function(){return a=new s.Terminal(B.X),O=new g.FitAddon,a.loadAddon(O),a.open(document.getElementById("terminal-container-console")),O.fit(),(0,I.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(t){t.data&&t.data.fontSize&&Object.assign(a.options,t.data)}),function(){d()}},[]),(0,P.useEffect)(function(){window.addEventListener("resize",function(){O.fit();var t={size:{width:a.cols,height:a.rows},type:f};f&&m&&m.send(JSON.stringify(t))})},[f]);function d(){C&&(a.reset(),O.fit(),a.focus(),C.dispose()),m&&(m.close(),m=null)}return(0,K.jsx)("div",{style:{height:(c=v.height)!==null&&c!==void 0?c:"100vh"},id:"terminal-container-console"})});T.Z=y},12323:function(N,T,e){e.d(T,{X:function(){return U},n:function(){return h}});var U={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},h=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]}}]);
