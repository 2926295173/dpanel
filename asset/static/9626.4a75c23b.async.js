"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9626],{69626:function(Fe,he,n){n.d(he,{Z:function(){return Pn}});var ge=n(19632),m=n.n(ge),ye=n(5574),g=n.n(ye),E=n(15009),d=n.n(E),ie=n(99289),x=n.n(ie),o=n(67294),Q=n(80821),F=n(90098),ue=n(43425),M=n(87740),V=n(48689),W=n(33160),C=n(87784),I=n(74842),De=n(30159),ce=n(25035),Re=n(95591),fe=n(26522),xe=n(58638),K=n(38345),te=n(97269),X=n(86615),se=n(62370),pe=n(82346),Oe=n(85265),J=n(42075),Te=n(40056),de=n(96074),c=n(25593),l=n(84567),N=n(83062),r=n(83622),Ne=n(99861),ke=n(91058),Ge=n(79245),Qe=n(60940),ze=n(55241),He=n(78451),Ye=n(37413),Xe=n(94359),Je=n(91806),qe=n(60433),en=n(99611),_e=n(89035),nn=n(99922),tn=n(46357),rn=n(87662),Ze=n(5251),b=n(36146),be=n(93362),e=n(85893);function an(u){var re=(0,o.useState)(""),G=g()(re,2),A=G[0],q=G[1],k=(0,o.useRef)(),T=(0,o.useRef)(),U=(0,o.useState)(!1),y=g()(U,2),D=y[0],t=y[1],S=new b.Uo("components.appCompose"),Z=(0,o.useRef)();return(0,o.useEffect)(function(){(0,rn.K3)().then(function(v){var f;q((f=v.data.serverUrl)!==null&&f!==void 0?f:"")}),t(!1)},[u.containerList]),u.containerList&&(0,e.jsxs)(K.Z,{ghost:!0,title:(0,e.jsx)(Je.Z,{}),subTitle:S.format("detailContainerTitle"),extra:u.enableSelectService&&(0,e.jsx)(l.Z,{checked:D,onChange:function(f){t(f.target.checked)},children:S.format("selectService")},"selectService"),children:[(0,e.jsx)(nn.Z,{showFileExplorer:!0,ref:k}),(0,e.jsx)(be.Z,{ref:Z}),(0,e.jsx)(tn.Z,{ref:T}),(0,e.jsx)(Qe.Z,{scroll:{x:"max-content"},rowKey:"service",pagination:!1,columns:[{title:b.FD.format("listName"),dataIndex:"name",width:200,render:function(f,s,L){return(0,e.jsx)(N.Z,{title:s.service,children:(0,e.jsx)(He.Z,{content:s.name?(0,Ze.fi)(s.name,"/"):s.service})})}},{title:b.FD.format("listPort"),render:function(f,s,L){var z=[],P=[];return s.publishers&&s.publishers.map(function(_){_.publishedPort?z.push({PrivatePort:_.targetPort,Type:_.protocol,IP:_.url,PublicPort:_.publishedPort}):_.publishedPort&&P.push({PrivatePort:_.targetPort,Type:_.protocol,IP:_.url,PublicPort:_.publishedPort})}),(0,e.jsx)(Ye.Z,{publicPort:z,privatePort:P,domain:[],serverIp:A})}},{title:b.FD.format("listStatus"),render:function(f,s,L){return(0,e.jsx)(Xe.Z,{status:"container.".concat(s.state),tip:"".concat(s.state," ").concat(s.status)},s.name)}},{title:b.FD.format("listManage"),fixed:"right",render:function(f,s,L){return(0,e.jsxs)(J.Z,{split:(0,e.jsx)(de.Z,{type:"vertical"}),children:[s.name==""&&(0,e.jsx)(ze.Z,{placement:"left",content:(0,e.jsx)(K.Z,{ghost:!0,title:b.FD.format("listManageShowContainerEnv"),children:(0,e.jsx)(J.Z,{direction:"vertical",children:s.environment&&Object.keys(s.environment).map(function(z){if(s.environment&&s.environment[z])return(0,e.jsx)(c.Z.Text,{code:!0,children:"".concat(z,"=").concat(s.environment[z])},z)})})}),children:(0,e.jsx)(qe.Z,{})}),s.name!=""&&(0,e.jsx)(c.Z.Link,{onClick:function(){var P;(P=T.current)===null||P===void 0||P.show(s.name)},children:(0,e.jsx)(en.Z,{})},"container"),s.state=="running"&&(0,e.jsx)(c.Z.Link,{onClick:function(){var P;(P=k.current)===null||P===void 0||P.show({url:"/console/container/".concat((0,Ze.fi)(s.name,"/")),title:s.name})},children:(0,e.jsx)(_e.Z,{})},"console"),s.state=="running"&&(0,e.jsx)(c.Z.Link,{onClick:function(){var P;(P=Z.current)===null||P===void 0||P.showContainer((0,Ze.fi)(s.name,"/"))},children:(0,e.jsx)(Re.Z,{})},"file")]})}}],dataSource:u.containerList,rowSelection:D&&u.containerList?{defaultSelectedRowKeys:u.containerList.map(function(v){return v.service}),onChange:function(f,s,L){u.selectServiceFinish&&u.selectServiceFinish(f)}}:void 0})]})}var sn=n(81146),on=n(1883),Le=n(3616),ln=(0,o.forwardRef)(function(u,re){(0,o.useImperativeHandle)(re,function(){return{show:function(Z){return x()(d()().mark(function v(){return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:D(u.composeItem),k(!0);case 2:case"end":return s.stop()}},v)}))()}}});var G=(0,o.useState)(!1),A=g()(G,2),q=A[0],k=A[1],T=(0,o.useState)(),U=g()(T,2),y=U[0],D=U[1],t=(0,o.useRef)();return(0,e.jsxs)(e.Fragment,{children:[u.showTriggerButton&&(0,e.jsx)(r.ZP,{onClick:x()(d()().mark(function S(){return d()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:D(u.composeItem),k(!0);case 2:case"end":return v.stop()}},S)})),icon:(0,e.jsx)(on.Z,{}),children:b.FD.format("listManageLog")},"log"),(0,e.jsx)(Oe.Z,{title:b.FD.format("listLog"),open:q,forceRender:!0,onClose:function(){k(!1)},afterOpenChange:function(Z){if(Z)setTimeout(function(){var f,s;(f=t.current)===null||f===void 0||f.start(),(s=t.current)===null||s===void 0||s.fit()},1e3);else{var v;(v=t.current)===null||v===void 0||v.close()}},width:Le.FK,children:y&&q&&(0,e.jsx)(sn.Z,{ref:t,showInDrawer:!0,id:"compose:log:".concat(String(y.id||y.name)),request:function(){var S=x()(d()().mark(function Z(v){var f;return d()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,F.Yz)({id:y.id||y.name,lineTotal:v.lineTotal,download:(f=v.download)!==null&&f!==void 0?f:!1,showTime:v.showTime});case 2:case"end":return L.stop()}},Z)}));return function(Z){return S.apply(this,arguments)}}(),download:function(){var S=x()(d()().mark(function Z(v){var f;return d()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,F.vf)({id:y.id||y.name,lineTotal:v.lineTotal,showTime:v.showTime,download:!0});case 2:return f=L.sent,L.abrupt("return",{data:new Blob([f],{type:"text/plain"}),name:u.composeItem.name+"_"+new Date().toLocaleDateString()+".log"});case 4:case"end":return L.stop()}},Z)}));return function(Z){return S.apply(this,arguments)}}()})})]})}),un=ln,Ae=n(24963),cn=n(86548),Be=n(184),dn=n(95213),mn=n(11106),fn=n(92398),pn=n(40411);function vn(u){var re=(0,o.useContext)(Ae.Z),G=re.message,A=(0,o.useRef)(),q=new b.Uo("components.appCompose"),k=new b.Uo("compose");return u.composeItem.yamlList&&(0,e.jsx)(Be.a,{drawerProps:{width:Le.R_,destroyOnHidden:!0},title:q.format("yamlDrawerTitle"),formRef:A,trigger:(0,e.jsx)(r.ZP,{icon:(0,e.jsx)(cn.Z,{}),children:"Yaml"}),onFinish:function(){var T=x()(d()().mark(function U(y){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,F.im)({id:String(u.composeItem.id?u.composeItem.id:u.composeItem.name),name:u.composeItem.name,type:u.composeItem.setting.type,yaml:y.yaml,yamlOverride:y.yamlOverride});case 2:return t.next=4,(0,F.xC)({yaml:[y.yaml,y.yamlOverride],environment:u.composeItem.setting.environment,id:u.composeItem.id||u.composeItem.name});case 4:return u.onFinish&&u.onFinish(),t.abrupt("return",!0);case 6:case"end":return t.stop()}},U)}));return function(U){return T.apply(this,arguments)}}(),children:(0,e.jsx)(K.Z,{ghost:!0,children:(0,e.jsx)(fn.Z,{items:u.composeItem.yamlList.map(function(T,U){var y=[{label:k.format("createYaml"),key:"yaml"},{label:(0,e.jsx)(pn.Z,{count:T&&b.FD.format("listInUse"),offset:[15,-5],children:k.format("createYamlOverride")}),key:"yamlOverride"}];return{label:y[U].label,key:y[U].key,children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z,{hidden:!0,name:y[U].key}),(0,e.jsx)(se.Z,{shouldUpdate:!0,children:function(t){return(0,e.jsx)(mn.ZP,{onFocus:function(){if(y[U].key=="yaml"&&u.composeItem.setting.type=="remoteUrl"){G.error(k.format("createYamlDisableEdit"));return}},readOnly:y[U].key=="yaml"&&u.composeItem.setting.type=="remoteUrl",theme:"dark",minHeight:"550px",value:T,onChange:function(Z){t.setFieldValue(y[U].key,Z)},extensions:[dn.RI.yaml()]})}})]})}})})})})}var hn=n(65913),$e=n(1699),gn=n(16970),yn=n(75544),jn=(0,o.forwardRef)(function(u,re){(0,o.useImperativeHandle)(re,function(){return{show:function(){return x()(d()().mark(function D(){var t;return d()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return U(!0),(t=A.current)===null||t===void 0||t.clear(),Z.next=4,new Promise(function(v){return setTimeout(function(){var f;(f=A.current)===null||f===void 0||f.fit(),v(!0)},1e3)});case 4:case"end":return Z.stop()}},D)}))()},close:function(){var D;U(!1),(D=A.current)===null||D===void 0||D.clear()}}});var G=(0,pe.useModel)("subscriber"),A=(0,o.useRef)(),q=(0,o.useState)(!1),k=g()(q,2),T=k[0],U=k[1];return G.addDataHandler("compose:"+u.id,function(y){var D;(D=A.current)===null||D===void 0||D.write(y.data)}),(0,e.jsx)(K.Z,{hidden:!T,ghost:!0,title:(0,e.jsx)(_e.Z,{}),subTitle:"Console",extra:(0,e.jsx)(J.Z,{children:(0,e.jsx)(Q.Z,{action:x()(d()().mark(function y(){var D;return d()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return(D=A.current)===null||D===void 0||D.clear(),G.progress.close("compose:"+u.id),S.abrupt("return",!0);case 3:case"end":return S.stop()}},y)})),icon:(0,e.jsx)(V.Z,{}),danger:!0,onSuccess:function(){},children:b.FD.format("listManageKill")},"kill")}),children:(0,e.jsx)(yn.Z,{id:"create-log-".concat(u.id),height:"200px",style:{fontSize:12},ref:A})})}),Ve=jn,Cn=(0,o.forwardRef)(function(u,re){var G=(0,o.useState)(!1),A=g()(G,2),q=A[0],k=A[1],T=new b.Uo("components.appCompose"),U=(0,o.useState)(),y=g()(U,2),D=y[0],t=y[1],S=(0,o.useRef)(),Z=(0,o.useRef)();return(0,o.useImperativeHandle)(re,function(){return{show:function(f){var s;k(!0),t(f),(s=S.current)===null||s===void 0||s.setFieldsValue({environment:f.detail.setting.environment})}}}),(0,e.jsxs)(Be.a,{formRef:S,open:q,drawerProps:{forceRender:!0},title:T.format("taskDrawerTitle",{name:""}),onOpenChange:function(f){k(f)},children:[(0,e.jsx)(K.Z,{title:(0,e.jsx)(ue.Z,{}),subTitle:T.format("managerTitle"),ghost:!0,children:D&&(0,e.jsx)(J.Z,{wrap:!0,split:(0,e.jsx)(de.Z,{type:"vertical"}),children:(0,e.jsx)(Q.Z,{icon:(0,e.jsx)(I.Z,{}),type:"primary",confirmOnOpenChange:function(f){var s;f&&(!((s=S.current)===null||s===void 0)&&s.resetFields)&&S.current.resetFields()},action:x()(d()().mark(function v(){var f,s,L;return d()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return(f=Z.current)===null||f===void 0||f.show(),L=(s=S.current)===null||s===void 0?void 0:s.getFieldValue("environment"),P.next=4,(0,F.Oh)({id:D.detail.name,environment:L,autoRemove:!0});case 4:k(!1),u.onFinish&&u.onFinish(L);case 6:case"end":return P.stop()}},v)})),children:T.format("managerCreateButton")},"create")})},"operator"),D&&(0,e.jsx)(Ve,{ref:Z,id:D.detail.name}),(0,e.jsx)(ke.Z,{drawerProps:{ghost:!0,title:T.format("envTitle"),subTitle:T.format("envSubTitle"),tooltip:T.format("envTip")},name:"environment",showDisableName:!0,requireValue:!0,showDeleteButton:!1})]})}),wn=Cn,Rn=n(2831),Sn=(0,o.forwardRef)(function(u,re){var G;(0,o.useImperativeHandle)(re,function(){return{show:function(i){return x()(d()().mark(function p(){var w;return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(w=le.current)===null||w===void 0||w.close(),T(!0),a.prev=2,a.next=5,Ke(i);case 5:a.next=12;break;case 7:a.prev=7,a.t0=a.catch(2),T(!1),S(void 0),u.onClose&&u.onClose();case 12:case"end":return a.stop()}},p,null,[[2,7]])}))()}}});var A=(0,o.useState)(!1),q=g()(A,2),k=q[0],T=q[1],U=(0,pe.useNavigate)(),y=(0,o.useState)(),D=g()(y,2),t=D[0],S=D[1],Z=(0,o.useState)(),v=g()(Z,2),f=v[0],s=v[1],L=(0,o.useState)(0),z=g()(L,2),P=z[0],_=z[1],ae=(0,o.useRef)(),Se=(0,o.useRef)(),oe=(0,o.useRef)(),Ee=(0,o.useRef)(),le=(0,o.useRef)(),Ie=(0,o.useRef)(),Dn=(0,o.useContext)(Ae.Z),xn=Dn.message,Pe=(0,pe.useAccess)(),O=new b.Uo("components.appCompose"),On=new b.Uo("components.network"),Fn=(0,o.useRef)(),We=(0,o.useRef)();function Tn(j){return Ue.apply(this,arguments)}function Ue(){return Ue=x()(d()().mark(function j(i){var p,w,R;return d()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(p=le.current)===null||p===void 0?void 0:p.show();case 2:if(!i.pullImageUseDPanel){h.next=6;break}return h.next=5,(w=Ee.current)===null||w===void 0?void 0:w.start();case 5:(R=Ee.current)===null||R===void 0||R.finish();case 6:return h.prev=6,h.next=9,(0,F.Oh)(i);case 9:u.onDeployFinish&&u.onDeployFinish(),h.next=15;break;case 12:h.prev=12,h.t0=h.catch(6),u.onDeployFailed&&u.onDeployFailed(t);case 15:_(P+1);case 16:case"end":return h.stop()}},j,null,[[6,12]])})),Ue.apply(this,arguments)}function Ke(j){return Me.apply(this,arguments)}function Me(){return Me=x()(d()().mark(function j(i){var p,w,R,a,h,ee,H;return d()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return(p=Ie.current)===null||p===void 0||p.show(),(w=ae.current)===null||w===void 0||w.resetFields(),$.next=4,(0,F.Pn)({id:i}).finally(x()(d()().mark(function ne(){var B;return d()().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:(B=Ie.current)===null||B===void 0||B.destroy();case 1:case"end":return Ce.stop()}},ne)}))).catch(function(ne){throw ne});case 4:R=$.sent,a=R.data.detail,a.setting.status&&a.setting.status.indexOf("running")>-1&&(a.isRunning=!0),a.setting.status&&a.setting.status.indexOf("paused")>-1&&(a.isPaused=!0),a.setting.status&&a.setting.status.indexOf("exited")>-1&&(a.isExited=!0),a.setting.status&&a.setting.status=="waiting"?a.isDeploy=!1:a.isDeploy=!0,a.setting.status&&a.setting.status.indexOf("created")>-1&&(a.isCreated=!0,a.isDeploy=!1),h=R.data.project,h&&(a.imageList=m()(new Set(Object.keys(h.services).map(function(ne){var B;return(B=h.services[ne].image)!==null&&B!==void 0?B:""})))),a.containerList=R.data.containerList,a.containerList||(a.containerList=[]),Object.entries(h.services).forEach(function(ne){var B,me=g()(ne,2),Ce=me[0],Y=me[1];a.containerList.find(function(ve){return ve.service==Ce})||a.containerList.push({project:(B=h.name)!==null&&B!==void 0?B:"",name:"",service:Ce,publishers:Y.ports?Y.ports.map(function(ve){var we;return{url:"",targetPort:ve.target,publishedPort:parseInt(ve.published),protocol:(we=ve.protocol)!==null&&we!==void 0?we:""}}):[],state:"waiting",status:"",environment:Y.environment})}),a.containerList&&((ee=ae.current)===null||ee===void 0||ee.setFieldValue("deployServiceName",R.data.detail.setting.deployServiceName)),a.yamlList=R.data.yaml,S(a),s(R.data.task),R.data.yaml&&R.data.yaml.map(function(ne){(0,Ge.m)(ne).map(function(B){a.setting.environment&&!a.setting.environment.find(function(me){return me.name==B.name})&&a.setting.environment.push(B)})}),R.data.detail.setting.environment&&((H=ae.current)===null||H===void 0||H.setFieldValue("environment",R.data.detail.setting.environment));case 22:case"end":return $.stop()}},j)})),Me.apply(this,arguments)}return(0,o.useEffect)(function(){P>0&&t&&Ke(t.id||t.name).catch(function(j){T(!1)})},[P]),(0,e.jsxs)(Oe.Z,{width:Le.R_,forceRender:!0,title:(0,e.jsx)(J.Z,{children:O.format("drawerTitle",{name:(G=t==null?void 0:t.name)!==null&&G!==void 0?G:""})}),open:k,onClose:function(){T(!1),S(void 0),u.onClose&&u.onClose()},children:[(0,e.jsx)(be.Z,{ref:We}),(0,e.jsx)(wn,{onFinish:function(i){var p,w,R,a=((p=ae.current)===null||p===void 0?void 0:p.getFieldFormatValue)&&((w=ae.current)===null||w===void 0?void 0:w.getFieldFormatValue("environment"));a==null||a.forEach(function(h,ee){var H=i.find(function(je){return je.name==h.name});H&&(a[ee].value=H.value)}),!((R=ae.current)===null||R===void 0)&&R.setFieldValue&&ae.current.setFieldValue("environment",a)},ref:Fn}),(0,e.jsx)(hn.Z,{ref:Ie,children:(0,e.jsxs)(K.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,e.jsxs)(K.Z,{title:(0,e.jsx)(ue.Z,{}),subTitle:O.format("managerContainerTitle"),ghost:!0,extra:(0,e.jsx)(e.Fragment,{children:t&&t.imageList&&t.imageList.length>0&&(0,e.jsx)(Ne.Z,{ref:Ee,image:t.imageList})}),children:[t&&t.setting.type=="dangling"&&(0,e.jsx)(Te.Z,{type:"warning",showIcon:!0,description:(0,e.jsxs)("div",{children:[O.format("managerStatusDanglingAlert",{name:t.name})," ",(0,e.jsx)("a",{href:"https://dpanel.cc/manual/compose-create-outpath",target:"_blank",children:b.FD.format("help")})]})}),t&&t.setting.type!="dangling"&&(0,e.jsxs)(J.Z,{wrap:!0,split:(0,e.jsx)(de.Z,{type:"vertical"}),children:[(0,e.jsx)($e.u,{access:"canSeeComposeList",children:(0,e.jsx)(Q.Z,{icon:(0,e.jsx)(M.Z,{}),type:"primary",confirmOnOpenChange:function(i){var p;i&&(!((p=oe.current)===null||p===void 0)&&p.resetFields)&&oe.current.resetFields()},confirm:(0,e.jsxs)(J.Z,{style:{width:300},direction:"vertical",children:[(0,e.jsx)(c.Z.Text,{children:O.format("managerCreateTip")}),(0,e.jsxs)(te.A,{name:"createForm",formRef:oe,layout:"inline",submitter:!1,children:[(0,e.jsx)(X.Z.Group,{name:"pullImageUse",layout:"vertical",fieldProps:{style:{display:"flex",flexDirection:"column",gap:8}},options:O.option("managerCreatePullImageUseOption",["useCommand","useDPanel"])}),(0,e.jsx)(se.Z,{initialValue:!0,name:"createPath",valuePropName:"checked",children:(0,e.jsx)(l.Z,{defaultChecked:!0,children:O.format("managerCreateCreatePath")})}),(0,e.jsx)(se.Z,{initialValue:!0,name:"removeOrphans",valuePropName:"checked",children:(0,e.jsx)(l.Z,{defaultChecked:!0,children:O.format("managerCreateRemoveOrphans")})})]})]}),action:x()(d()().mark(function j(){var i,p,w,R,a,h,ee,H,je,$,ne,B,me;return d()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if($={id:t.id||t.name},(i=oe.current)!==null&&i!==void 0&&i.getFieldValue&&((p=oe.current)===null||p===void 0?void 0:p.getFieldValue("pullImageUse"))=="useDPanel"&&($.pullImage=!1,$.pullImageUseDPanel=!0),(w=oe.current)!==null&&w!==void 0&&w.getFieldValue&&((R=oe.current)===null||R===void 0?void 0:R.getFieldValue("pullImageUse"))=="useCommand"&&($.pullImage=!0),ne=((a=ae.current)===null||a===void 0?void 0:a.getFieldsFormatValue)&&ae.current.getFieldsFormatValue(),$.environment=ne.environment,$.deployServiceName=ne.deployServiceName,$.createPath=(h=(ee=oe.current)===null||ee===void 0?void 0:ee.getFieldValue("createPath"))!==null&&h!==void 0?h:!0,$.removeOrphans=(H=(je=oe.current)===null||je===void 0?void 0:je.getFieldValue("removeOrphans"))!==null&&H!==void 0?H:!0,!(t!=null&&t.isDeploy)){Y.next=12;break}if(!((B=oe.current)!==null&&B!==void 0&&B.getFieldValue("pullImageUseCommand"))){Y.next=12;break}return Y.next=12,(0,F.GG)({id:t.id||t.name,op:"pull"});case 12:if(!(t.isDeploy&&$.deployServiceName)){Y.next=18;break}if(me=!1,t.containerList.forEach(function(ve){var we;ve.status!=""&&!((we=$.deployServiceName)!==null&&we!==void 0&&we.includes(ve.service))&&(me=!0)}),!me){Y.next=18;break}return Y.next=18,(0,F.mg)({id:t.id||t.name,deleteImage:!1,deleteData:!1,deleteVolume:!1,deletePath:!1});case 18:return Y.abrupt("return",Tn($));case 19:case"end":return Y.stop()}},j)})),children:O.format(t.isDeploy?"managerUpgradeButton":"managerCreateButton")},"create")}),(t.isDeploy||t.isCreated)&&Pe.canSeeComposeListManage&&(0,e.jsx)(Q.Z,{action:function(){var i;return(i=le.current)===null||i===void 0||i.show(),(0,F.mg)({id:t.id||t.name,deleteImage:!1,deleteData:!1,deleteVolume:!1,deletePath:!1})},onSuccess:function(){_(P+1)},type:"primary",danger:!0,confirm:"notification.confirm.title",icon:(0,e.jsx)(V.Z,{}),children:O.format("managerDeleteContainerButton")}),t.isDeploy&&(0,e.jsxs)($e.u,{access:"canSeeComposeList",space:{direction:"horizontal"},children:[(0,e.jsx)(Q.Z,{icon:(0,e.jsx)(W.Z,{}),action:x()(d()().mark(function j(){var i;return d()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return(i=le.current)===null||i===void 0||i.show(),w.abrupt("return",(0,F.GG)({id:t.id||t.name,op:"restart"}));case 2:case"end":return w.stop()}},j)})),onSuccess:function(){_(P+1)},children:O.format("managerRestartButton")},"restart"),(0,e.jsx)(Q.Z,{action:function(){var i;return(i=le.current)===null||i===void 0||i.show(),(0,F.GG)({id:t.id||t.name,op:"stop"})},icon:(0,e.jsx)(C.Z,{}),disabled:t.isExited,onSuccess:function(){_(P+1)},children:O.format("managerStopButton")}),t.isPaused&&(0,e.jsx)(Q.Z,{action:function(){var i;return(i=le.current)===null||i===void 0||i.show(),(0,F.GG)({id:t.id||t.name,op:"unpause"})},onSuccess:function(){_(P+1)},icon:(0,e.jsx)(I.Z,{}),children:O.format("managerUnpauseButton")}),!t.isPaused&&(0,e.jsx)(Q.Z,{action:function(){var i;return(i=le.current)===null||i===void 0||i.show(),(0,F.GG)({id:t.id||t.name,op:"pause"})},onSuccess:function(){_(P+1)},icon:(0,e.jsx)(De.Z,{}),disabled:!t.isRunning,children:O.format("managerPauseButton")})]}),t.id>0&&Pe.canSeeComposeListManageDelete&&(0,e.jsx)(Q.Z,{type:"primary",action:x()(d()().mark(function j(){var i,p,w,R,a,h,ee,H;return d()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return(i=le.current)===null||i===void 0||i.show(),$.next=3,(0,F.mg)({id:(p=t==null?void 0:t.id)!==null&&p!==void 0?p:t.name,deleteImage:(w=(R=Se.current)===null||R===void 0?void 0:R.getFieldValue("deleteImage"))!==null&&w!==void 0?w:!1,deleteVolume:(a=(h=Se.current)===null||h===void 0?void 0:h.getFieldValue("deleteVolume"))!==null&&a!==void 0?a:!1,deletePath:(ee=(H=Se.current)===null||H===void 0?void 0:H.getFieldValue("deletePath"))!==null&&ee!==void 0?ee:!1,deleteData:!0});case 3:T(!1),S(void 0),u.onClose&&u.onClose();case 6:case"end":return $.stop()}},j)})),danger:!0,onSuccess:function(){},confirmOnOpenChange:function(){var i;!((i=Se.current)===null||i===void 0)&&i.resetFields&&Se.current.resetFields()},confirm:(0,e.jsxs)(J.Z,{style:{width:240},direction:"vertical",children:[(0,e.jsx)(c.Z.Text,{children:O.format("managerDeleteTaskTip")}),(0,e.jsxs)(te.A,{formRef:Se,layout:"inline",submitter:!1,children:[(0,e.jsx)(se.Z,{initialValue:!1,name:"deleteImage",valuePropName:"checked",children:(0,e.jsx)(l.Z,{children:O.format("managerDeleteTaskDeleteImage")})}),(0,e.jsx)(se.Z,{addonAfter:(0,e.jsx)(N.Z,{title:O.format("managerDeleteTaskDeleteVolumeTip"),children:(0,e.jsx)(ce.Z,{})}),initialValue:!1,name:"deleteVolume",valuePropName:"checked",children:(0,e.jsx)(l.Z,{children:O.format("managerDeleteTaskDeleteVolume")})}),(0,e.jsx)(se.Z,{initialValue:!1,name:"deletePath",valuePropName:"checked",children:(0,e.jsx)(l.Z,{children:O.format("managerDeleteTaskDeletePath")})})]})]}),children:O.format("managerDeleteTaskButton")}),t.isDeploy&&(0,e.jsx)(un,{composeItem:t,showTriggerButton:!0}),u.showBackListButton&&(0,e.jsx)(pe.Link,{to:"/compose/list",children:(0,e.jsx)(r.ZP,{children:b.Ob.format("compose.list")})})]})]},"operator"),(0,e.jsx)(K.Z,{title:(0,e.jsx)(ue.Z,{}),subTitle:O.format("managerTitle"),ghost:!0,children:t&&t.setting.type!="dangling"&&(0,e.jsxs)(J.Z,{children:[Pe.canSeeComposeListManage&&(0,e.jsx)(vn,{composeItem:t,onFinish:x()(d()().mark(function j(){return d()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:xn.info(O.format("messageYamlEditFinish")),_(P+1);case 2:case"end":return p.stop()}},j)}))}),Pe.canSeeComposeListManageCreate&&t&&t.setting.type!="outPath"&&(0,e.jsx)(r.ZP,{icon:(0,e.jsx)(Re.Z,{}),onClick:x()(d()().mark(function j(){var i,p,w,R;return d()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,Rn.aF)();case 2:p=h.sent,p.data&&(i=p.data.dpanel.containerInfo)!==null&&i!==void 0&&i.Name&&((w=We.current)===null||w===void 0||w.showContainer((R=p.data.dpanel.containerInfo)===null||R===void 0?void 0:R.Name,"/dpanel/compose/".concat(t.name)));case 4:case"end":return h.stop()}},j)})),children:O.format("managerOpenTaskPath")}),(0,e.jsx)(de.Z,{type:"vertical"}),Pe.canSeeComposeListManage&&(0,e.jsx)(gn.Z,{trigger:(0,e.jsx)(r.ZP,{icon:(0,e.jsx)(fe.Z,{}),children:On.format("createTitle")},"network")},"network-create"),Pe.canSeeComposeListManageCreate&&t&&(0,e.jsx)(r.ZP,{type:"primary",icon:(0,e.jsx)(xe.Z,{}),onClick:function(){U("/compose/create?id=".concat(t.id||t.name))},children:O.format("drawerEditButtonTip")}),(0,e.jsx)(de.Z,{type:"vertical"}),(0,e.jsx)(r.ZP,{icon:(0,e.jsx)(W.Z,{}),onClick:function(){var i;(i=le.current)===null||i===void 0||i.close(),_(P+1)},children:b.FD.format("listManageRefresh")})]})},"manager"),t&&(0,e.jsx)(Ve,{ref:le,id:t.id||t.name}),t&&(0,e.jsx)(an,{containerList:t.containerList,enableSelectService:!0,selectServiceFinish:function(i){var p;(p=ae.current)===null||p===void 0||p.setFieldValue("deployServiceName",i)}}),(0,e.jsx)($e.u,{access:"canSeeComposeList",children:(0,e.jsxs)(te.A,{submitter:!1,formRef:ae,children:[(0,e.jsx)(se.Z,{name:"deployServiceName",hidden:!0}),t&&t.setting.type!="dangling"&&(0,e.jsx)(ke.Z,{drawerProps:{subTitle:O.format("envSubTitle"),title:O.format("envTitle"),ghost:!0,tooltip:O.format("envTip")},name:"environment",showDisableName:!0,requireValue:!0,showDeleteButton:!1})]})})]})})]})}),Pn=Sn},75544:function(Fe,he,n){var ge=n(5574),m=n.n(ge),ye=n(12323),g=n(78267),E=n.n(g),d=n(75458),ie=n.n(d),x=n(67294),o=n(4244),Q=n.n(o),F=n(24078),ue=n(85893),M,V,W,C=(0,x.forwardRef)(function(I,De){var ce,Re=(0,x.useState)(!0),fe=m()(Re,2),xe=fe[0],K=fe[1];return(0,x.useEffect)(function(){return M=new o.Terminal(ye.X),V=new d.SearchAddon,W=new g.FitAddon,window.addEventListener("resize",function(){I.showInModal||W.fit()}),I.style&&I.style.fontSize&&(M.options.fontSize=I.style.fontSize),M.loadAddon(W),M.loadAddon(V),M.open(document.getElementById(I.id?I.id:"terminal-container")),I.showInModal||W.fit(),function(){M.reset(),K(!0)}},[]),(0,x.useImperativeHandle)(De,function(){return{write:function(X){xe&&(W.fit(),K(!1)),M.write(X)},clear:function(){M.clear()},getTerminal:function(){return M},findNext:function(X){V.findNext(X)},findPrev:function(X){V.findPrevious(X)},fit:function(){W.fit()},onData:function(X){return M.onData(X)}}}),(0,ue.jsx)("div",{id:I.id?I.id:"terminal-container",style:{width:I.width?I.width:"100%",height:I.height?I.height:"500px",marginTop:(ce=I.style)===null||ce===void 0?void 0:ce.marginTop}})});he.Z=C},2831:function(Fe,he,n){n.d(he,{Ll:function(){return Q},aF:function(){return d},d6:function(){return ue},u5:function(){return x}});var ge=n(15009),m=n.n(ge),ye=n(99289),g=n.n(ye),E=n(82346);function d(){return ie.apply(this,arguments)}function ie(){return ie=g()(m()().mark(function V(){return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,E.request)("/api/common/home/info",{method:"POST"});case 2:return C.abrupt("return",C.sent);case 3:case"end":return C.stop()}},V)})),ie.apply(this,arguments)}function x(){return o.apply(this,arguments)}function o(){return o=g()(m()().mark(function V(){return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,E.request)("/api/common/home/check-new-version",{method:"POST"});case 2:return C.abrupt("return",C.sent);case 3:case"end":return C.stop()}},V)})),o.apply(this,arguments)}function Q(){return F.apply(this,arguments)}function F(){return F=g()(m()().mark(function V(){return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,E.request)("/api/common/home/usage",{method:"POST"});case 2:return C.abrupt("return",C.sent);case 3:case"end":return C.stop()}},V)})),F.apply(this,arguments)}function ue(){return M.apply(this,arguments)}function M(){return M=g()(m()().mark(function V(){return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,E.request)("/api/common/home/upgrade-script",{method:"POST"});case 2:return C.abrupt("return",C.sent);case 3:case"end":return C.stop()}},V)})),M.apply(this,arguments)}},90098:function(Fe,he,n){n.d(he,{GG:function(){return De},MG:function(){return te},Oh:function(){return V},Pn:function(){return Q},Yz:function(){return Re},iE:function(){return Oe},ik:function(){return ue},im:function(){return d},mg:function(){return C},pm:function(){return x},tw:function(){return Te},vf:function(){return xe},xC:function(){return se}});var ge=n(15009),m=n.n(ge),ye=n(99289),g=n.n(ye),E=n(82346);function d(c){return ie.apply(this,arguments)}function ie(){return ie=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,E.request)("/api/app/compose/create",{method:"POST",data:l}));case 1:case"end":return r.stop()}},c)})),ie.apply(this,arguments)}function x(c){return o.apply(this,arguments)}function o(){return o=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,E.request)("/api/app/compose/get-list",{method:"POST",data:l}));case 1:case"end":return r.stop()}},c)})),o.apply(this,arguments)}function Q(c){return F.apply(this,arguments)}function F(){return F=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l.id=String(l.id),r.abrupt("return",(0,E.request)("/api/app/compose/get-task",{method:"POST",data:l}));case 2:case"end":return r.stop()}},c)})),F.apply(this,arguments)}function ue(c){return M.apply(this,arguments)}function M(){return M=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,E.request)("/api/app/compose/delete",{method:"POST",data:l}));case 1:case"end":return r.stop()}},c)})),M.apply(this,arguments)}function V(c){return W.apply(this,arguments)}function W(){return W=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l.id=String(l.id),r.abrupt("return",(0,E.request)("/api/app/compose/container-deploy",{method:"POST",data:l}));case 2:case"end":return r.stop()}},c)})),W.apply(this,arguments)}function C(c){return I.apply(this,arguments)}function I(){return I=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l.id=String(l.id),r.abrupt("return",(0,E.request)("/api/app/compose/container-destroy",{method:"POST",data:l}));case 2:case"end":return r.stop()}},c)})),I.apply(this,arguments)}function De(c){return ce.apply(this,arguments)}function ce(){return ce=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l.id=String(l.id),r.abrupt("return",(0,E.request)("/api/app/compose/container-ctrl",{method:"POST",data:l}));case 2:case"end":return r.stop()}},c)})),ce.apply(this,arguments)}function Re(c){return fe.apply(this,arguments)}function fe(){return fe=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l.id=String(l.id),r.abrupt("return",(0,E.request)("/api/app/compose/container-log",{method:"POST",data:l}));case 2:case"end":return r.stop()}},c)})),fe.apply(this,arguments)}function xe(c){return K.apply(this,arguments)}function K(){return K=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l.download=!0,l.id=String(l.id),r.next=4,(0,E.request)("/api/app/compose/container-log",{method:"POST",data:l,responseType:"blob"});case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}},c)})),K.apply(this,arguments)}function te(c){return X.apply(this,arguments)}function X(){return X=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,E.request)("/api/app/compose/get-from-uri",{method:"POST",data:l}));case 1:case"end":return r.stop()}},c)})),X.apply(this,arguments)}function se(c){return pe.apply(this,arguments)}function pe(){return pe=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l.id=String(l.id),r.abrupt("return",(0,E.request)("/api/app/compose/parse",{method:"POST",data:l}));case 2:case"end":return r.stop()}},c)})),pe.apply(this,arguments)}function Oe(c){return J.apply(this,arguments)}function J(){return J=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,E.request)("/api/common/store/deploy",{method:"POST",data:l}));case 1:case"end":return r.stop()}},c)})),J.apply(this,arguments)}function Te(c){return de.apply(this,arguments)}function de(){return de=g()(m()().mark(function c(l){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l.id=String(l.id),r.abrupt("return",(0,E.request)("/api/app/compose/download",{method:"POST",data:l,responseType:"blob"}));case 2:case"end":return r.stop()}},c)})),de.apply(this,arguments)}}}]);
