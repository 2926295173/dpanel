"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4202],{45742:function(y,T,e){e.d(T,{Z:function(){return M}});var R=e(87462),i=e(67294),E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656zM492 400h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zM340 368a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"profile",theme:"outlined"},m=E,h=e(84089),j=function(r,L){return i.createElement(h.Z,(0,R.Z)({},r,{ref:L,icon:m}))},I=i.forwardRef(j),M=I},80821:function(y,T,e){e.d(T,{Z:function(){return P}});var R=e(5574),i=e.n(R),E=e(24963),m=e(86738),h=e(28036),j=e(83062),I=e(67294),M=e(85893);function P(r){var L=(0,I.useState)(!1),s=i()(L,2),v=s[0],t=s[1],l=(0,I.useContext)(E.Z),A=l.lang,f=l.notice,B=l.message,C=function(){t(!0);var O=r.action();O instanceof Promise?O.then(function(g){if(t(!1),g){typeof r.onSuccess=="function"&&r.onSuccess(g);var _="";r.messageSuccess?typeof r.messageSuccess=="function"?_=r.messageSuccess(g):_=r.messageSuccess.indexOf("notification.")==0?A(r.messageSuccess):r.messageSuccess:_=A("notification.finish"),r.asynced?B.info(_):B.success(_)}}).catch(function(g){t(!1),typeof r.onError=="function"&&r.onError(g)}):t(!1)};return r.confirm?(0,M.jsx)(m.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:A("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?A(r.confirm):r.confirm,onConfirm:C,okText:"Yes",cancelText:"No",onOpenChange:r.confirmOnOpenChange,children:(0,M.jsx)(h.ZP,{block:r.block,disabled:r.disabled,icon:!r.children&&v?void 0:r.icon,loading:v,danger:r.danger,type:r.type,children:r.children})}):(0,M.jsx)(j.Z,{title:r.tips,children:(0,M.jsx)(h.ZP,{block:r.block,style:r.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:r.disabled,icon:!r.children&&v?void 0:r.icon,loading:v,onClick:C,danger:r.danger,type:r.type,children:r.children})})}},94359:function(y,T,e){e.d(T,{Z:function(){return v}});var R=e(3089),i=e(98165),E=e(18429),m=e(8751),h=e(14313),j=e(30159),I=e(87740),M=e(50888),P=e(66309),r=e(83062),L=e(82346),s=e(85893);function v(t){var l=(0,s.jsx)(s.Fragment,{});if(t.status=="0"&&(l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(R.Z,{}),color:"default",children:"waiting"})),t.status=="10"&&(l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(i.Z,{spin:!0}),color:"processing",children:"processing"})),t.status=="20"&&(l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(E.Z,{}),color:"error",children:"error"})),t.status=="30"&&(l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(m.Z,{}),color:"success",children:"success"})),t.status=="running"||t.status=="healthy"){var A,f;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(h.Z,{}),color:"success",children:(A=t.message)!==null&&A!==void 0&&A.showInTag?(f=t.message)===null||f===void 0?void 0:f.content:t.status})}if(t.status=="paused"){var B,C;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(j.Z,{}),children:(B=t.message)!==null&&B!==void 0&&B.showInTag?(C=t.message)===null||C===void 0?void 0:C.content:t.status})}if(t.status=="waiting"||t.status=="starting"){var W,O;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(I.Z,{}),children:(W=t.message)!==null&&W!==void 0&&W.showInTag?(O=t.message)===null||O===void 0?void 0:O.content:t.status})}if(t.status=="deploying"){var g,_;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(M.Z,{}),color:"processing",children:(g=t.message)!==null&&g!==void 0&&g.showInTag?(_=t.message)===null||_===void 0?void 0:_.content:t.status})}if(t.status=="error"){var a,d;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(E.Z,{}),color:"error",children:(a=t.message)!==null&&a!==void 0&&a.showInTag?(d=t.message)===null||d===void 0?void 0:d.content:t.status})}if(t.status=="exited"||t.status=="dead"||t.status=="removing"||t.status=="restarting"||t.status=="unhealthy"||t.status=="created"){var u,D;l=(0,s.jsx)(P.Z,{icon:(0,s.jsx)(E.Z,{}),color:"warning",children:(u=t.message)!==null&&u!==void 0&&u.showInTag?(D=t.message)===null||D===void 0?void 0:D.content:t.status})}if(t.link)return(0,s.jsx)(L.Link,{to:t.link,children:l});if(t.message){var o,n;return(0,s.jsx)(r.Z,{placement:(o=t.message.placement)!==null&&o!==void 0?o:"top",title:(n=t.message.title)!==null&&n!==void 0?n:t.message.content,children:l})}return l}},74344:function(y,T,e){var R=e(5574),i=e.n(R),E=e(37476),m=e(38345),h=e(82346),j=e(67294),I=e(54964),M=e(85893),P=(0,j.forwardRef)(function(r,L){(0,j.useImperativeHandle)(L,function(){return{start:function(){for(var _=arguments.length,a=new Array(_),d=0;d<_;d++)a[d]=arguments[d];C(a.join(":")),l(!0)},reset:function(){var _;(_=O.current)===null||_===void 0||_.clear(),l(!1)},show:function(_){var a,d;(a=O.current)===null||a===void 0||a.clear(),(d=O.current)===null||d===void 0||d.write(_),l(!0)}}});var s=(0,j.useState)(!1),v=i()(s,2),t=v[0],l=v[1],A=(0,j.useState)(""),f=i()(A,2),B=f[0],C=f[1],W=(0,h.useModel)("subscriber"),O=(0,j.useRef)();return W.addDataHandler("image:"+B,function(g){var _;(_=O.current)===null||_===void 0||_.write(g.data)}),(0,j.useEffect)(function(){var g;(g=O.current)===null||g===void 0||g.fit()},[]),(0,M.jsx)(E.Y,{modalProps:{forceRender:!0},title:"\u6784\u5EFA\u65E5\u5FD7",submitter:!1,width:1e3,onOpenChange:function(_){if(l(_),_){var a,d;(a=O.current)===null||a===void 0||a.clear(),(d=O.current)===null||d===void 0||d.fit()}},open:t,children:(0,M.jsx)(m.Z,{ghost:!0,children:(0,M.jsx)(I.Z,{showInModal:!0,width:"960px",height:"500px",ref:O})})})});T.Z=P},78451:function(y,T,e){e.d(T,{Z:function(){return E}});var R=e(67294),i=e(85893);function E(m){return(0,i.jsx)("span",{style:{width:m.width?m.width:"auto",wordBreak:"break-word"},children:m.content})}},54964:function(y,T,e){e.d(T,{a:function(){return s}});var R=e(5574),i=e.n(R),E=e(78267),m=e.n(E),h=e(75458),j=e.n(h),I=e(67294),M=e(12320),P=e.n(M),r=e(89629),L=e(85893),s={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},v=new M.Terminal(s),t=new h.SearchAddon,l=new E.FitAddon,A=(0,I.forwardRef)(function(f,B){var C,W=(0,I.useState)(!0),O=i()(W,2),g=O[0],_=O[1];return(0,I.useEffect)(function(){return window.addEventListener("resize",function(){f.showInModal||l.fit()}),f.style&&f.style.fontSize&&(v.options.fontSize=f.style.fontSize),v.loadAddon(l),v.loadAddon(t),v.open(document.getElementById(f.id?f.id:"terminal-container")),f.showInModal||l.fit(),function(){v.reset(),_(!0)}},[]),(0,I.useImperativeHandle)(B,function(){return{write:function(d){g&&(l.fit(),_(!1)),v.write(d)},clear:function(){v.clear()},getTerminal:function(){return v},findNext:function(d){t.findNext(d)},findPrev:function(d){t.findPrevious(d)},fit:function(){l.fit()},onData:function(d){return v.onData(d)}}}),(0,L.jsx)("div",{id:f.id?f.id:"terminal-container",style:{width:f.width?f.width:"100%",height:f.height?f.height:"500px",marginTop:(C=f.style)===null||C===void 0?void 0:C.marginTop}})});T.Z=A},24963:function(y,T,e){var R=e(67294),i=(0,R.createContext)({});T.Z=i},52548:function(y,T,e){e.r(T),e.d(T,{default:function(){return d}});var R=e(15009),i=e.n(R),E=e(99289),m=e.n(E),h=e(90078),j=e(78099),I=e(28036),M=e(42075),P=e(83062),r=e(66309),L=e(96074),s=e(25593),v=e(50136),t=e(82346),l=e(18148),A=e(94359),f=e(43425),B=e(45742),C=e(80821),W=e(67294),O=e(67255),g=e(78451),_=e(74344),a=e(85893);function d(){var u=(0,W.useRef)(),D=(0,W.useRef)();return(0,a.jsxs)(h._z,{header:{extra:[(0,a.jsx)(I.ZP,{type:"primary",children:(0,a.jsx)(t.Link,{to:"/image/create",children:"\u521B\u5EFA\u955C\u50CF"})},"create"),(0,a.jsx)(I.ZP,{children:"\u62C9\u53D6\u955C\u50CF"},"pull")]},children:[(0,a.jsx)(j.Z,{scroll:{x:"max-content"},actionRef:u,rowKey:"id",columns:[{title:"\u540D\u79F0",render:function(n,c,K,U){return(0,a.jsx)(M.Z,{direction:"vertical",style:{textAlign:"left"},children:c.imageInfo&&c.imageInfo.info.Id?(0,a.jsx)(t.Link,{to:"/image/detail/".concat(c.imageInfo.info.Id),children:(0,a.jsxs)(P.Z,{title:"\u67E5\u770B\u955C\u50CF",children:[" ",c.title]})},"detail"):c.title},c.id)}},{title:"\u6700\u65B0Tag",dataIndex:"tag",search:!1,render:function(n,c,K,U){return c.imageInfo?c.imageInfo.info.Id==""?(0,a.jsx)(r.Z,{children:"none"},"none"):(0,a.jsx)(M.Z,{direction:"vertical",style:{textAlign:"left"},children:c.imageInfo.info.RepoTags.map(function(x,Z){return(0,a.jsx)(r.Z,{color:"#2db7f5",children:x},Z)})},c.id):(0,a.jsx)(r.Z,{color:"#2db7f5",children:c.tag},c.id)}},{title:"\u955C\u50CFId",search:!1,copyable:!0,width:300,render:function(n,c,K,U,x){return(0,a.jsx)(g.Z,{content:c.imageInfo&&c.imageInfo.info.Id})}},{title:"\u6784\u5EFA\u72B6\u6001",width:150,ellipsis:!0,search:!1,render:function(n,c,K,U){return[(0,a.jsx)("div",{children:(0,a.jsx)(A.Z,{status:c.status},c.id)},c.id)]}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,fixed:"right",render:function(n,c,K,U){return(0,a.jsxs)(M.Z,{split:(0,a.jsx)(L.Z,{type:"vertical"}),children:[(0,a.jsx)(t.Link,{to:"/image/create?id="+c.id,type:"link",children:(0,a.jsx)(P.Z,{title:"\u518D\u6B21\u6784\u5EFA",children:(0,a.jsx)(f.Z,{})})},"rebuild"),(0,a.jsx)(s.Z.Link,{onClick:function(){var Z;(Z=D.current)===null||Z===void 0||Z.show(c.message)},children:(0,a.jsx)(P.Z,{title:"\u6784\u5EFA\u65E5\u5FD7",children:(0,a.jsx)(B.Z,{})})},"logs")]})}}],request:function(){var o=m()(i()().mark(function n(c,K,U){var x,Z,b;return i()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,l.Xn)({page:(x=c.current)!==null&&x!==void 0?x:1,pageSize:(Z=c.pageSize)!==null&&Z!==void 0?Z:10});case 2:return b=S.sent,S.abrupt("return",{data:b.data.list,success:!0,total:b.data.total});case 4:case"end":return S.stop()}},n)}));return function(n,c,K){return o.apply(this,arguments)}}(),pagination:(0,O.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(n){var c=n.selectedRowKeys;return(0,a.jsx)(M.Z,{size:16,children:(0,a.jsx)(C.Z,{danger:!0,type:"primary",action:function(){return(0,l.$q)({id:c})},onSuccess:function(){var U,x;return!((U=u.current)===null||U===void 0)&&U.reloadAndRest&&((x=u.current)===null||x===void 0||x.reloadAndRest()),!0},onError:function(){var U,x;return!((U=u.current)===null||U===void 0)&&U.reset&&((x=u.current)===null||x===void 0||x.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"})})},tableExtraRender:function(){return(0,a.jsx)(v.Z,{mode:"horizontal",selectedKeys:["build"],items:[{label:(0,a.jsx)(t.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,a.jsx)(t.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})}}),(0,a.jsx)(_.Z,{ref:D})]})}},18148:function(y,T,e){e.d(T,{$q:function(){return t},Fj:function(){return g},KG:function(){return j},KX:function(){return a},T8:function(){return s},Xn:function(){return r},ao:function(){return A},c5:function(){return W},c7:function(){return B}});var R=e(15009),i=e.n(R),E=e(99289),m=e.n(E),h=e(82346);function j(u){return I.apply(this,arguments)}function I(){return I=m()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/app/image/get-list",{method:"POST",data:D}));case 1:case"end":return n.stop()}},u)})),I.apply(this,arguments)}function M(u){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function u(D){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,request("/api/app/log/image-build",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),P.apply(this,arguments)}function r(u){return L.apply(this,arguments)}function L(){return L=m()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/app/image/get-list-build",{method:"POST",data:D}));case 1:case"end":return n.stop()}},u)})),L.apply(this,arguments)}function s(u){return v.apply(this,arguments)}function v(){return v=m()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,h.request)("/api/app/image/get-build-task",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),v.apply(this,arguments)}function t(u){return l.apply(this,arguments)}function l(){return l=m()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,h.request)("/api/app/image/delete-build-task",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),l.apply(this,arguments)}function A(u){return f.apply(this,arguments)}function f(){return f=m()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,h.request)("/api/app/image/image-delete",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),f.apply(this,arguments)}function B(){return C.apply(this,arguments)}function C(){return C=m()(i()().mark(function u(){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,h.request)("/api/app/image/image-prune",{method:"POST"});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},u)})),C.apply(this,arguments)}function W(){return O.apply(this,arguments)}function O(){return O=m()(i()().mark(function u(){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,h.request)("/api/app/image/build-prune",{method:"POST"});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},u)})),O.apply(this,arguments)}function g(u){return _.apply(this,arguments)}function _(){return _=m()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,h.request)("/api/app/image/update-title",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),_.apply(this,arguments)}function a(u){return d.apply(this,arguments)}function d(){return d=m()(i()().mark(function u(D){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/app/image/tag-sync",{method:"POST",data:D}));case 1:case"end":return n.stop()}},u)})),d.apply(this,arguments)}},67255:function(y,T,e){e.d(T,{O:function(){return R},j:function(){return i}});function R(){var E=localStorage.getItem("dpanel-pagesize");return E=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(E!=null?E:"20")}}function i(E){var m="dpanel-table-column-".concat(E),h={};if(localStorage.getItem(m)){var j;h=JSON.parse((j=localStorage.getItem(m))!==null&&j!==void 0?j:"{}")}return{defaultValue:h,onChange:function(M){localStorage.setItem("dpanel-table-column-".concat(E),JSON.stringify(M))}}}}}]);
