"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4157],{57716:function(B,M,n){n.d(M,{Z:function(){return o}});var w=n(5574),u=n.n(w),b=n(15009),c=n.n(b),d=n(99289),R=n.n(d),r=n(67294),i=n(184),f=n(38345),a=n(64317),v=n(5966),P=n(62370),_=n(97462),y=n(42075),p=n(89035),S=n(82346),m=n(28036),h=n(85893);function E(l){var s=(0,r.useState)({height:800,width:1024}),t=u()(s,2),D=t[0],e=t[1],F=function(){var H=window.innerWidth,z=window.innerHeight;e({height:z,width:H})};(0,r.useEffect)(function(){window.addEventListener("resize",function(){F()}),F()},[l]);var $=l.query?Object.keys(l.query).map(function(x){if(l.query)return"".concat(x,"=").concat(l.query[x])}):[];return(0,h.jsx)(S.Link,{target:"_blank",to:"/console/"+l.container+"?width=".concat(D.width,"&height=").concat(D.height,"&").concat($.join("&")),children:(0,h.jsx)(m.ZP,{type:"primary",icon:(0,h.jsx)(p.Z,{}),children:l.content})})}var j=n(60335),C=n(5251),O=n(49610),g=(0,r.forwardRef)(function(l,s){(0,r.useImperativeHandle)(s,function(){return{show:function(I,T){return R()(c()().mark(function A(){var K,k,L;return c()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,j.jV)({md5:I});case 2:L=Z.sent,T&&T!=""&&(L.data.info.Config.WorkingDir=T),N(L.data.info),x(!0),(K=t.current)===null||K===void 0||K.resetFields(),(k=t.current)===null||k===void 0||k.setFieldsValue({workDir:L.data.info.Config.WorkingDir});case 8:case"end":return Z.stop()}},A)}))()}}});var t=(0,r.useRef)(),D=(0,r.useRef)(),e=(0,r.useState)(!1),F=u()(e,2),$=F[0],x=F[1],H=(0,r.useState)(),z=u()(H,2),W=z[0],N=z[1];return(0,r.useEffect)(function(){return W&&setTimeout(function(){var U;(U=D.current)===null||U===void 0||U.start(W.Id,{width:"800",height:"".concat(window.innerHeight),cmd:"/bin/sh",workDir:W.Config.WorkingDir})},2e3),function(){var U;(U=D.current)===null||U===void 0||U.close()}},[W,$]),(0,h.jsxs)(i.a,{drawerProps:{forceRender:!0},onFinish:function(){var U=R()(c()().mark(function I(T){var A,K;return c()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(W){L.next=2;break}return L.abrupt("return",!1);case 2:return(A=D.current)===null||A===void 0||A.close(),(K=D.current)===null||K===void 0||K.start(W.Id,{width:"800",height:"".concat(window.innerHeight),cmd:T.entryCmd,workDir:T.workDir}),L.abrupt("return",!1);case 5:case"end":return L.stop()}},I)}));return function(I){return U.apply(this,arguments)}}(),onValuesChange:function(I,T){if(T.entryCmd){var A;(A=t.current)===null||A===void 0||A.submit()}},isKeyPressSubmit:!0,open:$,formRef:t,onOpenChange:function(I){if(x(I),I){var T;(T=D.current)===null||T===void 0||T.fit()}},submitter:!1,title:(0,C.fi)(W?W.Name:"","/")+" \u63A7\u5236\u53F0",children:[(0,h.jsx)(f.Z,{ghost:!0,children:(0,h.jsxs)(y.Z.Compact,{children:[(0,h.jsx)(a.Z,{label:"shell",width:"sm",name:"entryCmd",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,h.jsx)(v.Z,{width:"sm",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",disabled:!0}),(0,h.jsx)(P.Z,{label:" ",children:(0,h.jsx)(_.Z,{name:["entryCmd","workDir"],children:function(I){var T=I.entryCmd;return(!T||T=="")&&(T="/bin/sh"),W&&(0,h.jsx)(E,{container:W.Id,query:{cmd:encodeURIComponent(T),workDir:encodeURIComponent(W.Config.WorkingDir)},content:"\u65B0\u7A97\u53E3\u6253\u5F00"})}})})]})}),$&&(0,h.jsx)(O.Z,{showInDrawer:!0,ref:D})]})}),o=g},80821:function(B,M,n){n.d(M,{Z:function(){return f}});var w=n(5574),u=n.n(w),b=n(24963),c=n(86738),d=n(28036),R=n(83062),r=n(67294),i=n(85893);function f(a){var v=(0,r.useState)(!1),P=u()(v,2),_=P[0],y=P[1],p=(0,r.useContext)(b.Z),S=p.lang,m=p.notice,h=p.message,E=function(){y(!0);var C=a.action();C instanceof Promise?C.then(function(O){if(y(!1),O){typeof a.onSuccess=="function"&&a.onSuccess(O);var g="";a.messageSuccess?typeof a.messageSuccess=="function"?g=a.messageSuccess(O):g=a.messageSuccess.indexOf("notification.")==0?S(a.messageSuccess):a.messageSuccess:g=S("notification.finish"),a.asynced?h.info(g):h.success(g)}}).catch(function(O){y(!1),typeof a.onError=="function"&&a.onError(O)}):y(!1)};return a.confirm?(0,i.jsx)(c.Z,{style:{width:500},title:a.confirmTitle?a.confirmTitle:S("notification.title.tip"),description:typeof a.confirm=="string"&&a.confirm.indexOf("notification.")==0?S(a.confirm):a.confirm,onConfirm:E,okText:"Yes",cancelText:"No",children:(0,i.jsx)(d.ZP,{disabled:a.disabled,icon:a.icon,loading:_,danger:a.danger,type:a.type,children:a.children})}):(0,i.jsx)(R.Z,{title:a.tips,children:(0,i.jsx)(d.ZP,{style:a.ghost?{padding:0,height:"auto"}:{},disabled:a.disabled,icon:a.icon,loading:_,onClick:E,danger:a.danger,type:a.type,children:a.children})})}},49610:function(B,M,n){var w=n(67294),u=n(54964),b=n(52626),c=n(12320),d=n.n(c),R=n(78267),r=n.n(R),i=n(85893),f,a=new c.Terminal(u.a),v=new R.FitAddon,P=(0,w.forwardRef)(function(_,y){var p,S=function(){a.reset(),p&&p.dispose(),f&&(f.close(),f=null)},m=function(){a.reset(),v.fit(),a.focus(),p&&p.dispose(),p=a.onData(function(E){var j={content:{command:E},type:"console"};f&&f.send(JSON.stringify(j))})};return(0,w.useImperativeHandle)(y,function(){return{start:function(E,j){var C=j?Object.keys(j).map(function(O){if(j&&j[O])return"".concat(O,"=").concat(j[O])}):[];f=new WebSocket((0,b.R)("/console/"+E+"?"+C.join("&"))),f.addEventListener("message",function(O){var g=JSON.parse(O.data),o=g.type;if(o=="console:"+E&&(a.write(g.data),g.data.indexOf("exec failed")!=-1)){S();return}}),m()},close:function(){S()},fit:function(){v.fit()}}}),(0,w.useEffect)(function(){return a.loadAddon(v),a.open(document.getElementById("terminal-container-console")),v.fit(),function(){S()}},[]),(0,i.jsx)("div",{style:{height:_.showInDrawer?"75vh":"100vh"},id:"terminal-container-console"})});M.Z=P},54964:function(B,M,n){n.d(M,{a:function(){return P}});var w=n(5574),u=n.n(w),b=n(78267),c=n.n(b),d=n(75458),R=n.n(d),r=n(67294),i=n(12320),f=n.n(i),a=n(89629),v=n(85893),P={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},_=new i.Terminal(P),y=new d.SearchAddon,p=new b.FitAddon,S=(0,r.forwardRef)(function(m,h){var E,j=(0,r.useState)(!0),C=u()(j,2),O=C[0],g=C[1];return(0,r.useEffect)(function(){return window.addEventListener("resize",function(){m.showInModal||p.fit()}),m.style&&m.style.fontSize&&(_.options.fontSize=m.style.fontSize),_.loadAddon(p),_.loadAddon(y),_.open(document.getElementById(m.id?m.id:"terminal-container")),m.showInModal||p.fit(),function(){_.reset(),g(!0)}},[]),(0,r.useImperativeHandle)(h,function(){return{write:function(l){O&&(p.fit(),g(!1)),_.write(l)},clear:function(){_.clear()},getTerminal:function(){return _},findNext:function(l){y.findNext(l)},findPrev:function(l){y.findPrevious(l)},fit:function(){p.fit()},onData:function(l){return _.onData(l)}}}),(0,v.jsx)("div",{id:m.id?m.id:"terminal-container",style:{width:m.width?m.width:"100%",height:m.height?m.height:"500px",marginTop:(E=m.style)===null||E===void 0?void 0:E.marginTop}})});M.Z=S},24963:function(B,M,n){var w=n(67294),u=(0,w.createContext)({});M.Z=u},28031:function(B,M,n){n.d(M,{C4:function(){return h},LK:function(){return S},OQ:function(){return j},V9:function(){return R},Yx:function(){return P},ZU:function(){return a},_U:function(){return i},gb:function(){return y},lE:function(){return o},vp:function(){return O}});var w=n(15009),u=n.n(w),b=n(99289),c=n.n(b),d=n(82346);function R(s){return r.apply(this,arguments)}function r(){return r=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/get-path-list",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),r.apply(this,arguments)}function i(s){return f.apply(this,arguments)}function f(){return f=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/export",{data:t,method:"POST",responseType:"blob"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),f.apply(this,arguments)}function a(s){return v.apply(this,arguments)}function v(){return v=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/import",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),v.apply(this,arguments)}function P(s){return _.apply(this,arguments)}function _(){return _=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/delete",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),_.apply(this,arguments)}function y(s){return p.apply(this,arguments)}function p(){return p=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/unzip",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),p.apply(this,arguments)}function S(s){return m.apply(this,arguments)}function m(){return m=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/get-content",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),m.apply(this,arguments)}function h(s){return E.apply(this,arguments)}function E(){return E=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/import-file-content",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),E.apply(this,arguments)}function j(s){return C.apply(this,arguments)}function C(){return C=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/chmod",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),C.apply(this,arguments)}function O(s){return g.apply(this,arguments)}function g(){return g=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/volume/backup",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),g.apply(this,arguments)}function o(s){return l.apply(this,arguments)}function l(){return l=c()(u()().mark(function s(t){return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.request)("/api/app/explorer/get-passwd",{data:t,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},s)})),l.apply(this,arguments)}},60335:function(B,M,n){n.d(M,{IE:function(){return i},IW:function(){return R},KK:function(){return y},LJ:function(){return S},RF:function(){return j},Re:function(){return h},aF:function(){return O},eE:function(){return P},jV:function(){return a}});var w=n(15009),u=n.n(w),b=n(99289),c=n.n(b),d=n(82346);function R(o){return r.apply(this,arguments)}function r(){return r=c()(u()().mark(function o(l){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/container/status",{method:"POST",data:l}));case 1:case"end":return t.stop()}},o)})),r.apply(this,arguments)}function i(o){return f.apply(this,arguments)}function f(){return f=c()(u()().mark(function o(l){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/container/get-list",{data:l,method:"POST"}));case 1:case"end":return t.stop()}},o)})),f.apply(this,arguments)}function a(o){return v.apply(this,arguments)}function v(){return v=c()(u()().mark(function o(l){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/container/get-detail",{data:l,method:"POST"}));case 1:case"end":return t.stop()}},o)})),v.apply(this,arguments)}function P(o){return _.apply(this,arguments)}function _(){return _=c()(u()().mark(function o(l){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/container/update",{data:l,method:"POST"}));case 1:case"end":return t.stop()}},o)})),_.apply(this,arguments)}function y(){return p.apply(this,arguments)}function p(){return p=c()(u()().mark(function o(){return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,d.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return s.stop()}},o)})),p.apply(this,arguments)}function S(o){return m.apply(this,arguments)}function m(){return m=c()(u()().mark(function o(l){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/container/export",{method:"POST",data:l,responseType:"blob"}));case 1:case"end":return t.stop()}},o)})),m.apply(this,arguments)}function h(o){return E.apply(this,arguments)}function E(){return E=c()(u()().mark(function o(l){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/container/commit",{method:"POST",data:l}));case 1:case"end":return t.stop()}},o)})),E.apply(this,arguments)}function j(o){return C.apply(this,arguments)}function C(){return C=c()(u()().mark(function o(l){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/container/upgrade",{method:"POST",data:l}));case 1:case"end":return t.stop()}},o)})),C.apply(this,arguments)}function O(o){return g.apply(this,arguments)}function g(){return g=c()(u()().mark(function o(l){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/container/copy",{method:"POST",data:l}));case 1:case"end":return t.stop()}},o)})),g.apply(this,arguments)}},5251:function(B,M,n){n.d(M,{FI:function(){return u},NF:function(){return c},ZM:function(){return b},fi:function(){return d}});function w(r){return r.trim()}function u(r){var i="";r<.1*1024?i=r.toFixed(2)+"B":r<.1*1024*1024?i=(r/1024).toFixed(2)+"KB":r<1*1024*1024*1024?i=(r/(1024*1024)).toFixed(2)+"MB":i=(r/(1024*1024*1024)).toFixed(2)+"GB";var f=i+"",a=f.indexOf("."),v=f.substring(a+1,a+3);return v=="00"?f.substring(0,a)+f.substr(a+3,2):i}function b(r){if(r){var i=new Date(r),f=i.getFullYear()+"-",a=(i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1)+"-",v=(i.getDate()<10?"0"+i.getDate():i.getDate())+" ",P=(i.getHours()<10?"0"+i.getHours():i.getHours())+":",_=(i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes())+":",y=i.getSeconds()<10?"0"+i.getSeconds():i.getSeconds();return f+a+v+P+_+y}}function c(r){if(!r||r=="")return"-";var i=new Date(r),f=i.getUTCFullYear(),a=String(i.getUTCMonth()+1).padStart(2,"0"),v=String(i.getUTCDate()).padStart(2,"0"),P=String(i.getUTCHours()).padStart(2,"0"),_=String(i.getUTCMinutes()).padStart(2,"0"),y=String(i.getUTCSeconds()).padStart(2,"0");return"".concat(f,"-").concat(a,"-").concat(v," ").concat(P,":").concat(_,":").concat(y)}function d(r,i){if(!r||r.length===0)return"";if(i.length===0)return r;for(;r.startsWith(i);)r=r.slice(i.length);return r}function R(r,i){if(!r||r.length===0)return"";if(i.length===0)return r;for(;r.endsWith(i);)r=r.slice(0,r.length-i.length);return r}}}]);
