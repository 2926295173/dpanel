"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3917],{80821:function(I,R,e){e.d(R,{Z:function(){return D}});var j=e(5574),l=e.n(j),E=e(24963),d=e(86738),_=e(14726),S=e(83062),A=e(67294),v=e(85893);function D(n){var T=(0,A.useState)(!1),M=l()(T,2),O=M[0],g=M[1],r=(0,A.useContext)(E.Z),Z=r.lang,B=r.notice,u=r.message,m=function(){g(!0),n.action().then(function(t){if(g(!1),typeof n.onSuccess=="function"&&n.onSuccess(t),n.messageSuccess){var C="";typeof n.messageSuccess=="function"?C=n.messageSuccess(t):C=n.messageSuccess,C.indexOf(".")>-1&&(C=Z(C)),n.asynced?u.info(C):u.success(C)}}).catch(function(t){g(!1),typeof n.onError=="function"&&n.onError(t)})};return n.confirm?(0,v.jsx)(d.Z,{style:{width:500},title:n.confirmTitle?n.confirmTitle:Z("notification.title.tip"),description:n.confirm,onConfirm:m,okText:"Yes",cancelText:"No",children:(0,v.jsx)(_.ZP,{disabled:n.disabled,icon:n.icon,loading:O,danger:n.danger,type:n.type,children:n.children})}):(0,v.jsx)(S.Z,{title:n.tips,children:(0,v.jsx)(_.ZP,{disabled:n.disabled,icon:n.icon,loading:O,onClick:m,danger:n.danger,type:n.type,children:n.children})})}},24963:function(I,R,e){var j=e(67294),l=(0,j.createContext)({});R.Z=l},29337:function(I,R,e){e.r(R),e.d(R,{default:function(){return Q}});var j=e(15009),l=e.n(j),E=e(99289),d=e.n(E),_=e(5574),S=e.n(_),A=e(24963),v=e(15078),D=e(184),n=e(5966),T=e(86615),M=e(97462),O=e(14726),g=e(67294),r=e(85893),Z=(0,g.forwardRef)(function(p,L){var $=(0,g.useState)(!1),x=S()($,2),w=x[0],z=x[1],U=(0,g.useRef)(),F=(0,g.useContext)(A.Z),G=F.message,b=F.notice;return(0,g.useImperativeHandle)(L,function(){return{}}),(0,r.jsxs)(D.a,{name:"create",title:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97",open:w,onOpenChange:function(a){z(a)},formRef:U,trigger:(0,r.jsx)(O.ZP,{type:"primary",children:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97"}),onFinish:function(){var f=d()(l()().mark(function a(o){var y,s,h;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,v.ks)({name:o.name,url:o.url,type:o.type});case 2:if(y=c.sent,!(y&&y.data)){c.next=12;break}return c.next=6,(0,v.$c)({name:o.name,title:o.title,type:o.type,url:o.url,apps:y.data.list});case 6:if(s=c.sent,!(s&&s.data)){c.next=12;break}return G.success("\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\u6210\u529F"),p.onFinish&&p.onFinish(),(h=U.current)===null||h===void 0||h.resetFields(),c.abrupt("return",!0);case 12:case"end":return c.stop()}},a)}));return function(a){return f.apply(this,arguments)}}(),children:[(0,r.jsx)(n.Z,{label:"\u540D\u79F0",name:"title",required:!0,rules:[{required:!0}],placeholder:"\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u5E94\u7528\u5546\u5E97"}),(0,r.jsx)(n.Z,{label:"\u6807\u8BC6",name:"name",required:!0,rules:[{required:!0}],placeholder:"\u6307\u5B9A\u5546\u5E97\u6807\u8BC6\uFF0C\u7528\u4E8E\u521B\u5EFA\u5546\u5E97\u6587\u4EF6\u5B58\u50A8\u76EE\u5F55"}),(0,r.jsx)(T.Z.Group,{name:"type",label:"\u5546\u5E97\u7C7B\u578B",valueEnum:{casaos:"casaos \u5E94\u7528\u5546\u5E97","1panel":"1panel \u5E94\u7528\u5546\u5E97"}}),(0,r.jsx)(M.Z,{name:["type"],children:function(a){var o=a.type;if(o=="1panel")return[(0,r.jsx)(n.Z,{label:"\u4ED3\u5E93\u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/1Panel-dev/appstore"},"url")];if(o=="portainer")return(0,r.jsx)(n.Z,{label:"template.json \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/Lissy93/portainer-templates/blob/main/templates.json"});if(o=="casaos")return(0,r.jsx)(n.Z,{label:"zip \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://play.cuse.eu.org/Cp0204-AppStore-Play.zip"})}})]})}),B=Z,u=e(80821),m=e(67255),P=e(43425),t=e(98165),C=e(90078),N=e(10641),W=e(54006),V=e(66309),K=e(42075),J=e(96074),H=e(25593),Y=e(83062);function Q(){var p=(0,g.useRef)(),L=(0,g.useRef)(),$=(0,W.useAccess)(),x=(0,W.useModel)("@@initialState"),w=x.initialState,z=x.loading,U=x.error,F=x.refresh,G=x.setInitialState;return(0,r.jsx)(C._z,{header:{extra:[$.canSeeFounder&&(0,r.jsx)(B,{onFinish:function(){var f,a;!((f=p.current)===null||f===void 0)&&f.reloadAndRest&&((a=p.current)===null||a===void 0||a.reloadAndRest())}},"create")]},children:(0,r.jsx)(N.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,m.O)(),columns:[{title:"\u6807\u8BC6",dataIndex:"name",width:200},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u5730\u5740",width:500,search:!1,render:function(f,a,o,y,s){return(0,r.jsx)("a",{href:a.setting.url,target:"_blank",children:(0,r.jsx)(V.Z,{children:a.setting.url})})}},{title:"\u6700\u540E\u66F4\u65B0",render:function(f,a,o,y,s){return new Date(a.setting.updatedAt*1e3).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(f,a,o,y,s){return(0,r.jsxs)(K.Z,{split:(0,r.jsx)(J.Z,{type:"vertical"}),children:[(0,r.jsx)(H.Z.Link,{onClick:function(){var i;(i=L.current)===null||i===void 0||i.showDetail(a.id)},children:(0,r.jsx)(Y.Z,{title:"\u7BA1\u7406",children:(0,r.jsx)(P.Z,{})})}),(0,r.jsx)(u.Z,{type:"link",icon:(0,r.jsx)(t.Z,{}),action:function(){return(0,v.ks)({id:a.id,name:a.name,url:a.setting.url,type:a.setting.type})},onSuccess:function(){var i,c;return!((i=p.current)===null||i===void 0)&&i.reloadAndRest&&((c=p.current)===null||c===void 0||c.reloadAndRest()),!0},onError:function(){var i,c;return!((i=p.current)===null||i===void 0)&&i.reset&&((c=p.current)===null||c===void 0||c.reset()),!0},messageSuccess:"\u66F4\u65B0\u6210\u529F",children:" "})]})}}],request:function(){var b=d()(l()().mark(function f(a,o,y){var s;return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,v.eO)({name:a.name,title:a.title});case 2:return s=i.sent,F(),i.abrupt("return",{data:s.data.list,success:!0,total:s.data.list.length});case 5:case"end":return i.stop()}},f)}));return function(f,a,o){return b.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:p,tableAlertOptionRender:function(f){var a=f.selectedRowKeys,o=f.selectedRows;return(0,r.jsx)(K.Z,{size:16,children:(0,r.jsx)(u.Z,{danger:!0,type:"primary",action:function(){return(0,v.Me)({id:o.map(function(s){return s.id})})},onSuccess:function(){var s,h;return!((s=p.current)===null||s===void 0)&&s.reloadAndRest&&((h=p.current)===null||h===void 0||h.reloadAndRest()),!0},onError:function(){var s,h;return!((s=p.current)===null||s===void 0)&&s.reset&&((h=p.current)===null||h===void 0||h.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"})})}})})}},15078:function(I,R,e){e.d(R,{$c:function(){return S},Me:function(){return g},eO:function(){return M},ks:function(){return v}});var j=e(15009),l=e.n(j),E=e(99289),d=e.n(E),_=e(54006);function S(u){return A.apply(this,arguments)}function A(){return A=d()(l()().mark(function u(m){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,_.request)("/api/common/store/create",{method:"POST",data:m}));case 1:case"end":return t.stop()}},u)})),A.apply(this,arguments)}function v(u){return D.apply(this,arguments)}function D(){return D=d()(l()().mark(function u(m){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,_.request)("/api/common/store/sync",{method:"POST",data:m}));case 1:case"end":return t.stop()}},u)})),D.apply(this,arguments)}function n(u){return T.apply(this,arguments)}function T(){return T=_asyncToGenerator(_regeneratorRuntime().mark(function u(m){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:m}));case 1:case"end":return t.stop()}},u)})),T.apply(this,arguments)}function M(u){return O.apply(this,arguments)}function O(){return O=d()(l()().mark(function u(m){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,_.request)("/api/common/store/get-list",{method:"POST",data:m}));case 1:case"end":return t.stop()}},u)})),O.apply(this,arguments)}function g(u){return r.apply(this,arguments)}function r(){return r=d()(l()().mark(function u(m){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,_.request)("/api/common/store/delete",{method:"POST",data:m});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},u)})),r.apply(this,arguments)}function Z(u){return B.apply(this,arguments)}function B(){return B=_asyncToGenerator(_regeneratorRuntime().mark(function u(m){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/common/store/logo",{method:"POST",data:m}));case 1:case"end":return t.stop()}},u)})),B.apply(this,arguments)}},67255:function(I,R,e){e.d(R,{O:function(){return j},j:function(){return l}});function j(){var E,d=parseInt((E=localStorage.getItem("dpanel-pagesize"))!==null&&E!==void 0?E:"0");return{showSizeChanger:!0,defaultPageSize:d!=null?d:20}}function l(E){var d="dpanel-table-column-".concat(E),_={};if(localStorage.getItem(d)){var S;_=JSON.parse((S=localStorage.getItem(d))!==null&&S!==void 0?S:"{}")}return{defaultValue:_,onChange:function(v){localStorage.setItem("dpanel-table-column-".concat(E),JSON.stringify(v))}}}}}]);
