"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7499],{80821:function(ne,D,n){n.d(D,{Z:function(){return O}});var w=n(5574),r=n.n(w),W=n(24963),d=n(86738),p=n(14726),K=n(83062),S=n(67294),T=n(85893);function O(o){var C=(0,S.useState)(!1),R=r()(C,2),y=R[0],b=R[1],j=(0,S.useContext)(W.Z),M=j.lang,A=j.notice,u=j.message,m=function(){b(!0),o.action().then(function(a){if(b(!1),typeof o.onSuccess=="function"&&o.onSuccess(a),o.messageSuccess){var P="";typeof o.messageSuccess=="function"?P=o.messageSuccess(a):P=o.messageSuccess,P.indexOf(".")>-1&&(P=M(P)),o.asynced?u.info(P):u.success(P)}}).catch(function(a){b(!1),typeof o.onError=="function"&&o.onError(a)})};return o.confirm?(0,T.jsx)(d.Z,{style:{width:500},title:o.confirmTitle?o.confirmTitle:M("notification.title.tip"),description:o.confirm,onConfirm:m,okText:"Yes",cancelText:"No",children:(0,T.jsx)(p.ZP,{disabled:o.disabled,icon:o.icon,loading:y,danger:o.danger,type:o.type,children:o.children})}):(0,T.jsx)(K.Z,{title:o.tips,children:(0,T.jsx)(p.ZP,{disabled:o.disabled,icon:o.icon,loading:y,onClick:m,danger:o.danger,type:o.type,children:o.children})})}},24963:function(ne,D,n){var w=n(67294),r=(0,w.createContext)({});D.Z=r},43774:function(ne,D,n){n.r(D),n.d(D,{default:function(){return me}});var w=n(5574),r=n.n(w),W=n(24963),d=n(15078),p=n(90078),K=n(97269),S=n(62370),T=n(97462),O=n(38345),o=n(45360),C=n(42075),R=n(65233),y=n(14726),b=n(92398),j=n(2487),M=n(32983),A=n(4393),u=n(67294),m=n(15009),x=n.n(m),a=n(99289),P=n.n(a),V=n(184),Y=n(51652),B=n(71230),Z=n(15746),Q=n(34041),ae=n(29158),X=n(74842),q=n(25593),ee=n(83062),s=n(66309),e=n(85893);function _(i){var $=(0,u.useState)(),I=r()($,2),f=I[0],L=I[1];return(0,u.useEffect)(function(){var z=i.url.substring(0,i.url.indexOf("://"));switch(z){case"image":L((0,e.jsx)("img",{width:i.imageSize?i.imageSize.width:"auto",height:i.imageSize?i.imageSize.height:"auto",src:i.url.replace("image://","/dpanel/static/store/file/")}));break;case"http":case"https":L((0,e.jsx)("img",{width:i.imageSize?i.imageSize.width:"auto",height:i.imageSize?i.imageSize.height:"auto",src:i.url}));break;case"markdown-file":(0,d.yL)({path:i.url.replace("markdown-file://","/dpanel/static/store/file/")}).then(function(k){L((0,e.jsx)(Y.Z,{source:k,style:{padding:5}},"content"))});break;case"markdown":L((0,e.jsx)(Y.Z,{source:i.url.replace("markdown://",""),style:{padding:5}},"content"));break;default:L("")}},[i.url]),(0,e.jsx)(e.Fragment,{children:f})}function t(i){return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(B.Z,{gutter:[10,10],children:[(0,e.jsx)(Z.Z,{span:6,children:(0,e.jsx)(_,{url:i.app.logo,imageSize:i.logoSize})}),(0,e.jsxs)(Z.Z,{span:i.extra?12:18,children:[(0,e.jsx)(B.Z,{children:(0,e.jsx)(Z.Z,{span:24,children:(0,e.jsxs)(C.Z,{direction:"horizontal",children:[(0,e.jsx)(q.Z.Title,{level:5,children:i.app.title}),(0,e.jsx)(q.Z.Text,{children:i.app.name})]})})}),(0,e.jsx)(B.Z,{style:{height:"60px"},children:(0,e.jsx)(Z.Z,{children:(0,e.jsx)(ee.Z,{title:i.app.description,children:(0,e.jsx)(q.Z.Paragraph,{ellipsis:{rows:2},children:i.app.description})})})}),(0,e.jsx)(B.Z,{style:{height:"35px"},children:(0,e.jsx)(Z.Z,{children:(0,e.jsxs)(C.Z,{wrap:!0,children:[i.app.storeName?(0,e.jsx)(s.Z,{color:"blue-inverse",children:i.app.storeName}):"",i.app.tag&&i.app.tag.map(function($,I){return(0,e.jsx)(s.Z,{children:$},I)})]})})})]}),(0,e.jsx)(Z.Z,{span:i.extra?6:0,children:i.extra})]})})}var le=n(80821),ce=n(90098),oe=n(54006),de=(0,u.forwardRef)(function(i,$){var I=(0,u.useState)(!1),f=r()(I,2),L=f[0],z=f[1],k=(0,u.useState)(),se=r()(k,2),h=se[0],re=se[1],F=(0,u.useState)(""),N=r()(F,2),J=N[0],te=N[1],ue=(0,oe.useNavigate)();return(0,u.useImperativeHandle)($,function(){return{show:function(v){z(!0),re(v),te(Object.keys(v.version)[0])}}}),(0,e.jsx)(V.a,{submitter:!1,open:L,onOpenChange:function(v){z(v)},title:"".concat(h==null?void 0:h.name," \u8BE6\u60C5\u4ECB\u7ECD"),children:h&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(O.Z,{ghost:!0,style:{marginBottom:"20px",paddingBottom:"20px",borderBottom:"#eeeeee solid 1px"},children:(0,e.jsx)(t,{app:h,logoSize:{width:"130",height:"130"},extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(B.Z,{gutter:[10,10],children:[(0,e.jsx)(Z.Z,{children:(0,e.jsxs)(C.Z,{wrap:!0,children:[(0,e.jsx)(y.ZP,{href:h.website,target:"_blank",icon:(0,e.jsx)(ae.Z,{}),children:"\u5B98\u7F51"},"website"),(0,e.jsx)(le.Z,{action:P()(x()().mark(function g(){var v,l;return x()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,ce.iE)({storeId:(v=h.storeId)!==null&&v!==void 0?v:0,name:h.name,title:h.title,composeFile:h.version[J].composeFile,environment:h.version[J].environment});case 2:l=E.sent,l&&l.data.id&&ue("/compose/create?id="+l.data.id);case 4:case"end":return E.stop()}},g)})),type:"primary",icon:(0,e.jsx)(X.Z,{}),children:"\u5B89\u88C5"},"install")]})}),(0,e.jsx)(Z.Z,{span:24,children:h.version&&(0,e.jsx)(Q.Z,{style:{width:"100%"},value:J,onChange:function(v){te(v)},options:Object.keys(h.version).map(function(g){return{value:g,label:g}})})})]})})})}),Object.keys(h.version).map(function(g){if(!(J!=g||!h.version[g].environment||h.version[g].environment.length==0)){var v=[{name:"%CONTAINER_DEFAULT_NAME%",value:"-",label:"\u4F7F\u7528 Compose \u9ED8\u8BA4\u5BB9\u5668\u540D\u79F0"}],l=`## DPanel \u9762\u677F\u5185\u7F6E\u53D8\u91CF 
 |\u53D8\u91CF\u540D|\u9ED8\u8BA4\u503C|\u8BF4\u660E| 
 |---|---|---|
`;return v.map(function(c){l+="|".concat(c.name,"|").concat(c.value,"|").concat(c.label,`| 
`)}),l+="## \u7248\u672C\u4FE1\u606F <sup>".concat(g,`</sup> 
 |\u53D8\u91CF\u540D|\u9ED8\u8BA4\u503C|\u8BF4\u660E| 
 |---|---|---|
`),h.version[g].environment.map(function(c){l+="|".concat(c.name,"|").concat(c.value,"|").concat(c.label,`| 
`)}),l+="<br />",(0,e.jsx)(Y.Z,{source:l,style:{padding:5}},g)}}),(0,e.jsx)(_,{url:h==null?void 0:h.content})]})})}),pe=de,G="dpanel-search-result";function me(){var i=(0,u.useRef)(),$=(0,u.useState)(),I=r()($,2),f=I[0],L=I[1],z=(0,u.useContext)(W.Z),k=z.loading,se=z.lang,h=(0,u.useState)(""),re=r()(h,2),F=re[0],N=re[1],J=(0,u.useState)([]),te=r()(J,2),ue=te[0],g=te[1];(0,u.useEffect)(function(){k.show(),(0,d.eO)().then(function(l){l&&l.data&&l.data.list&&l.data.list.push({id:-1,name:G,title:"\u641C\u7D22\u7ED3\u679C",setting:{apps:[]}}),L(Object.fromEntries(l.data.list.map(function(c){return[c.name,c]}))),l.data.list.length>0&&N(l.data.list[0].name)}).finally(function(){k.destroy()})},[]);var v=function(c){var E=[];f&&(Object.keys(f).map(function(H){H!=G&&f[H].setting.apps.map(function(U){if(c&&(U.name.toLowerCase().indexOf(c)!==-1||U.title&&U.title.toLowerCase().indexOf(c)!==-1)){var ie=JSON.parse(JSON.stringify(U));ie.storeName="".concat(f[H].title),ie.storeId=f[H].id,E.push(ie)}})}),E.length>0?(g(E),N(G)):(o.ZP.error("\u672A\u80FD\u627E\u5230\u5305\u542B\u5173\u952E\u5B57\u7684\u5E94\u7528"),N(Object.keys(f)[0]),g([])))};return(0,e.jsxs)(p._z,{extra:[(0,e.jsx)(K.A,{isKeyPressSubmit:!0,submitter:!1,onFinish:function(c){v(c.search)},children:(0,e.jsxs)(C.Z.Compact,{children:[(0,e.jsx)(S.Z,{style:{margin:0},name:"search",children:(0,e.jsx)(R.Z,{allowClear:!0,addonBefore:"\u5168\u5546\u5E97\u67E5\u8BE2",placeholder:"\u6309\u56DE\u8F66\u67E5\u8BE2\u5E94\u7528",onClear:function(){v("")}})}),(0,e.jsx)(T.Z,{name:["search"],children:function(c){var E=c.search;return(0,e.jsx)(y.ZP,{onClick:function(){v(E)},children:"\u641C\u7D22"})}})]})},"form")],children:[(0,e.jsx)(pe,{ref:i}),(0,e.jsxs)(O.Z,{children:[F!=""&&f&&(0,e.jsx)(b.Z,{activeKey:F,onChange:function(c){g([]),N(c)},items:Object.keys(f).map(function(l){return{label:f[l].title,key:l,disabled:F!=G&&l==G}})}),(0,e.jsx)(j.Z,{locale:{emptyText:(0,e.jsx)(M.Z,{image:M.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(e.Fragment,{children:["\u9762\u677F\u652F\u6301\u591A\u79CD\u7C7B\u578B\u7684\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\uFF0C",(0,e.jsx)(oe.Link,{to:"/system/appstore?op=create",children:"\u8BF7\u5148\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5546\u5E97"})]})})},pagination:{pageSize:36},rowKey:function(c){return"".concat(c.name).concat(c.storeName)},grid:{gutter:10,xs:1,sm:2,md:2,lg:2,xl:2,xxl:3},dataSource:F==G?ue:f&&f[F]&&f[F].setting.apps,renderItem:function(c,E){return(0,e.jsx)(j.Z.Item,{children:(0,e.jsx)(A.Z,{onClick:function(){if(f){var U;c.storeId||(c.storeId=f[F].id),(U=i.current)===null||U===void 0||U.show(c)}},hoverable:!0,children:(0,e.jsx)(t,{app:c,logoSize:{width:"50",height:"50"}})})},E)}})]})]})}},15078:function(ne,D,n){n.d(D,{$c:function(){return K},Me:function(){return b},eO:function(){return R},ks:function(){return T},yL:function(){return M}});var w=n(15009),r=n.n(w),W=n(99289),d=n.n(W),p=n(54006);function K(u){return S.apply(this,arguments)}function S(){return S=d()(r()().mark(function u(m){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,p.request)("/api/common/store/create",{method:"POST",data:m}));case 1:case"end":return a.stop()}},u)})),S.apply(this,arguments)}function T(u){return O.apply(this,arguments)}function O(){return O=d()(r()().mark(function u(m){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,p.request)("/api/common/store/sync",{method:"POST",data:m}));case 1:case"end":return a.stop()}},u)})),O.apply(this,arguments)}function o(u){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function u(m){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:m}));case 1:case"end":return a.stop()}},u)})),C.apply(this,arguments)}function R(u){return y.apply(this,arguments)}function y(){return y=d()(r()().mark(function u(m){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,p.request)("/api/common/store/get-list",{method:"POST",data:m}));case 1:case"end":return a.stop()}},u)})),y.apply(this,arguments)}function b(u){return j.apply(this,arguments)}function j(){return j=d()(r()().mark(function u(m){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,p.request)("/api/common/store/delete",{method:"POST",data:m});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},u)})),j.apply(this,arguments)}function M(u){return A.apply(this,arguments)}function A(){return A=d()(r()().mark(function u(m){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,p.request)(m==null?void 0:m.path,{method:"GET"}));case 1:case"end":return a.stop()}},u)})),A.apply(this,arguments)}},90098:function(ne,D,n){n.d(D,{CT:function(){return R},GG:function(){return x},MG:function(){return Z},Oh:function(){return M},Pn:function(){return o},U_:function(){return Y},VN:function(){return P},iE:function(){return q},ik:function(){return b},im:function(){return K},mg:function(){return u},pm:function(){return T},xC:function(){return ae}});var w=n(15009),r=n.n(w),W=n(99289),d=n.n(W),p=n(54006);function K(s){return S.apply(this,arguments)}function S(){return S=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/create",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),S.apply(this,arguments)}function T(s){return O.apply(this,arguments)}function O(){return O=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/get-list",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),O.apply(this,arguments)}function o(s){return C.apply(this,arguments)}function C(){return C=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/get-task",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),C.apply(this,arguments)}function R(s){return y.apply(this,arguments)}function y(){return y=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/get-detail",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),y.apply(this,arguments)}function b(s){return j.apply(this,arguments)}function j(){return j=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/delete",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),j.apply(this,arguments)}function M(s){return A.apply(this,arguments)}function A(){return A=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/container-deploy",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),A.apply(this,arguments)}function u(s){return m.apply(this,arguments)}function m(){return m=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/container-destroy",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),m.apply(this,arguments)}function x(s){return a.apply(this,arguments)}function a(){return a=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/container-ctrl",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),a.apply(this,arguments)}function P(s){return V.apply(this,arguments)}function V(){return V=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/container-log",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),V.apply(this,arguments)}function Y(s){return B.apply(this,arguments)}function B(){return B=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/container-process-kill",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),B.apply(this,arguments)}function Z(s){return Q.apply(this,arguments)}function Q(){return Q=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/get-from-uri",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),Q.apply(this,arguments)}function ae(s){return X.apply(this,arguments)}function X(){return X=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/compose/parse",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),X.apply(this,arguments)}function q(s){return ee.apply(this,arguments)}function ee(){return ee=d()(r()().mark(function s(e){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/common/store/deploy",{method:"POST",data:e}));case 1:case"end":return t.stop()}},s)})),ee.apply(this,arguments)}}}]);
