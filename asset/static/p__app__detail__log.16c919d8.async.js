"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8615],{1699:function(x,D,e){e.d(D,{u:function(){return M}});var T=e(9783),a=e.n(T),b=e(97857),u=e.n(b),m=e(67294),C=e(82346),E=e(40411),L=e(42075),g=e(85893),M=function(n){var p=(0,C.useAccess)(),P=Array.isArray(n.access)?n.access:[n.access],i,o=n.fallback;return typeof n.children=="function"?(i=n.children(P.reduce(function(h,d){return u()(u()({},h),{},a()({},d,p[d]))},{})),i||(i=o)):P.every(function(h){return p[h]})?i=n.children:i=o,!o&&i&&n.showProTips&&p.canSeeEnableCe&&(i=(0,g.jsx)(E.Z,{offset:n.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:i})),!o&&i&&n.showProRibbonTips&&p.canSeeEnableCe&&(i=(0,g.jsx)(E.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:i})),n.space?(0,g.jsx)(L.Z,u()(u()({},n.space),{},{children:i})):i}},80821:function(x,D,e){e.d(D,{Z:function(){return y}});var T=e(97857),a=e.n(T),b=e(5574),u=e.n(b),m=e(24963),C=e(86738),E=e(28036),L=e(83062),g=e(67294),M=e(85893);function y(n){var p=(0,g.useState)(!1),P=u()(p,2),i=P[0],o=P[1],h=(0,g.useContext)(m.Z),d=h.lang,f=h.message,O=function(){o(!0);var v=n.action();v instanceof Promise?v.then(function(_){if(o(!1),_){typeof n.onSuccess=="function"&&n.onSuccess(_);var t="";n.messageSuccess?typeof n.messageSuccess=="function"?t=n.messageSuccess(_):t=n.messageSuccess.indexOf("notification.")==0?d(n.messageSuccess):n.messageSuccess:t=d("notification.finish"),n.asynced?f.info(t):f.success(t)}}).catch(function(_){o(!1),typeof n.onError=="function"&&n.onError(_)}):o(!1)};return n.confirm?(0,M.jsx)(C.Z,a()(a()({style:{width:500},title:n.confirmTitle?n.confirmTitle:d("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?d(n.confirm):n.confirm,onConfirm:O,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,M.jsx)(E.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&i?void 0:n.icon,loading:i,danger:n.danger,type:n.type,children:n.children})})):(0,M.jsx)(L.Z,{title:n.tips,children:(0,M.jsx)(E.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&i?void 0:n.icon,loading:i,onClick:O,danger:n.danger,type:n.type,children:n.children})})}},81146:function(x,D,e){var T=e(15009),a=e.n(T),b=e(99289),u=e.n(b),m=e(97857),C=e.n(m),E=e(67294),L=e(97269),g=e(62370),M=e(5966),y=e(97462),n=e(82346),p=e(71230),P=e(15746),i=e(34041),o=e(28036),h=e(84567),d=e(42075),f=e(80821),O=e(23430),j=e(93162),v=e.n(j),_=e(12320),t=e.n(_),l=e(78267),r=e.n(l),s=e(75458),Q=e.n(s),z=e(12323),c=e(85893),S=new _.Terminal(C()(C()({},z.Xq),{},{fontSize:12,lineHeight:1.2})),w=new l.FitAddon,Z=new s.SearchAddon,J=(0,E.forwardRef)(function(K,G){(0,E.useImperativeHandle)(G,function(){return{fit:function(){S.clear(),w.fit()},start:function(){return u()(a()().mark(function A(){return a()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,H({lineTotal:500});case 2:case"end":return B.stop()}},A)}))()},close:function(){F.progress.close(K.id)}}});var $=(0,E.useRef)(),F=(0,n.useModel)("subscriber");F.addDataHandler(K.id,function(R){S.write(R.data)});var H=function(){var R=u()(a()().mark(function A(W){return a()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return S.clear(),W.download=!1,I.next=4,K.request(W);case 4:case"end":return I.stop()}},A)}));return function(W){return R.apply(this,arguments)}}();return(0,E.useEffect)(function(){return window.addEventListener("resize",function(){w.fit()}),S.loadAddon(w),S.open(document.getElementById("terminal-container-log")),w.fit(),function(){S.clear(),S.reset(),F.progress.close(K.id)}},[]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(L.A,{submitter:!1,layout:"horizontal",onValuesChange:function(A,W){H({id:K.id,lineTotal:parseInt(W.lineTotal),showTime:W.showTime})},formRef:$,children:(0,c.jsxs)(p.Z,{gutter:[10,0],children:[(0,c.jsx)(P.Z,{span:8,children:(0,c.jsx)(g.Z,{name:"lineTotal",initialValue:"500",label:"\u83B7\u53D6\u65E5\u5FD7\u6761\u6570",children:(0,c.jsxs)(i.Z,{defaultValue:"500",children:[(0,c.jsx)(i.Z.Option,{value:"100",children:"100\u6761\u65E5\u5FD7\u6570\u636E"}),(0,c.jsx)(i.Z.Option,{value:"200",children:"200\u6761\u65E5\u5FD7\u6570\u636E"}),(0,c.jsx)(i.Z.Option,{value:"500",children:"500\u6761\u65E5\u5FD7\u6570\u636E"}),(0,c.jsx)(i.Z.Option,{value:"1000",children:"1000\u6761\u65E5\u5FD7\u6570\u636E"}),(0,c.jsx)(i.Z.Option,{value:"-1",children:"\u5168\u90E8\uFF08\u4E0B\u8F7D\u53EF\u89C1\uFF09"})]})})}),(0,c.jsx)(P.Z,{children:(0,c.jsx)(o.ZP,{onClick:function(){S.clear()},children:"\u6E05\u5C4F"})}),(0,c.jsx)(P.Z,{children:(0,c.jsx)(g.Z,{name:"showTime",valuePropName:"checked",children:(0,c.jsx)(h.Z,{children:"\u663E\u793A\u65F6\u95F4"})})}),(0,c.jsx)(P.Z,{children:(0,c.jsx)(M.Z,{label:"\u67E5\u627E",name:"keywork"})}),(0,c.jsx)(P.Z,{children:(0,c.jsx)(y.Z,{name:["keywork"],children:function(A){var W=A.keywork;return(0,c.jsxs)(d.Z,{size:10,children:[(0,c.jsx)(o.ZP,{onClick:function(){Z.findNext(W)},children:"\u4E0B\u4E00\u4E2A"},"next"),(0,c.jsx)(o.ZP,{onClick:function(){Z.findPrevious(W)},children:"\u4E0A\u4E00\u4E2A"},"prev")]})}})}),(0,c.jsx)(P.Z,{children:(0,c.jsx)(f.Z,{icon:(0,c.jsx)(O.Z,{}),action:u()(a()().mark(function R(){var A,W,B;return a()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!K.download){k.next=5;break}return k.next=3,K.download({lineTotal:parseInt((A=$.current)===null||A===void 0?void 0:A.getFieldValue("lineTotal")),showTime:(W=$.current)===null||W===void 0?void 0:W.getFieldValue("showTime")});case 3:B=k.sent,(0,j.saveAs)(B.data,B.name);case 5:case"end":return k.stop()}},R)})),children:"\u4E0B\u8F7D\u65E5\u5FD7"})})]})}),(0,c.jsx)("div",{style:{marginTop:"20px",height:K.showInDrawer?"75vh":"580px"},id:"terminal-container-log"})]})});D.Z=J},53102:function(x,D,e){e.d(D,{Z:function(){return b}});var T=e(67294),a=e(85893);function b(u){var m=function(E){if(u.check&&u.check(E)){E.preventDefault();return}if(E.target&&E.target.className&&E.target.className.indexOf(u.targetClassName)!==-1){E.preventDefault();return}};return(0,T.useEffect)(function(){return window.addEventListener("wheel",m,{passive:!1}),function(){window.removeEventListener("wheel",m)}},[]),(0,a.jsx)(a.Fragment,{children:u.children})}},12323:function(x,D,e){e.d(D,{Xq:function(){return a},nS:function(){return b}});var T=null,a={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},b=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},24963:function(x,D,e){var T=e(67294),a=(0,T.createContext)({});D.Z=a},50070:function(x,D,e){e.r(D),e.d(D,{AppDetailContext:function(){return d},default:function(){return f}});var T=e(15009),a=e.n(T),b=e(99289),u=e.n(b),m=e(5574),C=e.n(m),E=e(1699),L=e(24963),g=e(13822),M=e(55809),y=e(90078),n=e(82346),p=e(25593),P=e(28036),i=e(50136),o=e(67294),h=e(85893),d=(0,o.createContext)({});function f(){var O,j=(0,o.useContext)(L.Z),v=j.loading,_=(0,n.useParams)(),t=(0,n.useSearchParams)(),l=C()(t,2),r=l[0],s=l[1],Q=(O=r.get("tab"))!==null&&O!==void 0?O:"edit",z=(0,o.useState)("edit"),c=C()(z,2),S=c[0],w=c[1],Z=(0,n.useNavigate)(),J=(0,o.useState)(1),K=C()(J,2),G=K[0],$=K[1],F=[{label:(0,h.jsx)(n.Link,{to:"/app/detail/edit/".concat(_.id,"?tab=edit"),children:"\u5BB9\u5668\u8BE6\u60C5"}),key:"edit"},{label:(0,h.jsx)(n.Link,{to:"/app/detail/network/".concat(_.id,"?tab=network"),children:"\u7F51\u7EDC\u7BA1\u7406"}),key:"network"},{label:(0,h.jsx)(p.Z.Link,{children:"\u6587\u4EF6\u7BA1\u7406"}),key:"file",onClick:function(){Z("/app/detail/file/".concat(_.id,"?tab=file"))}},{label:(0,h.jsx)(p.Z.Link,{children:"\u8FD0\u884C\u65E5\u5FD7"}),key:"log",onClick:function(){Z("/app/detail/log/".concat(_.id,"?tab=log"))}},{label:(0,h.jsx)(p.Z.Link,{children:"\u8FD0\u884C\u72B6\u6001"}),key:"stat",onClick:function(){Z("/app/detail/stat/".concat(_.id,"?tab=stat"))}},{label:"",key:"containerName",icon:(0,h.jsx)(M.Z,{}),disabled:!0}],H=(0,o.useState)(F),R=C()(H,2),A=R[0],W=R[1];(0,o.useEffect)(function(){v.show(),w(Q);var I=function(){var k=u()(a()().mark(function q(){var X,Y,V;return a()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return X=F,U.prev=1,U.next=4,(0,g.jV)({md5:(Y=_.id)!==null&&Y!==void 0?Y:""});case 4:V=U.sent,X.map(function(N){return N.key=="containerName"&&(N.label=V.data.info.Name),(!V.data.info.State.Running||V.data.info.State.Restarting)&&(N.key=="file"||N.key=="stat")&&(N.disabled=!0),N}),W(X),U.next=13;break;case 9:return U.prev=9,U.t0=U.catch(1),Z("/app/list"),U.abrupt("return");case 13:return U.prev=13,v.destroy(),U.finish(13);case 16:case"end":return U.stop()}},q,null,[[1,9,13,16]])}));return function(){return k.apply(this,arguments)}}();I()},[G,_]);var B=function(k){w(k.key)};return(0,h.jsx)(d.Provider,{value:{reload:function(){$(G+1)}},children:(0,h.jsxs)(y._z,{header:{extra:[(0,h.jsx)(E.u,{access:"canSeeContainerListManageCreate",children:(0,h.jsx)(n.Link,{to:"/app/create/image",children:(0,h.jsx)(P.ZP,{type:"primary",children:"\u521B\u5EFA\u5BB9\u5668"})})},"create")]},children:[(0,h.jsx)(i.Z,{mode:"horizontal",onClick:B,selectedKeys:[S],items:A}),(0,h.jsx)(n.Outlet,{})]})})}},2742:function(x,D,e){e.r(D),e.d(D,{default:function(){return P}});var T=e(15009),a=e.n(T),b=e(99289),u=e.n(b),m=e(38345),C=e(82346),E=e(81146),L=e(67294),g=e(50070),M=e(62597),y=e(13822),n=e(53102),p=e(85893);function P(){var i=(0,C.useParams)(),o=(0,L.useRef)(),h=(0,L.useContext)(g.AppDetailContext);return(0,L.useEffect)(function(){return h.reload(),setTimeout(function(){if(i.id){var d,f;(d=o.current)===null||d===void 0||d.start(),(f=o.current)===null||f===void 0||f.fit()}},1e3),function(){var d;(d=o.current)===null||d===void 0||d.close()}},[]),(0,p.jsx)(m.Z,{direction:"column",gutter:[0,10],children:i.id&&(0,p.jsx)(n.Z,{check:function(f){return!!(f&&f.target&&f.target.parentNode.parentNode.className&&f.target.parentNode.parentNode.className.indexOf("xterm")!==-1)},children:(0,p.jsx)(E.Z,{id:"container:log:".concat(i.id),ref:o,request:function(){var d=u()(a()().mark(function f(O){return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,M.Tb)({id:i.id,lineTotal:O.lineTotal,download:O.download,showTime:O.showTime});case 2:case"end":return v.stop()}},f)}));return function(f){return d.apply(this,arguments)}}(),download:function(){var d=u()(a()().mark(function f(O){var j,v,_;return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,M.XH)({id:i.id,lineTotal:O.lineTotal,showTime:O.showTime});case 2:return v=l.sent,l.next=5,(0,y.jV)({md5:(j=i.id)!==null&&j!==void 0?j:""});case 5:return _=l.sent,l.abrupt("return",{data:new Blob([v],{type:"text/plain"}),name:_.data.info.Name.replaceAll("/","")+"_"+new Date().toLocaleDateString()+".log"});case 7:case"end":return l.stop()}},f)}));return function(f){return d.apply(this,arguments)}}()})})})}},13822:function(x,D,e){e.d(D,{IE:function(){return L},IW:function(){return C},KK:function(){return P},LJ:function(){return o},RF:function(){return O},Re:function(){return d},aF:function(){return v},eE:function(){return n},jV:function(){return M}});var T=e(15009),a=e.n(T),b=e(99289),u=e.n(b),m=e(82346);function C(t){return E.apply(this,arguments)}function E(){return E=u()(a()().mark(function t(l){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,m.request)("/api/app/container/status",{method:"POST",data:l}));case 1:case"end":return s.stop()}},t)})),E.apply(this,arguments)}function L(t){return g.apply(this,arguments)}function g(){return g=u()(a()().mark(function t(l){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,m.request)("/api/app/container/get-list",{data:l,method:"POST"}));case 1:case"end":return s.stop()}},t)})),g.apply(this,arguments)}function M(t){return y.apply(this,arguments)}function y(){return y=u()(a()().mark(function t(l){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,m.request)("/api/app/container/get-detail",{data:l,method:"POST"}));case 1:case"end":return s.stop()}},t)})),y.apply(this,arguments)}function n(t){return p.apply(this,arguments)}function p(){return p=u()(a()().mark(function t(l){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,m.request)("/api/app/container/update",{data:l,method:"POST"}));case 1:case"end":return s.stop()}},t)})),p.apply(this,arguments)}function P(){return i.apply(this,arguments)}function i(){return i=u()(a()().mark(function t(){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,m.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return r.stop()}},t)})),i.apply(this,arguments)}function o(t){return h.apply(this,arguments)}function h(){return h=u()(a()().mark(function t(l){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,m.request)("/api/app/container/export",{method:"POST",data:l,responseType:"blob"}));case 1:case"end":return s.stop()}},t)})),h.apply(this,arguments)}function d(t){return f.apply(this,arguments)}function f(){return f=u()(a()().mark(function t(l){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,m.request)("/api/app/container/commit",{method:"POST",data:l}));case 1:case"end":return s.stop()}},t)})),f.apply(this,arguments)}function O(t){return j.apply(this,arguments)}function j(){return j=u()(a()().mark(function t(l){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,m.request)("/api/app/container/upgrade",{method:"POST",data:l}));case 1:case"end":return s.stop()}},t)})),j.apply(this,arguments)}function v(t){return _.apply(this,arguments)}function _(){return _=u()(a()().mark(function t(l){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,m.request)("/api/app/container/copy",{method:"POST",data:l}));case 1:case"end":return s.stop()}},t)})),_.apply(this,arguments)}},62597:function(x,D,e){e.d(D,{$G:function(){return C},Ct:function(){return h},Tb:function(){return y},XH:function(){return p},cl:function(){return g},fp:function(){return L},iE:function(){return i},xb:function(){return f},ze:function(){return j}});var T=e(15009),a=e.n(T),b=e(99289),u=e.n(b),m=e(82346);function C(_){return E.apply(this,arguments)}function E(){return E=u()(a()().mark(function _(t){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,m.request)("/api/app/site/create-by-image",{method:"POST",data:t}));case 1:case"end":return r.stop()}},_)})),E.apply(this,arguments)}var L={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096};function g(_){return M.apply(this,arguments)}function M(){return M=u()(a()().mark(function _(t){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,m.request)("/api/app/site/get-list",{method:"POST",data:t}));case 1:case"end":return r.stop()}},_)})),M.apply(this,arguments)}function y(_){return n.apply(this,arguments)}function n(){return n=u()(a()().mark(function _(t){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.download=!1,r.next=3,(0,m.request)("/api/app/log/run",{method:"POST",data:t});case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}},_)})),n.apply(this,arguments)}function p(_){return P.apply(this,arguments)}function P(){return P=u()(a()().mark(function _(t){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.download=!0,r.next=3,(0,m.request)("/api/app/log/run",{method:"POST",data:t,responseType:"blob"});case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}},_)})),P.apply(this,arguments)}function i(_){return o.apply(this,arguments)}function o(){return o=u()(a()().mark(function _(t){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.id=String(t.id),r.next=3,(0,m.request)("/api/app/site/get-detail",{data:t,method:"POST"});case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}},_)})),o.apply(this,arguments)}function h(_){return d.apply(this,arguments)}function d(){return d=u()(a()().mark(function _(t){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,m.request)("/api/app/container/delete",{method:"POST",data:t}));case 1:case"end":return r.stop()}},_)})),d.apply(this,arguments)}function f(_){return O.apply(this,arguments)}function O(){return O=u()(a()().mark(function _(t){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,m.request)("/api/app/site/delete",{method:"POST",data:t}));case 1:case"end":return r.stop()}},_)})),O.apply(this,arguments)}function j(_){return v.apply(this,arguments)}function v(){return v=u()(a()().mark(function _(t){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,m.request)("/api/app/container/ignore",{method:"POST",data:t}));case 1:case"end":return r.stop()}},_)})),v.apply(this,arguments)}}}]);
