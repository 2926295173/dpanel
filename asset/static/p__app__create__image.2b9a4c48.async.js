"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{28307:function(xe,Q,u){var ae=u(5574),l=u.n(ae),re=u(38345),F=u(97269),f=u(5966),S=u(64317),U=u(62370),b=u(14726),te=u(85265),q=u(42075),E=u(67294),V=u(80821),ie=u(3393),se=u(97961),oe=u(92754),g=u(54006),p=u(85893),W=(0,E.forwardRef)(function(R,Z){var $=(0,E.useState)(!1),ge=l()($,2),le=ge[0],ne=ge[1],Y=(0,E.useRef)(),B=(0,E.useRef)();return(0,E.useImperativeHandle)(Z,function(){return{upgradeImage:function(v){var n;return ne(!0),(n=Y.current)===null||n===void 0||n.setFieldValue("imageUrl",v),(0,ie.Gb)({tag:v,type:"pull"})},setImageName:function(v){var n;ne(!0),(n=Y.current)===null||n===void 0||n.setFieldValue("imageUrl",v)}}}),[(0,p.jsx)(b.ZP,{type:R.buttonType?R.buttonType:"default",onClick:function(){var v,n;R.onClick&&R.onClick(),ne(!0),(v=Y.current)===null||v===void 0||v.resetFields(),(n=B.current)===null||n===void 0||n.setStart("")},children:"\u62C9\u53D6\u955C\u50CF"},"remoteBtn"),(0,p.jsxs)(te.Z,{forceRender:!0,open:le,title:"\u4E0B\u8F7D\u8FDC\u7A0B\u955C\u50CF",width:800,onClose:function(){return ne(!1)},footer:!1,children:[(0,p.jsx)(re.Z,{children:(0,p.jsxs)(q.Z,{direction:"vertical",size:"middle",children:[(0,p.jsxs)("div",{children:["1\u3001\u955C\u50CF\u540D\u79F0\u4E2D\u4E0D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C \u9ED8\u8BA4\u4ECE ",(0,p.jsx)("a",{href:"https://hub.docker.com/",target:"_blank",children:"docker hub"})," \u4E2D\u4E0B\u8F7D\uFF0C \u4F60\u53EF\u4EE5\u5728\u4E0A\u9762",(0,p.jsx)("a",{href:"https://hub.docker.com/search?q=",target:"_blank",children:"\u3010\u67E5\u627E\u3011"}),"\u9700\u8981\u7684\u955C\u50CF"]}),(0,p.jsxs)("div",{children:["2\u3001\u955C\u50CF\u4E2D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C\u8BF7\u786E",(0,p.jsx)(g.Link,{to:"/image/registry",children:"\u3010\u6DFB\u52A0\u3011"}),"\u8FC7\u8BE5\u4ED3\u5E93\uFF0C\u5E76\u6709 Pull \u6743\u9650"]}),(0,p.jsxs)("div",{children:["3\u3001\u53EF\u5728",(0,p.jsx)(g.Link,{to:"/image/registry",children:"\u3010\u4ED3\u5E93\u7BA1\u7406\u3011"}),"\u4E2D\u914D\u7F6E\u955C\u50CF\u7684\u52A0\u901F\u5730\u5740"]})]})}),(0,p.jsx)(re.Z,{title:"\u4E0B\u8F7D\u955C\u50CF",headerBordered:!0,children:(0,p.jsxs)(F.A,{submitter:!1,formRef:Y,children:[(0,p.jsxs)(q.Z.Compact,{children:[(0,p.jsx)(f.Z,{width:400,name:"imageUrl",placeholder:"\u8BF7\u8F93\u5165\u955C\u50CF\u5730\u5740"}),(0,p.jsx)(S.Z,{name:"platform",style:{width:150},placeholder:"\u9ED8\u8BA4\u5F53\u524D\u67B6\u6784",options:se.ii.map(function(D){return{label:D.name,value:D.name}})}),(0,p.jsx)(V.Z,{action:function(){var v,n,je,Ee,De,Ie=(v=(n=Y.current)===null||n===void 0?void 0:n.getFieldValue("imageUrl"))!==null&&v!==void 0?v:"";return(je=B.current)===null||je===void 0||je.setStart(Ie),(0,ie.Gb)({tag:Ie,type:"pull",platform:(Ee=(De=Y.current)===null||De===void 0?void 0:De.getFieldValue("platform"))!==null&&Ee!==void 0?Ee:""})},onSuccess:function(v){var n;(n=B.current)===null||n===void 0||n.setFinish(),ne(!1),R.onFinish&&R.onFinish(v.data.tag)},messageSuccess:function(v){var n="\u62C9\u53D6\u6210\u529F";return v.data.proxyUrl&&(n+="\uFF0C\u4F7F\u7528\u4EE3\u7406 "+v.data.proxyUrl),n},children:"\u62C9\u53D6\u955C\u50CF"})]}),(0,p.jsx)(U.Z,{label:"\u4E0B\u8F7D\u8FDB\u5EA6",children:(0,p.jsx)(oe.Z,{ref:B})})]})})]},"remoteDrawer")]});Q.Z=W},35880:function(xe,Q,u){var ae=u(67294),l=(0,ae.createContext)({});Q.Z=l},58012:function(xe,Q,u){u.r(Q),u.d(Q,{default:function(){return Eu}});var ae=u(15009),l=u.n(ae),re=u(99289),F=u.n(re),f=u(5574),S=u.n(f),U=u(90078),b=u(38345),te=u(97269),q=u(2236),E=u(5966),V=u(97462),ie=u(64218),se=u(92398),oe=u(38925),g=u(67294),p=u(35880),W=u(10641),R=u(62370),Z=u(85576),$=u(42075),ge=u(96074),le=u(25593),ne=u(83062),Y=u(71230),B=u(15746),D=u(14726),v=u(3393),n=u(18148),je=u(5251),Ee=u(64789),De=u(75162),Ie=u(23430),He=u(28307),_e=u(78451),We=u(99861),e=u(85893);function $e(i){var I=(0,g.useState)(!1),x=S()(I,2),o=x[0],c=x[1],C=(0,g.useRef)(),r=(0,g.useContext)(p.Z),d=r.createFormRef,A=r.volumeListRef,j=r.createEnvRef,s=r.domainRef,m=(0,g.useRef)(),w=function(){var P=F()(l()().mark(function y(h){var T,M,H,k,K,X,N,Be,J,ee,ve,z;return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c(!1),a.next=3,(0,v.YU)({md5:h});case 3:k=a.sent,i.redeploy||(Be=(K=d.current)===null||K===void 0?void 0:K.getFieldsValue(),(X=d.current)===null||X===void 0||X.resetFields(),(N=d.current)===null||N===void 0||N.setFieldsValue({siteName:Be.siteName,siteTitle:Be.siteTitle})),k.data.info.Config.Env&&k.data.info.Config.Env.map(function(t){var G,ue=t.split("=");(G=j.current)===null||G===void 0||G.addEnvItem(ue[0],ue.slice(1).join("="))}),(T=d.current)===null||T===void 0||T.setFieldValue("imageName",h),(M=d.current)===null||M===void 0||M.setFieldValue("workDir",k.data.info.Config.WorkingDir),(H=s.current)===null||H===void 0||H.setExposePort(k.data.info.Config.ExposedPorts),i.redeploy||(k.data.info.Config.Volumes?(ve=[],Object.keys(k.data.info.Config.Volumes).map(function(t,G){ve.push(t)}),(ee=A.current)===null||ee===void 0||ee.setDefaultDestPath(ve)):(z=A.current)===null||z===void 0||z.setDefaultDestPath([]),(J=d.current)===null||J===void 0||J.setFieldsValue({workDir:{value:"",useDefault:!0,default:k.data.info.Config.WorkingDir},user:{value:"",useDefault:!0,default:k.data.info.Config.User},command:{value:"",useDefault:!0,default:k.data.info.Config.Cmd&&k.data.info.Config.Cmd.join(" ")},entrypoint:{value:"",useDefault:!0,default:k.data.info.Config.Entrypoint&&k.data.info.Config.Entrypoint.join(" ")}}));case 10:case"end":return a.stop()}},y)}));return function(h){return P.apply(this,arguments)}}();return(0,g.useEffect)(function(){i.fromImageId&&w(i.fromImageId)},[i.fromImageId]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Z.Z,{open:o,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return c(!1)},children:(0,e.jsx)(W.Z,{scroll:{x:"max-content"},columns:[{title:"Id",dataIndex:"Id",search:!1,width:200,render:function(y,h,T,M,H){return(0,e.jsx)(_e.Z,{content:h.Id})}},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",width:200,render:function(y,h,T,M){return(0,e.jsx)(_e.Z,{content:h.RepoTags[0]})}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(y,h,T,M){return(0,e.jsx)("div",{children:(0,je.ZM)(h.Created*1e3)},h.Id)},sorter:function(y,h){return y.Created-h.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:80,render:function(y,h,T,M){return(0,e.jsxs)($.Z,{split:(0,e.jsx)(ge.Z,{type:"vertical"}),children:[(0,e.jsx)(le.Z.Link,{onClick:F()(l()().mark(function H(){return l()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",w(h.RepoTags[0]));case 1:case"end":return K.stop()}},H)})),children:(0,e.jsx)(ne.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(Ee.Z,{})})},"addImage"),(0,e.jsx)(le.Z.Link,{onClick:F()(l()().mark(function H(){var k;return l()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:h.RepoTags[0]&&((k=m.current)===null||k===void 0||k.setImageName(h.RepoTags[0]));case 1:case"end":return X.stop()}},H)})),children:(0,e.jsx)(ne.Z,{title:"\u66F4\u65B0\u955C\u50CF",children:(0,e.jsx)(De.Z,{})})},"updateImage")]})}}],request:function(){var P=F()(l()().mark(function y(h,T,M){var H,k,K,X,N;return l()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return i.redeploy&&(k=(H=d.current)===null||H===void 0?void 0:H.getFieldValue("imageName"),h.tag=k?k.split(":")[0]:h.tag),J.next=3,(0,n.KG)({tag:h.tag});case 3:return K=J.sent,X=0,N=[],K.data.list&&(N=K.data.list.flatMap(function(ee){return ee.RepoTags.map(function(ve){return{Key:X++,Id:ee.Id,Created:ee.Created,RepoTags:[ve]}})})),J.abrupt("return",{data:N,success:!0,total:N.length});case 8:case"end":return J.stop()}},y)}));return function(y,h,T){return P.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(He.Z,{onClick:function(){c(!1)},buttonType:"primary",ref:m,onFinish:function(h){w(h)}},"remote")]},formRef:C,rowKey:"Key",pagination:{pageSize:5}})},"imageTableList"),(0,e.jsxs)(Y.Z,{children:[(0,e.jsx)(B.Z,{span:14,children:(0,e.jsx)(E.Z,{label:"\u955C\u50CF",tooltip:i.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0})}),(0,e.jsx)(B.Z,{children:(0,e.jsx)(R.Z,{label:" ",children:(0,e.jsxs)($.Z,{children:[(0,e.jsx)(D.ZP,{type:"primary",onClick:function(){return c(!0)},children:i.redeploy?"\u66F4\u65B0\u955C\u50CF":"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(V.Z,{name:["imageName"],children:function(y){var h=y.imageName;if(i.redeploy)return(0,e.jsx)(We.Z,{image:[h],trigger:(0,e.jsx)(ne.Z,{title:"\u5FEB\u901F\u91CD\u65B0\u62C9\u53D6\u955C\u50CF\uFF0C\u66F4\u65B0\u5BB9\u5668",children:(0,e.jsx)(D.ZP,{icon:(0,e.jsx)(Ie.Z,{}),children:"\u66F4\u65B0\u6216\u662F\u62C9\u53D6\u5F53\u524D\u955C\u50CF"})})})}})]})})})]})]})}var be=u(60335),Ke=u(24969),de=u(24739),Ge=u(63434),Fe=u(17186),ze=u(27496),Ye=u(66309);function Xe(i){return(0,e.jsx)(W.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"names",render:function(x,o,c,C){return(0,e.jsx)($.Z,{direction:"vertical",style:{textAlign:"left"},children:o==null?void 0:o.Names.map(function(r){return r})},o.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(x,o,c,C){return o!=null&&o.Ports?(0,e.jsx)($.Z,{direction:"vertical",style:{textAlign:"left"},children:o==null?void 0:o.Ports.map(function(r,d){return(0,e.jsx)(Ye.Z,{color:"#2db7f5",icon:r.PublicPort?(0,e.jsx)(ze.Z,{}):"",children:"".concat(r.PublicPort?r.IP+":"+r.PublicPort+"->":"").concat(r.PrivatePort,"/").concat(r.Type)},d)})},o.Id):(0,e.jsx)(e.Fragment,{})}},{title:"\u8FD0\u884C\u5BB9\u5668",search:!1,render:function(x,o,c,C){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(le.Z.Text,{ellipsis:{tooltip:o.Image},children:o.Image},o.Id)})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(x,o,c,C){return[(0,e.jsx)(D.ZP,{type:"link",onClick:function(){(0,be.jV)({md5:o.Id}).then(function(d){return i.onSelect&&i.onSelect(d.data.info),!0})},children:(0,e.jsx)(Ee.Z,{})},o.Id)]}}],rowKey:"Id",request:function(){var I=F()(l()().mark(function x(o,c,C){return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",new Promise(function(A,j){(0,be.IE)({tag:o.names}).then(function(s){var m={data:s.data.list,success:!0,total:s.data.list.length};A(m)})}));case 1:case"end":return d.stop()}},x)}));return function(x,o,c){return I.apply(this,arguments)}}(),pagination:{pageSize:5}})}var Je=(0,g.forwardRef)(function(i,I){var x=(0,g.useState)(!1),o=S()(x,2),c=o[0],C=o[1],r=(0,g.useRef)(),d=function(s){var m=(0,g.useState)([]),w=S()(m,2),P=w[0],y=w[1];return(0,g.useEffect)(function(){(0,be.jV)({md5:s.name}).then(function(h){var T;return y((T=h.data.info.Config.Env)!==null&&T!==void 0?T:[]),!0})},[]),(0,e.jsxs)(b.Z,{bordered:!0,extra:s.action,style:{marginBottom:10},children:[(0,e.jsx)(b.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(E.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(E.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(Ge.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(b.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)($.Z,{direction:"vertical",children:P&&P.map(function(h,T){return(0,e.jsx)(le.Z.Text,{copyable:{icon:(0,e.jsx)(Ke.Z,{}),onCopy:function(){var H=h.split("=");i.onAddEnv(H[0],H[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:h},style:{width:300},children:h},T)})},"linkEnv")})]})},A=function(s){var m,w,P=!1,y=(m=(w=r.current)===null||w===void 0?void 0:w.getList())!==null&&m!==void 0?m:[];if(y.map(function(T){T.name==s.name&&(P=!0)}),!P){var h;(h=r.current)===null||h===void 0||h.add(s)}};return(0,g.useImperativeHandle)(I,function(){return{setDefaultLink:function(s){s&&s.map(function(m){m.name!=""&&A(m)})}}}),(0,e.jsxs)(b.Z,{title:"\u5173\u8054\u5BB9\u5668",headerBordered:!0,children:[(0,e.jsx)(Fe.u,{name:"links",actionRef:r,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(s,m){return C(!0),!1}},copyIconProps:!1,min:0,itemRender:function(s,m){return(0,e.jsx)(d,{action:s.action,name:m.record.name})}}),(0,e.jsx)(Z.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:1024,footer:!1,open:c,onCancel:function(){return C(!1)},children:(0,e.jsx)(Xe,{onSelect:function(s){A({name:s.Name,alise:s.Config.Hostname,volume:!1}),C(!1)}})})]})}),Qe=Je,qe=u(91058),Se=u(86615),Ae=u(64317),eu=(0,g.forwardRef)(function(i,I){var x=(0,g.useRef)(),o=(0,g.useRef)();return(0,g.useImperativeHandle)(I,function(){return{setDefaultDestPath:function(C){var r,d,A=(r=(d=x.current)===null||d===void 0?void 0:d.getList())!==null&&r!==void 0?r:[];C.length!=0&&C.filter(function(j){return j!=""}).map(function(j){var s=!1;if(A.map(function(w){if(w.dest==j){s=!0;return}}),!s){var m;(m=x.current)===null||m===void 0||m.add({dest:j,permission:"write",inImage:!0,edit:!1})}})},addUserVolumeItem:function(C,r){var d,A=(d=o.current)===null||d===void 0?void 0:d.getList(),j=!1;if(A==null||A.map(function(m){if(m.dest==r){j=!0;return}}),!j){var s;(s=o.current)===null||s===void 0||s.add({host:C,dest:r})}}}}),(0,e.jsxs)(e.Fragment,{children:[i.showDefault&&(0,e.jsx)(b.Z,{title:"\u9ED8\u8BA4\u5B58\u50A8\uFF08Volume\uFF09",subTitle:"\u9ED8\u8BA4\u5B58\u50A8\u4E0E\u7AD9\u70B9\u6807\u8BC6\u4FDD\u6301\u4E00\u81F4",headerBordered:!0,children:(0,e.jsx)(Fe.u,{name:"volumesDefault",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u76EE\u5F55\u5230\u9ED8\u8BA4\u5B58\u50A8"},actionRef:x,copyIconProps:!1,min:0,children:function(C,r,d){var A=d.getCurrentRowData();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(E.Z,{width:"lg",name:"dest",label:"\u5BB9\u5668\u5185\u8DEF\u5F84",required:!0,rules:[{required:!0}],disabled:A.inImage}),(0,e.jsx)(Se.Z.Group,{hidden:!0,name:"inImage",label:"\u955C\u50CF\u5185\u6302\u8F7D",valueEnum:{1:"\u662F",0:"\u5426"}})]})}})}),(0,e.jsx)(b.Z,{title:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u6216\u662F\u5B58\u50A8\u5377",tooltip:"\u6302\u8F7D\u53EF\u4EE5\u662F\u5BBF\u4E3B\u673A\u7684\u76EE\u5F55\u6216\u662F\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u5B58\u50A8\u5377\u540D\uFF08\u81EA\u52A8\u65B0\u5EFA\uFF09\u3002",headerBordered:!0,direction:"column",children:(0,e.jsx)(Fe.u,{actionRef:o,name:"volumes",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u6620\u5C04\u76EE\u5F55"},copyIconProps:!1,min:0,children:(0,e.jsxs)(de.UW,{children:[(0,e.jsxs)($.Z.Compact,{children:[(0,e.jsx)(E.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u3001\u76EE\u5F55\u6216\u5B58\u50A8\u5377",name:"host",width:i.showInDrawer?"sm":"md",required:!0,rules:[{required:!0}]}),(0,e.jsx)(Ae.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(E.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:i.showInDrawer?"sm":"md",required:!0,rules:[{required:!0}],disabled:i.disabledUserVolumeDest})]})})})]})}),uu=eu,tu=u(2831),ce=u(52688),Ve=u(86125),nu=u(44349);function au(i){var I,x=(0,g.useState)(),o=S()(x,2),c=o[0],C=o[1];return(0,g.useEffect)(function(){(0,tu.aF)().then(function(r){return C(r.data.info)})},[]),(0,e.jsxs)(b.Z,{children:[(0,e.jsx)(E.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:"64M",tooltip:"0 \u4E3A\u4F7F\u7528\u9ED8\u8BA464M"}),(0,e.jsx)(R.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Ve.Z,{step:.1,max:c==null?void 0:c.NCPU,marks:{0:"0",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(R.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(Ve.Z,{step:256,max:Math.round(((I=c==null?void 0:c.MemTotal)!==null&&I!==void 0?I:0)/1024/1024),marks:{0:"0",1024:"1G",2048:"2G",3072:"3G",4096:"4G"}})}),(0,e.jsx)(Ae.Z,{label:"\u65E5\u5FD7\u7C7B\u578B",name:["log","driver"],tooltip:"\u9ED8\u8BA4\u4F7F\u7528 json-file \u9A71\u52A8\u7531 docker \u7EDF\u4E00\u7BA1\u7406\u3002\u91C7\u7528 journal \u65F6\u65E5\u5FD7\u5C06\u6765\u5BBF\u4E3B\u673A\u7BA1\u7406",initialValue:"json-file",valueEnum:{"json-file":"json-file",journald:"journal (\u5BBF\u4E3B\u9700\u8981\u5B89\u88C5journal\u670D\u52A1)"}}),(0,e.jsx)(V.Z,{name:["log"],children:function(d){var A=d.log;if(A.driver=="json-file")return(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(E.Z,{label:"\u65E5\u5FD7\u5207\u5272\u5C3A\u5BF8",name:["log","maxSize"],placeholder:"\u4F8B\u5982\uFF1A10k,5M",tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u5207\u5272\u65E5\u5FD7"}),(0,e.jsx)(E.Z,{tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u6E05\u7406\u65E5\u5FD7\u6587\u4EF6",label:"\u4FDD\u7559\u65E5\u5FD7\u6587\u4EF6\u6570",name:["log","maxFile"],placeholder:"\u4F8B\u5982\uFF1A10"})]})}}),(0,e.jsx)(nu.Z,{name:"device",label:"\u5173\u8054\u8BBE\u5907",hideCopyButton:!0,showAddButton:!0,items:[{label:"\u5BBF\u4E3B\u673A\u8DEF\u5F84",name:"host",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"},{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"}]}),(0,e.jsxs)(Y.Z,{children:[(0,e.jsx)(B.Z,{span:4,children:(0,e.jsx)(ce.Z,{label:"\u4F7F\u7528 Gpu",name:["gpus","enable"]})}),(0,e.jsx)(B.Z,{span:20,children:(0,e.jsx)(V.Z,{name:["gpus"],children:function(d){var A=d.gpus;if(A&&A.enable)return(0,e.jsx)(Ae.Z,{mode:"tags",label:"\u8BBE\u5907\u5217\u8868",name:["gpus","device"],placeholder:"\u914D\u7F6E\u4F7F\u7528\u8BBE\u5907id\u6216\u662Fuuid\uFF0C\u4E0D\u586B\u6240\u4E3A\u6240\u6709\u8BBE\u5907"})}})})]}),(0,e.jsx)(V.Z,{name:["gpus"],children:function(d){var A=d.gpus;if(A&&A.enable)return(0,e.jsx)(Ae.Z,{label:"\u8BA1\u7B97\u80FD\u529B",name:["gpus","capabilities"],mode:"multiple",fieldProps:{allowClear:!0},options:[{label:"compute - \u8BA1\u7B97\u80FD\u529B",value:"compute"},{label:"compat32 - \u517C\u5BB932\u4F4D",value:"compat32"},{label:"graphics - \u56FE\u5F62\u5904\u7406\u80FD\u529B",value:"graphics"},{label:"utility - \u76D1\u63A7\u548C\u7BA1\u7406\u80FD\u529B",value:"utility"},{label:"video - \u89C6\u9891\u5904\u7406\u80FD\u529B",value:"video"},{label:"display - \u663E\u793A\u56FE\u5F62\u754C\u9762\u80FD\u529B",value:"display"}]})}})]})}function ru(){return(0,e.jsx)(b.Z,{title:"\u5BB9\u5668\u6807\u7B7E",children:(0,e.jsx)(Fe.u,{name:"label",label:"",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(E.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(E.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var iu=u(44771),Fu="default",Bu="user";function lu(i){return(0,e.jsx)(R.Z,{label:i.label,tooltip:i.tooltip,children:(0,e.jsxs)($.Z.Compact,{block:!0,children:[(0,e.jsx)(Se.Z.Group,{radioType:"button",name:[i.name,"useDefault"],options:[{label:"\u4F7F\u7528\u9ED8\u8BA4",value:!0},{label:"\u81EA\u5B9A\u4E49",value:!1}]}),(0,e.jsx)(V.Z,{name:[i.name],children:function(x){return x[i.name]&&x[i.name].useDefault?(0,e.jsx)(E.Z,{name:[i.name,"default"],disabled:!0,placeholder:"\u672A\u8BBE\u7F6E"}):(0,e.jsx)(E.Z,{name:[i.name,"value"]})}})]})})}var ye=lu,Oe=u(24963);function su(){var i=(0,g.useContext)(Oe.Z),I=i.notice,x=i.lang;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(b.Z,{children:[(0,e.jsx)(iu.Z,{label:"\u91CD\u542F\u7B56\u7565"}),(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(ce.Z,{fieldProps:{onChange:function(c){c&&I.warning(x("app.create.privilegedNotice"))}},name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(ce.Z,{name:"autoRemove",label:"\u505C\u6B62\u540E\u81EA\u52A8\u5220\u9664",initialValue:!1}),(0,e.jsx)(ce.Z,{fieldProps:{onChange:function(c){c&&I.warning(x("app.create.hostPidNotice"))}},name:"hostPid",label:"\u5173\u8054\u5BBF\u4E3B\u673APid",initialValue:!1})]}),(0,e.jsx)(ye,{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55",name:"workDir"}),(0,e.jsx)(ye,{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237",name:"user"}),(0,e.jsx)(ye,{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command"}),(0,e.jsx)(ye,{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4",name:"entrypoint"})]})})}var ou=u(91845),Me=u(62597),Ne=u(54006),du=u(4798),cu=(0,g.forwardRef)(function(i,I){var x=(0,g.useState)(""),o=S()(x,2),c=o[0],C=o[1],r=(0,g.useRef)(),d=(0,g.useContext)(p.Z),A=d.createFormRef;return(0,g.useImperativeHandle)(I,function(){return{setExposePort:function(s){if(s){var m,w,P=(m=(w=r.current)===null||w===void 0?void 0:w.getList())!==null&&m!==void 0?m:[];Object.keys(s).map(function(y){var h=!1;if(P.map(function(M){M.dest==y&&(h=!0)}),!h){var T;(T=r.current)===null||T===void 0||T.add({host:"",dest:y})}})}},setHostname:function(s){C(s)},addPortItem:function(s,m){var w,P=(w=r.current)===null||w===void 0?void 0:w.getList(),y=!1;if(P==null||P.map(function(T){if(T.host==s){y=!0;return}}),!y){var h;(h=r.current)===null||h===void 0||h.add({host:String(s),dest:String(m)})}}}}),(0,e.jsx)(b.Z,{title:"\u7ED1\u5B9A\u7AEF\u53E3",tooltip:"\u8BBF\u95EE\u7AEF\u53E3\u7559\u7A7A\u65F6\u968F\u673A\u751F\u6210\u7AEF\u53E3\uFF0C\u5168\u90E8\u5220\u9664\u5219\u8868\u793A\u4E0D\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,extra:(0,e.jsxs)($.Z,{children:[i.showBindHost&&(0,e.jsx)(ce.Z,{name:"useHostNetwork",fieldProps:{checkedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",unCheckedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",onChange:function(s){if(s){var m;(m=A.current)===null||m===void 0||m.setFieldsValue({bindIpV6:!1,publishAllPorts:!1})}}}}),i.showBindIpV6&&(0,e.jsx)(V.Z,{name:["siteName","useHostNetwork"],children:function(s){var m=s.useHostNetwork;return(0,e.jsx)(ce.Z,{name:"publishAllPorts",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3",unCheckedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3"},disabled:m},"publishAllPorts")}}),i.showBindIpV6&&(0,e.jsx)(V.Z,{name:["siteName","useHostNetwork"],children:function(s){var m=s.useHostNetwork;return(0,e.jsx)(ce.Z,{name:"bindIpV6",fieldProps:{checkedChildren:"IpV6",unCheckedChildren:"IpV6"},disabled:m},"bindIpV6")}})]}),children:(0,e.jsx)(V.Z,{name:["useHostNetwork","bindIpV6","publishAllPorts"],children:function(s){var m=s.useHostNetwork,w=s.bindIpV6,P=s.publishAllPorts;if(!m&&!P)return(0,e.jsx)(Fe.u,{name:"ports",actionRef:r,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(E.Z,{width:i.showInDrawer?"sm":"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u6DFB\u52A0\u8BBF\u95EE\u7AEF\u53E3\u6216\u662F\u521B\u5EFA\u5B8C\u6210\u540E\u5BF9\u5BB9\u5668\u7ED1\u5B9A\u57DF\u540D",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3\uFF0C\u7ED1\u5B9AIpV6\u5FC5\u586B",required:w,rules:[{required:w}]}),(0,e.jsx)(E.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:i.showInDrawer?"sm":"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3",required:!0,rules:[{required:!0}]})]})})}})})}),mu=cu;function fe(i){return(0,e.jsx)("div",{style:{display:i.show?"block":"none"},children:i.children})}function hu(){var i=(0,g.useRef)(),I=function(c){var C,r,d=!1,A=(C=(r=i.current)===null||r===void 0?void 0:r.getList())!==null&&C!==void 0?C:[];if(A.map(function(s){s.name==c.name&&(d=!0)}),!d){var j;(j=i.current)===null||j===void 0||j.add(c)}},x=function(c){var C,r,d=!1,A=(C=(r=i.current)===null||r===void 0?void 0:r.getList())!==null&&C!==void 0?C:[];A.map(function(j,s){if(j.name==c){var m;(m=i.current)===null||m===void 0||m.remove(s)}})};return(0,e.jsx)(b.Z,{title:"\u5173\u8054\u5BBF\u4E3B\u7F51\u7EDC\u4E3B\u673A",tooltip:"\u5BB9\u5668\u5185\u5982\u679C\u9700\u8981\u8BF7\u6C42\u5BBF\u4E3B\u673A\u6240\u5728\u7684\u7F51\u7EDC\u4E2D\u7684\u4E3B\u673A\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6B64\u914D\u7F6E\u5C06Ip\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D",extra:(0,e.jsx)($.Z,{children:(0,e.jsx)(ce.Z,{name:"enableBindHost",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",unCheckedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",onChange:function(c){c?I({name:"host.dpanel.local",value:"host-gateway"}):x("host.dpanel.local")}}})}),children:(0,e.jsx)(Fe.u,{name:"extraHosts",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BBF\u4E3B\u673A\u7F51\u7EDC\u5173\u8054"},actionRef:i,copyIconProps:!1,min:0,children:(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(E.Z,{width:"md",name:"name",label:"Hostname",placeholder:""}),(0,e.jsx)(E.Z,{width:"md",name:"value",label:"ip",placeholder:""})]})})})}var Ze=u(90672),fu=(0,g.forwardRef)(function(i,I){return(0,g.useImperativeHandle)(I,function(){return{}}),(0,e.jsxs)(b.Z,{title:"\u7F51\u7EDC\u914D\u7F6E",children:[(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(E.Z,{label:"\u914D\u7F6E ipV4 \u5730\u5740",name:["ipV4","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u5730\u5740\uFF0C\u4F8B\u5982 192.168.1.5",placeholder:"192.168.1.5"}),(0,e.jsx)(V.Z,{name:["ipV4"],children:function(o){var c=o.ipV4;return(0,e.jsx)(E.Z,{label:"\u914D\u7F6E ipV4 \u5B50\u7F51",name:["ipV4","subnet"],width:"md",required:c&&c.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 192.168.1.0/24",placeholder:"192.168.1.0/24",rules:[{required:c&&c.address}]})}}),(0,e.jsx)(E.Z,{label:"\u914D\u7F6E ipV4 \u7F51\u5173",name:["ipV4","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 192.168.1.1",placeholder:"192.168.1.1"}),(0,e.jsx)(ce.Z,{label:"\u81EA\u5B9A\u4E49ipV6",name:"enableIpV6Address"})]}),(0,e.jsx)(V.Z,{name:["enableIpV6Address"],children:function(o){var c=o.enableIpV6Address;if(c)return(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(E.Z,{label:"\u914D\u7F6E ipV6 \u5730\u5740",name:["ipV6","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u5730\u5740\uFF0C\u4F8B\u5982 2001:db8::5",placeholder:"2001:db8::5"}),(0,e.jsx)(V.Z,{name:["ipV6"],children:function(r){var d=r.ipV6;return(0,e.jsx)(E.Z,{label:"\u914D\u7F6E ipV6 \u5B50\u7F51",name:["ipV6","subnet"],width:"md",required:d&&d.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 2001:db8::/48",placeholder:"2001:db8::/48",rules:[{required:d&&d.address}]})}}),(0,e.jsx)(E.Z,{label:"\u914D\u7F6E ipV6 \u7F51\u5173",name:["ipV6","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 2001:db8::1",placeholder:"2001:db8::1"})]})}}),(0,e.jsx)(Ze.Z,{label:"DNS\u914D\u7F6E",name:"dns",placeholder:"\u8BF7\u6307\u5B9Adns\u5730\u5740\uFF0C\u4F8B\u5982\uFF1A8.8.8.8\uFF0C\u4E00\u884C\u6DFB\u4E00\u6761dns\u5730\u5740"})]})}),vu=fu,we=u(31199),pu=u(86250);function gu(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(b.Z,{title:"\u9644\u52A0\u6267\u884C\u811A\u672C",headerBordered:!0,subTitle:"",children:(0,e.jsx)(Ze.Z,{label:"\u5BB9\u5668\u521B\u5EFA\u540E\u6267\u884C\u811A\u672C",name:["hook","containerCreate"],placeholder:"\u5BB9\u5668\u5728\u521B\u5EFA\u540E\u6267\u884C\u7684\u811A\u672C\uFF0C\u6B64\u811A\u672C\u5E76\u4E0D\u4F1A\u5F71\u54CD entrypoint \u53CA command\u3002\u4F8B\u5982\uFF1Als -al && touch abc.txt && apt update"})}),(0,e.jsxs)(b.Z,{title:"\u5065\u5EB7\u68C0\u67E5",headerBordered:!0,children:[(0,e.jsxs)(pu.Z,{gap:20,justify:"start",children:[(0,e.jsx)(we.Z,{label:"\u91CD\u590D\u95F4\u9694\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","interval"],initialValue:30}),(0,e.jsx)(we.Z,{label:"\u8D85\u65F6\u5931\u8D25\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","timeout"],initialValue:10}),(0,e.jsx)(we.Z,{label:"\u5931\u8D25\u91CD\u590D\u6B21\u6570",name:["healthcheck","retries"],initialValue:3}),(0,e.jsx)(Ae.Z,{width:"sm",label:"\u811A\u672C\u6267\u884C\u73AF\u5883",initialValue:"CMD",name:["healthcheck","shellType"],valueEnum:{CMD:"\u5728 Docker \u73AF\u5883\u6267\u884C","CMD-SHELL":"\u5728\u5BB9\u5668\u5185\u6267\u884C"}})]}),(0,e.jsx)(Ze.Z,{label:"\u6267\u884C\u811A\u672C",name:["healthcheck","cmd"],placeholder:"\u914D\u7F6E\u5BB9\u5668\u5065\u5EB7\u68C0\u67E5\u811A\u672C\uFF0C\u4F8B\u5982\uFF1Acurl -f http://localhost:8080/ || exit 1"})]})]})}var Pe="update",Le="copy",Te="new";function Eu(){var i,I,x,o=(0,g.useContext)(Oe.Z),c=o.loading,C=(0,g.useContext)(p.Z),r=C.createFormRef,d=C.volumeListRef,A=C.domainRef,j=C.createEnvRef,s=C.createLinkRef,m=(0,g.useState)(Te),w=S()(m,2),P=w[0],y=w[1],h=(0,Ne.useSearchParams)(),T=S()(h,2),M=T[0],H=T[1],k=(0,Ne.useNavigate)(),K=(0,g.useState)("basic"),X=S()(K,2),N=X[0],Be=X[1],J=parseInt((i=M.get("id"))!==null&&i!==void 0?i:""),ee=(I=M.get("containerId"))!==null&&I!==void 0?I:"",ve=(x=M.get("imageId"))!==null&&x!==void 0?x:"";return(0,g.useEffect)(function(){if(ee||J)c.show(),(0,Me.iE)({md5:ee,id:J}).then(function(){var L=F()(l()().mark(function a(t){var G,ue,_,he,me,Re,ke,Ue;return l()().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(_={info:{},layer:[]},M.get("op")==Le?y(Le):y(Pe),t.data.env.network&&t.data.env.network.map(function(O){return!O.alise&&O.name!="bridge"&&(O.alise=[t.data.siteName+".pod.dpanel.local"]),O}),t.data.env.ports&&t.data.env.ports.map(function(O){return O.host=="0"&&(O.host=""),O}),he=t.data.env.bindIpV6,t.data.containerInfo.Info&&t.data.containerInfo.Info.NetworkSettings.Networks&&Object.keys(t.data.containerInfo.Info.NetworkSettings.Networks).map(function(O){t.data.env.network&&(t.data.env.network=t.data.env.network.map(function(pe){return O==pe.name&&(pe.subnet=t.data.containerInfo.Info.NetworkSettings.Networks[O].IPAddress+"/"+t.data.containerInfo.Info.NetworkSettings.Networks[O].IPPrefixLen),pe})),t.data.containerInfo.Info.NetworkSettings.Networks[O].IPv6Gateway!=""&&(he=!0)}),t.data.env.extraHosts&&t.data.env.extraHosts.map(function(O){if(O.value=="host-gateway"){var pe;(pe=r.current)===null||pe===void 0||pe.setFieldValue("enableBindHost",!0)}}),me=t.data.env.ports,t.data.env.ports&&(me=t.data.env.ports.map(function(O){return O.host=(O.hostIp?O.hostIp+":":"")+O.host,O})),(G=r.current)===null||G===void 0||G.setFieldsValue({imageName:t.data.env.imageName,privileged:t.data.env.privileged,bindIpV6:t.data.env.useHostNetwork?!1:he,useHostNetwork:t.data.env.useHostNetwork,publishAllPorts:t.data.env.useHostNetwork?!1:t.data.env.publishAllPorts,workDir:{value:t.data.env.workDir,useDefault:!t.data.env.workDir,default:_&&_.info.Config&&_.info.Config.WorkingDir},user:{value:t.data.env.user,useDefault:!t.data.env.user,default:_&&_.info.Config&&_.info.Config.User},command:{value:t.data.env.command,useDefault:!t.data.env.command,default:_&&_.info.Config&&_.info.Config.Cmd&&_.info.Config.Cmd.join(" ")},entrypoint:{value:t.data.env.entrypoint,useDefault:!t.data.env.entrypoint,default:_&&_.info.Config&&_.info.Config.Entrypoint&&_.info.Config.Entrypoint.join(" ")},shmsize:(ue=t.data.env.shmsize)!==null&&ue!==void 0?ue:"64M",cpus:t.data.env.cpus,memory:t.data.env.memory,environment:t.data.env.environment,label:t.data.env.label,volumesDefault:t.data.env.volumesDefault,volumes:t.data.env.volumes,ports:me,links:t.data.env.links,network:t.data.env.network,restart:t.data.env.restart,extraHosts:t.data.env.extraHosts,autoRemove:t.data.env.autoRemove,log:t.data.env.log,dns:t.data.env.dns&&t.data.env.dns.join(`
`),ipV4:t.data.env.ipV4,ipV6:t.data.env.ipV6,gpus:t.data.env.gpus,device:t.data.env.device,hook:t.data.env.hook,hostPid:t.data.env.hostPid}),t.data.env.healthcheck&&t.data.env.healthcheck.cmd&&t.data.env.healthcheck.cmd!=""&&((Re=r.current)===null||Re===void 0||Re.setFieldsValue({healthcheck:t.data.env.healthcheck})),M.get("op")==Pe&&((ke=r.current)===null||ke===void 0||ke.setFieldsValue({siteTitle:t.data.siteTitle,siteName:t.data.siteName})),!t.data.env.imageName){Ce.next=17;break}return Ce.next=15,(0,v.YU)({md5:t.data.env.imageName});case 15:Ue=Ce.sent,_=Ue.data;case 17:case"end":return Ce.stop()}},a)}));return function(a){return L.apply(this,arguments)}}()).finally(function(){c.destroy()});else{var z;y(Te),(z=r.current)===null||z===void 0||z.resetFields()}},[M]),(0,e.jsx)(U._z,{children:(0,e.jsx)(b.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(te.A,{submitter:{render:function(L,a){return(0,e.jsx)(q.S,{children:a})}},formRef:r,onFinish:function(){var z=F()(l()().mark(function L(a){var t,G,ue,_;return l()().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return _={siteTitle:a.siteTitle,siteName:a.siteName,imageName:a.imageName,environment:a.environment,links:a.links,ports:a.ports,volumes:a.volumes,volumesDefault:a.volumesDefault,network:a.network,privileged:(t=a.privileged)!==null&&t!==void 0?t:!1,autoRemove:(G=a.autoRemove)!==null&&G!==void 0?G:!1,restart:a.restart,cpus:a.cpus,memory:a.memory,shmsize:(ue=a.shmsize)!==null&&ue!==void 0?ue:0,workDir:a.workDir&&!a.workDir.useDefault?a.workDir.value:"",user:a.user&&!a.user.useDefault?a.user.value:"",command:a.command&&!a.command.useDefault?a.command.value:"",entrypoint:a.entrypoint&&!a.entrypoint.useDefault?a.entrypoint.value:"",useHostNetwork:a.useHostNetwork,bindIpV6:a.bindIpV6,log:a.log,dns:a.dns&&a.dns!=""?a.dns.split(`
`):[],label:a.label,publishAllPorts:a.publishAllPorts,extraHosts:a.extraHosts,ipV4:a.ipV4,ipV6:a.ipV6,device:a.device,gpus:a.gpus,hook:a.hook,hostPid:a.hostPid},a.healthcheck&&a.healthcheck.cmd&&a.healthcheck.cmd!=""&&(_.healthcheck=a.healthcheck),ee&&P==Pe&&(_.containerId=ee),me.next=5,(0,Me.$G)(_);case 5:return k("/app/list"),me.abrupt("return",!0);case 7:case"end":return me.stop()}},L)}));return function(L){return z.apply(this,arguments)}}(),children:[(0,e.jsxs)(b.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(E.Z,{name:"siteTitle",label:"\u7AD9\u70B9\u540D\u79F0",required:!0,rules:[{required:!0}],fieldProps:{onChange:function(L){var a="";if(L.target.value&&P!=Pe){var t,G=(0,ou.N9)(L.target.value.trim(),{toneType:"none",type:"array"});a=G.join(""),(t=r.current)===null||t===void 0||t.setFieldValue("siteName",a)}}},placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(E.Z,{name:"siteName",label:"\u7AD9\u70B9\u6807\u8BC6",tooltip:"\u7AD9\u70B9\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u7AD9\u70B9\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:P==Pe,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)($e,{redeploy:P!=Te,fromImageId:ve})]}),(0,e.jsx)(ie.Z,{offsetTop:50,children:(0,e.jsx)(b.Z,{style:{marginBottom:-20},children:(0,e.jsx)(se.Z,{activeKey:N,onChange:function(L){Be(L),window.scrollTo(0,450)},items:[{label:"\u57FA\u672C\u914D\u7F6E",key:"basic"},{label:"\u5173\u8054\u914D\u7F6E",key:"link"},{label:"\u5B58\u50A8\u914D\u7F6E",key:"storage"},{label:"\u8FD0\u884C\u914D\u7F6E",key:"run-command"},{label:"\u8D44\u6E90\u914D\u7F6E",key:"resource"},{label:"Hook",key:"hook"},{label:"\u5176\u5B83",key:"other"}]})})}),(0,e.jsxs)(fe,{show:N=="basic",children:[(0,e.jsx)(mu,{ref:A,showBindHost:!0,showBindIpV6:!0}),(0,e.jsx)(qe.Z,{showAddButton:!0,showImportButton:!0,showCodeMode:!0,label:"\u73AF\u5883\u53D8\u91CF",ref:j}),(0,e.jsx)(V.Z,{name:["siteName","useHostNetwork"],children:function(L){var a=L.siteName,t=L.useHostNetwork;if(!t)return(0,e.jsx)(vu,{})}})]}),(0,e.jsx)(fe,{show:N=="link",children:(0,e.jsx)(V.Z,{name:["siteName","useHostNetwork"],children:function(L){var a=L.siteName,t=L.useHostNetwork;return t?(0,e.jsx)(oe.Z,{showIcon:!0,description:"\u7ED1\u5B9A\u5230\u5BBF\u4E3B\u673A\u7F51\u7EDC\u65F6\uFF0C\u65E0\u6CD5\u901A\u8FC7 Docker \u5173\u8054\u5176\u5B83\u5BB9\u5668\u3002\u8BF7\u4F7F\u7528\u5BBF\u4E3B\u673A\u5185\u7F51IP\u6216\u662F127.0.0.1\u4E92\u8054\u5BB9\u5668\u66B4\u9732\u7AEF\u53E3\u3002"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Qe,{onAddEnv:function(ue,_){var he;(he=j.current)===null||he===void 0||he.addEnvItem(ue,_)},ref:s}),(0,e.jsx)(du.Z,{siteName:a}),(0,e.jsx)(hu,{})]})}})}),(0,e.jsx)(fe,{show:N=="storage",children:(0,e.jsx)(uu,{showDefault:!0,ref:d})}),(0,e.jsx)(fe,{show:N=="run-command",children:(0,e.jsx)(su,{})}),(0,e.jsx)(fe,{show:N=="resource",children:(0,e.jsx)(au,{})}),(0,e.jsx)(fe,{show:N=="hook",children:(0,e.jsx)(gu,{})}),(0,e.jsx)(fe,{show:N=="other",children:(0,e.jsx)(ru,{})})]},"form")})})}},97961:function(xe,Q,u){u.d(Q,{GH:function(){return E},MF:function(){return oe},_2:function(){return ie},fN:function(){return U},ii:function(){return S},vC:function(){return te}});var ae=u(15009),l=u.n(ae),re=u(99289),F=u.n(re),f=u(54006),S=[{name:"linux/amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"linux/arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"linux/i386",arch:"386",search:[]},{name:"linux/arm/v6",arch:"arm",search:[]},{name:"linux/arm/v7",arch:"arm",search:[]},{name:"linux/arm/v8",arch:"arm64",search:[]},{name:"linux/ppc64le",arch:"ppc64le",search:[]},{name:"linux/riscv64",arch:"riscv64",search:[]}];function U(p){return b.apply(this,arguments)}function b(){return b=F()(l()().mark(function p(W){return l()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,f.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:W}));case 1:case"end":return Z.stop()}},p)})),b.apply(this,arguments)}function te(p){return q.apply(this,arguments)}function q(){return q=F()(l()().mark(function p(W){return l()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,f.request)("/api/app/image/import-by-container-tar",{method:"POST",data:W}));case 1:case"end":return Z.stop()}},p)})),q.apply(this,arguments)}function E(p){return V.apply(this,arguments)}function V(){return V=F()(l()().mark(function p(W){return l()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,f.request)("/api/app/image/import-by-image-tar",{method:"POST",data:W}));case 1:case"end":return Z.stop()}},p)})),V.apply(this,arguments)}function ie(p){return se.apply(this,arguments)}function se(){return se=F()(l()().mark(function p(W){return l()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,f.request)("/api/common/attach/delete",{method:"POST",data:W});case 2:return Z.abrupt("return",Z.sent);case 3:case"end":return Z.stop()}},p)})),se.apply(this,arguments)}function oe(){return g.apply(this,arguments)}function g(){return g=F()(l()().mark(function p(){return l()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,f.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return R.stop()}},p)})),g.apply(this,arguments)}},18148:function(xe,Q,u){u.d(Q,{$q:function(){return se},Fj:function(){return ge},KG:function(){return S},KX:function(){return ne},T8:function(){return V},Xn:function(){return q},ao:function(){return g},c5:function(){return Z},c7:function(){return W}});var ae=u(15009),l=u.n(ae),re=u(99289),F=u.n(re),f=u(54006);function S(B){return U.apply(this,arguments)}function U(){return U=F()(l()().mark(function B(D){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/image/get-list",{method:"POST",data:D}));case 1:case"end":return n.stop()}},B)})),U.apply(this,arguments)}function b(B){return te.apply(this,arguments)}function te(){return te=_asyncToGenerator(_regeneratorRuntime().mark(function B(D){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,request("/api/app/log/image-build",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),te.apply(this,arguments)}function q(B){return E.apply(this,arguments)}function E(){return E=F()(l()().mark(function B(D){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/image/get-list-build",{method:"POST",data:D}));case 1:case"end":return n.stop()}},B)})),E.apply(this,arguments)}function V(B){return ie.apply(this,arguments)}function ie(){return ie=F()(l()().mark(function B(D){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/app/image/get-build-task",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),ie.apply(this,arguments)}function se(B){return oe.apply(this,arguments)}function oe(){return oe=F()(l()().mark(function B(D){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/app/image/delete-build-task",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),oe.apply(this,arguments)}function g(B){return p.apply(this,arguments)}function p(){return p=F()(l()().mark(function B(D){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/app/image/image-delete",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),p.apply(this,arguments)}function W(){return R.apply(this,arguments)}function R(){return R=F()(l()().mark(function B(){return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,f.request)("/api/app/image/image-prune",{method:"POST"});case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},B)})),R.apply(this,arguments)}function Z(){return $.apply(this,arguments)}function $(){return $=F()(l()().mark(function B(){return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,f.request)("/api/app/image/build-prune",{method:"POST"});case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},B)})),$.apply(this,arguments)}function ge(B){return le.apply(this,arguments)}function le(){return le=F()(l()().mark(function B(D){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/app/image/update-title",{method:"POST",data:D});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},B)})),le.apply(this,arguments)}function ne(B){return Y.apply(this,arguments)}function Y(){return Y=F()(l()().mark(function B(D){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/image/tag-sync",{method:"POST",data:D}));case 1:case"end":return n.stop()}},B)})),Y.apply(this,arguments)}},5251:function(xe,Q,u){u.d(Q,{FI:function(){return l},ZM:function(){return re}});function ae(F){return F.trim()}function l(F){var f="";F<.1*1024?f=F.toFixed(2)+"B":F<.1*1024*1024?f=(F/1024).toFixed(2)+"KB":F<1*1024*1024*1024?f=(F/(1024*1024)).toFixed(2)+"MB":f=(F/(1024*1024*1024)).toFixed(2)+"GB";var S=f+"",U=S.indexOf("."),b=S.substring(U+1,U+3);return b=="00"?S.substring(0,U)+S.substr(U+3,2):f}function re(F){if(F){var f=new Date(F),S=f.getFullYear()+"-",U=(f.getMonth()+1<10?"0"+(f.getMonth()+1):f.getMonth()+1)+"-",b=(f.getDate()<10?"0"+f.getDate():f.getDate())+" ",te=(f.getHours()<10?"0"+f.getHours():f.getHours())+":",q=(f.getMinutes()<10?"0"+f.getMinutes():f.getMinutes())+":",E=f.getSeconds()<10?"0"+f.getSeconds():f.getSeconds();return S+U+b+te+q+E}}}}]);
