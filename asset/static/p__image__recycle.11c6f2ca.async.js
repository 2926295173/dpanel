"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4202],{45742:function(Z,M,e){e.d(M,{Z:function(){return D}});var R=e(87462),u=e(67294),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656zM492 400h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zM340 368a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"profile",theme:"outlined"},c=m,E=e(84089),P=function(a,C){return u.createElement(E.Z,(0,R.Z)({},a,{ref:C,icon:c}))},j=u.forwardRef(P),D=j},80821:function(Z,M,e){e.d(M,{Z:function(){return h}});var R=e(5574),u=e.n(R),m=e(24963),c=e(86738),E=e(28036),P=e(83062),j=e(67294),D=e(85893);function h(a){var C=(0,j.useState)(!1),l=u()(C,2),T=l[0],t=l[1],o=(0,j.useContext)(m.Z),A=o.lang,x=o.notice,U=o.message,L=function(){t(!0);var O=a.action();O instanceof Promise?O.then(function(v){if(t(!1),v){typeof a.onSuccess=="function"&&a.onSuccess(v);var _="";a.messageSuccess?typeof a.messageSuccess=="function"?_=a.messageSuccess(v):_=a.messageSuccess.indexOf("notification.")==0?A(a.messageSuccess):a.messageSuccess:_=A("notification.finish"),a.asynced?U.info(_):U.success(_)}}).catch(function(v){t(!1),typeof a.onError=="function"&&a.onError(v)}):t(!1)};return a.confirm?(0,D.jsx)(c.Z,{style:{width:500},title:a.confirmTitle?a.confirmTitle:A("notification.title.tip"),description:typeof a.confirm=="string"&&a.confirm.indexOf("notification.")==0?A(a.confirm):a.confirm,onConfirm:L,okText:"Yes",cancelText:"No",onOpenChange:a.confirmOnOpenChange,children:(0,D.jsx)(E.ZP,{block:a.block,disabled:a.disabled,icon:!a.children&&T?void 0:a.icon,loading:T,danger:a.danger,type:a.type,children:a.children})}):(0,D.jsx)(P.Z,{title:a.tips,children:(0,D.jsx)(E.ZP,{block:a.block,style:a.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:a.disabled,icon:!a.children&&T?void 0:a.icon,loading:T,onClick:L,danger:a.danger,type:a.type,children:a.children})})}},94359:function(Z,M,e){e.d(M,{Z:function(){return T}});var R=e(3089),u=e(98165),m=e(18429),c=e(8751),E=e(14313),P=e(30159),j=e(87740),D=e(50888),h=e(66309),a=e(83062),C=e(82346),l=e(85893);function T(t){var o=(0,l.jsx)(l.Fragment,{});if(t.status=="0"&&(o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(R.Z,{}),color:"default",children:"waiting"})),t.status=="10"&&(o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(u.Z,{spin:!0}),color:"processing",children:"processing"})),t.status=="20"&&(o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(m.Z,{}),color:"error",children:"error"})),t.status=="30"&&(o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(c.Z,{}),color:"success",children:"success"})),t.status=="running"||t.status=="healthy"){var A,x;o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(E.Z,{}),color:"success",children:(A=t.message)!==null&&A!==void 0&&A.showInTag?(x=t.message)===null||x===void 0?void 0:x.content:t.status})}if(t.status=="paused"){var U,L;o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(P.Z,{}),children:(U=t.message)!==null&&U!==void 0&&U.showInTag?(L=t.message)===null||L===void 0?void 0:L.content:t.status})}if(t.status=="waiting"||t.status=="starting"){var W,O;o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(j.Z,{}),children:(W=t.message)!==null&&W!==void 0&&W.showInTag?(O=t.message)===null||O===void 0?void 0:O.content:t.status})}if(t.status=="deploying"){var v,_;o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(D.Z,{}),color:"processing",children:(v=t.message)!==null&&v!==void 0&&v.showInTag?(_=t.message)===null||_===void 0?void 0:_.content:t.status})}if(t.status=="error"){var r,g;o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(m.Z,{}),color:"error",children:(r=t.message)!==null&&r!==void 0&&r.showInTag?(g=t.message)===null||g===void 0?void 0:g.content:t.status})}if(t.status=="exited"||t.status=="dead"||t.status=="removing"||t.status=="restarting"||t.status=="unhealthy"||t.status=="created"){var i,f;o=(0,l.jsx)(h.Z,{icon:(0,l.jsx)(m.Z,{}),color:"warning",children:(i=t.message)!==null&&i!==void 0&&i.showInTag?(f=t.message)===null||f===void 0?void 0:f.content:t.status})}if(t.link)return(0,l.jsx)(C.Link,{to:t.link,children:o});if(t.message){var s,n;return(0,l.jsx)(a.Z,{placement:(s=t.message.placement)!==null&&s!==void 0?s:"top",title:(n=t.message.title)!==null&&n!==void 0?n:t.message.content,children:o})}return o}},74344:function(Z,M,e){var R=e(5574),u=e.n(R),m=e(37476),c=e(38345),E=e(82346),P=e(67294),j=e(40365),D=e(85893),h=(0,P.forwardRef)(function(a,C){(0,P.useImperativeHandle)(C,function(){return{start:function(){for(var _=arguments.length,r=new Array(_),g=0;g<_;g++)r[g]=arguments[g];L(r.join(":")),o(!0)},reset:function(){var _;(_=O.current)===null||_===void 0||_.clear(),o(!1)},show:function(_){var r,g;(r=O.current)===null||r===void 0||r.clear(),(g=O.current)===null||g===void 0||g.write(_),o(!0)}}});var l=(0,P.useState)(!1),T=u()(l,2),t=T[0],o=T[1],A=(0,P.useState)(""),x=u()(A,2),U=x[0],L=x[1],W=(0,E.useModel)("subscriber"),O=(0,P.useRef)();return W.addDataHandler("image:"+U,function(v){var _;(_=O.current)===null||_===void 0||_.write(v.data)}),(0,P.useEffect)(function(){var v;(v=O.current)===null||v===void 0||v.fit()},[]),(0,D.jsx)(m.Y,{modalProps:{forceRender:!0},title:"\u6784\u5EFA\u65E5\u5FD7",submitter:!1,width:1e3,onOpenChange:function(_){if(o(_),_){var r,g;(r=O.current)===null||r===void 0||r.clear(),(g=O.current)===null||g===void 0||g.fit()}},open:t,children:(0,D.jsx)(c.Z,{ghost:!0,children:(0,D.jsx)(j.Z,{showInModal:!0,width:"960px",height:"500px",ref:O})})})});M.Z=h},78451:function(Z,M,e){e.d(M,{Z:function(){return m}});var R=e(67294),u=e(85893);function m(c){return(0,u.jsx)("span",{style:{width:c.width?c.width:"auto",wordBreak:"break-word"},children:c.content})}},52548:function(Z,M,e){e.r(M),e.d(M,{default:function(){return g}});var R=e(15009),u=e.n(R),m=e(99289),c=e.n(m),E=e(90078),P=e(41482),j=e(28036),D=e(42075),h=e(66309),a=e(96074),C=e(83062),l=e(25593),T=e(50136),t=e(82346),o=e(18148),A=e(94359),x=e(43425),U=e(45742),L=e(80821),W=e(67294),O=e(67255),v=e(78451),_=e(74344),r=e(85893);function g(){var i=(0,W.useRef)(),f=(0,W.useRef)();return(0,r.jsxs)(E._z,{header:{extra:[(0,r.jsx)(j.ZP,{type:"primary",children:(0,r.jsx)(t.Link,{to:"/image/create",children:"\u521B\u5EFA\u955C\u50CF"})},"create"),(0,r.jsx)(j.ZP,{children:"\u62C9\u53D6\u955C\u50CF"},"pull")]},children:[(0,r.jsx)(P.Z,{scroll:{x:"max-content"},actionRef:i,rowKey:"id",columns:[{title:"\u540D\u79F0",render:function(n,d,y,B){return(0,r.jsx)(D.Z,{direction:"vertical",style:{textAlign:"left"},children:d.title},d.id)}},{title:"\u6700\u65B0Tag",dataIndex:"tag",search:!1,render:function(n,d,y,B){return d.imageInfo?d.imageInfo.info.Id==""?(0,r.jsx)(h.Z,{children:"none"},"none"):(0,r.jsx)(D.Z,{direction:"vertical",style:{textAlign:"left"},children:d.imageInfo.info.RepoTags.map(function(I,K){return(0,r.jsx)(h.Z,{color:"#2db7f5",children:I},K)})},d.id):(0,r.jsx)(h.Z,{color:"#2db7f5",children:d.tag},d.id)}},{title:"\u955C\u50CFId",search:!1,copyable:!0,width:300,render:function(n,d,y,B,I){return(0,r.jsx)(v.Z,{content:d.imageInfo&&d.imageInfo.info.Id})}},{title:"\u6784\u5EFA\u72B6\u6001",width:150,ellipsis:!0,search:!1,render:function(n,d,y,B){return[(0,r.jsx)("div",{children:(0,r.jsx)(A.Z,{status:d.status},d.id)},d.id)]}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,fixed:"right",render:function(n,d,y,B){return(0,r.jsxs)(D.Z,{split:(0,r.jsx)(a.Z,{type:"vertical"}),children:[(0,r.jsx)(t.Link,{to:"/image/create?id="+d.id,type:"link",children:(0,r.jsx)(C.Z,{title:"\u518D\u6B21\u6784\u5EFA",children:(0,r.jsx)(x.Z,{})})},"rebuild"),(0,r.jsx)(l.Z.Link,{onClick:function(){var K;(K=f.current)===null||K===void 0||K.show(d.message)},children:(0,r.jsx)(C.Z,{title:"\u6784\u5EFA\u65E5\u5FD7",children:(0,r.jsx)(U.Z,{})})},"logs")]})}}],request:function(){var s=c()(u()().mark(function n(d,y,B){var I,K,S;return u()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,(0,o.Xn)({page:(I=d.current)!==null&&I!==void 0?I:1,pageSize:(K=d.pageSize)!==null&&K!==void 0?K:10});case 2:return S=b.sent,b.abrupt("return",{data:S.data.list,success:!0,total:S.data.total});case 4:case"end":return b.stop()}},n)}));return function(n,d,y){return s.apply(this,arguments)}}(),pagination:(0,O.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(n){var d=n.selectedRowKeys;return(0,r.jsx)(D.Z,{size:16,children:(0,r.jsx)(L.Z,{danger:!0,type:"primary",action:function(){return(0,o.$q)({id:d})},onSuccess:function(){var B,I;return!((B=i.current)===null||B===void 0)&&B.reloadAndRest&&((I=i.current)===null||I===void 0||I.reloadAndRest()),!0},onError:function(){var B,I;return!((B=i.current)===null||B===void 0)&&B.reset&&((I=i.current)===null||I===void 0||I.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"})})},tableExtraRender:function(){return(0,r.jsx)(T.Z,{mode:"horizontal",selectedKeys:["build"],items:[{label:(0,r.jsx)(t.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,r.jsx)(t.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})}}),(0,r.jsx)(_.Z,{ref:f})]})}},18148:function(Z,M,e){e.d(M,{$q:function(){return t},Fj:function(){return v},KG:function(){return P},KX:function(){return r},T8:function(){return l},Xn:function(){return a},ao:function(){return A},c5:function(){return W},c7:function(){return U}});var R=e(15009),u=e.n(R),m=e(99289),c=e.n(m),E=e(82346);function P(i){return j.apply(this,arguments)}function j(){return j=c()(u()().mark(function i(f){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/get-list",{method:"POST",data:f}));case 1:case"end":return n.stop()}},i)})),j.apply(this,arguments)}function D(i){return h.apply(this,arguments)}function h(){return h=_asyncToGenerator(_regeneratorRuntime().mark(function i(f){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,request("/api/app/log/image-build",{method:"POST",data:f});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},i)})),h.apply(this,arguments)}function a(i){return C.apply(this,arguments)}function C(){return C=c()(u()().mark(function i(f){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/get-list-build",{method:"POST",data:f}));case 1:case"end":return n.stop()}},i)})),C.apply(this,arguments)}function l(i){return T.apply(this,arguments)}function T(){return T=c()(u()().mark(function i(f){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,E.request)("/api/app/image/get-build-task",{method:"POST",data:f});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},i)})),T.apply(this,arguments)}function t(i){return o.apply(this,arguments)}function o(){return o=c()(u()().mark(function i(f){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,E.request)("/api/app/image/delete-build-task",{method:"POST",data:f});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},i)})),o.apply(this,arguments)}function A(i){return x.apply(this,arguments)}function x(){return x=c()(u()().mark(function i(f){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,E.request)("/api/app/image/image-delete",{method:"POST",data:f});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},i)})),x.apply(this,arguments)}function U(){return L.apply(this,arguments)}function L(){return L=c()(u()().mark(function i(){return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,E.request)("/api/app/image/image-prune",{method:"POST"});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},i)})),L.apply(this,arguments)}function W(){return O.apply(this,arguments)}function O(){return O=c()(u()().mark(function i(){return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,E.request)("/api/app/image/build-prune",{method:"POST"});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},i)})),O.apply(this,arguments)}function v(i){return _.apply(this,arguments)}function _(){return _=c()(u()().mark(function i(f){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,E.request)("/api/app/image/update-title",{method:"POST",data:f});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},i)})),_.apply(this,arguments)}function r(i){return g.apply(this,arguments)}function g(){return g=c()(u()().mark(function i(f){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,E.request)("/api/app/image/tag-sync",{method:"POST",data:f}));case 1:case"end":return n.stop()}},i)})),g.apply(this,arguments)}},67255:function(Z,M,e){e.d(M,{O:function(){return R},j:function(){return u}});function R(){var m=localStorage.getItem("dpanel-pagesize");return m=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(m!=null?m:"20")}}function u(m){var c="dpanel-table-column-".concat(m),E={};if(localStorage.getItem(c)){var P;E=JSON.parse((P=localStorage.getItem(c))!==null&&P!==void 0?P:"{}")}return{defaultValue:E,onChange:function(D){localStorage.setItem("dpanel-table-column-".concat(m),JSON.stringify(D))}}}}}]);
