"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4214],{1699:function(L,A,e){e.d(A,{u:function(){return g}});var T=e(9783),o=e.n(T),F=e(97857),i=e.n(F),x=e(67294),s=e(82346),P=e(40411),b=e(42075),j=e(85893),g=function(c){var O=(0,s.useAccess)(),Z=Array.isArray(c.access)?c.access:[c.access],h,y=c.fallback;return typeof c.children=="function"?(h=c.children(Z.reduce(function(p,E){return i()(i()({},p),{},o()({},E,O[E]))},{})),h||(h=y)):Z.every(function(p){return O[p]})?h=c.children:h=y,!y&&h&&c.showProTips&&O.canSeeEnableCe&&(h=(0,j.jsx)(P.Z,{offset:c.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:h})),!y&&h&&c.showProRibbonTips&&O.canSeeEnableCe&&(h=(0,j.jsx)(P.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:h})),c.space?(0,j.jsx)(b.Z,i()(i()({},c.space),{},{children:h})):h}},34879:function(L,A,e){e.d(A,{Z:function(){return x}});var T=e(97961),o=e(91604),F=e(1677),i=e(85893);function x(s){return s.showDragger?(0,i.jsx)(o.Z,{max:s.max?s.max:1,title:s.title,label:s.label,required:s.required,rules:[{required:s.required}],fieldProps:{multiple:!!(s.max&&s.max>1),name:"file",accept:s.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(b){return new Promise(function(j){var g;(0,T._2)({path:(g=b.response.data.path)!==null&&g!==void 0?g:""}).then(function(B){j(!0)})})}},name:s.name}):(0,i.jsx)(F.Z,{max:s.max?s.max:1,title:s.title,label:s.label,required:s.required,rules:[{required:s.required}],fieldProps:{multiple:!!(s.max&&s.max>1),name:"file",accept:s.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(b){return new Promise(function(j){var g;(0,T._2)({path:(g=b.response.data.path)!==null&&g!==void 0?g:""}).then(function(B){j(!0)})})}},name:s.name})}},92754:function(L,A,e){var T=e(5574),o=e.n(T),F=e(67294),i=e(82346),x=e(38703),s=e(85893),P=(0,F.forwardRef)(function(b,j){var g=(0,F.useState)(""),B=o()(g,2),c=B[0],O=B[1];(0,F.useImperativeHandle)(j,function(){return{setFinish:function(){E({finish:{downloading:100,extracting:100}})},setStart:function(S){S&&O(S),E({start:{downloading:0,extracting:0}})},close:function(){Z.progress.close("image:pull:"+c),E({start:{downloading:0,extracting:0}})}}});var Z=(0,i.useModel)("subscriber");Z.addDataHandler("image:pull:"+c,function(R){E(R.data)});var h=(0,F.useState)(),y=o()(h,2),p=y[0],E=y[1];return(0,F.useEffect)(function(){return E({start:{downloading:0,extracting:0}}),function(){Z.progress.close("image:pull:"+c)}},[]),(0,s.jsx)(s.Fragment,{children:p&&Object.keys(p).map(function(R){return(0,s.jsx)(x.Z,{percent:p[R].downloading,success:{percent:p[R].extracting}},R)})})});A.Z=P},78451:function(L,A,e){e.d(A,{Z:function(){return F}});var T=e(67294),o=e(85893);function F(i){return(0,o.jsx)("span",{style:{width:i.width?i.width:"auto",wordBreak:"break-word"},children:i.content})}},65913:function(L,A,e){var T=e(5574),o=e.n(T),F=e(74330),i=e(67294),x=e(85893),s=(0,i.forwardRef)(function(P,b){(0,i.useImperativeHandle)(b,function(){return{show:function(){c(!0)},destroy:function(){c(!1)}}});var j=(0,i.useState)(!1),g=o()(j,2),B=g[0],c=g[1];return(0,x.jsx)(F.Z,{spinning:B,size:"default",children:P.children})});A.Z=s},17550:function(L,A,e){e.r(A),e.d(A,{default:function(){return xe}});var T=e(19632),o=e.n(T),F=e(15009),i=e.n(F),x=e(99289),s=e.n(x),P=e(5574),b=e.n(P),j=e(90078),g=e(41482),B=e(97269),c=e(62370),O=e(37476),Z=e(5966),h=e(28036),y=e(96074),p=e(25593),E=e(42075),R=e(66309),S=e(83062),W=e(84567),d=e(50136),m=e(67294),I=e(82346),n=e(18148),ee=e(5251),J=e(80821),ae=e(43425),ue=e(64789),se=e(58638),ie=e(1912),le=e(28307),oe=e(96042),te=e(67255),ce=e(24963),de=e(3393),me=e(93162),fe=e(78914),$=e(1699),he=e(184),ve=e(34879),_e=e(44349),ge=e(97961),t=e(85893),pe=(0,m.forwardRef)(function(K,re){(0,m.useImperativeHandle)(re,function(){return{}});var V=(0,m.useRef)();return(0,t.jsxs)(he.a,{title:"\u5BFC\u5165\u955C\u50CF",trigger:(0,t.jsx)(h.ZP,{children:"\u5BFC\u5165\u955C\u50CF"},"create"),formRef:V,onFinish:function(){var k=s()(i()().mark(function N(f){var H,Y;return i()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,(0,ge.GH)({localUrl:f.imageTarUpload?f.imageTarUpload.map(function(w){return w.response.data.path}):[],remoteUrl:f.remoteUrl?f.remoteUrl.map(function(w){return w.url}):[]});case 2:return Y=U.sent,!((H=V.current)===null||H===void 0)&&H.resetFields&&V.current.resetFields(),K.onFinish&&K.onFinish(),U.abrupt("return",!0);case 6:case"end":return U.stop()}},N)}));return function(N){return k.apply(this,arguments)}}(),children:[(0,t.jsx)(ve.Z,{label:"\u672C\u5730\u955C\u50CF",showDragger:!0,max:10,title:"\u5BFC\u5165\u955C\u50CF\u5305, \u6700\u591A\u4E0A\u4F20\u652F\u6301 10 \u4E2A\u3002\uFF08\u53EA\u5141\u8BB8\u4E0A\u4F20 .tar \u6587\u4EF6\uFF0C\u901A\u8FC7\u5BFC\u51FA\u955C\u50CF\u751F\u6210\uFF09",name:"imageTarUpload",accept:".tar"}),(0,t.jsx)(_e.Z,{label:"\u8FDC\u7A0B\u5730\u5740",name:"remoteUrl",showAddButton:!0,hideCopyButton:!0,min:1,items:[{width:"lg",name:"url",placeholder:"\u6307\u5B9A\u8FDC\u7A0B\u5730\u5740 http \u6216\u662F https \u5F00\u5934"}]})]})}),Ee=pe,Fe=e(3616);function xe(){var K=(0,m.useContext)(ce.Z),re=K.message,V=K.notice,k=K.lang,N=(0,I.useAccess)(),f=(0,m.useRef)(),H=(0,m.useState)({force:!1}),Y=b()(H,2),ne=Y[0],U=Y[1],w=(0,m.useRef)(),Q=(0,m.useRef)(),X=(0,m.useRef)();return(0,t.jsxs)(j._z,{header:{extra:[(0,t.jsx)($.u,{access:"canSeeImageListManageCreate",children:(0,t.jsx)(I.Link,{to:"/image/create",children:(0,t.jsx)(h.ZP,{type:"primary",children:"\u521B\u5EFA\u955C\u50CF"},"create")},"create")},"create"),(0,t.jsxs)($.u,{access:"canSeeImageListManageCreate",children:[(0,t.jsx)(y.Z,{type:"vertical"}),(0,t.jsx)(Ee,{onFinish:function(){var l;!((l=f.current)===null||l===void 0)&&l.reloadAndRest&&f.current.reloadAndRest()}})]},"import"),(0,t.jsx)($.u,{access:"canSeeImageListPull",children:(0,t.jsx)(le.Z,{onFinish:function(){var l,r;!((l=f.current)===null||l===void 0)&&l.reloadAndRest&&((r=f.current)===null||r===void 0||r.reloadAndRest())}},"remote")},"remote")]},children:[(0,t.jsx)(fe.Z,{ref:Q,onClose:function(){var l,r;!((l=f.current)===null||l===void 0)&&l.reloadAndRest&&((r=f.current)===null||r===void 0||r.reloadAndRest())}}),(0,t.jsx)(g.Z,{scroll:{x:"max-content"},rowKey:"Id",columns:[{title:"Id",dataIndex:"title",search:!1,render:function(l,r,v,C,a){var u=r.Id.substring(7,19);return r.Title&&(u=r.Title),(0,t.jsx)(p.Z.Link,{onClick:function(){var M;!((M=Q.current)===null||M===void 0)&&M.show&&Q.current.show(r.Id)},children:u},"title-".concat(v))}},{title:"\u540D\u79F0",dataIndex:"tag",render:function(l,r,v,C){return(0,t.jsx)(E.Z,{direction:"vertical",style:{textAlign:"left"},children:r.RepoTags.map(function(a,u){return(0,t.jsxs)(E.Z,{children:[(0,t.jsx)(R.Z,{color:"#2db7f5",children:(0,t.jsx)(p.Z.Text,{copyable:!0,title:a,style:{color:"#ffffff"},children:a},"tag-"+u)},"tag-".concat(u)),r.Containers>0&&(0,t.jsx)(R.Z,{color:"cyan",children:"\u4F7F\u7528\u4E2D"},"use-".concat(u))]},u)})},r.Id)}},{title:"Digest",search:!1,tooltip:"\u8BE5\u955C\u50CF\u5728\u4ED3\u5E93\u4E2D\u7684\u6807\u8BC6\uFF0C\u4E0D\u5305\u542B\u6B64\u503C\u7684\u955C\u50CF\u65E0\u6CD5\u68C0\u6D4B\u66F4\u65B0",render:function(l,r,v,C,a){return(0,t.jsx)(E.Z,{direction:"vertical",children:r.RepoDigests&&r.RepoDigests.map(function(u){return u.substring(u.indexOf("@")+8).substring(0,12)})})}},{title:"\u67B6\u6784",width:80,search:!1,render:function(l,r,v,C,a){if(r.Labels&&r.Labels["com.dpanel.image.arch"])return(0,t.jsx)(R.Z,{children:r.Labels["com.dpanel.image.arch"]},"arch"+r.Id)}},{title:"\u5927\u5C0F",dataIndex:"size",ellipsis:!0,width:"120px",search:!1,sorter:function(l,r){return parseFloat(l.Size)-parseFloat(r.Size)},render:function(l,r,v,C){return(0,t.jsx)("div",{children:(0,ee.FI)(parseFloat(r.Size))},r.Id)}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(l,r,v,C){return(0,t.jsx)("div",{children:(0,ee.ZM)(r.Created*1e3)},r.Id)},sorter:function(l,r){return l.Created-r.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,fixed:"right",hidden:!N.canSeeImageListManage,render:function(l,r,v,C){return(0,t.jsxs)(E.Z,{split:(0,t.jsx)(y.Z,{type:"vertical"}),children:[(0,t.jsx)(p.Z.Link,{onClick:function(){var u;!((u=Q.current)===null||u===void 0)&&u.show&&Q.current.show(r.Id)},children:(0,t.jsx)(S.Z,{title:"\u7BA1\u7406",children:(0,t.jsx)(ae.Z,{})})},"edit"),(0,t.jsx)(I.Link,{to:"/app/create/image?imageId="+r.RepoTags[0],children:(0,t.jsx)(S.Z,{title:"\u521B\u5EFA\u5BB9\u5668",children:(0,t.jsx)(ue.Z,{})})},"create")]})}}],request:function(){var D=s()(i()().mark(function l(r,v,C){var a;return i()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,n.KG)({tag:r.tag,title:r.title,use:r.use?r.use=="1"?1:2:0});case 2:if(a=_.sent,!(!a||!a.data||!a.data.list)){_.next=5;break}return _.abrupt("return",{data:[],success:!0,total:0});case 5:return a.data.list.map(function(M){var z="";M.RepoTags.map(function(q){a.data.title[q]&&(z=a.data.title[q])}),M.Title=z}),_.abrupt("return",{data:a.data.list,success:!0,total:a.data.list.length});case 7:case"end":return _.stop()}},l)}));return function(l,r,v){return D.apply(this,arguments)}}(),pagination:(0,te.O)(),search:{collapsed:!1},rowSelection:N.canSeeImageListManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:f,tableAlertOptionRender:function(l){var r=l.selectedRowKeys,v=l.selectedRows;return(0,t.jsxs)(E.Z,{size:16,children:[(0,t.jsx)(J.Z,{icon:(0,t.jsx)(se.Z,{}),confirm:(0,t.jsxs)(E.Z,{style:{width:500,marginTop:"10px",paddingRight:"10px"},direction:"vertical",size:20,children:[(0,t.jsx)(p.Z.Text,{children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5BFC\u51FA\u955C\u50CF\u540E\u4F1A\u81EA\u52A8\u901A\u8FC7\u6D4F\u89C8\u5668\u4E0B\u8F7D\u81F3\u672C\u5730"}),(0,t.jsx)("li",{children:"\u5F53\u914D\u7F6E\u3010\u5BFC\u51FA\u5230\u9762\u677F\u5BB9\u5668\u76EE\u5F55\u3011\u540E\u5C06\u4FDD\u5B58\u81F3 /dpanel/storage \u76EE\u5F55"}),(0,t.jsx)("li",{children:"\u6D4F\u89C8\u5668\u4E0B\u8F7D\u5931\u8D25\u65F6\uFF0C\u8BF7\u68C0\u67E5\u662F\u5426\u5B89\u88C5\u4E86\u76F8\u5173\u4E0B\u8F7D\u63D2\u4EF6"})]})}),(0,t.jsx)(B.A,{layout:"horizontal",formRef:X,submitter:!1,children:(0,t.jsx)(c.Z,{valuePropName:"checked",name:"enableExportToPath",children:(0,t.jsx)(W.Z,{children:"\u5BFC\u51FA\u5230\u9762\u677F\u5BB9\u5668\u76EE\u5F55"})},"enableExportToPath")})]}),confirmOnOpenChange:function(){var a;!((a=X.current)===null||a===void 0)&&a.resetFields&&X.current.resetFields()},action:function(){var a,u=[];return v.map(function(_){u.push.apply(u,o()(_.RepoTags))}),(0,de.Rb)({md5:u,enableExportToPath:(a=X.current)===null||a===void 0?void 0:a.getFieldValue("enableExportToPath")})},onSuccess:function(a){var u,_=v.map(function(z){return z.RepoTags[0]});if(a.size>29){var M=new Blob([a],{type:"application/tar"});(0,me.saveAs)(M,_.join("-")+".tar")}!((u=f.current)===null||u===void 0)&&u.reset&&f.current.reset()},children:"\u5BFC\u51FA"}),(0,t.jsxs)(O.Y,{modalProps:{width:Fe.ob},formRef:w,title:"\u6279\u91CF\u63A8\u9001\u955C\u50CF",trigger:(0,t.jsx)(h.ZP,{icon:(0,t.jsx)(ie.Z,{}),children:"\u540C\u6B65\u81F3\u5176\u5B83\u4ED3\u5E93"}),onFinish:function(){var C=s()(i()().mark(function a(u){var _,M,z;return i()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,(0,n.KX)({md5:r,registryId:u.registryId,newNamespace:u.newNamespace});case 2:return z=G.sent,(_=f.current)===null||_===void 0||_.reload(),!((M=f.current)===null||M===void 0)&&M.clearSelected&&f.current.clearSelected(),G.abrupt("return",!0);case 6:case"end":return G.stop()}},a)}));return function(a){return C.apply(this,arguments)}}(),children:[(0,t.jsx)(c.Z,{name:"registryId",hidden:!0}),(0,t.jsx)(c.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,t.jsxs)(t.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,t.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,t.jsx)(oe.Z,{multiple:!0,top:!0,onChangeList:function(a){var u;(u=w.current)===null||u===void 0||u.setFieldValue("registryId",a.map(function(_){return _.id}))}})}),(0,t.jsx)(Z.Z,{tooltip:"\u53EF\u4EE5\u901A\u8FC7\u6B64\u9879\u91CD\u65B0\u5B9A\u4E49\u547D\u540D\u7A7A\u95F4\uFF0Cdocker hub \u4E0D\u53D7\u8BE5\u914D\u7F6E\u7684\u5F71\u54CD\u3002 \u914D\u7F6E\u6B64\u9879\u540E mysql:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/mysql:latest\uFF0C dpanel/dpanel:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/dpanel:latest",label:"\u91CD\u5199\u4ED3\u5E93\u547D\u540D\u7A7A\u95F4",name:"newNamespace"})]}),(0,t.jsx)($.u,{access:"canSeeImageListManageDelete",children:(0,t.jsx)(J.Z,{danger:!0,type:"primary",action:function(){return(0,n.ao)({md5:r,force:ne.force})},onSuccess:function(){var a,u;return!((a=f.current)===null||a===void 0)&&a.reloadAndRest&&((u=f.current)===null||u===void 0||u.reloadAndRest()),!0},onError:function(){var a,u;return!((a=f.current)===null||a===void 0)&&a.reset&&((u=f.current)===null||u===void 0||u.reset()),!0},confirm:(0,t.jsxs)(E.Z,{style:{width:280},direction:"vertical",children:[(0,t.jsx)(p.Z.Text,{children:k("notification.confirm.title")}),(0,t.jsx)(W.Z,{name:"deleteVolume",onChange:function(a){return U({force:a.target.checked})},children:"\u5F3A\u5236\u5220\u9664\uFF1F"})]}),children:"\u6279\u91CF\u5220\u9664"})})]})},tableExtraRender:function(){return(0,t.jsx)($.u,{access:"canSeeImageListManageCreate",children:(0,t.jsx)(d.Z,{mode:"horizontal",selectedKeys:["all"],items:[{label:(0,t.jsx)(I.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,t.jsx)(I.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})})},toolBarRender:function(){return[(0,t.jsx)($.u,{access:"canSeeImageListManageDelete",children:(0,t.jsx)(J.Z,{action:function(){return(0,n.c7)()},onSuccess:function(){var r,v;return!((r=f.current)===null||r===void 0)&&r.reloadAndRest&&((v=f.current)===null||v===void 0||v.reloadAndRest()),!0},onError:function(){var r,v;return!((r=f.current)===null||r===void 0)&&r.reset&&((v=f.current)===null||v===void 0||v.reset()),!0},confirm:"notification.confirm.title",children:"\u6E05\u7406\u672A\u4F7F\u7528\u955C\u50CF"})},"prune")]},columnsState:(0,te.j)("image-list")})]})}},3393:function(L,A,e){e.d(A,{Gb:function(){return b},Pn:function(){return c},Rb:function(){return Z},YU:function(){return s},ZQ:function(){return E},_U:function(){return g},cD:function(){return S},cd:function(){return y}});var T=e(15009),o=e.n(T),F=e(99289),i=e.n(F),x=e(82346);function s(d){return P.apply(this,arguments)}function P(){return P=i()(o()().mark(function d(m){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/image/get-detail",{method:"POST",data:m}));case 1:case"end":return n.stop()}},d)})),P.apply(this,arguments)}function b(d){return j.apply(this,arguments)}function j(){return j=i()(o()().mark(function d(m){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/image/tag-remote",{method:"POST",data:m}));case 1:case"end":return n.stop()}},d)})),j.apply(this,arguments)}function g(d){return B.apply(this,arguments)}function B(){return B=i()(o()().mark(function d(m){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/image/tag-add",{method:"POST",data:m}));case 1:case"end":return n.stop()}},d)})),B.apply(this,arguments)}function c(d){return O.apply(this,arguments)}function O(){return O=i()(o()().mark(function d(m){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/image/tag-delete",{method:"POST",data:m}));case 1:case"end":return n.stop()}},d)})),O.apply(this,arguments)}function Z(d){return h.apply(this,arguments)}function h(){return h=i()(o()().mark(function d(m){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/image/export",{method:"POST",data:m,responseType:"blob"}));case 1:case"end":return n.stop()}},d)})),h.apply(this,arguments)}function y(d){return p.apply(this,arguments)}function p(){return p=i()(o()().mark(function d(m){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/pro/image/get-remote-tag",{method:"POST",data:m}));case 1:case"end":return n.stop()}},d)})),p.apply(this,arguments)}function E(d){return R.apply(this,arguments)}function R(){return R=i()(o()().mark(function d(m){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/image/check-upgrade",{method:"POST",data:m}));case 1:case"end":return n.stop()}},d)})),R.apply(this,arguments)}function S(d){return W.apply(this,arguments)}function W(){return W=i()(o()().mark(function d(m){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/pro/image/get-rootfs",{method:"POST",data:m}));case 1:case"end":return n.stop()}},d)})),W.apply(this,arguments)}}}]);
