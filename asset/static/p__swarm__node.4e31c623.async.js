"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3763],{52645:function(De,z,n){n.d(z,{Z:function(){return Z}});var W=n(87462),l=n(67294),J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},g=J,q=n(84089),A=function(K,N){return l.createElement(q.Z,(0,W.Z)({},K,{ref:N,icon:g}))},L=l.forwardRef(A),Z=L},91806:function(De,z,n){n.d(z,{Z:function(){return Z}});var W=n(87462),l=n(67294),J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},g=J,q=n(84089),A=function(K,N){return l.createElement(q.Z,(0,W.Z)({},K,{ref:N,icon:g}))},L=l.forwardRef(A),Z=L},74842:function(De,z,n){n.d(z,{Z:function(){return Z}});var W=n(87462),l=n(67294),J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},g=J,q=n(84089),A=function(K,N){return l.createElement(q.Z,(0,W.Z)({},K,{ref:N,icon:g}))},L=l.forwardRef(A),Z=L},87784:function(De,z,n){n.d(z,{Z:function(){return Z}});var W=n(87462),l=n(67294),J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},g=J,q=n(84089),A=function(K,N){return l.createElement(q.Z,(0,W.Z)({},K,{ref:N,icon:g}))},L=l.forwardRef(A),Z=L},75293:function(De,z,n){n.d(z,{Z:function(){return J}});var W=n(25593),l=n(85893);function J(g){return(0,l.jsx)(W.Z.Text,{copyable:!0,style:{padding:10,display:g.block?"block":"",background:"#24292f",color:"#ffffff"},children:g.content})}},47900:function(De,z,n){n.r(z),n.d(z,{default:function(){return Mt}});var W=n(15009),l=n.n(W),J=n(99289),g=n.n(J),q=n(5574),A=n.n(q),L=n(94359),Z=n(24494),o=n(36146),K=n(184),N=n(5966),Me=n(52688),Pe=n(83622),ue=n(86250),h=n(67294),e=n(85893);function Be(v){var j=(0,h.useRef)(),i=new o.Uo("swarm");return(0,e.jsxs)(K.a,{title:i.format("nodeInitTitle"),trigger:(0,e.jsx)(Pe.ZP,{type:"primary",children:i.format("nodeInitTitle")}),onFinish:function(){var P=g()(l()().mark(function F(C){var x;return l()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,Z.UK)({advertiseAddr:C.advertiseAddr,listenAddr:C.listenAddr,dataPathAddr:C.dataPathAddr,autoLockManagers:C.autoLockManagers,forceNewCluster:C.forceNewCluster,subnet:C.subnet});case 2:return x=p.sent,v.onFinish&&v.onFinish(),p.abrupt("return",!0);case 5:case"end":return p.stop()}},F)}));return function(F){return P.apply(this,arguments)}}(),formRef:j,onOpenChange:function(F){var C;!F&&(!((C=j.current)===null||C===void 0)&&C.resetFields)&&j.current.resetFields()},children:[(0,e.jsx)(N.Z,{name:"advertiseAddr",label:i.format("nodeInitAdvertiseAddr"),tooltip:i.format("nodeInitAdvertiseAddrTip"),required:!0,rules:[{required:!0}],placeholder:"172.16.1.13"}),(0,e.jsx)(N.Z,{name:"listenAddr",label:i.format("nodeInitListenAddr"),tooltip:i.format("nodeInitListenAddrTip"),initialValue:"0.0.0.0",required:!0,rules:[{required:!0}]}),(0,e.jsx)(N.Z,{name:"subnet",label:i.format("nodeInitSubnet"),initialValue:"10.0.0.0/16"}),(0,e.jsxs)(ue.Z,{gap:30,children:[(0,e.jsx)(Me.Z,{label:i.format("nodeInitAutoLockManagers"),name:"autoLockManagers",tooltip:i.format("nodeInitAutoLockManagersTip")}),(0,e.jsx)(Me.Z,{label:i.format("nodeInitForceNewCluster"),name:"forceNewCluster",tooltip:i.format("nodeInitForceNewClusterTip")})]})]})}var Ee=n(3616),ze=n(86615),s=n(64317),I=n(97462),b=n(62370),se=n(40056),ce=n(75293),re=n(82346);function ve(v){var j,i=new o.Uo("swarm"),P=(0,h.useRef)(),F=(0,h.useState)(),C=A()(F,2),x=C[0],k=C[1],p=(0,re.useModel)("@@initialState"),ne=p.initialState;(0,h.useEffect)(function(){v.detail&&v.type=="add"&&H(v.detail,"worker")},[v.detail]);function H(w,D){return le.apply(this,arguments)}function le(){return le=g()(l()().mark(function w(D,U){var B,G,V;return l()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:k("docker swarm join --token ".concat(U=="manager"?(B=D.swarm)===null||B===void 0?void 0:B.JoinTokens.Manager:(G=D.swarm)===null||G===void 0?void 0:G.JoinTokens.Worker," ").concat((D==null?void 0:D.node)&&(D==null||(V=D.node.ManagerStatus)===null||V===void 0?void 0:V.Addr)));case 1:case"end":return R.stop()}},w)})),le.apply(this,arguments)}return(0,e.jsxs)(K.a,{drawerProps:{width:Ee.R_},submitter:!1,formRef:P,onOpenChange:function(D){var U;!D&&(!((U=P.current)===null||U===void 0)&&U.resetFields)&&P.current.resetFields(),!D&&v.onFinish&&v.onFinish()},title:i.format("nodeJoinTitleOption.".concat(v.type)),trigger:(0,e.jsx)(Pe.ZP,{children:i.format("nodeJoinTitleOption.".concat(v.type))}),onValuesChange:function(){var w=g()(l()().mark(function D(U,B){var G,V;return l()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(k(""),!B.dockerEnvName){R.next=12;break}return R.prev=2,R.next=5,(0,Z.vb)({dockerEnvName:B.dockerEnvName,role:B.role,type:v.type});case 5:G=R.sent,H(G.data,B.role),R.next=12;break;case 9:R.prev=9,R.t0=R.catch(2),(V=P.current)===null||V===void 0||V.resetFields(["dockerEnvName"]);case 12:v.type=="add"&&v.detail&&H(v.detail,B.role);case 13:case"end":return R.stop()}},D,null,[[2,9]])}));return function(D,U){return w.apply(this,arguments)}}(),children:[(0,e.jsx)(ze.Z.Group,{label:i.format("nodeJoinRole"),name:"role",initialValue:"worker",options:i.option("nodeAddRoleOption",["manager","worker"])}),v.type=="join"&&(0,e.jsx)(s.Z,{label:i.format("nodeJoinDockerEnvName"),name:"dockerEnvName",placeholder:i.format("nodeJoinDockerEnvNameEmpty"),options:ne==null||(j=ne.dockerEnv)===null||j===void 0?void 0:j.list.map(function(w){return{value:w.name,label:w.title}})},"env"),v.type=="join"&&!x&&(0,e.jsx)(I.Z,{name:["role"],children:function(D){var U=D.role;return(0,e.jsx)(b.Z,{label:i.format("nodeJoinCommandManual"),children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)(se.Z,{type:"warning",message:i.format("nodeJoinCommandManualTip")}),(0,e.jsx)(ce.Z,{block:!0,content:"docker swarm join-token ".concat(U)})]})})}}),x&&(0,e.jsx)(b.Z,{label:i.format("nodeJoinCommandJoin"),children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)(se.Z,{message:i.format("nodeJoinCommandJoinTip",{target:i.format("nodeJoinCommandJoinTargetOption.".concat(v.type))})}),(0,e.jsx)(ce.Z,{block:!0,content:x})]})})]})}var Ze=n(43425),je=n(74842),Ae=n(30159),be=n(87784),oe=n(87462),Te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.5 360.3a7.95 7.95 0 00-12.9 0l-178 246c-3.8 5.3 0 12.7 6.5 12.7H381c10.2 0 19.9-4.9 25.9-13.2L512 460.4l105.2 145.4c6 8.3 15.6 13.2 25.9 13.2H690c6.5 0 10.3-7.4 6.5-12.7l-178-246z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"up-circle",theme:"outlined"},xe=Te,te=n(84089),we=function(j,i){return h.createElement(te.Z,(0,oe.Z)({},j,{ref:i,icon:xe}))},Je=h.forwardRef(we),ye=Je,Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},fe=Ie,Ve=function(j,i){return h.createElement(te.Z,(0,oe.Z)({},j,{ref:i,icon:fe}))},me=h.forwardRef(Ve),Le=me,he=n(45605),Fe=n(91806),Qe=n(60433),_=n(38345),de=n(42075),Ye=n(96074),$=n(26412),Ne=n(66309),pe=n(80821),We=n(5251),dt=n(91058),ut=n(76428),ct=n(24963),vt=n(97269),qe=n(25593),ft=n(84567);function _e(v){var j=(0,h.useRef)(),i=new o.Uo("swarm");return(0,e.jsx)(pe.Z,{buttonProps:{type:"primary",danger:!0},confirmProps:{title:o.FD.format("title.tip"),onOpenChange:function(F,C){var x;!((x=j.current)===null||x===void 0)&&x.resetFields&&j.current.resetFields()},description:(0,e.jsx)(vt.A,{submitter:!1,formRef:j,children:(0,e.jsxs)(de.Z,{style:{width:600,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(qe.Z.Text,{children:(0,e.jsx)("ul",{children:i.prefix("removeButtonTipOption",4).map(function(P,F){return(0,e.jsx)("li",{children:P},F)})})}),(0,e.jsx)(b.Z,{name:"enableForce",valuePropName:"checked",children:(0,e.jsxs)(ft.Z,{disabled:!!v.nodeId,children:[o.FD.format("listManageExitForce"),"\uFF1F"]})})]})})},action:g()(l()().mark(function P(){var F;return l()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,Z.QB)({nodeId:v.nodeId,force:(F=j.current)===null||F===void 0?void 0:F.getFieldValue("enableForce")}));case 1:case"end":return x.stop()}},P)})),onSuccess:function(){v.onFinish&&v.onFinish()},children:v.title},"console")}var mt=n(94617),ht=(0,h.forwardRef)(function(v,j){var i,P,F,C,x,k,p,ne,H,le,w,D,U,B,G,V,Se,R,Ce,M,O,d,y,T,X,u,a,c,S,E,Y,Q,Oe,Re,Ke;(0,h.useImperativeHandle)(j,function(){return{show:function(r){var ie,f,$e;!((ie=r.Spec)===null||ie===void 0)&&ie.Labels&&((f=lt.current)===null||f===void 0||f.setFieldValue("labels",Object.keys(($e=r.Spec)===null||$e===void 0?void 0:$e.Labels).map(function(Ue){var ae,Ge,Xe;return{name:Ue,value:(ae=r.Spec)!==null&&ae!==void 0&&ae.Labels&&(Ge=r.Spec)!==null&&Ge!==void 0&&Ge.Labels[Ue]?(Xe=r.Spec)===null||Xe===void 0?void 0:Xe.Labels[Ue]:""}}))),ge(r),ke(!0)}}});var Et=(0,h.useState)(!1),rt=A()(Et,2),ot=rt[0],ke=rt[1],lt=(0,h.useRef)(),At=(0,h.useState)(),st=A()(At,2),t=st[0],ge=st[1],ee=new o.Uo("swarm"),He=new o.Uo("system.home.overview"),bt=(0,h.useContext)(ct.Z),Tt=bt.message;return(0,e.jsx)(K.a,{title:ee.format("nodeDetailTitle",{name:t==null||(i=t.Description)===null||i===void 0?void 0:i.Hostname}),open:ot,drawerProps:{forceRender:!0,width:Ee.R_},onOpenChange:function(r){ke(r),!r&&v.onFinish&&v.onFinish()},onFinish:function(){var m=g()(l()().mark(function r(ie){var f,$e;return l()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,(0,Z.Zc)({nodeId:(f=t==null?void 0:t.ID)!==null&&f!==void 0?f:"",labels:ie.labels});case 2:return $e=ae.sent,ge($e.data.detail),Tt.success(o.FD.format("finish")),ae.abrupt("return",!1);case 6:case"end":return ae.stop()}},r)}));return function(r){return m.apply(this,arguments)}}(),formRef:lt,children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,children:[(0,e.jsx)(_.Z,{title:(0,e.jsx)(Ze.Z,{}),ghost:!0,subTitle:o.FD.format("listManage"),children:(0,e.jsxs)(de.Z,{wrap:!0,children:[(0,e.jsx)(pe.Z,{buttonProps:{disabled:(t==null||(P=t.Spec)===null||P===void 0?void 0:P.Availability)=="active"||(t==null||(F=t.Status)===null||F===void 0?void 0:F.State)!="ready",icon:(0,e.jsx)(je.Z,{})},action:g()(l()().mark(function m(){var r;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,Z.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",availability:"active"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},tips:ee.format("nodeListStatusOptionTip.active"),children:o.FD.format("listManageUnpause")}),(0,e.jsx)(pe.Z,{action:g()(l()().mark(function m(){var r;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,Z.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",availability:"pause"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},tips:ee.format("nodeListStatusOptionTip.pause"),buttonProps:{disabled:(t==null||(C=t.Spec)===null||C===void 0?void 0:C.Availability)=="pause"||(t==null||(x=t.Status)===null||x===void 0?void 0:x.State)!="ready",icon:(0,e.jsx)(Ae.Z,{})},children:o.FD.format("listManagePause")}),(0,e.jsx)(pe.Z,{action:g()(l()().mark(function m(){var r;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,Z.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",availability:"drain"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},tips:ee.format("nodeListStatusOptionTip.drain"),buttonProps:{disabled:(t==null||(k=t.Spec)===null||k===void 0?void 0:k.Availability)=="drain"||(t==null||(p=t.Status)===null||p===void 0?void 0:p.State)!="ready",icon:(0,e.jsx)(be.Z,{})},children:o.FD.format("listManageStop")}),(0,e.jsx)(Ye.Z,{type:"vertical"}),(t==null||(ne=t.Spec)===null||ne===void 0?void 0:ne.Role)=="worker"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(pe.Z,{action:g()(l()().mark(function m(){var r;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,Z.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",role:"manager"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},buttonProps:{disabled:(t==null||(H=t.Spec)===null||H===void 0?void 0:H.Availability)=="drain"||(t==null||(le=t.Status)===null||le===void 0?void 0:le.State)!="ready",icon:(0,e.jsx)(ye,{}),type:"primary"},children:ee.format("nodeDetailManageManager")})}),(t==null||(w=t.Spec)===null||w===void 0?void 0:w.Role)=="manager"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(pe.Z,{action:g()(l()().mark(function m(){var r;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,Z.Zc)({nodeId:(r=t==null?void 0:t.ID)!==null&&r!==void 0?r:"",role:"worker"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(r){ge(r.data.detail)},buttonProps:{disabled:(t==null||(D=t.Spec)===null||D===void 0?void 0:D.Availability)=="drain"||(t==null||(U=t.Status)===null||U===void 0?void 0:U.State)!="ready",icon:(0,e.jsx)(Le,{}),type:"primary"},children:ee.format("nodeDetailManageWorker")})}),(0,e.jsx)(Ye.Z,{type:"vertical"}),(0,e.jsx)(_e,{title:o.FD.format("listManageDelete"),nodeId:t==null?void 0:t.ID,onFinish:function(){ke(!1),v.onFinish&&v.onFinish()}})]})}),(0,e.jsx)(_.Z,{title:(0,e.jsx)(he.Z,{}),subTitle:o.FD.format("listManageDetail"),ghost:!0,children:(0,e.jsxs)($.Z,{column:1,bordered:!0,styles:{label:{width:150}},children:[(0,e.jsxs)($.Z.Item,{label:"Hostname",children:[(0,e.jsx)(ut.Z,{title:t==null?void 0:t.ID})," - ",t==null||(B=t.Description)===null||B===void 0?void 0:B.Hostname," - ",(0,e.jsx)(Ne.Z,{color:"blue",children:t==null||(G=t.Spec)===null||G===void 0?void 0:G.Role})," ",t&&(0,e.jsx)(L.Z,{status:"swarm.".concat((V=t.Status)===null||V===void 0?void 0:V.State),tip:ee.format("nodeListRunStatusOptionTipOption.".concat((Se=(R=t.Status)===null||R===void 0?void 0:R.State)!==null&&Se!==void 0?Se:"ready"))}),t&&(0,e.jsx)(L.Z,{status:"swarm.".concat((Ce=t.Spec)===null||Ce===void 0?void 0:Ce.Availability),tip:ee.format("nodeListStatusOptionTip.".concat((M=(O=t.Spec)===null||O===void 0?void 0:O.Availability)!==null&&M!==void 0?M:"active"))})]}),(0,e.jsx)($.Z.Item,{label:He.format("basicDockerTitleSystemVersion"),children:"".concat(t==null||(d=t.Description)===null||d===void 0||(d=d.Platform)===null||d===void 0?void 0:d.OS,` - 
              `).concat(t==null||(y=t.Description)===null||y===void 0||(y=y.Platform)===null||y===void 0?void 0:y.Architecture,` - 
              `).concat(t==null||(T=t.Description)===null||T===void 0||(T=T.Engine)===null||T===void 0?void 0:T.EngineVersion)}),(0,e.jsxs)($.Z.Item,{label:"Cpu",children:[((X=t==null||(u=t.Description)===null||u===void 0||(u=u.Resources)===null||u===void 0?void 0:u.NanoCPUs)!==null&&X!==void 0?X:0)/1e9," ",o.FD.format("unitCpu")]}),(0,e.jsx)($.Z.Item,{label:"Memory",children:(0,We.FI)((a=t==null||(c=t.Description)===null||c===void 0||(c=c.Resources)===null||c===void 0?void 0:c.MemoryBytes)!==null&&a!==void 0?a:0)}),(0,e.jsx)($.Z.Item,{label:He.format("basicDockerTitlePluginsVolume"),children:(0,e.jsx)(de.Z,{children:(t==null||(S=t.Description)===null||S===void 0||(S=S.Engine)===null||S===void 0?void 0:S.Plugins)&&(t==null||(E=t.Description)===null||E===void 0||(E=E.Engine)===null||E===void 0?void 0:E.Plugins.filter(function(m){return m.Type=="Volume"}).map(function(m){return m.Name}))})}),(0,e.jsx)($.Z.Item,{label:He.format("basicDockerTitlePluginsNetwork"),children:(0,e.jsx)(de.Z,{wrap:!0,children:(t==null||(Y=t.Description)===null||Y===void 0||(Y=Y.Engine)===null||Y===void 0?void 0:Y.Plugins)&&(t==null||(Q=t.Description)===null||Q===void 0||(Q=Q.Engine)===null||Q===void 0?void 0:Q.Plugins.filter(function(m){return m.Type=="Network"}).map(function(m){return m.Name}))})}),(0,e.jsx)($.Z.Item,{label:He.format("basicDockerTitleLogDriver"),children:(0,e.jsx)(de.Z,{wrap:!0,children:(t==null||(Oe=t.Description)===null||Oe===void 0||(Oe=Oe.Engine)===null||Oe===void 0?void 0:Oe.Plugins)&&(t==null||(Re=t.Description)===null||Re===void 0||(Re=Re.Engine)===null||Re===void 0?void 0:Re.Plugins.filter(function(m){return m.Type=="Log"}).map(function(m){return m.Name}))})})]})}),t&&t.ID&&ot&&(0,e.jsx)(_.Z,{title:(0,e.jsx)(Fe.Z,{}),subTitle:ee.format("nodeDetailServiceList"),headStyle:{paddingBottom:0},ghost:!0,children:(0,e.jsx)(mt.Z,{showWithNodeId:t.ID,tableProps:{search:!1,ghost:!0}})}),(t==null||(Ke=t.Spec)===null||Ke===void 0?void 0:Ke.Labels)&&(0,e.jsx)(_.Z,{title:(0,e.jsx)(Qe.Z,{}),ghost:!0,subTitle:ee.format("nodeDetailTagList"),children:(0,e.jsx)(dt.Z,{drawerProps:{ghost:!0},name:"labels",showAddButton:!0,addButtonLabel:ee.format("nodeDetailTagAdd")})})]})})}),pt=ht,St=n(98009),gt=function(j,i){return h.createElement(te.Z,(0,oe.Z)({},j,{ref:i,icon:St.Z}))},Dt=h.forwardRef(gt),et=Dt,Zt=n(30432),jt=function(j,i){return h.createElement(te.Z,(0,oe.Z)({},j,{ref:i,icon:Zt.Z}))},xt=h.forwardRef(jt),yt=xt,It=n(52645),Ct=n(74453),Ot=n(9773),tt=n(32983),Rt=n(60940),$t=n(40411),Pt=n(83062),Ft=n(22181),nt=n(89240),it={xs:1,sm:2,md:2,lg:2,xl:3,xxl:4},at={display:"flex",justifyContent:"flex-end",width:100};function Mt(){var v=(0,h.useState)(),j=A()(v,2),i=j[0],P=j[1],F=(0,h.useState)(0),C=A()(F,2),x=C[0],k=C[1],p=new o.Uo("swarm"),ne=(0,h.useRef)(),H=(0,h.useRef)(),le=(0,h.useState)(),w=A()(le,2),D=w[0],U=w[1],B=(0,h.useState)(),G=A()(B,2),V=G[0],Se=G[1],R=(0,re.useModel)("@@initialState"),Ce=R.refresh;return(0,h.useEffect)(function(){(0,Z.JC)().then(function(M){var O;P(M.data),!((O=H.current)===null||O===void 0)&&O.reloadAndRest&&H.current.reloadAndRest()})},[x]),(0,e.jsxs)(Ct._z,{extra:[i&&i.status.isManage&&(0,e.jsx)(ve,{type:"add",detail:i,onFinish:function(){k(x+1)}},"join"),i&&i.status.isNode&&(0,e.jsx)(_e,{title:p.format("nodeDetailDeleteButtonOption.".concat(i.status.isManage?"delete":"leave")),onFinish:function(){i.status.isManage?Ce():k(x+1)}},"leave")],children:[(0,e.jsx)(pt,{ref:ne,onFinish:function(){k(x+1)}}),(0,e.jsxs)(_.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(!i||!i.status.isNode)&&(0,e.jsx)(ue.Z,{justify:"center",style:{height:"58vh"},vertical:!0,children:(0,e.jsx)(tt.Z,{image:tt.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(de.Z,{direction:"vertical",size:[0,20],children:[p.format("nodeDetailJoinTip"),(0,e.jsxs)(de.Z,{children:[(0,e.jsx)(ve,{type:"join",detail:i,onFinish:function(){k(x+1)}},"join"),(0,e.jsx)(Be,{onFinish:function(){Ce(),k(x+1)}})]})]})})}),i&&i.status.isNode&&i.info&&i.info.LocalNodeState!="error"&&(0,e.jsxs)(_.Z,{title:(0,e.jsx)(et,{}),subTitle:p.format("nodeDetailCurrent"),direction:"column",gutter:[0,20],children:[(0,e.jsx)(_.Z,{ghost:!0,children:(0,e.jsxs)($.Z,{column:it,styles:{label:at},children:[(0,e.jsx)($.Z.Item,{label:"Id",children:i.info.NodeID}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listRunStatus"),children:(0,e.jsx)(L.Z,{status:"swarm.".concat(i.info.LocalNodeState),tip:p.format("nodeListRunStatusTipOption.".concat(i.info.LocalNodeState))})}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listType"),children:p.format("nodeAddRoleOption.".concat(i.info.ControlAvailable?"manager":"worker"))})]})}),i.info.RemoteManagers&&!i.status.isManage&&(0,e.jsx)(_.Z,{ghost:!0,title:(0,e.jsx)(et,{}),subTitle:p.format("nodeDetailManager"),children:(0,e.jsx)(Rt.Z,{pagination:!1,columns:[{title:o.FD.format("listName"),dataIndex:"NodeID"},{title:o.FD.format("listIpAddress"),dataIndex:"Addr"}],dataSource:i.info.RemoteManagers})})]}),i&&i.status.isManage&&i.swarm&&(0,e.jsx)(_.Z,{title:(0,e.jsx)(yt,{}),subTitle:p.format("nodeDetailSwarm"),direction:"column",gutter:[0,15],children:(0,e.jsx)(_.Z,{ghost:!0,children:(0,e.jsxs)($.Z,{column:it,styles:{label:at},children:[(0,e.jsx)($.Z.Item,{label:o.FD.format("listName"),children:i.swarm.ID}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listTitle"),children:i.swarm.Spec&&i.swarm.Spec.Name}),(0,e.jsxs)($.Z.Item,{label:o.FD.format("listResource"),children:[D&&(0,nt.PD)(D.cpu)," ",o.FD.format("unitCpu")," / ",(0,We.FI)(D==null?void 0:D.memory)]}),(0,e.jsxs)($.Z.Item,{label:"".concat(p.format("nodeDetailSwarmWorker")," / ").concat(p.format("nodeDetailSwarmManager")),children:[i.info.Nodes," / ",i.info.Managers]}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listCreatedAt"),children:new Date(i.swarm.CreatedAt).toLocaleString()}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listUpdatedAt"),children:new Date(i.swarm.UpdatedAt).toLocaleString()})]})})}),i&&i.status.isManage&&i.info.LocalNodeState!="error"&&(0,e.jsx)(_.Z,{title:(0,e.jsx)(Qe.Z,{}),subTitle:p.format("nodeDetailSwarmNodeList"),children:(0,e.jsx)(Ot.Z,{scroll:{x:"max-content"},rowKey:"ID",actionRef:H,pagination:!1,ghost:!0,search:!1,request:g()(l()().mark(function M(){var O,d,y,T,X;return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,Z.HN)();case 2:return O=a.sent,d={cpu:0,memory:0},O.data.list&&O.data.list.forEach(function(c){var S,E,Y,Q;d.cpu+=(S=(E=c.Description)===null||E===void 0||(E=E.Resources)===null||E===void 0?void 0:E.NanoCPUs)!==null&&S!==void 0?S:0,d.memory+=(Y=(Q=c.Description)===null||Q===void 0||(Q=Q.Resources)===null||Q===void 0?void 0:Q.MemoryBytes)!==null&&Y!==void 0?Y:0}),U(d),a.next=8,(0,Z.kM)();case 8:return y=a.sent,a.next=11,(0,Z.XX)();case 11:return T=a.sent,T.data&&T.data.list&&(X=[],T.data.list.forEach(function(c){if(c.Status.State=="running"){var S,E=y.data&&y.data.list&&((S=y.data.list.find(function(Y){return Y.ID==c.ServiceID}))===null||S===void 0||(S=S.Spec)===null||S===void 0?void 0:S.Name);(!E||E=="")&&(E=c.ServiceID),X.push({nodeId:c.NodeID,serviceName:E,taskId:c.ID})}}),Se(X)),a.abrupt("return",{data:O.data.list,success:!0,total:O.data.list.length});case 14:case"end":return a.stop()}},M)})),columns:[{title:o.FD.format("listName"),render:function(O,d,y,T,X){var u,a;return(0,e.jsxs)(de.Z,{children:[(0,e.jsx)(qe.Z.Link,{onClick:function(){var S;(S=ne.current)===null||S===void 0||S.show(d)},children:(u=(a=d.Description)===null||a===void 0?void 0:a.Hostname)!==null&&u!==void 0?u:d.ID})," ",i.node&&d.ID==i.node.ID&&(0,e.jsx)($t.Z,{status:"processing"})]})}},{title:o.FD.format("listRole"),dataIndex:["Spec","Role"],render:function(O,d,y,T,X){var u,a,c,S;return(0,e.jsx)(Ne.Z,{color:p.format("nodeAddRoleColorOption.".concat((u=(a=d.Spec)===null||a===void 0?void 0:a.Role)!==null&&u!==void 0?u:"worker")),children:p.format("nodeAddRoleOption.".concat((c=(S=d.Spec)===null||S===void 0?void 0:S.Role)!==null&&c!==void 0?c:"worker"))})}},{title:"CPU / Memory",render:function(O,d,y,T,X){var u,a,c;return"".concat((0,nt.PD)((u=d.Description)===null||u===void 0||(u=u.Resources)===null||u===void 0?void 0:u.NanoCPUs)," ").concat(o.FD.format("unitCpu")," / ").concat((0,We.FI)((a=(c=d.Description)===null||c===void 0||(c=c.Resources)===null||c===void 0?void 0:c.MemoryBytes)!==null&&a!==void 0?a:0))}},{title:o.FD.format("listRunTask"),render:function(O,d,y,T,X){var u={};return V&&V.filter(function(a){return a.nodeId==d.ID}).forEach(function(a){u[a.serviceName]||(u[a.serviceName]=0),u[a.serviceName]+=1}),Object.keys(u).length>0?Object.keys(u).map(function(a,c){return(0,e.jsx)(Pt.Z,{title:a,children:(0,e.jsx)(Ne.Z,{color:"success",children:u[a]})},"".concat(a,"-").concat(c))}):(0,e.jsx)(Ne.Z,{children:"0"})}},{title:o.FD.format("listApiVersion"),dataIndex:["Description","Engine","EngineVersion"]},{title:o.FD.format("listIpAddress"),dataIndex:["Status","Addr"]},{title:o.FD.format("listRunStatus"),render:function(O,d,y,T,X){var u,a,c=(u=(a=d.Status)===null||a===void 0?void 0:a.State)!==null&&u!==void 0?u:"ready";return(0,e.jsx)(L.Z,{status:"swarm.".concat(c),tip:p.format("nodeListRunStatusTipOption.".concat(c))})}},{title:o.FD.format("listStatus"),render:function(O,d,y,T,X){var u,a,c,S;return(0,e.jsx)(L.Z,{status:"swarm.".concat((u=(a=d.Spec)===null||a===void 0?void 0:a.Availability)!==null&&u!==void 0?u:"active"),tip:p.format("nodeListStatusOptionTip.".concat((c=(S=d.Spec)===null||S===void 0?void 0:S.Availability)!==null&&c!==void 0?c:"active"))})}}],toolBarRender:function(){return[(0,e.jsx)(pe.Z,{action:function(){return(0,Z.kp)()},onSuccess:function(){var d,y;return!((d=H.current)===null||d===void 0)&&d.reloadAndRest&&((y=H.current)===null||y===void 0||y.reloadAndRest()),!0},onError:function(){var d,y;return!((d=H.current)===null||d===void 0)&&d.reset&&((y=H.current)===null||y===void 0||y.reset()),!0},confirmProps:{description:p.format("nodeListManagePruneTip")},buttonProps:{icon:(0,e.jsx)(It.Z,{})},children:o.FD.format("listManagePrune")},"clear")]}})}),i&&i.status.isNode&&i.info.LocalNodeState=="error"&&(0,e.jsx)(Ft.ZP,{status:"error",title:p.format(["nodeListRunStatusTipOption.error","nodeListRunStatusTipOption.exit"]),subTitle:i.info.Error})]})]})}},89240:function(De,z,n){n.d(z,{HJ:function(){return h},PD:function(){return Be},Rk:function(){return e},pM:function(){return Ee},yi:function(){return ue},zY:function(){return ze}});var W=n(64599),l=n.n(W),J=n(5251),g=n(10531),q=n(43836),A=n(17179),L=n(74911),Z=n(17637),o=n(58353),K=/^([1-9]|[1-5]?[0-9]{2,4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$/m;function N(s){return K.test(s)?parseInt(s,10):0}function Me(s){typeof s!="string"&&(s=s.toString());var I=g.Z(s,"-",2),b=q.Z(I,N);return b.length==1&&b.push(b[0]),b}function Pe(s,I){typeof s!="string"&&(s=s.toString());var b=null,se=s.indexOf(":");se>=0&&(b=s.substring(0,se),s=s.substring(se+1)),I=typeof I=="number"?I:N(I);var ce=Me(s),re=Math.min(ce[0],I),ve=Math.max(ce[1],I);return b?b+":"+re+"-"+ve:re+"-"+ve}function ue(s){if(!s||!s.HostConfig||!s.HostConfig.PortBindings)return[];var I=[],b=s.HostConfig.PortBindings,se=A.Z(b),ce=L.Z(se,function(re){return g.Z(re,"/")[1]});return Z.Z(ce,function(re,ve){var Ze={},je=l()(re),Ae;try{for(je.s();!(Ae=je.n()).done;){var be=Ae.value,oe=l()(b[be]),Te;try{for(oe.s();!(Te=oe.n()).done;){var xe=Te.value;Ze[xe.HostIp]=Ze[xe.HostIp]||[],Ze[xe.HostIp].push(be)}}catch(te){oe.e(te)}finally{oe.f()}}}catch(te){je.e(te)}finally{je.f()}Z.Z(Ze,function(te,we){var Je=o.Z(te,function(fe){return parseInt(g.Z(fe,"/")[0],10)}),ye=-1,Ie=-1;Z.Z(Je,function(fe){var Ve=g.Z(fe,"/"),me=parseInt(Ve[0],10),Le=b[fe][0];b[fe].shift();var he=N(Le.HostPort);if(he>0){if(I.length>0&&ye===he-1&&Ie===me-1){I[I.length-1].host=Pe(I[I.length-1].host,he),I[I.length-1].dest=Pe(I[I.length-1].dest,me),ye=he,Ie=me;return}ye=he,Ie=me}else ye=-1,Ie=-1;var Fe=Le.HostPort.toString();we&&(Fe="".concat(we,":").concat(Fe)),I.push({host:Fe,dest:me.toString(),protocol:ve})})})}),I}function h(s){return(0,J.fi)(s,"/")}function e(s){return s?(0,J.FI)(s):"64M"}function Be(s){return s&&s>1e8?s/1e9:0}function Ee(s){return s?s/1024/1024:0}function ze(s){return"".concat(h(s),".pod.dpanel.local")}}}]);
