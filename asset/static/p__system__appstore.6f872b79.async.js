"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3917],{80821:function(W,j,e){e.d(j,{Z:function(){return R}});var O=e(5574),c=e.n(O),v=e(24963),g=e(86738),u=e(28036),n=e(83062),m=e(67294),d=e(85893);function R(t){var C=(0,m.useState)(!1),T=c()(C,2),Z=T[0],B=T[1],b=(0,m.useContext)(v.Z),A=b.lang,U=b.notice,f=b.message,s=function(){B(!0),t.action().then(function(r){if(B(!1),r){typeof t.onSuccess=="function"&&t.onSuccess(r);var $="";t.messageSuccess?typeof t.messageSuccess=="function"?$=t.messageSuccess(r):$=t.messageSuccess.indexOf("notification.")==0?A(t.messageSuccess):t.messageSuccess:$=A("notification.finish"),t.asynced?f.info($):f.success($)}}).catch(function(r){B(!1),typeof t.onError=="function"&&t.onError(r)})};return t.confirm?(0,d.jsx)(g.Z,{style:{width:500},title:t.confirmTitle?t.confirmTitle:A("notification.title.tip"),description:typeof t.confirm=="string"&&t.confirm.indexOf("notification.")==0?A(t.confirm):t.confirm,onConfirm:s,okText:"Yes",cancelText:"No",children:(0,d.jsx)(u.ZP,{disabled:t.disabled,icon:t.icon,loading:Z,danger:t.danger,type:t.type,children:t.children})}):(0,d.jsx)(n.Z,{title:t.tips,children:(0,d.jsx)(u.ZP,{style:t.ghost?{padding:0,height:"auto"}:{},disabled:t.disabled,icon:t.icon,loading:Z,onClick:s,danger:t.danger,type:t.type,children:t.children})})}},24963:function(W,j,e){var O=e(67294),c=(0,O.createContext)({});j.Z=c},29337:function(W,j,e){e.r(j),e.d(j,{default:function(){return te}});var O=e(15009),c=e.n(O),v=e(99289),g=e.n(v),u=e(5574),n=e.n(u),m=e(24963),d=e(15078),R=e(184),t=e(5966),C=e(97462),T=e(86615),Z=e(62370),B=e(63713),b=e(28036),A=e(42075),U=e(25593),f=e(66309),s=e(67294),a=e(85893),r=(0,s.forwardRef)(function(E,z){var w=(0,s.useState)(!1),D=n()(w,2),y=D[0],i=D[1],x=(0,s.useRef)(),M=(0,s.useContext)(m.Z),h=M.message,_=M.notice,l=(0,B.useSearchParams)(),S=n()(l,2),ne=S[0],re=S[1];return(0,s.useImperativeHandle)(z,function(){return{edit:function(p){var o;(o=x.current)===null||o===void 0||o.setFieldsValue({title:p.title,name:p.name,type:p.setting.type,url:p.setting.url,id:p.id}),i(!0)}}}),(0,s.useEffect)(function(){ne.get("op")=="create"&&i(!0)},[]),(0,a.jsxs)(R.a,{name:"create",title:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97",open:y,onOpenChange:function(p){i(p)},drawerProps:{forceRender:!0},formRef:x,trigger:(0,a.jsx)(b.ZP,{type:"primary",children:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97"}),onFinish:function(){var L=g()(c()().mark(function p(o){var F,I,K;return c()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,d.ks)({name:o.name,url:o.url,type:o.type});case 2:if(F=P.sent,!(F&&F.data)){P.next=12;break}return P.next=6,(0,d.$c)({id:o.id,name:o.name,title:o.title,type:o.type,url:o.url,apps:F.data.list});case 6:if(I=P.sent,!(I&&I.data)){P.next=12;break}return h.success("\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\u6210\u529F"),E.onFinish&&E.onFinish(),(K=x.current)===null||K===void 0||K.resetFields(),P.abrupt("return",!0);case 12:case"end":return P.stop()}},p)}));return function(p){return L.apply(this,arguments)}}(),children:[(0,a.jsx)(t.Z,{name:"id",hidden:!0}),(0,a.jsx)(t.Z,{label:"\u540D\u79F0",name:"title",required:!0,rules:[{required:!0}],placeholder:"\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u5E94\u7528\u5546\u5E97"}),(0,a.jsx)(C.Z,{name:["id"],children:function(p){var o=p.id;return(0,a.jsx)(t.Z,{label:"\u6807\u8BC6",name:"name",required:!0,disabled:!!o,rules:[{required:!0}],placeholder:"\u6307\u5B9A\u5546\u5E97\u6807\u8BC6\uFF0C\u7528\u4E8E\u521B\u5EFA\u5546\u5E97\u6587\u4EF6\u5B58\u50A8\u76EE\u5F55"})}}),(0,a.jsx)(T.Z.Group,{name:"type",label:"\u5546\u5E97\u7C7B\u578B",valueEnum:{casaos:"casaos \u5E94\u7528\u5546\u5E97","1panel":"1panel \u5E94\u7528\u5546\u5E97"},fieldProps:{onChange:function(p){var o;(o=x.current)===null||o===void 0||o.resetFields(["url"])}}}),(0,a.jsx)(C.Z,{name:["type"],children:function(p){var o=p.type,F=[],I=[];if(o=="1panel"&&(I=["https://gitee.com/qyg2297248353/appstore-dpanel","https://github.com/1Panel-dev/appstore","https://github.com/okxlin/appstore"],F=[(0,a.jsx)(t.Z,{label:"\u4ED3\u5E93\u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B git \u4ED3\u5E93\u5730\u5740"},"gitUrl")]),o=="portainer"&&(F=[(0,a.jsx)(t.Z,{label:"template.json \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/Lissy93/portainer-templates/blob/main/templates.json"},"jsonUrl")]),o=="casaos"&&(I=["https://play.cuse.eu.org/Cp0204-AppStore-Play.zip"],F=[(0,a.jsx)(t.Z,{label:"zip \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B zip \u5730\u5740"},"zipUrl")]),o&&o!="")return[F,(0,a.jsx)(Z.Z,{label:(0,a.jsxs)(A.Z,{children:["\u63A8\u8350\u5546\u5E97",(0,a.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/setting/store?id=%e6%94%af%e6%8c%81%e7%b1%bb%e5%9e%8b",target:"_blank",children:"\u4E09\u65B9\u5546\u5E97\u63A5\u5165\u8BF4\u660E"})]}),children:(0,a.jsx)(A.Z,{wrap:!0,children:I.map(function(K,N){return(0,a.jsx)(U.Z.Link,{onClick:function(){var G;(G=x.current)===null||G===void 0||G.setFieldValue("url",K)},children:(0,a.jsx)(f.Z,{color:"cyan",children:K})},N)})})},"recommend")]}})]})}),$=r,H=e(80821),Y=e(5251),V=e(67255),J=e(43425),Q=e(98165),X=e(90078),k=e(10641),q=e(96074),ee=e(83062);function te(){var E=(0,s.useRef)(),z=(0,B.useAccess)(),w=(0,s.useRef)();return(0,a.jsx)(X._z,{header:{extra:[z.canSeeFounder&&(0,a.jsx)($,{ref:w,onFinish:function(){var y,i;!((y=E.current)===null||y===void 0)&&y.reloadAndRest&&((i=E.current)===null||i===void 0||i.reloadAndRest())}},"create")]},children:(0,a.jsx)(k.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,V.O)(),columns:[{title:"\u6807\u8BC6",dataIndex:"name",width:200},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u5730\u5740",width:500,search:!1,render:function(y,i,x,M,h){return(0,a.jsx)("a",{href:i.setting.url,target:"_blank",children:(0,a.jsx)(f.Z,{children:i.setting.url})})}},{title:"\u6700\u540E\u66F4\u65B0",width:180,render:function(y,i,x,M,h){if(i.setting.updatedAt)return(0,Y.ZM)(i.setting.updatedAt*1e3)}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(y,i,x,M,h){return(0,a.jsxs)(A.Z,{split:(0,a.jsx)(q.Z,{type:"vertical"}),children:[(0,a.jsx)(U.Z.Link,{onClick:function(){var l;(l=w.current)===null||l===void 0||l.edit(i)},children:(0,a.jsx)(ee.Z,{title:"\u7BA1\u7406",children:(0,a.jsx)(J.Z,{})})},"manage"),(0,a.jsx)(H.Z,{type:"link",icon:(0,a.jsx)(Q.Z,{}),action:function(){var l,S;return(0,d.ks)({id:i.id,name:i.name,url:(l=i.setting.url)!==null&&l!==void 0?l:"",type:(S=i.setting.type)!==null&&S!==void 0?S:""})},onSuccess:function(){var l,S;return!((l=E.current)===null||l===void 0)&&l.reloadAndRest&&((S=E.current)===null||S===void 0||S.reloadAndRest()),!0},onError:function(){var l,S;return!((l=E.current)===null||l===void 0)&&l.reloadAndRest&&((S=E.current)===null||S===void 0||S.reloadAndRest()),!0},children:" "},"upgrade")]})}}],request:function(){var D=g()(c()().mark(function y(i,x,M){var h;return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,d.eO)({name:i.name,title:i.title});case 2:return h=l.sent,l.abrupt("return",{data:h.data.list,success:!0,total:h.data.list.length});case 4:case"end":return l.stop()}},y)}));return function(y,i,x){return D.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:E,tableAlertOptionRender:function(y){var i=y.selectedRowKeys,x=y.selectedRows;return(0,a.jsx)(A.Z,{size:16,children:(0,a.jsx)(H.Z,{danger:!0,type:"primary",action:function(){return(0,d.Me)({id:x.map(function(h){return h.id})})},onSuccess:function(){var h,_;return!((h=E.current)===null||h===void 0)&&h.reloadAndRest&&((_=E.current)===null||_===void 0||_.reloadAndRest()),!0},onError:function(){var h,_;return!((h=E.current)===null||h===void 0)&&h.reset&&((_=E.current)===null||_===void 0||_.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"},"delete")})}})})}},15078:function(W,j,e){e.d(j,{$c:function(){return n},Me:function(){return B},eO:function(){return T},ks:function(){return d},yL:function(){return A}});var O=e(15009),c=e.n(O),v=e(99289),g=e.n(v),u=e(63713);function n(f){return m.apply(this,arguments)}function m(){return m=g()(c()().mark(function f(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,u.request)("/api/common/store/create",{method:"POST",data:s}));case 1:case"end":return r.stop()}},f)})),m.apply(this,arguments)}function d(f){return R.apply(this,arguments)}function R(){return R=g()(c()().mark(function f(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,u.request)("/api/common/store/sync",{method:"POST",data:s}));case 1:case"end":return r.stop()}},f)})),R.apply(this,arguments)}function t(f){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function f(s){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:s}));case 1:case"end":return r.stop()}},f)})),C.apply(this,arguments)}function T(f){return Z.apply(this,arguments)}function Z(){return Z=g()(c()().mark(function f(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,u.request)("/api/common/store/get-list",{method:"POST",data:s}));case 1:case"end":return r.stop()}},f)})),Z.apply(this,arguments)}function B(f){return b.apply(this,arguments)}function b(){return b=g()(c()().mark(function f(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,u.request)("/api/common/store/delete",{method:"POST",data:s});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},f)})),b.apply(this,arguments)}function A(f){return U.apply(this,arguments)}function U(){return U=g()(c()().mark(function f(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,u.request)(s==null?void 0:s.path,{method:"GET"}));case 1:case"end":return r.stop()}},f)})),U.apply(this,arguments)}},5251:function(W,j,e){e.d(j,{FI:function(){return c},NF:function(){return g},ZM:function(){return v}});function O(u){return u.trim()}function c(u){var n="";u<.1*1024?n=u.toFixed(2)+"B":u<.1*1024*1024?n=(u/1024).toFixed(2)+"KB":u<1*1024*1024*1024?n=(u/(1024*1024)).toFixed(2)+"MB":n=(u/(1024*1024*1024)).toFixed(2)+"GB";var m=n+"",d=m.indexOf("."),R=m.substring(d+1,d+3);return R=="00"?m.substring(0,d)+m.substr(d+3,2):n}function v(u){if(u){var n=new Date(u),m=n.getFullYear()+"-",d=(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"-",R=(n.getDate()<10?"0"+n.getDate():n.getDate())+" ",t=(n.getHours()<10?"0"+n.getHours():n.getHours())+":",C=(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes())+":",T=n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds();return m+d+R+t+C+T}}function g(u){if(!u||u=="")return"-";var n=new Date(u),m=n.getUTCFullYear(),d=String(n.getUTCMonth()+1).padStart(2,"0"),R=String(n.getUTCDate()).padStart(2,"0"),t=String(n.getUTCHours()).padStart(2,"0"),C=String(n.getUTCMinutes()).padStart(2,"0"),T=String(n.getUTCSeconds()).padStart(2,"0");return"".concat(m,"-").concat(d,"-").concat(R," ").concat(t,":").concat(C,":").concat(T)}},67255:function(W,j,e){e.d(j,{O:function(){return O},j:function(){return c}});function O(){var v=localStorage.getItem("dpanel-pagesize");return v=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(v!=null?v:"20")}}function c(v){var g="dpanel-table-column-".concat(v),u={};if(localStorage.getItem(g)){var n;u=JSON.parse((n=localStorage.getItem(g))!==null&&n!==void 0?n:"{}")}return{defaultValue:u,onChange:function(d){localStorage.setItem("dpanel-table-column-".concat(v),JSON.stringify(d))}}}}}]);
