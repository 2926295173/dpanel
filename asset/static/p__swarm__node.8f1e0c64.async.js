"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3763],{52645:function(Fe,Q,n){n.d(Q,{Z:function(){return y}});var ne=n(87462),v=n(67294),Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},x=Y,de=n(84089),U=function(ie,k){return v.createElement(de.Z,(0,ne.Z)({},ie,{ref:k,icon:x}))},K=v.forwardRef(U),y=K},91806:function(Fe,Q,n){n.d(Q,{Z:function(){return y}});var ne=n(87462),v=n(67294),Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},x=Y,de=n(84089),U=function(ie,k){return v.createElement(de.Z,(0,ne.Z)({},ie,{ref:k,icon:x}))},K=v.forwardRef(U),y=K},75293:function(Fe,Q,n){n.d(Q,{Z:function(){return Y}});var ne=n(25593),v=n(85893);function Y(x){return(0,v.jsx)(ne.Z.Text,{copyable:!0,style:{padding:10,display:x.block?"block":"",background:"#24292f",color:"#ffffff"},children:x.content})}},47900:function(Fe,Q,n){n.r(Q),n.d(Q,{default:function(){return Mt}});var ne=n(15009),v=n.n(ne),Y=n(99289),x=n.n(Y),de=n(5574),U=n.n(de),K=n(94359),y=n(24494),o=n(36146),ie=n(184),k=n(5966),Me=n(52688),$e=n(83622),ue=n(86250),h=n(67294),e=n(85893);function Be(c){var D=(0,h.useRef)(),i=new o.Uo("swarm");return(0,e.jsxs)(ie.a,{title:i.format("nodeInitTitle"),trigger:(0,e.jsx)($e.ZP,{type:"primary",children:i.format("nodeInitTitle")}),onFinish:function(){var P=x()(v()().mark(function F(C){var j;return v()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,y.UK)({advertiseAddr:C.advertiseAddr,listenAddr:C.listenAddr,dataPathAddr:C.dataPathAddr,autoLockManagers:C.autoLockManagers,forceNewCluster:C.forceNewCluster,subnet:C.subnet});case 2:return j=p.sent,c.onFinish&&c.onFinish(),p.abrupt("return",!0);case 5:case"end":return p.stop()}},F)}));return function(F){return P.apply(this,arguments)}}(),formRef:D,onOpenChange:function(F){var C;!F&&(!((C=D.current)===null||C===void 0)&&C.resetFields)&&D.current.resetFields()},children:[(0,e.jsx)(k.Z,{name:"advertiseAddr",label:i.format("nodeInitAdvertiseAddr"),tooltip:i.format("nodeInitAdvertiseAddrTip"),required:!0,rules:[{required:!0}],placeholder:"172.16.1.13"}),(0,e.jsx)(k.Z,{name:"listenAddr",label:i.format("nodeInitListenAddr"),tooltip:i.format("nodeInitListenAddrTip"),initialValue:"0.0.0.0",required:!0,rules:[{required:!0}]}),(0,e.jsx)(k.Z,{name:"subnet",label:i.format("nodeInitSubnet"),initialValue:"10.0.0.0/16"}),(0,e.jsxs)(ue.Z,{gap:30,children:[(0,e.jsx)(Me.Z,{label:i.format("nodeInitAutoLockManagers"),name:"autoLockManagers",tooltip:i.format("nodeInitAutoLockManagersTip")}),(0,e.jsx)(Me.Z,{label:i.format("nodeInitForceNewCluster"),name:"forceNewCluster",tooltip:i.format("nodeInitForceNewClusterTip")})]})]})}var Ee=n(3616),Je=n(86615),l=n(64317),I=n(97462),b=n(62370),le=n(40056),ce=n(75293),re=n(82346);function ve(c){var D,i=new o.Uo("swarm"),P=(0,h.useRef)(),F=(0,h.useState)(),C=U()(F,2),j=C[0],B=C[1],p=(0,re.useModel)("@@initialState"),_=p.initialState;(0,h.useEffect)(function(){c.detail&&c.type=="add"&&w(c.detail,"worker")},[c.detail]);function w(T,g){return oe.apply(this,arguments)}function oe(){return oe=x()(v()().mark(function T(g,L){var N,J,H;return v()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:B("docker swarm join --token ".concat(L=="manager"?(N=g.swarm)===null||N===void 0?void 0:N.JoinTokens.Manager:(J=g.swarm)===null||J===void 0?void 0:J.JoinTokens.Worker," ").concat((g==null?void 0:g.node)&&(g==null||(H=g.node.ManagerStatus)===null||H===void 0?void 0:H.Addr)));case 1:case"end":return R.stop()}},T)})),oe.apply(this,arguments)}return(0,e.jsxs)(ie.a,{drawerProps:{width:Ee.R_},submitter:!1,formRef:P,onOpenChange:function(g){var L;!g&&(!((L=P.current)===null||L===void 0)&&L.resetFields)&&P.current.resetFields(),!g&&c.onFinish&&c.onFinish()},title:i.format("nodeJoinTitleOption.".concat(c.type)),trigger:(0,e.jsx)($e.ZP,{children:i.format("nodeJoinTitleOption.".concat(c.type))}),onValuesChange:function(){var T=x()(v()().mark(function g(L,N){var J,H;return v()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(B(""),!N.dockerEnvName){R.next=12;break}return R.prev=2,R.next=5,(0,y.vb)({dockerEnvName:N.dockerEnvName,role:N.role,type:c.type});case 5:J=R.sent,w(J.data,N.role),R.next=12;break;case 9:R.prev=9,R.t0=R.catch(2),(H=P.current)===null||H===void 0||H.resetFields(["dockerEnvName"]);case 12:c.type=="add"&&c.detail&&w(c.detail,N.role);case 13:case"end":return R.stop()}},g,null,[[2,9]])}));return function(g,L){return T.apply(this,arguments)}}(),children:[(0,e.jsx)(Je.Z.Group,{label:i.format("nodeJoinRole"),name:"role",initialValue:"worker",options:i.option("nodeAddRoleOption",["manager","worker"])}),c.type=="join"&&(0,e.jsx)(l.Z,{label:i.format("nodeJoinDockerEnvName"),name:"dockerEnvName",placeholder:i.format("nodeJoinDockerEnvNameEmpty"),options:_==null||(D=_.dockerEnv)===null||D===void 0?void 0:D.list.map(function(T){return{value:T.name,label:T.title}})},"env"),c.type=="join"&&!j&&(0,e.jsx)(I.Z,{name:["role"],children:function(g){var L=g.role;return(0,e.jsx)(b.Z,{label:i.format("nodeJoinCommandManual"),children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)(le.Z,{type:"warning",message:i.format("nodeJoinCommandManualTip")}),(0,e.jsx)(ce.Z,{block:!0,content:"docker swarm join-token ".concat(L)})]})})}}),j&&(0,e.jsx)(b.Z,{label:i.format("nodeJoinCommandJoin"),children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)(le.Z,{message:i.format("nodeJoinCommandJoinTip",{target:i.format("nodeJoinCommandJoinTargetOption.".concat(c.type))})}),(0,e.jsx)(ce.Z,{block:!0,content:j})]})})]})}var De=n(43425),je=n(74842),be=n(30159),Ae=n(87784),ae=n(87462),Te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.5 360.3a7.95 7.95 0 00-12.9 0l-178 246c-3.8 5.3 0 12.7 6.5 12.7H381c10.2 0 19.9-4.9 25.9-13.2L512 460.4l105.2 145.4c6 8.3 15.6 13.2 25.9 13.2H690c6.5 0 10.3-7.4 6.5-12.7l-178-246z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"up-circle",theme:"outlined"},Ze=Te,q=n(84089),we=function(D,i){return h.createElement(q.Z,(0,ae.Z)({},D,{ref:i,icon:Ze}))},Ve=h.forwardRef(we),xe=Ve,ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},fe=ye,We=function(D,i){return h.createElement(q.Z,(0,ae.Z)({},D,{ref:i,icon:fe}))},me=h.forwardRef(We),Le=me,he=n(45605),Pe=n(91806),Qe=n(60433),G=n(38345),se=n(42075),Ye=n(96074),$=n(26412),Ne=n(66309),pe=n(80821),ze=n(5251),dt=n(91058),ut=n(76428),ct=n(24963),vt=n(97269),qe=n(25593),ft=n(84567);function _e(c){var D=(0,h.useRef)(),i=new o.Uo("swarm");return(0,e.jsx)(pe.Z,{buttonProps:{type:"primary",danger:!0},confirmProps:{title:o.FD.format("title.tip"),onOpenChange:function(F,C){var j;!((j=D.current)===null||j===void 0)&&j.resetFields&&D.current.resetFields()},description:(0,e.jsx)(vt.A,{submitter:!1,formRef:D,children:(0,e.jsxs)(se.Z,{style:{width:600,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(qe.Z.Text,{children:(0,e.jsx)("ul",{children:i.prefix("removeButtonTipOption",4).map(function(P,F){return(0,e.jsx)("li",{children:P},F)})})}),(0,e.jsx)(b.Z,{name:"enableForce",valuePropName:"checked",children:(0,e.jsxs)(ft.Z,{disabled:!!c.nodeId,children:[o.FD.format("listManageExitForce"),"\uFF1F"]})})]})})},action:x()(v()().mark(function P(){var F;return v()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,y.QB)({nodeId:c.nodeId,force:(F=D.current)===null||F===void 0?void 0:F.getFieldValue("enableForce")}));case 1:case"end":return j.stop()}},P)})),onSuccess:function(){c.onFinish&&c.onFinish()},children:c.title},"console")}var mt=n(94617),ht=(0,h.forwardRef)(function(c,D){var i,P,F,C,j,B,p,_,w,oe,T,g,L,N,J,H,Se,R,Ie,M,O,s,Z,A,V,d,r,u,S,E,z,W,Ce,Oe,Ke;(0,h.useImperativeHandle)(D,function(){return{show:function(a){var ee,f,Re;!((ee=a.Spec)===null||ee===void 0)&&ee.Labels&&((f=lt.current)===null||f===void 0||f.setFieldValue("labels",Object.keys((Re=a.Spec)===null||Re===void 0?void 0:Re.Labels).map(function(Ue){var te,Ge,Xe;return{name:Ue,value:(te=a.Spec)!==null&&te!==void 0&&te.Labels&&(Ge=a.Spec)!==null&&Ge!==void 0&&Ge.Labels[Ue]?(Xe=a.Spec)===null||Xe===void 0?void 0:Xe.Labels[Ue]:""}}))),ge(a),ke(!0)}}});var Et=(0,h.useState)(!1),at=U()(Et,2),ot=at[0],ke=at[1],lt=(0,h.useRef)(),bt=(0,h.useState)(),st=U()(bt,2),t=st[0],ge=st[1],X=new o.Uo("swarm"),He=new o.Uo("system.home.overview"),At=(0,h.useContext)(ct.Z),Tt=At.message;return(0,e.jsx)(ie.a,{title:X.format("nodeDetailTitle",{name:t==null||(i=t.Description)===null||i===void 0?void 0:i.Hostname}),open:ot,drawerProps:{forceRender:!0,width:Ee.R_},onOpenChange:function(a){ke(a),!a&&c.onFinish&&c.onFinish()},onFinish:function(){var m=x()(v()().mark(function a(ee){var f,Re;return v()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,(0,y.Zc)({nodeId:(f=t==null?void 0:t.ID)!==null&&f!==void 0?f:"",labels:ee.labels});case 2:return Re=te.sent,ge(Re.data.detail),Tt.success(o.FD.format("finish")),te.abrupt("return",!1);case 6:case"end":return te.stop()}},a)}));return function(a){return m.apply(this,arguments)}}(),formRef:lt,children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,children:[(0,e.jsx)(G.Z,{title:(0,e.jsx)(De.Z,{}),ghost:!0,subTitle:o.FD.format("listManage"),children:(0,e.jsxs)(se.Z,{wrap:!0,children:[(0,e.jsx)(pe.Z,{buttonProps:{disabled:(t==null||(P=t.Spec)===null||P===void 0?void 0:P.Availability)=="active"||(t==null||(F=t.Status)===null||F===void 0?void 0:F.State)!="ready",icon:(0,e.jsx)(je.Z,{})},action:x()(v()().mark(function m(){var a;return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",availability:"active"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(a){ge(a.data.detail)},tips:X.format("nodeListStatusOptionTip.active"),children:o.FD.format("listManageUnpause")}),(0,e.jsx)(pe.Z,{action:x()(v()().mark(function m(){var a;return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",availability:"pause"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(a){ge(a.data.detail)},tips:X.format("nodeListStatusOptionTip.pause"),buttonProps:{disabled:(t==null||(C=t.Spec)===null||C===void 0?void 0:C.Availability)=="pause"||(t==null||(j=t.Status)===null||j===void 0?void 0:j.State)!="ready",icon:(0,e.jsx)(be.Z,{})},children:o.FD.format("listManagePause")}),(0,e.jsx)(pe.Z,{action:x()(v()().mark(function m(){var a;return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",availability:"drain"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(a){ge(a.data.detail)},tips:X.format("nodeListStatusOptionTip.drain"),buttonProps:{disabled:(t==null||(B=t.Spec)===null||B===void 0?void 0:B.Availability)=="drain"||(t==null||(p=t.Status)===null||p===void 0?void 0:p.State)!="ready",icon:(0,e.jsx)(Ae.Z,{})},children:o.FD.format("listManageStop")}),(0,e.jsx)(Ye.Z,{type:"vertical"}),(t==null||(_=t.Spec)===null||_===void 0?void 0:_.Role)=="worker"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(pe.Z,{action:x()(v()().mark(function m(){var a;return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",role:"manager"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(a){ge(a.data.detail)},buttonProps:{disabled:(t==null||(w=t.Spec)===null||w===void 0?void 0:w.Availability)=="drain"||(t==null||(oe=t.Status)===null||oe===void 0?void 0:oe.State)!="ready",icon:(0,e.jsx)(xe,{}),type:"primary"},children:X.format("nodeDetailManageManager")})}),(t==null||(T=t.Spec)===null||T===void 0?void 0:T.Role)=="manager"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(pe.Z,{action:x()(v()().mark(function m(){var a;return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",role:"worker"}));case 1:case"end":return f.stop()}},m)})),onSuccess:function(a){ge(a.data.detail)},buttonProps:{disabled:(t==null||(g=t.Spec)===null||g===void 0?void 0:g.Availability)=="drain"||(t==null||(L=t.Status)===null||L===void 0?void 0:L.State)!="ready",icon:(0,e.jsx)(Le,{}),type:"primary"},children:X.format("nodeDetailManageWorker")})}),(0,e.jsx)(Ye.Z,{type:"vertical"}),(0,e.jsx)(_e,{title:o.FD.format("listManageDelete"),nodeId:t==null?void 0:t.ID,onFinish:function(){ke(!1),c.onFinish&&c.onFinish()}})]})}),(0,e.jsx)(G.Z,{title:(0,e.jsx)(he.Z,{}),subTitle:o.FD.format("listManageDetail"),ghost:!0,children:(0,e.jsxs)($.Z,{column:1,bordered:!0,styles:{label:{width:150}},children:[(0,e.jsxs)($.Z.Item,{label:"Hostname",children:[(0,e.jsx)(ut.Z,{title:t==null?void 0:t.ID})," - ",t==null||(N=t.Description)===null||N===void 0?void 0:N.Hostname," - ",(0,e.jsx)(Ne.Z,{color:"blue",children:t==null||(J=t.Spec)===null||J===void 0?void 0:J.Role})," ",t&&(0,e.jsx)(K.Z,{status:"swarm.".concat((H=t.Status)===null||H===void 0?void 0:H.State),tip:X.format("nodeListRunStatusOptionTipOption.".concat((Se=(R=t.Status)===null||R===void 0?void 0:R.State)!==null&&Se!==void 0?Se:"ready"))}),t&&(0,e.jsx)(K.Z,{status:"swarm.".concat((Ie=t.Spec)===null||Ie===void 0?void 0:Ie.Availability),tip:X.format("nodeListStatusOptionTip.".concat((M=(O=t.Spec)===null||O===void 0?void 0:O.Availability)!==null&&M!==void 0?M:"active"))})]}),(0,e.jsx)($.Z.Item,{label:He.format("basicDockerTitleSystemVersion"),children:"".concat(t==null||(s=t.Description)===null||s===void 0||(s=s.Platform)===null||s===void 0?void 0:s.OS,` - 
              `).concat(t==null||(Z=t.Description)===null||Z===void 0||(Z=Z.Platform)===null||Z===void 0?void 0:Z.Architecture,` - 
              `).concat(t==null||(A=t.Description)===null||A===void 0||(A=A.Engine)===null||A===void 0?void 0:A.EngineVersion)}),(0,e.jsxs)($.Z.Item,{label:"Cpu",children:[((V=t==null||(d=t.Description)===null||d===void 0||(d=d.Resources)===null||d===void 0?void 0:d.NanoCPUs)!==null&&V!==void 0?V:0)/1e9," ",o.FD.format("unitCpu")]}),(0,e.jsx)($.Z.Item,{label:"Memory",children:(0,ze.FI)((r=t==null||(u=t.Description)===null||u===void 0||(u=u.Resources)===null||u===void 0?void 0:u.MemoryBytes)!==null&&r!==void 0?r:0)}),(0,e.jsx)($.Z.Item,{label:He.format("basicDockerTitlePluginsVolume"),children:(0,e.jsx)(se.Z,{children:(t==null||(S=t.Description)===null||S===void 0||(S=S.Engine)===null||S===void 0?void 0:S.Plugins)&&(t==null||(E=t.Description)===null||E===void 0||(E=E.Engine)===null||E===void 0?void 0:E.Plugins.filter(function(m){return m.Type=="Volume"}).map(function(m){return m.Name}))})}),(0,e.jsx)($.Z.Item,{label:He.format("basicDockerTitlePluginsNetwork"),children:(0,e.jsx)(se.Z,{wrap:!0,children:(t==null||(z=t.Description)===null||z===void 0||(z=z.Engine)===null||z===void 0?void 0:z.Plugins)&&(t==null||(W=t.Description)===null||W===void 0||(W=W.Engine)===null||W===void 0?void 0:W.Plugins.filter(function(m){return m.Type=="Network"}).map(function(m){return m.Name}))})}),(0,e.jsx)($.Z.Item,{label:He.format("basicDockerTitleLogDriver"),children:(0,e.jsx)(se.Z,{wrap:!0,children:(t==null||(Ce=t.Description)===null||Ce===void 0||(Ce=Ce.Engine)===null||Ce===void 0?void 0:Ce.Plugins)&&(t==null||(Oe=t.Description)===null||Oe===void 0||(Oe=Oe.Engine)===null||Oe===void 0?void 0:Oe.Plugins.filter(function(m){return m.Type=="Log"}).map(function(m){return m.Name}))})})]})}),t&&t.ID&&ot&&(0,e.jsx)(G.Z,{title:(0,e.jsx)(Pe.Z,{}),subTitle:X.format("nodeDetailServiceList"),headStyle:{paddingBottom:0},ghost:!0,children:(0,e.jsx)(mt.Z,{showWithNodeId:t.ID,tableProps:{search:!1,ghost:!0}})}),(t==null||(Ke=t.Spec)===null||Ke===void 0?void 0:Ke.Labels)&&(0,e.jsx)(G.Z,{title:(0,e.jsx)(Qe.Z,{}),ghost:!0,subTitle:X.format("nodeDetailTagList"),children:(0,e.jsx)(dt.Z,{drawerProps:{ghost:!0},name:"labels",showAddButton:!0,addButtonLabel:X.format("nodeDetailTagAdd")})})]})})}),pt=ht,St=n(98009),gt=function(D,i){return h.createElement(q.Z,(0,ae.Z)({},D,{ref:i,icon:St.Z}))},Dt=h.forwardRef(gt),et=Dt,jt=n(30432),Zt=function(D,i){return h.createElement(q.Z,(0,ae.Z)({},D,{ref:i,icon:jt.Z}))},xt=h.forwardRef(Zt),yt=xt,It=n(52645),Ct=n(74453),Ot=n(9773),tt=n(32983),Rt=n(60940),$t=n(40411),Pt=n(83062),Ft=n(22181),nt=n(89240),it={xs:1,sm:2,md:2,lg:2,xl:3,xxl:4},rt={display:"flex",justifyContent:"flex-end",width:100};function Mt(){var c=(0,h.useState)(),D=U()(c,2),i=D[0],P=D[1],F=(0,h.useState)(0),C=U()(F,2),j=C[0],B=C[1],p=new o.Uo("swarm"),_=(0,h.useRef)(),w=(0,h.useRef)(),oe=(0,h.useState)(),T=U()(oe,2),g=T[0],L=T[1],N=(0,h.useState)(),J=U()(N,2),H=J[0],Se=J[1],R=(0,re.useModel)("@@initialState"),Ie=R.refresh;return(0,h.useEffect)(function(){(0,y.JC)().then(function(M){var O;P(M.data),!((O=w.current)===null||O===void 0)&&O.reloadAndRest&&w.current.reloadAndRest()})},[j]),(0,e.jsxs)(Ct._z,{extra:[i&&i.status.isManage&&(0,e.jsx)(ve,{type:"add",detail:i,onFinish:function(){B(j+1)}},"join"),i&&i.status.isNode&&(0,e.jsx)(_e,{title:p.format("nodeDetailDeleteButtonOption.".concat(i.status.isManage?"delete":"leave")),onFinish:function(){i.status.isManage?Ie():B(j+1)}},"leave")],children:[(0,e.jsx)(pt,{ref:_,onFinish:function(){B(j+1)}}),(0,e.jsxs)(G.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(!i||!i.status.isNode)&&(0,e.jsx)(ue.Z,{justify:"center",style:{height:"58vh"},vertical:!0,children:(0,e.jsx)(tt.Z,{image:tt.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(se.Z,{direction:"vertical",size:[0,20],children:[p.format("nodeDetailJoinTip"),(0,e.jsxs)(se.Z,{children:[(0,e.jsx)(ve,{type:"join",detail:i,onFinish:function(){B(j+1)}},"join"),(0,e.jsx)(Be,{onFinish:function(){Ie(),B(j+1)}})]})]})})}),i&&i.status.isNode&&i.info&&i.info.LocalNodeState!="error"&&(0,e.jsxs)(G.Z,{title:(0,e.jsx)(et,{}),subTitle:p.format("nodeDetailCurrent"),direction:"column",gutter:[0,20],children:[(0,e.jsx)(G.Z,{ghost:!0,children:(0,e.jsxs)($.Z,{column:it,styles:{label:rt},children:[(0,e.jsx)($.Z.Item,{label:"Id",children:i.info.NodeID}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listRunStatus"),children:(0,e.jsx)(K.Z,{status:"swarm.".concat(i.info.LocalNodeState),tip:p.format("nodeListRunStatusTipOption.".concat(i.info.LocalNodeState))})}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listType"),children:p.format("nodeAddRoleOption.".concat(i.info.ControlAvailable?"manager":"worker"))})]})}),i.info.RemoteManagers&&!i.status.isManage&&(0,e.jsx)(G.Z,{ghost:!0,title:(0,e.jsx)(et,{}),subTitle:p.format("nodeDetailManager"),children:(0,e.jsx)(Rt.Z,{pagination:!1,columns:[{title:o.FD.format("listName"),dataIndex:"NodeID"},{title:o.FD.format("listIpAddress"),dataIndex:"Addr"}],dataSource:i.info.RemoteManagers})})]}),i&&i.status.isManage&&i.swarm&&(0,e.jsx)(G.Z,{title:(0,e.jsx)(yt,{}),subTitle:p.format("nodeDetailSwarm"),direction:"column",gutter:[0,15],children:(0,e.jsx)(G.Z,{ghost:!0,children:(0,e.jsxs)($.Z,{column:it,styles:{label:rt},children:[(0,e.jsx)($.Z.Item,{label:o.FD.format("listName"),children:i.swarm.ID}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listTitle"),children:i.swarm.Spec&&i.swarm.Spec.Name}),(0,e.jsxs)($.Z.Item,{label:o.FD.format("listResource"),children:[g&&(0,nt.PD)(g.cpu)," ",o.FD.format("unitCpu")," / ",(0,ze.FI)(g==null?void 0:g.memory)]}),(0,e.jsxs)($.Z.Item,{label:"".concat(p.format("nodeDetailSwarmWorker")," / ").concat(p.format("nodeDetailSwarmManager")),children:[i.info.Nodes," / ",i.info.Managers]}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listCreatedAt"),children:new Date(i.swarm.CreatedAt).toLocaleString()}),(0,e.jsx)($.Z.Item,{label:o.FD.format("listUpdatedAt"),children:new Date(i.swarm.UpdatedAt).toLocaleString()})]})})}),i&&i.status.isManage&&i.info.LocalNodeState!="error"&&(0,e.jsx)(G.Z,{title:(0,e.jsx)(Qe.Z,{}),subTitle:p.format("nodeDetailSwarmNodeList"),children:(0,e.jsx)(Ot.Z,{scroll:{x:"max-content"},rowKey:"ID",actionRef:w,pagination:!1,ghost:!0,search:!1,request:x()(v()().mark(function M(){var O,s,Z,A,V;return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,y.HN)();case 2:return O=r.sent,s={cpu:0,memory:0},O.data.list&&O.data.list.forEach(function(u){var S,E,z,W;s.cpu+=(S=(E=u.Description)===null||E===void 0||(E=E.Resources)===null||E===void 0?void 0:E.NanoCPUs)!==null&&S!==void 0?S:0,s.memory+=(z=(W=u.Description)===null||W===void 0||(W=W.Resources)===null||W===void 0?void 0:W.MemoryBytes)!==null&&z!==void 0?z:0}),L(s),r.next=8,(0,y.kM)();case 8:return Z=r.sent,r.next=11,(0,y.XX)();case 11:return A=r.sent,A.data&&A.data.list&&(V=[],A.data.list.forEach(function(u){if(u.Status.State=="running"){var S,E=Z.data&&Z.data.list&&((S=Z.data.list.find(function(z){return z.ID==u.ServiceID}))===null||S===void 0||(S=S.Spec)===null||S===void 0?void 0:S.Name);(!E||E=="")&&(E=u.ServiceID),V.push({nodeId:u.NodeID,serviceName:E,taskId:u.ID})}}),Se(V)),r.abrupt("return",{data:O.data.list,success:!0,total:O.data.list.length});case 14:case"end":return r.stop()}},M)})),columns:[{title:o.FD.format("listName"),render:function(O,s,Z,A,V){var d,r;return(0,e.jsxs)(se.Z,{children:[(0,e.jsx)(qe.Z.Link,{onClick:function(){var S;(S=_.current)===null||S===void 0||S.show(s)},children:(d=(r=s.Description)===null||r===void 0?void 0:r.Hostname)!==null&&d!==void 0?d:s.ID})," ",i.node&&s.ID==i.node.ID&&(0,e.jsx)($t.Z,{status:"processing"})]})}},{title:o.FD.format("listRole"),dataIndex:["Spec","Role"],render:function(O,s,Z,A,V){var d,r,u,S;return(0,e.jsx)(Ne.Z,{color:p.format("nodeAddRoleColorOption.".concat((d=(r=s.Spec)===null||r===void 0?void 0:r.Role)!==null&&d!==void 0?d:"worker")),children:p.format("nodeAddRoleOption.".concat((u=(S=s.Spec)===null||S===void 0?void 0:S.Role)!==null&&u!==void 0?u:"worker"))})}},{title:"CPU / Memory",render:function(O,s,Z,A,V){var d,r,u;return"".concat((0,nt.PD)((d=s.Description)===null||d===void 0||(d=d.Resources)===null||d===void 0?void 0:d.NanoCPUs)," ").concat(o.FD.format("unitCpu")," / ").concat((0,ze.FI)((r=(u=s.Description)===null||u===void 0||(u=u.Resources)===null||u===void 0?void 0:u.MemoryBytes)!==null&&r!==void 0?r:0))}},{title:o.FD.format("listRunTask"),render:function(O,s,Z,A,V){var d={};return H&&H.filter(function(r){return r.nodeId==s.ID}).forEach(function(r){d[r.serviceName]||(d[r.serviceName]=0),d[r.serviceName]+=1}),Object.keys(d).length>0?Object.keys(d).map(function(r,u){return(0,e.jsx)(Pt.Z,{title:r,children:(0,e.jsx)(Ne.Z,{color:"success",children:d[r]})},"".concat(r,"-").concat(u))}):(0,e.jsx)(Ne.Z,{children:"0"})}},{title:o.FD.format("listApiVersion"),dataIndex:["Description","Engine","EngineVersion"]},{title:o.FD.format("listIpAddress"),dataIndex:["Status","Addr"]},{title:o.FD.format("listRunStatus"),render:function(O,s,Z,A,V){var d,r,u=(d=(r=s.Status)===null||r===void 0?void 0:r.State)!==null&&d!==void 0?d:"ready";return(0,e.jsx)(K.Z,{status:"swarm.".concat(u),tip:p.format("nodeListRunStatusTipOption.".concat(u))})}},{title:o.FD.format("listStatus"),render:function(O,s,Z,A,V){var d,r,u,S;return(0,e.jsx)(K.Z,{status:"swarm.".concat((d=(r=s.Spec)===null||r===void 0?void 0:r.Availability)!==null&&d!==void 0?d:"active"),tip:p.format("nodeListStatusOptionTip.".concat((u=(S=s.Spec)===null||S===void 0?void 0:S.Availability)!==null&&u!==void 0?u:"active"))})}}],toolBarRender:function(){return[(0,e.jsx)(pe.Z,{action:function(){return(0,y.kp)()},onSuccess:function(){var s,Z;return!((s=w.current)===null||s===void 0)&&s.reloadAndRest&&((Z=w.current)===null||Z===void 0||Z.reloadAndRest()),!0},onError:function(){var s,Z;return!((s=w.current)===null||s===void 0)&&s.reset&&((Z=w.current)===null||Z===void 0||Z.reset()),!0},confirmProps:{description:p.format("nodeListManagePruneTip")},buttonProps:{icon:(0,e.jsx)(It.Z,{})},children:o.FD.format("listManagePrune")},"clear")]}})}),i&&i.status.isNode&&i.info.LocalNodeState=="error"&&(0,e.jsx)(Ft.ZP,{status:"error",title:p.format(["nodeListRunStatusTipOption.error","nodeListRunStatusTipOption.exit"]),subTitle:i.info.Error})]})]})}},89240:function(Fe,Q,n){n.d(Q,{HJ:function(){return h},PD:function(){return Be},Rk:function(){return e},pM:function(){return Ee},yi:function(){return ue},zY:function(){return Je}});var ne=n(64599),v=n.n(ne),Y=n(5251),x=n(10531),de=n(43836),U=n(17179),K=n(74911),y=n(17637),o=n(58353),ie=/^([1-9]|[1-5]?[0-9]{2,4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$/m;function k(l){return ie.test(l)?parseInt(l,10):0}function Me(l){typeof l!="string"&&(l=l.toString());var I=x.Z(l,"-",2),b=de.Z(I,k);return b.length==1&&b.push(b[0]),b}function $e(l,I){typeof l!="string"&&(l=l.toString());var b=null,le=l.indexOf(":");le>=0&&(b=l.substring(0,le),l=l.substring(le+1)),I=typeof I=="number"?I:k(I);var ce=Me(l),re=Math.min(ce[0],I),ve=Math.max(ce[1],I);return b?b+":"+re+"-"+ve:re+"-"+ve}function ue(l){if(!l||!l.HostConfig||!l.HostConfig.PortBindings)return[];var I=[],b=l.HostConfig.PortBindings,le=U.Z(b),ce=K.Z(le,function(re){return x.Z(re,"/")[1]});return y.Z(ce,function(re,ve){var De={},je=v()(re),be;try{for(je.s();!(be=je.n()).done;){var Ae=be.value,ae=v()(b[Ae]),Te;try{for(ae.s();!(Te=ae.n()).done;){var Ze=Te.value;De[Ze.HostIp]=De[Ze.HostIp]||[],De[Ze.HostIp].push(Ae)}}catch(q){ae.e(q)}finally{ae.f()}}}catch(q){je.e(q)}finally{je.f()}y.Z(De,function(q,we){var Ve=o.Z(q,function(fe){return parseInt(x.Z(fe,"/")[0],10)}),xe=-1,ye=-1;y.Z(Ve,function(fe){var We=x.Z(fe,"/"),me=parseInt(We[0],10),Le=b[fe][0];b[fe].shift();var he=k(Le.HostPort);if(he>0){if(I.length>0&&xe===he-1&&ye===me-1){I[I.length-1].host=$e(I[I.length-1].host,he),I[I.length-1].dest=$e(I[I.length-1].dest,me),xe=he,ye=me;return}xe=he,ye=me}else xe=-1,ye=-1;var Pe=Le.HostPort.toString();we&&(Pe="".concat(we,":").concat(Pe)),I.push({host:Pe,dest:me.toString(),protocol:ve})})})}),I}function h(l){return(0,Y.fi)(l,"/")}function e(l){return l?(0,Y.FI)(l):"64M"}function Be(l){return l&&l>1e8?l/1e9:0}function Ee(l){return l?l/1024/1024:0}function Je(l){return"".concat(h(l),".pod.dpanel.local")}}}]);
