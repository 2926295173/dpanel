(self.webpackChunk=self.webpackChunk||[]).push([[4214],{80821:function(Z,I,e){"use strict";e.d(I,{Z:function(){return B}});var P=e(5574),d=e.n(P),v=e(24963),m=e(86738),p=e(28036),D=e(83062),O=e(67294),h=e(85893);function B(a){var u=(0,O.useState)(!1),o=d()(u,2),R=o[0],i=o[1],f=(0,O.useContext)(v.Z),F=f.lang,j=f.notice,y=f.message,x=function(){i(!0);var g=a.action();g instanceof Promise?g.then(function(_){if(i(!1),_){typeof a.onSuccess=="function"&&a.onSuccess(_);var t="";a.messageSuccess?typeof a.messageSuccess=="function"?t=a.messageSuccess(_):t=a.messageSuccess.indexOf("notification.")==0?F(a.messageSuccess):a.messageSuccess:t=F("notification.finish"),a.asynced?y.info(t):y.success(t)}}).catch(function(_){i(!1),typeof a.onError=="function"&&a.onError(_)}):i(!1)};return a.confirm?(0,h.jsx)(m.Z,{style:{width:500},title:a.confirmTitle?a.confirmTitle:F("notification.title.tip"),description:typeof a.confirm=="string"&&a.confirm.indexOf("notification.")==0?F(a.confirm):a.confirm,onConfirm:x,okText:"Yes",cancelText:"No",onOpenChange:a.confirmOnOpenChange,children:(0,h.jsx)(p.ZP,{block:a.block,disabled:a.disabled,icon:a.icon,loading:R,danger:a.danger,type:a.type,children:a.children})}):(0,h.jsx)(D.Z,{title:a.tips,children:(0,h.jsx)(p.ZP,{block:a.block,style:a.ghost?{padding:0,height:"auto"}:{},disabled:a.disabled,icon:a.icon,loading:R,onClick:x,danger:a.danger,type:a.type,children:a.children})})}},92754:function(Z,I,e){"use strict";var P=e(5574),d=e.n(P),v=e(67294),m=e(82346),p=e(38703),D=e(85893),O=(0,v.forwardRef)(function(h,B){var a=(0,v.useState)(""),u=d()(a,2),o=u[0],R=u[1];(0,v.useImperativeHandle)(B,function(){return{setFinish:function(){y({finish:{downloading:100,extracting:100}})},setStart:function(l){l&&R(l),y({start:{downloading:0,extracting:0}})},close:function(){i.progress.close("image:pull:"+o),y({start:{downloading:0,extracting:0}})}}});var i=(0,m.useModel)("subscriber");i.addDataHandler("image:pull:"+o,function(x){y(x.data)});var f=(0,v.useState)(),F=d()(f,2),j=F[0],y=F[1];return(0,v.useEffect)(function(){return y({start:{downloading:0,extracting:0}}),function(){i.progress.close("image:pull:"+o)}},[]),(0,D.jsx)(D.Fragment,{children:j&&Object.keys(j).map(function(x){return(0,D.jsx)(p.Z,{percent:j[x].downloading,success:{percent:j[x].extracting}},x)})})});I.Z=O},31810:function(Z,I,e){"use strict";e.r(I),e.d(I,{default:function(){return me}});var P=e(19632),d=e.n(P),v=e(15009),m=e.n(v),p=e(99289),D=e.n(p),O=e(5574),h=e.n(O),B=e(90078),a=e(78099),u=e(37476),o=e(62370),R=e(5966),i=e(31418),f=e(28036),F=e(25593),j=e(42075),y=e(66309),x=e(96074),l=e(83062),g=e(84567),_=e(50136),t=e(67294),w=e(82346),K=e(18148),H=e(5251),N=e(80821),q=e(43425),ee=e(87462),te=e(3803),ne=e(84089),ae=function(G,V){return t.createElement(ne.Z,(0,ee.Z)({},G,{ref:V,icon:te.Z}))},re=t.forwardRef(ae),ue=re,oe=e(58638),ie=e(1912),se=e(28307),le=e(96042),Y=e(67255),ce=e(24963),de=e(3393),fe=e(93162),r=e(85893);function me(){var z=(0,t.useContext)(ce.Z),G=z.message,V=z.notice,ge=z.lang,S=(0,t.useRef)(),ve=(0,t.useState)({force:!1}),X=h()(ve,2),pe=X[0],he=X[1],xe=i.Z.useApp(),Ee=(0,t.useState)(1),J=h()(Ee,2),Q=J[0],Re=J[1],k=(0,t.useRef)();return(0,t.useEffect)(function(){var T;(T=S.current)===null||T===void 0||T.reload()},[Q]),(0,r.jsx)(B._z,{header:{extra:[(0,r.jsx)(w.Link,{to:"/image/create",children:(0,r.jsx)(f.ZP,{type:"primary",children:"\u521B\u5EFA&\u5BFC\u5165\u955C\u50CF"},"create")},"create"),(0,r.jsx)(se.Z,{onFinish:function(){var E,n;!((E=S.current)===null||E===void 0)&&E.reloadAndRest&&((n=S.current)===null||n===void 0||n.reloadAndRest())}},"remote")]},children:(0,r.jsx)(a.Z,{scroll:{x:"max-content"},rowKey:"Id",columns:[{title:"\u540D\u79F0",dataIndex:"title",render:function(E,n,A,b,s){var c=n.Id.substring(7,19);return n.Title&&(c=n.Title),(0,r.jsx)(F.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u955C\u50CF\u5907\u6CE8\u540D\u79F0",onChange:function(){var C=D()(m()().mark(function U(W){var L;return m()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,K.Fj)({tag:n.RepoTags[0],title:W});case 2:L=$.sent,Re(Q+1),G.success("\u4FEE\u6539\u955C\u50CF\u540D\u79F0\u6210\u529F");case 5:case"end":return $.stop()}},U)}));function M(U){return C.apply(this,arguments)}return M}()},children:(0,r.jsx)(w.Link,{to:"/image/detail/"+n.Id,children:c},"edit")},"title-".concat(A))}},{title:"Tag",dataIndex:"tag",render:function(E,n,A,b){return(0,r.jsx)(j.Z,{direction:"vertical",style:{textAlign:"left"},children:n.RepoTags.map(function(s,c){return(0,r.jsxs)(j.Z,{children:[(0,r.jsx)(y.Z,{color:"#2db7f5",children:(0,r.jsx)(F.Z.Text,{copyable:!0,title:s,style:{color:"#ffffff"},children:s},"tag-"+c)},"tag-".concat(c)),n.Containers>0&&(0,r.jsx)(y.Z,{color:"cyan",children:"\u4F7F\u7528\u4E2D"},"use-".concat(c))]},c)})},n.Id)}},{title:"\u67B6\u6784",width:80,search:!1,render:function(E,n,A,b,s){if(n.Labels&&n.Labels["com.dpanel.image.arch"])return(0,r.jsx)(y.Z,{children:n.Labels["com.dpanel.image.arch"]},"arch"+n.Id)}},{title:"\u5927\u5C0F",dataIndex:"size",ellipsis:!0,width:"120px",search:!1,sorter:function(E,n){return parseFloat(E.Size)-parseFloat(n.Size)},render:function(E,n,A,b){return(0,r.jsx)("div",{children:(0,H.FI)(parseFloat(n.Size))},n.Id)}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(E,n,A,b){return(0,r.jsx)("div",{children:(0,H.ZM)(n.Created*1e3)},n.Id)},sorter:function(E,n){return E.Created-n.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,fixed:"right",render:function(E,n,A,b){return(0,r.jsxs)(j.Z,{split:(0,r.jsx)(x.Z,{type:"vertical"}),children:[(0,r.jsx)(w.Link,{to:"/image/detail/"+n.Id,children:(0,r.jsx)(l.Z,{title:"\u7BA1\u7406",children:(0,r.jsx)(q.Z,{})})},"edit"),(0,r.jsx)(w.Link,{to:"/app/create/image?imageId="+n.RepoTags[0],children:(0,r.jsx)(l.Z,{title:"\u521B\u5EFA\u5BB9\u5668",children:(0,r.jsx)(ue,{})})},"create")]})}}],request:function(){var T=D()(m()().mark(function E(n,A,b){var s;return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,K.KG)({tag:n.tag,title:n.title});case 2:if(s=C.sent,!(!s||!s.data||!s.data.list)){C.next=5;break}return C.abrupt("return",{data:[],success:!0,total:0});case 5:return s.data.list.map(function(M){var U="";M.RepoTags.map(function(W){s.data.title[W]&&(U=s.data.title[W])}),M.Title=U}),C.abrupt("return",{data:s.data.list,success:!0,total:s.data.list.length});case 7:case"end":return C.stop()}},E)}));return function(E,n,A){return T.apply(this,arguments)}}(),pagination:(0,Y.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:S,tableAlertOptionRender:function(E){var n=E.selectedRowKeys,A=E.selectedRows;return(0,r.jsxs)(j.Z,{size:16,children:[(0,r.jsx)(N.Z,{icon:(0,r.jsx)(oe.Z,{}),action:function(){var s=[];return A.map(function(c){s.push.apply(s,d()(c.RepoTags))}),(0,de.Rb)({md5:s})},onSuccess:function(s){var c=A.map(function(M){return M.RepoTags[0]}),C=new Blob([s],{type:"application/tar"});(0,fe.saveAs)(C,c.join("-")+".tar")},children:"\u5BFC\u51FA"}),(0,r.jsxs)(u.Y,{formRef:k,title:"\u6279\u91CF\u63A8\u9001\u955C\u50CF",trigger:(0,r.jsx)(f.ZP,{icon:(0,r.jsx)(ie.Z,{}),children:"\u540C\u6B65\u81F3\u5176\u5B83\u4ED3\u5E93"}),onFinish:function(){var b=D()(m()().mark(function s(c){var C,M,U;return m()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,K.KX)({md5:n,registryId:c.registryId,newNamespace:c.newNamespace});case 2:return U=L.sent,(C=S.current)===null||C===void 0||C.reload(),!((M=S.current)===null||M===void 0)&&M.clearSelected&&S.current.clearSelected(),L.abrupt("return",!0);case 6:case"end":return L.stop()}},s)}));return function(s){return b.apply(this,arguments)}}(),children:[(0,r.jsx)(o.Z,{name:"registryId",hidden:!0}),(0,r.jsx)(o.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,r.jsxs)(r.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,r.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,r.jsx)(le.Z,{multiple:!0,top:!0,onChangeList:function(s){var c;(c=k.current)===null||c===void 0||c.setFieldValue("registryId",s.map(function(C){return C.id}))}})}),(0,r.jsx)(R.Z,{tooltip:"\u53EF\u4EE5\u901A\u8FC7\u6B64\u9879\u91CD\u65B0\u5B9A\u4E49\u547D\u540D\u7A7A\u95F4\uFF0Cdocker hub \u4E0D\u53D7\u8BE5\u914D\u7F6E\u7684\u5F71\u54CD\u3002 \u914D\u7F6E\u6B64\u9879\u540E mysql:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/mysql:latest\uFF0C dpanel/dpanel:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/dpanel:latest",label:"\u91CD\u5199\u4ED3\u5E93\u547D\u540D\u7A7A\u95F4",name:"newNamespace"})]}),(0,r.jsx)(N.Z,{danger:!0,type:"primary",action:function(){return(0,K.ao)({md5:n,force:pe.force})},onSuccess:function(){var s,c;return!((s=S.current)===null||s===void 0)&&s.reloadAndRest&&((c=S.current)===null||c===void 0||c.reloadAndRest()),!0},onError:function(){var s,c;return!((s=S.current)===null||s===void 0)&&s.reset&&((c=S.current)===null||c===void 0||c.reset()),!0},confirm:(0,r.jsxs)(j.Z,{style:{width:280},direction:"vertical",children:[(0,r.jsx)(F.Z.Text,{children:ge("notification.confirm.title")}),(0,r.jsx)(g.Z,{name:"deleteVolume",onChange:function(s){return he({force:s.target.checked})},children:"\u5F3A\u5236\u5220\u9664\uFF1F"})]}),children:"\u6279\u91CF\u5220\u9664"})]})},tableExtraRender:function(){return(0,r.jsx)(_.Z,{mode:"horizontal",selectedKeys:["all"],items:[{label:(0,r.jsx)(w.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,r.jsx)(w.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})},toolBarRender:function(){return[(0,r.jsx)(N.Z,{action:function(){return(0,K.c7)()},onSuccess:function(){var n,A;return!((n=S.current)===null||n===void 0)&&n.reloadAndRest&&((A=S.current)===null||A===void 0||A.reloadAndRest()),!0},onError:function(){var n,A;return!((n=S.current)===null||n===void 0)&&n.reset&&((A=S.current)===null||A===void 0||A.reset()),!0},confirm:"notification.confirm.title",children:"\u6E05\u7406\u672A\u4F7F\u7528\u955C\u50CF"})]},columnsState:(0,Y.j)("image-list")})})}},3393:function(Z,I,e){"use strict";e.d(I,{Gb:function(){return h},Pn:function(){return o},Rb:function(){return i},YU:function(){return D},ZQ:function(){return y},_U:function(){return a},cd:function(){return F}});var P=e(15009),d=e.n(P),v=e(99289),m=e.n(v),p=e(82346);function D(l){return O.apply(this,arguments)}function O(){return O=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/image/get-detail",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),O.apply(this,arguments)}function h(l){return B.apply(this,arguments)}function B(){return B=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/image/tag-remote",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),B.apply(this,arguments)}function a(l){return u.apply(this,arguments)}function u(){return u=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/image/tag-add",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),u.apply(this,arguments)}function o(l){return R.apply(this,arguments)}function R(){return R=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/image/tag-delete",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),R.apply(this,arguments)}function i(l){return f.apply(this,arguments)}function f(){return f=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/image/export",{method:"POST",data:g,responseType:"blob"}));case 1:case"end":return t.stop()}},l)})),f.apply(this,arguments)}function F(l){return j.apply(this,arguments)}function j(){return j=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/pro/image/get-remote-tag",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),j.apply(this,arguments)}function y(l){return x.apply(this,arguments)}function x(){return x=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/api/app/image/check-upgrade",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),x.apply(this,arguments)}},67255:function(Z,I,e){"use strict";e.d(I,{O:function(){return P},j:function(){return d}});function P(){var v=localStorage.getItem("dpanel-pagesize");return v=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(v!=null?v:"20")}}function d(v){var m="dpanel-table-column-".concat(v),p={};if(localStorage.getItem(m)){var D;p=JSON.parse((D=localStorage.getItem(m))!==null&&D!==void 0?D:"{}")}return{defaultValue:p,onChange:function(h){localStorage.setItem("dpanel-table-column-".concat(v),JSON.stringify(h))}}}},93162:function(Z,I,e){var P,d,v;(function(m,p){d=[],P=p,v=typeof P=="function"?P.apply(I,d):P,v!==void 0&&(Z.exports=v)})(this,function(){"use strict";function m(u,o){return typeof o=="undefined"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function p(u,o,R){var i=new XMLHttpRequest;i.open("GET",u),i.responseType="blob",i.onload=function(){a(i.response,o,R)},i.onerror=function(){console.error("could not download file")},i.send()}function D(u){var o=new XMLHttpRequest;o.open("HEAD",u,!1);try{o.send()}catch(R){}return 200<=o.status&&299>=o.status}function O(u){try{u.dispatchEvent(new MouseEvent("click"))}catch(R){var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(o)}}var h=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof e.g=="object"&&e.g.global===e.g?e.g:void 0,B=h.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=h.saveAs||(typeof window!="object"||window!==h?function(){}:"download"in HTMLAnchorElement.prototype&&!B?function(u,o,R){var i=h.URL||h.webkitURL,f=document.createElement("a");o=o||u.name||"download",f.download=o,f.rel="noopener",typeof u=="string"?(f.href=u,f.origin===location.origin?O(f):D(f.href)?p(u,o,R):O(f,f.target="_blank")):(f.href=i.createObjectURL(u),setTimeout(function(){i.revokeObjectURL(f.href)},4e4),setTimeout(function(){O(f)},0))}:"msSaveOrOpenBlob"in navigator?function(u,o,R){if(o=o||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(m(u,R),o);else if(D(u))p(u,o,R);else{var i=document.createElement("a");i.href=u,i.target="_blank",setTimeout(function(){O(i)})}}:function(u,o,R,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),typeof u=="string")return p(u,o,R);var f=u.type==="application/octet-stream",F=/constructor/i.test(h.HTMLElement)||h.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||f&&F||B)&&typeof FileReader!="undefined"){var y=new FileReader;y.onloadend=function(){var g=y.result;g=j?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=g:location=g,i=null},y.readAsDataURL(u)}else{var x=h.URL||h.webkitURL,l=x.createObjectURL(u);i?i.location=l:location.href=l,i=null,setTimeout(function(){x.revokeObjectURL(l)},4e4)}});h.saveAs=a.saveAs=a,Z.exports=a})}}]);
