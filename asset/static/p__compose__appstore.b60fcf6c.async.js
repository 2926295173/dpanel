"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7499],{80821:function(k,D,t){t.d(D,{Z:function(){return S}});var b=t(5574),r=t.n(b),R=t(24963),l=t(86738),c=t(14726),W=t(83062),O=t(67294),A=t(85893);function S(u){var y=(0,O.useState)(!1),L=r()(y,2),E=L[0],w=L[1],j=(0,O.useContext)(R.Z),B=j.lang,f=j.notice,d=j.message,p=function(){w(!0),u.action().then(function(a){if(w(!1),typeof u.onSuccess=="function"&&u.onSuccess(a),u.messageSuccess){var x="";typeof u.messageSuccess=="function"?x=u.messageSuccess(a):x=u.messageSuccess,x.indexOf(".")>-1&&(x=B(x)),u.asynced?d.info(x):d.success(x)}}).catch(function(a){w(!1),typeof u.onError=="function"&&u.onError(a)})};return u.confirm?(0,A.jsx)(l.Z,{style:{width:500},title:u.confirmTitle?u.confirmTitle:B("notification.title.tip"),description:u.confirm,onConfirm:p,okText:"Yes",cancelText:"No",children:(0,A.jsx)(c.ZP,{disabled:u.disabled,icon:u.icon,loading:E,danger:u.danger,type:u.type,children:u.children})}):(0,A.jsx)(W.Z,{title:u.tips,children:(0,A.jsx)(c.ZP,{disabled:u.disabled,icon:u.icon,loading:E,onClick:p,danger:u.danger,type:u.type,children:u.children})})}},24963:function(k,D,t){var b=t(67294),r=(0,b.createContext)({});D.Z=r},43774:function(k,D,t){t.r(D),t.d(D,{default:function(){return oe}});var b=t(5574),r=t.n(b),R=t(24963),l=t(15078),c=t(90078),W=t(97269),O=t(62370),A=t(97462),S=t(38345),u=t(45360),y=t(42075),L=t(65233),E=t(14726),w=t(92398),j=t(2487),B=t(4393),f=t(67294),d=t(15009),p=t.n(d),Z=t(99289),a=t.n(Z),x=t(184),K=t(51652),F=t(71230),P=t(15746),ne=t(34041),V=t(29158),te=t(74842),z=t(25593),re=t(83062),Y=t(66309),e=t(85893);function i(s){var $=(0,f.useState)(),M=r()($,2),g=M[0],I=M[1];return(0,f.useEffect)(function(){var G=s.url.substring(0,s.url.indexOf("://"));switch(G){case"image":I((0,e.jsx)("img",{width:s.imageSize?s.imageSize.width:"auto",height:s.imageSize?s.imageSize.height:"auto",src:s.url.replace("image://","/dpanel/static/store/file/")}));break;case"http":case"https":I((0,e.jsx)("img",{width:s.imageSize?s.imageSize.width:"auto",height:s.imageSize?s.imageSize.height:"auto",src:s.url}));break;case"markdown-file":(0,l.yL)({path:s.url.replace("markdown-file://","/dpanel/static/store/file/")}).then(function(N){I((0,e.jsx)(K.Z,{source:N,style:{padding:5}},"content"))});break;case"markdown":I((0,e.jsx)(K.Z,{source:s.url.replace("markdown://",""),style:{padding:5}},"content"));break}},[s.url]),(0,e.jsx)(e.Fragment,{children:g})}function C(s){return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(F.Z,{gutter:[10,10],children:[(0,e.jsx)(P.Z,{span:6,children:(0,e.jsx)(i,{url:s.app.logo,imageSize:s.logoSize})}),(0,e.jsxs)(P.Z,{span:s.extra?12:18,children:[(0,e.jsx)(F.Z,{children:(0,e.jsx)(P.Z,{span:24,children:(0,e.jsx)(y.Z,{direction:"horizontal",children:(0,e.jsxs)(z.Z.Title,{level:5,children:[s.app.name,s.app.title]})})})}),(0,e.jsx)(F.Z,{style:{height:"60px"},children:(0,e.jsx)(P.Z,{children:(0,e.jsx)(re.Z,{title:s.app.description,children:(0,e.jsx)(z.Z.Paragraph,{ellipsis:{rows:2},children:s.app.description})})})}),(0,e.jsx)(F.Z,{style:{height:"30px"},children:(0,e.jsx)(P.Z,{children:s.app.tag&&s.app.tag.map(function($,M){return(0,e.jsx)(Y.Z,{children:$},M)})})})]}),(0,e.jsx)(P.Z,{span:s.extra?6:0,children:s.extra})]})})}var n=t(80821),ae=t(90098),se=t(54006),ue=(0,f.forwardRef)(function(s,$){var M=(0,f.useState)(!1),g=r()(M,2),I=g[0],G=g[1],N=(0,f.useState)(),q=r()(N,2),h=q[0],Q=q[1],J=(0,f.useState)(""),H=r()(J,2),_=H[0],m=H[1],U=(0,se.useNavigate)();return(0,f.useImperativeHandle)($,function(){return{show:function(o){console.log(o),G(!0),Q(o),m(Object.keys(o.version)[0])}}}),(0,e.jsx)(x.a,{submitter:!1,open:I,onOpenChange:function(o){G(o)},title:"".concat(h==null?void 0:h.name," \u8BE6\u60C5\u4ECB\u7ECD"),children:h&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{ghost:!0,style:{marginBottom:"20px",paddingBottom:"20px",borderBottom:"#eeeeee solid 1px"},children:(0,e.jsx)(C,{app:h,logoSize:{width:"130",height:"130"},extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(F.Z,{gutter:[10,10],children:[(0,e.jsx)(P.Z,{children:(0,e.jsxs)(y.Z,{wrap:!0,children:[(0,e.jsx)(E.ZP,{href:h.website,target:"_blank",icon:(0,e.jsx)(V.Z,{}),children:"\u5B98\u7F51"},"website"),(0,e.jsx)(n.Z,{action:a()(p()().mark(function v(){var o,T;return p()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return console.log(h),console.log(_),X.next=4,(0,ae.iE)({storeId:(o=h.storeId)!==null&&o!==void 0?o:0,name:h.name,composeFile:h.version[_].composeFile});case 4:T=X.sent,T&&T.data.id&&U("/compose/create?id="+T.data.id);case 6:case"end":return X.stop()}},v)})),type:"primary",icon:(0,e.jsx)(te.Z,{}),children:"\u5B89\u88C5"},"install")]})}),(0,e.jsx)(P.Z,{span:24,children:h.version&&(0,e.jsx)(ne.Z,{style:{width:"100%"},value:_,onChange:function(o){m(o)},options:Object.keys(h.version).map(function(v){return{value:v,label:v}})})})]})})})}),Object.keys(h.version).map(function(v){if(!(_!=v||!h.version[v].environment||h.version[v].environment.length==0)){var o="## \u7248\u672C\u4FE1\u606F <sup>".concat(v,`</sup> 
 |\u53D8\u91CF\u540D|\u9ED8\u8BA4\u503C|\u8BF4\u660E| 
 |---|---|---|
`);return h.version[v].environment.map(function(T){o+="|".concat(T.name,"|").concat(T.value,"|").concat(T.label,`| 
`)}),o+="<br />",(0,e.jsx)(K.Z,{source:o,style:{padding:5}},v)}}),(0,e.jsx)(i,{url:h==null?void 0:h.content})]})})}),ie=ue;function oe(){var s=(0,f.useRef)(),$=(0,f.useState)(),M=r()($,2),g=M[0],I=M[1],G=(0,f.useContext)(R.Z),N=G.loading,q=(0,f.useState)(""),h=r()(q,2),Q=h[0],J=h[1];(0,f.useEffect)(function(){N.show(),(0,l.eO)().then(function(_){I(Object.fromEntries(_.data.list.map(function(m){return[m.name,m]}))),_.data.list.length>0&&J(_.data.list[0].name)}).finally(function(){N.destroy()})},[]);var H=function(m){var U=[];if(g){if(g["search"+m])return;var v={};Object.keys(g).map(function(o){g[o].id!=-1&&(v[o]=g[o]),g[o].setting.apps.map(function(T){if(m&&T.name.toLowerCase().indexOf(m)!==-1){var ee=JSON.parse(JSON.stringify(T));ee.title=" - \u3010".concat(g[o].title,"\u3011"),ee.storeId=g[o].id,U.push(ee)}})}),U.length>0?(v["search"+m]={id:-1,name:"search"+m,title:"\u641C\u7D22\u7ED3\u679C",setting:{apps:U}},J("search"+m)):(u.ZP.error("\u672A\u80FD\u627E\u5230\u5305\u542B\u5173\u952E\u5B57\u7684\u5E94\u7528"),J(Object.keys(g)[0])),I(v)}};return(0,e.jsxs)(c._z,{extra:[(0,e.jsx)(W.A,{isKeyPressSubmit:!0,submitter:!1,onFinish:function(m){H(m.search)},children:(0,e.jsxs)(y.Z.Compact,{children:[(0,e.jsx)(O.Z,{style:{margin:0},name:"search",children:(0,e.jsx)(L.Z,{allowClear:!0,addonBefore:"\u5168\u5546\u5E97\u67E5\u8BE2",placeholder:"\u6309\u56DE\u8F66\u67E5\u8BE2\u5E94\u7528",onClear:function(){H("")}})}),(0,e.jsx)(A.Z,{name:["search"],children:function(m){var U=m.search;return(0,e.jsx)(E.ZP,{onClick:function(){H(U)},children:"\u641C\u7D22"})}})]})},"form")],children:[(0,e.jsx)(ie,{ref:s}),(0,e.jsxs)(S.Z,{children:[g&&(0,e.jsx)(w.Z,{activeKey:Q,onChange:function(m){J(m)},items:Object.keys(g).map(function(_){return{label:g[_].title,key:_}})}),(0,e.jsx)(j.Z,{pagination:{pageSize:36},rowKey:"name",grid:{gutter:10,xs:1,sm:2,md:2,lg:2,xl:2,xxl:3},dataSource:g&&g[Q].setting.apps,renderItem:function(m,U){return(0,e.jsx)(j.Z.Item,{children:(0,e.jsx)(B.Z,{onClick:function(){if(g){var o;m.storeId||(m.storeId=g[Q].id),(o=s.current)===null||o===void 0||o.show(m)}},hoverable:!0,children:(0,e.jsx)(C,{app:m,logoSize:{width:"50",height:"50"}})})})}})]})]})}},15078:function(k,D,t){t.d(D,{$c:function(){return W},Me:function(){return w},eO:function(){return L},ks:function(){return A},yL:function(){return B}});var b=t(15009),r=t.n(b),R=t(99289),l=t.n(R),c=t(54006);function W(d){return O.apply(this,arguments)}function O(){return O=l()(r()().mark(function d(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,c.request)("/api/common/store/create",{method:"POST",data:p}));case 1:case"end":return a.stop()}},d)})),O.apply(this,arguments)}function A(d){return S.apply(this,arguments)}function S(){return S=l()(r()().mark(function d(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,c.request)("/api/common/store/sync",{method:"POST",data:p}));case 1:case"end":return a.stop()}},d)})),S.apply(this,arguments)}function u(d){return y.apply(this,arguments)}function y(){return y=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:p}));case 1:case"end":return a.stop()}},d)})),y.apply(this,arguments)}function L(d){return E.apply(this,arguments)}function E(){return E=l()(r()().mark(function d(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,c.request)("/api/common/store/get-list",{method:"POST",data:p}));case 1:case"end":return a.stop()}},d)})),E.apply(this,arguments)}function w(d){return j.apply(this,arguments)}function j(){return j=l()(r()().mark(function d(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,c.request)("/api/common/store/delete",{method:"POST",data:p});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},d)})),j.apply(this,arguments)}function B(d){return f.apply(this,arguments)}function f(){return f=l()(r()().mark(function d(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,c.request)(p==null?void 0:p.path,{method:"GET"}));case 1:case"end":return a.stop()}},d)})),f.apply(this,arguments)}},90098:function(k,D,t){t.d(D,{CT:function(){return L},GG:function(){return Z},MG:function(){return ne},Oh:function(){return B},Pn:function(){return u},U_:function(){return F},VN:function(){return x},iE:function(){return re},ik:function(){return w},im:function(){return W},mg:function(){return d},pm:function(){return A},xC:function(){return te}});var b=t(15009),r=t.n(b),R=t(99289),l=t.n(R),c=t(54006);function W(e){return O.apply(this,arguments)}function O(){return O=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/create",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),O.apply(this,arguments)}function A(e){return S.apply(this,arguments)}function S(){return S=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-list",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),S.apply(this,arguments)}function u(e){return y.apply(this,arguments)}function y(){return y=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-task",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),y.apply(this,arguments)}function L(e){return E.apply(this,arguments)}function E(){return E=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-detail",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),E.apply(this,arguments)}function w(e){return j.apply(this,arguments)}function j(){return j=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/delete",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),j.apply(this,arguments)}function B(e){return f.apply(this,arguments)}function f(){return f=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-deploy",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),f.apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return p=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-destroy",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),p.apply(this,arguments)}function Z(e){return a.apply(this,arguments)}function a(){return a=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-ctrl",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),a.apply(this,arguments)}function x(e){return K.apply(this,arguments)}function K(){return K=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-log",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),K.apply(this,arguments)}function F(e){return P.apply(this,arguments)}function P(){return P=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-process-kill",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),P.apply(this,arguments)}function ne(e){return V.apply(this,arguments)}function V(){return V=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-from-uri",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),V.apply(this,arguments)}function te(e){return z.apply(this,arguments)}function z(){return z=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/parse",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),z.apply(this,arguments)}function re(e){return Y.apply(this,arguments)}function Y(){return Y=l()(r()().mark(function e(i){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/common/store/deploy",{method:"POST",data:i}));case 1:case"end":return n.stop()}},e)})),Y.apply(this,arguments)}}}]);
