"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3158],{99922:function(ce,A,e){var L=e(97857),r=e.n(L),w=e(15009),d=e.n(w),W=e(99289),Z=e.n(W),x=e(5574),T=e.n(x),C=e(67294),K=e(85265),D=e(42075),u=e(28036),ne=e(49610),P=e(3616),g=e(93362),U=e(90581),O=e(5251),j=e(85893),b=(0,C.forwardRef)(function(c,Y){var B,I,p=(0,C.useRef)(),G=(0,C.useRef)(),he=(0,C.useState)(!1),ue=T()(he,2),ie=ue[0],le=ue[1],ve=(0,C.useState)(),J=T()(ve,2),o=J[0],h=J[1];return(0,C.useImperativeHandle)(Y,function(){return{show:function(Q){return Z()(d()().mark(function X(){var _e;return d()().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:h(Q),le(!0),(_e=p.current)===null||_e===void 0||_e.resetFields();case 3:case"end":return Oe.stop()}},X)}))()}}}),(0,C.useEffect)(function(){return setTimeout(function(){var v;o&&((v=G.current)===null||v===void 0||v.start(o.url,{cmd:o&&o.cmd,workDir:o&&o.workDir}))},500),function(){var v;(v=G.current)===null||v===void 0||v.close()}},[o,ie]),(0,j.jsxs)(K.Z,{forceRender:!0,width:P.FK,open:ie,onClose:function(){return[le(!1)]},title:(o==null?void 0:o.title)+" - \u63A7\u5236\u53F0",children:[(0,j.jsxs)(D.Z,{style:{marginBottom:20},children:[(0,j.jsx)(g.Z,{trigger:(0,j.jsx)(u.ZP,{type:"primary",children:"\u6587\u4EF6\u7BA1\u7406"}),apiPrefix:"container",workDir:o&&o.workDir,title:(0,O.fi)((B=o==null?void 0:o.title)!==null&&B!==void 0?B:"","/"),name:o&&o.url&&(I=o.url.split("/").pop())!==null&&I!==void 0?I:""}),(0,j.jsx)(U.Z,{onChangeShell:function(Q){var X;if(!o)return!1;(X=G.current)===null||X===void 0||X.close(),Q!=(o==null?void 0:o.cmd)&&h(r()(r()({},o),{cmd:Q}))},onOpenNewWindow:function(Q){return o?(Q.workDir=o&&o.workDir?o.workDir:"","".concat(o.url,"?").concat(Object.keys(Q).map(function(X){return"".concat(X,"=").concat(encodeURIComponent(Q[X]))}).join("&"))):""},onOpenNewWindowFinish:function(){var Q;(Q=G.current)===null||Q===void 0||Q.close(),le(!1)},onBatchCommandFinish:function(Q){G.current&&G.current.run(Q)}})]}),ie&&(0,j.jsx)(ne.Z,{height:"80vh",ref:G})]})});A.Z=b},93362:function(ce,A,e){var L=e(97857),r=e.n(L),w=e(5574),d=e.n(w),W=e(67294),Z=e(4459),x=e(25593),T=e(85265),C=e(95591),K=e(3616),D=e(82346),u=e(85893),ne=(0,W.forwardRef)(function(P,g){var U=(0,W.useState)(!1),O=d()(U,2),j=O[0],b=O[1],c=(0,D.useSearchParams)(),Y=d()(c,2),B=Y[0],I=Y[1];return(0,W.useImperativeHandle)(g,function(){return{}}),(0,u.jsxs)(u.Fragment,{children:[P.trigger?W.cloneElement(P.trigger,{onClick:function(){b(!0)}}):(0,u.jsx)(x.Z.Link,{onClick:function(){b(!0)},children:(0,u.jsx)(C.Z,{})},"file"),(0,u.jsx)(T.Z,{width:K.R_,title:"".concat(P.title," - \u6587\u4EF6\u7BA1\u7406"),onClose:function(){I([]),b(!1)},open:j,children:j&&(0,u.jsx)(Z.Z,r()({},P))})]})});A.Z=ne},80821:function(ce,A,e){e.d(A,{Z:function(){return D}});var L=e(97857),r=e.n(L),w=e(5574),d=e.n(w),W=e(24963),Z=e(86738),x=e(28036),T=e(83062),C=e(67294),K=e(85893);function D(u){var ne=(0,C.useState)(!1),P=d()(ne,2),g=P[0],U=P[1],O=(0,C.useContext)(W.Z),j=O.lang,b=O.message,c=function(){U(!0);var B=u.action();B instanceof Promise?B.then(function(I){if(U(!1),I){typeof u.onSuccess=="function"&&u.onSuccess(I);var p="";u.messageSuccess?typeof u.messageSuccess=="function"?p=u.messageSuccess(I):p=u.messageSuccess.indexOf("notification.")==0?j(u.messageSuccess):u.messageSuccess:p=j("notification.finish"),u.asynced?b.info(p):b.success(p)}}).catch(function(I){U(!1),typeof u.onError=="function"&&u.onError(I)}):U(!1)};return u.confirm?(0,K.jsx)(Z.Z,r()(r()({style:{width:500},title:u.confirmTitle?u.confirmTitle:j("notification.title.tip"),description:typeof u.confirm=="string"&&u.confirm.indexOf("notification.")==0?j(u.confirm):u.confirm,onConfirm:c,okText:"Yes",cancelText:"No",onOpenChange:u.confirmOnOpenChange},u.confirmProps),{},{children:(0,K.jsx)(x.ZP,{block:u.block,disabled:u.disabled,icon:!u.children&&g?void 0:u.icon,loading:g,danger:u.danger,type:u.type,children:u.children})})):(0,K.jsx)(T.Z,{title:u.tips,children:(0,K.jsx)(x.ZP,{block:u.block,style:u.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:u.disabled,icon:!u.children&&g?void 0:u.icon,loading:g,onClick:c,danger:u.danger,type:u.type,children:u.children})})}},90581:function(ce,A,e){e.d(A,{Z:function(){return I}});var L=e(15009),r=e.n(L),w=e(99289),d=e.n(w),W=e(5574),Z=e.n(W),x=e(3616),T=e(97269),C=e(38345),K=e(64317),D=e(37476),u=e(62370),ne=e(97462),P=e(95089),g=e(42075),U=e(28036),O=e(83062),j=e(67294),b=e(58638),c=e(82346),Y=e(69938),B=e(85893);function I(p){var G=(0,j.useState)(!1),he=Z()(G,2),ue=he[0],ie=he[1],le=(0,j.useRef)();return(0,B.jsx)(T.A,{layout:"inline",submitter:!1,children:(0,B.jsx)(C.Z,{ghost:!0,children:(0,B.jsxs)(g.Z,{children:[(0,B.jsx)(K.Z,{label:" ",width:"sm",name:"entryCmd",placeholder:"\u5207\u6362 shell \u73AF\u5883",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(J){p.onChangeShell&&p.onChangeShell(J)}}),(0,B.jsx)(D.Y,{modalProps:{width:x.ob,height:x.Ed},title:"\u6279\u91CF\u6267\u884C\u811A\u672C",name:"batchCommand",open:ue,trigger:(0,B.jsx)(U.ZP,{children:"\u6279\u91CF\u6267\u884C"}),formKey:"batchCommand",formRef:le,isKeyPressSubmit:!0,onFinish:function(){var ve=d()(r()().mark(function J(o){return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:p.onBatchCommandFinish&&p.onBatchCommandFinish(o.shell.split(`
`)),ie(!1);case 2:case"end":return v.stop()}},J)}));return function(J){return ve.apply(this,arguments)}}(),onOpenChange:function(J){ie(J),J&&le.current&&le.current.resetFields()},children:(0,B.jsx)(u.Z,{name:"shell",children:(0,B.jsx)(P.ZP,{theme:"dark",height:x.Ed})})}),(0,B.jsx)(ne.Z,{name:["entryCmd"],children:function(J){var o=J.entryCmd;return(!o||o=="")&&(o="/bin/sh"),p.onOpenNewWindow&&(0,B.jsx)(c.Link,{onClick:function(){p.onOpenNewWindowFinish&&p.onOpenNewWindowFinish()},target:"_blank",to:p.onOpenNewWindow({cmd:o}),children:(0,B.jsx)(O.Z,{title:"\u65B0\u7A97\u53E3\u6253\u5F00",children:(0,B.jsx)(U.ZP,{type:"dashed",icon:(0,B.jsx)(b.Z,{})})})})}}),(0,B.jsx)(Y.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})}},49610:function(ce,A,e){var L=e(5574),r=e.n(L),w=e(67294),d=e(52626),W=e(78267),Z=e.n(W),x=e(12323),T=e(87662),C=e(82346),K=e(4244),D=e.n(K),u=e(24078),ne=e(85893),P,g=new K.Terminal(x.X),U=new W.FitAddon,O,j=(0,w.forwardRef)(function(b,c){var Y,B=(0,w.useState)(),I=r()(B,2),p=I[0],G=I[1],he=(0,w.useState)(""),ue=r()(he,2),ie=ue[0],le=ue[1],ve=(0,C.useAccess)();(0,w.useImperativeHandle)(c,function(){return{start:function(h,v){J(),v.width=g.cols,v.height=g.rows;var Q=v?Object.keys(v).filter(function(X){return v&&v[X]}).map(function(X){if(v&&v[X])return"".concat(X,"=").concat(v[X])}):[];P=new WebSocket((0,d.R)(h+"?"+Q.join("&"))),P.addEventListener("message",function(X){var _e=JSON.parse(X.data),Pe=_e.type;if(Pe==h&&(g.write(_e.data),_e.data.indexOf("exec failed")!=-1)){J();return}}),O=g.onData(function(X){var _e={content:{command:X},type:h};P&&P.send(JSON.stringify(_e))}),le(h),G(v)},close:function(){J()},fit:function(){return U.fit(),{width:g.cols,height:g.rows}},run:function(h){p&&h&&h.forEach(function(v){var Q={content:{command:v+`
`},type:ie};P&&P.send(JSON.stringify(Q))})}}}),(0,w.useEffect)(function(){return g.loadAddon(U),g.open(document.getElementById("terminal-container-console")),U.fit(),(0,T.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(o){o.data&&o.data.fontSize&&Object.assign(g.options,o.data)}),function(){J()}},[]),(0,w.useEffect)(function(){window.addEventListener("resize",function(){U.fit();var o={size:{width:g.cols,height:g.rows},type:ie};ie&&P&&P.send(JSON.stringify(o))})},[ie]);function J(){g.reset(),U.fit(),g.focus(),O&&O.dispose(),P&&(P.close(),P=null)}return(0,ne.jsx)("div",{style:{height:(Y=b.height)!==null&&Y!==void 0?Y:"100vh"},id:"terminal-container-console"})});A.Z=j},81366:function(ce,A,e){var L=e(19632),r=e.n(L),w=e(5574),d=e.n(w),W=e(27254),Z=e(42075),x=e(28036),T=e(25593),C=e(67294),K=e(31112),D=e(85893),u={title:"ROOT",path:"/"},ne=(0,C.forwardRef)(function(P,g){var U=(0,C.useContext)(K.Z),O=U.showPath,j=(0,C.useState)([u]),b=d()(j,2),c=b[0],Y=b[1];(0,C.useImperativeHandle)(g,function(){return{addHistory:function(p,G){G=="/"?Y([u]):Y([].concat(r()(c),[{title:p,path:G}]))},initHistory:function(p){Y([u].concat(r()(p)))}}});var B=function(p){O?O(c[p].title,c[p].path):P.showPath&&P.showPath(c[p].title,c[p].path);var G=c.filter(function(he,ue){return ue<=p});Y(r()(G))};return(0,D.jsxs)(Z.Z,{children:[(0,D.jsx)(Z.Z.Compact,{children:c.map(function(I,p){return(0,D.jsx)(x.ZP,{icon:(0,D.jsx)(W.Z,{}),type:"dashed",onClick:function(){B(p)},children:I.title},p)})}),c.length>=2&&(0,D.jsx)(T.Z.Text,{copyable:{text:c[c.length-1].path}})]})});A.Z=ne},31112:function(ce,A,e){var L=e(67294),r=(0,L.createContext)({});A.Z=r},4459:function(ce,A,e){e.d(A,{Z:function(){return an}});var L=e(15009),r=e.n(L),w=e(99289),d=e.n(w),W=e(5574),Z=e.n(W),x=e(82346);function T(t,s){return C.apply(this,arguments)}function C(){return C=d()(r()().mark(function t(s,l){var m;return r()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return m="/api/".concat(s,"/explorer/get-path-list"),$.next=3,(0,x.request)(m,{data:l,method:"POST"});case 3:return $.abrupt("return",$.sent);case 4:case"end":return $.stop()}},t)})),C.apply(this,arguments)}function K(t,s){return D.apply(this,arguments)}function D(){return D=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/export"),{data:l,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),D.apply(this,arguments)}function u(t,s){return ne.apply(this,arguments)}function ne(){return ne=_asyncToGenerator(_regeneratorRuntime().mark(function t(s,l){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return l.enableExportHost=!0,n.next=3,request("/api/".concat(s,"/explorer/export"),{data:l,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},t)})),ne.apply(this,arguments)}function P(t,s){return g.apply(this,arguments)}function g(){return g=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/import"),{data:l,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),g.apply(this,arguments)}function U(t,s){return O.apply(this,arguments)}function O(){return O=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/delete"),{data:l,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),O.apply(this,arguments)}function j(t,s){return b.apply(this,arguments)}function b(){return b=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/unzip"),{data:l,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),b.apply(this,arguments)}function c(t,s){return Y.apply(this,arguments)}function Y(){return Y=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/get-content"),{data:l,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),Y.apply(this,arguments)}function B(t,s){return I.apply(this,arguments)}function I(){return I=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/import-file-content"),{data:l,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),I.apply(this,arguments)}function p(t,s){return G.apply(this,arguments)}function G(){return G=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/mkdir"),{data:l,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),G.apply(this,arguments)}function he(t,s){return ue.apply(this,arguments)}function ue(){return ue=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/chmod"),{data:l,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),ue.apply(this,arguments)}function ie(t,s){return le.apply(this,arguments)}function le(){return le=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/get-user-list"),{data:l,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),le.apply(this,arguments)}function ve(t,s){return J.apply(this,arguments)}function J(){return J=d()(r()().mark(function t(s,l){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,x.request)("/api/".concat(s,"/explorer/get-file-stat"),{data:l,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),J.apply(this,arguments)}var o=e(41482),h=e(67294),v=e(31112),Q=e(51042),X=e(48689),_e=e(42075),Pe=e(28036),Oe=e(80821),We=e(88484),ye=e(37476),Ae=e(91604),Le=e(97961),Me=e(3616),a=e(85893);function Ue(){var t=(0,h.useRef)(),s=(0,h.useContext)(v.Z),l=s.refresh,m=s.name,n=s.apiPrefix,$=s.currentPath;return(0,a.jsx)(ye.Y,{modalProps:{width:Me.ob},formRef:t,trigger:(0,a.jsx)(Pe.ZP,{icon:(0,a.jsx)(We.Z,{}),children:"\u4E0A\u4F20"}),title:"\u4E0A\u4F20\u6587\u4EF6\u5230\u5BB9\u5668",onFinish:function(){var k=d()(r()().mark(function re(H){var ae,q;return r()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return q=[],H.importFileList&&H.importFileList.map(function(ee){q.push({name:ee.name,path:ee.response.data.path})}),P(n,{fileList:q,name:m,destPath:$}),(ae=t.current)===null||ae===void 0||ae.resetFields(),l(),se.abrupt("return",!0);case 6:case"end":return se.stop()}},re)}));return function(re){return k.apply(this,arguments)}}(),children:(0,a.jsx)(Ae.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(re){return new Promise(function(H){var ae;(0,Le._2)({path:(ae=re.response.data.path)!==null&&ae!==void 0?ae:""}).then(function(q){H(!0)})})}}})})}var Ie=e(23430),we=e(93162),ge=e(24963);function Ze(t){var s=(0,h.useContext)(v.Z),l=s.name,m=s.apiPrefix,n=(0,h.useContext)(ge.Z),$=n.message;return(0,a.jsx)(Oe.Z,{action:function(){return!t.selectFileList||t.selectFileList.length==0?($.info("\u8BF7\u9009\u62E9\u8981\u4E0B\u8F7D\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):K(m,{name:l,fileList:t.selectFileList})},onSuccess:function(re){var H=new Blob([re],{type:"application/zip"});(0,we.saveAs)(H,"export.zip")},icon:(0,a.jsx)(Ie.Z,{}),children:"\u4E0B\u8F7D"})}var je=e(38345),me=e(63434),Ke=e(24739),xe=e(5966);function Se(t){var s=(0,h.useContext)(ge.Z),l=s.notice,m=(0,h.useRef)(),n=(0,h.useContext)(v.Z),$=n.currentPath,k=n.refresh,re=n.name,H=n.apiPrefix,ae=(0,h.useState)(!1),q=Z()(ae,2),oe=q[0],se=q[1],ee=function(M){var E=M.split(""),y=0,R=0,F=0;return E[1]=="r"&&(y+=4),E[2]=="w"&&(y+=2),E[3]=="x"&&(y+=1),E[4]=="r"&&(R+=4),E[5]=="w"&&(R+=2),E[6]=="x"&&(R+=1),E[7]=="r"&&(F+=4),E[8]=="w"&&(F+=2),E[9]=="x"&&(F+=1),"".concat(y).concat(R).concat(F)},pe=function(M){var E;if((E=m.current)===null||E===void 0||E.setFieldValue("permission",M),M.length>=1){var y;(y=m.current)===null||y===void 0||y.setFieldsValue({ownerRead:Number(M[0])&4,ownerWrite:Number(M[0])&2,ownerExec:Number(M[0])&1})}if(M.length>=2){var R;(R=m.current)===null||R===void 0||R.setFieldsValue({groupRead:Number(M[1])&4,groupWrite:Number(M[1])&2,groupExec:Number(M[1])&1})}if(M.length>=3){var F;(F=m.current)===null||F===void 0||F.setFieldsValue({everyoneRead:Number(M[2])&4,everyoneWrite:Number(M[2])&2,everyoneExec:Number(M[2])&1})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Pe.ZP,{onClick:d()(r()().mark(function de(){var M;return r()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(!t.selectFileObject||t.selectFileObject.length==0)){y.next=7;break}return(M=m.current)===null||M===void 0||M.resetFields(),l.error("\u8BF7\u5148\u9009\u62E9\u8981\u4FEE\u6539\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),se(!1),y.abrupt("return",!1);case 7:se(!0);case 8:case"end":return y.stop()}},de)})),children:"\u6743\u9650"}),(0,a.jsxs)(ye.Y,{modalProps:{forceRender:!0,width:Me.ob},title:t.selectFileObject.length==1?"\u4FEE\u6539 ".concat(t.selectFileObject[0].name," \u6743\u9650"):"\u6279\u91CF\u6587\u4EF6\u4FEE\u6539\u6743\u9650",layout:"horizontal",open:oe,onOpenChange:function(M){se(M),t.selectFileObject.length==1&&pe(ee(t.selectFileObject[0].modStr))},formRef:m,onValuesChange:function(M,E){if(M.permission)pe(M.permission);else{var y=["-",E.ownerRead?"r":"-",E.ownerWrite?"w":"-",E.ownerExec?"x":"-",E.groupRead?"r":"-",E.groupWrite?"w":"-",E.groupExec?"x":"-",E.everyoneRead?"r":"-",E.everyoneWrite?"w":"-",E.everyoneExec?"x":"-"];pe(ee(y.join("")))}},onFinish:function(){var de=d()(r()().mark(function M(E){var y,R,F,fe;return r()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return F=[],t.selectFileObject.map(function(i){F.push(i.path)}),_.next=4,he(H,{name:re,fileList:F,mod:(y=E.permission)!==null&&y!==void 0?y:"600",hasChildren:(R=E.hasChildren)!==null&&R!==void 0?R:!0,user:E.user});case 4:return fe=_.sent,k(),_.abrupt("return",!0);case 7:case"end":return _.stop()}},M)}));return function(M){return de.apply(this,arguments)}}(),children:[(0,a.jsxs)(je.Z,{direction:"row",gutter:[20,10],children:[(0,a.jsxs)(je.Z,{bordered:!0,title:"\u6240\u6709\u8005",headerBordered:!0,children:[(0,a.jsx)(me.Z,{label:"\u8BFB\u53D6",name:"ownerRead"}),(0,a.jsx)(me.Z,{label:"\u5199\u5165",name:"ownerWrite"}),(0,a.jsx)(me.Z,{label:"\u6267\u884C",name:"ownerExec"})]}),(0,a.jsxs)(je.Z,{bordered:!0,title:"\u7528\u6237\u7EC4",headerBordered:!0,children:[(0,a.jsx)(me.Z,{label:"\u8BFB\u53D6",name:"groupRead"}),(0,a.jsx)(me.Z,{label:"\u5199\u5165",name:"groupWrite"}),(0,a.jsx)(me.Z,{label:"\u6267\u884C",name:"groupExec"})]}),(0,a.jsxs)(je.Z,{bordered:!0,title:"\u516C\u5171",headerBordered:!0,children:[(0,a.jsx)(me.Z,{label:"\u8BFB\u53D6",name:"everyoneRead"}),(0,a.jsx)(me.Z,{label:"\u5199\u5165",name:"everyoneWrite"}),(0,a.jsx)(me.Z,{label:"\u6267\u884C",name:"everyoneExec"})]})]}),(0,a.jsx)(je.Z,{children:(0,a.jsxs)(Ke.UW,{children:[(0,a.jsx)(xe.Z,{label:"\u6743\u9650",name:"permission",fieldProps:{maxLength:3},width:"xs"}),(0,a.jsxs)(_e.Z.Compact,{children:[(0,a.jsx)(xe.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237",label:"\u6240\u6709\u8005",name:"user",fieldProps:{addonAfter:":"}}),(0,a.jsx)(xe.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237\u7EC4",name:"group"})]}),(0,a.jsx)(me.Z,{label:"\u5E94\u7528\u5230\u5B50\u76EE\u5F55",name:"hasChildren",initialValue:!0})]})})]})]})}var Ne=e(27461);function $e(t){var s=(0,h.useContext)(v.Z),l=s.currentPath,m=s.refresh,n=s.name,$=s.apiPrefix,k=(0,h.useContext)(ge.Z),re=k.notice;return(0,a.jsx)(Oe.Z,{icon:(0,a.jsx)(Ne.Z,{}),action:d()(r()().mark(function H(){return r()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(t.selectFileObject.length!=0){q.next=3;break}return re.error("\u8BF7\u5148\u9009\u62E9\u8981\u89E3\u538B\u7684 .zip .tar .tar.gz \u6587\u4EF6"),q.abrupt("return",!1);case 3:return q.abrupt("return",j($,{name:n,file:t.selectFileObject.map(function(oe){return oe.path}),path:l}));case 4:case"end":return q.stop()}},H)})),onSuccess:function(){m()},children:"\u89E3\u538B"})}function sn(t){var s=useContext(FileExplorerContext),l=s.name,m=s.apiPrefix,n=useContext(AppContext),$=n.message,k=useRef();return _jsx(RequestButton,{confirm:_jsx(Space,{children:_jsx(ProForm,{layout:"inline",submitter:!1,formRef:k,children:_jsx(ProFormText,{width:"md",label:"\u5BFC\u51FA\u5230\u4E3B\u673A\u76EE\u5F55",name:"hostPath"})})}),action:function(){var H;return!t.selectFileList||t.selectFileList.length==0?($.info("\u8BF7\u9009\u62E9\u8981\u5BFC\u51FA\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):exportFileList(m,{name:l,hostPath:(H=k.current)===null||H===void 0?void 0:H.getFieldValue("hostPath"),enableExportHost:!0,fileList:t.selectFileList})},icon:_jsx(ExportOutlined,{}),children:"\u5BFC\u51FA\u5230\u4E3B\u673A"})}function ke(t){var s=(0,h.useContext)(v.Z),l=s.refresh,m=s.name,n=s.apiPrefix,$=s.currentPath,k=s.newFile;return(0,a.jsxs)(_e.Z,{size:16,wrap:!0,children:[(0,a.jsx)(Ze,{selectFileList:t.selectFileList}),!1,(0,a.jsx)(Ue,{}),(0,a.jsx)(Se,{selectFileObject:t.selectFileObject}),(0,a.jsx)($e,{selectFileObject:t.selectFileObject}),(0,a.jsx)(Pe.ZP,{icon:(0,a.jsx)(Q.Z,{}),onClick:function(){k()},type:"primary",children:"\u65B0\u5EFA"}),(0,a.jsx)(Oe.Z,{danger:!0,type:"default",icon:(0,a.jsx)(X.Z,{}),action:function(){return U(n,{name:m,fileList:t.selectFileList})},onSuccess:function(){l()},confirm:"notification.confirm.title",children:"\u5220\u9664"})]})}var Fe=e(83062),Re=e(66309);function He(t){return t.change==0?(0,a.jsx)(Fe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u4FEE\u6539",children:(0,a.jsx)(Re.Z,{color:"blue",children:"MODIFIED"})}):t.change==1?(0,a.jsx)(Fe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u65B0\u589E\u7684\u6587\u4EF6",children:(0,a.jsx)(Re.Z,{color:"green",children:"ADD"})}):t.change==2?(0,a.jsx)(Fe.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u5220\u9664\u6587\u4EF6",children:(0,a.jsx)(Re.Z,{color:"error",children:"DELETED"})}):t.change==100?(0,a.jsx)(Fe.Z,{title:"\u6302\u8F7D\u7684\u6301\u4E45\u5316\u76EE\u5F55",children:(0,a.jsx)(Re.Z,{color:"cyan",children:"VOLUME"})}):(0,a.jsx)(a.Fragment,{})}var ze=e(81366),Ve=e(97269),Ge=e(86615),Je=e(97462),Ye=e(62370),Qe=e(85576),Xe=e(95089),be=e(5251),qe=(0,h.forwardRef)(function(t,s){var l,m,n,$=(0,h.useContext)(ge.Z),k=$.message,re=$.notice,H=(0,h.useContext)(v.Z),ae=H.currentPath,q=H.refresh,oe=H.name,se=H.apiPrefix,ee=(0,h.useRef)(),pe=(0,h.useState)(!1),de=Z()(pe,2),M=de[0],E=de[1];return(0,h.useImperativeHandle)(s,function(){return{newFile:function(){var R,F;E(!0),(R=ee.current)===null||R===void 0||R.resetFields(),(F=ee.current)===null||F===void 0||F.setFieldValue("type","newFile")},editFile:function(R,F,fe){return d()(r()().mark(function f(){var _,i,S,N,z;return r()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return(_=ee.current)===null||_===void 0||_.resetFields(),k.loading("\u6B63\u5728\u83B7\u53D6\u6587\u4EF6\u5185\u5BB9"),V.next=4,c(se,{name:oe,file:F}).finally(function(){k.destroy()});case 4:if(z=V.sent,!(z.data.content==""&&fe!="0")){V.next=9;break}return k.error("\u4E0D\u652F\u6301\u7F16\u8F91\u7684\u6587\u4EF6\u7C7B\u578B"),E(!1),V.abrupt("return");case 9:return(i=ee.current)===null||i===void 0||i.setFieldValue("newValue",z.data.content),(S=ee.current)===null||S===void 0||S.setFieldValue("newName",R),(N=ee.current)===null||N===void 0||N.setFieldValue("type","editFile"),E(!0),V.abrupt("return");case 14:case"end":return V.stop()}},f)}))()}}}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Qe.Z,{width:Me.ob,title:(l=ee.current)!==null&&l!==void 0&&l.getFieldValue("newName")?"\u7F16\u8F91\u6587\u4EF6":"\u65B0\u5EFA\u6587\u4EF6",open:M,onCancel:function(){var R;E(!1),(R=ee.current)===null||R===void 0||R.resetFields()},footer:!1,forceRender:!0,children:(0,a.jsxs)(Ve.A,{formRef:ee,onFinish:function(){var y=d()(r()().mark(function R(F){return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(F.type!="newDir"){f.next=13;break}return f.prev=1,f.next=4,p(se,{name:oe,destPath:"".concat(ae,"/").concat((0,be.fi)(F.newPath,"/"))});case 4:return q(),E(!1),f.abrupt("return",!0);case 9:f.prev=9,f.t0=f.catch(1);case 11:f.next=23;break;case 13:return f.prev=13,f.next=16,B(se,{destPath:ae,file:F.newName,content:F.newValue,name:oe});case 16:return q(),E(!1),f.abrupt("return",!0);case 21:f.prev=21,f.t1=f.catch(13);case 23:return f.abrupt("return",!1);case 24:case"end":return f.stop()}},R,null,[[1,9],[13,21]])}));return function(R){return y.apply(this,arguments)}}(),children:[(0,a.jsx)(Ge.Z.Group,{name:"type",options:[{label:"\u7F16\u8F91\u6587\u4EF6",value:"editFile",disabled:((m=ee.current)===null||m===void 0?void 0:m.getFieldValue("type"))!="editFile"},{label:"\u65B0\u5EFA\u6587\u4EF6",value:"newFile"},{label:"\u65B0\u5EFA\u76EE\u5F55",value:"newDir"}],disabled:((n=ee.current)===null||n===void 0?void 0:n.getFieldValue("type"))=="editFile"}),(0,a.jsx)(Je.Z,{name:["type"],children:function(R){var F=R.type;return F!="newDir"?[(0,a.jsx)(xe.Z,{label:"\u6587\u4EF6\u540D",tooltip:"\u7F16\u8F91\u6587\u4EF6\u65F6\u4FEE\u6539\u6587\u4EF6\u540D\u53EF\u5B9E\u73B0\u590D\u5236\u529F\u80FD",name:"newName",fieldProps:{addonBefore:"".concat(ae,"/")},placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D",disabled:F=="editFile"},"fileName"),(0,a.jsx)(Ye.Z,{label:"\u5185\u5BB9",name:"newValue",children:(0,a.jsx)(Xe.ZP,{theme:"dark",height:Me.Ed,onChange:function(f){var _;(_=ee.current)===null||_===void 0||_.setFieldValue("newValue",f)}})},"fileContent")]:(0,a.jsx)(xe.Z,{name:"newPath",label:"\u76EE\u5F55\u540D",placeholder:"\u8F93\u5165\u76EE\u5F55\u540D\u79F0\uFF0C\u652F\u6301\u591A\u7EA7"})}})]})})})}),en=qe,nn=e(99922),Be=e(68536),tn=e(87662),un=null;function rn(t){var s=(0,h.useRef)(),l=(0,h.useRef)(),m=(0,h.useRef)(),n=(0,h.useState)(""),$=Z()(n,2),k=$[0],re=$[1],H=(0,h.useRef)(),ae=(0,x.useSearchParams)(),q=Z()(ae,2),oe=q[0],se=q[1],ee=(0,h.useState)(),pe=Z()(ee,2),de=pe[0],M=pe[1],E=(0,h.useContext)(ge.Z),y=E.lang,R=E.message,F=t.apiPrefix=="host"?"common":"app";(0,h.useEffect)(function(){var f=oe.get("path");if(f){for(var _,i=f.split("/"),S=[],N="",z=1;z<i.length;z++)N+="/"+i[z],S.push({title:i[z],path:N});fe(i[i.length-1],f),(_=s.current)===null||_===void 0||_.initHistory([].concat(S))}(0,tn.K3)().then(function(Ee){!Ee.data.enableSSH&&R.info(y("app.detail.createExplorerPlugin"))})},[t.name,oe]);var fe=function(_,i){var S,N;if((S=s.current)===null||S===void 0||S.addHistory(_,i),re(i),m.current&&(N=m.current)!==null&&N!==void 0&&N.reloadAndRest){var z;(z=m.current)===null||z===void 0||z.reloadAndRest()}i=="/"?se([]):(oe.set("path",i),se(oe))};return(0,a.jsxs)(v.Z.Provider,{value:{apiPrefix:F,name:t.name,currentPath:k,showPath:fe,refresh:function(){var _;if(m&&typeof((_=m.current)===null||_===void 0?void 0:_.reloadAndRest)=="function"){var i;(i=m.current)===null||i===void 0||i.reloadAndRest()}},editFile:function(_,i,S){l.current&&l.current.editFile(_,i,S)},newFile:function(){l.current&&l.current.newFile()}},children:[(0,a.jsx)(o.Z,{scroll:{x:"max-content"},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},toolBarRender:function(){var _=[];return t.onConsole&&_.push((0,a.jsx)(Pe.ZP,{type:"dashed",onClick:function(){t.onConsole&&t.onConsole(k)},children:"Console"},"fileConsole")),[].concat(_)},tableAlertOptionRender:function(_){var i=_.selectedRowKeys,S=_.selectedRows,N=[];return S.map(function(z){N.push(z.path)}),[(0,a.jsx)(ke,{selectFileList:N,selectFileObject:S,enableExportHost:t.apiPrefix=="container"},"1")]},headerTitle:(0,a.jsx)(ze.Z,{ref:s}),actionRef:m,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:d()(r()().mark(function f(){var _,i,S,N,z;return r()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,T(F,{name:t.name,path:k});case 2:if(_=V.sent,k==""&&_.data.currentPath!=""&&(S=[],re(_.data.currentPath),(i=s.current)===null||i===void 0||i.initHistory(_.data.currentPath.split("/").filter(function(te){return te!=""}).map(function(te){return S.push(te),{title:te,path:"/".concat(S.join("/"))}}))),N=de,N){V.next=11;break}return V.next=8,ie(F,{name:t.name});case 8:z=V.sent,M(z.data),N=z.data;case 11:return V.abrupt("return",{data:_.data.list.map(function(te){if(N){var Ce,Te;te.group=(Ce=(Te=N.group.find(function(De){return De.gid==te.group}))===null||Te===void 0?void 0:Te.name)!==null&&Ce!==void 0?Ce:te.group}return te}),success:!0,total:_.data.list.length});case 12:case"end":return V.stop()}},f)})),columns:[{title:"\u540D\u79F0",dataIndex:"name",key:"name",render:function(Ee,i,S,N,z){var Ee;return i.isDir?Ee=(0,a.jsx)(Be.Z,{isDir:!0,onClick:function(){return fe(i.name,i.path)},showName:i.name}):i.isSymlink?Ee=(0,a.jsx)(Be.Z,{isLink:!0,showName:"".concat(i.name," -> ").concat(i.linkName),onClick:d()(r()().mark(function V(){var te,Ce;return r()().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return De.next=2,ve(F,{name:t.name,path:i.path});case 2:te=De.sent,te.data.info.isDir?fe(i.name,te.data.info.target):(Ce=l.current)===null||Ce===void 0||Ce.editFile(te.data.info.name,te.data.info.target,i.size);case 4:case"end":return De.stop()}},V)}))}):Ee=(0,a.jsx)(Be.Z,{showName:i.name,onClick:function(){var te;(te=l.current)===null||te===void 0||te.editFile(i.name,i.path,i.size)}}),Ee}},{title:"\u72B6\u6001",key:"status",width:110,render:function(_,i,S,N,z){return(0,a.jsx)(He,{change:i.change})}},{title:"\u6743\u9650",dataIndex:"modStr",key:"mod"},{title:"\u7528\u6237",dataIndex:"user"},{title:"\u7528\u6237\u7EC4",dataIndex:"group"},{title:"\u5927\u5C0F",dataIndex:"size",key:"size",render:function(_,i,S,N,z){return(0,be.FI)(i.size)}},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"modTime",key:"modTime",sorter:function(_,i){return new Date(_.modTime).getTime()-new Date(i.modTime).getTime()},render:function(_,i,S,N,z){return(0,be.NF)(i.modTime)}}],cardProps:{ghost:!0}}),(0,a.jsx)(en,{ref:l}),(0,a.jsx)(nn.Z,{ref:H})]})}var an=rn},68536:function(ce,A,e){e.d(A,{Z:function(){return K}});var L=e(24963),r=e(93613),w=e(36693),d=e(2741),W=e(25593),Z=e(42075),x=e(67294),T=e(85893),C=0;function K(D){var u=(0,x.useContext)(L.Z),ne=u.message;return D.isDir?(0,T.jsx)(W.Z.Link,{onClick:function(){D.onClick&&D.onClick()},children:(0,T.jsxs)(Z.Z,{children:[(0,T.jsx)(r.Z,{}),D.showName]})}):D.isLink?(0,T.jsx)(W.Z.Link,{onClick:function(){D.onClick&&D.onClick()},children:(0,T.jsxs)(Z.Z,{children:[(0,T.jsx)(w.Z,{}),D.showName]})}):(0,T.jsx)(W.Z.Text,{onClick:function(){if(C++,C==2){C=0,D.onClick&&D.onClick();return}setTimeout(function(){C==1&&ne.info("\u53CC\u51FB\u67E5\u770B\u6587\u4EF6\u5185\u5BB9"),C=0},400)},style:{cursor:"pointer"},children:(0,T.jsxs)(Z.Z,{children:[(0,T.jsx)(d.Z,{}),D.showName]})})}},3616:function(ce,A,e){e.d(A,{Ed:function(){return d},FK:function(){return r},R_:function(){return L},ob:function(){return w}});var L=window.innerWidth<=1024?"90vw":"65vw",r="90vw",w="60vw",d="50vh"},12323:function(ce,A,e){e.d(A,{X:function(){return L},n:function(){return r}});var L={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},r=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},24963:function(ce,A,e){var L=e(67294),r=(0,L.createContext)({});A.Z=r},97961:function(ce,A,e){e.d(A,{GH:function(){return D},MF:function(){return g},_2:function(){return ne},fN:function(){return x},ii:function(){return Z},vC:function(){return C}});var L=e(15009),r=e.n(L),w=e(99289),d=e.n(w),W=e(82346),Z=[{name:"amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"i386",arch:"386",search:[]},{name:"arm/v6",arch:"arm",search:[]},{name:"arm/v7",arch:"arm",search:[]},{name:"arm/v8",arch:"arm64",search:[]},{name:"ppc64le",arch:"ppc64le",search:[]},{name:"riscv64",arch:"riscv64",search:[]}];function x(O){return T.apply(this,arguments)}function T(){return T=d()(r()().mark(function O(j){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,W.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:j}));case 1:case"end":return c.stop()}},O)})),T.apply(this,arguments)}function C(O){return K.apply(this,arguments)}function K(){return K=d()(r()().mark(function O(j){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,W.request)("/api/app/image/import-by-container-tar",{method:"POST",data:j}));case 1:case"end":return c.stop()}},O)})),K.apply(this,arguments)}function D(O){return u.apply(this,arguments)}function u(){return u=d()(r()().mark(function O(j){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,W.request)("/api/app/image/import-by-image-tar",{method:"POST",data:j}));case 1:case"end":return c.stop()}},O)})),u.apply(this,arguments)}function ne(O){return P.apply(this,arguments)}function P(){return P=d()(r()().mark(function O(j){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,W.request)("/api/common/attach/delete",{method:"POST",data:j});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},O)})),P.apply(this,arguments)}function g(){return U.apply(this,arguments)}function U(){return U=d()(r()().mark(function O(){return r()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,W.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return b.stop()}},O)})),U.apply(this,arguments)}}}]);
