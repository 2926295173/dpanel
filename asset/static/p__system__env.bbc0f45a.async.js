"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{1699:function(X,x,e){e.d(x,{u:function(){return K}});var V=e(9783),T=e.n(V),G=e(97857),B=e.n(G),H=e(67294),S=e(82346),Z=e(40411),D=e(42075),L=e(85893),K=function(t){var A=(0,S.useAccess)(),n=Array.isArray(t.access)?t.access:[t.access],r,u=t.fallback;if(typeof t.children=="function"?(r=t.children(n.reduce(function(R,c){return B()(B()({},R),{},T()({},c,A[c]))},{})),r||(r=u)):n.every(function(R){return A[R]})?r=t.children:r=u,!u&&r&&t.showProTips&&A.canSeeEnableCe){if(A.canSeeEnableHiddenProTips)return null;r=(0,L.jsx)(Z.Z,{offset:t.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:r})}if(!u&&r&&t.showProRibbonTips&&A.canSeeEnableCe){if(A.canSeeEnableHiddenProTips)return null;r=(0,L.jsx)(Z.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:r})}return t.space?(0,L.jsx)(D.Z,B()(B()({},t.space),{},{children:r})):r}},80821:function(X,x,e){e.d(x,{Z:function(){return A}});var V=e(97857),T=e.n(V),G=e(5574),B=e.n(G),H=e(24963),S=e(36146),Z=e(86738),D=e(83062),L=e(96074),K=e(83622),o=e(67294),t=e(85893);function A(n){var r=(0,o.useState)(!1),u=B()(r,2),R=u[0],c=u[1],a=(0,o.useContext)(H.Z),i=a.message,l=new S.Uo,_=function(){c(!0);var M=n.action();M instanceof Promise?M.then(function(E){if(c(!1),E){typeof n.onSuccess=="function"&&n.onSuccess(E);var y="";n.messageSuccess?typeof n.messageSuccess=="function"?y=n.messageSuccess(E):y=n.messageSuccess.indexOf("notification.")==0?l.format(n.messageSuccess):n.messageSuccess:y=l.format("notification.finish"),n.asynced?i.info(y):i.success(y)}}).catch(function(E){c(!1),typeof n.onError=="function"&&n.onError(E)}):c(!1)};return n.confirm?(0,t.jsx)(Z.Z,T()(T()({style:{width:500},title:n.confirmTitle?n.confirmTitle:l.format("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?l.format(n.confirm):n.confirm,onConfirm:_,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,t.jsxs)(D.Z,{title:n.tips,children:[n.showDivider&&(0,t.jsx)(L.Z,{type:"vertical",style:{marginRight:15}}),(0,t.jsx)(K.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&R?void 0:n.icon,loading:R,danger:n.danger,type:n.type,children:n.children})]})})):(0,t.jsxs)(D.Z,{title:n.tips,children:[n.showDivider&&(0,t.jsx)(L.Z,{type:"vertical",style:{marginRight:15}}),(0,t.jsx)(K.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&R?void 0:n.icon,loading:R,onClick:_,danger:n.danger,type:n.type,children:n.children})]})}},44349:function(X,x,e){var V=e(97857),T=e.n(V),G=e(15009),B=e.n(G),H=e(99289),S=e.n(H),Z=e(74763),D=e(17186),L=e(5966),K=e(86250),o=e(67294),t=e(85893),A=(0,o.forwardRef)(function(n,r){var u=(0,o.useRef)();(0,o.useImperativeHandle)(r,function(){return{addItem:function(c){function a(i,l,_){return c.apply(this,arguments)}return a.toString=function(){return c.toString()},a}(function(c,a,i){var l,_=(l=u.current)===null||l===void 0?void 0:l.getList(),C;if(_==null||_.forEach(function(y,z){y[c]==a[c]&&(C=z)}),!(0,Z.k)(C)&&i){var M;(M=u.current)===null||M===void 0||M.remove(C),C=void 0}if(!C){var E;(E=u.current)===null||E===void 0||E.add(a)}}),removeItemByKey:function(a,i){return S()(B()().mark(function l(){var _,C;return B()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return C=(_=u.current)===null||_===void 0?void 0:_.getList(),C==null||C.forEach(function(y,z){if(y[a]==i){var J;(J=u.current)===null||J===void 0||J.remove(z);return}}),E.abrupt("return");case 3:case"end":return E.stop()}},l)}))()},clear:function(a){if(!a){var i;a=(i=u.current)===null||i===void 0||(i=i.getList())===null||i===void 0?void 0:i.map(function(_,C){return C})}if(a){var l;(l=u.current)===null||l===void 0||l.remove(a)}},getList:function(){var a;return(a=u.current)===null||a===void 0?void 0:a.getList()}}});var R={};return n.hideCopyButton===!0&&(R.copyIconProps=!1),n.hideDeleteButton===!0&&(R.deleteIconProps=!1),(0,t.jsx)(D.u,T()(T()({initialValue:n.initialValue,label:n.label,name:n.name,actionRef:u,creatorButtonProps:n.showAddButton?{creatorButtonText:n.label?n.label:n.name}:!1,min:n.min?n.min:0},R),{},{children:function(a,i,l){return(0,t.jsx)(K.Z,{justify:n.justify,gap:n.gap,children:n.items.map(function(_){return _.render?(0,t.jsx)("div",{children:_.render&&_.render(a,i,l)},"".concat(n.name,"-").concat(_.name,"-").concat(a.key)):(0,t.jsx)(L.Z,{width:_.width,name:_.name,label:_.label,required:_.required,rules:[{required:_.required}],disabled:_.disabled,placeholder:_.placeholder},"".concat(n.name,"-").concat(_.name,"-").concat(a.key))})})}}))});x.Z=A},36435:function(X,x,e){var V=e(15009),T=e.n(V),G=e(64599),B=e.n(G),H=e(99289),S=e.n(H),Z=e(9783),D=e.n(Z),L=e(5574),K=e.n(L),o=e(67294),t=e(184),A=e(38345),n=e(97269),r=e(97321),u=e(97462),R=e(64317),c=e(5966),a=e(86615),i=e(68602),l=e(83622),_=e(83403),C=e(24963),M=e(1699),E=e(29177),y=e(1883),z=e(43425),J=e(44349),k=e(3616),Y=e(36146),m=e(85893),w=(0,o.forwardRef)(function(h,g){var p=(0,o.useState)(!1),U=K()(p,2),$=U[0],s=U[1],f=(0,o.useRef)(),Q=(0,o.useContext)(C.Z),ee=Q.message,re=(0,o.useState)([]),ne=K()(re,2),q=ne[0],_e=ne[1],I=new Y.Uo("components.permissionButton"),te=D()(D()(D()(D()(D()({},_.W6.CONTAINER,"Id"),_.W6.APPSTORE,"name"),_.W6.COMPOSE,"name"),_.W6.REGISTRY,"serverAddress"),_.W6.DOCKER_ENV,"name"),le=D()(D()(D()(D()(D()({},_.W6.CONTAINER,"name"),_.W6.APPSTORE,"name"),_.W6.COMPOSE,"name"),_.W6.REGISTRY,"title"),_.W6.DOCKER_ENV,"title"),ae=te[h.type],oe=le[h.type],ie=h.selected.map(function(v){return v[te[h.type]]});return o.useEffect(function(){if($){if(!h.selected||h.selected.length==0){ee.error(Y.FD.format("message.noDataSelect")),s(!1);return}(0,i.dP)({permission:{uri:h.type,key:ae,value:ie}}).then(function(v){var d;(d=f.current)===null||d===void 0||d.setFieldValue("list",Object.keys(v.data.list).map(function(O){return{name:O,type:v.data.list[O].type,users:v.data.list[O].users}}))}),(0,i.lE)().then(function(v){var d,O=(d=v.data)===null||d===void 0||(d=d.list)===null||d===void 0?void 0:d.map(function(P){return{label:P.username,value:P.username}});_e(O)})}},[$]),(0,m.jsx)(M.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,m.jsxs)(t.a,{name:"create",title:I.format("drawerTitle"),open:$,onOpenChange:function(d){if(!d){var O;(O=f.current)===null||O===void 0||O.resetFields()}s(d)},drawerProps:{forceRender:!0,width:k.R_},formRef:f,trigger:(0,m.jsx)(l.ZP,{icon:(0,m.jsx)(E.Z,{}),children:I.format("drawerTriggerButton")}),onFinish:function(){var v=S()(T()().mark(function d(O){var P,b,j;return T()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:P=B()(O.list),W.prev=1,P.s();case 3:if((b=P.n()).done){W.next=9;break}return j=b.value,W.next=7,(0,i.Db)({usernames:j.users,permissionType:j.type,permission:{uri:h.type,key:ae,showKey:oe,value:[j.name]}});case 7:W.next=3;break;case 9:W.next=14;break;case 11:W.prev=11,W.t0=W.catch(1),P.e(W.t0);case 14:return W.prev=14,P.f(),W.finish(14);case 17:ee.success(Y.FD.format("finish")),s(!1),h.onSuccess();case 20:case"end":return W.stop()}},d,null,[[1,11,14,17]])}));return function(d){return v.apply(this,arguments)}}(),children:[(0,m.jsxs)(A.Z,{ghost:!0,title:(0,m.jsx)(y.Z,{}),subTitle:I.format("batchTitle"),children:[(0,m.jsx)(n.A.Item,{name:"type",style:{marginBottom:0},children:(0,m.jsx)(r.Z.Group,{defaultValue:"admin",onChange:function(d){var O,P,b=(O=f.current)===null||O===void 0?void 0:O.getFieldValue("list");b.forEach(function(j){j.type=d,j.users=[]}),(P=f.current)===null||P===void 0||P.setFieldValue("list",b)},children:["admin","restricted","public"].map(function(v){return(0,m.jsx)(r.Z,{style:{width:240},title:I.format("dataTypeOption.".concat(v)),description:I.format("dataTypeOptionDesc.".concat(v)),value:v},v)})})}),(0,m.jsx)(u.Z,{name:["type"],children:function(d){var O=d.type;if(O==="restricted")return(0,m.jsx)(R.Z,{mode:"multiple",name:"usernames",label:I.format("formUsernames"),onChange:function(b){var j,F,W=(j=f.current)===null||j===void 0?void 0:j.getFieldValue("list");W.forEach(function(N){N.users=b}),(F=f.current)===null||F===void 0||F.setFieldValue("list",W)},rules:[{required:!0}],request:S()(T()().mark(function P(){var b,j,F;return T()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(!(q.length>0)){N.next=2;break}return N.abrupt("return",q);case 2:return N.next=4,(0,i.lE)();case 4:return j=N.sent,F=(b=j.data)===null||b===void 0||(b=b.list)===null||b===void 0?void 0:b.map(function(se){return{label:se.username,value:se.username}}),_e(F),N.abrupt("return",F);case 8:case"end":return N.stop()}},P)}))})}})]}),(0,m.jsx)(A.Z,{ghost:!0,title:(0,m.jsx)(z.Z,{}),subTitle:I.format("dataTitle"),children:(0,m.jsx)(J.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:I.format("dataName"),render:function(d,O,P){var b=P.getCurrentRowData();return(0,m.jsx)(c.Z,{disabled:!0,label:I.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:I.format("dataType"),render:function(d,O,P){var b=P.getCurrentRowData();return(0,m.jsx)(a.Z.Group,{label:I.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(j){return{label:I.format("dataTypeOption.".concat(j)),value:j}})})}},{name:"users",label:I.format("dataUsers"),render:function(d,O,P){return(0,m.jsx)(u.Z,{name:["type"],children:function(j){var F=j.type;if(F=="restricted")return(0,m.jsx)(R.Z,{width:"sm",mode:"tags",name:"users",label:I.format("dataUsers"),options:q})}})}}]})})]})})});x.Z=w},98163:function(X,x,e){e.r(x),e.d(x,{default:function(){return C}});var V=e(15009),T=e.n(V),G=e(99289),B=e.n(G),H=e(80821),S=e(77273),Z=e(36435),D=e(83403),L=e(24963),K=e(87662),o=e(36146),t=e(86548),A=e(90078),n=e(56729),r=e(82346),u=e(83622),R=e(42075),c=e(96074),a=e(25593),i=e(83062),l=e(67294),_=e(85893);function C(){var M=(0,l.useRef)(),E=(0,l.useRef)(),y=(0,r.useModel)("@@initialState"),z=y.refresh,J=(0,l.useContext)(L.Z),k=J.message,Y=(0,r.useLocation)(),m=(0,r.useNavigate)(),w=new o.Uo("system.env");return(0,l.useEffect)(function(){var h=Y.state;if(h&&h.item){var g;m(".",{replace:!0}),(g=E.current)===null||g===void 0||g.edit(h.item)}},[Y.state]),(0,_.jsx)(A._z,{header:{extra:[(0,_.jsx)(S.Z,{trigger:(0,_.jsx)(u.ZP,{type:"primary",children:w.format("createButton")}),ref:E,onFinish:B()(T()().mark(function h(){var g,p,U;return T()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(U=Y.state,!(U&&U.item)){s.next=6;break}return s.next=4,(0,K.vC)({name:U.item.name});case 4:return m(Y.pathname,{replace:!0,state:null}),s.abrupt("return");case 6:z(),!((g=M.current)===null||g===void 0)&&g.reloadAndRest&&((p=M.current)===null||p===void 0||p.reloadAndRest());case 8:case"end":return s.stop()}},h)}))},"dockerEnvCreate")]},children:(0,_.jsx)(n.Z,{rowKey:"name",columns:[{title:o.FD.format("listName"),dataIndex:"name"},{title:o.FD.format("listTitle"),dataIndex:"title"},{title:o.FD.format("listTargetAddress"),dataIndex:"address"},{title:o.FD.format("listManage"),width:100,search:!1,render:function(g,p,U,$,s){return(0,_.jsx)(R.Z,{split:(0,_.jsx)(c.Z,{type:"vertical"}),children:(0,_.jsx)(a.Z.Link,{onClick:function(){var Q;(Q=E.current)===null||Q===void 0||Q.edit(p)},children:(0,_.jsx)(i.Z,{title:o.FD.format("listManageEdit"),children:(0,_.jsx)(t.Z,{})})},p.name)})}}],pagination:!1,request:B()(T()().mark(function h(){var g;return T()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,(0,K.Kg)({enableCertContent:!0});case 2:return g=U.sent,U.abrupt("return",{data:g.data.list,total:g.data.list.length});case 4:case"end":return U.stop()}},h)})),search:!1,rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:M,tableAlertOptionRender:function(g){var p=g.selectedRows,U=g.selectedRowKeys;return(0,_.jsxs)(R.Z,{size:16,children:[(0,_.jsx)(Z.Z,{type:D.W6.DOCKER_ENV,selected:p,onSuccess:function(){var s,f;return!((s=M.current)===null||s===void 0)&&s.reloadAndRest&&((f=M.current)===null||f===void 0||f.reloadAndRest()),!0}},"permissionButton"),(0,_.jsx)(H.Z,{danger:!0,type:"primary",action:function(){return p.find(function(s){return s.default})?(k.warning(o.FD.format("systemEnvDefaultCannotDelete")),!1):(0,K._g)({name:U})},onSuccess:function(){var s,f;return!((s=M.current)===null||s===void 0)&&s.reloadAndRest&&((f=M.current)===null||f===void 0||f.reloadAndRest()),!0},onError:function(){var s,f;return!((s=M.current)===null||s===void 0)&&s.reset&&((f=M.current)===null||f===void 0||f.reset()),!0},confirm:"notification.confirm.title",children:o.FD.format("listManageDeleteBatch")})]})}})})}}}]);
