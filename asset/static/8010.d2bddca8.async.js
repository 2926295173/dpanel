"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8010],{58010:function(Re,le,n){n.d(le,{Z:function(){return un}});var oe=n(19632),ce=n.n(oe),de=n(5574),G=n.n(de),xe=n(15009),o=n.n(xe),je=n(99289),R=n.n(je),u=n(67294),Y=n(80821),Z=n(90098),me=n(52209),W=n(86548),q=n(43425),X=n(74842),ue=n(48689),S=n(33160),fe=n(87784),ne=n(30159),ve=n(25035),Q=n(38345),te=n(97269),se=n(86615),A=n(62370),T=n(82346),Ce=n(85265),k=n(42075),he=n(96074),J=n(25593),re=n(83062),Ze=n(38925),_=n(84567),Se=n(28036),Pe=n(99861),Le=n(91058),Ae=n(79245),$e=n(60940),Ie=n(55241),we=n(78451),Be=n(37413),Oe=n(94359),ge=n(24963),Te=n(91806),Me=n(60433),De=n(89035),Ue=n(99922),Ve=n(23747),Ke=n(87662),Ne=n(5251),e=n(85893);function Ge(a){var H=(0,u.useState)(""),V=G()(H,2),$=V[0],M=V[1],F=(0,u.useContext)(ge.Z),x=F.loading,z=F.lang,f=F.notice,v=F.message,t=(0,u.useRef)(),I=(0,u.useRef)(),U=(0,u.useState)(!1),y=G()(U,2),h=y[0],j=y[1];return(0,u.useEffect)(function(){(0,Ke.K3)().then(function(c){var P;M((P=c.data.serverUrl)!==null&&P!==void 0?P:"")}),j(!1)},[a.containerList]),a.containerList&&(0,e.jsxs)(Q.Z,{ghost:!0,title:(0,e.jsx)(Te.Z,{}),subTitle:"\u5BB9\u5668\u5217\u8868",extra:a.enableSelectService&&(0,e.jsx)(_.Z,{onChange:function(P){j(P.target.checked)},children:"\u81EA\u5B9A\u4E49\u90E8\u7F72\u5BB9\u5668\u670D\u52A1\uFF1F"},"selectService"),children:[(0,e.jsx)(Ue.Z,{ref:t}),(0,e.jsx)(Ve.Z,{ref:I}),(0,e.jsx)($e.Z,{scroll:{x:"max-content"},rowKey:"service",pagination:!1,columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"name",width:200,render:function(P,s,b){return(0,e.jsx)(re.Z,{title:s.service,children:(0,e.jsx)(we.Z,{content:s.name?(0,Ne.fi)(s.name,"/"):s.service})})}},{title:"\u7AEF\u53E3",render:function(P,s,b){var C=[],B=[];return s.publishers&&s.publishers.map(function(K){K.publishedPort?C.push({PrivatePort:K.targetPort,Type:K.protocol,IP:K.url,PublicPort:K.publishedPort}):K.publishedPort&&B.push({PrivatePort:K.targetPort,Type:K.protocol,IP:K.url,PublicPort:K.publishedPort})}),(0,e.jsx)(Be.Z,{publicPort:C,privatePort:B,domain:[],serverIp:$})}},{title:"\u72B6\u6001",render:function(P,s,b){return(0,e.jsx)(Oe.Z,{status:s.state,message:{content:z("container.status.".concat(s.state)),placement:"top",showInTag:!0}},s.name)}},{title:"\u64CD\u4F5C",fixed:"right",render:function(P,s,b){return(0,e.jsxs)(k.Z,{split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[s.name==""&&(0,e.jsx)(Ie.Z,{placement:"left",content:(0,e.jsx)(Q.Z,{ghost:!0,title:"\u5BB9\u5668\u5185\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(k.Z,{direction:"vertical",children:s.environment&&Object.keys(s.environment).map(function(C){if(s.environment&&s.environment[C])return(0,e.jsx)(J.Z.Text,{code:!0,children:"".concat(C,"=").concat(s.environment[C])},C)})})}),children:(0,e.jsx)(Me.Z,{})}),s.name!=""&&(0,e.jsx)(J.Z.Link,{onClick:function(){var B;(B=I.current)===null||B===void 0||B.show(s.name)},children:(0,e.jsx)(q.Z,{})},"container"),s.state=="running"&&(0,e.jsx)(J.Z.Link,{onClick:function(){var B;(B=t.current)===null||B===void 0||B.show({url:"/console/container/".concat(s.name),title:s.name})},children:(0,e.jsx)(De.Z,{})},"console")]})}}],dataSource:a.containerList,rowSelection:h&&a.containerList?{defaultSelectedRowKeys:a.containerList.map(function(c){return c.service}),onChange:function(P,s,b){a.selectServiceFinish&&a.selectServiceFinish(P)}}:void 0})]})}var We=n(81146),ze=n(45742),Fe=n(3616),Qe=(0,u.forwardRef)(function(a,H){(0,u.useImperativeHandle)(H,function(){return{show:function(U){return R()(o()().mark(function y(){return o()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:v(a.composeItem),F(!0);case 2:case"end":return j.stop()}},y)}))()}}});var V=(0,u.useState)(!1),$=G()(V,2),M=$[0],F=$[1],x=(0,u.useState)(),z=G()(x,2),f=z[0],v=z[1],t=(0,u.useRef)();return(0,e.jsxs)(e.Fragment,{children:[a.showTriggerButton&&(0,e.jsx)(J.Z.Link,{onClick:R()(o()().mark(function I(){return o()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:v(a.composeItem),F(!0);case 2:case"end":return y.stop()}},I)})),children:(0,e.jsx)(re.Z,{title:"\u8FD0\u884C\u65E5\u5FD7",children:(0,e.jsx)(ze.Z,{})})},"log"),(0,e.jsx)(Ce.Z,{title:"\u4EFB\u52A1\u65E5\u5FD7",open:M,forceRender:!0,onClose:function(){F(!1)},afterOpenChange:function(U){if(U)setTimeout(function(){var h,j;(h=t.current)===null||h===void 0||h.start(),(j=t.current)===null||j===void 0||j.fit()},1e3);else{var y;(y=t.current)===null||y===void 0||y.close()}},width:Fe.FK,children:f&&M&&(0,e.jsx)(We.Z,{ref:t,showInDrawer:!0,id:"compose:log:".concat(String(f.id||f.name)),request:function(){var I=R()(o()().mark(function U(y){var h;return o()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,Z.Yz)({id:f.id||f.name,lineTotal:y.lineTotal,download:(h=y.download)!==null&&h!==void 0?h:!1,showTime:y.showTime});case 2:case"end":return c.stop()}},U)}));return function(U){return I.apply(this,arguments)}}(),download:function(){var I=R()(o()().mark(function U(y){var h;return o()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,Z.vf)({id:f.id||f.name,lineTotal:y.lineTotal,showTime:y.showTime,download:!0});case 2:return h=c.sent,c.abrupt("return",{data:new Blob([h],{type:"text/plain"}),name:a.composeItem.name+"_"+new Date().toLocaleDateString()+".log"});case 4:case"end":return c.stop()}},U)}));return function(U){return I.apply(this,arguments)}}()})})]})}),Ye=Qe,He=n(184),Xe=n(95213),ke=n(95089),Je=n(92398);function be(a){var H=(0,u.useContext)(ge.Z),V=H.message,$=(0,u.useRef)();return a.composeItem.yamlList&&(0,e.jsx)(He.a,{drawerProps:{width:Fe.R_},title:"\u7F16\u8F91\u4EFB\u52A1 Yaml",formRef:$,trigger:(0,e.jsx)(J.Z.Link,{children:(0,e.jsx)(re.Z,{title:"Yaml",children:"Yaml"})}),onFinish:function(){var M=R()(o()().mark(function F(x){return o()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,Z.im)({id:String(a.composeItem.id?a.composeItem.id:a.composeItem.name),name:a.composeItem.name,type:a.composeItem.setting.type,yaml:x.yaml,yamlOverride:x.yamlOverride});case 2:return f.next=4,(0,Z.xC)({yaml:[x.yaml,x.yamlOverride],environment:a.composeItem.setting.environment,id:a.composeItem.id||a.composeItem.name});case 4:return a.onFinish&&a.onFinish(),f.abrupt("return",!0);case 6:case"end":return f.stop()}},F)}));return function(F){return M.apply(this,arguments)}}(),children:(0,e.jsx)(Q.Z,{ghost:!0,children:(0,e.jsx)(Je.Z,{items:a.composeItem.yamlList.map(function(M,F){var x=[{label:"Yaml \u6587\u4EF6",key:"yaml"},{label:"\u8986\u76D6 Yaml \u6587\u4EF6",key:"yamlOverride"}];return{label:x[F].label,key:x[F].key,children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(A.Z,{hidden:!0,name:x[F].key}),(0,e.jsx)(A.Z,{shouldUpdate:!0,children:function(f){return(0,e.jsx)(ke.ZP,{onFocus:function(){if(x[F].key=="yaml"&&a.composeItem.setting.type=="remoteUrl"){V.error("\u8FDC\u7A0Byaml\u6587\u4EF6\u65E0\u6CD5\u4FEE\u6539\uFF0C\u8BF7\u901A\u8FC7\u3010\u8986\u76D6 yaml \u6587\u4EF6\u3011\u7684\u65B9\u5F0F\u4FEE\u6539\u5185\u5BB9\u3002");return}},readOnly:x[F].key=="yaml"&&a.composeItem.setting.type=="remoteUrl",theme:"dark",minHeight:"550px",value:M,onChange:function(t){f.setFieldValue(x[F].key,t)},extensions:[Xe.RI.yaml()]})}})]})}})})})})}var qe=n(65913),pe=n(1699),_e=n(28230),en=n(52756),nn=n(35887),tn=(0,u.forwardRef)(function(a,H){(0,u.useImperativeHandle)(H,function(){return{show:function(){var v;z(!0),(v=$.current)===null||v===void 0||v.clear(),setTimeout(function(){var t;(t=$.current)===null||t===void 0||t.fit()},1e3)},close:function(){var v;z(!1),(v=$.current)===null||v===void 0||v.clear()}}});var V=(0,T.useModel)("subscriber"),$=(0,u.useRef)(),M=(0,u.useState)(!1),F=G()(M,2),x=F[0],z=F[1];return V.addDataHandler("compose:"+a.id,function(f){var v;(v=$.current)===null||v===void 0||v.write(f.data)}),(0,e.jsx)(Q.Z,{hidden:!x,ghost:!0,title:(0,e.jsx)(De.Z,{}),subTitle:"\u63A7\u5236\u53F0",extra:(0,e.jsx)(k.Z,{children:(0,e.jsx)(Y.Z,{action:function(){var v;return(v=$.current)===null||v===void 0||v.clear(),(0,Z.U_)({})},icon:(0,e.jsx)(ue.Z,{}),danger:!0,onSuccess:function(){},children:"\u4E2D\u6B62\u6267\u884C"},"kill")}),children:(0,e.jsx)(nn.Z,{height:"200px",style:{fontSize:12},ref:$})})}),rn=tn,an=(0,u.forwardRef)(function(a,H){var V;(0,u.useImperativeHandle)(H,function(){return{show:function(i){return R()(o()().mark(function d(){var g;return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return(g=C.current)===null||g===void 0||g.close(),x(!0),l.prev=2,l.next=5,Ee(i);case 5:l.next=12;break;case 7:l.prev=7,l.t0=l.catch(2),x(!1),I(void 0),a.onClose&&a.onClose();case 12:case"end":return l.stop()}},d,null,[[2,7]])}))()}}});var $=(0,u.useState)(!1),M=G()($,2),F=M[0],x=M[1],z=(0,T.useNavigate)(),f=(0,u.useState)(),v=G()(f,2),t=v[0],I=v[1],U=(0,u.useState)(0),y=G()(U,2),h=y[0],j=y[1],c=(0,u.useRef)(),P=(0,u.useRef)(),s=(0,u.useRef)(),b=(0,u.useRef)(),C=(0,u.useRef)(),B=(0,u.useRef)(),K=(0,u.useContext)(ge.Z),sn=K.message,ae=(0,T.useAccess)(),ln=function(){var m=R()(o()().mark(function i(d){var g,L,l,r;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if((g=C.current)===null||g===void 0||g.show(),!d.pullImageUseDPanel){p.next=5;break}return p.next=4,(L=b.current)===null||L===void 0?void 0:L.start();case 4:(l=b.current)===null||l===void 0||l.finish();case 5:return p.prev=5,p.next=8,(0,Z.Oh)(d);case 8:(r=C.current)===null||r===void 0||r.close(),a.onDeployFinish&&a.onDeployFinish(),p.next=15;break;case 12:p.prev=12,p.t0=p.catch(5),a.onDeployFailed&&a.onDeployFailed(t);case 15:j(h+1);case 16:case"end":return p.stop()}},i,null,[[5,12]])}));return function(d){return m.apply(this,arguments)}}(),Ee=function(){var m=R()(o()().mark(function i(d){var g,L,l,r,E,p,w;return o()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return(g=B.current)===null||g===void 0||g.show(),(L=c.current)===null||L===void 0||L.resetFields(),N.next=4,(0,Z.Pn)({id:d}).finally(R()(o()().mark(function D(){var O;return o()().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:(O=B.current)===null||O===void 0||O.destroy();case 1:case"end":return ye.stop()}},D)}))).catch(function(D){throw D});case 4:l=N.sent,r=l.data.detail,r.setting.status&&r.setting.status.indexOf("running")>-1&&(r.isRunning=!0),r.setting.status&&r.setting.status.indexOf("paused")>-1&&(r.isPaused=!0),r.setting.status&&r.setting.status.indexOf("exited")>-1&&(r.isExited=!0),r.setting.status&&r.setting.status=="waiting"?r.isDeploy=!1:r.isDeploy=!0,r.setting.status&&r.setting.status.indexOf("created")>-1&&(r.isCreated=!0,r.isDeploy=!1),E=l.data.project,E&&(r.imageList=ce()(new Set(Object.keys(E.services).map(function(D){var O;return(O=E.services[D].image)!==null&&O!==void 0?O:""})))),r.containerList=l.data.containerList,(!r.containerList||r.containerList.length==0)&&E&&E.services&&(r.containerList=Object.keys(E.services).map(function(D){return{name:"",service:D,publishers:E.services[D].ports?E.services[D].ports.map(function(O){var ee;return{url:"",targetPort:O.target,publishedPort:parseInt(O.published),protocol:(ee=O.protocol)!==null&&ee!==void 0?ee:""}}):[],state:"waiting",status:"",environment:E.services[D].environment}})),r.containerList&&((p=c.current)===null||p===void 0||p.setFieldValue("deployServiceName",l.data.detail.setting.deployServiceName)),r.yamlList=l.data.yaml,I(r),l.data.yaml&&l.data.yaml.map(function(D){(0,Ae.m)(D).map(function(O){r.setting.environment&&!r.setting.environment.find(function(ee){return ee.name==O.name})&&r.setting.environment.push(O)})}),l.data.detail.setting.environment&&((w=c.current)===null||w===void 0||w.setFieldValue("environment",l.data.detail.setting.environment));case 20:case"end":return N.stop()}},i)}));return function(d){return m.apply(this,arguments)}}();return(0,u.useEffect)(function(){h>0&&t&&Ee(t.id||t.name).catch(function(m){x(!1)})},[h]),(0,e.jsx)(Ce.Z,{width:Fe.R_,forceRender:!0,extra:t&&t.setting.type!="dangling"&&(0,e.jsxs)(k.Z,{split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[t.isDeploy&&(0,e.jsx)(Ye,{composeItem:t,showTriggerButton:!0}),ae.canSeeComposeListManage&&(0,e.jsx)(_e.Z,{trigger:(0,e.jsx)(J.Z.Link,{children:(0,e.jsx)(me.Z,{})},"network")},"network-create"),ae.canSeeComposeListManage&&(0,e.jsx)(be,{composeItem:t,onFinish:R()(o()().mark(function m(){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:sn.info("\u4FEE\u6539 Yaml \u540E\u8BF7\u66F4\u65B0\u8BE5\u4EFB\u52A1\uFF0C\u5982\u679C\u5305\u542B\u73AF\u5883\u53D8\u91CF\u6539\u52A8\uFF0C\u8BF7\u91CD\u65B0\u90E8\u7F72"),j(h+1);case 2:case"end":return d.stop()}},m)}))}),ae.canSeeComposeListManageCreate&&(0,e.jsx)(T.Link,{to:"/compose/create?id="+(t.id||t.name),children:(0,e.jsx)(re.Z,{title:"\u7F16\u8F91\u4EFB\u52A1",children:(0,e.jsx)(W.Z,{})})})]}),title:(0,e.jsxs)(k.Z,{children:["\u5FEB\u6377\u67E5\u770B\u4EFB\u52A1 - ",(V=t==null?void 0:t.name)!==null&&V!==void 0?V:""]}),open:F,onClose:function(){x(!1),I(void 0),a.onClose&&a.onClose()},children:(0,e.jsx)(qe.Z,{ref:B,children:(0,e.jsxs)(Q.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,e.jsxs)(Q.Z,{title:(0,e.jsx)(q.Z,{}),subTitle:"\u7BA1\u7406\u4EFB\u52A1",ghost:!0,extra:(0,e.jsx)(e.Fragment,{children:t&&t.imageList&&t.imageList.length>0&&(0,e.jsx)(Pe.Z,{ref:b,image:t.imageList})}),children:[t&&t.setting.type=="dangling"&&(0,e.jsx)(Ze.Z,{type:"warning",showIcon:!0,description:(0,e.jsxs)("div",{children:["\u65E0\u6CD5\u627E\u5230\u8BE5\u4EFB\u52A1\u7684 yaml \u6587\u4EF6\uFF0C \u8BF7\u5728\u9762\u677F\u7684 /dpanel/compose \u76EE\u5F55\u4E2D\u6DFB\u52A0 ",t.name," \u76EE\u5F55, \u5728\u76EE\u5F55\u4E2D\u653E\u7F6E compose.yaml \u6587\u4EF6 ",(0,e.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/compose/external",target:"_blank",children:(0,en.getLang)("notification.help")})]})}),t&&t.setting.type!="dangling"&&(0,e.jsxs)(k.Z,{wrap:!0,split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[(0,e.jsx)(pe.u,{access:"canSeeComposeList",children:(0,e.jsx)(Y.Z,{icon:(0,e.jsx)(X.Z,{}),type:"primary",confirmOnOpenChange:function(i){var d;i&&(!((d=s.current)===null||d===void 0)&&d.resetFields)&&s.current.resetFields()},confirm:(0,e.jsxs)(k.Z,{style:{width:300},direction:"vertical",children:[(0,e.jsx)(J.Z.Text,{children:"\u91CD\u65B0\u521B\u5EFA\u8BE5\u4EFB\u52A1\u4E0B\u7684\u5BB9\u5668\uFF1F"}),(0,e.jsxs)(te.A,{name:"createForm",formRef:s,layout:"inline",submitter:!1,children:[(0,e.jsx)(se.Z.Group,{name:"pullImageUse",layout:"vertical",fieldProps:{style:{display:"flex",flexDirection:"column",gap:8}},valueEnum:{useCommand:"\u4F7F\u7528\u547D\u4EE4\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u547D\u4EE4\u4EE3\u7406\uFF09\uFF1F",useDPanel:"\u4F7F\u7528\u9762\u677F\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u4ED3\u5E93\u52A0\u901F\uFF09\uFF1F"}}),(0,e.jsx)(A.Z,{initialValue:!0,name:"createPath",valuePropName:"checked",children:(0,e.jsx)(_.Z,{defaultChecked:!0,children:"\u521B\u5EFA\u6302\u8F7D\u76EE\u5F55\uFF08\u4EC5\u9762\u677F\u975E\u5BB9\u5668\u90E8\u7F72\u751F\u6548\uFF09\uFF1F"})}),(0,e.jsx)(A.Z,{initialValue:!0,name:"removeOrphans",valuePropName:"checked",children:(0,e.jsx)(_.Z,{defaultChecked:!0,children:"\u6E05\u9664\u5DF2\u91CD\u547D\u540D\u6216\u662F\u88AB\u5220\u9664\u7684\u670D\u52A1\uFF1F"})})]})]}),action:R()(o()().mark(function m(){var i,d,g,L,l,r,E,p,w,ie;return o()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(w={id:t.id||t.name},(i=s.current)!==null&&i!==void 0&&i.getFieldValue&&((d=s.current)===null||d===void 0?void 0:d.getFieldValue("pullImageUse"))=="useDPanel"&&(w.pullImageUseDPanel=!0),w.environment=(g=c.current)===null||g===void 0?void 0:g.getFieldValue("environment"),w.deployServiceName=(L=c.current)===null||L===void 0?void 0:L.getFieldValue("deployServiceName"),w.createPath=(l=(r=s.current)===null||r===void 0?void 0:r.getFieldValue("createPath"))!==null&&l!==void 0?l:!0,w.removeOrphans=(E=(p=s.current)===null||p===void 0?void 0:p.getFieldValue("removeOrphans"))!==null&&E!==void 0?E:!0,!(t!=null&&t.isDeploy)){D.next=10;break}if(!((ie=s.current)!==null&&ie!==void 0&&ie.getFieldValue("pullImageUseCommand"))){D.next=10;break}return D.next=10,(0,Z.GG)({id:t.id||t.name,op:"pull"});case 10:return D.abrupt("return",ln(w));case 11:case"end":return D.stop()}},m)})),children:t.isDeploy?"\u66F4\u65B0":"\u542F\u52A8"},"create")}),(t.isDeploy||t.isCreated)&&ae.canSeeComposeListManage&&(0,e.jsx)(Y.Z,{action:function(){var i;return(i=C.current)===null||i===void 0||i.show(),(0,Z.mg)({id:t.id||t.name,deleteImage:!1,deleteData:!1,deleteVolume:!1,deletePath:!1})},onSuccess:function(){j(h+1)},type:"primary",danger:!0,confirm:"notification.confirm.title",icon:(0,e.jsx)(ue.Z,{}),children:"\u5220\u9664\u5BB9\u5668"}),t.isDeploy&&(0,e.jsxs)(pe.u,{access:"canSeeComposeList",space:{direction:"horizontal"},children:[(0,e.jsx)(Y.Z,{icon:(0,e.jsx)(S.Z,{}),action:R()(o()().mark(function m(){var i;return o()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return(i=C.current)===null||i===void 0||i.show(),g.abrupt("return",(0,Z.GG)({id:t.id||t.name,op:"restart"}));case 2:case"end":return g.stop()}},m)})),onSuccess:function(){j(h+1)},children:"\u91CD\u542F"},"restart"),(0,e.jsx)(Y.Z,{action:function(){var i;return(i=C.current)===null||i===void 0||i.show(),(0,Z.GG)({id:t.id||t.name,op:"stop"})},icon:(0,e.jsx)(fe.Z,{}),disabled:t.isExited,onSuccess:function(){j(h+1)},children:"\u505C\u6B62"}),t.isPaused&&(0,e.jsx)(Y.Z,{action:function(){var i;return(i=C.current)===null||i===void 0||i.show(),(0,Z.GG)({id:t.id||t.name,op:"unpause"})},onSuccess:function(){j(h+1)},icon:(0,e.jsx)(X.Z,{}),children:"\u6062\u590D"}),!t.isPaused&&(0,e.jsx)(Y.Z,{action:function(){var i;return(i=C.current)===null||i===void 0||i.show(),(0,Z.GG)({id:t.id||t.name,op:"pause"})},onSuccess:function(){j(h+1)},icon:(0,e.jsx)(ne.Z,{}),disabled:!t.isRunning,children:"\u6682\u505C"})]}),t.id>0&&ae.canSeeComposeListManageDelete&&(0,e.jsx)(Y.Z,{type:"primary",action:R()(o()().mark(function m(){var i,d,g,L,l,r,E,p,w;return o()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return(i=C.current)===null||i===void 0||i.show(),N.next=3,(0,Z.mg)({id:(d=t==null?void 0:t.id)!==null&&d!==void 0?d:t.name,deleteImage:(g=(L=P.current)===null||L===void 0?void 0:L.getFieldValue("deleteImage"))!==null&&g!==void 0?g:!1,deleteVolume:(l=(r=P.current)===null||r===void 0?void 0:r.getFieldValue("deleteVolume"))!==null&&l!==void 0?l:!1,deletePath:(E=(p=P.current)===null||p===void 0?void 0:p.getFieldValue("deletePath"))!==null&&E!==void 0?E:!1});case 3:return N.next=5,(0,Z.ik)({id:[(w=t.id)!==null&&w!==void 0?w:0]});case 5:j(h+1);case 6:case"end":return N.stop()}},m)})),danger:!0,onSuccess:function(){z("/compose/list")},confirm:(0,e.jsxs)(k.Z,{style:{width:240},direction:"vertical",children:[(0,e.jsx)(J.Z.Text,{children:"\u4F1A\u540C\u65F6\u5220\u9664\u5BB9\u5668\u53CA\u90E8\u7F72\u76F8\u5173\u6570\u636E\uFF0C\u672A\u52FE\u9009\u5220\u9664 compose \u6587\u4EF6\u65F6 yaml \u6587\u4EF6\u5C06\u4F1A\u4FDD\u7559\uFF0C\u786E\u8BA4\u5417\uFF1F"}),(0,e.jsxs)(te.A,{formRef:P,layout:"inline",submitter:!1,children:[(0,e.jsx)(A.Z,{initialValue:!1,name:"deleteImage",valuePropName:"checked",children:(0,e.jsx)(_.Z,{children:"\u5220\u9664\u955C\u50CF\uFF1F"})}),(0,e.jsx)(A.Z,{addonAfter:(0,e.jsx)(re.Z,{title:"\u672A\u6302\u8F7D\u955C\u50CF\u5185\u58F0\u660E\u7684\u76EE\u5F55\u5E76\u7531 docker \u81EA\u52A8\u521B\u5EFA\u7684\u5B58\u50A8\u5377",children:(0,e.jsx)(ve.Z,{})}),initialValue:!1,name:"deleteVolume",valuePropName:"checked",children:(0,e.jsx)(_.Z,{children:"\u5220\u9664\u533F\u540D\u5B58\u50A8\u5377\uFF1F"})}),(0,e.jsx)(A.Z,{initialValue:!1,name:"deletePath",valuePropName:"checked",children:(0,e.jsx)(_.Z,{children:"\u5220\u9664 Compose \u6587\u4EF6\u548C\u4EFB\u52A1\u76EE\u5F55\uFF1F"})})]})]}),children:"\u5220\u9664\u4EFB\u52A1"}),a.showBackListButton&&(0,e.jsx)(T.Link,{to:"/compose/list",children:(0,e.jsx)(Se.ZP,{children:"\u4EFB\u52A1\u5217\u8868"})})]})]},"operator"),t&&(0,e.jsx)(rn,{ref:C,id:t.id||t.name}),t&&(0,e.jsx)(Ge,{containerList:t.containerList,enableSelectService:!t.isDeploy,selectServiceFinish:function(i){var d;(d=c.current)===null||d===void 0||d.setFieldValue("deployServiceName",i)}}),(0,e.jsx)(pe.u,{access:"canSeeComposeList",children:(0,e.jsxs)(te.A,{submitter:!1,formRef:c,children:[(0,e.jsx)(A.Z,{name:"deployServiceName",hidden:!0}),t&&t.setting.type!="dangling"&&(0,e.jsx)(Q.Z,{title:"\u73AF\u5883\u53D8\u91CF",subTitle:"\u73AF\u5883\u53D8\u91CF\u4F1A\u8986\u76D6 .env \u6587\u4EF6",tooltip:"\u66B4\u9732\u73AF\u5883\u53D8\u91CF\u9700\u8981\u5728 yaml \u4E2D\u914D\u7F6E\u73AF\u5883\u53D8\u91CF",ghost:!0,children:(0,e.jsx)(Le.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,requireValue:!0,showDeleteButton:!1})})]})})]})})})}),un=an},35887:function(Re,le,n){var oe=n(5574),ce=n.n(oe),de=n(12323),G=n(78267),xe=n.n(G),o=n(75458),je=n.n(o),R=n(67294),u=n(12320),Y=n.n(u),Z=n(89629),me=n(85893),W=new u.Terminal(de.Xq),q=new o.SearchAddon,X=new G.FitAddon,ue=(0,R.forwardRef)(function(S,fe){var ne,ve=(0,R.useState)(!0),Q=ce()(ve,2),te=Q[0],se=Q[1];return(0,R.useEffect)(function(){return window.addEventListener("resize",function(){S.showInModal||X.fit()}),S.style&&S.style.fontSize&&(W.options.fontSize=S.style.fontSize),W.loadAddon(X),W.loadAddon(q),W.open(document.getElementById(S.id?S.id:"terminal-container")),S.showInModal||X.fit(),function(){W.reset(),se(!0)}},[]),(0,R.useImperativeHandle)(fe,function(){return{write:function(T){te&&(X.fit(),se(!1)),W.write(T)},clear:function(){W.clear()},getTerminal:function(){return W},findNext:function(T){q.findNext(T)},findPrev:function(T){q.findPrevious(T)},fit:function(){X.fit()},onData:function(T){return W.onData(T)}}}),(0,me.jsx)("div",{id:S.id?S.id:"terminal-container",style:{width:S.width?S.width:"100%",height:S.height?S.height:"500px",marginTop:(ne=S.style)===null||ne===void 0?void 0:ne.marginTop}})});le.Z=ue}}]);
