"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9002],{80821:function(V,F,e){e.d(F,{Z:function(){return y}});var B=e(5574),c=e.n(B),x=e(24963),h=e(86738),R=e(28036),A=e(83062),u=e(67294),t=e(85893);function y(r){var P=(0,u.useState)(!1),E=c()(P,2),T=E[0],Z=E[1],K=(0,u.useContext)(x.Z),I=K.lang,X=K.notice,L=K.message,W=function(){Z(!0);var N=r.action();N instanceof Promise?N.then(function(D){if(Z(!1),D){typeof r.onSuccess=="function"&&r.onSuccess(D);var U="";r.messageSuccess?typeof r.messageSuccess=="function"?U=r.messageSuccess(D):U=r.messageSuccess.indexOf("notification.")==0?I(r.messageSuccess):r.messageSuccess:U=I("notification.finish"),r.asynced?L.info(U):L.success(U)}}).catch(function(D){Z(!1),typeof r.onError=="function"&&r.onError(D)}):Z(!1)};return r.confirm?(0,t.jsx)(h.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:I("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?I(r.confirm):r.confirm,onConfirm:W,okText:"Yes",cancelText:"No",children:(0,t.jsx)(R.ZP,{disabled:r.disabled,icon:r.icon,loading:T,danger:r.danger,type:r.type,children:r.children})}):(0,t.jsx)(A.Z,{title:r.tips,children:(0,t.jsx)(R.ZP,{style:r.ghost?{padding:0,height:"auto"}:{},disabled:r.disabled,icon:r.icon,loading:T,onClick:W,danger:r.danger,type:r.type,children:r.children})})}},78451:function(V,F,e){e.d(F,{Z:function(){return x}});var B=e(67294),c=e(85893);function x(h){return(0,c.jsx)("span",{style:{width:h.width?h.width:"auto",wordBreak:"break-word"},children:h.content})}},24963:function(V,F,e){var B=e(67294),c=(0,B.createContext)({});F.Z=c},86783:function(V,F,e){e.r(F),e.d(F,{default:function(){return ye}});var B=e(15009),c=e.n(B),x=e(99289),h=e.n(x),R=e(80821),A=e(78451),u=e(5574),t=e.n(u),y=e(24963),r=e(82346);function P(s){return E.apply(this,arguments)}function E(){return E=h()(c()().mark(function s(g){return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/volume/get-list",{method:"POST",data:g}));case 1:case"end":return l.stop()}},s)})),E.apply(this,arguments)}function T(s){return Z.apply(this,arguments)}function Z(){return Z=h()(c()().mark(function s(g){return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/volume/create",{method:"POST",data:g}));case 1:case"end":return l.stop()}},s)})),Z.apply(this,arguments)}function K(s){return I.apply(this,arguments)}function I(){return I=h()(c()().mark(function s(g){return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,r.request)("/api/app/volume/prune",{method:"POST",data:g});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s)})),I.apply(this,arguments)}function X(s){return L.apply(this,arguments)}function L(){return L=h()(c()().mark(function s(g){return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,r.request)("/api/app/volume/delete",{method:"POST",data:g});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s)})),L.apply(this,arguments)}function W(s){return z.apply(this,arguments)}function z(){return z=h()(c()().mark(function s(g){return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/volume/get-detail",{method:"POST",data:g}));case 1:case"end":return l.stop()}},s)})),z.apply(this,arguments)}var N=e(184),D=e(5966),U=e(62370),te=e(86615),re=e(97462),ae=e(17186),ue=e(24739),ie=e(28036),k=e(34041),O=e(67294),n=e(85893),le=(0,O.forwardRef)(function(s,g){var C=(0,O.useState)(!1),l=t()(C,2),$=l[0],p=l[1],o=(0,O.useRef)(),i=(0,O.useContext)(y.Z),j=i.message,a=i.notice;return(0,O.useImperativeHandle)(g,function(){return{}}),(0,n.jsxs)(N.a,{name:"create",title:"\u6DFB\u52A0\u5B58\u50A8\u5377",open:$,onOpenChange:function(m){p(m)},formRef:o,trigger:(0,n.jsx)(ie.ZP,{type:"primary",children:"\u521B\u5EFA\u5B58\u50A8\u5377"}),onFinish:function(){var d=h()(c()().mark(function m(f){var v,S,Y,M,J,Q;return c()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return M=[],f.otherOptions&&f.otherOptions.map(function(ne){M.push(ne.name+`
`+ne.value)}),w.next=4,T({name:f.name,driver:"local",type:f.type,nfsUrl:(v=f.nfsUrl)!==null&&v!==void 0?v:"",nfsMountPoint:(S=f.nfsMountPoint)!==null&&S!==void 0?S:"",nfsOptions:(Y=f.nfsOptions)!==null&&Y!==void 0?Y:"",tmpfsOptions:f.tmpfsOptions,otherOptions:M});case 4:if(J=w.sent,!(J&&J.data&&J.data.info.Name!="")){w.next=10;break}return j.success("\u6DFB\u52A0\u5B58\u50A8\u5377\u6210\u529F"),s.onFinish&&s.onFinish(),(Q=o.current)===null||Q===void 0||Q.resetFields(),w.abrupt("return",!0);case 10:case"end":return w.stop()}},m)}));return function(m){return d.apply(this,arguments)}}(),children:[(0,n.jsx)(D.Z,{label:"\u540D\u79F0",name:"name",placeholder:"\u6307\u5B9A\u552F\u4E00\u5B58\u50A8\u5377\u540D\u79F0"}),(0,n.jsx)(U.Z,{label:"\u7C7B\u578B",name:"driver",children:(0,n.jsx)(k.Z,{defaultValue:"local",children:(0,n.jsx)(k.Z.Option,{value:"local",children:"local"})})}),(0,n.jsx)(te.Z.Group,{name:"type",label:"\u5B58\u50A8\u7C7B\u578B",valueEnum:{default:"\u9ED8\u8BA4",tmpfs:"tmpfs",nfs:"Nfs",nfs4:"Nfs4",other:"\u81EA\u5B9A\u4E49"},initialValue:"default"}),(0,n.jsx)(re.Z,{name:["type"],children:function(m){var f=m.type;if(f=="other")return(0,n.jsx)(ae.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:"\u5B58\u50A8"},copyIconProps:!1,min:0,children:(0,n.jsxs)(ue.UW,{children:[(0,n.jsx)(D.Z,{name:"name",label:"\u540D\u79F0",placeholder:"\u4F8B\u5982:mountpoint"}),(0,n.jsx)(D.Z,{name:"value",label:"\u503C",placeholder:"\u4F8B\u5982:/etc/path"})]})});if(f=="nfs"||f=="nfs4")return[(0,n.jsx)(D.Z,{label:"\u5730\u5740",name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:"\u914D\u7F6ENfs\u670D\u52A1\u5730\u5740,\u4F8B\u5982 my.nfs.com \u6216\u662F 172.16.1.13 "},"nfsUrl"),(0,n.jsx)(D.Z,{label:"\u6302\u8F7D\u70B9",name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"\u4F8B\u5982, /export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,n.jsx)(D.Z,{label:"\u914D\u7F6E",name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(f=="tmpfs")return[(0,n.jsx)(D.Z,{label:"\u914D\u7F6E",name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),oe=le,q=e(5251),_=e(38345),b=e(26412),se=e(63490),H=e(66309),de=(0,O.forwardRef)(function(s,g){var C;(0,O.useImperativeHandle)(g,function(){return{showDetail:function(f){return h()(c()().mark(function v(){var S;return c()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,W({name:f});case 2:S=M.sent,o(!0),d(S.data);case 5:case"end":return M.stop()}},v)}))()}}});var l=(0,O.useState)(!1),$=t()(l,2),p=$[0],o=$[1],i=(0,O.useState)(),j=t()(i,2),a=j[0],d=j[1];return(0,n.jsxs)(N.a,{title:"\u5B58\u50A8\u8BE6\u60C5",open:p,submitter:!1,onOpenChange:function(f){o(f),!f&&d(void 0)},children:[(0,n.jsx)(_.Z,{title:"\u5B58\u50A8\u8BE6\u60C5",ghost:!0,children:(0,n.jsxs)(b.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:[(0,n.jsx)(b.Z.Item,{label:"\u540D\u79F0",children:a==null?void 0:a.info.Name}),(0,n.jsx)(b.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:new Date((C=a==null?void 0:a.info.CreatedAt)!==null&&C!==void 0?C:"").toLocaleString()}),(0,n.jsx)(b.Z.Item,{label:"\u6302\u8F7D\u70B9",children:a==null?void 0:a.info.Mountpoint}),(0,n.jsx)(b.Z.Item,{label:"\u7C7B\u578B",children:a==null?void 0:a.info.Driver}),(a==null?void 0:a.info.Labels)&&(0,n.jsx)(b.Z.Item,{label:"Lables",children:(0,n.jsx)(b.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:(a==null?void 0:a.info.Labels)&&Object.keys(a==null?void 0:a.info.Labels).map(function(m){return(0,n.jsx)(b.Z.Item,{label:m,children:a.info.Labels[m]})})})})]})}),(0,n.jsx)(_.Z,{title:"\u4F7F\u7528\u5BB9\u5668",ghost:!0,children:(0,n.jsx)(se.Z,{rowKey:"Id",columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"Name",render:function(f,v,S){return(0,n.jsx)(r.Link,{target:"_blank",to:"/app/detail/edit/".concat(v.Id),children:(0,q.fi)(v.Name,"/")})}},{title:"\u5BB9\u5668\u5185\u8DEF\u5F84",dataIndex:"Mount"},{title:"\u6743\u9650",render:function(f,v,S){return v.RW?(0,n.jsx)(H.Z,{children:"\u8BFB\u5199"}):(0,n.jsx)(H.Z,{children:"\u53EA\u8BFB"})}}],dataSource:a==null?void 0:a.inUseContainer,pagination:!1})})]})}),ce=de,fe=e(67255),me=e(36693),he=e(43425),ve=e(90078),ge=e(97269),xe=e(10641),G=e(42075),ee=e(25593),pe=e(84567),je=e(96074),Se=e(83062);function ye(){var s=(0,O.useRef)(),g=(0,O.useRef)(),C=(0,O.useRef)(),l=(0,O.useContext)(y.Z),$=l.lang;return(0,n.jsxs)(ve._z,{header:{extra:[(0,n.jsx)(oe,{onFinish:function(){var o,i;!((o=s.current)===null||o===void 0)&&o.reloadAndRest&&((i=s.current)===null||i===void 0||i.reloadAndRest())}},"create"),(0,n.jsx)(R.Z,{action:function(){var o,i;return K({deleteAll:(o=(i=C.current)===null||i===void 0?void 0:i.getFieldValue("deleteAll"))!==null&&o!==void 0?o:!1})},onSuccess:function(){var o,i;return!((o=s.current)===null||o===void 0)&&o.reloadAndRest&&((i=s.current)===null||i===void 0||i.reloadAndRest()),!0},onError:function(){var o,i;return!((o=s.current)===null||o===void 0)&&o.reset&&((i=s.current)===null||i===void 0||i.reset()),!0},confirm:(0,n.jsx)(ge.A,{formRef:C,submitter:!1,children:(0,n.jsxs)(G.Z,{style:{width:280},direction:"vertical",children:[(0,n.jsx)(ee.Z.Text,{children:$("notification.confirm.title")}),(0,n.jsx)(U.Z,{name:"deleteAll",valuePropName:"checked",children:(0,n.jsx)(pe.Z,{children:"\u662F\u5426\u6E05\u7406\u975E\u533F\u540D\u5377\uFF1F"})})]})}),children:"\u6E05\u7406\u672A\u4F7F\u7528\u5B58\u50A8"})]},children:[(0,n.jsx)(ce,{ref:g}),(0,n.jsx)(xe.Z,{scroll:{x:"max-content"},rowKey:"Name",pagination:(0,fe.O)(),columns:[{title:"\u540D\u79F0",dataIndex:"Name",width:300,render:function(o,i,j,a,d){return(0,n.jsx)(A.Z,{content:i.Name})}},{title:"\u6240\u5C5E\u5BB9\u5668",ellipsis:!0,search:!1,render:function(o,i,j,a,d){return i.InUse?(0,n.jsx)(G.Z,{direction:"vertical",children:i.InUse.map(function(m){return(0,n.jsx)(r.Link,{target:"_blank",to:"/app/detail/edit/"+m.md5,children:(0,n.jsx)(H.Z,{color:"cyan",icon:(0,n.jsx)(me.Z,{}),children:(0,q.fi)(m.name,"/")})})})}):(0,n.jsx)(H.Z,{children:"\u672A\u4F7F\u7528"})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:"\u6302\u8F7D\u70B9",search:!1,width:250,dataIndex:"Mountpoint",render:function(o,i,j,a,d){return(0,n.jsx)(A.Z,{content:i.Mountpoint})}},{title:"\u521B\u5EFA\u65F6\u95F4",ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(o,i,j,a,d){return new Date(i.CreatedAt).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,fixed:"right",render:function(o,i,j,a,d){return(0,n.jsx)(G.Z,{split:(0,n.jsx)(je.Z,{type:"vertical"}),children:(0,n.jsx)(ee.Z.Link,{onClick:function(){var f;(f=g.current)===null||f===void 0||f.showDetail(i.Name)},children:(0,n.jsx)(Se.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(he.Z,{})})})})}}],request:function(){var p=h()(c()().mark(function o(i,j,a){var d,m;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,P({name:i.name});case 2:return d=v.sent,m=[],d.data.inUse?m=d.data.list.map(function(S){return d.data.inUse&&d.data.inUse[S.Name]?S.InUse=d.data.inUse[S.Name]:S.InUse=void 0,S}):m=d.data.list,v.abrupt("return",{data:m,success:!0,total:d.data.list.length});case 6:case"end":return v.stop()}},o)}));return function(o,i,j){return p.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:s,tableAlertOptionRender:function(o){var i=o.selectedRowKeys;return(0,n.jsx)(G.Z,{size:16,children:(0,n.jsx)(R.Z,{danger:!0,type:"primary",action:function(){return X({name:i})},onSuccess:function(){var a,d;return!((a=s.current)===null||a===void 0)&&a.reloadAndRest&&((d=s.current)===null||d===void 0||d.reloadAndRest()),!0},onError:function(){var a,d;return!((a=s.current)===null||a===void 0)&&a.reset&&((d=s.current)===null||d===void 0||d.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"})})}})]})}},5251:function(V,F,e){e.d(F,{FI:function(){return c},NF:function(){return h},ZM:function(){return x},fi:function(){return R}});function B(u){return u.trim()}function c(u){var t="";u<.1*1024?t=u.toFixed(2)+"B":u<.1*1024*1024?t=(u/1024).toFixed(2)+"KB":u<1*1024*1024*1024?t=(u/(1024*1024)).toFixed(2)+"MB":t=(u/(1024*1024*1024)).toFixed(2)+"GB";var y=t+"",r=y.indexOf("."),P=y.substring(r+1,r+3);return P=="00"?y.substring(0,r)+y.substr(r+3,2):t}function x(u){if(u){var t=new Date(u),y=t.getFullYear()+"-",r=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",P=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",E=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",T=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",Z=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return y+r+P+E+T+Z}}function h(u){if(!u||u=="")return"-";var t=new Date(u),y=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),P=String(t.getUTCDate()).padStart(2,"0"),E=String(t.getUTCHours()).padStart(2,"0"),T=String(t.getUTCMinutes()).padStart(2,"0"),Z=String(t.getUTCSeconds()).padStart(2,"0");return"".concat(y,"-").concat(r,"-").concat(P," ").concat(E,":").concat(T,":").concat(Z)}function R(u,t){if(!u||u.length===0)return"";if(t.length===0)return u;for(;u.startsWith(t);)u=u.slice(t.length);return u}function A(u,t){if(!u||u.length===0)return"";if(t.length===0)return u;for(;u.endsWith(t);)u=u.slice(0,u.length-t.length);return u}},67255:function(V,F,e){e.d(F,{O:function(){return B},j:function(){return c}});function B(){var x=localStorage.getItem("dpanel-pagesize");return x=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(x!=null?x:"20")}}function c(x){var h="dpanel-table-column-".concat(x),R={};if(localStorage.getItem(h)){var A;R=JSON.parse((A=localStorage.getItem(h))!==null&&A!==void 0?A:"{}")}return{defaultValue:R,onChange:function(t){localStorage.setItem("dpanel-table-column-".concat(x),JSON.stringify(t))}}}}}]);
