"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7667],{35995:function(b,I,e){e.d(I,{Z:function(){return T}});var L=e(87462),r=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M508 624a112 112 0 00112-112c0-3.28-.15-6.53-.43-9.74L498.26 623.57c3.21.28 6.45.43 9.74.43zm370.72-458.44L836 122.88a8 8 0 00-11.31 0L715.37 232.23Q624.91 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.7 119.43 136.55 191.45L112.56 835a8 8 0 000 11.31L155.25 889a8 8 0 0011.31 0l712.16-712.12a8 8 0 000-11.32zM332 512a176 176 0 01258.88-155.28l-48.62 48.62a112.08 112.08 0 00-140.92 140.92l-48.62 48.62A175.09 175.09 0 01332 512z"}},{tag:"path",attrs:{d:"M942.2 486.2Q889.4 375 816.51 304.85L672.37 449A176.08 176.08 0 01445 676.37L322.74 798.63Q407.82 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5z"}}]},name:"eye-invisible",theme:"filled"},v=j,f=e(84089),p=function(s,h){return r.createElement(f.Z,(0,L.Z)({},s,{ref:h,icon:v}))},m=r.forwardRef(p),T=m},29158:function(b,I,e){e.d(I,{Z:function(){return T}});var L=e(87462),r=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"}}]},name:"link",theme:"outlined"},v=j,f=e(84089),p=function(s,h){return r.createElement(f.Z,(0,L.Z)({},s,{ref:h,icon:v}))},m=r.forwardRef(p),T=m},74842:function(b,I,e){e.d(I,{Z:function(){return T}});var L=e(87462),r=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},v=j,f=e(84089),p=function(s,h){return r.createElement(f.Z,(0,L.Z)({},s,{ref:h,icon:v}))},m=r.forwardRef(p),T=m},87784:function(b,I,e){e.d(I,{Z:function(){return T}});var L=e(87462),r=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},v=j,f=e(84089),p=function(s,h){return r.createElement(f.Z,(0,L.Z)({},s,{ref:h,icon:v}))},m=r.forwardRef(p),T=m},88484:function(b,I,e){e.d(I,{Z:function(){return T}});var L=e(87462),r=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},v=j,f=e(84089),p=function(s,h){return r.createElement(f.Z,(0,L.Z)({},s,{ref:h,icon:v}))},m=r.forwardRef(p),T=m},99861:function(b,I,e){var L=e(15009),r=e.n(L),j=e(64599),v=e.n(j),f=e(99289),p=e.n(f),m=e(5574),T=e.n(m),c=e(42119),s=e(67294),h=e(92754),l=e(3393),B=e(184),t=e(38345),u=e(85893),O=(0,s.forwardRef)(function(i,y){(0,s.useImperativeHandle)(y,function(){return{start:function(){J(!0)}}});var _=(0,s.useState)(0),A=T()(_,2),F=A[0],Z=A[1],M=(0,s.useRef)(),w=(0,s.useState)(!1),$=T()(w,2),Q=$[0],J=$[1];return(0,u.jsxs)(B.a,{trigger:i.trigger,width:800,open:Q,submitter:!1,title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",onOpenChange:function(){var H=p()(r()().mark(function V(E){var g,D,n,R,K,Y,q;return r()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(J(E),!E){S.next=26;break}D=0,n=v()(i.image),S.prev=4,n.s();case 6:if((R=n.n()).done){S.next=16;break}return Y=R.value,Z(D),(K=M.current)===null||K===void 0||K.setStart(Y),S.next=12,(0,l.Gb)({tag:Y,type:"pull"});case 12:q=S.sent,D++;case 14:S.next=6;break;case 16:S.next=21;break;case 18:S.prev=18,S.t0=S.catch(4),n.e(S.t0);case 21:return S.prev=21,n.f(),S.finish(21);case 24:(g=M.current)===null||g===void 0||g.setFinish(),Z(D);case 26:case"end":return S.stop()}},V,null,[[4,18,21,24]])}));return function(V){return H.apply(this,arguments)}}(),children:[(0,u.jsx)(t.Z,{children:(0,u.jsx)(c.Z,{current:F,items:i.image.map(function(H,V){return{title:H,key:V}})})}),(0,u.jsx)(t.Z,{children:(0,u.jsx)(h.Z,{ref:M})})]})});I.Z=O},91058:function(b,I,e){var L=e(5574),r=e.n(L),j=e(89035),v=e(38345),f=e(17186),p=e(24739),m=e(5966),T=e(42075),c=e(14726),s=e(85576),h=e(67294),l=e(95089),B=e(89063),t=e(85893),u="docker-image",O=(0,h.forwardRef)(function(i,y){var _=(0,h.useState)(u),A=r()(_,2),F=A[0],Z=A[1],M=(0,h.useRef)(),w=(0,h.useState)(""),$=r()(w,2),Q=$[0],J=$[1],H=function(){F!="code"?Z("code"):Z(u)};(0,h.useImperativeHandle)(y,function(){return{addEnvItem:function(D,n){var R,K=(R=M.current)===null||R===void 0?void 0:R.getList(),Y=!1;if(K==null||K.map(function(ae){if(ae.name==D){Y=!0;return}}),!Y){var q;(q=M.current)===null||q===void 0||q.add({name:D,value:n})}},clear:function(){var D;(D=M.current)===null||D===void 0||(D=D.getList())===null||D===void 0||D.map(function(n,R){var K;(K=M.current)===null||K===void 0||K.remove(R)})}}});function V(g){try{var D,n;g==""&&(g=E());for(var R=(D=(n=M.current)===null||n===void 0||(n=n.getList())===null||n===void 0?void 0:n.length)!==null&&D!==void 0?D:0,K=R;K>=0;K--){var Y;(Y=M.current)===null||Y===void 0||Y.remove(K)}var q=g.split(`
`),ae=0;q.map(function(S){var ie,ce=S.split("=");ce.length<2||((ie=M.current)===null||ie===void 0||ie.add({name:ce[0],value:ce.slice(1).join("=")},ae),ae++)})}catch(S){console.log(S)}}function E(){if(M&&M.current&&M.current.getList){var g,D=(g=M.current)===null||g===void 0?void 0:g.getList();if(D){var n=[];return D.map(function(R){n.push("".concat(R.name,"=").concat(R.value))}),n.join(`
`)}else return""}else return""}return(0,t.jsxs)(v.Z,{ghost:i.showCardGhost,title:i.label?i.label:null,headerBordered:!0,extra:(i.showCodeMode||i.showImportButton)&&(0,t.jsxs)(T.Z,{children:[i.showImportButton&&(0,t.jsx)("div",{style:{marginBottom:"-25px"},children:(0,t.jsx)(B.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(D){return V(D),!0},onLoad:function(D){if(D.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),i.showCodeMode?(0,t.jsx)(c.ZP,{icon:(0,t.jsx)(j.Z,{}),type:F=="code"?"primary":"default",onClick:H,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,t.jsx)(f.u,{name:i.name?i.name:"environment",actionRef:M,creatorButtonProps:i.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,min:100,children:(0,t.jsxs)(p.UW,{children:[(0,t.jsx)(m.Z,{width:i.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:i.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),(0,t.jsx)(m.Z,{width:i.showInDrawer?"sm":"md",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:!!i.requireValue}],disabled:i.showDisableValue,placeholder:"\u8F93\u5165\u53D8\u91CF\u503C\uFF0C\u53EF\u4EE5\u4E3A\u7A7A"})]})}),(0,t.jsx)(s.Z,{width:"800px",open:F=="code",onCancel:function(){return Z("docker-image")},onOk:function(){V(Q),Z("docker-image")},children:(0,t.jsx)(l.ZP,{onChange:function(D){return J(D)},value:E(),height:"680px",theme:"light"})})]})});I.Z=O},80821:function(b,I,e){e.d(I,{Z:function(){return c}});var L=e(5574),r=e.n(L),j=e(24963),v=e(86738),f=e(14726),p=e(83062),m=e(67294),T=e(85893);function c(s){var h=(0,m.useState)(!1),l=r()(h,2),B=l[0],t=l[1],u=(0,m.useContext)(j.Z),O=u.lang,i=u.notice,y=u.message,_=function(){t(!0),s.action().then(function(F){if(t(!1),typeof s.onSuccess=="function"&&s.onSuccess(F),s.messageSuccess){var Z="";typeof s.messageSuccess=="function"?Z=s.messageSuccess(F):Z=s.messageSuccess,Z.indexOf(".")>-1&&(Z=O(Z)),s.asynced?y.info(Z):y.success(Z)}}).catch(function(F){t(!1),typeof s.onError=="function"&&s.onError(F)})};return s.confirm?(0,T.jsx)(v.Z,{style:{width:500},title:s.confirmTitle?s.confirmTitle:O("notification.title.tip"),description:s.confirm,onConfirm:_,okText:"Yes",cancelText:"No",children:(0,T.jsx)(f.ZP,{disabled:s.disabled,icon:s.icon,loading:B,danger:s.danger,type:s.type,children:s.children})}):(0,T.jsx)(p.Z,{title:s.tips,children:(0,T.jsx)(f.ZP,{disabled:s.disabled,icon:s.icon,loading:B,onClick:_,danger:s.danger,type:s.type,children:s.children})})}},37413:function(b,I,e){e.d(I,{Z:function(){return B}});var L=e(19632),r=e.n(L),j=e(27496),v=e(35995),f=e(99611),p=e(29158),m=e(38345),T=e(55241),c=e(42075),s=e(66309),h=e(67294),l=e(85893);function B(t){return(0,l.jsx)(T.Z,{placement:"right",content:(0,l.jsxs)(m.Z,{direction:"column",style:{width:500},ghost:!0,children:[(0,l.jsx)(m.Z,{title:"\u7AEF\u53E3",children:[].concat(r()(t.publicPort),r()(t.privatePort)).map(function(u,O){var i=t.serverIp;return i!=""&&i.indexOf(":")>-1&&(i="[".concat(i,"]")),i==""&&u.IP=="::"&&(i="[::1]"),i==""&&u.IP=="0.0.0.0"&&(i="127.0.0.1"),i==""&&(i=u.IP),(0,l.jsx)(c.Z,{size:"large",wrap:!0,children:(0,l.jsx)(s.Z,{color:u.PublicPort?"#2db7f5":"warning",icon:u.PublicPort?(0,l.jsx)(j.Z,{}):"",style:{marginBottom:5,width:210},children:u.PublicPort?(0,l.jsx)("a",{href:"http://".concat(i,":").concat(u.PublicPort),target:"_blank",children:"".concat(u.PublicPort?u.IP+":"+u.PublicPort+" -> ":"").concat(u.PrivatePort,"/").concat(u.Type)},"link".concat(O)):"".concat(u.PrivatePort,"/").concat(u.Type)})},"space".concat(O))})}),t.domain.length>0&&(0,l.jsx)(m.Z,{title:"\u57DF\u540D",children:(0,l.jsx)(c.Z,{direction:"vertical",style:{textAlign:"left"},children:t.domain.map(function(u,O){return(0,l.jsx)(s.Z,{color:"blue",icon:(0,l.jsx)(j.Z,{}),children:(0,l.jsx)("a",{href:u,target:"_blank",children:u})},"domain".concat(O))})})})]}),children:(0,l.jsxs)(c.Z,{direction:"vertical",children:[t.privatePort.length>0&&(0,l.jsxs)(s.Z,{color:"warning",icon:(0,l.jsx)(v.Z,{}),children:["\u5185\u90E8\u7AEF\u53E3: ",t.privatePort.length]}),t.publicPort.length>0&&(0,l.jsxs)(s.Z,{color:"#2db7f5",icon:(0,l.jsx)(f.Z,{}),children:["\u5BF9\u5916\u7AEF\u53E3: ",t.publicPort.length]}),t.domain.length>0&&(0,l.jsxs)(s.Z,{color:"blue",icon:(0,l.jsx)(p.Z,{}),children:["\u7ED1\u5B9A\u57DF\u540D: ",t.domain.length]})]})})}},94359:function(b,I,e){e.d(I,{Z:function(){return B}});var L=e(67294),r=e(3089),j=e(98165),v=e(18429),f=e(8751),p=e(14313),m=e(30159),T=e(87740),c=e(66309),s=e(83062),h=e(54006),l=e(85893);function B(t){var u=(0,l.jsx)(l.Fragment,{});if(t.status=="0"&&(u=(0,l.jsx)(c.Z,{icon:(0,l.jsx)(r.Z,{}),color:"default",children:"waiting"})),t.status=="10"&&(u=(0,l.jsx)(c.Z,{icon:(0,l.jsx)(j.Z,{spin:!0}),color:"processing",children:"processing"})),t.status=="20"&&(u=(0,l.jsx)(c.Z,{icon:(0,l.jsx)(v.Z,{}),color:"error",children:"error"})),t.status=="30"&&(u=(0,l.jsx)(c.Z,{icon:(0,l.jsx)(f.Z,{}),color:"success",children:"success"})),t.status=="running"||t.status=="healthy"){var O,i;u=(0,l.jsx)(c.Z,{icon:(0,l.jsx)(p.Z,{}),color:"success",children:(O=t.message)!==null&&O!==void 0&&O.showInTag?(i=t.message)===null||i===void 0?void 0:i.content:t.status})}if(t.status=="paused"){var y,_;u=(0,l.jsx)(c.Z,{icon:(0,l.jsx)(m.Z,{}),children:(y=t.message)!==null&&y!==void 0&&y.showInTag?(_=t.message)===null||_===void 0?void 0:_.content:t.status})}if(t.status=="waiting"||t.status=="starting"){var A,F;u=(0,l.jsx)(c.Z,{icon:(0,l.jsx)(T.Z,{}),children:(A=t.message)!==null&&A!==void 0&&A.showInTag?(F=t.message)===null||F===void 0?void 0:F.content:t.status})}if(t.status=="exited"||t.status=="dead"||t.status=="removing"||t.status=="restarting"||t.status=="unhealthy"||t.status=="created"){var Z,M;u=(0,l.jsx)(c.Z,{icon:(0,l.jsx)(v.Z,{}),color:"warning",children:(Z=t.message)!==null&&Z!==void 0&&Z.showInTag?(M=t.message)===null||M===void 0?void 0:M.content:t.status})}if(t.link&&(u=(0,l.jsx)(h.Link,{to:t.link,children:u})),t.message){var w;u=(0,l.jsx)(s.Z,{placement:(w=t.message.placement)!==null&&w!==void 0?w:"top",title:t.message.content,children:u})}return(0,l.jsx)(l.Fragment,{children:u})}},89063:function(b,I,e){e.d(I,{Z:function(){return T}});var L=e(24963),r=e(88484),j=e(31418),v=e(72723),f=e(14726),p=e(67294),m=e(85893);function T(c){var s=(0,p.useContext)(L.Z),h=s.message,l=s.notice,B=s.lang,t=(0,p.useRef)(null),u=j.Z.useApp(),O=function(){t.current&&(t.current.click(),t.current.onchange=function(y){if(!y||!y.target)return"";var _=new FileReader;_.onload=function(F){var Z,M,w=(Z=F.target)===null||Z===void 0?void 0:Z.result;if(c.onLoad)try{c.onLoad&&c.onLoad(w)}catch($){l.error($);return}typeof c.onImport=="function"&&c.onImport(w),(M=t.current)!==null&&M!==void 0&&M.value&&(t.current.value="")};var A=y.target;if(A.files)try{_.readAsText(A.files[0])}catch(F){l.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(v.Z.Item,{name:"importFile",label:c.label,children:(0,m.jsx)(f.ZP,{icon:(0,m.jsx)(r.Z,{}),block:!0,onClick:O,children:c.title})}),(0,m.jsx)("input",{style:{display:"none"},type:"file",ref:t,name:"importFileInput"})]})}},92754:function(b,I,e){var L=e(5574),r=e.n(L),j=e(67294),v=e(54006),f=e(38703),p=e(85893),m=(0,j.forwardRef)(function(T,c){var s=(0,j.useState)(""),h=r()(s,2),l=h[0],B=h[1];(0,j.useImperativeHandle)(c,function(){return{setFinish:function(){y({finish:{downloading:100,extracting:100}})},setStart:function(A){A&&B(A),y({start:{downloading:0,extracting:0}})}}});var t=(0,v.useModel)("subscriber");t.addDataHandler("image:pull:"+l,function(_){y(_.data)});var u=(0,j.useState)(),O=r()(u,2),i=O[0],y=O[1];return(0,j.useEffect)(function(){y({start:{downloading:0,extracting:0}})},[]),(0,p.jsx)(p.Fragment,{children:i&&Object.keys(i).map(function(_){return(0,p.jsx)(f.Z,{percent:i[_].downloading,success:{percent:i[_].extracting}},_)})})});I.Z=m},54964:function(b,I,e){e.d(I,{a:function(){return s}});var L=e(78267),r=e.n(L),j=e(75458),v=e.n(j),f=e(67294),p=e(12320),m=e.n(p),T=e(89629),c=e(85893),s={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},h=new p.Terminal(s),l=new j.SearchAddon,B=new L.FitAddon,t=(0,f.forwardRef)(function(u,O){return(0,f.useEffect)(function(){window.addEventListener("resize",function(){u.showInModal||B.fit()}),u.style&&u.style.fontSize&&(h.options.fontSize=u.style.fontSize),h.loadAddon(B),h.loadAddon(l),h.open(document.getElementById("terminal-container")),B.fit()},[]),(0,f.useImperativeHandle)(O,function(){return{write:function(y){h.write(y)},clear:function(){h.clear()},getTerminal:function(){return h},findNext:function(y){l.findNext(y)},findPrev:function(y){l.findPrevious(y)},fit:function(){B.fit()},onData:function(y){h.onData(y)}}}),(0,c.jsx)("div",{id:"terminal-container",style:{width:u.width?u.width:"100%",height:u.height?u.height:"500px"}})});I.Z=t},24963:function(b,I,e){var L=e(67294),r=(0,L.createContext)({});I.Z=r},9740:function(b,I,e){e.r(I),e.d(I,{default:function(){return Ue}});var L=e(15009),r=e.n(L),j=e(99289),v=e.n(j),f=e(5574),p=e.n(f),m=e(80821),T=e(54964),c=e(90098),s=e(43425),h=e(74842),l=e(48689),B=e(33160),t=e(87784),u=e(30159),O=e(86548),i=e(89035),y=e(45742),_=e(90078),A=e(38345),F=e(97269),Z=e(62370),M=e(54006),w=e(14726),$=e(72269),Q=e(42075),J=e(25593),H=e(84567),V=e(96074),E=e(38925),g=e(63490),D=e(83062),n=e(92398),R=e(67294),K=e(99861),Y=e(95089),q=e(95213),ae=e(24963),S=e(91058),ie=e(12320),ce=e(89629),Le=e(78267),a=e(85893),le=new ie.Terminal(T.a),_e=new Le.FitAddon;function Ae(re){var ue=(0,M.useModel)("subscriber");return ue.addDataHandler("compose:log:"+re.id,function(oe){le.write(oe.data)}),(0,R.useEffect)(function(){return window.addEventListener("resize",function(){_e.fit()}),le.options.fontSize=12,le.loadAddon(_e),le.open(document.getElementById("terminal-log")),_e.fit(),le.clear(),function(){ue.progress.close("compose:log:"+re.id)}},[re.id]),(0,a.jsx)("div",{id:"terminal-log",style:{width:"100%",height:"500px"}})}var Be=e(37413),Ze=e(87662),Re=e(94359);function Ue(){var re,ue,oe,ve=(0,R.useContext)(ae.Z),he=ve.loading,Fe=ve.lang,de=(0,M.useParams)(),Se=(0,M.useNavigate)(),We=(0,R.useState)(),ge=p()(We,2),d=ge[0],Ke=ge[1],be=(0,R.useState)({deleteVolume:!1,deleteImage:!1,deleteData:!1,deletePath:!1}),Ee=p()(be,2),X=Ee[0],me=Ee[1],ee=(0,R.useRef)(),we=(0,R.useState)(0),Pe=p()(we,2),te=Pe[0],ne=Pe[1],Ve=(0,R.useState)("default"),De=p()(Ve,2),ze=De[0],se=De[1],k=(0,R.useRef)(),pe=(0,M.useModel)("subscriber"),Ge=(0,R.useState)(""),Oe=p()(Ge,2),Ne=Oe[0],$e=Oe[1],He=(0,R.useState)("default"),Ce=p()(He,2),je=Ce[0],Me=Ce[1],Ye=(0,R.useState)({pullImage:!0}),xe=p()(Ye,2),ye=xe[0],Ie=xe[1];return pe.addDataHandler("compose:"+de.id,function(C){var o;(o=ee.current)===null||o===void 0||o.write(C.data)}),(0,R.useEffect)(function(){var C;return he.show(),Ie({pullImage:!0}),(0,c.Pn)({id:parseInt((C=de.id)!==null&&C!==void 0?C:"")}).then(function(o){var P,x=o.data.detail;if(x.setting.status&&x.setting.status.indexOf("running")>-1&&(x.isRunning=!0),x.setting.status&&x.setting.status.indexOf("paused")>-1&&(x.isPaused=!0),x.setting.status&&x.setting.status.indexOf("exited")>-1&&(x.isExited=!0),x.setting.status&&x.setting.status=="waiting"?x.isDeploy=!1:x.isDeploy=!0,x.setting.status&&x.setting.status.indexOf("created")>-1&&(x.isCreated=!0,x.isDeploy=!1),o.data.project&&(x.imageList=Object.keys(o.data.project.services).map(function(N){var G;return(G=o.data.project.services[N].image)!==null&&G!==void 0?G:""})),o.data.containerList){var z;(0,Ze.pe)({groupName:"setting",name:"server"}).then(function(N){N.data.setting.value.serverIp&&$e(N.data.setting.value.serverIp)}),x.containerList=o.data.containerList,(z=k.current)===null||z===void 0||z.setFieldValue("deployServiceName",o.data.containerList.map(function(N){return N.name}))}x.yamlList=o.data.yaml,Ke(x);var U=o.data.project;if(U!=null&&U.services&&Object.keys(U.services).map(function(N){var G=[];if(U.services&&U.services[N]&&(U.services[N].environment&&Object.keys(U.services[N].environment).map(function(Te){U.services[N].environment&&G.push({name:Te,value:U.services[N].environment[Te]})}),G.length!=0)){var fe;(fe=k.current)===null||fe===void 0||fe.setFieldValue(["environmentService",N],G)}}),(P=k.current)===null||P===void 0||P.setFieldValue("environment",o.data.detail.setting.environment),x.isDeploy){var W;(0,c.VN)({id:parseInt((W=de.id)!==null&&W!==void 0?W:"")})}}).catch(function(){Se("/compose/list")}).finally(function(){he.destroy()}),function(){pe.progress.close("compose:log:"+de.id)}},[te]),(0,a.jsx)(_._z,{header:{extra:[(0,a.jsx)(M.Link,{to:"/compose/create",reloadDocument:location.search.length>0,children:(0,a.jsx)(w.ZP,{type:"primary",children:"\u521B\u5EFA\u4EFB\u52A1"},"createCompose")},"create")]},children:(0,a.jsxs)(A.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,a.jsx)(A.Z,{title:(0,a.jsx)(s.Z,{}),subTitle:"\u64CD\u4F5C - "+(d==null?void 0:d.name),bordered:!0,extra:(0,a.jsx)(a.Fragment,{children:d&&d.imageList&&d.imageList.length>0&&(0,a.jsx)(K.Z,{image:d.imageList,trigger:(0,a.jsx)($.Z,{checkedChildren:"\u4F7F\u7528\u9762\u677F\u62C9\u53D6\u955C\u50CF",unCheckedChildren:"\u4F7F\u7528\u9762\u677F\u62C9\u53D6\u955C\u50CF",value:je!="default",onChange:function(o){Me(o?"dpanel":"default")}})})}),headerBordered:!0,children:d!=null&&d.yamlList&&d.yamlList[0]!=""?(0,a.jsxs)(Q.Z,{wrap:!0,children:[(0,a.jsx)(m.Z,{icon:(0,a.jsx)(h.Z,{}),type:"primary",confirm:(0,a.jsxs)(Q.Z,{style:{width:280},direction:"vertical",children:[(0,a.jsx)(J.Z.Text,{children:"\u91CD\u65B0\u521B\u5EFA\u8BE5\u4EFB\u52A1\u4E0B\u7684\u5BB9\u5668\uFF1F"}),(0,a.jsx)(H.Z,{name:"deleteImage",checked:ye.pullImage,onChange:function(o){return Ie({pullImage:o.target.checked})},children:"\u91CD\u65B0\u62C9\u53D6\u955C\u50CF\uFF1F"})]}),action:v()(r()().mark(function C(){var o,P,x,z,U,W;return r()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(se("deploy"),(o=ee.current)===null||o===void 0||o.clear(),U={id:(P=d==null?void 0:d.id)!==null&&P!==void 0?P:0},U.environment=(x=k.current)===null||x===void 0?void 0:x.getFieldValue("environment"),U.deployServiceName=(z=k.current)===null||z===void 0?void 0:z.getFieldValue("deployServiceName"),!(d!=null&&d.isDeploy)){G.next=9;break}if(!(je=="default"&&ye.pullImage)){G.next=9;break}return G.next=9,(0,c.GG)({id:(W=d==null?void 0:d.id)!==null&&W!==void 0?W:0,op:"pull"});case 9:return G.next=11,(0,c.Oh)(U);case 11:ne(te+1);case 12:case"end":return G.stop()}},C)})),children:d.isDeploy?"\u66F4\u65B0":"\u542F\u52A8"},"create"),d.isDeploy&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{action:function(){var o,P;return(o=ee.current)===null||o===void 0||o.clear(),se("destory"),(0,c.mg)({id:(P=d==null?void 0:d.id)!==null&&P!==void 0?P:0,deleteImage:!1,deleteData:!1,deleteVolume:!1})},onSuccess:function(){ne(te+1)},confirm:"\u662F\u5426\u8981\u9500\u6BC1\u5BB9\u5668\uFF1F",type:"primary",danger:!0,messageSuccess:"\u9500\u6BC1\u6210\u529F",icon:(0,a.jsx)(l.Z,{}),children:"\u5220\u9664\u5E76\u505C\u6B62"}),(0,a.jsx)(V.Z,{type:"vertical"}),(0,a.jsx)(m.Z,{icon:(0,a.jsx)(B.Z,{}),action:v()(r()().mark(function C(){var o;return r()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return se("crtl"),x.next=3,(0,c.GG)({id:(o=d==null?void 0:d.id)!==null&&o!==void 0?o:0,op:"restart"});case 3:ne(te+1);case 4:case"end":return x.stop()}},C)})),children:"\u91CD\u542F"},"restart"),(0,a.jsx)(m.Z,{action:function(){var o,P;return(o=ee.current)===null||o===void 0||o.clear(),se("crtl"),(0,c.GG)({id:(P=d==null?void 0:d.id)!==null&&P!==void 0?P:0,op:"stop"})},messageSuccess:"\u505C\u6B62\u6210\u529F",icon:(0,a.jsx)(t.Z,{}),disabled:d.isExited,onSuccess:function(){ne(te+1)},children:"\u505C\u6B62"}),d.isPaused&&(0,a.jsx)(m.Z,{action:function(){var o,P;return se("crtl"),(o=ee.current)===null||o===void 0||o.clear(),(0,c.GG)({id:(P=d==null?void 0:d.id)!==null&&P!==void 0?P:0,op:"unpause"})},messageSuccess:"\u6062\u590D\u6210\u529F",onSuccess:function(){ne(te+1)},icon:(0,a.jsx)(h.Z,{}),children:"\u6062\u590D"}),!d.isPaused&&(0,a.jsx)(m.Z,{action:function(){var o,P;return se("crtl"),(o=ee.current)===null||o===void 0||o.clear(),(0,c.GG)({id:(P=d==null?void 0:d.id)!==null&&P!==void 0?P:0,op:"pause"})},onSuccess:function(){ne(te+1)},messageSuccess:"\u6682\u505C\u6210\u529F",icon:(0,a.jsx)(u.Z,{}),disabled:!d.isRunning,children:"\u6682\u505C"})]}),(0,a.jsx)(V.Z,{type:"vertical"}),d.id>0&&(0,a.jsx)(M.Link,{to:"/compose/create?id="+d.id,children:(0,a.jsx)(w.ZP,{icon:(0,a.jsx)(O.Z,{}),children:"\u7F16\u8F91\u4EFB\u52A1"})}),d.isDeploy&&(0,a.jsx)(m.Z,{type:"primary",action:v()(r()().mark(function C(){var o,P,x;return r()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return(o=ee.current)===null||o===void 0||o.clear(),se("destory"),U.next=4,(0,c.mg)({id:(P=d==null?void 0:d.id)!==null&&P!==void 0?P:0,deleteImage:X.deleteImage,deleteData:!0,deleteVolume:X.deleteVolume});case 4:x=U.sent,ne(te+1);case 6:case"end":return U.stop()}},C)})),danger:!0,confirm:(0,a.jsxs)(Q.Z,{style:{width:280},direction:"vertical",children:[(0,a.jsx)(J.Z.Text,{children:"\u5220\u9664\u5BB9\u5668\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"}),(0,a.jsx)(H.Z,{name:"deleteImage",onChange:function(o){return me({deleteImage:o.target.checked,deleteData:X.deleteData,deleteVolume:X.deleteVolume,deletePath:X.deletePath})},children:"\u5220\u9664\u955C\u50CF\uFF1F"}),(0,a.jsx)(H.Z,{name:"deleteVolume",onChange:function(o){return me({deleteData:X.deleteImage,deleteImage:X.deleteImage,deleteVolume:o.target.checked,deletePath:X.deletePath})},children:"\u5220\u9664\u5B58\u50A8\u5377\uFF1F"}),(0,a.jsx)(H.Z,{name:"deleteVolume",onChange:function(o){return me({deleteData:X.deleteImage,deleteImage:X.deleteImage,deleteVolume:X.deleteVolume,deletePath:o.target.checked})},children:"\u5220\u9664\u4EFB\u52A1\u5B58\u653E\u76EE\u5F55\uFF1F"})]}),children:"\u5220\u9664\u4EFB\u52A1"})]}):(0,a.jsx)(E.Z,{showIcon:!0,type:"info",message:(0,a.jsxs)(a.Fragment,{children:["\u65E0\u6CD5\u83B7\u53D6\u8BE5\u4EFB\u52A1\u7684 compose.yaml \u6587\u4EF6\uFF0C\u65E0\u7BA1\u7406\u6743\u9650\u3002",(0,a.jsx)("a",{target:"_blank",href:"https://dpanel.cc/#/zh-cn/manual/compose/external",children:"\u5982\u4F55\u7BA1\u7406\u5916\u90E8\u4EFB\u52A1\uFF1F"})]})})},"operator"),(0,a.jsxs)(A.Z,{split:"vertical",children:[(0,a.jsxs)(A.Z,{colSpan:"45%",direction:"column",split:"horizontal",title:"\u542F\u52A8\u914D\u7F6E",subTitle:"\u7F16\u8F91\u540E\u53EA\u5F71\u54CD\u672C\u6B21\u90E8\u7F72",children:[ze!="default"&&(0,a.jsx)(A.Z,{title:(0,a.jsx)(i.Z,{}),subTitle:"\u63A7\u5236\u53F0",extra:(0,a.jsx)(Q.Z,{children:(0,a.jsx)(m.Z,{action:function(){var o;return(o=ee.current)===null||o===void 0||o.clear(),(0,c.U_)({})},icon:(0,a.jsx)(l.Z,{}),danger:!0,onSuccess:function(){ne(te+1)},children:"\u4E2D\u6B62\u6267\u884C"},"kill")}),children:(0,a.jsx)(T.Z,{width:"100%",height:"300px",showInModal:!0,style:{fontSize:12},ref:ee})}),d&&(0,a.jsx)(A.Z,{children:(0,a.jsx)(g.Z,{rowKey:"name",pagination:!1,columns:[{title:"\u540D\u79F0",dataIndex:"name"},{title:"\u7AEF\u53E3",render:function(o,P,x){var z=[],U=[];return P.publishers&&P.publishers.map(function(W){W.publishedPort?z.push({PrivatePort:W.targetPort,Type:W.protocol,IP:W.url,PublicPort:W.publishedPort}):W.publishedPort&&U.push({PrivatePort:W.targetPort,Type:W.protocol,IP:W.url,PublicPort:W.publishedPort})}),(0,a.jsx)(Be.Z,{publicPort:z,privatePort:U,domain:[],serverIp:Ne})}},{title:"\u72B6\u6001",render:function(o,P,x){return(0,a.jsx)(Re.Z,{status:P.state,message:{content:Fe("container.".concat(P.state)),placement:"top",showInTag:!0}},P.name)}},{title:"\u64CD\u4F5C",render:function(o,P,x){return(0,a.jsxs)(Q.Z,{split:(0,a.jsx)(V.Z,{type:"vertical"}),children:[(0,a.jsx)(M.Link,{to:"/app/detail/edit/"+P.name,target:"_blank",children:(0,a.jsx)(D.Z,{title:"\u7BA1\u7406\u5BB9\u5668",children:(0,a.jsx)(s.Z,{})})},"edit"),P.state=="running"&&(0,a.jsx)(M.Link,{target:"_blank",to:"/console/"+P.name,children:(0,a.jsx)(D.Z,{title:"\u7EC8\u7AEF",children:(0,a.jsx)(i.Z,{})})},"console")]})}}],dataSource:d.containerList,rowSelection:d.isDeploy?null:{defaultSelectedRowKeys:d.containerList.map(function(C){return C.name}),onChange:function(o,P,x){var z;(z=k.current)===null||z===void 0||z.setFieldValue("deployServiceName",o)}}})}),(0,a.jsxs)(F.A,{formRef:k,submitter:!1,children:[(0,a.jsx)(Z.Z,{name:"deployServiceName",hidden:!0}),!(d!=null&&d.isDeploy)&&(0,a.jsx)(A.Z,{title:"\u73AF\u5883\u53D8\u91CF",subTitle:".dpanel.env \u6587\u4EF6",children:(0,a.jsx)(S.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,showInDrawer:!0,requireValue:!0})}),!(d!=null&&d.isDeploy)&&(0,a.jsx)(A.Z,{title:"\u670D\u52A1\u73AF\u5883\u53D8\u91CF",tooltip:"\u4FEE\u6539\u670D\u52A1\u4E2D\u7684\u73AF\u5883\u53D8\u91CF\u65F6\uFF0C\u8BF7\u5728 yaml \u4E2D\u5C06\u503C\u5148\u6620\u5C04\u6210\u81EA\u5B9A\u4E49\u7684\u53D8\u91CF\u540D",children:(0,a.jsx)(n.Z,{indicator:{align:"center"},items:k&&k.current&&((re=k.current)===null||re===void 0?void 0:re.getFieldValue("environmentService"))&&Object.keys((ue=k.current)===null||ue===void 0?void 0:ue.getFieldValue("environmentService")).map(function(C){return{label:C,key:C,children:(0,a.jsx)(S.Z,{showCardGhost:!0,name:["environmentService",C],showDisableName:!0,showDisableValue:!0,showInDrawer:!0,requireValue:!0})}})})})]})]}),d&&!d.isDeploy&&(0,a.jsx)(A.Z,{colSpan:"55%",children:(0,a.jsx)(n.Z,{items:d.yamlList.map(function(C,o){var P=[{label:"Yaml \u6587\u4EF6",key:"yaml"},{label:"\u8986\u76D6 Yaml \u6587\u4EF6",key:"yamlOverride"}];return{label:P[o].label,key:P[o].key,disabled:C=="",children:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Y.ZP,{theme:"dark",minHeight:"550px",value:C,readOnly:!0,extensions:[q.RI.yaml()]})})}})})}),d&&d.isDeploy&&(0,a.jsx)(A.Z,{title:(0,a.jsx)(y.Z,{}),subTitle:"\u65E5\u5FD7",colSpan:"55%",children:(0,a.jsx)(Ae,{id:(oe=de.id)!==null&&oe!==void 0?oe:""})})]})]})})}},90098:function(b,I,e){e.d(I,{CT:function(){return l},GG:function(){return A},MG:function(){return Q},Oh:function(){return O},Pn:function(){return s},U_:function(){return w},VN:function(){return Z},ik:function(){return t},im:function(){return p},mg:function(){return y},pm:function(){return T},xC:function(){return H}});var L=e(15009),r=e.n(L),j=e(99289),v=e.n(j),f=e(54006);function p(E){return m.apply(this,arguments)}function m(){return m=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/create",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),m.apply(this,arguments)}function T(E){return c.apply(this,arguments)}function c(){return c=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/get-list",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),c.apply(this,arguments)}function s(E){return h.apply(this,arguments)}function h(){return h=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/get-task",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),h.apply(this,arguments)}function l(E){return B.apply(this,arguments)}function B(){return B=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/get-detail",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),B.apply(this,arguments)}function t(E){return u.apply(this,arguments)}function u(){return u=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/delete",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),u.apply(this,arguments)}function O(E){return i.apply(this,arguments)}function i(){return i=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/container-deploy",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),i.apply(this,arguments)}function y(E){return _.apply(this,arguments)}function _(){return _=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/container-destroy",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),_.apply(this,arguments)}function A(E){return F.apply(this,arguments)}function F(){return F=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/container-ctrl",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),F.apply(this,arguments)}function Z(E){return M.apply(this,arguments)}function M(){return M=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/container-log",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),M.apply(this,arguments)}function w(E){return $.apply(this,arguments)}function $(){return $=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/container-process-kill",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),$.apply(this,arguments)}function Q(E){return J.apply(this,arguments)}function J(){return J=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/get-from-uri",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),J.apply(this,arguments)}function H(E){return V.apply(this,arguments)}function V(){return V=v()(r()().mark(function E(g){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,f.request)("/api/app/compose/parse",{method:"POST",data:g}));case 1:case"end":return n.stop()}},E)})),V.apply(this,arguments)}},3393:function(b,I,e){e.d(I,{Gb:function(){return T},Pn:function(){return l},Rb:function(){return t},YU:function(){return p},_U:function(){return s}});var L=e(15009),r=e.n(L),j=e(99289),v=e.n(j),f=e(54006);function p(O){return m.apply(this,arguments)}function m(){return m=v()(r()().mark(function O(i){return r()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,f.request)("/api/app/image/get-detail",{method:"POST",data:i}));case 1:case"end":return _.stop()}},O)})),m.apply(this,arguments)}function T(O){return c.apply(this,arguments)}function c(){return c=v()(r()().mark(function O(i){return r()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,f.request)("/api/app/image/tag-remote",{method:"POST",data:i}));case 1:case"end":return _.stop()}},O)})),c.apply(this,arguments)}function s(O){return h.apply(this,arguments)}function h(){return h=v()(r()().mark(function O(i){return r()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,f.request)("/api/app/image/tag-add",{method:"POST",data:i}));case 1:case"end":return _.stop()}},O)})),h.apply(this,arguments)}function l(O){return B.apply(this,arguments)}function B(){return B=v()(r()().mark(function O(i){return r()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,f.request)("/api/app/image/tag-delete",{method:"POST",data:i}));case 1:case"end":return _.stop()}},O)})),B.apply(this,arguments)}function t(O){return u.apply(this,arguments)}function u(){return u=v()(r()().mark(function O(i){return r()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,f.request)("/api/app/image/export",{method:"POST",data:i,responseType:"blob"}));case 1:case"end":return _.stop()}},O)})),u.apply(this,arguments)}}}]);
