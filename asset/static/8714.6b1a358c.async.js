"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8714],{68714:function(mn,nn,n){n.d(nn,{Z:function(){return Dn}});var en=n(5574),c=n.n(en),an=n(15009),l=n.n(an),tn=n(99289),P=n.n(tn),i=n(67294),rn=n(37767),K=n(60335),z=n(82346),sn=n(58638),G=n(85265),on=n(96074),Z=n(83062),B=n(86250),N=n(52031),ln=n(14189),un=n(72409),dn=n(21393),X=n(184),y=n(25593),J=n(95591),Y=n(5251),a=n(85893),vn=(0,i.forwardRef)(function(u,L){var h,O=(0,i.useState)(!1),E=c()(O,2),M=E[0],R=E[1];return(0,i.useImperativeHandle)(L,function(){return{}}),(0,a.jsx)(X.a,{submitter:!1,title:(0,Y.fi)(u.containerInfo.Name,"/")+" - \u6587\u4EF6\u7BA1\u7406",onOpenChange:function(m){R(m)},trigger:(0,a.jsx)(y.Z.Link,{children:(0,a.jsx)(J.Z,{})},"file"),children:M&&(0,a.jsx)(dn.Z,{md5:u.containerInfo.Id,initPath:(h=u.containerInfo.Config.WorkingDir)!==null&&h!==void 0?h:"/"})})}),k=vn,hn=n(43831),b=n(52209),En=(0,i.forwardRef)(function(u,L){(0,i.useImperativeHandle)(L,function(){return{}});var h=(0,i.useState)(!1),O=c()(h,2),E=O[0],M=O[1];return(0,a.jsx)(X.a,{submitter:!1,title:(0,Y.fi)(u.containerInfo.Name,"/")+" - \u7F51\u7EDC\u7BA1\u7406",onOpenChange:function(e){M(e)},open:E,trigger:(0,a.jsx)(y.Z.Link,{children:(0,a.jsx)(b.Z,{})},"file"),children:(0,a.jsx)(hn.Z,{ghost:!0,containerInfo:u.containerInfo})})}),t=En,I=n(81146),$=n(45742),H=n(62597),cn=(0,i.forwardRef)(function(u,L){(0,i.useImperativeHandle)(L,function(){return{show:function(f){return P()(l()().mark(function s(){var o;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,K.jV)({md5:f});case 2:o=r.sent,o.data&&g(o.data.info),M(!0);case 5:case"end":return r.stop()}},s)}))()}}});var h=(0,i.useState)(!1),O=c()(h,2),E=O[0],M=O[1],R=(0,i.useState)(),e=c()(R,2),m=e[0],g=e[1],T=(0,i.useRef)();return(0,a.jsxs)(a.Fragment,{children:[u.showTriggerButton&&(0,a.jsx)(y.Z.Link,{onClick:P()(l()().mark(function C(){return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:g(u.containerInfo),M(!0);case 2:case"end":return s.stop()}},C)})),children:(0,a.jsx)(Z.Z,{title:"\u8FD0\u884C\u65E5\u5FD7",children:(0,a.jsx)($.Z,{})})},"log"),(0,a.jsx)(G.Z,{title:"\u5BB9\u5668\u65E5\u5FD7",open:E,forceRender:!0,onClose:function(){M(!1)},afterOpenChange:function(f){if(f)setTimeout(function(){var o,v;(o=T.current)===null||o===void 0||o.start(),(v=T.current)===null||v===void 0||v.fit()},1e3);else{var s;(s=T.current)===null||s===void 0||s.close()}},width:800,children:m&&E&&(0,a.jsx)(I.Z,{ref:T,showInDrawer:!0,id:"container:log:".concat(m==null?void 0:m.Id),request:function(){var C=P()(l()().mark(function f(s){var o;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,H.Tb)({id:(o=m.Id)!==null&&o!==void 0?o:"",lineTotal:s.lineTotal,download:s.download,showTime:s.showTime});case 2:case"end":return r.stop()}},f)}));return function(f){return C.apply(this,arguments)}}(),download:function(){var C=P()(l()().mark(function f(s){var o,v,r,W;return l()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,(0,H.XH)({id:(o=m.Id)!==null&&o!==void 0?o:"",lineTotal:s.lineTotal,showTime:s.showTime});case 2:return r=A.sent,A.next=5,(0,K.jV)({md5:(v=m.Id)!==null&&v!==void 0?v:""});case 5:return W=A.sent,A.abrupt("return",{data:new Blob([r],{type:"text/plain"}),name:W.data.info.Name.replaceAll("/","")+"_"+new Date().toLocaleDateString()+".log"});case 7:case"end":return A.stop()}},f)}));return function(f){return C.apply(this,arguments)}}()})})]})}),p=cn,fn=n(65913),V=n(14245),S=n(1699),q=n(40666),j=n(64789),D=n(38345),d=n(42075),_=n(66309),w=n(29453),U=n(90127);function gn(u){var L=(0,i.useState)(0),h=c()(L,2),O=h[0],E=h[1],M=(0,i.useState)(),R=c()(M,2),e=R[0],m=R[1];return(0,i.useEffect)(function(){m([]),(0,w.pK)().then(function(g){m(g.data.list)})},[O,u.data.info.Name]),(0,a.jsx)(D.Z,{ghost:!0,title:(0,a.jsx)(q.Z,{}),subTitle:"\u5BB9\u5668\u6807\u7B7E",extra:(0,a.jsx)(U.Z,{trigger:(0,a.jsx)(y.Z.Link,{children:(0,a.jsx)(j.Z,{})}),containerDetail:u.data,onFinish:function(){E(O+1)}}),children:(0,a.jsx)(d.Z,{wrap:!0,children:e&&(e==null?void 0:e.filter(function(g){return g.container&&g.container.find(function(T){return T.containerName==u.data.info.Name})}).map(function(g,T){return(0,a.jsx)(_.Z,{color:g.tagColor,closable:!0,style:{height:35,display:"flex",borderRadius:20,justifyContent:"center",alignItems:"center"},onClose:P()(l()().mark(function C(){return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,w._2)({containerName:u.data.info.Name,tag:g.tag});case 2:E(O+1);case 3:case"end":return s.stop()}},C)})),children:(0,a.jsx)("span",{style:{paddingLeft:10,paddingRight:3},children:g.tag})},T)}))})})}var jn=(0,i.forwardRef)(function(u,L){var h;(0,i.useImperativeHandle)(L,function(){return{show:function(v){return P()(l()().mark(function r(){return l()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return f(!0),x.next=3,s(v);case 3:case"end":return x.stop()}},r)}))()}}});var O=(0,z.useAccess)(),E=(0,i.useRef)(),M=(0,i.useState)(),R=c()(M,2),e=R[0],m=R[1],g=(0,i.useState)(!1),T=c()(g,2),C=T[0],f=T[1],s=function(){var o=P()(l()().mark(function v(r){var W,x;return l()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return(W=E.current)===null||W===void 0||W.show(),Q.next=3,(0,K.jV)({md5:r}).finally(function(){var F;(F=E.current)===null||F===void 0||F.destroy()});case 3:x=Q.sent,x.data&&(x.data.info.HostConfig.NetworkMode=="host"&&x.data.info.Config.ExposedPorts&&Object.keys(x.data.info.Config.ExposedPorts).map(function(F){x.data.info.NetworkSettings.Ports[F]=[{HostIp:"0.0.0.0",HostPort:F.substring(0,F.indexOf("/"))}]}),m(x.data));case 5:case"end":return Q.stop()}},v)}));return function(r){return o.apply(this,arguments)}}();return(0,a.jsx)(G.Z,{title:"\u5FEB\u6377\u67E5\u770B\u5BB9\u5668 - ".concat((0,Y.fi)((h=e==null?void 0:e.info.Name)!==null&&h!==void 0?h:"","/")),open:C,onClose:function(){f(!1),u.onFinish&&u.onFinish()},width:800,extra:(0,a.jsxs)(S.u,{access:"canSeeContainerList",space:{split:(0,a.jsx)(on.Z,{type:"vertical"})},children:[(e==null?void 0:e.info)&&e.info.State.Running&&(0,a.jsx)(k,{containerInfo:e.info}),(e==null?void 0:e.info)&&O.canSeeContainerListManageOp&&(0,a.jsx)(t,{containerInfo:e.info}),(e==null?void 0:e.info)&&e.info.State.Running&&(0,a.jsx)(p,{containerInfo:e.info,showTriggerButton:!0}),(0,a.jsx)(S.u,{access:"canSeeContainerListManage",children:(0,a.jsx)(Z.Z,{title:"\u67E5\u770B\u5B8C\u6574\u4FE1\u606F",children:(0,a.jsx)(z.Link,{to:"/app/detail/edit/"+(e==null?void 0:e.info.Id),children:(0,a.jsx)(sn.Z,{})},"detail")})})]}),children:(0,a.jsx)(fn.Z,{ref:E,children:(0,a.jsxs)(B.Z,{vertical:!0,gap:20,children:[e&&(0,a.jsx)(S.u,{access:"canSeeContainerList",children:(0,a.jsx)(ln.Z,{ghost:!0,data:e==null?void 0:e.info,onFinish:P()(l()().mark(function o(){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s(e.info.Id);case 2:return r.t0=r.sent,r.abrupt("return",[r.t0]);case 4:case"end":return r.stop()}},o)}))})}),e&&(0,a.jsx)(S.u,{access:["canSeeContainerListManage","canSeeContainerListManageOp"],children:(0,a.jsx)(un.Z,{ghost:!0,data:e,checkContainerUpgrade:function(){f(!1),u.onUpgradeFinish&&u.onUpgradeFinish()}})}),e&&(0,a.jsx)(gn,{data:e}),e&&(0,a.jsx)(rn.Z,{data:e,ghost:!0}),(0,a.jsx)(N.Z,{data:e==null?void 0:e.info,ghost:!0}),e&&(0,a.jsx)(V.Z,{data:e.info,ghost:!0})]})})})}),Dn=jn},81146:function(mn,nn,n){var en=n(15009),c=n.n(en),an=n(99289),l=n.n(an),tn=n(97857),P=n.n(tn),i=n(67294),rn=n(97269),K=n(62370),z=n(5966),sn=n(97462),G=n(82346),on=n(71230),Z=n(15746),B=n(34041),N=n(28036),ln=n(84567),un=n(42075),dn=n(54964),X=n(80821),y=n(23430),J=n(93162),Y=n.n(J),a=n(12320),vn=n.n(a),k=n(78267),hn=n.n(k),b=n(75458),En=n.n(b),t=n(85893),I=new a.Terminal(P()(P()({},dn.a),{},{fontSize:12})),$=new k.FitAddon,H=new b.SearchAddon,cn=(0,i.forwardRef)(function(p,fn){(0,i.useImperativeHandle)(fn,function(){return{fit:function(){I.clear(),$.fit()},start:function(){return l()(c()().mark(function D(){return c()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,q({lineTotal:500});case 2:case"end":return _.stop()}},D)}))()},close:function(){S.progress.close(p.id)}}});var V=(0,i.useRef)(),S=(0,G.useModel)("subscriber");S.addDataHandler(p.id,function(j){I.write(j.data.replaceAll(`
`,`

`))});var q=function(){var j=l()(c()().mark(function D(d){return c()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return I.clear(),d.download=!1,w.next=4,p.request(d);case 4:case"end":return w.stop()}},D)}));return function(d){return j.apply(this,arguments)}}();return(0,i.useEffect)(function(){return window.addEventListener("resize",function(){$.fit()}),I.loadAddon($),I.open(document.getElementById("terminal-container-log")),$.fit(),function(){I.clear(),I.reset(),S.progress.close(p.id)}},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(rn.A,{submitter:!1,layout:"horizontal",onValuesChange:function(D,d){q({id:p.id,lineTotal:parseInt(d.lineTotal),showTime:d.showTime})},formRef:V,children:(0,t.jsxs)(on.Z,{gutter:[10,0],children:[(0,t.jsx)(Z.Z,{span:8,children:(0,t.jsx)(K.Z,{name:"lineTotal",initialValue:"500",label:"\u83B7\u53D6\u65E5\u5FD7\u6761\u6570",children:(0,t.jsxs)(B.Z,{defaultValue:"500",children:[(0,t.jsx)(B.Z.Option,{value:"100",children:"100\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(B.Z.Option,{value:"200",children:"200\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(B.Z.Option,{value:"500",children:"500\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(B.Z.Option,{value:"1000",children:"1000\u6761\u65E5\u5FD7\u6570\u636E"}),(0,t.jsx)(B.Z.Option,{value:"-1",children:"\u5168\u90E8\uFF08\u4E0B\u8F7D\u53EF\u89C1\uFF09"})]})})}),(0,t.jsx)(Z.Z,{children:(0,t.jsx)(N.ZP,{onClick:function(){I.clear()},children:"\u6E05\u5C4F"})}),(0,t.jsx)(Z.Z,{children:(0,t.jsx)(K.Z,{name:"showTime",valuePropName:"checked",children:(0,t.jsx)(ln.Z,{children:"\u663E\u793A\u65F6\u95F4"})})}),(0,t.jsx)(Z.Z,{children:(0,t.jsx)(z.Z,{label:"\u67E5\u627E",name:"keywork"})}),(0,t.jsx)(Z.Z,{children:(0,t.jsx)(sn.Z,{name:["keywork"],children:function(D){var d=D.keywork;return(0,t.jsxs)(un.Z,{size:10,children:[(0,t.jsx)(N.ZP,{onClick:function(){H.findNext(d)},children:"\u4E0B\u4E00\u4E2A"},"next"),(0,t.jsx)(N.ZP,{onClick:function(){H.findPrevious(d)},children:"\u4E0A\u4E00\u4E2A"},"prev")]})}})}),(0,t.jsx)(Z.Z,{children:(0,t.jsx)(X.Z,{icon:(0,t.jsx)(y.Z,{}),action:l()(c()().mark(function j(){var D,d,_;return c()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!p.download){U.next=5;break}return U.next=3,p.download({lineTotal:parseInt((D=V.current)===null||D===void 0?void 0:D.getFieldValue("lineTotal")),showTime:(d=V.current)===null||d===void 0?void 0:d.getFieldValue("showTime")});case 3:_=U.sent,(0,J.saveAs)(_.data,_.name);case 5:case"end":return U.stop()}},j)})),children:"\u4E0B\u8F7D\u65E5\u5FD7"})})]})}),(0,t.jsx)("div",{style:{marginTop:"20px",height:p.showInDrawer?"75vh":"580px"},id:"terminal-container-log"})]})});nn.Z=cn}}]);
