"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3917],{80821:function(L,y,e){e.d(y,{Z:function(){return D}});var R=e(5574),c=e.n(R),g=e(24963),m=e(86738),v=e(14726),_=e(83062),j=e(67294),f=e(85893);function D(a){var P=(0,j.useState)(!1),$=c()(P,2),O=$[0],S=$[1],C=(0,j.useContext)(g.Z),A=C.lang,Z=C.notice,l=C.message,s=function(){S(!0),a.action().then(function(r){if(S(!1),typeof a.onSuccess=="function"&&a.onSuccess(r),a.messageSuccess){var x="";typeof a.messageSuccess=="function"?x=a.messageSuccess(r):x=a.messageSuccess,x.indexOf(".")>-1&&(x=A(x)),a.asynced?l.info(x):l.success(x)}}).catch(function(r){S(!1),typeof a.onError=="function"&&a.onError(r)})};return a.confirm?(0,f.jsx)(m.Z,{style:{width:500},title:a.confirmTitle?a.confirmTitle:A("notification.title.tip"),description:a.confirm,onConfirm:s,okText:"Yes",cancelText:"No",children:(0,f.jsx)(v.ZP,{disabled:a.disabled,icon:a.icon,loading:O,danger:a.danger,type:a.type,children:a.children})}):(0,f.jsx)(_.Z,{title:a.tips,children:(0,f.jsx)(v.ZP,{disabled:a.disabled,icon:a.icon,loading:O,onClick:s,danger:a.danger,type:a.type,children:a.children})})}},24963:function(L,y,e){var R=e(67294),c=(0,R.createContext)({});y.Z=c},29337:function(L,y,e){e.r(y),e.d(y,{default:function(){return ne}});var R=e(15009),c=e.n(R),g=e(99289),m=e.n(g),v=e(5574),_=e.n(v),j=e(24963),f=e(15078),D=e(184),a=e(5966),P=e(97462),$=e(86615),O=e(62370),S=e(54006),C=e(14726),A=e(42075),Z=e(25593),l=e(66309),s=e(67294),n=e(85893),r=(0,s.forwardRef)(function(h,z){var W=(0,s.useState)(!1),b=_()(W,2),V=b[0],K=b[1],I=(0,s.useRef)(),w=(0,s.useContext)(j.Z),J=w.message,B=w.notice,p=(0,S.useSearchParams)(),i=_()(p,2),T=i[0],M=i[1];return(0,s.useImperativeHandle)(z,function(){return{edit:function(u){var t;(t=I.current)===null||t===void 0||t.setFieldsValue({title:u.title,name:u.name,type:u.setting.type,url:u.setting.url,id:u.id}),K(!0)}}}),(0,s.useEffect)(function(){T.get("op")=="create"&&K(!0)},[]),(0,n.jsxs)(D.a,{name:"create",title:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97",open:V,onOpenChange:function(u){K(u)},drawerProps:{forceRender:!0},formRef:I,trigger:(0,n.jsx)(C.ZP,{type:"primary",children:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97"}),onFinish:function(){var o=m()(c()().mark(function u(t){var d,F,U;return c()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,f.ks)({name:t.name,url:t.url,type:t.type});case 2:if(d=E.sent,!(d&&d.data)){E.next=12;break}return E.next=6,(0,f.$c)({id:t.id,name:t.name,title:t.title,type:t.type,url:t.url,apps:d.data.list});case 6:if(F=E.sent,!(F&&F.data)){E.next=12;break}return J.success("\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\u6210\u529F"),h.onFinish&&h.onFinish(),(U=I.current)===null||U===void 0||U.resetFields(),E.abrupt("return",!0);case 12:case"end":return E.stop()}},u)}));return function(u){return o.apply(this,arguments)}}(),children:[(0,n.jsx)(a.Z,{name:"id",hidden:!0}),(0,n.jsx)(a.Z,{label:"\u540D\u79F0",name:"title",required:!0,rules:[{required:!0}],placeholder:"\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u5E94\u7528\u5546\u5E97"}),(0,n.jsx)(P.Z,{name:["id"],children:function(u){var t=u.id;return(0,n.jsx)(a.Z,{label:"\u6807\u8BC6",name:"name",required:!0,disabled:!!t,rules:[{required:!0}],placeholder:"\u6307\u5B9A\u5546\u5E97\u6807\u8BC6\uFF0C\u7528\u4E8E\u521B\u5EFA\u5546\u5E97\u6587\u4EF6\u5B58\u50A8\u76EE\u5F55"})}}),(0,n.jsx)($.Z.Group,{name:"type",label:"\u5546\u5E97\u7C7B\u578B",valueEnum:{casaos:"casaos \u5E94\u7528\u5546\u5E97","1panel":"1panel \u5E94\u7528\u5546\u5E97"},fieldProps:{onChange:function(u){var t;(t=I.current)===null||t===void 0||t.resetFields(["url"])}}}),(0,n.jsx)(P.Z,{name:["type"],children:function(u){var t=u.type,d=[],F=[];if(t=="1panel"&&(F=["https://gitee.com/qyg2297248353/appstore-dpanel","https://github.com/1Panel-dev/appstore","https://github.com/okxlin/appstore"],d=[(0,n.jsx)(a.Z,{label:"\u4ED3\u5E93\u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B git \u4ED3\u5E93\u5730\u5740"},"gitUrl")]),t=="portainer"&&(d=[(0,n.jsx)(a.Z,{label:"template.json \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/Lissy93/portainer-templates/blob/main/templates.json"},"jsonUrl")]),t=="casaos"&&(F=["https://play.cuse.eu.org/Cp0204-AppStore-Play.zip"],d=[(0,n.jsx)(a.Z,{label:"zip \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B zip \u5730\u5740"},"zipUrl")]),t&&t!="")return[d,(0,n.jsx)(O.Z,{label:(0,n.jsxs)(A.Z,{children:["\u63A8\u8350\u5546\u5E97",(0,n.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/setting/store?id=%e6%94%af%e6%8c%81%e7%b1%bb%e5%9e%8b",target:"_blank",children:"\u4E09\u65B9\u5546\u5E97\u63A5\u5165\u8BF4\u660E"})]}),children:(0,n.jsx)(A.Z,{wrap:!0,children:F.map(function(U,H){return(0,n.jsx)(Z.Z.Link,{onClick:function(){var G;(G=I.current)===null||G===void 0||G.setFieldValue("url",U)},children:(0,n.jsx)(l.Z,{color:"cyan",children:U})},H)})})},"recommend")]}})]})}),x=r,N=e(80821),Y=e(67255),Q=e(43425),X=e(98165),k=e(90078),q=e(10641),ee=e(96074),te=e(83062);function ne(){var h=(0,s.useRef)(),z=(0,S.useAccess)(),W=(0,s.useRef)(),b=(0,S.useModel)("@@initialState"),V=b.initialState,K=b.loading,I=b.error,w=b.refresh,J=b.setInitialState;return(0,n.jsx)(k._z,{header:{extra:[z.canSeeFounder&&(0,n.jsx)(x,{ref:W,onFinish:function(){var p,i;!((p=h.current)===null||p===void 0)&&p.reloadAndRest&&((i=h.current)===null||i===void 0||i.reloadAndRest())}},"create")]},children:(0,n.jsx)(q.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,Y.O)(),columns:[{title:"\u6807\u8BC6",dataIndex:"name",width:200},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u5730\u5740",width:500,search:!1,render:function(p,i,T,M,o){return(0,n.jsx)("a",{href:i.setting.url,target:"_blank",children:(0,n.jsx)(l.Z,{children:i.setting.url})})}},{title:"\u6700\u540E\u66F4\u65B0",render:function(p,i,T,M,o){if(i.setting.updatedAt)return new Date(i.setting.updatedAt*1e3).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(p,i,T,M,o){return(0,n.jsxs)(A.Z,{split:(0,n.jsx)(ee.Z,{type:"vertical"}),children:[(0,n.jsx)(Z.Z.Link,{onClick:function(){var t;(t=W.current)===null||t===void 0||t.edit(i)},children:(0,n.jsx)(te.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(Q.Z,{})})},"manage"),(0,n.jsx)(N.Z,{type:"link",icon:(0,n.jsx)(X.Z,{}),action:function(){var t,d;return(0,f.ks)({id:i.id,name:i.name,url:(t=i.setting.url)!==null&&t!==void 0?t:"",type:(d=i.setting.type)!==null&&d!==void 0?d:""})},onSuccess:function(){var t,d;return!((t=h.current)===null||t===void 0)&&t.reloadAndRest&&((d=h.current)===null||d===void 0||d.reloadAndRest()),!0},onError:function(){var t,d;return!((t=h.current)===null||t===void 0)&&t.reset&&((d=h.current)===null||d===void 0||d.reset()),!0},messageSuccess:"\u66F4\u65B0\u6210\u529F",children:" "},"upgrade")]})}}],request:function(){var B=m()(c()().mark(function p(i,T,M){var o;return c()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,f.eO)({name:i.name,title:i.title});case 2:return o=t.sent,w(),t.abrupt("return",{data:o.data.list,success:!0,total:o.data.list.length});case 5:case"end":return t.stop()}},p)}));return function(p,i,T){return B.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:h,tableAlertOptionRender:function(p){var i=p.selectedRowKeys,T=p.selectedRows;return(0,n.jsx)(A.Z,{size:16,children:(0,n.jsx)(N.Z,{danger:!0,type:"primary",action:function(){return(0,f.Me)({id:T.map(function(o){return o.id})})},onSuccess:function(){var o,u;return!((o=h.current)===null||o===void 0)&&o.reloadAndRest&&((u=h.current)===null||u===void 0||u.reloadAndRest()),!0},onError:function(){var o,u;return!((o=h.current)===null||o===void 0)&&o.reset&&((u=h.current)===null||u===void 0||u.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"},"delete")})}})})}},15078:function(L,y,e){e.d(y,{$c:function(){return _},Me:function(){return S},eO:function(){return $},ks:function(){return f},yL:function(){return A}});var R=e(15009),c=e.n(R),g=e(99289),m=e.n(g),v=e(54006);function _(l){return j.apply(this,arguments)}function j(){return j=m()(c()().mark(function l(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,v.request)("/api/common/store/create",{method:"POST",data:s}));case 1:case"end":return r.stop()}},l)})),j.apply(this,arguments)}function f(l){return D.apply(this,arguments)}function D(){return D=m()(c()().mark(function l(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,v.request)("/api/common/store/sync",{method:"POST",data:s}));case 1:case"end":return r.stop()}},l)})),D.apply(this,arguments)}function a(l){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function l(s){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:s}));case 1:case"end":return r.stop()}},l)})),P.apply(this,arguments)}function $(l){return O.apply(this,arguments)}function O(){return O=m()(c()().mark(function l(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,v.request)("/api/common/store/get-list",{method:"POST",data:s}));case 1:case"end":return r.stop()}},l)})),O.apply(this,arguments)}function S(l){return C.apply(this,arguments)}function C(){return C=m()(c()().mark(function l(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,v.request)("/api/common/store/delete",{method:"POST",data:s});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},l)})),C.apply(this,arguments)}function A(l){return Z.apply(this,arguments)}function Z(){return Z=m()(c()().mark(function l(s){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,v.request)(s==null?void 0:s.path,{method:"GET"}));case 1:case"end":return r.stop()}},l)})),Z.apply(this,arguments)}},67255:function(L,y,e){e.d(y,{O:function(){return R},j:function(){return c}});function R(){var g,m=parseInt((g=localStorage.getItem("dpanel-pagesize"))!==null&&g!==void 0?g:"0");return{showSizeChanger:!0,defaultPageSize:m!=null?m:20}}function c(g){var m="dpanel-table-column-".concat(g),v={};if(localStorage.getItem(m)){var _;v=JSON.parse((_=localStorage.getItem(m))!==null&&_!==void 0?_:"{}")}return{defaultValue:v,onChange:function(f){localStorage.setItem("dpanel-table-column-".concat(g),JSON.stringify(f))}}}}}]);
