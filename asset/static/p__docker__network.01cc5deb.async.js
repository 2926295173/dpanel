"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[236],{80821:function(J,B,t){t.d(B,{Z:function(){return p}});var T=t(5574),c=t.n(T),A=t(93246),f=t(54006),x=t(31418),P=t(86738),O=t(14726),C=t(83062),$=t(67294),M=t(85893);function p(d){var D=(0,$.useState)(!1),F=c()(D,2),S=F[0],R=F[1],V=x.Z.useApp(),W=(0,f.useIntl)(),Z=function(){R(!0),d.action().then(function(I){if(R(!1),typeof d.onSuccess=="function"&&d.onSuccess(I),d.messageSuccess){var l="";typeof d.messageSuccess=="function"?l=d.messageSuccess(I):l=d.messageSuccess,l.indexOf(".")>-1&&(l=W.formatMessage({id:l})),d.asynced?(0,A.Rk)(V,l):(0,A.$h)(V,l)}}).catch(function(I){R(!1),typeof d.onError=="function"&&d.onError(I)})};return d.confirm?(0,M.jsx)(P.Z,{style:{width:500},title:"\u63D0\u793A",description:d.confirm,onConfirm:Z,okText:"Yes",cancelText:"No",children:(0,M.jsx)(O.ZP,{disabled:d.disabled,icon:d.icon,loading:S,danger:d.danger,type:d.type,children:d.children})}):(0,M.jsx)(C.Z,{title:d.tips,children:(0,M.jsx)(O.ZP,{disabled:d.disabled,icon:d.icon,loading:S,onClick:Z,danger:d.danger,type:d.type,children:d.children})})}},51672:function(J,B,t){t.r(B),t.d(B,{default:function(){return ce}});var T=t(15009),c=t.n(T),A=t(99289),f=t.n(A),x=t(5574),P=t.n(x),O=t(80821),C=t(14946),$=t(93246),M=t(184),p=t(5966),d=t(62370),D=t(97462),F=t(52688),S=t(24739),R=t(17186),V=t(31418),W=t(14726),Z=t(34041),K=t(71230),I=t(15746),l=t(67294),e=t(85893),j=(0,l.forwardRef)(function(g,X){var k=(0,l.useState)(!1),_=P()(k,2),z=_[0],Q=_[1],Y=V.Z.useApp(),n=(0,l.useRef)();return(0,l.useImperativeHandle)(X,function(){return{}}),(0,e.jsxs)(M.a,{name:"create",title:"\u521B\u5EFA\u7F51\u7EDC",open:z,onOpenChange:function(b){Q(b)},formRef:n,trigger:(0,e.jsx)(W.ZP,{type:"primary",children:"\u521B\u5EFA\u7F51\u7EDC"}),onFinish:function(){var N=f()(c()().mark(function b(i){var E,U,o,h,r,m,s,u,w,y,H,q;return c()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return i.driver=="macvlan"&&(i.driverOptionName||(i.driverOptionName=[],i.driverOptionValue=[]),i.driverOptionName.push("parent"),i.driverOptionValue.push(i.macvlanParentCard)),L.next=3,(0,C.XY)({name:i.name,driver:(E=i.driver)!==null&&E!==void 0?E:"bridge",ipSubnet:(U=i.ipSubnet)!==null&&U!==void 0?U:"",ipGateway:(o=i.ipGateway)!==null&&o!==void 0?o:"",ipRange:(h=i.ipRange)!==null&&h!==void 0?h:"",ipAux:i.ipAux,enableIpV6:(r=i.enableIpV6)!==null&&r!==void 0?r:!1,ipV6Subnet:(m=i.ipV6Subnet)!==null&&m!==void 0?m:"",ipV6Gateway:(s=i.ipV6Gateway)!==null&&s!==void 0?s:"",ipV6Range:(u=i.ipV6Range)!==null&&u!==void 0?u:"",ipV6Aux:i.ipV6Aux,driverOption:i.driverOption,internal:(w=i.internal)!==null&&w!==void 0?w:!1,attachable:(y=i.attachable)!==null&&y!==void 0?y:!1});case 3:if(H=L.sent,!(H&&H.data&&H.data.id!="")){L.next=9;break}return(0,$.$h)(Y,"\u521B\u5EFA\u7F51\u7EDC\u6210\u529F"),g.onFinish&&g.onFinish(),(q=n.current)===null||q===void 0||q.resetFields(),L.abrupt("return",!0);case 9:case"end":return L.stop()}},b)}));return function(b){return N.apply(this,arguments)}}(),children:[(0,e.jsx)(p.Z,{label:"\u540D\u79F0",tooltip:"\u4E0D\u914D\u7F6E\u5B50\u7F51\u65F6\uFF0C\u4F1A\u81EA\u52A8\u751F\u6210",name:"name",required:!0,rules:[{required:!0}],placeholder:"\u6307\u5B9A\u552F\u4E00\u7684\u7F51\u7EDC\u540D\u79F0"}),(0,e.jsx)(d.Z,{label:"\u7C7B\u578B",name:"driver",children:(0,e.jsxs)(Z.Z,{defaultValue:"bridge",children:[(0,e.jsx)(Z.Z.Option,{value:"bridge",children:"bridge"}),(0,e.jsx)(Z.Z.Option,{value:"ipvlan",children:"ipvlan"}),(0,e.jsx)(Z.Z.Option,{value:"macvlan",children:"macvlan"}),(0,e.jsx)(Z.Z.Option,{value:"overlay",children:"overlay"})]})}),(0,e.jsx)(D.Z,{name:["driver"],children:function(b){var i=b.driver;if(i=="macvlan")return(0,e.jsx)(p.Z,{label:"\u7236\u7F51\u5361",name:"macvlanParentCard"})}}),(0,e.jsxs)(K.Z,{children:[(0,e.jsx)(I.Z,{span:8,children:(0,e.jsx)(F.Z,{label:"\u81EA\u5B9AIPV4\u5B50\u7F51",name:"userIpV4Subnet"})}),(0,e.jsx)(I.Z,{span:8,children:(0,e.jsx)(F.Z,{name:"internal",label:"\u9694\u79BB\u5916\u90E8\u8BBF\u95EE",initialValue:!1})}),(0,e.jsx)(I.Z,{span:8,children:(0,e.jsx)(F.Z,{name:"attachable",label:"\u5141\u8BB8\u624B\u52A8\u9644\u52A0\u5BB9\u5668",initialValue:!1})})]}),(0,e.jsx)(D.Z,{name:["userIpV4Subnet"],children:function(b){var i=b.userIpV4Subnet;if(i)return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(S.UW,{title:"IPV4\u914D\u7F6E",children:[(0,e.jsx)(p.Z,{label:"\u5B50\u7F51",name:"ipSubnet",width:"md",placeholder:"\u4F8B\u5982: 172.20.0.0/16"}),(0,e.jsx)(p.Z,{label:"\u7F51\u5173",name:"ipGateway",width:"md",placeholder:"\u4F8B\u5982: 172.20.10.11"}),(0,e.jsx)(p.Z,{label:"Ip\u8303\u56F4",name:"ipRange",width:"md",placeholder:"\u4F8B\u5982: 172.20.10.128/25"})]}),(0,e.jsx)(R.u,{name:"ipAux",label:"\u6392\u9664Ip",children:(0,e.jsxs)(S.UW,{children:[(0,e.jsx)(p.Z,{label:"\u8BBE\u5907\u540D\u79F0",name:"ipAuxDevice",width:"md"}),(0,e.jsx)(p.Z,{label:"Ip\u5730\u5740",name:"ipAuxAddress",width:"md"})]})})]})}}),(0,e.jsxs)(K.Z,{children:[(0,e.jsx)(I.Z,{span:8,children:(0,e.jsx)(F.Z,{label:"\u542F\u7528IPV6",name:"enableIpV6"})}),(0,e.jsx)(I.Z,{children:(0,e.jsx)(F.Z,{label:"\u81EA\u5B9AIPV6\u5B50\u7F51",name:"userIpV6Subnet",fieldProps:{onChange:function(b,i){if(b){var E;(E=n.current)===null||E===void 0||E.setFieldValue("enableIpV6",!0)}}}})})]}),(0,e.jsx)(D.Z,{name:["userIpV6Subnet"],children:function(b){var i=b.userIpV6Subnet;if(i)return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(S.UW,{title:"IPV6\u914D\u7F6E",children:[(0,e.jsx)(p.Z,{label:"\u5B50\u7F51",name:"ipV6Subnet",width:"md",placeholder:"\u4F8B\u5982: 2001:db8::/48"}),(0,e.jsx)(p.Z,{label:"\u7F51\u5173",name:"ipV6Gateway",width:"md",placeholder:"\u4F8B\u5982: 2001:db8::1"}),(0,e.jsx)(p.Z,{label:"Ip\u8303\u56F4",name:"ipV6Range",width:"md",placeholder:"\u4F8B\u5982: 2001:db8::/64"})]}),(0,e.jsx)(R.u,{name:"ipV6Aux",label:"\u6392\u9664Ip",children:(0,e.jsxs)(S.UW,{children:[(0,e.jsx)(p.Z,{label:"\u8BBE\u5907\u540D\u79F0",name:"ipAuxDevice",width:"md"}),(0,e.jsx)(p.Z,{label:"Ip\u5730\u5740",name:"ipAuxAddress",width:"md"})]})})]})}}),(0,e.jsx)(R.u,{name:"driverOption",label:"\u81EA\u5B9A\u4E49\u9A71\u52A8\u914D\u7F6E",children:(0,e.jsxs)(S.UW,{children:[(0,e.jsx)(p.Z,{label:"\u540D\u79F0",name:"driverOptionName",width:"md"}),(0,e.jsx)(p.Z,{label:"\u503C",name:"driverOptionValue",width:"md"})]})})]})}),a=j,te=t(67255),re=t(43425),ae=t(48689),le=t(6110),ue=t(10641),ee=t(38345),ie=t(66309),G=t(42075),ne=t(96074),se=t(83062),v=t(26412),de=t(63490),oe=t(39711);function ce(){var g=(0,l.useRef)(),X=(0,l.useState)(""),k=P()(X,2),_=k[0],z=k[1],Q=(0,l.useState)(),Y=P()(Q,2),n=Y[0],N=Y[1],b=(0,l.useState)(),i=P()(b,2),E=i[0],U=i[1];return(0,e.jsxs)(le._z,{header:{extra:[(0,e.jsx)(a,{onFinish:function(){var h,r;!((h=g.current)===null||h===void 0)&&h.reloadAndRest&&((r=g.current)===null||r===void 0||r.reloadAndRest())}},"create")]},children:[(0,e.jsx)(ue.Z,{scroll:{x:"max-content"},rowKey:"Name",columns:[{title:"\u540D\u79F0",ellipsis:!0,dataIndex:"Name",render:function(h,r,m,s,u){return r.Name=="none"||r.Name=="bridge"||r.Name=="host"?(0,e.jsxs)(e.Fragment,{children:[r.Name," ",(0,e.jsx)(ie.Z,{color:"blue",children:"System"})]}):(0,e.jsx)(e.Fragment,{children:h})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,dataIndex:"Driver",search:!1},{title:"IPAM Driver",ellipsis:!0,width:120,search:!1,dataIndex:["IPAM","Driver"]},{title:"IPV4",ellipsis:!0,width:150,search:!1,render:function(h,r,m,s,u){return r.IPAM.Config&&r.IPAM.Config[0]?(0,e.jsxs)(G.Z,{direction:"vertical",children:[(0,e.jsx)("div",{children:r.IPAM.Config&&r.IPAM.Config[0].Subnet}),(0,e.jsx)("div",{children:r.IPAM.Config&&r.IPAM.Config[0].Gateway})]}):"-"}},{title:"IPV6",ellipsis:!0,width:150,search:!1,render:function(h,r,m,s,u){return r.IPAM.Config&&r.IPAM.Config[1]?(0,e.jsxs)(G.Z,{direction:"vertical",children:[(0,e.jsx)("div",{children:r.IPAM.Config&&r.IPAM.Config[1].Subnet}),(0,e.jsx)("div",{children:r.IPAM.Config&&r.IPAM.Config[1].Gateway})]}):"-"}},{title:"\u521B\u5EFA\u65F6\u95F4",ellipsis:!0,width:180,search:!1,dataIndex:"Created",render:function(h,r,m,s,u){return new Date(r.Created).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(h,r,m,s,u){return(0,e.jsx)(G.Z,{split:(0,e.jsx)(ne.Z,{type:"vertical"}),children:(0,e.jsx)(W.ZP,{type:"link",onClick:function(){z(r.Name)},children:(0,e.jsx)(se.Z,{title:"\u7BA1\u7406",children:(0,e.jsx)(re.Z,{})})})})}}],request:function(){var o=f()(c()().mark(function h(r,m,s){var u;return c()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,(0,C.jR)({name:r.Name});case 2:return u=y.sent,y.abrupt("return",{data:u.data.list,success:!0,total:u.data.list.length});case 4:case"end":return y.stop()}},h)}));return function(h,r,m){return o.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:g,tableAlertOptionRender:function(h){var r=h.selectedRowKeys;return(0,e.jsxs)(G.Z,{size:16,children:[(0,e.jsx)(O.Z,{danger:!0,type:"primary",action:function(){return(0,C._x)({name:r})},onSuccess:function(){var s,u;return!((s=g.current)===null||s===void 0)&&s.reloadAndRest&&((u=g.current)===null||u===void 0||u.reloadAndRest()),!0},onError:function(){var s,u;return!((s=g.current)===null||s===void 0)&&s.reset&&((u=g.current)===null||u===void 0||u.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"},"delete"),(0,e.jsx)(O.Z,{action:function(){return(0,C.CI)()},onSuccess:function(){var s,u;return!((s=g.current)===null||s===void 0)&&s.reloadAndRest&&((u=g.current)===null||u===void 0||u.reloadAndRest()),!0},onError:function(){var s,u;return!((s=g.current)===null||s===void 0)&&s.reset&&((u=g.current)===null||u===void 0||u.reset()),!0},messageSuccess:"\u6E05\u9664\u6210\u529F",confirm:"\u662F\u5426\u6E05\u7406\u672A\u4F7F\u7528\u7684\u7F51\u7EDC\uFF1F",children:"\u6E05\u7406\u672A\u4F7F\u7528\u7F51\u7EDC"},"clearNotUse")]})},pagination:(0,te.O)()}),(0,e.jsxs)(M.a,{title:"\u7F51\u7EDC\u8BE6\u60C5",open:_!="",onOpenChange:function(h){h?_&&(0,C.IS)({name:_}).then(function(r){if(r.data.info.Containers){var m=[];Object.keys(r.data.info.Containers).map(function(s){r.data.info.Containers[s].Id=s,m.push(r.data.info.Containers[s])}),U(m)}else U([]);N(r.data.info)}):z("")},submitter:!1,children:[(0,e.jsx)(ee.Z,{ghost:!0,children:(0,e.jsxs)(v.Z,{labelStyle:{width:"180px"},column:1,bordered:!0,children:[(0,e.jsx)(v.Z.Item,{label:"\u540D\u79F0",children:n==null?void 0:n.Name}),(0,e.jsx)(v.Z.Item,{label:"Id",children:n==null?void 0:n.Id}),(0,e.jsx)(v.Z.Item,{label:"Driver",children:n==null?void 0:n.Driver}),(0,e.jsx)(v.Z.Item,{label:"Scope",children:n==null?void 0:n.Scope}),(0,e.jsx)(v.Z.Item,{label:"Attachable",children:n!=null&&n.Attachable?"\u662F":"\u5426"}),(0,e.jsx)(v.Z.Item,{label:"Internal",children:n!=null&&n.Internal?"\u662F":"\u5426"}),(n==null?void 0:n.IPAM.Config)&&(n==null?void 0:n.IPAM.Config[0])&&(0,e.jsx)(v.Z.Item,{label:"IPV4",children:(0,e.jsxs)(v.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:[(0,e.jsx)(v.Z.Item,{label:"Subnet",children:n==null?void 0:n.IPAM.Config[0].Subnet}),(0,e.jsx)(v.Z.Item,{label:"Gateway",children:n==null?void 0:n.IPAM.Config[0].Gateway}),(0,e.jsx)(v.Z.Item,{label:"IP Range ",children:n==null?void 0:n.IPAM.Config[0].IPRange}),(0,e.jsx)(v.Z.Item,{label:"Excluded IPs",children:(n==null?void 0:n.IPAM.Config[0].AuxiliaryAddresses)&&Object.keys(n==null?void 0:n.IPAM.Config[0].AuxiliaryAddresses).map(function(o){return(n==null?void 0:n.IPAM.Config[0].AuxiliaryAddresses[o])+" ,"})})]})}),(n==null?void 0:n.IPAM.Config)&&(n==null?void 0:n.IPAM.Config[1])&&(0,e.jsx)(v.Z.Item,{label:"IPV6",children:(0,e.jsxs)(v.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:[(0,e.jsx)(v.Z.Item,{label:"Subnet",children:n==null?void 0:n.IPAM.Config[1].Subnet}),(0,e.jsx)(v.Z.Item,{label:"Gateway",children:n==null?void 0:n.IPAM.Config[1].Gateway}),(0,e.jsx)(v.Z.Item,{label:"IP Range ",children:n==null?void 0:n.IPAM.Config[1].IPRange}),(0,e.jsx)(v.Z.Item,{label:"Excluded IPs",children:(n==null?void 0:n.IPAM.Config[1].AuxiliaryAddresses)&&Object.keys(n==null?void 0:n.IPAM.Config[1].AuxiliaryAddresses).map(function(o){return(n==null?void 0:n.IPAM.Config[1].AuxiliaryAddresses[o])+" ,"})})]})}),(n==null?void 0:n.Options)&&Object.keys(n==null?void 0:n.Options).length>0&&(0,e.jsx)(v.Z.Item,{label:"Options",children:(0,e.jsx)(v.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:Object.keys(n==null?void 0:n.Options).map(function(o){return(0,e.jsx)(v.Z.Item,{label:o,children:n.Options[o]},o)})})}),(n==null?void 0:n.Labels)&&Object.keys(n==null?void 0:n.Labels).length>0&&(0,e.jsx)(v.Z.Item,{label:"Lables",children:(0,e.jsx)(v.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:Object.keys(n==null?void 0:n.Labels).map(function(o){return(0,e.jsx)(v.Z.Item,{label:o,children:n.Labels[o]},o)})})})]})}),(0,e.jsx)(ee.Z,{title:"\u7F51\u7EDC\u5185\u5BB9\u5668",ghost:!0,children:(0,e.jsx)(de.Z,{rowKey:"Id",columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"Name",render:function(h,r,m){return(0,e.jsx)(oe.rU,{target:"_blank",to:"/app/detail/edit/".concat(r.Id),children:r.Name})}},{title:"IPV4",dataIndex:"IPv4Address"},{title:"IPV6",dataIndex:"IPv6Address"},{title:"MacAddress",dataIndex:"MacAddress"},{title:"\u64CD\u4F5C",render:function(h,r,m){return(0,e.jsx)(G.Z,{split:(0,e.jsx)(ne.Z,{type:"vertical"}),children:(0,e.jsx)(O.Z,{type:"text",action:function(){var u,w;return(0,C.t9)({name:(u=n==null?void 0:n.Id)!==null&&u!==void 0?u:"",containerName:(w=r.Id)!==null&&w!==void 0?w:""})},messageSuccess:"\u5BB9\u5668\u6210\u529F\u9000\u51FA\u8BE5\u7F51\u7EDC",onSuccess:function(){var u=E==null?void 0:E.filter(function(w){return w.Id!=r.Id});U(u)},children:(0,e.jsx)(ae.Z,{})},"delete")})}}],dataSource:E,pagination:!1})})]})]})}},14946:function(J,B,t){t.d(B,{CI:function(){return M},HY:function(){return W},IS:function(){return P},XY:function(){return F},_3:function(){return K},_x:function(){return d},jR:function(){return C},t9:function(){return R}});var T=t(15009),c=t.n(T),A=t(99289),f=t.n(A),x=t(54006);function P(l){return O.apply(this,arguments)}function O(){return O=f()(c()().mark(function l(e){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,x.request)("/api/app/network/get-detail",{method:"POST",data:e}));case 1:case"end":return a.stop()}},l)})),O.apply(this,arguments)}function C(l){return $.apply(this,arguments)}function $(){return $=f()(c()().mark(function l(e){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,x.request)("/api/app/network/get-list",{method:"POST",data:e}));case 1:case"end":return a.stop()}},l)})),$.apply(this,arguments)}function M(){return p.apply(this,arguments)}function p(){return p=f()(c()().mark(function l(){return c()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,x.request)("/api/app/network/prune",{method:"POST"});case 2:return j.abrupt("return",j.sent);case 3:case"end":return j.stop()}},l)})),p.apply(this,arguments)}function d(l){return D.apply(this,arguments)}function D(){return D=f()(c()().mark(function l(e){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,x.request)("/api/app/network/delete",{method:"POST",data:e});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},l)})),D.apply(this,arguments)}function F(l){return S.apply(this,arguments)}function S(){return S=f()(c()().mark(function l(e){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,x.request)("/api/app/network/create",{method:"POST",data:e});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},l)})),S.apply(this,arguments)}function R(l){return V.apply(this,arguments)}function V(){return V=f()(c()().mark(function l(e){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,x.request)("/api/app/network/disconnect",{method:"POST",data:e});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},l)})),V.apply(this,arguments)}function W(l){return Z.apply(this,arguments)}function Z(){return Z=f()(c()().mark(function l(e){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,x.request)("/api/app/network/connect",{method:"POST",data:e});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},l)})),Z.apply(this,arguments)}function K(l){return I.apply(this,arguments)}function I(){return I=f()(c()().mark(function l(e){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,x.request)("/api/app/network/get-container-list",{method:"POST",data:e}));case 1:case"end":return a.stop()}},l)})),I.apply(this,arguments)}},67255:function(J,B,t){t.d(B,{O:function(){return T},j:function(){return c}});function T(){var A,f=parseInt((A=localStorage.getItem("dpanel-pagesize"))!==null&&A!==void 0?A:"0");return{showSizeChanger:!0,defaultPageSize:f!=null?f:20}}function c(A){var f="dpanel-table-column-".concat(A),x={};if(localStorage.getItem(f)){var P;x=JSON.parse((P=localStorage.getItem(f))!==null&&P!==void 0?P:"{}")}return{defaultValue:x,onChange:function(C){localStorage.setItem("dpanel-table-column-".concat(A),JSON.stringify(C))}}}}}]);
