"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3917],{1699:function(J,S,e){e.d(S,{u:function(){return E}});var F=e(9783),d=e.n(F),U=e(97857),m=e.n(U),K=e(67294),C=e(82346),I=e(40411),M=e(42075),i=e(85893),E=function(n){var W=(0,C.useAccess)(),P=Array.isArray(n.access)?n.access:[n.access],_,p=n.fallback;if(typeof n.children=="function"?(_=n.children(P.reduce(function(s,u){return m()(m()({},s),{},d()({},u,W[u]))},{})),_||(_=p)):P.every(function(s){return W[s]})?_=n.children:_=p,!p&&_&&n.showProTips&&W.canSeeEnableCe){if(W.canSeeEnableHiddenProTips)return null;_=(0,i.jsx)(I.Z,{offset:n.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:_})}if(!p&&_&&n.showProRibbonTips&&W.canSeeEnableCe){if(W.canSeeEnableHiddenProTips)return null;_=(0,i.jsx)(I.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:_})}return n.space?(0,i.jsx)(M.Z,m()(m()({},n.space),{},{children:_})):_}},80821:function(J,S,e){e.d(S,{Z:function(){return A}});var F=e(97857),d=e.n(F),U=e(5574),m=e.n(U),K=e(24963),C=e(86738),I=e(83062),M=e(28036),i=e(67294),E=e(85893);function A(n){var W=(0,i.useState)(!1),P=m()(W,2),_=P[0],p=P[1],s=(0,i.useContext)(K.Z),u=s.lang,O=s.message,B=function(){p(!0);var T=n.action();T instanceof Promise?T.then(function(r){if(p(!1),r){typeof n.onSuccess=="function"&&n.onSuccess(r);var H="";n.messageSuccess?typeof n.messageSuccess=="function"?H=n.messageSuccess(r):H=n.messageSuccess.indexOf("notification.")==0?u(n.messageSuccess):n.messageSuccess:H=u("notification.finish"),n.asynced?O.info(H):O.success(H)}}).catch(function(r){p(!1),typeof n.onError=="function"&&n.onError(r)}):p(!1)};return n.confirm?(0,E.jsx)(C.Z,d()(d()({style:{width:500},title:n.confirmTitle?n.confirmTitle:u("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?u(n.confirm):n.confirm,onConfirm:B,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,E.jsx)(I.Z,{title:n.tips,children:(0,E.jsx)(M.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&_?void 0:n.icon,loading:_,danger:n.danger,type:n.type,children:n.children})})})):(0,E.jsx)(I.Z,{title:n.tips,children:(0,E.jsx)(M.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&_?void 0:n.icon,loading:_,onClick:B,danger:n.danger,type:n.type,children:n.children})})}},44349:function(J,S,e){var F=e(97857),d=e.n(F),U=e(17186),m=e(5966),K=e(86250),C=e(67294),I=e(85893),M=(0,C.forwardRef)(function(i,E){var A=(0,C.useRef)();(0,C.useImperativeHandle)(E,function(){return{addItem:function(P,_){var p,s=(p=A.current)===null||p===void 0?void 0:p.getList(),u=!1;if(s==null||s.map(function(B){if(B.name==P){u=!0;return}}),!u){var O;(O=A.current)===null||O===void 0||O.add({name:P,value:_})}},clear:function(){var P;(P=A.current)===null||P===void 0||(P=P.getList())===null||P===void 0||P.map(function(_,p){var s;(s=A.current)===null||s===void 0||s.remove(p)})}}});var n={};return i.hideCopyButton===!0&&(n.copyIconProps=!1),i.hideDeleteButton===!0&&(n.deleteIconProps=!1),(0,I.jsx)(U.u,d()(d()({initialValue:i.initialValue,label:i.label,name:i.name,actionRef:A,creatorButtonProps:i.showAddButton?{creatorButtonText:i.label?i.label:i.name}:!1,min:i.min?i.min:0},n),{},{children:function(P,_,p){return(0,I.jsx)(K.Z,{justify:i.justify,gap:i.gap,children:i.items.map(function(s){return s.render?(0,I.jsx)("div",{children:s.render&&s.render(P,_,p)},"".concat(i.name,"-").concat(s.name,"-").concat(P.key)):(0,I.jsx)(m.Z,{width:s.width,name:s.name,label:s.label,required:s.required,rules:[{required:s.required}],disabled:s.disabled,placeholder:s.placeholder},"".concat(i.name,"-").concat(s.name,"-").concat(P.key))})})}}))});S.Z=M},36435:function(J,S,e){var F=e(15009),d=e.n(F),U=e(64599),m=e.n(U),K=e(99289),C=e.n(K),I=e(9783),M=e.n(I),i=e(5574),E=e.n(i),A=e(67294),n=e(184),W=e(38345),P=e(97269),_=e(97321),p=e(97462),s=e(64317),u=e(5966),O=e(86615),B=e(68602),l=e(28036),T=e(83403),r=e(24963),H=e(1699),ne=e(29177),q=e(45742),te=e(43425),re=e(44349),ae=e(3616),Q=e(36146),x=e(85893),se=(0,A.forwardRef)(function(V,ue){var le=(0,A.useState)(!1),ee=E()(le,2),w=ee[0],X=ee[1],j=(0,A.useRef)(),k=(0,A.useContext)(r.Z),Y=k.message,z=(0,A.useState)([]),$=E()(z,2),f=$[0],G=$[1],R=new Q.Uo("components.permissionButton"),g=M()(M()(M()(M()(M()({},T.W6.CONTAINER,"Id"),T.W6.APPSTORE,"name"),T.W6.COMPOSE,"name"),T.W6.REGISTRY,"serverAddress"),T.W6.DOCKER_ENV,"name"),L=M()(M()(M()(M()(M()({},T.W6.CONTAINER,"name"),T.W6.APPSTORE,"name"),T.W6.COMPOSE,"name"),T.W6.REGISTRY,"title"),T.W6.DOCKER_ENV,"title"),h=g[V.type],N=L[V.type],de=V.selected.map(function(o){return o[g[V.type]]});return A.useEffect(function(){if(w){if(!V.selected||V.selected.length==0){Y.error(Q.FD.format("message.noDataSelect")),X(!1);return}(0,B.dP)({permission:{uri:V.type,key:h,value:de}}).then(function(o){var c;(c=j.current)===null||c===void 0||c.setFieldValue("list",Object.keys(o.data.list).map(function(a){return{name:a,type:o.data.list[a].type,users:o.data.list[a].users}}))}),(0,B.lE)().then(function(o){var c,a=(c=o.data)===null||c===void 0||(c=c.list)===null||c===void 0?void 0:c.map(function(t){return{label:t.username,value:t.username}});G(a)})}},[w]),(0,x.jsx)(H.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,x.jsxs)(n.a,{name:"create",title:R.format("drawerTitle"),open:w,onOpenChange:function(c){if(!c){var a;(a=j.current)===null||a===void 0||a.resetFields()}X(c)},drawerProps:{forceRender:!0,width:ae.R_},formRef:j,trigger:(0,x.jsx)(l.ZP,{icon:(0,x.jsx)(ne.Z,{}),children:R.format("drawerTriggerButton")}),onFinish:function(){var o=C()(d()().mark(function c(a){var t,D,v;return d()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:t=m()(a.list),b.prev=1,t.s();case 3:if((D=t.n()).done){b.next=9;break}return v=D.value,b.next=7,(0,B.Db)({usernames:v.users,permissionType:v.type,permission:{uri:V.type,key:h,showKey:N,value:[v.name]}});case 7:b.next=3;break;case 9:b.next=14;break;case 11:b.prev=11,b.t0=b.catch(1),t.e(b.t0);case 14:return b.prev=14,t.f(),b.finish(14);case 17:Y.success(Q.FD.format("finish")),X(!1),V.onSuccess();case 20:case"end":return b.stop()}},c,null,[[1,11,14,17]])}));return function(c){return o.apply(this,arguments)}}(),children:[(0,x.jsxs)(W.Z,{ghost:!0,title:(0,x.jsx)(q.Z,{}),subTitle:R.format("batchTitle"),children:[(0,x.jsx)(P.A.Item,{name:"type",style:{marginBottom:0},children:(0,x.jsx)(_.Z.Group,{defaultValue:"admin",onChange:function(c){var a,t,D=(a=j.current)===null||a===void 0?void 0:a.getFieldValue("list");D.forEach(function(v){v.type=c,v.users=[]}),(t=j.current)===null||t===void 0||t.setFieldValue("list",D)},children:["admin","restricted","public"].map(function(o){return(0,x.jsx)(_.Z,{style:{width:240},title:R.format("dataTypeOption.".concat(o)),description:R.format("dataTypeOptionDesc.".concat(o)),value:o},o)})})}),(0,x.jsx)(p.Z,{name:["type"],children:function(c){var a=c.type;if(a==="restricted")return(0,x.jsx)(s.Z,{mode:"multiple",name:"usernames",label:R.format("formUsernames"),onChange:function(D){var v,Z,b=(v=j.current)===null||v===void 0?void 0:v.getFieldValue("list");b.forEach(function(y){y.users=D}),(Z=j.current)===null||Z===void 0||Z.setFieldValue("list",b)},rules:[{required:!0}],request:C()(d()().mark(function t(){var D,v,Z;return d()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(f.length>0)){y.next=2;break}return y.abrupt("return",f);case 2:return y.next=4,(0,B.lE)();case 4:return v=y.sent,Z=(D=v.data)===null||D===void 0||(D=D.list)===null||D===void 0?void 0:D.map(function(oe){return{label:oe.username,value:oe.username}}),G(Z),y.abrupt("return",Z);case 8:case"end":return y.stop()}},t)}))})}})]}),(0,x.jsx)(W.Z,{ghost:!0,title:(0,x.jsx)(te.Z,{}),subTitle:R.format("dataTitle"),children:(0,x.jsx)(re.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:R.format("dataName"),render:function(c,a,t){var D=t.getCurrentRowData();return(0,x.jsx)(u.Z,{disabled:!0,label:R.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:R.format("dataType"),render:function(c,a,t){var D=t.getCurrentRowData();return(0,x.jsx)(O.Z.Group,{label:R.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(v){return{label:R.format("dataTypeOption.".concat(v)),value:v}})})}},{name:"users",label:R.format("dataUsers"),render:function(c,a,t){return(0,x.jsx)(p.Z,{name:["type"],children:function(v){var Z=v.type;if(Z=="restricted")return(0,x.jsx)(s.Z,{width:"sm",mode:"tags",name:"users",label:R.format("dataUsers"),options:f})}})}}]})})]})})});S.Z=se},3616:function(J,S,e){e.d(S,{Ed:function(){return m},FK:function(){return d},R_:function(){return F},ob:function(){return U}});var F=window.innerWidth<=1024?"90vw":"65vw",d="90vw",U="60vw",m="50vh"},24963:function(J,S,e){var F=e(67294),d=(0,F.createContext)({});S.Z=d},29337:function(J,S,e){e.r(S),e.d(S,{default:function(){return X}});var F=e(15009),d=e.n(F),U=e(99289),m=e.n(U),K=e(5574),C=e.n(K),I=e(3616),M=e(24963),i=e(15078),E=e(36146),A=e(184),n=e(5966),W=e(97462),P=e(86615),_=e(62370),p=e(82346),s=e(28036),u=e(42075),O=e(25593),B=e(66309),l=e(40056),T=e(67294),r=e(85893),H=(0,T.forwardRef)(function(j,k){var Y=(0,T.useState)(!1),z=C()(Y,2),$=z[0],f=z[1],G=(0,T.useRef)(),R=(0,T.useContext)(M.Z),g=R.message,L=(0,p.useSearchParams)(),h=C()(L,2),N=h[0],de=h[1],o=new E.Uo("components.appstore");return(0,T.useImperativeHandle)(k,function(){return{edit:function(a){var t;(t=G.current)===null||t===void 0||t.setFieldsValue({title:a.title,name:a.name,type:a.setting.type,url:a.setting.url,id:a.id}),f(!0)}}}),(0,T.useEffect)(function(){N.get("op")=="create"&&f(!0)},[]),(0,r.jsxs)(A.a,{name:"appstoreCreate",title:o.format("createDrawerTitle"),open:$,onOpenChange:function(a){var t;!a&&((t=G.current)===null||t===void 0||t.resetFields()),f(a)},drawerProps:{forceRender:!0,width:I.R_},formRef:G,trigger:(0,r.jsx)(s.ZP,{type:"primary",children:o.format("createDrawerTitle")}),onFinish:function(){var c=m()(d()().mark(function a(t){var D,v,Z;return d()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return t.type=="1panel-local"&&(t.url="/dpanel/store/".concat(t.name)),y.next=3,(0,i.ks)({name:t.name,url:t.url,type:t.type});case 3:if(D=y.sent,!(D&&D.data)){y.next=13;break}return y.next=7,(0,i.$c)({id:t.id,name:t.name,title:t.title,type:t.type,url:t.url,apps:D.data.list});case 7:if(v=y.sent,!(v&&v.data)){y.next=13;break}return g.success(E.FD.format("finish")),j.onFinish&&j.onFinish(),(Z=G.current)===null||Z===void 0||Z.resetFields(),y.abrupt("return",!0);case 13:case"end":return y.stop()}},a)}));return function(a){return c.apply(this,arguments)}}(),children:[(0,r.jsx)(n.Z,{name:"id",hidden:!0}),(0,r.jsx)(n.Z,{label:o.format("formTitle"),name:"title",required:!0,rules:[{required:!0}],placeholder:o.format("formTitleEmpty")}),(0,r.jsx)(W.Z,{name:["id"],children:function(a){var t=a.id;return(0,r.jsx)(n.Z,{label:o.format("formName"),name:"name",required:!0,disabled:!!t,rules:[{required:!0}],placeholder:o.format("formNameEmpty")})}}),(0,r.jsx)(P.Z.Group,{name:"type",label:o.format("formType"),options:o.option("formTypeOption",["casaos","1panel","1panel-local"]),fieldProps:{onChange:function(a){var t;(t=G.current)===null||t===void 0||t.resetFields(["url"])}}}),(0,r.jsx)(W.Z,{name:["type","name"],children:function(a){var t=a.type,D=a.name,v=[],Z=[];if(t=="1panel"&&(Z=["https://gitee.com/qyg2297248353/appstore-dpanel","https://github.com/1Panel-dev/appstore","https://github.com/okxlin/appstore"],v=[(0,r.jsx)(n.Z,{label:o.format("formGitUrl"),name:"url",required:!0,rules:[{required:!0}],placeholder:o.format("formGitUrlEmpty")},"gitUrl")]),t=="portainer"&&(v=[(0,r.jsx)(n.Z,{label:o.format("formJsonUrl"),name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/Lissy93/portainer-templates/blob/main/templates.json"},"jsonUrl")]),t=="casaos"&&(Z=["https://play.cuse.eu.org/Cp0204-AppStore-Play.zip"],v=[(0,r.jsx)(n.Z,{label:o.format("formZipUrl"),name:"url",required:!0,rules:[{required:!0}],placeholder:o.format("formZipUrlEmpty")},"zipUrl")]),t&&t!="1panel-local")return[v,(0,r.jsx)(_.Z,{label:(0,r.jsxs)(u.Z,{children:[o.format("formRecommend"),(0,r.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/setting/store?id=%e6%94%af%e6%8c%81%e7%b1%bb%e5%9e%8b",target:"_blank",children:E.FD.format("help")})]}),children:(0,r.jsx)(u.Z,{wrap:!0,children:Z.map(function(b,y){return(0,r.jsx)(O.Z.Link,{onClick:function(){var ie;(ie=G.current)===null||ie===void 0||ie.setFieldValue("url",b)},children:(0,r.jsx)(B.Z,{color:"cyan",children:b})},y)})})},"recommend")];if(t=="1panel-local")return[v,(0,r.jsx)(_.Z,{children:(0,r.jsx)(l.Z,{message:o.format("formLocalDesc",{name:D})})},"local-description")]}})]})}),ne=H,q=e(80821),te=e(36435),re=e(83403),ae=e(5251),Q=e(67255),x=e(99611),se=e(86548),V=e(98165),ue=e(90078),le=e(78099),ee=e(96074),w=e(83062);function X(){var j=(0,T.useRef)(),k=(0,p.useAccess)(),Y=(0,T.useRef)();return(0,r.jsx)(ue._z,{header:{extra:[k.canSeeFounder&&(0,r.jsx)(ne,{ref:Y,onFinish:function(){var $,f;!(($=j.current)===null||$===void 0)&&$.reloadAndRest&&((f=j.current)===null||f===void 0||f.reloadAndRest())}},"create")]},children:(0,r.jsx)(le.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,Q.O)(),columns:[{title:E.FD.format("listName"),dataIndex:"name",width:200},{title:E.FD.format("listTitle"),dataIndex:"title"},{title:E.FD.format("listTargetAddress"),width:500,search:!1,render:function($,f,G,R,g){return(0,r.jsx)("a",{href:f.setting.url,target:"_blank",children:(0,r.jsx)(B.Z,{children:f.setting.url})})}},{title:E.FD.format("listUpdatedAt"),width:180,render:function($,f,G,R,g){if(f.setting.updatedAt)return(0,ae.ZM)(f.setting.updatedAt*1e3)}},{title:E.FD.format("listManage"),width:100,search:!1,fixed:"right",render:function($,f,G,R,g){return(0,r.jsxs)(u.Z,{split:(0,r.jsx)(ee.Z,{type:"vertical"}),children:[(0,r.jsx)(p.Link,{to:"/compose/appstore",state:{name:f.name},children:(0,r.jsx)(w.Z,{title:E.FD.format("listManageView"),children:(0,r.jsx)(x.Z,{})})}),(0,r.jsx)(O.Z.Link,{onClick:function(){var h;(h=Y.current)===null||h===void 0||h.edit(f)},children:(0,r.jsx)(w.Z,{title:E.FD.format("listManageEdit"),children:(0,r.jsx)(se.Z,{})})},"manage"),(0,r.jsx)(q.Z,{type:"link",icon:(0,r.jsx)(V.Z,{}),action:function(){var h,N;return(0,i.ks)({id:f.id,name:f.name,url:(h=f.setting.url)!==null&&h!==void 0?h:"",type:(N=f.setting.type)!==null&&N!==void 0?N:""})},onSuccess:function(){var h,N;return!((h=j.current)===null||h===void 0)&&h.reloadAndRest&&((N=j.current)===null||N===void 0||N.reloadAndRest()),!0},onError:function(){var h,N;return!((h=j.current)===null||h===void 0)&&h.reloadAndRest&&((N=j.current)===null||N===void 0||N.reloadAndRest()),!0},ghost:!0,tips:E.FD.format("listManageSync")},"upgrade")]})}}],request:function(){var z=m()(d()().mark(function $(f,G,R){var g;return d()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,i.eO)({name:f.name,title:f.title});case 2:return g=h.sent,h.abrupt("return",{data:g.data.list,success:!0,total:g.data.list.length});case 4:case"end":return h.stop()}},$)}));return function($,f,G){return z.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:j,tableAlertOptionRender:function($){var f=$.selectedRowKeys,G=$.selectedRows;return(0,r.jsxs)(u.Z,{size:16,children:[(0,r.jsx)(te.Z,{type:re.W6.APPSTORE,selected:G,onSuccess:function(){var g,L;return!((g=j.current)===null||g===void 0)&&g.reloadAndRest&&((L=j.current)===null||L===void 0||L.reloadAndRest()),!0}}),(0,r.jsx)(q.Z,{danger:!0,type:"primary",action:function(){return(0,i.Me)({id:G.map(function(g){return g.id})})},onSuccess:function(){var g,L;return!((g=j.current)===null||g===void 0)&&g.reloadAndRest&&((L=j.current)===null||L===void 0||L.reloadAndRest()),!0},onError:function(){var g,L;return!((g=j.current)===null||g===void 0)&&g.reset&&((L=j.current)===null||L===void 0||L.reset()),!0},confirm:"notification.confirm.title",children:E.FD.format("listManageDeleteBatch")},"delete")]})}})})}},15078:function(J,S,e){e.d(S,{$c:function(){return C},Me:function(){return P},eO:function(){return n},ks:function(){return M},yL:function(){return p}});var F=e(15009),d=e.n(F),U=e(99289),m=e.n(U),K=e(82346);function C(u){return I.apply(this,arguments)}function I(){return I=m()(d()().mark(function u(O){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,K.request)("/api/common/store/create",{method:"POST",data:O}));case 1:case"end":return l.stop()}},u)})),I.apply(this,arguments)}function M(u){return i.apply(this,arguments)}function i(){return i=m()(d()().mark(function u(O){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,K.request)("/api/common/store/sync",{method:"POST",data:O}));case 1:case"end":return l.stop()}},u)})),i.apply(this,arguments)}function E(u){return A.apply(this,arguments)}function A(){return A=_asyncToGenerator(_regeneratorRuntime().mark(function u(O){return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:O}));case 1:case"end":return l.stop()}},u)})),A.apply(this,arguments)}function n(u){return W.apply(this,arguments)}function W(){return W=m()(d()().mark(function u(O){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,K.request)("/api/common/store/get-list",{method:"POST",data:O}));case 1:case"end":return l.stop()}},u)})),W.apply(this,arguments)}function P(u){return _.apply(this,arguments)}function _(){return _=m()(d()().mark(function u(O){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,K.request)("/api/common/store/delete",{method:"POST",data:O});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},u)})),_.apply(this,arguments)}function p(u){return s.apply(this,arguments)}function s(){return s=m()(d()().mark(function u(O){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,K.request)(O==null?void 0:O.path,{method:"GET"}));case 1:case"end":return l.stop()}},u)})),s.apply(this,arguments)}},67255:function(J,S,e){e.d(S,{O:function(){return F},j:function(){return d}});function F(U){var m=localStorage.getItem("dpanel-pagesize");return m=="all"?!1:{defaultCurrent:U==null?void 0:U.page,showSizeChanger:!0,defaultPageSize:parseInt(m!=null?m:"20"),onChange:function(C,I){localStorage.setItem("dpanel-page-"+location.pathname.split("/").slice(-2).join("-"),"".concat(C))}}}function d(U){var m="dpanel-table-column-".concat(U),K={};if(localStorage.getItem(m)){var C;K=JSON.parse((C=localStorage.getItem(m))!==null&&C!==void 0?C:"{}")}return{defaultValue:K,onChange:function(M){localStorage.setItem("dpanel-table-column-".concat(U),JSON.stringify(M))}}}}}]);
