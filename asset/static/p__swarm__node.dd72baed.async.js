"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3763],{91806:function(Re,V,n){n.d(V,{Z:function(){return y}});var X=n(87462),l=n(67294),k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},j=k,ne=n(84089),N=function(Q,J){return l.createElement(ne.Z,(0,X.Z)({},Q,{ref:J,icon:j}))},H=l.forwardRef(N),y=H},74842:function(Re,V,n){n.d(V,{Z:function(){return y}});var X=n(87462),l=n(67294),k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},j=k,ne=n(84089),N=function(Q,J){return l.createElement(ne.Z,(0,X.Z)({},Q,{ref:J,icon:j}))},H=l.forwardRef(N),y=H},87784:function(Re,V,n){n.d(V,{Z:function(){return y}});var X=n(87462),l=n(67294),k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},j=k,ne=n(84089),N=function(Q,J){return l.createElement(ne.Z,(0,X.Z)({},Q,{ref:J,icon:j}))},H=l.forwardRef(N),y=H},75293:function(Re,V,n){n.d(V,{Z:function(){return k}});var X=n(25593),l=n(85893);function k(j){return(0,l.jsx)(X.Z.Text,{copyable:!0,style:{padding:10,display:j.block?"block":"",background:"#24292f",color:"#ffffff"},children:j.content})}},47900:function(Re,V,n){n.r(V),n.d(V,{default:function(){return Mt}});var X=n(15009),l=n.n(X),k=n(99289),j=n.n(k),ne=n(5574),N=n.n(ne),H=n(94359),y=n(24494),o=n(36146),Q=n(184),J=n(5966),Me=n(52688),Oe=n(83622),le=n(86250),g=n(67294),e=n(85893);function He(v){var f=(0,g.useRef)(),i=new o.Uo("swarm");return(0,e.jsxs)(Q.a,{title:i.format("nodeInitTitle"),trigger:(0,e.jsx)(Oe.ZP,{type:"primary",children:i.format("nodeInitTitle")}),onFinish:function(){var b=j()(l()().mark(function x(R){var P;return l()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,y.UK)({advertiseAddr:R.advertiseAddr,listenAddr:R.listenAddr,dataPathAddr:R.dataPathAddr,autoLockManagers:R.autoLockManagers,forceNewCluster:R.forceNewCluster,subnet:R.subnet});case 2:return P=S.sent,v.onFinish&&v.onFinish(),S.abrupt("return",!0);case 5:case"end":return S.stop()}},x)}));return function(x){return b.apply(this,arguments)}}(),formRef:f,onOpenChange:function(x){var R;!x&&(!((R=f.current)===null||R===void 0)&&R.resetFields)&&f.current.resetFields()},children:[(0,e.jsx)(J.Z,{name:"advertiseAddr",label:i.format("nodeInitAdvertiseAddr"),tooltip:i.format("nodeInitAdvertiseAddrTip"),required:!0,rules:[{required:!0}],placeholder:"172.16.1.13"}),(0,e.jsx)(J.Z,{name:"listenAddr",label:i.format("nodeInitListenAddr"),tooltip:i.format("nodeInitListenAddrTip"),initialValue:"0.0.0.0",required:!0,rules:[{required:!0}]}),(0,e.jsx)(J.Z,{name:"subnet",label:i.format("nodeInitSubnet"),initialValue:"10.0.0.0/16"}),(0,e.jsxs)(le.Z,{gap:30,children:[(0,e.jsx)(Me.Z,{label:i.format("nodeInitAutoLockManagers"),name:"autoLockManagers",tooltip:i.format("nodeInitAutoLockManagersTip")}),(0,e.jsx)(Me.Z,{label:i.format("nodeInitForceNewCluster"),name:"forceNewCluster",tooltip:i.format("nodeInitForceNewClusterTip")})]})]})}var Ee=n(3616),Je=n(86615),s=n(64317),C=n(97462),T=n(62370),re=n(40056),se=n(75293),ae=n(87662);function de(v){var f=new o.Uo("swarm"),i=(0,g.useRef)(),b=(0,g.useState)(),x=N()(b,2),R=x[0],P=x[1];(0,g.useEffect)(function(){v.detail&&v.type=="add"&&B(v.detail,"worker")},[v.detail]);function B(U,m){return S.apply(this,arguments)}function S(){return S=j()(l()().mark(function U(m,L){var I,F,z;return l()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:P("docker swarm join --token ".concat(L=="manager"?(I=m.swarm)===null||I===void 0?void 0:I.JoinTokens.Manager:(F=m.swarm)===null||F===void 0?void 0:F.JoinTokens.Worker," ").concat((m==null?void 0:m.node)&&(m==null||(z=m.node.ManagerStatus)===null||z===void 0?void 0:z.Addr)));case 1:case"end":return O.stop()}},U)})),S.apply(this,arguments)}return(0,e.jsxs)(Q.a,{drawerProps:{width:Ee.R_},submitter:!1,formRef:i,onOpenChange:function(m){var L;!m&&(!((L=i.current)===null||L===void 0)&&L.resetFields)&&i.current.resetFields(),!m&&v.onFinish&&v.onFinish()},title:f.format("nodeJoinTitle.".concat(v.type)),trigger:(0,e.jsx)(Oe.ZP,{children:f.format("nodeJoinTitle.".concat(v.type))}),onValuesChange:function(){var U=j()(l()().mark(function m(L,I){var F,z;return l()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(P(""),!I.dockerEnvName){O.next=12;break}return O.prev=2,O.next=5,(0,y.vb)({dockerEnvName:I.dockerEnvName,role:I.role,type:v.type});case 5:F=O.sent,B(F.data,I.role),O.next=12;break;case 9:O.prev=9,O.t0=O.catch(2),(z=i.current)===null||z===void 0||z.resetFields(["dockerEnvName"]);case 12:v.type=="add"&&v.detail&&B(v.detail,I.role);case 13:case"end":return O.stop()}},m,null,[[2,9]])}));return function(m,L){return U.apply(this,arguments)}}(),children:[(0,e.jsx)(Je.Z.Group,{label:f.format("nodeJoinRole"),name:"role",initialValue:"worker",options:f.option("nodeAddRoleOption",["manager","worker"])}),v.type=="join"&&(0,e.jsx)(s.Z,{label:f.format("nodeJoinDockerEnvName"),name:"dockerEnvName",placeholder:f.format("nodeJoinDockerEnvNameEmpty"),request:j()(l()().mark(function U(){var m;return l()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,(0,ae.Kg)();case 2:return m=I.sent,I.abrupt("return",m.data.list.filter(function(F){return F.name!=m.data.currentName}).map(function(F){return{label:F.title,value:F.name}}));case 4:case"end":return I.stop()}},U)}))},"env"),v.type=="join"&&!R&&(0,e.jsx)(C.Z,{name:["role"],children:function(m){var L=m.role;return(0,e.jsx)(T.Z,{label:f.format("nodeJoinCommandManual"),children:(0,e.jsxs)(le.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)(re.Z,{type:"warning",message:f.format("nodeJoinCommandManualTip")}),(0,e.jsx)(se.Z,{block:!0,content:"docker swarm join-token ".concat(L)})]})})}}),R&&(0,e.jsx)(T.Z,{label:f.format("nodeJoinCommandJoin"),children:(0,e.jsxs)(le.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)(re.Z,{message:f.format("nodeJoinCommandJoinTip",{target:f.format("nodeJoinCommandJoinTarget.".concat(v.type))})}),(0,e.jsx)(se.Z,{block:!0,content:R})]})})]})}var pe=n(43425),Se=n(74842),Ae=n(30159),Te=n(87784),ie=n(87462),we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.5 360.3a7.95 7.95 0 00-12.9 0l-178 246c-3.8 5.3 0 12.7 6.5 12.7H381c10.2 0 19.9-4.9 25.9-13.2L512 460.4l105.2 145.4c6 8.3 15.6 13.2 25.9 13.2H690c6.5 0 10.3-7.4 6.5-12.7l-178-246z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"up-circle",theme:"outlined"},ge=we,_=n(84089),be=function(f,i){return g.createElement(_.Z,(0,ie.Z)({},f,{ref:i,icon:ge}))},ze=g.forwardRef(be),De=ze,je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},ue=je,We=function(f,i){return g.createElement(_.Z,(0,ie.Z)({},f,{ref:i,icon:ue}))},ce=g.forwardRef(We),Le=ce,ve=n(45605),$e=n(91806),Qe=n(60433),Y=n(38345),oe=n(42075),Ye=n(96074),M=n(26412),Ne=n(66309),fe=n(80821),Ke=n(5251),dt=n(91058),ut=n(76428),ct=n(24963),vt=n(97269),qe=n(25593),ft=n(84567);function _e(v){var f=(0,g.useRef)(),i=new o.Uo("swarm");return(0,e.jsx)(fe.Z,{type:"primary",danger:!0,confirmTitle:o.FD.format("title.tip"),confirmOnOpenChange:function(){var x;!((x=f.current)===null||x===void 0)&&x.resetFields&&f.current.resetFields()},confirm:(0,e.jsx)(vt.A,{submitter:!1,formRef:f,children:(0,e.jsxs)(oe.Z,{style:{width:600,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(qe.Z.Text,{children:(0,e.jsx)("ul",{children:i.prefix("removeButtonTip",4).map(function(b,x){return(0,e.jsx)("li",{children:b},x)})})}),(0,e.jsx)(T.Z,{name:"enableForce",valuePropName:"checked",children:(0,e.jsxs)(ft.Z,{disabled:!!v.nodeId,children:[o.FD.format("listManageExitForce"),"\uFF1F"]})})]})}),action:j()(l()().mark(function b(){var x;return l()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,y.QB)({nodeId:v.nodeId,force:(x=f.current)===null||x===void 0?void 0:x.getFieldValue("enableForce")}));case 1:case"end":return P.stop()}},b)})),onSuccess:function(){v.onFinish&&v.onFinish()},children:v.title},"console")}var mt=n(94617),ht=(0,g.forwardRef)(function(v,f){var i,b,x,R,P,B,S,U,m,L,I,F,z,me,O,Ze,Fe,Pe,ye,E,$,d,Z,w,W,u,r,c,D,A,G,K,xe,Ie,Ve;(0,g.useImperativeHandle)(f,function(){return{show:function(a){var ee,h,Ce;!((ee=a.Spec)===null||ee===void 0)&&ee.Labels&&((h=lt.current)===null||h===void 0||h.setFieldValue("labels",Object.keys((Ce=a.Spec)===null||Ce===void 0?void 0:Ce.Labels).map(function(Be){var te,Ge,Xe;return{name:Be,value:(te=a.Spec)!==null&&te!==void 0&&te.Labels&&(Ge=a.Spec)!==null&&Ge!==void 0&&Ge.Labels[Be]?(Xe=a.Spec)===null||Xe===void 0?void 0:Xe.Labels[Be]:""}}))),he(a),ke(!0)}}});var Et=(0,g.useState)(!1),at=N()(Et,2),ot=at[0],ke=at[1],lt=(0,g.useRef)(),At=(0,g.useState)(),st=N()(At,2),t=st[0],he=st[1],q=new o.Uo("swarm"),Ue=new o.Uo("system.home.overview"),Tt=(0,g.useContext)(ct.Z),wt=Tt.message;return(0,e.jsx)(Q.a,{title:q.format("nodeDetailTitle",{name:t==null||(i=t.Description)===null||i===void 0?void 0:i.Hostname}),open:ot,drawerProps:{forceRender:!0,width:Ee.R_},onOpenChange:function(a){ke(a),!a&&v.onFinish&&v.onFinish()},onFinish:function(){var p=j()(l()().mark(function a(ee){var h,Ce;return l()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,(0,y.Zc)({nodeId:(h=t==null?void 0:t.ID)!==null&&h!==void 0?h:"",labels:ee.labels});case 2:return Ce=te.sent,he(Ce.data.detail),wt.success(o.FD.format("finish")),te.abrupt("return",!1);case 6:case"end":return te.stop()}},a)}));return function(a){return p.apply(this,arguments)}}(),formRef:lt,children:(0,e.jsxs)(le.Z,{vertical:!0,gap:20,children:[(0,e.jsx)(Y.Z,{title:(0,e.jsx)(pe.Z,{}),ghost:!0,subTitle:o.FD.format("listManage"),children:(0,e.jsxs)(oe.Z,{wrap:!0,children:[(0,e.jsx)(fe.Z,{action:j()(l()().mark(function p(){var a;return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",availability:"active"}));case 1:case"end":return h.stop()}},p)})),onSuccess:function(a){he(a.data.detail)},disabled:(t==null||(b=t.Spec)===null||b===void 0?void 0:b.Availability)=="active"||(t==null||(x=t.Status)===null||x===void 0?void 0:x.State)!="ready",tips:q.format("nodeListStatusOptionTip.active"),icon:(0,e.jsx)(Se.Z,{}),children:o.FD.format("listManageUnpause")}),(0,e.jsx)(fe.Z,{action:j()(l()().mark(function p(){var a;return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",availability:"pause"}));case 1:case"end":return h.stop()}},p)})),onSuccess:function(a){he(a.data.detail)},disabled:(t==null||(R=t.Spec)===null||R===void 0?void 0:R.Availability)=="pause"||(t==null||(P=t.Status)===null||P===void 0?void 0:P.State)!="ready",tips:q.format("nodeListStatusOptionTip.pause"),icon:(0,e.jsx)(Ae.Z,{}),children:o.FD.format("listManagePause")}),(0,e.jsx)(fe.Z,{action:j()(l()().mark(function p(){var a;return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",availability:"drain"}));case 1:case"end":return h.stop()}},p)})),onSuccess:function(a){he(a.data.detail)},tips:q.format("nodeListStatusOptionTip.drain"),disabled:(t==null||(B=t.Spec)===null||B===void 0?void 0:B.Availability)=="drain"||(t==null||(S=t.Status)===null||S===void 0?void 0:S.State)!="ready",icon:(0,e.jsx)(Te.Z,{}),children:o.FD.format("listManageStop")}),(0,e.jsx)(Ye.Z,{type:"vertical"}),(t==null||(U=t.Spec)===null||U===void 0?void 0:U.Role)=="worker"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(fe.Z,{action:j()(l()().mark(function p(){var a;return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",role:"manager"}));case 1:case"end":return h.stop()}},p)})),onSuccess:function(a){he(a.data.detail)},type:"primary",disabled:(t==null||(m=t.Spec)===null||m===void 0?void 0:m.Availability)=="drain"||(t==null||(L=t.Status)===null||L===void 0?void 0:L.State)!="ready",icon:(0,e.jsx)(De,{}),children:q.format("nodeDetailManageManager")})}),(t==null||(I=t.Spec)===null||I===void 0?void 0:I.Role)=="manager"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(fe.Z,{action:j()(l()().mark(function p(){var a;return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,y.Zc)({nodeId:(a=t==null?void 0:t.ID)!==null&&a!==void 0?a:"",role:"worker"}));case 1:case"end":return h.stop()}},p)})),onSuccess:function(a){he(a.data.detail)},type:"primary",disabled:(t==null||(F=t.Spec)===null||F===void 0?void 0:F.Availability)=="drain"||(t==null||(z=t.Status)===null||z===void 0?void 0:z.State)!="ready",icon:(0,e.jsx)(Le,{}),children:q.format("nodeDetailManageWorker")})}),(0,e.jsx)(Ye.Z,{type:"vertical"}),(0,e.jsx)(_e,{title:o.FD.format("listManageDelete"),nodeId:t==null?void 0:t.ID,onFinish:function(){ke(!1),v.onFinish&&v.onFinish()}})]})}),(0,e.jsx)(Y.Z,{title:(0,e.jsx)(ve.Z,{}),subTitle:o.FD.format("listManageDetail"),ghost:!0,children:(0,e.jsxs)(M.Z,{column:1,bordered:!0,styles:{label:{width:150}},children:[(0,e.jsxs)(M.Z.Item,{label:"Hostname",children:[(0,e.jsx)(ut.Z,{title:t==null?void 0:t.ID})," - ",t==null||(me=t.Description)===null||me===void 0?void 0:me.Hostname," - ",(0,e.jsx)(Ne.Z,{color:"blue",children:t==null||(O=t.Spec)===null||O===void 0?void 0:O.Role})," ",t&&(0,e.jsx)(H.Z,{status:"swarm.".concat((Ze=t.Status)===null||Ze===void 0?void 0:Ze.State),tip:q.format("nodeListRunStatusOptionTip.".concat((Fe=(Pe=t.Status)===null||Pe===void 0?void 0:Pe.State)!==null&&Fe!==void 0?Fe:"ready"))}),t&&(0,e.jsx)(H.Z,{status:"swarm.".concat((ye=t.Spec)===null||ye===void 0?void 0:ye.Availability),tip:q.format("nodeListStatusOptionTip.".concat((E=($=t.Spec)===null||$===void 0?void 0:$.Availability)!==null&&E!==void 0?E:"active"))})]}),(0,e.jsx)(M.Z.Item,{label:Ue.format("basicDockerTitleSystemVersion"),children:"".concat(t==null||(d=t.Description)===null||d===void 0||(d=d.Platform)===null||d===void 0?void 0:d.OS,` - 
              `).concat(t==null||(Z=t.Description)===null||Z===void 0||(Z=Z.Platform)===null||Z===void 0?void 0:Z.Architecture,` - 
              `).concat(t==null||(w=t.Description)===null||w===void 0||(w=w.Engine)===null||w===void 0?void 0:w.EngineVersion)}),(0,e.jsxs)(M.Z.Item,{label:"Cpu",children:[((W=t==null||(u=t.Description)===null||u===void 0||(u=u.Resources)===null||u===void 0?void 0:u.NanoCPUs)!==null&&W!==void 0?W:0)/1e9," ",o.FD.format("unitCpu")]}),(0,e.jsx)(M.Z.Item,{label:"Memory",children:(0,Ke.FI)((r=t==null||(c=t.Description)===null||c===void 0||(c=c.Resources)===null||c===void 0?void 0:c.MemoryBytes)!==null&&r!==void 0?r:0)}),(0,e.jsx)(M.Z.Item,{label:Ue.format("basicDockerTitlePluginsVolume"),children:(0,e.jsx)(oe.Z,{children:(t==null||(D=t.Description)===null||D===void 0||(D=D.Engine)===null||D===void 0?void 0:D.Plugins)&&(t==null||(A=t.Description)===null||A===void 0||(A=A.Engine)===null||A===void 0?void 0:A.Plugins.filter(function(p){return p.Type=="Volume"}).map(function(p){return p.Name}))})}),(0,e.jsx)(M.Z.Item,{label:Ue.format("basicDockerTitlePluginsNetwork"),children:(0,e.jsx)(oe.Z,{wrap:!0,children:(t==null||(G=t.Description)===null||G===void 0||(G=G.Engine)===null||G===void 0?void 0:G.Plugins)&&(t==null||(K=t.Description)===null||K===void 0||(K=K.Engine)===null||K===void 0?void 0:K.Plugins.filter(function(p){return p.Type=="Network"}).map(function(p){return p.Name}))})}),(0,e.jsx)(M.Z.Item,{label:Ue.format("basicDockerTitleLogDriver"),children:(0,e.jsx)(oe.Z,{wrap:!0,children:(t==null||(xe=t.Description)===null||xe===void 0||(xe=xe.Engine)===null||xe===void 0?void 0:xe.Plugins)&&(t==null||(Ie=t.Description)===null||Ie===void 0||(Ie=Ie.Engine)===null||Ie===void 0?void 0:Ie.Plugins.filter(function(p){return p.Type=="Log"}).map(function(p){return p.Name}))})})]})}),t&&t.ID&&ot&&(0,e.jsx)(Y.Z,{title:(0,e.jsx)($e.Z,{}),subTitle:q.format("nodeDetailServiceList"),headStyle:{paddingBottom:0},ghost:!0,children:(0,e.jsx)(mt.Z,{showWithNodeId:t.ID})}),(t==null||(Ve=t.Spec)===null||Ve===void 0?void 0:Ve.Labels)&&(0,e.jsx)(Y.Z,{title:(0,e.jsx)(Qe.Z,{}),ghost:!0,subTitle:q.format("nodeDetailTagList"),children:(0,e.jsx)(dt.Z,{showCardGhost:!0,name:"labels",showAddButton:!0,addButtonLabel:q.format("nodeDetailTagAdd")})})]})})}),pt=ht,St=n(98009),gt=function(f,i){return g.createElement(_.Z,(0,ie.Z)({},f,{ref:i,icon:St.Z}))},Dt=g.forwardRef(gt),et=Dt,jt=n(30432),Zt=function(f,i){return g.createElement(_.Z,(0,ie.Z)({},f,{ref:i,icon:jt.Z}))},yt=g.forwardRef(Zt),xt=yt,It=n(90078),Ct=n(56729),tt=n(32983),Rt=n(60940),Ot=n(40411),$t=n(83062),Ft=n(22181),Pt=n(82346),nt=n(89240),it={xs:1,sm:2,md:2,lg:2,xl:3,xxl:4},rt={display:"flex",justifyContent:"flex-end",width:100};function Mt(){var v=(0,g.useState)(),f=N()(v,2),i=f[0],b=f[1],x=(0,g.useState)(0),R=N()(x,2),P=R[0],B=R[1],S=new o.Uo("swarm"),U=(0,g.useRef)(),m=(0,g.useRef)(),L=(0,g.useState)(),I=N()(L,2),F=I[0],z=I[1],me=(0,g.useState)(),O=N()(me,2),Ze=O[0],Fe=O[1],Pe=(0,Pt.useModel)("@@initialState"),ye=Pe.refresh;return(0,g.useEffect)(function(){(0,y.JC)().then(function(E){var $;b(E.data),!(($=m.current)===null||$===void 0)&&$.reloadAndRest&&m.current.reloadAndRest()})},[P]),(0,e.jsxs)(It._z,{extra:[i&&i.status.isManage&&(0,e.jsx)(de,{type:"add",detail:i,onFinish:function(){B(P+1)}},"join"),i&&i.status.isNode&&(0,e.jsx)(_e,{title:S.format("nodeDetailDeleteButton.".concat(i.status.isManage?"delete":"leave")),onFinish:function(){i.status.isManage?ye():B(P+1)}},"leave")],children:[(0,e.jsx)(pt,{ref:U,onFinish:function(){B(P+1)}}),(0,e.jsxs)(Y.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(!i||!i.status.isNode)&&(0,e.jsx)(le.Z,{justify:"center",style:{height:"58vh"},vertical:!0,children:(0,e.jsx)(tt.Z,{image:tt.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(oe.Z,{direction:"vertical",size:[0,20],children:[S.format("nodeDetailJoinTip"),(0,e.jsxs)(oe.Z,{children:[(0,e.jsx)(de,{type:"join",detail:i,onFinish:function(){B(P+1)}},"join"),(0,e.jsx)(He,{onFinish:function(){ye(),B(P+1)}})]})]})})}),i&&i.status.isNode&&i.info&&i.info.LocalNodeState!="error"&&(0,e.jsxs)(Y.Z,{title:(0,e.jsx)(et,{}),subTitle:S.format("nodeDetailCurrent"),direction:"column",gutter:[0,20],children:[(0,e.jsx)(Y.Z,{ghost:!0,children:(0,e.jsxs)(M.Z,{column:it,styles:{label:rt},children:[(0,e.jsx)(M.Z.Item,{label:"Id",children:i.info.NodeID}),(0,e.jsx)(M.Z.Item,{label:o.FD.format("listRunStatus"),children:(0,e.jsx)(H.Z,{status:"swarm.".concat(i.info.LocalNodeState),tip:S.format("nodeListRunStatusOptionTip.".concat(i.info.LocalNodeState))})}),(0,e.jsx)(M.Z.Item,{label:o.FD.format("listType"),children:S.format("nodeAddRoleOption.".concat(i.info.ControlAvailable?"manager":"worker"))})]})}),i.info.RemoteManagers&&!i.status.isManage&&(0,e.jsx)(Y.Z,{ghost:!0,title:(0,e.jsx)(et,{}),subTitle:S.format("nodeDetailManager"),children:(0,e.jsx)(Rt.Z,{pagination:!1,columns:[{title:o.FD.format("listName"),dataIndex:"NodeID"},{title:o.FD.format("listIpAddress"),dataIndex:"Addr"}],dataSource:i.info.RemoteManagers})})]}),i&&i.status.isManage&&i.swarm&&(0,e.jsx)(Y.Z,{title:(0,e.jsx)(xt,{}),subTitle:S.format("nodeDetailSwarm"),direction:"column",gutter:[0,15],children:(0,e.jsx)(Y.Z,{ghost:!0,children:(0,e.jsxs)(M.Z,{column:it,styles:{label:rt},children:[(0,e.jsx)(M.Z.Item,{label:o.FD.format("listName"),children:i.swarm.ID}),(0,e.jsx)(M.Z.Item,{label:o.FD.format("listTitle"),children:i.swarm.Spec&&i.swarm.Spec.Name}),(0,e.jsxs)(M.Z.Item,{label:o.FD.format("listResource"),children:[F&&(0,nt.PD)(F.cpu)," ",o.FD.format("unitCpu")," / ",(0,Ke.FI)(F==null?void 0:F.memory)]}),(0,e.jsxs)(M.Z.Item,{label:"".concat(S.format("nodeDetailSwarmWorker")," / ").concat(S.format("nodeDetailSwarmManager")),children:[i.info.Nodes," / ",i.info.Managers]}),(0,e.jsx)(M.Z.Item,{label:o.FD.format("listCreatedAt"),children:new Date(i.swarm.CreatedAt).toLocaleString()}),(0,e.jsx)(M.Z.Item,{label:o.FD.format("listUpdatedAt"),children:new Date(i.swarm.UpdatedAt).toLocaleString()})]})})}),i&&i.status.isManage&&i.info.LocalNodeState!="error"&&(0,e.jsx)(Y.Z,{title:(0,e.jsx)(Qe.Z,{}),subTitle:S.format("nodeDetailSwarmNodeList"),children:(0,e.jsx)(Ct.Z,{scroll:{x:"max-content"},rowKey:"ID",actionRef:m,pagination:!1,ghost:!0,search:!1,request:j()(l()().mark(function E(){var $,d,Z,w,W;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,y.HN)();case 2:return $=r.sent,d={cpu:0,memory:0},$.data.list&&$.data.list.forEach(function(c){var D,A,G,K;d.cpu+=(D=(A=c.Description)===null||A===void 0||(A=A.Resources)===null||A===void 0?void 0:A.NanoCPUs)!==null&&D!==void 0?D:0,d.memory+=(G=(K=c.Description)===null||K===void 0||(K=K.Resources)===null||K===void 0?void 0:K.MemoryBytes)!==null&&G!==void 0?G:0}),z(d),r.next=8,(0,y.kM)();case 8:return Z=r.sent,r.next=11,(0,y.XX)();case 11:return w=r.sent,w.data&&w.data.list&&(W=[],w.data.list.forEach(function(c){if(c.Status.State=="running"){var D,A=Z.data&&Z.data.list&&((D=Z.data.list.find(function(G){return G.ID==c.ServiceID}))===null||D===void 0||(D=D.Spec)===null||D===void 0?void 0:D.Name);(!A||A=="")&&(A=c.ServiceID),W.push({nodeId:c.NodeID,serviceName:A,taskId:c.ID})}}),Fe(W)),r.abrupt("return",{data:$.data.list,success:!0,total:$.data.list.length});case 14:case"end":return r.stop()}},E)})),columns:[{title:o.FD.format("listName"),render:function($,d,Z,w,W){var u,r;return(0,e.jsxs)(oe.Z,{children:[(0,e.jsx)(qe.Z.Link,{onClick:function(){var D;(D=U.current)===null||D===void 0||D.show(d)},children:(u=(r=d.Description)===null||r===void 0?void 0:r.Hostname)!==null&&u!==void 0?u:d.ID})," ",i.node&&d.ID==i.node.ID&&(0,e.jsx)(Ot.Z,{status:"processing"})]})}},{title:o.FD.format("listRole"),dataIndex:["Spec","Role"],render:function($,d,Z,w,W){var u,r,c,D;return(0,e.jsx)(Ne.Z,{color:S.format("nodeAddRoleColor.".concat((u=(r=d.Spec)===null||r===void 0?void 0:r.Role)!==null&&u!==void 0?u:"worker")),children:S.format("nodeAddRoleOption.".concat((c=(D=d.Spec)===null||D===void 0?void 0:D.Role)!==null&&c!==void 0?c:"worker"))})}},{title:"CPU / Memory",render:function($,d,Z,w,W){var u,r,c;return"".concat((0,nt.PD)((u=d.Description)===null||u===void 0||(u=u.Resources)===null||u===void 0?void 0:u.NanoCPUs)," ").concat(o.FD.format("unitCpu")," / ").concat((0,Ke.FI)((r=(c=d.Description)===null||c===void 0||(c=c.Resources)===null||c===void 0?void 0:c.MemoryBytes)!==null&&r!==void 0?r:0))}},{title:o.FD.format("listRunTask"),render:function($,d,Z,w,W){var u={};return Ze&&Ze.filter(function(r){return r.nodeId==d.ID}).forEach(function(r){u[r.serviceName]||(u[r.serviceName]=0),u[r.serviceName]+=1}),Object.keys(u).length>0?Object.keys(u).map(function(r,c){return(0,e.jsx)($t.Z,{title:r,children:(0,e.jsx)(Ne.Z,{color:"success",children:u[r]})},"".concat(r,"-").concat(c))}):(0,e.jsx)(Ne.Z,{children:"0"})}},{title:o.FD.format("listApiVersion"),dataIndex:["Description","Engine","EngineVersion"]},{title:o.FD.format("listIpAddress"),dataIndex:["Status","Addr"]},{title:o.FD.format("listRunStatus"),render:function($,d,Z,w,W){var u,r,c=(u=(r=d.Status)===null||r===void 0?void 0:r.State)!==null&&u!==void 0?u:"ready";return(0,e.jsx)(H.Z,{status:"swarm.".concat(c),tip:S.format("nodeListRunStatusOptionTip.".concat(c))})}},{title:o.FD.format("listStatus"),render:function($,d,Z,w,W){var u,r,c,D;return(0,e.jsx)(H.Z,{status:"swarm.".concat((u=(r=d.Spec)===null||r===void 0?void 0:r.Availability)!==null&&u!==void 0?u:"active"),tip:S.format("nodeListStatusOptionTip.".concat((c=(D=d.Spec)===null||D===void 0?void 0:D.Availability)!==null&&c!==void 0?c:"active"))})}}],toolBarRender:function(){return[(0,e.jsx)(fe.Z,{action:function(){return(0,y.kp)()},onSuccess:function(){var d,Z;return!((d=m.current)===null||d===void 0)&&d.reloadAndRest&&((Z=m.current)===null||Z===void 0||Z.reloadAndRest()),!0},onError:function(){var d,Z;return!((d=m.current)===null||d===void 0)&&d.reset&&((Z=m.current)===null||Z===void 0||Z.reset()),!0},tips:o.FD.format("listManagePruneTip"),confirm:"notification.confirm.title",children:o.FD.format("listManagePrune")},"clear")]}})}),i&&i.status.isNode&&i.info.LocalNodeState=="error"&&(0,e.jsx)(Ft.ZP,{status:"error",title:S.format(["nodeListRunStatusOptionTip.error","nodeListRunStatusOptionTip.exit"]),subTitle:i.info.Error})]})]})}},89240:function(Re,V,n){n.d(V,{HJ:function(){return g},PD:function(){return He},Rk:function(){return e},pM:function(){return Ee},yi:function(){return le},zY:function(){return Je}});var X=n(64599),l=n.n(X),k=n(5251),j=n(88237),ne=n(43836),N=n(17179),H=n(74911),y=n(17637),o=n(58353),Q=/^([1-9]|[1-5]?[0-9]{2,4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$/m;function J(s){return Q.test(s)?parseInt(s,10):0}function Me(s){typeof s!="string"&&(s=s.toString());var C=j.Z(s,"-",2),T=ne.Z(C,J);return T.length==1&&T.push(T[0]),T}function Oe(s,C){typeof s!="string"&&(s=s.toString());var T=null,re=s.indexOf(":");re>=0&&(T=s.substring(0,re),s=s.substring(re+1)),C=typeof C=="number"?C:J(C);var se=Me(s),ae=Math.min(se[0],C),de=Math.max(se[1],C);return T?T+":"+ae+"-"+de:ae+"-"+de}function le(s){if(!s||!s.HostConfig||!s.HostConfig.PortBindings)return[];var C=[],T=s.HostConfig.PortBindings,re=N.Z(T),se=H.Z(re,function(ae){return j.Z(ae,"/")[1]});return y.Z(se,function(ae,de){var pe={},Se=l()(ae),Ae;try{for(Se.s();!(Ae=Se.n()).done;){var Te=Ae.value,ie=l()(T[Te]),we;try{for(ie.s();!(we=ie.n()).done;){var ge=we.value;pe[ge.HostIp]=pe[ge.HostIp]||[],pe[ge.HostIp].push(Te)}}catch(_){ie.e(_)}finally{ie.f()}}}catch(_){Se.e(_)}finally{Se.f()}y.Z(pe,function(_,be){var ze=o.Z(_,function(ue){return parseInt(j.Z(ue,"/")[0],10)}),De=-1,je=-1;y.Z(ze,function(ue){var We=j.Z(ue,"/"),ce=parseInt(We[0],10),Le=T[ue][0];T[ue].shift();var ve=J(Le.HostPort);if(ve>0){if(C.length>0&&De===ve-1&&je===ce-1){C[C.length-1].host=Oe(C[C.length-1].host,ve),C[C.length-1].dest=Oe(C[C.length-1].dest,ce),De=ve,je=ce;return}De=ve,je=ce}else De=-1,je=-1;var $e=Le.HostPort.toString();be&&($e="".concat(be,":").concat($e)),C.push({host:$e,dest:ce.toString(),protocol:de})})})}),C}function g(s){return(0,k.fi)(s,"/")}function e(s){return s?(0,k.FI)(s):"64M"}function He(s){return s&&s>1e8?s/1e9:0}function Ee(s){return s?s/1024/1024:0}function Je(s){return"".concat(g(s),".pod.dpanel.local")}}}]);
