"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9002],{52645:function(_,P,e){e.d(P,{Z:function(){return b}});var T=e(87462),l=e(67294),Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},f=Z,R=e(84089),A=function($,L){return l.createElement(R.Z,(0,T.Z)({},$,{ref:L,icon:f}))},M=l.forwardRef(A),b=M},1883:function(_,P,e){var T=e(87462),l=e(67294),Z=e(3936),f=e(84089),R=function(b,I){return l.createElement(f.Z,(0,T.Z)({},b,{ref:I,icon:Z.Z}))},A=l.forwardRef(R);P.Z=A},3616:function(_,P,e){e.d(P,{Ed:function(){return f},FK:function(){return l},R_:function(){return T},ob:function(){return Z}});var T=window.innerWidth<=1024?"90vw":"65vw",l="90vw",Z="60vw",f="50vh"},60415:function(_,P,e){e.r(P),e.d(P,{default:function(){return we}});var T=e(15009),l=e.n(T),Z=e(99289),f=e.n(Z),R=e(1699),A=e(24905),M=e(80821),b=e(59683),I=e(78451),$=e(5574),L=e.n($),ee=e(3616),B=e(24963),F=e(82346);function H(u){return K.apply(this,arguments)}function K(){return K=f()(l()().mark(function u(y){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,F.request)("/api/app/volume/get-list",{method:"POST",data:y}));case 1:case"end":return i.stop()}},u)})),K.apply(this,arguments)}function z(u){return G.apply(this,arguments)}function G(){return G=f()(l()().mark(function u(y){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,F.request)("/api/app/volume/create",{method:"POST",data:y}));case 1:case"end":return i.stop()}},u)})),G.apply(this,arguments)}function Q(u){return k.apply(this,arguments)}function k(){return k=f()(l()().mark(function u(y){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,F.request)("/api/app/volume/prune",{method:"POST",data:y});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},u)})),k.apply(this,arguments)}function X(u){return J.apply(this,arguments)}function J(){return J=f()(l()().mark(function u(y){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,F.request)("/api/app/volume/delete",{method:"POST",data:y});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},u)})),J.apply(this,arguments)}function Y(u){return q.apply(this,arguments)}function q(){return q=f()(l()().mark(function u(y){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,F.request)("/api/app/volume/get-detail",{method:"POST",data:y}));case 1:case"end":return i.stop()}},u)})),q.apply(this,arguments)}var p=e(36146),d=e(184),o=e(5966),w=e(62370),a=e(86615),ue=e(97462),oe=e(17186),de=e(24739),ce=e(83622),ae=e(34041),D=e(67294),r=e(85893),me=(0,D.forwardRef)(function(u,y){var C=(0,D.useState)(!1),i=L()(C,2),U=i[0],N=i[1],O=(0,D.useRef)(),h=(0,D.useContext)(B.Z),c=h.message,n=new p.Uo("docker");return(0,D.useImperativeHandle)(y,function(){return{}}),(0,r.jsxs)(d.a,{name:"create",title:n.format("volumeCreateTitle"),drawerProps:{width:ee.R_},open:U,onOpenChange:function(t){N(t)},formRef:O,trigger:(0,r.jsx)(ce.ZP,{type:"primary",children:n.format("volumeCreateTitle")}),onFinish:function(){var s=f()(l()().mark(function t(m){var v,g,j,E,W,x;return l()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return E=[],m.otherOptions&&m.otherOptions.map(function(se){E.push(se.name+`
`+se.value)}),V.next=4,z({name:m.name,driver:"local",type:m.type,nfsUrl:(v=m.nfsUrl)!==null&&v!==void 0?v:"",nfsMountPoint:(g=m.nfsMountPoint)!==null&&g!==void 0?g:"",nfsOptions:(j=m.nfsOptions)!==null&&j!==void 0?j:"",tmpfsOptions:m.tmpfsOptions,otherOptions:E});case 4:if(W=V.sent,!(W&&W.data&&W.data.info.Name!="")){V.next=10;break}return c.success(p.FD.format("finish")),u.onFinish&&u.onFinish(),(x=O.current)===null||x===void 0||x.resetFields(),V.abrupt("return",!0);case 10:case"end":return V.stop()}},t)}));return function(t){return s.apply(this,arguments)}}(),children:[(0,r.jsx)(o.Z,{label:n.format("volumeCreateFormName"),name:"name",placeholder:n.format("volumeCreateFormNameEmpty")}),(0,r.jsx)(w.Z,{label:n.format("volumeCreateFormDriver"),name:"driver",children:(0,r.jsx)(ae.Z,{defaultValue:"local",children:(0,r.jsx)(ae.Z.Option,{value:"local",children:"local"})})}),(0,r.jsx)(a.Z.Group,{name:"type",label:n.format("volumeCreateFormType"),options:n.option("volumeCreateFormTypeOption",["default","tmpfs","nfs","nfs4","other"]),initialValue:"default"}),(0,r.jsx)(ue.Z,{name:["type"],children:function(t){var m=t.type;if(m=="other")return(0,r.jsx)(oe.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:n.format("volumeCreateFormTypeOptions")},copyIconProps:!1,min:0,children:(0,r.jsxs)(de.UW,{children:[(0,r.jsx)(o.Z,{name:"name",label:n.format("volumeCreateFormTypeOtherName")}),(0,r.jsx)(o.Z,{name:"value",label:n.format("volumeCreateFormTypeOtherValue"),placeholder:"/etc/path"})]})});if(m=="nfs"||m=="nfs4")return[(0,r.jsx)(o.Z,{label:n.format("volumeCreateFormTypeNfsUrl"),name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:n.format("volumeCreateFormTypeNfsUrlEmpty")},"nfsUrl"),(0,r.jsx)(o.Z,{label:n.format("volumeCreateFormTypeNfsMountPoint"),name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"/export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,r.jsx)(o.Z,{label:n.format("volumeCreateFormTypeOptions"),name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(m=="tmpfs")return[(0,r.jsx)(o.Z,{label:n.format("volumeCreateFormTypeOptions"),name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),fe=me,le=e(5251),ie=e(38345),S=e(26412),pe=e(60940),re=e(25593),ne=e(66309),ve=e(67007),he=(0,D.forwardRef)(function(u,y){var C;(0,D.useImperativeHandle)(y,function(){return{showDetail:function(g){return f()(l()().mark(function j(){var E;return l()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,Y({name:g});case 2:E=x.sent,O(!0),s(E.data);case 5:case"end":return x.stop()}},j)}))()}}});var i=(0,D.useState)(!1),U=L()(i,2),N=U[0],O=U[1],h=(0,D.useState)(),c=L()(h,2),n=c[0],s=c[1],t=new p.Uo("docker"),m=(0,D.useRef)();return(0,r.jsxs)(d.a,{title:t.format("volumeDetailTitle"),open:N,submitter:!1,onOpenChange:function(g){O(g),!g&&s(void 0)},drawerProps:{width:ee.R_},children:[(0,r.jsx)(ie.Z,{title:t.format("volumeDetailTitle"),ghost:!0,children:(0,r.jsxs)(S.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:[(0,r.jsx)(S.Z.Item,{label:t.format("volumeDetailName"),children:n==null?void 0:n.info.Name}),(0,r.jsx)(S.Z.Item,{label:t.format("volumeDetailCreatedAt"),children:new Date((C=n==null?void 0:n.info.CreatedAt)!==null&&C!==void 0?C:"").toLocaleString()}),(0,r.jsx)(S.Z.Item,{label:t.format("volumeDetailMountpoint"),children:n==null?void 0:n.info.Mountpoint}),(0,r.jsx)(S.Z.Item,{label:t.format("volumeDetailDriver"),children:n==null?void 0:n.info.Driver}),(n==null?void 0:n.info.Labels)&&(0,r.jsx)(S.Z.Item,{label:"Lables",children:(0,r.jsx)(S.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:(n==null?void 0:n.info.Labels)&&Object.keys(n==null?void 0:n.info.Labels).map(function(v){return(0,r.jsx)(S.Z.Item,{label:v,children:n.info.Labels[v]})})})})]})}),(0,r.jsxs)(ie.Z,{title:t.format("volumeDetailUseContainer"),ghost:!0,children:[(0,r.jsx)(ve.Z,{ref:m}),(0,r.jsx)(pe.Z,{rowKey:"Name",columns:[{title:p.FD.format("listContainerName"),dataIndex:"Name",render:function(g,j,E){return(0,r.jsx)(re.Z.Link,{onClick:function(){var x;(x=m.current)===null||x===void 0||x.show(j.Id)},children:(0,le.fi)(j.Name,"/")})}},{title:p.FD.format("listContainerPath"),dataIndex:"Mount"},{title:p.FD.format("listPermission"),render:function(g,j,E){return j.RW?(0,r.jsx)(ne.Z,{children:p.FD.format("listPermission.read")}):(0,r.jsx)(ne.Z,{children:p.FD.format("listPermission.write")})}}],dataSource:n==null?void 0:n.inUseContainer,pagination:!1})]})]})}),ge=he,ye=e(36693),je=e(95591),Re=e(52645),De=e(82061),Oe=e(74453),Ce=e(97269),te=e(42075),xe=e(96074),Pe=e(84567);function we(){var u=(0,D.useRef)(),y=(0,D.useRef)(),C=(0,D.useRef)(),i=(0,F.useAccess)(),U=(0,D.useRef)(),N=new p.Uo("docker");return(0,r.jsxs)(Oe._z,{header:{extra:[(0,r.jsx)(R.u,{access:"canSeeDockerVolumeManage",children:(0,r.jsx)(fe,{onFinish:function(){var h,c;!((h=u.current)===null||h===void 0)&&h.reloadAndRest&&((c=u.current)===null||c===void 0||c.reloadAndRest())}},"create")},"volumeManage")]},children:[(0,r.jsx)(ge,{ref:y}),(0,r.jsx)(A.Z,{type:"volume",ref:U,onCloseDestroy:!0}),(0,r.jsx)(b.C,{rowKey:"Name",columns:[{title:p.FD.format("listTitle"),dataIndex:"Name",width:300,render:function(h,c,n,s,t){return(0,r.jsx)(re.Z.Link,{onClick:function(){var v;(v=y.current)===null||v===void 0||v.showDetail(c.Name)},children:(0,r.jsx)(I.Z,{content:c.Name})})}},{title:p.FD.format("listContainerName"),ellipsis:!0,search:!1,render:function(h,c,n,s,t){return c.InUse?(0,r.jsx)(te.Z,{direction:"vertical",children:c.InUse.map(function(m,v){return(0,r.jsx)(ne.Z,{color:"cyan",icon:(0,r.jsx)(ye.Z,{}),children:(0,le.fi)(m.name,"/")},v)})},n):(0,r.jsx)(ne.Z,{children:p.FD.format("listNotUse")})}},{title:p.FD.format("listDriver"),ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:p.FD.format("listHostPath"),search:!1,width:250,dataIndex:"Mountpoint",render:function(h,c,n,s,t){return(0,r.jsx)(I.Z,{content:c.Mountpoint})}},{title:p.FD.format("listCreatedAt"),ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(h,c,n,s,t){return new Date(c.CreatedAt).toLocaleString()}},{title:p.FD.format("listManage"),width:100,search:!1,fixed:"right",hidden:!i.canSeeDockerVolumeManage,render:function(h,c,n,s,t){return(0,r.jsx)(te.Z,{split:(0,r.jsx)(xe.Z,{type:"vertical"}),children:(0,r.jsx)(re.Z.Link,{onClick:function(){var v;(v=U.current)===null||v===void 0||v.showVolume(c.Name)},children:(0,r.jsx)(je.Z,{})})})}}],request:function(){var O=f()(l()().mark(function h(c,n,s){var t,m;return l()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,H({name:c.name});case 2:return t=g.sent,m=[],t.data.inUse?m=t.data.list.map(function(j){return t.data.inUse&&t.data.inUse[j.Name]?j.InUse=t.data.inUse[j.Name]:j.InUse=void 0,j}):m=t.data.list,g.abrupt("return",{data:m,success:!0,total:t.data.list.length});case 6:case"end":return g.stop()}},h)}));return function(h,c,n){return O.apply(this,arguments)}}(),rowSelection:i.canSeeDockerVolumeManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:u,quickToolbarRender:function(h){var c=h.selectedRows;return(0,r.jsxs)(te.Z,{size:16,children:[(0,r.jsx)(M.Z,{action:function(){var s,t;return Q({deleteAll:(s=(t=C.current)===null||t===void 0?void 0:t.getFieldValue("deleteAll"))!==null&&s!==void 0?s:!1})},buttonProps:{icon:(0,r.jsx)(Re.Z,{})},onSuccess:function(){var s,t;return!((s=u.current)===null||s===void 0)&&s.reloadAndRest&&((t=u.current)===null||t===void 0||t.reloadAndRest()),!0},onError:function(){var s,t;return!((s=u.current)===null||s===void 0)&&s.reset&&((t=u.current)===null||t===void 0||t.reset()),!0},confirmProps:{description:(0,r.jsx)(Ce.A,{formRef:C,submitter:!1,children:(0,r.jsxs)(te.Z,{style:{width:280},direction:"vertical",children:[(0,r.jsx)(re.Z.Text,{children:N.format("volumeListManagePruneTip")}),(0,r.jsx)(w.Z,{name:"deleteAll",valuePropName:"checked",children:(0,r.jsx)(Pe.Z,{children:N.format("volumeListManagePruneNotAnonymous")})})]})})},children:p.FD.format("listManagePrune")},"clear"),(0,r.jsx)(M.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,r.jsx)(De.Z,{})},confirmProps:{showCommonConfirm:!0},action:function(){return X({name:c.map(function(s){return s.Name})})},onSuccess:function(){var s,t;return!((s=u.current)===null||s===void 0)&&s.reloadAndRest&&((t=u.current)===null||t===void 0||t.reloadAndRest()),!0},onError:function(){var s,t;return!((s=u.current)===null||s===void 0)&&s.reset&&((t=u.current)===null||t===void 0||t.reset()),!0},children:p.FD.format("listManageDeleteBatch")})]})}},"volume-list")]})}},62597:function(_,P,e){e.d(P,{$G:function(){return I},Ct:function(){return k},Tb:function(){return F},XH:function(){return K},cl:function(){return ee},fp:function(){return L},fu:function(){return M},iE:function(){return G},nL:function(){return b},xb:function(){return J},ze:function(){return q}});var T=e(15009),l=e.n(T),Z=e(99289),f=e.n(Z),R=e(82346),A="com.dpanel.container.description",M="com.dpanel.container.title",b={Nanosecond:1,Microsecond:1e3,Millisecond:1e3*1e3,Second:1e3*1e3*1e3,Minute:60*1e3*1e3*1e3,Hour:3600*1e3*1e3*1e3};function I(d){return $.apply(this,arguments)}function $(){return $=f()(l()().mark(function d(o){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,R.request)("/api/app/site/create-by-image",{method:"POST",data:o}));case 1:case"end":return a.stop()}},d)})),$.apply(this,arguments)}var L={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueRuleInEnvFile:4,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192,EnvValueTypeOnePanel:16384};function ee(d){return B.apply(this,arguments)}function B(){return B=f()(l()().mark(function d(o){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,R.request)("/api/app/site/get-list",{method:"POST",data:o}));case 1:case"end":return a.stop()}},d)})),B.apply(this,arguments)}function F(d){return H.apply(this,arguments)}function H(){return H=f()(l()().mark(function d(o){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o.download=!1,a.next=3,(0,R.request)("/api/app/log/run",{method:"POST",data:o});case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}},d)})),H.apply(this,arguments)}function K(d){return z.apply(this,arguments)}function z(){return z=f()(l()().mark(function d(o){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o.download=!0,a.next=3,(0,R.request)("/api/app/log/run",{method:"POST",data:o,responseType:"blob"});case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}},d)})),z.apply(this,arguments)}function G(d){return Q.apply(this,arguments)}function Q(){return Q=f()(l()().mark(function d(o){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o.id=String(o.id),a.next=3,(0,R.request)("/api/app/site/get-detail",{data:o,method:"POST"});case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}},d)})),Q.apply(this,arguments)}function k(d){return X.apply(this,arguments)}function X(){return X=f()(l()().mark(function d(o){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,R.request)("/api/app/container/delete",{method:"POST",data:o}));case 1:case"end":return a.stop()}},d)})),X.apply(this,arguments)}function J(d){return Y.apply(this,arguments)}function Y(){return Y=f()(l()().mark(function d(o){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,R.request)("/api/app/site/delete",{method:"POST",data:o}));case 1:case"end":return a.stop()}},d)})),Y.apply(this,arguments)}function q(d){return p.apply(this,arguments)}function p(){return p=f()(l()().mark(function d(o){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,R.request)("/api/app/container/ignore",{method:"POST",data:o}));case 1:case"end":return a.stop()}},d)})),p.apply(this,arguments)}}}]);
