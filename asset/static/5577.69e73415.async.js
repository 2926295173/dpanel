"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5577],{57716:function(H,A,n){n.d(A,{Z:function(){return O}});var R=n(5574),r=n.n(R),W=n(15009),o=n.n(W),h=n(99289),U=n.n(h),l=n(67294),S=n(184),p=n(38345),g=n(64317),y=n(5966),b=n(62370),c=n(97462),j=n(42075),f=n(89035),I=n(82346),i=n(28036),s=n(85893);function _(u){var t=(0,l.useState)({height:800,width:1024}),a=r()(t,2),d=a[0],e=a[1],x=function(){var N=window.innerWidth,z=window.innerHeight;e({height:z,width:N})};(0,l.useEffect)(function(){window.addEventListener("resize",function(){x()}),x()},[u]);var K=u.query?Object.keys(u.query).map(function(B){if(u.query)return"".concat(B,"=").concat(u.query[B])}):[];return(0,s.jsx)(I.Link,{target:"_blank",to:"/console/"+u.container+"?width=".concat(d.width,"&height=").concat(d.height,"&").concat(K.join("&")),children:(0,s.jsx)(i.ZP,{type:"primary",icon:(0,s.jsx)(f.Z,{}),children:u.content})})}var v=n(60335),T=n(5251),P=n(49610),D=(0,l.forwardRef)(function(u,t){(0,l.useImperativeHandle)(t,function(){return{show:function(M,m){return U()(o()().mark(function L(){var F,Z,C;return o()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,v.jV)({md5:M});case 2:C=$.sent,m&&m!=""&&(C.data.info.Config.WorkingDir=m),V(C.data.info),B(!0),(F=a.current)===null||F===void 0||F.resetFields(),(Z=a.current)===null||Z===void 0||Z.setFieldsValue({workDir:C.data.info.Config.WorkingDir});case 8:case"end":return $.stop()}},L)}))()}}});var a=(0,l.useRef)(),d=(0,l.useRef)(),e=(0,l.useState)(!1),x=r()(e,2),K=x[0],B=x[1],N=(0,l.useState)(),z=r()(N,2),w=z[0],V=z[1];return(0,l.useEffect)(function(){return w&&setTimeout(function(){var E;(E=d.current)===null||E===void 0||E.start(w.Id,{width:"800",height:"".concat(window.innerHeight),cmd:"/bin/sh",workDir:w.Config.WorkingDir})},2e3),function(){var E;(E=d.current)===null||E===void 0||E.close()}},[w,K]),(0,s.jsxs)(S.a,{drawerProps:{forceRender:!0},onFinish:function(){var E=U()(o()().mark(function M(m){var L,F;return o()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(w){C.next=2;break}return C.abrupt("return",!1);case 2:return(L=d.current)===null||L===void 0||L.close(),(F=d.current)===null||F===void 0||F.start(w.Id,{width:"800",height:"".concat(window.innerHeight),cmd:m.entryCmd,workDir:m.workDir}),C.abrupt("return",!1);case 5:case"end":return C.stop()}},M)}));return function(M){return E.apply(this,arguments)}}(),onValuesChange:function(M,m){if(m.entryCmd){var L;(L=a.current)===null||L===void 0||L.submit()}},isKeyPressSubmit:!0,open:K,formRef:a,onOpenChange:function(M){if(B(M),M){var m;(m=d.current)===null||m===void 0||m.fit()}},submitter:!1,title:(0,T.fi)(w?w.Name:"","/")+" \u63A7\u5236\u53F0",children:[(0,s.jsx)(p.Z,{ghost:!0,children:(0,s.jsxs)(j.Z.Compact,{children:[(0,s.jsx)(g.Z,{label:"shell",width:"sm",name:"entryCmd",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,s.jsx)(y.Z,{width:"sm",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",disabled:!0}),(0,s.jsx)(b.Z,{label:" ",children:(0,s.jsx)(c.Z,{name:["entryCmd","workDir"],children:function(M){var m=M.entryCmd;return(!m||m=="")&&(m="/bin/sh"),w&&(0,s.jsx)(_,{container:w.Id,query:{cmd:encodeURIComponent(m),workDir:encodeURIComponent(w.Config.WorkingDir)},content:"\u65B0\u7A97\u53E3\u6253\u5F00"})}})})]})}),K&&(0,s.jsx)(P.Z,{showInDrawer:!0,ref:d})]})}),O=D},49610:function(H,A,n){var R=n(67294),r=n(54964),W=n(52626),o=n(12320),h=n.n(o),U=n(78267),l=n.n(U),S=n(85893),p,g=new o.Terminal(r.a),y=new U.FitAddon,b=(0,R.forwardRef)(function(c,j){var f,I=function(){g.reset(),f&&f.dispose(),p&&(p.close(),p=null)},i=function(){g.reset(),y.fit(),g.focus(),f&&f.dispose(),f=g.onData(function(_){var v={content:{command:_},type:"console"};p&&p.send(JSON.stringify(v))})};return(0,R.useImperativeHandle)(j,function(){return{start:function(_,v){var T=v?Object.keys(v).map(function(P){if(v&&v[P])return"".concat(P,"=").concat(v[P])}):[];p=new WebSocket((0,W.R)("/console/"+_+"?"+T.join("&"))),p.addEventListener("message",function(P){var D=JSON.parse(P.data),O=D.type;if(O=="console:"+_&&(g.write(D.data),D.data.indexOf("exec failed")!=-1)){I();return}}),i()},close:function(){I()},fit:function(){y.fit()}}}),(0,R.useEffect)(function(){return g.loadAddon(y),g.open(document.getElementById("terminal-container-console")),y.fit(),function(){I()}},[]),(0,S.jsx)("div",{style:{height:c.showInDrawer?"75vh":"100vh"},id:"terminal-container-console"})});A.Z=b},54964:function(H,A,n){n.d(A,{a:function(){return b}});var R=n(5574),r=n.n(R),W=n(78267),o=n.n(W),h=n(75458),U=n.n(h),l=n(67294),S=n(12320),p=n.n(S),g=n(89629),y=n(85893),b={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},c=new S.Terminal(b),j=new h.SearchAddon,f=new W.FitAddon,I=(0,l.forwardRef)(function(i,s){var _,v=(0,l.useState)(!0),T=r()(v,2),P=T[0],D=T[1];return(0,l.useEffect)(function(){return window.addEventListener("resize",function(){i.showInModal||f.fit()}),i.style&&i.style.fontSize&&(c.options.fontSize=i.style.fontSize),c.loadAddon(f),c.loadAddon(j),c.open(document.getElementById(i.id?i.id:"terminal-container")),i.showInModal||f.fit(),function(){c.reset(),D(!0)}},[]),(0,l.useImperativeHandle)(s,function(){return{write:function(u){P&&(f.fit(),D(!1)),c.write(u)},clear:function(){c.clear()},getTerminal:function(){return c},findNext:function(u){j.findNext(u)},findPrev:function(u){j.findPrevious(u)},fit:function(){f.fit()},onData:function(u){return c.onData(u)}}}),(0,y.jsx)("div",{id:i.id?i.id:"terminal-container",style:{width:i.width?i.width:"100%",height:i.height?i.height:"500px",marginTop:(_=i.style)===null||_===void 0?void 0:_.marginTop}})});A.Z=I},28031:function(H,A,n){n.d(A,{C4:function(){return s},LK:function(){return I},OQ:function(){return v},V9:function(){return U},Yx:function(){return b},ZU:function(){return g},_U:function(){return S},gb:function(){return j},lE:function(){return O},vp:function(){return P}});var R=n(15009),r=n.n(R),W=n(99289),o=n.n(W),h=n(82346);function U(t){return l.apply(this,arguments)}function l(){return l=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/get-path-list",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),l.apply(this,arguments)}function S(t){return p.apply(this,arguments)}function p(){return p=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/export",{data:a,method:"POST",responseType:"blob"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),p.apply(this,arguments)}function g(t){return y.apply(this,arguments)}function y(){return y=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/import",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),y.apply(this,arguments)}function b(t){return c.apply(this,arguments)}function c(){return c=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/delete",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),c.apply(this,arguments)}function j(t){return f.apply(this,arguments)}function f(){return f=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/unzip",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),f.apply(this,arguments)}function I(t){return i.apply(this,arguments)}function i(){return i=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/get-content",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),i.apply(this,arguments)}function s(t){return _.apply(this,arguments)}function _(){return _=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/import-file-content",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),_.apply(this,arguments)}function v(t){return T.apply(this,arguments)}function T(){return T=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/chmod",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),T.apply(this,arguments)}function P(t){return D.apply(this,arguments)}function D(){return D=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/volume/backup",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),D.apply(this,arguments)}function O(t){return u.apply(this,arguments)}function u(){return u=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/get-passwd",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),u.apply(this,arguments)}}}]);
