"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8714],{68714:function(Y,B,e){e.d(B,{Z:function(){return Me}});var I=e(5574),u=e.n(I),L=e(15009),o=e.n(L),Z=e(99289),t=e.n(Z),s=e(67294),C=e(37767),D=e(60335),f=e(82346),S=e(58638),K=e(85265),E=e(96074),y=e(83062),H=e(86250),k=e(52031),ue=e(14189),de=e(72409),ce=e(21393),q=e(184),X=e(25593),te=e(95591),re=e(5251),n=e(85893),me=(0,s.forwardRef)(function(j,R){var M,A=(0,s.useState)(!1),O=u()(A,2),U=O[0],b=O[1];return(0,s.useImperativeHandle)(R,function(){return{}}),(0,n.jsx)(q.a,{submitter:!1,title:(0,re.fi)(j.containerInfo.Name,"/")+" - \u6587\u4EF6\u7BA1\u7406",onOpenChange:function(v){b(v)},trigger:(0,n.jsx)(X.Z.Link,{children:(0,n.jsx)(te.Z,{})},"file"),children:U&&(0,n.jsx)(ce.Z,{md5:j.containerInfo.Id,initPath:(M=j.containerInfo.Config.WorkingDir)!==null&&M!==void 0?M:"/"})})}),se=me,he=e(43831),oe=e(52209),ve=(0,s.forwardRef)(function(j,R){(0,s.useImperativeHandle)(R,function(){return{}});var M=(0,s.useState)(!1),A=u()(M,2),O=A[0],U=A[1];return(0,n.jsx)(q.a,{submitter:!1,title:(0,re.fi)(j.containerInfo.Name,"/")+" - \u7F51\u7EDC\u7BA1\u7406",onOpenChange:function(a){U(a)},open:O,trigger:(0,n.jsx)(X.Z.Link,{children:(0,n.jsx)(oe.Z,{})},"file"),children:(0,n.jsx)(he.Z,{ghost:!0,containerInfo:j.containerInfo})})}),l=ve,W=e(81146),J=e(45742),ee=e(62597),_e=(0,s.forwardRef)(function(j,R){(0,s.useImperativeHandle)(R,function(){return{show:function(r){return t()(o()().mark(function i(){var _;return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,D.jV)({md5:r});case 2:_=d.sent,_.data&&G(_.data.info),U(!0);case 5:case"end":return d.stop()}},i)}))()}}});var M=(0,s.useState)(!1),A=u()(M,2),O=A[0],U=A[1],b=(0,s.useState)(),a=u()(b,2),v=a[0],G=a[1],m=(0,s.useRef)();return(0,n.jsxs)(n.Fragment,{children:[j.showTriggerButton&&(0,n.jsx)(X.Z.Link,{onClick:t()(o()().mark(function c(){return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:G(j.containerInfo),U(!0);case 2:case"end":return i.stop()}},c)})),children:(0,n.jsx)(y.Z,{title:"\u8FD0\u884C\u65E5\u5FD7",children:(0,n.jsx)(J.Z,{})})},"log"),(0,n.jsx)(K.Z,{title:"\u5BB9\u5668\u65E5\u5FD7",open:O,forceRender:!0,onClose:function(){U(!1)},afterOpenChange:function(r){if(r)setTimeout(function(){var _,h;(_=m.current)===null||_===void 0||_.start(),(h=m.current)===null||h===void 0||h.fit()},1e3);else{var i;(i=m.current)===null||i===void 0||i.close()}},width:800,children:v&&O&&(0,n.jsx)(W.Z,{ref:m,showInDrawer:!0,id:"container:log:".concat(v==null?void 0:v.Id),request:function(){var c=t()(o()().mark(function r(i){var _;return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,ee.Tb)({id:(_=v.Id)!==null&&_!==void 0?_:"",lineTotal:i.lineTotal,download:i.download,showTime:i.showTime});case 2:case"end":return d.stop()}},r)}));return function(r){return c.apply(this,arguments)}}(),download:function(){var c=t()(o()().mark(function r(i){var _,h,d,z;return o()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,ee.XH)({id:(_=v.Id)!==null&&_!==void 0?_:"",lineTotal:i.lineTotal,showTime:i.showTime});case 2:return d=$.sent,$.next=5,(0,D.jV)({md5:(h=v.Id)!==null&&h!==void 0?h:""});case 5:return z=$.sent,$.abrupt("return",{data:new Blob([d],{type:"text/plain"}),name:z.data.info.Name.replaceAll("/","")+"_"+new Date().toLocaleDateString()+".log"});case 7:case"end":return $.stop()}},r)}));return function(r){return c.apply(this,arguments)}}()})})]})}),F=_e,fe=e(65913),ne=e(14245),w=e(1699),le=e(40666),P=e(64789),x=e(38345),g=e(24739),p=e(64317),V=e(52688),N=e(97462),ie=e(5966),je=e(62370),Ee=e(42075),De=e(28036),Oe=e(66309),Ce=e(34879),ge=e(52364),Pe=e(2808);function xe(j){var R=(0,s.useRef)(),M=(0,s.useState)(0),A=u()(M,2),O=A[0],U=A[1],b=(0,s.useState)(),a=u()(b,2),v=a[0],G=a[1];return(0,s.useEffect)(function(){G([]),(0,ge.k)().then(function(m){G(m.data.list)})},[O,j.data.info.Name]),(0,n.jsx)(x.Z,{ghost:!0,title:(0,n.jsx)(le.Z,{}),subTitle:"\u5BB9\u5668\u6807\u7B7E",extra:(0,n.jsxs)(q.a,{onFinish:function(){var m=t()(o()().mark(function c(r){var i;return o()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return i="",r.tagColor&&r.tagColor.toHexString?r.tagColor.cleared||(i=r.tagColor.toHexString()):i=r.tagColor,h.next=4,(0,ge.l)({containerName:[j.data.info.Name],tag:r.tag?r.tag[0]:"",tagColor:i,title:r.title,description:r.description,url:r.url,icon:r.icon,enableShowGroup:r.enableShowGroup});case 4:return U(O+1),h.abrupt("return",!0);case 6:case"end":return h.stop()}},c)}));return function(c){return m.apply(this,arguments)}}(),formRef:R,title:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E",trigger:(0,n.jsx)(X.Z.Link,{children:(0,n.jsx)(P.Z,{})}),onOpenChange:function(c){var r;c&&(!((r=R.current)===null||r===void 0)&&r.resetFields)&&R.current.resetFields()},children:[(0,n.jsxs)(g.UW,{children:[(0,n.jsx)(p.Z,{width:"lg",label:"\u6807\u7B7E\u6216\u5206\u7EC4",required:!0,rules:[{required:!0}],onChange:function(c){var r=v&&v.find(function(_){return c&&c.length>=1&&_.tag==c[0]});if(r){var i;(i=R.current)===null||i===void 0||i.setFieldValue("tagColor",r.tagColor)}},options:v&&v.map(function(m){return{lable:m.tag,value:m.tag}}),name:"tag",mode:"tags",fieldProps:{maxCount:1},placeholder:"\u8BF7\u9009\u62E9\u6216\u662F\u8F93\u5165\u6807\u7B7E\u6216\u662F\u5206\u7EC4"},"tagSelect".concat(O)),(0,n.jsx)(Pe.Z,{label:"\u6807\u7B7E\u80CC\u666F\u989C\u8272",name:"tagColor"})]}),(0,n.jsx)(w.u,{access:"canSeeEnableCe",children:function(c){var r=c.canSeeEnableCe;return!r&&(0,n.jsx)(V.Z,{label:"\u4EE5\u5206\u7EC4\u7684\u5F62\u5F0F\u5C55\u793A\u5728\u9996\u9875",name:"enableShowGroup"})}}),(0,n.jsx)(N.Z,{name:["enableShowHome","title"],children:function(c){var r=c.enableShowHome;return r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(g.UW,{children:[(0,n.jsx)(ie.Z,{label:"\u6807\u9898",name:"title"}),(0,n.jsx)(ie.Z,{label:"\u63CF\u8FF0",name:"description"})]}),(0,n.jsxs)(Ee.Z.Compact,{children:[(0,n.jsx)(ie.Z,{label:"\u8BBF\u95EE\u5730\u5740",name:"url",width:"lg"}),(0,n.jsx)(je.Z,{label:" ",children:(0,n.jsx)(De.ZP,{children:"\u83B7\u53D6\u56FE\u6807"})})]}),(0,n.jsxs)(g.UW,{children:[(0,n.jsx)(Ce.Z,{label:"\u56FE\u6807",title:"\u4E0A\u4F20\u56FE\u6807",name:"iconUpload",accept:".jpg,.png,.webp,.svg"}),(0,n.jsx)(ie.Z,{width:"md",placeholder:"\u4EE5 https \u6216\u662F http \u5F00\u5934\uFF0C\u4F18\u5148\u4F7F\u7528\u4E0A\u4F20\u56FE\u7247",label:"\u8FDC\u7A0B\u5730\u5740",name:"icon"})]})]})}})]}),children:(0,n.jsx)(Ee.Z,{wrap:!0,children:v&&(v==null?void 0:v.filter(function(m){return m.containerName.includes(j.data.info.Name)}).map(function(m,c){return(0,n.jsx)(Oe.Z,{color:m.tagColor,closable:!0,style:{height:35,display:"flex",borderRadius:20,justifyContent:"center",alignItems:"center"},children:(0,n.jsx)("span",{style:{paddingLeft:10,paddingRight:3},children:m.tag})},c)}))})})}var pe=(0,s.forwardRef)(function(j,R){var M;(0,s.useImperativeHandle)(R,function(){return{show:function(h){return t()(o()().mark(function d(){return o()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return r(!0),T.next=3,i(h);case 3:case"end":return T.stop()}},d)}))()}}});var A=(0,f.useAccess)(),O=(0,s.useRef)(),U=(0,s.useState)(),b=u()(U,2),a=b[0],v=b[1],G=(0,s.useState)(!1),m=u()(G,2),c=m[0],r=m[1],i=function(){var _=t()(o()().mark(function h(d){var z,T;return o()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return(z=O.current)===null||z===void 0||z.show(),ae.next=3,(0,D.jV)({md5:d}).finally(function(){var Q;(Q=O.current)===null||Q===void 0||Q.destroy()});case 3:T=ae.sent,T.data&&(T.data.info.HostConfig.NetworkMode=="host"&&T.data.info.Config.ExposedPorts&&Object.keys(T.data.info.Config.ExposedPorts).map(function(Q){T.data.info.NetworkSettings.Ports[Q]=[{HostIp:"0.0.0.0",HostPort:Q.substring(0,Q.indexOf("/"))}]}),v(T.data));case 5:case"end":return ae.stop()}},h)}));return function(d){return _.apply(this,arguments)}}();return(0,n.jsx)(K.Z,{title:"\u5FEB\u6377\u67E5\u770B\u5BB9\u5668 - ".concat((0,re.fi)((M=a==null?void 0:a.info.Name)!==null&&M!==void 0?M:"","/")),open:c,onClose:function(){r(!1),j.onFinish&&j.onFinish()},width:800,extra:(0,n.jsxs)(w.u,{access:"canSeeContainerList",space:{split:(0,n.jsx)(E.Z,{type:"vertical"})},children:[(a==null?void 0:a.info)&&a.info.State.Running&&(0,n.jsx)(se,{containerInfo:a.info}),(a==null?void 0:a.info)&&A.canSeeContainerListManageOp&&(0,n.jsx)(l,{containerInfo:a.info}),(a==null?void 0:a.info)&&a.info.State.Running&&(0,n.jsx)(F,{containerInfo:a.info,showTriggerButton:!0}),(0,n.jsx)(w.u,{access:"canSeeContainerListManage",children:(0,n.jsx)(y.Z,{title:"\u67E5\u770B\u5B8C\u6574\u4FE1\u606F",children:(0,n.jsx)(f.Link,{to:"/app/detail/edit/"+(a==null?void 0:a.info.Id),children:(0,n.jsx)(S.Z,{})},"detail")})})]}),children:(0,n.jsx)(fe.Z,{ref:O,children:(0,n.jsxs)(H.Z,{vertical:!0,gap:20,children:[a&&(0,n.jsx)(w.u,{access:"canSeeContainerList",children:(0,n.jsx)(ue.Z,{ghost:!0,data:a==null?void 0:a.info,onFinish:t()(o()().mark(function _(){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,i(a.info.Id);case 2:return d.t0=d.sent,d.abrupt("return",[d.t0]);case 4:case"end":return d.stop()}},_)}))})}),a&&(0,n.jsx)(w.u,{access:["canSeeContainerListManage","canSeeContainerListManageOp"],children:(0,n.jsx)(de.Z,{ghost:!0,data:a,checkContainerUpgrade:function(){r(!1),j.onUpgradeFinish&&j.onUpgradeFinish()}})}),a&&(0,n.jsx)(xe,{data:a}),a&&(0,n.jsx)(C.Z,{data:a,ghost:!0}),(0,n.jsx)(k.Z,{data:a==null?void 0:a.info,ghost:!0}),a&&(0,n.jsx)(ne.Z,{data:a.info,ghost:!0})]})})})}),Me=pe},81146:function(Y,B,e){var I=e(15009),u=e.n(I),L=e(99289),o=e.n(L),Z=e(97857),t=e.n(Z),s=e(67294),C=e(97269),D=e(62370),f=e(5966),S=e(97462),K=e(82346),E=e(71230),y=e(15746),H=e(34041),k=e(28036),ue=e(84567),de=e(42075),ce=e(54964),q=e(80821),X=e(23430),te=e(93162),re=e.n(te),n=e(12320),me=e.n(n),se=e(78267),he=e.n(se),oe=e(75458),ve=e.n(oe),l=e(85893),W=new n.Terminal(t()(t()({},ce.a),{},{fontSize:12})),J=new se.FitAddon,ee=new oe.SearchAddon,_e=(0,s.forwardRef)(function(F,fe){(0,s.useImperativeHandle)(fe,function(){return{fit:function(){W.clear(),J.fit()},start:function(){return o()(u()().mark(function x(){return u()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,le({lineTotal:500});case 2:case"end":return p.stop()}},x)}))()},close:function(){w.progress.close(F.id)}}});var ne=(0,s.useRef)(),w=(0,K.useModel)("subscriber");w.addDataHandler(F.id,function(P){W.write(P.data.replaceAll(`
`,`

`))});var le=function(){var P=o()(u()().mark(function x(g){return u()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return W.clear(),g.download=!1,V.next=4,F.request(g);case 4:case"end":return V.stop()}},x)}));return function(g){return P.apply(this,arguments)}}();return(0,s.useEffect)(function(){return window.addEventListener("resize",function(){J.fit()}),W.loadAddon(J),W.open(document.getElementById("terminal-container-log")),J.fit(),function(){W.clear(),W.reset(),w.progress.close(F.id)}},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(C.A,{submitter:!1,layout:"horizontal",onValuesChange:function(x,g){le({id:F.id,lineTotal:parseInt(g.lineTotal),showTime:g.showTime})},formRef:ne,children:(0,l.jsxs)(E.Z,{gutter:[10,0],children:[(0,l.jsx)(y.Z,{span:8,children:(0,l.jsx)(D.Z,{name:"lineTotal",initialValue:"500",label:"\u83B7\u53D6\u65E5\u5FD7\u6761\u6570",children:(0,l.jsxs)(H.Z,{defaultValue:"500",children:[(0,l.jsx)(H.Z.Option,{value:"100",children:"100\u6761\u65E5\u5FD7\u6570\u636E"}),(0,l.jsx)(H.Z.Option,{value:"200",children:"200\u6761\u65E5\u5FD7\u6570\u636E"}),(0,l.jsx)(H.Z.Option,{value:"500",children:"500\u6761\u65E5\u5FD7\u6570\u636E"}),(0,l.jsx)(H.Z.Option,{value:"1000",children:"1000\u6761\u65E5\u5FD7\u6570\u636E"}),(0,l.jsx)(H.Z.Option,{value:"-1",children:"\u5168\u90E8\uFF08\u4E0B\u8F7D\u53EF\u89C1\uFF09"})]})})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(k.ZP,{onClick:function(){W.clear()},children:"\u6E05\u5C4F"})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(D.Z,{name:"showTime",valuePropName:"checked",children:(0,l.jsx)(ue.Z,{children:"\u663E\u793A\u65F6\u95F4"})})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(f.Z,{label:"\u67E5\u627E",name:"keywork"})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(S.Z,{name:["keywork"],children:function(x){var g=x.keywork;return(0,l.jsxs)(de.Z,{size:10,children:[(0,l.jsx)(k.ZP,{onClick:function(){ee.findNext(g)},children:"\u4E0B\u4E00\u4E2A"},"next"),(0,l.jsx)(k.ZP,{onClick:function(){ee.findPrevious(g)},children:"\u4E0A\u4E00\u4E2A"},"prev")]})}})}),(0,l.jsx)(y.Z,{children:(0,l.jsx)(q.Z,{icon:(0,l.jsx)(X.Z,{}),action:o()(u()().mark(function P(){var x,g,p;return u()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(!F.download){N.next=5;break}return N.next=3,F.download({lineTotal:parseInt((x=ne.current)===null||x===void 0?void 0:x.getFieldValue("lineTotal")),showTime:(g=ne.current)===null||g===void 0?void 0:g.getFieldValue("showTime")});case 3:p=N.sent,(0,te.saveAs)(p.data,p.name);case 5:case"end":return N.stop()}},P)})),children:"\u4E0B\u8F7D\u65E5\u5FD7"})})]})}),(0,l.jsx)("div",{style:{marginTop:"20px",height:F.showInDrawer?"75vh":"580px"},id:"terminal-container-log"})]})});B.Z=_e},34879:function(Y,B,e){e.d(B,{Z:function(){return Z}});var I=e(97961),u=e(91604),L=e(1677),o=e(85893);function Z(t){return t.showDragger?(0,o.jsx)(u.Z,{max:t.max?t.max:1,title:t.title,label:t.label,required:t.required,rules:[{required:t.required}],fieldProps:{multiple:!!(t.max&&t.max>1),name:"file",accept:t.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(C){return new Promise(function(D){var f;(0,I._2)({path:(f=C.response.data.path)!==null&&f!==void 0?f:""}).then(function(S){D(!0)})})}},name:t.name}):(0,o.jsx)(L.Z,{max:t.max?t.max:1,title:t.title,label:t.label,required:t.required,rules:[{required:t.required}],fieldProps:{multiple:!!(t.max&&t.max>1),name:"file",accept:t.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(C){return new Promise(function(D){var f;(0,I._2)({path:(f=C.response.data.path)!==null&&f!==void 0?f:""}).then(function(S){D(!0)})})}},name:t.name})}},2808:function(Y,B,e){e.d(B,{Z:function(){return s}});var I=e(97857),u=e.n(I),L=e(62370),o=e(51663),Z=e(67294),t=e(85893);function s(C){return(0,t.jsx)(L.Z,u()(u()({},C),{},{children:(0,t.jsx)(o.Z,{showText:function(f){return f.toHexString()},allowClear:!0,presets:[{label:"\u9884\u8BBE\u989C\u8272",colors:["#1677ff","#722ed1","#13c2c2","#52c41a","#eb2f96","#f5222d","#fa8c16","#fadb14","#fa541c","#2f54eb","#faad14","#a0d911","#000000","#5cdbd3","#b37feb","#b7eb8f","#61affe","#9254de","#36cfc9","#ff9c6e","#ff6f00","#ffc069","#28a745","#6610f2","#6f42c1","#007bff","#17a2b8","#20c997","#00cccc","#ff6666"]}]})}))}},65913:function(Y,B,e){var I=e(5574),u=e.n(I),L=e(74330),o=e(67294),Z=e(85893),t=(0,o.forwardRef)(function(s,C){(0,o.useImperativeHandle)(C,function(){return{show:function(){K(!0)},destroy:function(){K(!1)}}});var D=(0,o.useState)(!1),f=u()(D,2),S=f[0],K=f[1];return(0,Z.jsx)(L.Z,{spinning:S,size:"default",children:s.children})});B.Z=t},52364:function(Y,B,e){e.d(B,{k:function(){return C},l:function(){return t}});var I=e(15009),u=e.n(I),L=e(99289),o=e.n(L),Z=e(82346);function t(f){return s.apply(this,arguments)}function s(){return s=o()(u()().mark(function f(S){return u()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,Z.request)("/api/common/tag/create",{method:"POST",data:S});case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},f)})),s.apply(this,arguments)}function C(f){return D.apply(this,arguments)}function D(){return D=o()(u()().mark(function f(S){return u()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,Z.request)("/api/common/tag/get-list",{method:"POST"});case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},f)})),D.apply(this,arguments)}}}]);
