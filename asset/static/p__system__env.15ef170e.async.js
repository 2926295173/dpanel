"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{1699:function(z,A,e){e.d(A,{u:function(){return j}});var B=e(9783),u=e.n(B),y=e(97857),T=e.n(y),N=e(67294),L=e(82346),b=e(40411),f=e(42075),a=e(85893),j=function(n){var W=(0,L.useAccess)(),l=Array.isArray(n.access)?n.access:[n.access],t,d=n.fallback;if(typeof n.children=="function"?(t=n.children(l.reduce(function(_,g){return T()(T()({},_),{},u()({},g,W[g]))},{})),t||(t=d)):l.every(function(_){return W[_]})?t=n.children:t=d,!d&&t&&n.showProTips&&W.canSeeEnableCe){if(W.canSeeEnableHiddenProTips)return null;t=(0,a.jsx)(b.Z,{offset:n.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:t})}if(!d&&t&&n.showProRibbonTips&&W.canSeeEnableCe){if(W.canSeeEnableHiddenProTips)return null;t=(0,a.jsx)(b.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:t})}return n.space?(0,a.jsx)(f.Z,T()(T()({},n.space),{},{children:t})):t}},80821:function(z,A,e){e.d(A,{Z:function(){return s}});var B=e(97857),u=e.n(B),y=e(5574),T=e.n(y),N=e(24963),L=e(86738),b=e(83062),f=e(28036),a=e(67294),j=e(85893);function s(n){var W=(0,a.useState)(!1),l=T()(W,2),t=l[0],d=l[1],_=(0,a.useContext)(N.Z),g=_.lang,S=_.message,p=function(){d(!0);var r=n.action();r instanceof Promise?r.then(function($){if(d(!1),$){typeof n.onSuccess=="function"&&n.onSuccess($);var h="";n.messageSuccess?typeof n.messageSuccess=="function"?h=n.messageSuccess($):h=n.messageSuccess.indexOf("notification.")==0?g(n.messageSuccess):n.messageSuccess:h=g("notification.finish"),n.asynced?S.info(h):S.success(h)}}).catch(function($){d(!1),typeof n.onError=="function"&&n.onError($)}):d(!1)};return n.confirm?(0,j.jsx)(L.Z,u()(u()({style:{width:500},title:n.confirmTitle?n.confirmTitle:g("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?g(n.confirm):n.confirm,onConfirm:p,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,j.jsx)(b.Z,{title:n.tips,children:(0,j.jsx)(f.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&t?void 0:n.icon,loading:t,danger:n.danger,type:n.type,children:n.children})})})):(0,j.jsx)(b.Z,{title:n.tips,children:(0,j.jsx)(f.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&t?void 0:n.icon,loading:t,onClick:p,danger:n.danger,type:n.type,children:n.children})})}},44349:function(z,A,e){var B=e(97857),u=e.n(B),y=e(17186),T=e(5966),N=e(86250),L=e(67294),b=e(85893),f=(0,L.forwardRef)(function(a,j){var s=(0,L.useRef)();(0,L.useImperativeHandle)(j,function(){return{addItem:function(l,t){var d,_=(d=s.current)===null||d===void 0?void 0:d.getList(),g=!1;if(_==null||_.map(function(p){if(p.name==l){g=!0;return}}),!g){var S;(S=s.current)===null||S===void 0||S.add({name:l,value:t})}},clear:function(){var l;(l=s.current)===null||l===void 0||(l=l.getList())===null||l===void 0||l.map(function(t,d){var _;(_=s.current)===null||_===void 0||_.remove(d)})}}});var n={};return a.hideCopyButton===!0&&(n.copyIconProps=!1),a.hideDeleteButton===!0&&(n.deleteIconProps=!1),(0,b.jsx)(y.u,u()(u()({initialValue:a.initialValue,label:a.label,name:a.name,actionRef:s,creatorButtonProps:a.showAddButton?{creatorButtonText:a.label?a.label:a.name}:!1,min:a.min?a.min:0},n),{},{children:function(l,t,d){return(0,b.jsx)(N.Z,{justify:a.justify,gap:a.gap,children:a.items.map(function(_){return _.render?(0,b.jsx)("div",{children:_.render&&_.render(l,t,d)},"".concat(a.name,"-").concat(_.name,"-").concat(l.key)):(0,b.jsx)(T.Z,{width:_.width,name:_.name,label:_.label,required:_.required,rules:[{required:_.required}],disabled:_.disabled,placeholder:_.placeholder},"".concat(a.name,"-").concat(_.name,"-").concat(l.key))})})}}))});A.Z=f},36435:function(z,A,e){var B=e(15009),u=e.n(B),y=e(64599),T=e.n(y),N=e(99289),L=e.n(N),b=e(9783),f=e.n(b),a=e(5574),j=e.n(a),s=e(67294),n=e(184),W=e(38345),l=e(97269),t=e(97321),d=e(97462),_=e(64317),g=e(5966),S=e(86615),p=e(68602),G=e(28036),r=e(83403),$=e(24963),h=e(1699),J=e(29177),H=e(45742),ee=e(43425),ne=e(44349),_e=e(3616),Q=e(36146),v=e(85893),k=(0,s.forwardRef)(function(x,X){var q=(0,s.useState)(!1),w=j()(q,2),K=w[0],O=w[1],D=(0,s.useRef)(),C=(0,s.useContext)($.Z),V=C.message,o=(0,s.useState)([]),U=j()(o,2),Y=U[0],te=U[1],I=new Q.Uo("components.permissionButton"),ae=f()(f()(f()(f()(f()({},r.W6.CONTAINER,"Id"),r.W6.APPSTORE,"name"),r.W6.COMPOSE,"name"),r.W6.REGISTRY,"serverAddress"),r.W6.DOCKER_ENV,"name"),le=f()(f()(f()(f()(f()({},r.W6.CONTAINER,"name"),r.W6.APPSTORE,"name"),r.W6.COMPOSE,"name"),r.W6.REGISTRY,"title"),r.W6.DOCKER_ENV,"title"),re=ae[x.type],oe=le[x.type],ie=x.selected.map(function(c){return c[ae[x.type]]});return s.useEffect(function(){if(K){if(!x.selected||x.selected.length==0){V.error(Q.FD.format("message.noDataSelect")),O(!1);return}(0,p.dP)({permission:{uri:x.type,key:re,value:ie}}).then(function(c){var i;(i=D.current)===null||i===void 0||i.setFieldValue("list",Object.keys(c.data.list).map(function(m){return{name:m,type:c.data.list[m].type,users:c.data.list[m].users}}))}),(0,p.lE)().then(function(c){var i,m=(i=c.data)===null||i===void 0||(i=i.list)===null||i===void 0?void 0:i.map(function(E){return{label:E.username,value:E.username}});te(m)})}},[K]),(0,v.jsx)(h.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,v.jsxs)(n.a,{name:"create",title:I.format("drawerTitle"),open:K,onOpenChange:function(i){if(!i){var m;(m=D.current)===null||m===void 0||m.resetFields()}O(i)},drawerProps:{forceRender:!0,width:_e.R_},formRef:D,trigger:(0,v.jsx)(G.ZP,{icon:(0,v.jsx)(J.Z,{}),children:I.format("drawerTriggerButton")}),onFinish:function(){var c=L()(u()().mark(function i(m){var E,R,P;return u()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:E=T()(m.list),M.prev=1,E.s();case 3:if((R=E.n()).done){M.next=9;break}return P=R.value,M.next=7,(0,p.Db)({usernames:P.users,permissionType:P.type,permission:{uri:x.type,key:re,showKey:oe,value:[P.name]}});case 7:M.next=3;break;case 9:M.next=14;break;case 11:M.prev=11,M.t0=M.catch(1),E.e(M.t0);case 14:return M.prev=14,E.f(),M.finish(14);case 17:V.success(Q.FD.format("finish")),O(!1),x.onSuccess();case 20:case"end":return M.stop()}},i,null,[[1,11,14,17]])}));return function(i){return c.apply(this,arguments)}}(),children:[(0,v.jsxs)(W.Z,{ghost:!0,title:(0,v.jsx)(H.Z,{}),subTitle:I.format("batchTitle"),children:[(0,v.jsx)(l.A.Item,{name:"type",style:{marginBottom:0},children:(0,v.jsx)(t.Z.Group,{defaultValue:"admin",onChange:function(i){var m,E,R=(m=D.current)===null||m===void 0?void 0:m.getFieldValue("list");R.forEach(function(P){P.type=i,P.users=[]}),(E=D.current)===null||E===void 0||E.setFieldValue("list",R)},children:["admin","restricted","public"].map(function(c){return(0,v.jsx)(t.Z,{style:{width:240},title:I.format("dataTypeOption.".concat(c)),description:I.format("dataTypeOptionDesc.".concat(c)),value:c},c)})})}),(0,v.jsx)(d.Z,{name:["type"],children:function(i){var m=i.type;if(m==="restricted")return(0,v.jsx)(_.Z,{mode:"multiple",name:"usernames",label:I.format("formUsernames"),onChange:function(R){var P,Z,M=(P=D.current)===null||P===void 0?void 0:P.getFieldValue("list");M.forEach(function(F){F.users=R}),(Z=D.current)===null||Z===void 0||Z.setFieldValue("list",M)},rules:[{required:!0}],request:L()(u()().mark(function E(){var R,P,Z;return u()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!(Y.length>0)){F.next=2;break}return F.abrupt("return",Y);case 2:return F.next=4,(0,p.lE)();case 4:return P=F.sent,Z=(R=P.data)===null||R===void 0||(R=R.list)===null||R===void 0?void 0:R.map(function(se){return{label:se.username,value:se.username}}),te(Z),F.abrupt("return",Z);case 8:case"end":return F.stop()}},E)}))})}})]}),(0,v.jsx)(W.Z,{ghost:!0,title:(0,v.jsx)(ee.Z,{}),subTitle:I.format("dataTitle"),children:(0,v.jsx)(ne.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:I.format("dataName"),render:function(i,m,E){var R=E.getCurrentRowData();return(0,v.jsx)(g.Z,{disabled:!0,label:I.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:I.format("dataType"),render:function(i,m,E){var R=E.getCurrentRowData();return(0,v.jsx)(S.Z.Group,{label:I.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(P){return{label:I.format("dataTypeOption.".concat(P)),value:P}})})}},{name:"users",label:I.format("dataUsers"),render:function(i,m,E){return(0,v.jsx)(d.Z,{name:["type"],children:function(P){var Z=P.type;if(Z=="restricted")return(0,v.jsx)(_.Z,{width:"sm",mode:"tags",name:"users",label:I.format("dataUsers"),options:Y})}})}}]})})]})})});A.Z=k},3616:function(z,A,e){e.d(A,{Ed:function(){return T},FK:function(){return u},R_:function(){return B},ob:function(){return y}});var B=window.innerWidth<=1024?"90vw":"65vw",u="90vw",y="60vw",T="50vh"},24963:function(z,A,e){var B=e(67294),u=(0,B.createContext)({});A.Z=u},64312:function(z,A,e){e.r(A),e.d(A,{default:function(){return $}});var B=e(15009),u=e.n(B),y=e(99289),T=e.n(y),N=e(80821),L=e(77273),b=e(36435),f=e(83403),a=e(24963),j=e(87662),s=e(36146),n=e(86548),W=e(90078),l=e(78099),t=e(82346),d=e(28036),_=e(42075),g=e(96074),S=e(25593),p=e(83062),G=e(67294),r=e(85893);function $(){var h=(0,G.useRef)(),J=(0,G.useRef)(),H=(0,t.useModel)("@@initialState"),ee=H.initialState,ne=H.loading,_e=H.error,Q=H.refresh,v=H.setInitialState,k=(0,G.useContext)(a.Z),x=k.message,X=(0,t.useLocation)(),q=(0,t.useNavigate)(),w=new s.Uo("system.env");return(0,G.useEffect)(function(){var K=X.state;if(K&&K.item){var O;(O=J.current)===null||O===void 0||O.edit(K.item)}},[X.state]),(0,r.jsx)(W._z,{header:{extra:[(0,r.jsx)(L.Z,{trigger:(0,r.jsx)(d.ZP,{type:"primary",children:w.format("createButton")}),ref:J,onFinish:T()(u()().mark(function K(){var O,D,C;return u()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(C=X.state,!(C&&C.item)){o.next=6;break}return o.next=4,(0,j.vC)({name:C.item.name});case 4:return q(X.pathname,{replace:!0,state:null}),o.abrupt("return");case 6:Q(),!((O=h.current)===null||O===void 0)&&O.reloadAndRest&&((D=h.current)===null||D===void 0||D.reloadAndRest());case 8:case"end":return o.stop()}},K)}))},"dockerEnvCreate")]},children:(0,r.jsx)(l.Z,{rowKey:"name",columns:[{title:s.FD.format("listName"),dataIndex:"name"},{title:s.FD.format("listTitle"),dataIndex:"title"},{title:s.FD.format("listTargetAddress"),dataIndex:"address"},{title:s.FD.format("listManage"),width:100,search:!1,render:function(O,D,C,V,o){return(0,r.jsx)(_.Z,{split:(0,r.jsx)(g.Z,{type:"vertical"}),children:(0,r.jsx)(S.Z.Link,{onClick:function(){var Y;(Y=J.current)===null||Y===void 0||Y.edit(D)},children:(0,r.jsx)(p.Z,{title:s.FD.format("listManageEdit"),children:(0,r.jsx)(n.Z,{})})},D.name)})}}],pagination:!1,request:T()(u()().mark(function K(){var O;return u()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,j.Kg)();case 2:return O=C.sent,C.abrupt("return",{data:O.data.list,total:O.data.list.length});case 4:case"end":return C.stop()}},K)})),search:!1,rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:h,tableAlertOptionRender:function(O){var D=O.selectedRows,C=O.selectedRowKeys;return(0,r.jsxs)(_.Z,{size:16,children:[(0,r.jsx)(b.Z,{type:f.W6.DOCKER_ENV,selected:D,onSuccess:function(){var o,U;return!((o=h.current)===null||o===void 0)&&o.reloadAndRest&&((U=h.current)===null||U===void 0||U.reloadAndRest()),!0}},"permissionButton"),(0,r.jsx)(N.Z,{danger:!0,type:"primary",action:function(){return D.find(function(o){return o.default})?(x.warning(s.FD.format("systemEnvDefaultCannotDelete")),!1):(0,j._g)({name:C})},onSuccess:function(){var o,U;return!((o=h.current)===null||o===void 0)&&o.reloadAndRest&&((U=h.current)===null||U===void 0||U.reloadAndRest()),!0},onError:function(){var o,U;return!((o=h.current)===null||o===void 0)&&o.reset&&((U=h.current)===null||U===void 0||U.reset()),!0},confirm:"notification.confirm.title",children:s.FD.format("listManageDeleteBatch")})]})}})})}}}]);
