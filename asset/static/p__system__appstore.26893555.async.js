"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3917],{80821:function(K,j,e){e.d(j,{Z:function(){return F}});var P=e(5574),o=e.n(P),v=e(24963),g=e(86738),E=e(28036),A=e(83062),S=e(67294),f=e(85893);function F(r){var D=(0,S.useState)(!1),U=o()(D,2),Z=U[0],B=U[1],x=(0,S.useContext)(v.Z),C=x.lang,$=x.notice,i=x.message,a=function(){B(!0),r.action().then(function(t){if(B(!1),typeof r.onSuccess=="function"&&r.onSuccess(t),r.messageSuccess){var M="";typeof r.messageSuccess=="function"?M=r.messageSuccess(t):M=r.messageSuccess,M=C("notification.".concat(M))+C("notification.title.success"),r.asynced?i.info(M):i.success(M)}}).catch(function(t){B(!1),typeof r.onError=="function"&&r.onError(t)})};return r.confirm?(0,f.jsx)(g.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:C("notification.title.tip"),description:r.confirm,onConfirm:a,okText:"Yes",cancelText:"No",children:(0,f.jsx)(E.ZP,{disabled:r.disabled,icon:r.icon,loading:Z,danger:r.danger,type:r.type,children:r.children})}):(0,f.jsx)(A.Z,{title:r.tips,children:(0,f.jsx)(E.ZP,{disabled:r.disabled,icon:r.icon,loading:Z,onClick:a,danger:r.danger,type:r.type,children:r.children})})}},24963:function(K,j,e){var P=e(67294),o=(0,P.createContext)({});j.Z=o},29337:function(K,j,e){e.r(j),e.d(j,{default:function(){return ee}});var P=e(15009),o=e.n(P),v=e(99289),g=e.n(v),E=e(5574),A=e.n(E),S=e(24963),f=e(15078),F=e(184),r=e(5966),D=e(97462),U=e(86615),Z=e(62370),B=e(63713),x=e(28036),C=e(42075),$=e(25593),i=e(66309),a=e(67294),n=e(85893),t=(0,a.forwardRef)(function(m,z){var w=(0,a.useState)(!1),O=A()(w,2),h=O[0],u=O[1],R=(0,a.useRef)(),b=(0,a.useContext)(S.Z),c=b.message,y=b.notice,s=(0,B.useSearchParams)(),p=A()(s,2),ne=p[0],te=p[1];return(0,a.useImperativeHandle)(z,function(){return{edit:function(d){var l;(l=R.current)===null||l===void 0||l.setFieldsValue({title:d.title,name:d.name,type:d.setting.type,url:d.setting.url,id:d.id}),u(!0)}}}),(0,a.useEffect)(function(){ne.get("op")=="create"&&u(!0)},[]),(0,n.jsxs)(F.a,{name:"create",title:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97",open:h,onOpenChange:function(d){u(d)},drawerProps:{forceRender:!0},formRef:R,trigger:(0,n.jsx)(x.ZP,{type:"primary",children:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97"}),onFinish:function(){var L=g()(o()().mark(function d(l){var T,I,W;return o()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,f.ks)({name:l.name,url:l.url,type:l.type});case 2:if(T=_.sent,!(T&&T.data)){_.next=12;break}return _.next=6,(0,f.$c)({id:l.id,name:l.name,title:l.title,type:l.type,url:l.url,apps:T.data.list});case 6:if(I=_.sent,!(I&&I.data)){_.next=12;break}return c.success("\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\u6210\u529F"),m.onFinish&&m.onFinish(),(W=R.current)===null||W===void 0||W.resetFields(),_.abrupt("return",!0);case 12:case"end":return _.stop()}},d)}));return function(d){return L.apply(this,arguments)}}(),children:[(0,n.jsx)(r.Z,{name:"id",hidden:!0}),(0,n.jsx)(r.Z,{label:"\u540D\u79F0",name:"title",required:!0,rules:[{required:!0}],placeholder:"\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u5E94\u7528\u5546\u5E97"}),(0,n.jsx)(D.Z,{name:["id"],children:function(d){var l=d.id;return(0,n.jsx)(r.Z,{label:"\u6807\u8BC6",name:"name",required:!0,disabled:!!l,rules:[{required:!0}],placeholder:"\u6307\u5B9A\u5546\u5E97\u6807\u8BC6\uFF0C\u7528\u4E8E\u521B\u5EFA\u5546\u5E97\u6587\u4EF6\u5B58\u50A8\u76EE\u5F55"})}}),(0,n.jsx)(U.Z.Group,{name:"type",label:"\u5546\u5E97\u7C7B\u578B",valueEnum:{casaos:"casaos \u5E94\u7528\u5546\u5E97","1panel":"1panel \u5E94\u7528\u5546\u5E97"},fieldProps:{onChange:function(d){var l;(l=R.current)===null||l===void 0||l.resetFields(["url"])}}}),(0,n.jsx)(D.Z,{name:["type"],children:function(d){var l=d.type,T=[],I=[];if(l=="1panel"&&(I=["https://gitee.com/qyg2297248353/appstore-dpanel","https://github.com/1Panel-dev/appstore","https://github.com/okxlin/appstore"],T=[(0,n.jsx)(r.Z,{label:"\u4ED3\u5E93\u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B git \u4ED3\u5E93\u5730\u5740"},"gitUrl")]),l=="portainer"&&(T=[(0,n.jsx)(r.Z,{label:"template.json \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/Lissy93/portainer-templates/blob/main/templates.json"},"jsonUrl")]),l=="casaos"&&(I=["https://play.cuse.eu.org/Cp0204-AppStore-Play.zip"],T=[(0,n.jsx)(r.Z,{label:"zip \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B zip \u5730\u5740"},"zipUrl")]),l&&l!="")return[T,(0,n.jsx)(Z.Z,{label:(0,n.jsxs)(C.Z,{children:["\u63A8\u8350\u5546\u5E97",(0,n.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/setting/store?id=%e6%94%af%e6%8c%81%e7%b1%bb%e5%9e%8b",target:"_blank",children:"\u4E09\u65B9\u5546\u5E97\u63A5\u5165\u8BF4\u660E"})]}),children:(0,n.jsx)(C.Z,{wrap:!0,children:I.map(function(W,V){return(0,n.jsx)($.Z.Link,{onClick:function(){var G;(G=R.current)===null||G===void 0||G.setFieldValue("url",W)},children:(0,n.jsx)(i.Z,{color:"cyan",children:W})},V)})})},"recommend")]}})]})}),M=t,N=e(80821),J=e(67255),H=e(43425),Y=e(98165),Q=e(90078),X=e(10641),k=e(96074),q=e(83062);function ee(){var m=(0,a.useRef)(),z=(0,B.useAccess)(),w=(0,a.useRef)();return(0,n.jsx)(Q._z,{header:{extra:[z.canSeeFounder&&(0,n.jsx)(M,{ref:w,onFinish:function(){var h,u;!((h=m.current)===null||h===void 0)&&h.reloadAndRest&&((u=m.current)===null||u===void 0||u.reloadAndRest())}},"create")]},children:(0,n.jsx)(X.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,J.O)(),columns:[{title:"\u6807\u8BC6",dataIndex:"name",width:200},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u5730\u5740",width:500,search:!1,render:function(h,u,R,b,c){return(0,n.jsx)("a",{href:u.setting.url,target:"_blank",children:(0,n.jsx)(i.Z,{children:u.setting.url})})}},{title:"\u6700\u540E\u66F4\u65B0",render:function(h,u,R,b,c){if(u.setting.updatedAt)return new Date(u.setting.updatedAt*1e3).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(h,u,R,b,c){return(0,n.jsxs)(C.Z,{split:(0,n.jsx)(k.Z,{type:"vertical"}),children:[(0,n.jsx)($.Z.Link,{onClick:function(){var s;(s=w.current)===null||s===void 0||s.edit(u)},children:(0,n.jsx)(q.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(H.Z,{})})},"manage"),(0,n.jsx)(N.Z,{type:"link",icon:(0,n.jsx)(Y.Z,{}),action:function(){var s,p;return(0,f.ks)({id:u.id,name:u.name,url:(s=u.setting.url)!==null&&s!==void 0?s:"",type:(p=u.setting.type)!==null&&p!==void 0?p:""})},onSuccess:function(){var s,p;return!((s=m.current)===null||s===void 0)&&s.reloadAndRest&&((p=m.current)===null||p===void 0||p.reloadAndRest()),!0},onError:function(){var s,p;return!((s=m.current)===null||s===void 0)&&s.reloadAndRest&&((p=m.current)===null||p===void 0||p.reloadAndRest()),!0},messageSuccess:"upgrade",children:" "},"upgrade")]})}}],request:function(){var O=g()(o()().mark(function h(u,R,b){var c;return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,f.eO)({name:u.name,title:u.title});case 2:return c=s.sent,s.abrupt("return",{data:c.data.list,success:!0,total:c.data.list.length});case 4:case"end":return s.stop()}},h)}));return function(h,u,R){return O.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:m,tableAlertOptionRender:function(h){var u=h.selectedRowKeys,R=h.selectedRows;return(0,n.jsx)(C.Z,{size:16,children:(0,n.jsx)(N.Z,{danger:!0,type:"primary",action:function(){return(0,f.Me)({id:R.map(function(c){return c.id})})},onSuccess:function(){var c,y;return!((c=m.current)===null||c===void 0)&&c.reloadAndRest&&((y=m.current)===null||y===void 0||y.reloadAndRest()),!0},onError:function(){var c,y;return!((c=m.current)===null||c===void 0)&&c.reset&&((y=m.current)===null||y===void 0||y.reset()),!0},messageSuccess:"delete",children:"\u6279\u91CF\u5220\u9664"},"delete")})}})})}},15078:function(K,j,e){e.d(j,{$c:function(){return A},Me:function(){return B},eO:function(){return U},ks:function(){return f},yL:function(){return C}});var P=e(15009),o=e.n(P),v=e(99289),g=e.n(v),E=e(63713);function A(i){return S.apply(this,arguments)}function S(){return S=g()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,E.request)("/api/common/store/create",{method:"POST",data:a}));case 1:case"end":return t.stop()}},i)})),S.apply(this,arguments)}function f(i){return F.apply(this,arguments)}function F(){return F=g()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,E.request)("/api/common/store/sync",{method:"POST",data:a}));case 1:case"end":return t.stop()}},i)})),F.apply(this,arguments)}function r(i){return D.apply(this,arguments)}function D(){return D=_asyncToGenerator(_regeneratorRuntime().mark(function i(a){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:a}));case 1:case"end":return t.stop()}},i)})),D.apply(this,arguments)}function U(i){return Z.apply(this,arguments)}function Z(){return Z=g()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,E.request)("/api/common/store/get-list",{method:"POST",data:a}));case 1:case"end":return t.stop()}},i)})),Z.apply(this,arguments)}function B(i){return x.apply(this,arguments)}function x(){return x=g()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,E.request)("/api/common/store/delete",{method:"POST",data:a});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},i)})),x.apply(this,arguments)}function C(i){return $.apply(this,arguments)}function $(){return $=g()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,E.request)(a==null?void 0:a.path,{method:"GET"}));case 1:case"end":return t.stop()}},i)})),$.apply(this,arguments)}},67255:function(K,j,e){e.d(j,{O:function(){return P},j:function(){return o}});function P(){var v=localStorage.getItem("dpanel-pagesize");return v=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(v!=null?v:"20")}}function o(v){var g="dpanel-table-column-".concat(v),E={};if(localStorage.getItem(g)){var A;E=JSON.parse((A=localStorage.getItem(g))!==null&&A!==void 0?A:"{}")}return{defaultValue:E,onChange:function(f){localStorage.setItem("dpanel-table-column-".concat(v),JSON.stringify(f))}}}}}]);
