"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7745],{16664:function(x,E,e){e.d(E,{Z:function(){return b}});var D=e(87462),c=e(67294),M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},s=M,a=e(84089),p=function(i,d){return c.createElement(a.Z,(0,D.Z)({},i,{ref:d,icon:s}))},n=c.forwardRef(p),b=n},27619:function(x,E,e){e.d(E,{Z:function(){return b}});var D=e(97857),c=e.n(D),M=e(19632),s=e.n(M),a=e(64183),p=e(67294),n=e(85893);function b(r){var i,d=Math.max.apply(Math,s()(r.data.map(function(o){var P;return(P=o[r.yField])!==null&&P!==void 0?P:0}))),m={theme:"academy",xField:r.xField,yField:r.yField,height:200,axis:{y:{line:!0},x:{line:!0,grid:{visable:!0},labelAutoRotate:!0}},style:{opacity:.4},tooltip:{channel:"y",valueFormatter:r.yLabelFormatter},scale:{y:{domainMin:(i=r.yDomainMin)!==null&&i!==void 0?i:0,domainMax:r.yDomainMax?r.yDomainMax:r.yDomainMaxCallback?r.yDomainMaxCallback(d):d}},data:r.data};return r.yLabelFormatter&&(m.axis.y.labelFormatter=r.yLabelFormatter),r.colorField&&(m.colorField=r.colorField),(0,n.jsx)(a.Z,c()({},m))}},71890:function(x,E,e){var D=e(15009),c=e.n(D),M=e(99289),s=e.n(M),a=e(67294);function p(n){var b=n.reqFunction,r=n.interval,i=n.maxPolling,d=n.pollingStatus,m=n.inPath,o=(0,a.useRef)(null),P=0,f=function C(){o.current=window.setTimeout(s()(c()().mark(function T(){var l;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(P++>=i)){v.next=3;break}return j(),v.abrupt("return");case 3:if(v.prev=3,!(m&&window.location.href.indexOf(m)==-1)){v.next=7;break}return j(),v.abrupt("return");case 7:return v.next=9,b();case 9:l=v.sent,C(),v.next=17;break;case 13:v.prev=13,v.t0=v.catch(3),j(),console.error("\u8F6E\u8BE2\u53D1\u751F\u9519\u8BEF\uFF1A",v.t0);case 17:case"end":return v.stop()}},T,null,[[3,13]])})),r)},j=function(){console.log("end polling"),o.current&&window.clearTimeout(o.current)};return(0,a.useEffect)(function(){return console.log((d?"start":"waiting")+" polling, max "+i),d&&f(),function(){j()}},[r,i,d]),{endPolling:j}}E.Z=p},11386:function(x,E,e){e.r(E),e.d(E,{default:function(){return k}});var D=e(15009),c=e.n(D),M=e(99289),s=e.n(M),a=e(5574),p=e.n(a),n=e(19632),b=e.n(n),r=e(27619),i=e(71890),d=e(84410),m=e(5251),o=e(12122),P=e(16664),f=e(38345),j=e(54006),C=e(63490),T=e(67294),l=e(85893),O=new Date().toLocaleTimeString(),v={total:0,memory:[{date:O,usage:0,source:{usage:0,limit:0}}],cpu:[{date:O,usage:0}],network:[{usage:0,type:"rx",date:O,source:{usage:0}},{usage:0,type:"tx",date:O,source:{usage:0}}],io:[{usage:0,type:"read",date:O,source:{usage:0}},{usage:0,type:"write",date:O,source:{usage:0}}]};function k(){var S=function(_,t){switch(t.type){case"update":var h=new Date(t.payload.read).toLocaleTimeString(),y=t.payload.cpu_stats.cpu_usage.total_usage-t.payload.precpu_stats.cpu_usage.total_usage,W=t.payload.cpu_stats.system_cpu_usage-t.payload.precpu_stats.system_cpu_usage,F=0,N=0;t.payload.blkio_stats.io_service_bytes_recursive||(t.payload.blkio_stats.io_service_bytes_recursive=[{value:0,op:"read",major:0,minor:0},{value:0,op:"write",major:0,minor:0}]),t.payload.blkio_stats.io_service_bytes_recursive.map(function(I){I.op=="read"&&(F=I.value),I.op=="write"&&(N=I.value)});var K={total:_.total+1,memory:[].concat(b()(_.memory),[{date:h,usage:Math.round(t.payload.memory_stats.usage),source:{usage:t.payload.memory_stats.usage,limit:t.payload.memory_stats.limit}}]),cpu:[].concat(b()(_.cpu),[{date:h,usage:y/W*t.payload.cpu_stats.online_cpus*100}]),io:[].concat(b()(_.io),[{date:h,usage:parseFloat(t.payload.blkio_stats.io_service_bytes_recursive[0].value.toFixed(2)),type:t.payload.blkio_stats.io_service_bytes_recursive[0].op,source:{usage:t.payload.blkio_stats.io_service_bytes_recursive[0].value}},{date:h,usage:parseFloat(t.payload.blkio_stats.io_service_bytes_recursive[1].value.toFixed(2)),type:t.payload.blkio_stats.io_service_bytes_recursive[1].op,source:{usage:t.payload.blkio_stats.io_service_bytes_recursive[1].value}}]),network:[]};return t.payload.networks&&(K.network=[].concat(b()(_.network),[{date:h,usage:parseFloat(t.payload.networks.eth0.rx_bytes.toFixed(2)),type:"rx",source:{usage:t.payload.networks.eth0.rx_bytes}},{date:h,usage:parseFloat(t.payload.networks.eth0.tx_bytes.toFixed(2)),type:"tx",source:{usage:t.payload.networks.eth0.tx_bytes}}])),K}},L=(0,j.useParams)(),Z=(0,T.useReducer)(S,v),R=p()(Z,2),u=R[0],w=R[1],z=(0,T.useState)(0),A=p()(z,2),$=A[0],G=A[1],H=(0,T.useState)(),B=p()(H,2),U=B[0],Y=B[1],J=(0,i.Z)({reqFunction:function(){var g=s()(c()().mark(function t(){var h,y;return c()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,d.i)({id:(h=L.id)!==null&&h!==void 0?h:""});case 2:y=F.sent,w({type:"update",payload:y});case 4:case"end":return F.stop()}},t)}));function _(){return g.apply(this,arguments)}return _}(),interval:3e3,maxPolling:999,pollingStatus:$!=0,inPath:"tab=stat"});return(0,T.useEffect)(function(){var g,_;(0,d.i)({id:(g=L.id)!==null&&g!==void 0?g:""}).then(function(t){return G(Math.round(t.memory_stats.limit)),!0}),(0,d.a)({id:(_=L.id)!==null&&_!==void 0?_:""}).then(function(t){var h={columns:[],data:[]};t.data.list.Titles.map(function(y){h.columns.push({title:y,label:y,dataIndex:y})}),t.data.list.Processes.map(function(y,W){h.data.push({UID:y[0],PID:y[1],PPID:y[2],C:y[3],STIME:y[4],TTY:y[5],TIME:y[6],CMD:y[7]})}),Y(h)})},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(f.Z,{direction:"row",wrap:!0,gutter:[20,20],children:[(0,l.jsx)(f.Z,{colSpan:12,title:(0,l.jsx)(o.Z,{}),subTitle:"Memory usage: ".concat((0,m.FI)(u.memory[u.memory.length-1].source.usage)," / ").concat((0,m.FI)(u.memory[u.memory.length-1].source.limit)),headerBordered:!0,bordered:!0,children:(0,l.jsx)(r.Z,{yField:"usage",xField:"date",data:u.memory,yDomainMaxCallback:function(_){return _*2},yLabelFormatter:function(_){return(0,m.FI)(parseFloat(_))}})}),(0,l.jsx)(f.Z,{colSpan:12,title:(0,l.jsx)(o.Z,{}),subTitle:"Cpu usage: ".concat(u.cpu[u.cpu.length-1].usage.toFixed(2),"%"),headerBordered:!0,bordered:!0,children:(0,l.jsx)(r.Z,{yField:"usage",xField:"date",data:u.cpu,yDomainMaxCallback:function(_){return _*1.5},yLabelFormatter:function(_){return"".concat(_,"%")}})}),(0,l.jsx)(f.Z,{colSpan:12,title:(0,l.jsx)(o.Z,{}),subTitle:"I/O: ".concat((0,m.FI)(u.io[u.io.length-1].source.usage)," / ").concat((0,m.FI)(u.io[u.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,l.jsx)(r.Z,{yField:"usage",xField:"date",colorField:"type",data:u.io,yDomainMaxCallback:function(_){return _*2},yLabelFormatter:function(_){return(0,m.FI)(parseFloat(_))}})}),u.network&&u.network.length>0&&(0,l.jsx)(f.Z,{colSpan:12,title:(0,l.jsx)(o.Z,{}),subTitle:"Network: ".concat((0,m.FI)(u.network[u.io.length-1].source.usage)," / ").concat((0,m.FI)(u.network[u.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,l.jsx)(r.Z,{yField:"usage",xField:"date",colorField:"type",data:u.network,yDomainMaxCallback:function(_){return _*2},yLabelFormatter:function(_){return(0,m.FI)(parseFloat(_))}})})]}),(0,l.jsx)(f.Z,{title:(0,l.jsx)(P.Z,{}),subTitle:"Progress",children:(0,l.jsx)(C.Z,{scroll:{x:"max-content"},rowKey:"PID",columns:U==null?void 0:U.columns,dataSource:U==null?void 0:U.data,pagination:{pageSize:10}})})]})}},84410:function(x,E,e){e.d(E,{a:function(){return b},i:function(){return p}});var D=e(15009),c=e.n(D),M=e(99289),s=e.n(M),a=e(54006);function p(i){return n.apply(this,arguments)}function n(){return n=s()(c()().mark(function i(d){return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,a.request)("/api/app/container/get-stat-info",{method:"POST",data:d}));case 1:case"end":return o.stop()}},i)})),n.apply(this,arguments)}function b(i){return r.apply(this,arguments)}function r(){return r=s()(c()().mark(function i(d){return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,a.request)("/api/app/container/get-process-info",{method:"POST",data:d}));case 1:case"end":return o.stop()}},i)})),r.apply(this,arguments)}},5251:function(x,E,e){e.d(E,{FI:function(){return c},ZM:function(){return M}});function D(s){return s.trim()}function c(s){var a="";s<.1*1024?a=s.toFixed(2)+"B":s<.1*1024*1024?a=(s/1024).toFixed(2)+"KB":s<1*1024*1024*1024?a=(s/(1024*1024)).toFixed(2)+"MB":a=(s/(1024*1024*1024)).toFixed(2)+"GB";var p=a+"",n=p.indexOf("."),b=p.substr(n+1,2);return b=="00"?p.substring(0,n)+p.substr(n+3,2):a}function M(s){if(s){var a=new Date(s),p=a.getFullYear()+"-",n=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",b=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ",r=(a.getHours()<10?"0"+a.getHours():a.getHours())+":",i=(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":",d=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds();return p+n+b+r+i+d}}}}]);
