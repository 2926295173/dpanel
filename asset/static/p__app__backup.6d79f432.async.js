"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[550],{94359:function($,Z,e){e.d(Z,{Z:function(){return H}});var T=e(5574),s=e.n(T),y=e(3089),c=e(98165),g=e(18429),a=e(8751),O=e(66212),j=e(14313),C=e(30159),d=e(87740),D=e(50888),_=e(66309),W=e(83062),k=e(36146),o=e(85893);function H(u){var n,R,L=new k.Uo("components.containerStatus"),r=u.status.split("."),K=s()(r,2),te=K[0],f=K[1],v="";v=L.format(u.status,(n=u.statusValue)!==null&&n!==void 0?n:{});var h=(0,o.jsx)(o.Fragment,{});return f=="0"&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(y.Z,{}),color:"default",children:v})),f=="10"&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(c.Z,{spin:!0}),color:"processing",children:v})),f=="20"&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(g.Z,{}),color:"error",children:v})),f=="30"&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(a.Z,{}),color:"success",children:v})),f=="new"&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(O.Z,{}),children:v})),(f=="running"||f=="healthy"||f=="active"||f=="ready")&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(j.Z,{}),color:"success",children:v})),(f=="paused"||f=="pause"||f=="rollback_paused")&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(C.Z,{}),color:"warning",children:v})),(f=="waiting"||f=="starting"||f=="accepted")&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(d.Z,{}),children:v})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(f)&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(D.Z,{}),color:"processing",children:v})),(f=="error"||f=="down"||f=="failed")&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(g.Z,{}),color:"error",children:v})),["complete","completed","rollback_completed"].includes(f)&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(a.Z,{}),color:"success",children:v})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(f)&&(h=(0,o.jsx)(_.Z,{icon:(0,o.jsx)(g.Z,{}),color:"warning",children:v})),(0,o.jsx)(W.Z,{placement:"top",title:(R=u.tip)!==null&&R!==void 0?R:"",children:h})}},76428:function($,Z,e){e.d(Z,{Z:function(){return c}});var T=e(25593),s=e(67294),y=e(85893);function c(g){return(0,y.jsx)(T.Z.Text,{copyable:!0,children:g.title})}},51100:function($,Z,e){e.d(Z,{Z:function(){return g}});var T=e(4813),s=e(91604),y=e(1677),c=e(85893);function g(a){return a.showDragger?(0,c.jsx)(s.Z,{max:a.max?a.max:1,title:a.title,label:a.label,required:a.required,rules:[{required:a.required}],fieldProps:{multiple:!!(a.max&&a.max>1),name:"file",accept:a.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(j){return new Promise(function(C){var d;(0,T._)({path:(d=j.response.data.path)!==null&&d!==void 0?d:""}).then(function(D){C(!0)})})},onChange:function(j){j.file.status=="done"&&a.onFinish&&a.onFinish(j.fileList)}},name:a.name}):(0,c.jsx)(y.Z,{max:a.max?a.max:1,title:a.title,label:a.label,required:a.required,rules:[{required:a.required}],fieldProps:{multiple:!!(a.max&&a.max>1),name:"file",accept:a.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(j){return new Promise(function(C){var d;(0,T._)({path:(d=j.response.data.path)!==null&&d!==void 0?d:""}).then(function(D){C(!0)})})},onChange:function(j){j.file.status=="done"&&a.onFinish&&a.onFinish(j.fileList)}},name:a.name})}},3616:function($,Z,e){e.d(Z,{Ed:function(){return c},FK:function(){return s},R_:function(){return T},ob:function(){return y}});var T=window.innerWidth<=1024?"90vw":"65vw",s="90vw",y="60vw",c="50vh"},65913:function($,Z,e){var T=e(5574),s=e.n(T),y=e(74330),c=e(67294),g=e(85893),a=(0,c.forwardRef)(function(O,j){(0,c.useImperativeHandle)(j,function(){return{show:function(){_(!0)},destroy:function(){_(!1)}}});var C=(0,c.useState)(!1),d=s()(C,2),D=d[0],_=d[1];return(0,g.jsx)(y.Z,{spinning:D,size:"default",children:O.children})});Z.Z=a},6091:function($,Z,e){e.r(Z),e.d(Z,{default:function(){return ge}});var T=e(15009),s=e.n(T),y=e(99289),c=e.n(y),g=e(37476),a=e(86615),O=e(97462),j=e(5966),C=e(83622),d=e(67294),D=e(1699),_=e(82346);function W(I){return k.apply(this,arguments)}function k(){return k=c()(s()().mark(function I(F){return s()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,_.request)("/api/pro/container-backup/import",{data:F,method:"POST"});case 2:return x.abrupt("return",x.sent);case 3:case"end":return x.stop()}},I)})),k.apply(this,arguments)}var o=e(3616),H=e(51100),u=e(36146),n=e(85893),R=(0,d.forwardRef)(function(I,F){(0,d.useImperativeHandle)(F,function(){return{}});var N=(0,d.useRef)(),x=new u.Uo("components.appDetail");return(0,n.jsx)(D.u,{showProTips:!0,access:["canSeeEnableCe","canSeeEnableDockerEnvLocal"],children:function(b){var P=b.canSeeEnableCe,i=b.canSeeEnableDockerEnvLocal;return i&&(0,n.jsxs)(g.Y,{modalProps:{width:o.ob},onFinish:function(){var M=c()(s()().mark(function E(p){var l,t,B;return s()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return l=p.tarFilePath,p.tarFileUpload&&p.tarFileUpload.length>0&&(l=(t=p.tarFileUpload[0].response.data.path)!==null&&t!==void 0?t:""),U.next=4,W({type:p.type,tarFilePath:l});case 4:return B=U.sent,I.onFinish&&I.onFinish(),U.abrupt("return",!0);case 7:case"end":return U.stop()}},E)}));return function(E){return M.apply(this,arguments)}}(),title:x.format("backupImportTitle"),formRef:N,trigger:(0,n.jsx)(C.ZP,{disabled:P,type:"primary",children:x.format("backupImportTitle")}),onOpenChange:function(){var E;(E=N.current)===null||E===void 0||E.resetFields()},children:[(0,n.jsx)(a.Z.Group,{label:x.format("backupImportType"),name:"type",initialValue:"upload",options:x.option("backupImportTypeOption",["upload"])}),(0,n.jsx)(O.Z,{name:["type"],children:function(E){var p=E.type;if(p=="upload")return(0,n.jsx)(H.Z,{required:!0,label:x.format("backupImportTarFileUpload"),name:"tarFileUpload",accept:".snapshot"});if(p=="serverPath")return(0,n.jsx)(j.Z,{required:!0,rules:[{required:!0}],name:"tarFilePath",label:x.format("backupImportTarFilePath")})}})]})}})}),L=R,r=e(5574),K=e.n(r),te=e(65913),f=e(85265),v=e(26412),h=e(42075),Y=e(96074),w=e(25593),re=e(66309),V=e(2487),Q=e(70146),J=e(5251),ie=e(45605),le=e(58638),ue=e(38345),ce=e(76428),de=(0,d.forwardRef)(function(I,F){(0,d.useImperativeHandle)(F,function(){return{show:function(B){return c()(s()().mark(function S(){var U;return s()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,Q.iD)({id:B});case 2:U=m.sent,P(U.data.detail),p(!0);case 5:case"end":return m.stop()}},S)}))()}}});var N=(0,d.useRef)(),x=(0,d.useState)(),z=K()(x,2),b=z[0],P=z[1],i=(0,d.useState)(!1),M=K()(i,2),E=M[0],p=M[1],l=new u.Uo("components.appDetail");return(0,n.jsx)(f.Z,{title:l.format("titleBackup"),open:E,onClose:function(){p(!1)},width:o.R_,children:(0,n.jsx)(te.Z,{ref:N,children:b&&b.map(function(t){var B,S,U=[],q=[];return t.NetworkSettings&&t.NetworkSettings.Ports&&Object.entries(t.NetworkSettings.Ports).map(function(m){var A=K()(m,2),G=A[0],ee=A[1],je=ee!=null?ee:[{HostPort:null,HostIp:""}],Ee=G.split("/"),ae=K()(Ee,2),se=ae[0],oe=ae[1];je.map(function(ne){ne.HostPort?U.push({PrivatePort:se,Type:oe,IP:ne.HostIp,PublicPort:ne.HostPort}):q.push({PrivatePort:se,Type:oe,IP:"",PublicPort:""})})}),(0,n.jsx)(ue.Z,{title:(0,n.jsx)(ie.Z,{}),subTitle:l.format("titleBasic"),ghost:!0,children:(0,n.jsxs)(v.Z,{column:1,bordered:!0,children:[(0,n.jsx)(v.Z.Item,{label:u.FD.format("listName"),children:(0,n.jsx)(h.Z,{split:(0,n.jsx)(Y.Z,{type:"vertical"}),children:(0,n.jsx)(w.Z.Text,{children:(0,J.fi)(t.Name,"/")})})}),(0,n.jsx)(v.Z.Item,{label:u.FD.format("listImageName"),children:(0,n.jsxs)(h.Z,{split:(0,n.jsx)(Y.Z,{type:"vertical"}),children:[(0,n.jsx)(w.Z.Text,{copyable:!0,children:t.Config.Image}),(0,n.jsx)(re.Z,{color:"blue",children:t.EnableImage?u.FD.format("listHas"):u.FD.format("listHasNot")})]})}),(0,n.jsx)(v.Z.Item,{label:u.FD.format("listPort"),children:(0,n.jsx)(h.Z,{size:"large",wrap:!0,children:[].concat(U,q).map(function(m,A){return(0,n.jsx)(re.Z,{color:m.PublicPort?"#2db7f5":"warning",icon:m.PublicPort?(0,n.jsx)(le.Z,{}):"",style:{marginBottom:10,marginRight:15,width:210},children:m.PublicPort?"".concat(m.PublicPort?m.IP+":"+m.PublicPort+" -> ":"").concat(m.PrivatePort,"/").concat(m.Type):"".concat(m.PrivatePort,"/").concat(m.Type)},A)})},"space")}),t.State.Running&&t.NetworkSettings.Networks&&Object.keys(t.NetworkSettings.Networks).map(function(m,A){return(0,n.jsx)(v.Z.Item,{label:m,children:m=="host"?u.FD.format("listNetworkUseHost"):(0,n.jsxs)(h.Z,{direction:"vertical",children:[(0,n.jsx)(ce.Z,{title:t.NetworkSettings.Networks[m].IPAddress}),t.NetworkSettings.Networks[m].Gateway,t.NetworkSettings.Networks[m].MacAddress]})},A)}),(0,n.jsx)(v.Z.Item,{label:u.FD.format("listEnv"),children:(0,n.jsx)(V.Z,{dataSource:(B=t.Config.Env)!==null&&B!==void 0?B:[],renderItem:function(A){var G=A.split("=");return(0,n.jsxs)(V.Z.Item,{children:[(0,n.jsx)(w.Z.Text,{code:!0,children:G[0]})," = ",(0,n.jsx)(w.Z.Text,{copyable:!0,children:G.slice(1).join("=")})]},G[0])}})}),t.Mounts&&t.Mounts.length>0&&(0,n.jsx)(v.Z.Item,{label:u.FD.format("listHostPath"),children:(0,n.jsx)(V.Z,{dataSource:(S=t.Mounts)!==null&&S!==void 0?S:[],renderItem:function(A){return(0,n.jsxs)(V.Z.Item,{children:[(0,n.jsx)(w.Z.Text,{code:!0,children:A.Source})," : ",(0,n.jsx)(w.Z.Text,{children:A.Destination})]},A.Source)}})})]})},t.Name)})})})}),me=de,X=e(80821),pe=e(94359),fe=e(98510),he=e(87740),_e=e(87784),ve=e(82061),Pe=e(74453);function ge(){var I=(0,d.useRef)(),F=(0,_.useAccess)(),N=(0,_.useModel)("subscriber"),x=(0,d.useRef)(),z=new u.Uo("app");return(0,n.jsxs)(Pe._z,{header:{extra:[(0,n.jsx)(L,{onFinish:function(){var P;!((P=I.current)===null||P===void 0)&&P.reloadAndRest&&I.current.reloadAndRest()}},"backup-import")]},children:[(0,n.jsx)(me,{ref:x}),(0,n.jsx)(fe.C,{rowKey:"id",columns:[{title:u.FD.format("listContainerName"),dataIndex:"containerId",width:150,render:function(P,i,M,E,p){return(0,n.jsx)(w.Z.Link,{onClick:function(){var t;(t=x.current)===null||t===void 0||t.show(i.id)},children:(0,J.fi)(i.containerId,"/")})}},{title:u.FD.format("listFilePath"),search:!1,width:300,render:function(P,i,M,E,p){var l=i.setting.backupTar;return(0,n.jsx)("span",{style:{wordBreak:"break-word"},children:l.substring(l.lastIndexOf("/",l.lastIndexOf("/")-1))})}},{title:u.FD.format("listSize"),search:!1,width:100,render:function(P,i,M,E,p){return i.setting.size?(0,n.jsx)(w.Z.Text,{children:(0,J.FI)(i.setting.size)}):"-"}},{title:u.FD.format("listContainerVolume"),search:!1,minWidth:100,render:function(P,i,M,E,p){return(0,n.jsx)(h.Z,{wrap:!0,children:i.setting.volumePathList.map(function(l){return l})})}},{title:u.FD.format("listStatus"),search:!1,width:80,render:function(P,i,M,E,p){var l,t;return(0,n.jsx)(pe.Z,{tip:(l=i.setting.error)!==null&&l!==void 0?l:"",status:"status.".concat((t=i.setting.status)!==null&&t!==void 0?t:"30")},i.id)}},{title:u.FD.format("listCreatedAt"),search:!1,width:200,render:function(P,i,M,E,p){return new Date(i.createdAt).toLocaleString()}},{title:u.FD.format("listManage"),search:!1,width:100,fixed:"right",hidden:!F.canSeeContainerBackupManage,render:function(P,i,M,E,p){return(0,n.jsxs)(h.Z,{split:(0,n.jsx)(Y.Z,{}),children:[i.setting.status=="30"&&(0,n.jsx)(X.Z,{buttonProps:{ghost:!0,type:"link",icon:(0,n.jsx)(he.Z,{})},confirmProps:{description:(0,n.jsx)(h.Z,{style:{width:300},children:z.format("backupRestoreConfirm")})},tips:u.FD.format("listManageUnpause"),action:function(){return(0,Q.SR)({id:i.id,enableForce:!1})}}),i.setting.status=="10"&&(0,n.jsx)(X.Z,{buttonProps:{danger:!0,ghost:!0,type:"link",icon:(0,n.jsx)(_e.Z,{})},action:c()(s()().mark(function l(){return s()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return N.progress.close("container:backup:".concat(i.id)),setTimeout(function(){var S;!((S=I.current)===null||S===void 0)&&S.reloadAndRest&&I.current.reloadAndRest()},500),B.abrupt("return",!1);case 3:case"end":return B.stop()}},l)}))})]})}}],request:function(){var b=c()(s()().mark(function P(i,M,E){var p;return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,Q.Zy)({containerId:i.containerId,page:i.current,pageSize:i.pageSize});case 2:return p=t.sent,t.abrupt("return",{data:p.data.list,success:!0,total:p.data.total});case 4:case"end":return t.stop()}},P)}));return function(P,i,M){return b.apply(this,arguments)}}(),rowSelection:F.canSeeContainerBackupManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:I,quickToolbarRender:function(P){var i=P.selectedRows,M=P.finish,E=P.loading;return(0,n.jsx)(h.Z,{size:16,children:(0,n.jsx)(X.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,n.jsx)(ve.Z,{})},confirmProps:{showCommonConfirm:!0},action:function(){return E(),(0,Q.VE)({id:i.map(function(l){return l.id})}).finally(function(){M(!0)})},onSuccess:function(){var l,t;return!((l=I.current)===null||l===void 0)&&l.reloadAndRest&&((t=I.current)===null||t===void 0||t.reloadAndRest()),!0},onError:function(){var l,t;return!((l=I.current)===null||l===void 0)&&l.reset&&((t=I.current)===null||t===void 0||t.reset()),!0},children:u.FD.format("listManageDeleteBatch")},"batchDelete")})}})]})}},70146:function($,Z,e){e.d(Z,{SR:function(){return _},VE:function(){return d},Zy:function(){return j},iD:function(){return k},vG:function(){return H},yB:function(){return a}});var T=e(15009),s=e.n(T),y=e(99289),c=e.n(y),g=e(82346);function a(n){return O.apply(this,arguments)}function O(){return O=c()(s()().mark(function n(R){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,g.request)("/api/app/container-backup/create",{data:R,method:"POST"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},n)})),O.apply(this,arguments)}function j(n){return C.apply(this,arguments)}function C(){return C=c()(s()().mark(function n(R){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,g.request)("/api/app/container-backup/get-list",{method:"POST",data:R}));case 1:case"end":return r.stop()}},n)})),C.apply(this,arguments)}function d(n){return D.apply(this,arguments)}function D(){return D=c()(s()().mark(function n(R){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,g.request)("/api/app/container-backup/delete",{method:"POST",data:R}));case 1:case"end":return r.stop()}},n)})),D.apply(this,arguments)}function _(n){return W.apply(this,arguments)}function W(){return W=c()(s()().mark(function n(R){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,g.request)("/api/app/container-backup/restore",{method:"POST",data:R}));case 1:case"end":return r.stop()}},n)})),W.apply(this,arguments)}function k(n){return o.apply(this,arguments)}function o(){return o=c()(s()().mark(function n(R){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,g.request)("/api/app/container-backup/get-detail",{method:"POST",data:R}));case 1:case"end":return r.stop()}},n)})),o.apply(this,arguments)}function H(n){return u.apply(this,arguments)}function u(){return u=c()(s()().mark(function n(R){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,g.request)("/api/app/site/restore",{data:R,method:"POST"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},n)})),u.apply(this,arguments)}},4813:function($,Z,e){e.d(Z,{_:function(){return a}});var T=e(15009),s=e.n(T),y=e(99289),c=e.n(y),g=e(82346);function a(j){return O.apply(this,arguments)}function O(){return O=c()(s()().mark(function j(C){return s()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,g.request)("/api/common/attach/delete",{method:"POST",data:C});case 2:return D.abrupt("return",D.sent);case 3:case"end":return D.stop()}},j)})),O.apply(this,arguments)}}}]);
