"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7745],{16664:function(x,g,e){e.d(g,{Z:function(){return v}});var h=e(87462),i=e(67294),P={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},n=P,a=e(84089),m=function(d,y){return i.createElement(a.Z,(0,h.Z)({},d,{ref:y,icon:n}))},o=i.forwardRef(m),v=o},27619:function(x,g,e){e.d(g,{Z:function(){return v}});var h=e(97857),i=e.n(h),P=e(19632),n=e.n(P),a=e(64183),m=e(67294),o=e(85893);function v(_){var d,y=Math.max.apply(Math,n()(_.data.map(function(s){var f;return(f=s[_.yField])!==null&&f!==void 0?f:0}))),M={theme:"academy",xField:_.xField,yField:_.yField,height:200,axis:{y:{line:!0},x:{line:!0,grid:{visable:!0},labelAutoRotate:!0}},style:{opacity:.4},tooltip:{channel:"y",valueFormatter:_.yLabelFormatter},scale:{y:{domainMin:(d=_.yDomainMin)!==null&&d!==void 0?d:0,domainMax:_.yDomainMax?_.yDomainMax:_.yDomainMaxCallback?_.yDomainMaxCallback(y):y}},data:_.data};return _.yLabelFormatter&&(M.axis.y.labelFormatter=_.yLabelFormatter),_.colorField&&(M.colorField=_.colorField),(0,o.jsx)(a.Z,i()({},M))}},71890:function(x,g,e){var h=e(15009),i=e.n(h),P=e(99289),n=e.n(P),a=e(67294);function m(o){var v=o.reqFunction,_=o.interval,d=o.maxPolling,y=o.pollingStatus,M=o.inPath,s=(0,a.useRef)(null),f=0,U=function F(){s.current=window.setTimeout(n()(i()().mark(function I(){var O;return i()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(f++>=d)){u.next=3;break}return D(),u.abrupt("return");case 3:if(u.prev=3,!(M&&window.location.href.indexOf(M)==-1)){u.next=7;break}return D(),u.abrupt("return");case 7:return u.next=9,v();case 9:O=u.sent,F(),u.next=17;break;case 13:u.prev=13,u.t0=u.catch(3),D(),console.error("\u8F6E\u8BE2\u53D1\u751F\u9519\u8BEF\uFF1A",u.t0);case 17:case"end":return u.stop()}},I,null,[[3,13]])})),_)},D=function(){console.log("end polling"),s.current&&window.clearTimeout(s.current)};return(0,a.useEffect)(function(){return console.log((y?"start":"waiting")+" polling, max "+d),y&&U(),function(){D()}},[_,d,y]),{endPolling:D}}g.Z=m},24963:function(x,g,e){var h=e(67294),i=(0,h.createContext)({});g.Z=i},11386:function(x,g,e){e.r(g),e.d(g,{default:function(){return Z}});var h=e(15009),i=e.n(h),P=e(99289),n=e.n(P),a=e(5574),m=e.n(a),o=e(19632),v=e.n(o),_=e(27619),d=e(71890),y=e(24963),M=e(84410),s=e(5251),f=e(12122),U=e(16664),D=e(38345),F=e(54006),I=e(63490),O=e(67294),c=e(85893),u=new Date().toLocaleTimeString(),S={total:0,memory:[{date:u,usage:0,source:{usage:0,limit:0}}],cpu:[{date:u,usage:0}],network:[{usage:0,type:"rx",date:u,source:{usage:0}},{usage:0,type:"tx",date:u,source:{usage:0}}],io:[{usage:0,type:"read",date:u,source:{usage:0}},{usage:0,type:"write",date:u,source:{usage:0}}]};function Z(){var w=function(r,t){switch(t.type){case"update":var E=new Date(t.payload.read).toLocaleTimeString(),p=t.payload.cpu_stats.cpu_usage.total_usage-t.payload.precpu_stats.cpu_usage.total_usage,W=t.payload.cpu_stats.system_cpu_usage-t.payload.precpu_stats.system_cpu_usage,j=0,V=0;t.payload.blkio_stats.io_service_bytes_recursive||(t.payload.blkio_stats.io_service_bytes_recursive=[{value:0,op:"read",major:0,minor:0},{value:0,op:"write",major:0,minor:0}]),t.payload.blkio_stats.io_service_bytes_recursive.map(function(T){T.op=="read"&&(j=T.value),T.op=="write"&&(V=T.value)});var k={total:r.total+1,memory:[].concat(v()(r.memory),[{date:E,usage:Math.round(t.payload.memory_stats.usage),source:{usage:t.payload.memory_stats.usage,limit:t.payload.memory_stats.limit}}]),cpu:[].concat(v()(r.cpu),[{date:E,usage:p/W*t.payload.cpu_stats.online_cpus*100}]),io:[].concat(v()(r.io),[{date:E,usage:parseFloat(t.payload.blkio_stats.io_service_bytes_recursive[0].value.toFixed(2)),type:t.payload.blkio_stats.io_service_bytes_recursive[0].op,source:{usage:t.payload.blkio_stats.io_service_bytes_recursive[0].value}},{date:E,usage:parseFloat(t.payload.blkio_stats.io_service_bytes_recursive[1].value.toFixed(2)),type:t.payload.blkio_stats.io_service_bytes_recursive[1].op,source:{usage:t.payload.blkio_stats.io_service_bytes_recursive[1].value}}]),network:[]};return t.payload.networks&&(k.network=[].concat(v()(r.network),[{date:E,usage:parseFloat(t.payload.networks.eth0.rx_bytes.toFixed(2)),type:"rx",source:{usage:t.payload.networks.eth0.rx_bytes}},{date:E,usage:parseFloat(t.payload.networks.eth0.tx_bytes.toFixed(2)),type:"tx",source:{usage:t.payload.networks.eth0.tx_bytes}}])),k}},z=(0,O.useContext)(y.Z),R=z.loading,L=(0,F.useParams)(),$=(0,O.useReducer)(w,S),A=m()($,2),l=A[0],G=A[1],H=(0,O.useState)(0),B=m()(H,2),Y=B[0],N=B[1],J=(0,O.useState)(),K=m()(J,2),C=K[0],Q=K[1],X=(0,d.Z)({reqFunction:function(){var b=n()(i()().mark(function t(){var E,p;return i()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,M.i)({id:(E=L.id)!==null&&E!==void 0?E:""});case 2:p=j.sent,R.destroy(),G({type:"update",payload:p});case 5:case"end":return j.stop()}},t)}));function r(){return b.apply(this,arguments)}return r}(),interval:3e3,maxPolling:999,pollingStatus:Y!=0,inPath:"tab=stat"});return(0,O.useEffect)(function(){var b,r;R.show(),(0,M.i)({id:(b=L.id)!==null&&b!==void 0?b:""}).then(function(t){return N(Math.round(t.memory_stats.limit)),!0}),(0,M.a)({id:(r=L.id)!==null&&r!==void 0?r:""}).then(function(t){var E={columns:[],data:[]};t.data.list.Titles.map(function(p){E.columns.push({title:p,label:p,dataIndex:p})}),t.data.list.Processes.map(function(p,W){E.data.push({UID:p[0],PID:p[1],PPID:p[2],C:p[3],STIME:p[4],TTY:p[5],TIME:p[6],CMD:p[7]})}),Q(E)})},[]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(D.Z,{direction:"row",wrap:!0,gutter:[20,20],children:[(0,c.jsx)(D.Z,{colSpan:12,title:(0,c.jsx)(f.Z,{}),subTitle:"Memory usage: ".concat((0,s.FI)(l.memory[l.memory.length-1].source.usage)," / ").concat((0,s.FI)(l.memory[l.memory.length-1].source.limit)),headerBordered:!0,bordered:!0,children:(0,c.jsx)(_.Z,{yField:"usage",xField:"date",data:l.memory,yDomainMaxCallback:function(r){return r*2},yLabelFormatter:function(r){return(0,s.FI)(parseFloat(r))}})}),(0,c.jsx)(D.Z,{colSpan:12,title:(0,c.jsx)(f.Z,{}),subTitle:"Cpu usage: ".concat(l.cpu[l.cpu.length-1].usage.toFixed(2),"%"),headerBordered:!0,bordered:!0,children:(0,c.jsx)(_.Z,{yField:"usage",xField:"date",data:l.cpu,yDomainMaxCallback:function(r){return r*1.5},yLabelFormatter:function(r){return"".concat(r,"%")}})}),(0,c.jsx)(D.Z,{colSpan:12,title:(0,c.jsx)(f.Z,{}),subTitle:"I/O: ".concat((0,s.FI)(l.io[l.io.length-1].source.usage)," / ").concat((0,s.FI)(l.io[l.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,c.jsx)(_.Z,{yField:"usage",xField:"date",colorField:"type",data:l.io,yDomainMaxCallback:function(r){return r*2},yLabelFormatter:function(r){return(0,s.FI)(parseFloat(r))}})}),l.network&&l.network.length>0&&(0,c.jsx)(D.Z,{colSpan:12,title:(0,c.jsx)(f.Z,{}),subTitle:"Network: ".concat((0,s.FI)(l.network[l.io.length-1].source.usage)," / ").concat((0,s.FI)(l.network[l.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,c.jsx)(_.Z,{yField:"usage",xField:"date",colorField:"type",data:l.network,yDomainMaxCallback:function(r){return r*2},yLabelFormatter:function(r){return(0,s.FI)(parseFloat(r))}})})]}),(0,c.jsx)(D.Z,{title:(0,c.jsx)(U.Z,{}),subTitle:"Progress",children:(0,c.jsx)(I.Z,{scroll:{x:"max-content"},rowKey:"PID",columns:C==null?void 0:C.columns,dataSource:C==null?void 0:C.data,pagination:{pageSize:10}})})]})}},84410:function(x,g,e){e.d(g,{a:function(){return v},i:function(){return m}});var h=e(15009),i=e.n(h),P=e(99289),n=e.n(P),a=e(54006);function m(d){return o.apply(this,arguments)}function o(){return o=n()(i()().mark(function d(y){return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,a.request)("/api/app/container/get-stat-info",{method:"POST",data:y}));case 1:case"end":return s.stop()}},d)})),o.apply(this,arguments)}function v(d){return _.apply(this,arguments)}function _(){return _=n()(i()().mark(function d(y){return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,a.request)("/api/app/container/get-process-info",{method:"POST",data:y}));case 1:case"end":return s.stop()}},d)})),_.apply(this,arguments)}},5251:function(x,g,e){e.d(g,{FI:function(){return i},ZM:function(){return P}});function h(n){return n.trim()}function i(n){var a="";n<.1*1024?a=n.toFixed(2)+"B":n<.1*1024*1024?a=(n/1024).toFixed(2)+"KB":n<1*1024*1024*1024?a=(n/(1024*1024)).toFixed(2)+"MB":a=(n/(1024*1024*1024)).toFixed(2)+"GB";var m=a+"",o=m.indexOf("."),v=m.substring(o+1,o+3);return v=="00"?m.substring(0,o)+m.substr(o+3,2):a}function P(n){if(n){var a=new Date(n),m=a.getFullYear()+"-",o=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",v=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ",_=(a.getHours()<10?"0"+a.getHours():a.getHours())+":",d=(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":",y=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds();return m+o+v+_+d+y}}}}]);
