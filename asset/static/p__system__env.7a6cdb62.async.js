"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{1699:function(w,S,e){e.d(S,{u:function(){return y}});var G=e(9783),T=e.n(G),$=e(97857),B=e.n($),H=e(67294),Z=e(82346),F=e(40411),O=e(42075),p=e(85893),y=function(t){var A=(0,Z.useAccess)(),n=Array.isArray(t.access)?t.access:[t.access],s,u=t.fallback;if(typeof t.children=="function"?(s=t.children(n.reduce(function(j,c){return B()(B()({},j),{},T()({},c,A[c]))},{})),s||(s=u)):n.every(function(j){return A[j]})?s=t.children:s=u,!u&&s&&t.showProTips&&A.canSeeEnableCe){if(A.canSeeEnableHiddenProTips)return null;s=(0,p.jsx)(F.Z,{offset:t.showProTipsOffset,count:"PRO",color:"gold",style:{fontWeight:"bold"},children:s})}if(!u&&s&&t.showProRibbonTips&&A.canSeeEnableCe){if(A.canSeeEnableHiddenProTips)return null;s=(0,p.jsx)(F.Z.Ribbon,{text:"PRO",color:"gold",style:{fontWeight:"bold"},children:s})}return t.space?(0,p.jsx)(O.Z,B()(B()({},t.space),{},{children:s})):s}},80821:function(w,S,e){e.d(S,{Z:function(){return A}});var G=e(97857),T=e.n(G),$=e(5574),B=e.n($),H=e(24963),Z=e(36146),F=e(86738),O=e(83062),p=e(96074),y=e(83622),l=e(67294),t=e(85893);function A(n){var s=(0,l.useState)(!1),u=B()(s,2),j=u[0],c=u[1],a=(0,l.useContext)(H.Z),o=a.message,r=new Z.Uo,_=function(){c(!0);var P=n.action();P instanceof Promise?P.then(function(m){if(c(!1),m){typeof n.onSuccess=="function"&&n.onSuccess(m);var U="";n.messageSuccess?typeof n.messageSuccess=="function"?U=n.messageSuccess(m):U=n.messageSuccess.indexOf("notification.")==0?r.format(n.messageSuccess):n.messageSuccess:U=r.format("notification.finish"),n.asynced?o.info(U):o.success(U)}}).catch(function(m){c(!1),typeof n.onError=="function"&&n.onError(m)}):c(!1)};return n.confirm?(0,t.jsx)(F.Z,T()(T()({style:{width:500},title:n.confirmTitle?n.confirmTitle:r.format("notification.title.tip"),description:typeof n.confirm=="string"&&n.confirm.indexOf("notification.")==0?r.format(n.confirm):n.confirm,onConfirm:_,okText:"Yes",cancelText:"No",onOpenChange:n.confirmOnOpenChange},n.confirmProps),{},{children:(0,t.jsxs)(O.Z,{title:n.tips,children:[n.showDivider&&(0,t.jsx)(p.Z,{type:"vertical",style:{marginRight:15}}),(0,t.jsx)(y.ZP,{block:n.block,disabled:n.disabled,icon:!n.children&&j?void 0:n.icon,loading:j,danger:n.danger,type:n.type,children:n.children})]})})):(0,t.jsxs)(O.Z,{title:n.tips,children:[n.showDivider&&(0,t.jsx)(p.Z,{type:"vertical",style:{marginRight:15}}),(0,t.jsx)(y.ZP,{block:n.block,style:n.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:n.disabled,icon:!n.children&&j?void 0:n.icon,loading:j,onClick:_,danger:n.danger,type:n.type,children:n.children})]})}},44349:function(w,S,e){var G=e(97857),T=e.n(G),$=e(15009),B=e.n($),H=e(99289),Z=e.n(H),F=e(74763),O=e(17186),p=e(5966),y=e(86250),l=e(67294),t=e(85893),A=(0,l.forwardRef)(function(n,s){var u=(0,l.useRef)();(0,l.useImperativeHandle)(s,function(){return{addItem:function(c){function a(o,r,_){return c.apply(this,arguments)}return a.toString=function(){return c.toString()},a}(function(c,a,o){var r,_=(r=u.current)===null||r===void 0?void 0:r.getList(),C;if(_==null||_.forEach(function(U,J){U[c]==a[c]&&(C=J)}),!(0,F.k)(C)&&o){var P;(P=u.current)===null||P===void 0||P.remove(C),C=void 0}if(!C){var m;(m=u.current)===null||m===void 0||m.add(a)}}),removeItemByKey:function(a,o){return Z()(B()().mark(function r(){var _,C;return B()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return C=(_=u.current)===null||_===void 0?void 0:_.getList(),C==null||C.forEach(function(U,J){if(U[a]==o){var Q;(Q=u.current)===null||Q===void 0||Q.remove(J);return}}),m.abrupt("return");case 3:case"end":return m.stop()}},r)}))()},clear:function(a){if(!a){var o;a=(o=u.current)===null||o===void 0||(o=o.getList())===null||o===void 0?void 0:o.map(function(_,C){return C})}if(a){var r;(r=u.current)===null||r===void 0||r.remove(a)}},getList:function(){var a;return(a=u.current)===null||a===void 0?void 0:a.getList()}}});var j={};return n.hideCopyButton===!0&&(j.copyIconProps=!1),n.hideDeleteButton===!0&&(j.deleteIconProps=!1),(0,t.jsx)(O.u,T()(T()({initialValue:n.initialValue,label:n.label,name:n.name,actionRef:u,creatorButtonProps:n.showAddButton?{creatorButtonText:n.label?n.label:n.name}:!1,min:n.min?n.min:0},j),{},{children:function(a,o,r){return(0,t.jsx)(y.Z,{justify:n.justify,gap:n.gap,children:n.items.map(function(_){return _.render?(0,t.jsx)("div",{children:_.render&&_.render(a,o,r)},"".concat(n.name,"-").concat(_.name,"-").concat(a.key)):(0,t.jsx)(p.Z,{width:_.width,name:_.name,label:_.label,required:_.required,rules:[{required:_.required}],disabled:_.disabled,placeholder:_.placeholder},"".concat(n.name,"-").concat(_.name,"-").concat(a.key))})})}}))});S.Z=A},36435:function(w,S,e){var G=e(15009),T=e.n(G),$=e(64599),B=e.n($),H=e(99289),Z=e.n(H),F=e(9783),O=e.n(F),p=e(5574),y=e.n(p),l=e(67294),t=e(184),A=e(38345),n=e(97269),s=e(97321),u=e(97462),j=e(64317),c=e(5966),a=e(86615),o=e(68602),r=e(83622),_=e(83403),C=e(24963),P=e(1699),m=e(29177),U=e(1883),J=e(43425),Q=e(44349),_e=e(3616),X=e(36146),D=e(85893),ee=(0,l.forwardRef)(function(x,k){var ne=(0,l.useState)(!1),q=y()(ne,2),L=q[0],M=q[1],R=(0,l.useRef)(),b=(0,l.useContext)(C.Z),Y=b.message,i=(0,l.useState)([]),I=y()(i,2),z=I[0],te=I[1],K=new X.Uo("components.permissionButton"),ae=O()(O()(O()(O()(O()({},_.W6.CONTAINER,"Id"),_.W6.APPSTORE,"name"),_.W6.COMPOSE,"name"),_.W6.REGISTRY,"serverAddress"),_.W6.DOCKER_ENV,"name"),le=O()(O()(O()(O()(O()({},_.W6.CONTAINER,"name"),_.W6.APPSTORE,"name"),_.W6.COMPOSE,"name"),_.W6.REGISTRY,"title"),_.W6.DOCKER_ENV,"title"),se=ae[x.type],oe=le[x.type],ie=x.selected.map(function(E){return E[ae[x.type]]});return l.useEffect(function(){if(L){if(!x.selected||x.selected.length==0){Y.error(X.FD.format("message.noDataSelect")),M(!1);return}(0,o.dP)({permission:{uri:x.type,key:se,value:ie}}).then(function(E){var d;(d=R.current)===null||d===void 0||d.setFieldValue("list",Object.keys(E.data.list).map(function(f){return{name:f,type:E.data.list[f].type,users:E.data.list[f].users}}))}),(0,o.lE)().then(function(E){var d,f=(d=E.data)===null||d===void 0||(d=d.list)===null||d===void 0?void 0:d.map(function(v){return{label:v.username,value:v.username}});te(f)})}},[L]),(0,D.jsx)(P.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,D.jsxs)(t.a,{name:"create",title:K.format("drawerTitle"),open:L,onOpenChange:function(d){if(!d){var f;(f=R.current)===null||f===void 0||f.resetFields()}M(d)},drawerProps:{forceRender:!0,width:_e.R_},formRef:R,trigger:(0,D.jsx)(r.ZP,{icon:(0,D.jsx)(m.Z,{}),children:K.format("drawerTriggerButton")}),onFinish:function(){var E=Z()(T()().mark(function d(f){var v,g,h;return T()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:v=B()(f.list),W.prev=1,v.s();case 3:if((g=v.n()).done){W.next=9;break}return h=g.value,W.next=7,(0,o.Db)({usernames:h.users,permissionType:h.type,permission:{uri:x.type,key:se,showKey:oe,value:[h.name]}});case 7:W.next=3;break;case 9:W.next=14;break;case 11:W.prev=11,W.t0=W.catch(1),v.e(W.t0);case 14:return W.prev=14,v.f(),W.finish(14);case 17:Y.success(X.FD.format("finish")),M(!1),x.onSuccess();case 20:case"end":return W.stop()}},d,null,[[1,11,14,17]])}));return function(d){return E.apply(this,arguments)}}(),children:[(0,D.jsxs)(A.Z,{ghost:!0,title:(0,D.jsx)(U.Z,{}),subTitle:K.format("batchTitle"),children:[(0,D.jsx)(n.A.Item,{name:"type",style:{marginBottom:0},children:(0,D.jsx)(s.Z.Group,{defaultValue:"admin",onChange:function(d){var f,v,g=(f=R.current)===null||f===void 0?void 0:f.getFieldValue("list");g.forEach(function(h){h.type=d,h.users=[]}),(v=R.current)===null||v===void 0||v.setFieldValue("list",g)},children:["admin","restricted","public"].map(function(E){return(0,D.jsx)(s.Z,{style:{width:240},title:K.format("dataTypeOption.".concat(E)),description:K.format("dataTypeOptionDesc.".concat(E)),value:E},E)})})}),(0,D.jsx)(u.Z,{name:["type"],children:function(d){var f=d.type;if(f==="restricted")return(0,D.jsx)(j.Z,{mode:"multiple",name:"usernames",label:K.format("formUsernames"),onChange:function(g){var h,N,W=(h=R.current)===null||h===void 0?void 0:h.getFieldValue("list");W.forEach(function(V){V.users=g}),(N=R.current)===null||N===void 0||N.setFieldValue("list",W)},rules:[{required:!0}],request:Z()(T()().mark(function v(){var g,h,N;return T()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(!(z.length>0)){V.next=2;break}return V.abrupt("return",z);case 2:return V.next=4,(0,o.lE)();case 4:return h=V.sent,N=(g=h.data)===null||g===void 0||(g=g.list)===null||g===void 0?void 0:g.map(function(re){return{label:re.username,value:re.username}}),te(N),V.abrupt("return",N);case 8:case"end":return V.stop()}},v)}))})}})]}),(0,D.jsx)(A.Z,{ghost:!0,title:(0,D.jsx)(J.Z,{}),subTitle:K.format("dataTitle"),children:(0,D.jsx)(Q.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:K.format("dataName"),render:function(d,f,v){var g=v.getCurrentRowData();return(0,D.jsx)(c.Z,{disabled:!0,label:K.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:K.format("dataType"),render:function(d,f,v){var g=v.getCurrentRowData();return(0,D.jsx)(a.Z.Group,{label:K.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(h){return{label:K.format("dataTypeOption.".concat(h)),value:h}})})}},{name:"users",label:K.format("dataUsers"),render:function(d,f,v){return(0,D.jsx)(u.Z,{name:["type"],children:function(h){var N=h.type;if(N=="restricted")return(0,D.jsx)(j.Z,{width:"sm",mode:"tags",name:"users",label:K.format("dataUsers"),options:z})}})}}]})})]})})});S.Z=ee},98163:function(w,S,e){e.r(S),e.d(S,{default:function(){return C}});var G=e(15009),T=e.n(G),$=e(99289),B=e.n($),H=e(80821),Z=e(77273),F=e(36435),O=e(83403),p=e(24963),y=e(87662),l=e(36146),t=e(86548),A=e(90078),n=e(56729),s=e(82346),u=e(83622),j=e(42075),c=e(96074),a=e(25593),o=e(83062),r=e(67294),_=e(85893);function C(){var P=(0,r.useRef)(),m=(0,r.useRef)(),U=(0,s.useModel)("@@initialState"),J=U.initialState,Q=U.loading,_e=U.error,X=U.refresh,D=U.setInitialState,ee=(0,r.useContext)(p.Z),x=ee.message,k=(0,s.useLocation)(),ne=(0,s.useNavigate)(),q=new l.Uo("system.env");return(0,r.useEffect)(function(){var L=k.state;if(L&&L.item){var M;(M=m.current)===null||M===void 0||M.edit(L.item)}},[k.state]),(0,_.jsx)(A._z,{header:{extra:[(0,_.jsx)(Z.Z,{trigger:(0,_.jsx)(u.ZP,{type:"primary",children:q.format("createButton")}),ref:m,onFinish:B()(T()().mark(function L(){var M,R,b;return T()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(b=k.state,!(b&&b.item)){i.next=6;break}return i.next=4,(0,y.vC)({name:b.item.name});case 4:return ne(k.pathname,{replace:!0,state:null}),i.abrupt("return");case 6:X(),!((M=P.current)===null||M===void 0)&&M.reloadAndRest&&((R=P.current)===null||R===void 0||R.reloadAndRest());case 8:case"end":return i.stop()}},L)}))},"dockerEnvCreate")]},children:(0,_.jsx)(n.Z,{rowKey:"name",columns:[{title:l.FD.format("listName"),dataIndex:"name"},{title:l.FD.format("listTitle"),dataIndex:"title"},{title:l.FD.format("listTargetAddress"),dataIndex:"address"},{title:l.FD.format("listManage"),width:100,search:!1,render:function(M,R,b,Y,i){return(0,_.jsx)(j.Z,{split:(0,_.jsx)(c.Z,{type:"vertical"}),children:(0,_.jsx)(a.Z.Link,{onClick:function(){var z;(z=m.current)===null||z===void 0||z.edit(R)},children:(0,_.jsx)(o.Z,{title:l.FD.format("listManageEdit"),children:(0,_.jsx)(t.Z,{})})},R.name)})}}],pagination:!1,request:B()(T()().mark(function L(){var M;return T()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,(0,y.Kg)({enableCertContent:!0});case 2:return M=b.sent,b.abrupt("return",{data:M.data.list,total:M.data.list.length});case 4:case"end":return b.stop()}},L)})),search:!1,rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:P,tableAlertOptionRender:function(M){var R=M.selectedRows,b=M.selectedRowKeys;return(0,_.jsxs)(j.Z,{size:16,children:[(0,_.jsx)(F.Z,{type:O.W6.DOCKER_ENV,selected:R,onSuccess:function(){var i,I;return!((i=P.current)===null||i===void 0)&&i.reloadAndRest&&((I=P.current)===null||I===void 0||I.reloadAndRest()),!0}},"permissionButton"),(0,_.jsx)(H.Z,{danger:!0,type:"primary",action:function(){return R.find(function(i){return i.default})?(x.warning(l.FD.format("systemEnvDefaultCannotDelete")),!1):(0,y._g)({name:b})},onSuccess:function(){var i,I;return!((i=P.current)===null||i===void 0)&&i.reloadAndRest&&((I=P.current)===null||I===void 0||I.reloadAndRest()),!0},onError:function(){var i,I;return!((i=P.current)===null||i===void 0)&&i.reset&&((I=P.current)===null||I===void 0||I.reset()),!0},confirm:"notification.confirm.title",children:l.FD.format("listManageDeleteBatch")})]})}})})}}}]);
