"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4037],{24963:function(Z,E,e){var f=e(67294),l=(0,f.createContext)({});E.Z=l},52756:function(Z,E,e){e.r(E),e.d(E,{default:function(){return O},getLang:function(){return y}});var f=e(82346),l=e(31418),S=e(26058),h=e(85137),M=e(24963),A=e(65913),j=e(67294),P=e(85893);function y(d,c,g){var s=(0,f.getLocale)();g!=null&&g.XK&&(s="zh-XK");var v=(0,f.getIntl)(s).formatMessage({id:d},c);return v}function O(){var d=(0,j.useRef)(),c=(0,f.useIntl)(),g=function(t){for(var a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];v.notification[t]({message:c.formatMessage({id:"notification.title."+t}),description:n.join(" "),placement:"topRight"})},s=function(t){for(var a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];v.message[t](n.join(" "))},v=l.Z.useApp(),T=(0,f.useModel)("@@initialState"),D=T.initialState,W=T.loading,b=T.error,N=T.refresh,C=T.setInitialState,_=(0,f.useModel)("subscriber");return D!=null&&D.user.username&&_.addDataHandler("user:permission:".concat(D==null?void 0:D.user.username),function(u){N()}),(0,P.jsx)(S.Z,{children:(0,P.jsx)(M.Z.Provider,{value:{notice:{success:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];g.apply(void 0,["success"].concat(a))},error:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];g.apply(void 0,["error"].concat(a))},warning:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];g.apply(void 0,["warning"].concat(a))},info:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];g.apply(void 0,["info"].concat(a))},destroy:function(){v.notification.destroy()}},message:{success:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];s.apply(void 0,["success"].concat(a))},error:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];s.apply(void 0,["error"].concat(a))},warning:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];s.apply(void 0,["warning"].concat(a))},info:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];s.apply(void 0,["info"].concat(a))},loading:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];s.apply(void 0,["loading"].concat(a))},destroy:function(){v.message.destroy()}},loading:{show:function(){d.current&&d.current.show()},destroy:function(){d.current&&d.current.destroy()}},lang:function(t,a){return c.formatMessage({id:t},a)}},children:(0,P.jsxs)(A.Z,{ref:d,children:[(0,P.jsx)(f.Outlet,{}),(0,P.jsx)(h.Z.BackTop,{duration:10,style:{bottom:100}})]})},W?"1":"2")})}},65913:function(Z,E,e){var f=e(5574),l=e.n(f),S=e(74330),h=e(67294),M=e(85893),A=(0,h.forwardRef)(function(j,P){(0,h.useImperativeHandle)(P,function(){return{show:function(){c(!0)},destroy:function(){c(!1)}}});var y=(0,h.useState)(!1),O=l()(y,2),d=O[0],c=O[1];return(0,M.jsx)(S.Z,{spinning:d,size:"default",children:j.children})});E.Z=A},66139:function(Z,E,e){e.r(E),e.d(E,{default:function(){return ne}});var f=e(15009),l=e.n(f),S=e(99289),h=e.n(S),M=e(5574),A=e.n(M),j=e(68602),P=e(89075),y=e(68262),O=e(82346),d=e(9361),c=e(40056),g=e(86250),s=e(25593),v=e(67294),T=e(52756),D=e(29177),W=e(88360),b=e(94149),N=e(12119),C=e(5966),_=e(97462),u=e(63434),t=e(92398),a=e(55241),n=e(42075),r=e(85893);function ee(w){var U;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.Z,{centered:!0,activeKey:w.loginType,items:[{icon:(0,r.jsx)(D.Z,{}),key:"account",label:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55"},{icon:(0,r.jsx)(W.Z,{}),key:"register",label:"\u914D\u7F6E\u7BA1\u7406\u5458\u7528\u6237\u540D\u53CA\u5BC6\u7801"}].filter(function(L){return L.key==w.loginType})}),(0,r.jsx)(C.Z,{name:"username",fieldProps:{size:"large",prefix:(0,r.jsx)(D.Z,{className:"prefixIcon"})},placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"}]},"username"),(0,r.jsx)(C.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,r.jsx)(b.Z,{className:"prefixIcon"})},placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]},"password"),w.showTwoFa&&(0,r.jsx)(C.Z,{name:"code",placeholder:"\u8BF7\u8F93\u5165\u53CC\u56E0\u7D20\u9A8C\u8BC1\u7801",rules:[{required:!0}],fieldProps:{maxLength:6,size:"large",prefix:(0,r.jsx)(N.Z,{className:"prefixIcon"})}}),w.loginType=="register"&&(0,r.jsx)(_.Z,{name:["password"],children:function(V){var re=V.password;return(0,r.jsx)(C.Z.Password,{fieldProps:{size:"large",prefix:(0,r.jsx)(b.Z,{className:"prefixIcon"})},placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801\uFF01"},function(H){var X=H.getFieldValue;return{validator:function(Q,I){return!I||X("password")===I?Promise.resolve():Promise.reject(new Error("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4"))}}}]},"confirmPassword")}}),w.showAutoLogin&&(0,r.jsxs)("div",{style:{marginBlockEnd:24},children:[(0,r.jsx)(u.Z,{noStyle:!0,name:"autoLogin",initialValue:!0,children:"\u4FDD\u6301\u767B\u5F55\u72B6\u6001"}),(0,r.jsx)(a.Z,{content:(0,r.jsxs)(n.Z,{direction:"vertical",size:[0,30],children:[(0,r.jsxs)("span",{children:["\u5BBF\u4E3B\u673A\u4E2D\u6267\u884C\u4EE5\u4E0B\u547D\u4EE4\uFF0C",(0,r.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/install/ctrl",target:"_blank",children:(0,T.getLang)("notification.help")})]}),(0,r.jsxs)(s.Z.Text,{copyable:!0,style:{padding:10,background:"#24292f",color:"#ffffff"},children:["docker exec ",(U=w.appName)!==null&&U!==void 0?U:"dpanel"," ./dpanel user:reset -f config.yaml"]}),(0,r.jsx)("span",{})]}),children:(0,r.jsx)(s.Z.Link,{style:{float:"right"},children:"\u5FD8\u8BB0\u5BC6\u7801?"})})]})]})}var ne=function(){var w=d.Z.useToken(),U=w.token,L=(0,O.useModel)("@@initialState"),V=L.initialState,re=L.loading,H=L.error,X=L.refresh,ae=L.setInitialState,Q=(0,v.useState)({loginType:"account",appName:"dpanel"}),I=A()(Q,2),B=I[0],te=I[1],se=(0,v.useState)(),Y=A()(se,2),p=Y[0],J=Y[1],oe=(0,v.useState)(),k=A()(oe,2),m=k[0],ie=k[1],ue=(0,O.useAntdConfigSetter)(),q=(0,v.useRef)();return(0,v.useEffect)(function(){window.document.title="DPanel - Docker \u7BA1\u7406\u9762\u677F",(0,j.Nr)().then(function(){var $=h()(l()().mark(function R(i){var x;return l()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:x={loginType:"account"},i.data.showBuildName&&i.data.family!="lite"&&(x.showBuildName=!0),i.data.showRegister&&(x.loginType="register"),i.data.family=="demo"&&(x.showDemo=!0),x.appName=i.data.appName,i.data.theme&&i.data.theme.algorithm&&(localStorage.setItem("dpanel-theme",i.data.theme.algorithm),ue(function(o){var z;(z=o.theme)!==null&&z!==void 0||(o.theme={});var G=[];return i.data.theme&&(i.data.theme.algorithm=="dark"?G.push(d.Z.darkAlgorithm):G.push(d.Z.defaultAlgorithm),o.theme.algorithm=G),o})),i.data.feature.indexOf("canSeeEnableThemeUser")!=-1?(0,P.ax)().then(function(o){o.data&&o.data.themeUserConfig&&o.data.themeUserConfig.siteTitle&&(window.document.title=o.data.themeUserConfig.siteTitle),J(o.data)}):J({}),ie(i.data),te(x);case 9:case"end":return K.stop()}},R)}));return function(R){return $.apply(this,arguments)}}())},[]),(0,r.jsxs)(r.Fragment,{children:[B&&B.showBuildName&&(0,r.jsx)(c.Z,{type:"error",message:"\u60A8\u521B\u5EFA\u7684\u9762\u677F\u5BB9\u5668\u540D\u79F0\u975E\u9ED8\u8BA4\u7684 dpanel\uFF0C\u8BF7\u91CD\u5EFA\u5E76\u901A\u8FC7\u73AF\u5883\u53D8\u91CF -e APP_NAME= \u6307\u5B9A\u65B0\u7684\u5BB9\u5668\u540D\u79F0\u3002",banner:!0}),B&&B.showDemo&&(0,r.jsx)(c.Z,{type:"error",message:"\u5F53\u524D\u4E3A\u6F14\u793A\u7AD9\uFF0C\u7981\u7528 docker \u76F8\u5173\u529F\u80FD\u3002\u5E10\u53F7\u5BC6\u7801\u4E3A admin 123456",banner:!0}),(0,r.jsx)(g.Z,{justify:"center",align:"center",style:{height:"100vh",background:p&&p.themeUserConfig&&p.themeUserConfig.bgImage&&p.themeUserConfig.bgImage.src?"url(".concat(p.themeUserConfig.bgImage.src,")"):"".concat(U.colorBgElevated,"dd")},children:(0,r.jsxs)(y.U,{onFinish:function(){var $=h()(l()().mark(function R(i){var x,F;return l()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(B.loginType!="register"){o.next=3;break}return o.next=3,(0,j.AT)({username:i.username,password:i.password,confirmPassword:i.confirmPassword});case 3:return o.prev=3,o.next=6,(0,j.n$)({username:i.username,password:i.password,autoLogin:i.autoLogin,code:i.code});case 6:if(x=o.sent,!x.data.accessToken){o.next=14;break}return localStorage.setItem("token",x.data.accessToken),X(),window.location.href="/dpanel/ui",o.abrupt("return");case 14:return o.abrupt("return",!1);case 15:o.next=20;break;case 17:o.prev=17,o.t0=o.catch(3),(F=q.current)===null||F===void 0||F.resetFields(["code"]);case 20:case"end":return o.stop()}},R,null,[[3,17]])}));return function(R){return $.apply(this,arguments)}}(),containerStyle:{background:"transparent",height:"auto"},logo:"",title:p&&(0,r.jsx)("img",{src:p&&p.themeUserConfig&&p.themeUserConfig.loginLogo?p.themeUserConfig.loginLogo:"/dpanel/static/asset/logo.png",width:"350"}),subTitle:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),(0,r.jsx)("br",{})]}),formRef:q,children:[(0,r.jsx)(ee,{showTwoFa:!!(p&&p.canSeeEnableTwoFa),loginType:B.loginType,appName:B.appName,showAutoLogin:!(m!=null&&m.feature.includes("canSeeEnableXk"))}),(0,r.jsxs)(s.Z.Paragraph,{style:{marginBottom:10,color:"#999999",textAlign:"center"},children:["\u767B\u5F55\u5373\u8868\u793A\u540C\u610F",(0,r.jsx)("a",{href:(0,T.getLang)("user.login.userAgreementUrl",{},{XK:m==null?void 0:m.feature.includes("canSeeEnableXk")}),target:"_blank",children:(0,T.getLang)("user.login.userAgreement",{},{XK:m==null?void 0:m.feature.includes("canSeeEnableXk")})}),(0,r.jsx)("a",{href:(0,T.getLang)("user.login.userPrivacyUrl",{},{XK:m==null?void 0:m.feature.includes("canSeeEnableXk")}),target:"_blank",children:(0,T.getLang)("user.login.userPrivacy",{},{XK:m==null?void 0:m.feature.includes("canSeeEnableXk")})})]})]})})]})}},89075:function(Z,E,e){e.d(E,{$w:function(){return A},YQ:function(){return P},ax:function(){return O}});var f=e(15009),l=e.n(f),S=e(99289),h=e.n(S),M=e(82346);function A(){return j.apply(this,arguments)}function j(){return j=h()(l()().mark(function c(){return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,M.request)("/api/pro/home/get-machine-id",{method:"POST"}));case 1:case"end":return s.stop()}},c)})),j.apply(this,arguments)}function P(){return y.apply(this,arguments)}function y(){return y=h()(l()().mark(function c(){return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,M.request)("/api/pro/home/get-license-info",{method:"POST"}));case 1:case"end":return s.stop()}},c)})),y.apply(this,arguments)}function O(){return d.apply(this,arguments)}function d(){return d=h()(l()().mark(function c(){return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,M.request)("/api/pro/home/login-info",{method:"POST"}));case 1:case"end":return s.stop()}},c)})),d.apply(this,arguments)}}}]);
