"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3647],{81146:function(We,ie,e){var oe=e(97857),a=e.n(oe),ve=e(15009),f=e.n(ve),x=e(99289),W=e.n(x),ne=e(67294),te=e(97269),A=e(62370),Z=e(5966),r=e(97462),U=e(82346),E=e(71230),J=e(15746),o=e(34041),X=e(83622),B=e(84567),V=e(42075),R=e(80821),me=e(23430),se=e(93162),g=e.n(se),b=e(78267),u=e.n(b),d=e(75458),re=e.n(d),De=e(12323),Ge=e(4244),s=e.n(Ge),qe=e(24078),Ze=e(36146),C=e(85893),q,Oe,ge,Re={decorations:{matchBackground:"",matchBorder:"#FFFF00",activeMatchBackground:"#FFFF0066",matchOverviewRuler:"",activeMatchColorOverviewRuler:""}},Be=(0,ne.forwardRef)(function(Pe,Ke){var p=(0,ne.useRef)(),P=(0,U.useModel)("subscriber"),M=new Ze.Uo("components.containerLog");(0,ne.useImperativeHandle)(Ke,function(){return{fit:function(){q.clear(),ge.fit()},start:function(){return W()(f()().mark(function k(){return f()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l({lineTotal:500});case 2:case"end":return n.stop()}},k)}))()},close:function(){P.progress.close(Pe.id)}}});function l(N){return Ye.apply(this,arguments)}function Ye(){return Ye=W()(f()().mark(function N(k){return f()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:P.progress.close(Pe.id),q.clear(),k.download=!1,Pe.request(k);case 4:case"end":return n.stop()}},N)})),Ye.apply(this,arguments)}return(0,ne.useEffect)(function(){return window.addEventListener("resize",function(){ge.fit()}),q=new Ge.Terminal(a()(a()({},De.X),{},{fontSize:12,lineHeight:1.2,allowProposedApi:!0})),ge=new b.FitAddon,Oe=new d.SearchAddon({}),q.loadAddon(ge),q.loadAddon(Oe),q.open(document.getElementById("terminal-container-log")),ge.fit(),P.addDataHandler(Pe.id,function(N){q.write(N.data)}),function(){q.clear(),q.reset(),P.progress.close(Pe.id)}},[]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(te.A,{submitter:!1,layout:"horizontal",onFinish:function(k){var j;l({id:Pe.id,lineTotal:parseInt(k.lineTotal),showTime:(j=k.showTime)!==null&&j!==void 0?j:!1})},formRef:p,children:(0,C.jsxs)(E.Z,{gutter:[10,0],children:[(0,C.jsx)(J.Z,{span:8,children:(0,C.jsx)(A.Z,{name:"lineTotal",initialValue:"500",label:M.format("formLineTotal"),children:(0,C.jsxs)(o.Z,{defaultValue:"500",onChange:function(k){var j;(j=p.current)===null||j===void 0||j.submit()},children:[(0,C.jsx)(o.Z.Option,{value:"100",children:M.format("formLineTotalOption",{number:"100"})}),(0,C.jsx)(o.Z.Option,{value:"200",children:M.format("formLineTotalOption",{number:"200"})}),(0,C.jsx)(o.Z.Option,{value:"500",children:M.format("formLineTotalOption",{number:"500"})}),(0,C.jsx)(o.Z.Option,{value:"1000",children:M.format("formLineTotalOption",{number:"1000"})}),(0,C.jsx)(o.Z.Option,{value:"-1",children:M.format("formLineTotalOptionAll")})]})})}),(0,C.jsx)(J.Z,{children:(0,C.jsx)(X.ZP,{onClick:function(){q.clear()},children:M.format("clearButton")})}),(0,C.jsx)(J.Z,{children:(0,C.jsx)(A.Z,{name:"showTime",valuePropName:"checked",children:(0,C.jsx)(B.Z,{onChange:function(k){var j;(j=p.current)===null||j===void 0||j.submit()},children:M.format("formShowTime")})})}),(0,C.jsx)(J.Z,{children:(0,C.jsx)(Z.Z,{label:M.format("formKeywork"),name:"keywork",fieldProps:{onPressEnter:function(){var k;Oe.findNext((k=p.current)===null||k===void 0?void 0:k.getFieldValue("keywork"),Re)},onChange:function(k){Oe.findNext(k.target.value,Re)}},placeholder:M.format("formKeyworkEmpty")})}),(0,C.jsx)(J.Z,{children:(0,C.jsx)(r.Z,{name:["keywork"],children:function(k){var j=k.keywork;return(0,C.jsxs)(V.Z,{size:10,children:[(0,C.jsx)(X.ZP,{onClick:function(){Oe.findNext(j,Re)},children:M.format("formKeyworkNext")},"next"),(0,C.jsx)(X.ZP,{onClick:function(){Oe.findPrevious(j,Re)},children:M.format("formKeyworkPrev")},"prev")]})}})}),(0,C.jsx)(J.Z,{children:(0,C.jsx)(R.Z,{icon:(0,C.jsx)(me.Z,{}),action:W()(f()().mark(function N(){var k,j,n;return f()().wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(!Pe.download){_e.next=5;break}return _e.next=3,Pe.download({lineTotal:parseInt((k=p.current)===null||k===void 0?void 0:k.getFieldValue("lineTotal")),showTime:(j=p.current)===null||j===void 0?void 0:j.getFieldValue("showTime")});case 3:n=_e.sent,(0,se.saveAs)(n.data,n.name);case 5:case"end":return _e.stop()}},N)})),children:M.format("downloadButton")})})]})}),(0,C.jsx)("div",{style:{marginTop:"20px",height:Pe.showInDrawer?"75vh":"85vh"},id:"terminal-container-log"})]})});ie.Z=Be},37413:function(We,ie,e){e.d(ie,{Z:function(){return J}});var oe=e(19632),a=e.n(oe),ve=e(36146),f=e(85577),x=e(58638),W=e(36693),ne=e(35995),te=e(99611),A=e(38345),Z=e(42075),r=e(66309),U=e(55241),E=e(85893);function J(o){var X,B=new ve.Uo("components.containerPort"),V=[];o.publicPort&&(V=a()(o.publicPort)),o.privatePort&&(V=[].concat(a()(V),a()(o.privatePort)));var R=(X=o.serverIp)!==null&&X!==void 0?X:"localhost";if(R!=""&&R.indexOf("http")===-1&&R.indexOf(":")>-1&&(R="[".concat(R,"]")),R==""||R=="127.0.0.1"){var me=document.location.protocol+"//"+document.location.hostname;R=me}var se=(0,E.jsxs)(A.Z,{direction:o.layout=="inline"?"row":"column",style:{width:o.layout!="inline"?600:"auto"},ghost:!0,children:[V.length>0&&(0,E.jsx)(A.Z,{title:(0,E.jsx)(f.Z,{}),subTitle:B.format("cardPortTitle"),ghost:o.ghost,bodyStyle:{maxHeight:300,overflow:"auto",margin:"10px 0"},children:V.map(function(g,b){var u;return R==""&&g.IP&&(R=g.IP),(0,E.jsx)(Z.Z,{size:"large",wrap:!0,children:(0,E.jsx)(r.Z,{color:g.PublicPort?"blue":"yellow",icon:g.PublicPort?(0,E.jsx)(x.Z,{}):"",style:{marginBottom:10,marginRight:15},children:g.PublicPort?(0,E.jsx)("a",{href:"".concat(R.indexOf("http")===0?R:"http://"+R,":").concat(g.PublicPort),target:"_blank",children:"".concat(g.PublicPort?((u=g.IP)!==null&&u!==void 0?u:"0.0.0.0")+":"+g.PublicPort+" -> ":"").concat(g.PrivatePort,"/").concat(g.Type)},"link".concat(b)):"".concat(g.PrivatePort,"/").concat(g.Type)})},"space".concat(b))})}),o.domain&&o.domain.length>0&&(0,E.jsx)(A.Z,{title:(0,E.jsx)(W.Z,{}),subTitle:B.format("cardDomainTitle"),ghost:o.ghost,children:(0,E.jsx)(Z.Z,{wrap:!0,style:{textAlign:"left"},children:o.domain&&o.domain.map(function(g,b){return(0,E.jsx)(r.Z,{color:"blue",icon:(0,E.jsx)(x.Z,{}),children:(0,E.jsx)("a",{href:g,target:"_blank",children:g})},"domain".concat(b))})})})]});return o.showInDetail?se:(0,E.jsx)(U.Z,{placement:"right",content:se,children:(0,E.jsxs)(Z.Z,{direction:"vertical",children:[o.privatePort&&o.privatePort.length>0&&(0,E.jsxs)(r.Z,{color:"yellow",icon:(0,E.jsx)(ne.Z,{}),children:[B.format("portPrivate"),": ",o.privatePort.length]}),o.publicPort&&o.publicPort.length>0&&(0,E.jsxs)(r.Z,{color:"blue",icon:(0,E.jsx)(te.Z,{}),children:[B.format("protPublic"),": ",o.publicPort.length]}),o.domain&&o.domain.length>0&&(0,E.jsx)(r.Z,{color:"geekblue",icon:(0,E.jsx)(W.Z,{}),children:o.domainTitle?o.domainTitle:"".concat(B.format("domain"),": ").concat(o.domain.length)})]})})}},94359:function(We,ie,e){e.d(ie,{Z:function(){return X}});var oe=e(5574),a=e.n(oe),ve=e(3089),f=e(98165),x=e(18429),W=e(8751),ne=e(66212),te=e(14313),A=e(30159),Z=e(87740),r=e(50888),U=e(66309),E=e(83062),J=e(36146),o=e(85893);function X(B){var V,R,me=new J.Uo("components.containerStatus"),se=B.status.split("."),g=a()(se,2),b=g[0],u=g[1],d="";d=me.format(B.status,(V=B.statusValue)!==null&&V!==void 0?V:{});var re=(0,o.jsx)(o.Fragment,{});return u=="0"&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(ve.Z,{}),color:"default",children:d})),u=="10"&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(f.Z,{spin:!0}),color:"processing",children:d})),u=="20"&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(x.Z,{}),color:"error",children:d})),u=="30"&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(W.Z,{}),color:"success",children:d})),u=="new"&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(ne.Z,{}),children:d})),(u=="running"||u=="healthy"||u=="active"||u=="ready")&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(te.Z,{}),color:"success",children:d})),(u=="paused"||u=="pause"||u=="rollback_paused")&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(A.Z,{}),color:"warning",children:d})),(u=="waiting"||u=="starting"||u=="accepted")&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(Z.Z,{}),children:d})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(u)&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(r.Z,{}),color:"processing",children:d})),(u=="error"||u=="down"||u=="failed")&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(x.Z,{}),color:"error",children:d})),["complete","completed","rollback_completed"].includes(u)&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(W.Z,{}),color:"success",children:d})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(u)&&(re=(0,o.jsx)(U.Z,{icon:(0,o.jsx)(x.Z,{}),color:"warning",children:d})),(0,o.jsx)(E.Z,{placement:"top",title:(R=B.tip)!==null&&R!==void 0?R:"",children:re})}},98093:function(We,ie,e){e.d(ie,{Z:function(){return k}});var oe=e(15009),a=e.n(oe),ve=e(99289),f=e.n(ve),x=e(5574),W=e.n(x),ne=e(3616),te=e(184),A=e(62370),Z=e(83622),r=e(67294),U=e(59252),E=e(24796),J=e(93529),o=e(91058),X=e(82034),B=e(10523),V=e(52255),R=e(38345),me=e(5966),se=e(24739),g=e(30291),b=e(92398),u=e(36146),d=e(42963),re=e(42075),De=e(64317),Ge=e(75870),s=e(85893);function qe(){var j=new u.Uo("components.appForm");return(0,s.jsxs)(re.Z.Compact,{children:[(0,s.jsx)(De.Z,{name:"imageRegistry",width:"sm",fieldProps:{popupMatchSelectWidth:!1},request:f()(a()().mark(function n(){var Ce;return a()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,(0,Ge.Ot)();case 2:return Ce=ue.sent,ue.abrupt("return",Ce.data.list.map(function(be){return{label:"".concat(be.title,"@").concat(be.serverAddress),value:be.id}}));case 4:case"end":return ue.stop()}},n)})),label:j.format("dockerImageImageName")}),(0,s.jsx)(me.Z,{label:" ",name:"imageName",required:!0,rules:[{required:!0}],width:"lg"})]})}var Ze=e(86615),C=e(97462),q=e(31199),Oe=e(86250),ge=e(44349),Re=e(24494);function Be(){var j,n=new u.Uo("components.appForm"),Ce=(0,r.useContext)(d.Z),_e=Ce.createFormRef,ue=(0,r.useRef)();return(0,s.jsxs)(R.Z,{children:[(0,s.jsxs)(Oe.Z,{gap:60,children:[(0,s.jsx)(Ze.Z.Group,{width:"md",label:n.format("createSchedulingLabel"),name:["scheduling","mode"],options:n.option("createSchedulingOption",["global","replicated"]),initialValue:"replicated",disabled:(j=_e.current)===null||j===void 0?void 0:j.getFieldValue("id")}),(0,s.jsx)(C.Z,{name:["scheduling"],children:function(Ne){var Ae=Ne.scheduling;return Ae.mode=="replicated"&&(0,s.jsx)(q.Z,{width:"md",label:n.format("createSchedulingReplicas"),name:["scheduling","replicas"],initialValue:1})}})]}),(0,s.jsx)(C.Z,{name:["scheduling","constraint"],children:function(Ne){var Ae=Ne.scheduling,Ue=Ne.constraint;return Ae.mode=="replicated"&&[(0,s.jsx)(Ze.Z.Group,{label:n.format("createConstraintNode"),initialValue:"all",name:["constraint","role"],options:n.option("createConstraintNodeOption",["all","manager","worker","user"])},"role"),Ue&&Ue.role=="user"&&(0,s.jsx)(De.Z,{name:["constraint","node"],request:f()(a()().mark(function ze(){var ke;return a()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,(0,Re.HN)();case 2:return ke=Q.sent,Q.abrupt("return",ke.data.list&&ke.data.list.map(function(ae){var de;return{label:(de=ae.Description)===null||de===void 0?void 0:de.Hostname,value:ae.ID}}));case 4:case"end":return Q.stop()}},ze)}))}),(0,s.jsx)(ge.Z,{name:["constraint","label"],label:n.format("createConstraintLabel"),hideCopyButton:!0,showAddButton:!0,gap:10,ref:ue,items:[{label:n.format("createConstraintLabelOption.name"),name:"name",width:"md",placeholder:"node.labels.name"},{name:"operator",render:function(ke,$,Q){return(0,s.jsx)(De.Z,{label:" ",name:"operator",valueEnum:{"==":"==","!=":"!="},initialValue:"=="})}},{label:n.format("createConstraintLabelOption.value"),name:"value",width:"md"}]},"label"),(0,s.jsx)(ge.Z,{name:"placement",label:n.format("createPlacementLabel"),hideCopyButton:!0,showAddButton:!0,gap:10,items:[{name:"name",render:function(ke,$,Q){return(0,s.jsx)(De.Z,{label:" ",name:"type",options:n.option("createPlacementOption",["spread"]),initialValue:"spread",allowClear:!1,width:"sm"})}},{label:n.format("createConstraintLabelOption.value"),name:"value",width:"md",placeholder:"node.labels.hostname"}]},"placement")]}})]})}var Pe=e(73396),Ke=e(55730),p=e(33879);function P(){var j=new u.Uo("components.appForm");return(0,s.jsx)(R.Z,{children:(0,s.jsxs)(Oe.Z,{gap:30,children:[(0,s.jsx)(De.Z,{label:j.format("createAdvRestart"),name:["restart","name"],width:"sm",initialValue:"any",options:j.option("createAdvRestartOption",["none","on-failure","any"])}),(0,s.jsx)(C.Z,{name:["restart"],children:function(Ce){var _e=Ce.restart;return _e=="on-failure"&&(0,s.jsx)(q.Z,{width:"sm",label:j.format("createAdvRestartMax"),name:["restart","maxAttempt"],initialValue:5})}}),(0,s.jsx)(q.Z,{width:"sm",label:j.format("createAdvRestartDelay"),tooltip:j.format("createAdvRestartDelayTip"),name:["restart","delay"],initialValue:5,fieldProps:{addonAfter:u.FD.format("unitSecond")}}),(0,s.jsx)(q.Z,{width:"sm",label:j.format("createAdvRestartWindow"),tooltip:j.format("createAdvRestartWindowTip"),name:["restart","window"],initialValue:0,fieldProps:{addonAfter:u.FD.format("unitSecond")}})]})})}function M(){var j=new u.Uo("components.appForm");return(0,s.jsxs)(R.Z,{children:[(0,s.jsxs)(Oe.Z,{gap:30,children:[(0,s.jsx)(q.Z,{label:j.format("createSwarmUpdateParallelism"),name:["scheduling","update","parallelism"],initialValue:1}),(0,s.jsx)(q.Z,{label:j.format("createSwarmUpdateDelay"),name:["scheduling","update","delay"],initialValue:0,fieldProps:{addonAfter:u.FD.format("unitSecond")}})]}),(0,s.jsx)(Ze.Z.Group,{label:j.format("createSwarmUpdateFailureAction"),name:["scheduling","update","failureAction"],initialValue:"pause",options:j.option("createSwarmUpdateFailureActionOption",["pause","continue","rollback"])}),(0,s.jsx)(Ze.Z.Group,{label:j.format("createSwarmUpdateOrder"),name:["scheduling","update","order"],initialValue:"stop-first",options:j.option("createSwarmUpdateOrderOption",["stop-first","start-first"])})]})}var l=e(64412),Ye=e(27323),N=(0,r.forwardRef)(function(j,n){(0,r.useImperativeHandle)(n,function(){return{edit:function(m){var c,O,_,h,K,w,F,D,T,je,H,le,fe,i,Ee,ce,Le,xe,Xe,we,ye,Ie,Me,y,v,S,G,I,z,Se,he,$e,en,Je,rn,an={id:m.ID,siteName:(c=(O=m.Spec)===null||O===void 0?void 0:O.Name)!==null&&c!==void 0?c:"",siteTitle:((_=m.Spec)===null||_===void 0?void 0:_.Labels)&&((h=m.Spec)===null||h===void 0?void 0:h.Labels[Re.$m]),hostname:(K=m.Spec)===null||K===void 0||(K=K.TaskTemplate)===null||K===void 0||(K=K.ContainerSpec)===null||K===void 0?void 0:K.Hostname,imageName:(w=(F=m.Spec)===null||F===void 0||(F=F.TaskTemplate)===null||F===void 0||(F=F.ContainerSpec)===null||F===void 0?void 0:F.Image)!==null&&w!==void 0?w:"",environment:(D=m.Spec)===null||D===void 0||(D=D.TaskTemplate)===null||D===void 0||(D=D.ContainerSpec)===null||D===void 0||(D=D.Env)===null||D===void 0?void 0:D.map(function(t){var L=t.split("=");return{name:L[0],value:L.slice(1).join("=")}}),volumes:(T=m.Spec)===null||T===void 0||(T=T.TaskTemplate)===null||T===void 0||(T=T.ContainerSpec)===null||T===void 0||(T=T.Mounts)===null||T===void 0?void 0:T.map(function(t){var L,ee;return{dest:(L=t.Target)!==null&&L!==void 0?L:"",host:(ee=t.Source)!==null&&ee!==void 0?ee:"",type:t.Type,permission:t.ReadOnly?"readonly":"write"}}),restartPolicy:function(t,L){return{name:(L=t.Condition)!==null&&L!==void 0?L:"any",maxAttempt:t.MaxAttempts,window:t.Window,delay:t.Delay}}(((je=m.Spec)===null||je===void 0||(je=je.TaskTemplate)===null||je===void 0?void 0:je.RestartPolicy)||{}),cpus:function(t){return t?t/1e9:0}((H=m.Spec)===null||H===void 0||(H=H.TaskTemplate)===null||H===void 0||(H=H.Resources)===null||H===void 0||(H=H.Limits)===null||H===void 0?void 0:H.NanoCPUs),memory:function(t){return t?t/1024/1024:0}((le=m.Spec)===null||le===void 0||(le=le.TaskTemplate)===null||le===void 0||(le=le.Resources)===null||le===void 0||(le=le.Limits)===null||le===void 0?void 0:le.MemoryBytes),workDir:{useDefault:!((fe=m.Spec)!==null&&fe!==void 0&&(fe=fe.TaskTemplate)!==null&&fe!==void 0&&(fe=fe.ContainerSpec)!==null&&fe!==void 0&&fe.Dir),default:"",value:(i=m.Spec)===null||i===void 0||(i=i.TaskTemplate)===null||i===void 0||(i=i.ContainerSpec)===null||i===void 0?void 0:i.Dir},user:{useDefault:!((Ee=m.Spec)!==null&&Ee!==void 0&&(Ee=Ee.TaskTemplate)!==null&&Ee!==void 0&&(Ee=Ee.ContainerSpec)!==null&&Ee!==void 0&&Ee.User),default:"",value:(ce=m.Spec)===null||ce===void 0||(ce=ce.TaskTemplate)===null||ce===void 0||(ce=ce.ContainerSpec)===null||ce===void 0?void 0:ce.User},command:{useDefault:!((Le=m.Spec)!==null&&Le!==void 0&&(Le=Le.TaskTemplate)!==null&&Le!==void 0&&(Le=Le.ContainerSpec)!==null&&Le!==void 0&&Le.Command),default:"",value:(xe=m.Spec)===null||xe===void 0||(xe=xe.TaskTemplate)===null||xe===void 0||(xe=xe.ContainerSpec)===null||xe===void 0||(xe=xe.Command)===null||xe===void 0?void 0:xe.join(" ")},log:function(t,L){return{driver:(L=t==null?void 0:t.Name)!==null&&L!==void 0?L:"json-file",maxFile:(t==null?void 0:t.Options)&&t.Options["max-file"],maxSize:(t==null?void 0:t.Options)&&t.Options["max-size"]}}((Xe=m.Spec)===null||Xe===void 0||(Xe=Xe.TaskTemplate)===null||Xe===void 0?void 0:Xe.LogDriver),dns:(we=m.Spec)===null||we===void 0||(we=we.TaskTemplate)===null||we===void 0||(we=we.ContainerSpec)===null||we===void 0||(we=we.DNSConfig)===null||we===void 0?void 0:we.Nameservers,label:((ye=m.Spec)===null||ye===void 0||(ye=ye.TaskTemplate)===null||ye===void 0||(ye=ye.ContainerSpec)===null||ye===void 0?void 0:ye.Labels)&&Object.entries((Ie=m.Spec)===null||Ie===void 0||(Ie=Ie.TaskTemplate)===null||Ie===void 0||(Ie=Ie.ContainerSpec)===null||Ie===void 0?void 0:Ie.Labels).map(function(t){return{name:t[0],value:t[1]}}),extraHosts:((Me=m.Spec)===null||Me===void 0||(Me=Me.TaskTemplate)===null||Me===void 0||(Me=Me.ContainerSpec)===null||Me===void 0?void 0:Me.Hosts)&&((y=m.Spec)===null||y===void 0||(y=y.TaskTemplate)===null||y===void 0||(y=y.ContainerSpec)===null||y===void 0?void 0:y.Hosts.map(function(t){var L=t.split(":"),ee=W()(L,2),He=ee[0],Fe=ee[1];return{name:He,value:Fe}})),capAdd:(v=m.Spec)===null||v===void 0||(v=v.TaskTemplate)===null||v===void 0||(v=v.ContainerSpec)===null||v===void 0?void 0:v.CapabilityAdd,scheduling:function(t){return{mode:t!=null&&t.Global?"global":"replicated",replicas:t!=null&&t.Replicated?t.Replicated.Replicas:1}}((S=m.Spec)===null||S===void 0?void 0:S.Mode),constraint:function(t,L,ee,He){var Fe="all";t!=null&&(L=t.Constraints)!==null&&L!==void 0&&L.includes("node.role==worker")&&(Fe="worker"),t!=null&&(ee=t.Constraints)!==null&&ee!==void 0&&ee.includes("node.role==manager")&&(Fe="manager"),t==null||(He=t.Constraints)===null||He===void 0||He.forEach(function(Qe){Qe.includes("node.id==")&&(Fe="user")});var nn="",tn=[];return t!=null&&t.Constraints&&t.Constraints.forEach(function(Qe){if(Qe.includes("node.id==")){var dn=Qe.split("node.id=="),on=W()(dn,2),_n=on[0],cn=on[1];nn=cn;return}if(Qe.includes("==")){var vn=Qe.split("=="),sn=W()(vn,2),mn=sn[0],pn=sn[1];tn.push({name:mn,value:pn,operator:"=="});return}if(Qe.includes("!=")){var fn=Qe.split("!="),un=W()(fn,2),hn=un[0],gn=un[1];tn.push({name:hn,value:gn,operator:"!="});return}}),{role:Fe,node:nn,label:tn}}((G=m.Spec)===null||G===void 0||(G=G.TaskTemplate)===null||G===void 0?void 0:G.Placement),placement:((I=m.Spec)===null||I===void 0||(I=I.TaskTemplate)===null||I===void 0||(I=I.Placement)===null||I===void 0?void 0:I.Preferences)&&Object.entries((z=m.Spec)===null||z===void 0||(z=z.TaskTemplate)===null||z===void 0||(z=z.Placement)===null||z===void 0?void 0:z.Preferences).map(function(t){var L,ee;return{name:"spread",value:(L=(ee=t[1].Spread)===null||ee===void 0?void 0:ee.SpreadDescriptor)!==null&&L!==void 0?L:""}}),update:function(t,L,ee){return{parallelism:(L=t==null?void 0:t.Parallelism)!==null&&L!==void 0?L:1,delay:(ee=t==null?void 0:t.Delay)!==null&&ee!==void 0?ee:0,failureAction:t==null?void 0:t.FailureAction,order:t==null?void 0:t.Order}}((Se=m.Spec)===null||Se===void 0?void 0:Se.UpdateConfig),healthcheck:function(t,L,ee,He,Fe,nn){var tn=t!=null&&(L=t.Test)!==null&&L!==void 0&&L.includes("CMD-SHELL")?"CMD-SHELL":"CMD";return{interval:(ee=t==null?void 0:t.Interval)!==null&&ee!==void 0?ee:30,timeout:(He=t==null?void 0:t.Timeout)!==null&&He!==void 0?He:10,retries:(Fe=t==null?void 0:t.Retries)!==null&&Fe!==void 0?Fe:3,cmd:t!=null&&t.Test?t==null||(nn=t.Test)===null||nn===void 0?void 0:nn.join(" "):"",shellType:tn}}((he=m.Spec)===null||he===void 0||(he=he.TaskTemplate)===null||he===void 0||(he=he.ContainerSpec)===null||he===void 0?void 0:he.Healthcheck)},ln=(($e=m.Spec)===null||$e===void 0?void 0:$e.Labels)&&((en=m.Spec)===null||en===void 0?void 0:en.Labels[Re.ev]);if(ln&&(an.imageRegistry=parseInt(ln)),(Je=m.Spec)!==null&&Je!==void 0&&(Je=Je.EndpointSpec)!==null&&Je!==void 0&&Je.Ports){var Ve;an.ports=(Ve=m.Spec)===null||Ve===void 0||(Ve=Ve.EndpointSpec)===null||Ve===void 0||(Ve=Ve.Ports)===null||Ve===void 0?void 0:Ve.map(function(t){var L;return{dest:String(t.TargetPort),host:String((L=t.PublishedPort)!==null&&L!==void 0?L:""),mode:t.PublishMode}})}(rn=Ue.current)===null||rn===void 0||rn.setFieldsValue(an),pe(!0)}}});var Ce=(0,r.useState)("basic"),_e=W()(Ce,2),ue=_e[0],be=_e[1],Ne=new u.Uo("components.appForm"),Ae=new u.Uo("swarm"),Ue=(0,r.useRef)(),ze=(0,r.useRef)(),ke=(0,r.useRef)(),$=(0,r.useRef)(),Q=(0,r.useRef)(),ae=(0,r.useState)(!1),de=W()(ae,2),Te=de[0],pe=de[1];return(0,s.jsx)(d.Z.Provider,{value:{createFormRef:Ue,volumeListRef:ze,createEnvRef:Q,createLinkRef:$,domainRef:ke},children:(0,s.jsx)(te.a,{drawerProps:{width:ne.R_,forceRender:j.forceRender},formRef:Ue,title:Ae.format("serviceCreateTitle.".concat(j.forceRender?"edit":"create")),onOpenChange:function(m){if(pe(m),!m){var c,O;!((c=Ue.current)===null||c===void 0)&&c.resetFields&&((O=Ue.current)===null||O===void 0||O.resetFields()),be("basic")}},open:Te,trigger:j.showTrigger?(0,s.jsx)(Z.ZP,{type:"primary",children:Ae.format("serviceCreateTitle.create")}):void 0,onFinish:function(){var Y=f()(a()().mark(function m(c){var O,_,h;return a()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return _={id:c.id,siteTitle:c.siteTitle,siteName:c.siteName,hostname:c.hostname,imageRegistry:c.imageRegistry,imageName:c.imageName,ports:c.ports,environment:c.environment,volumes:c.volumes,restartPolicy:c.restart,cpus:c.cpus,memory:c.memory,workDir:c.workDir&&!c.workDir.useDefault?c.workDir.value:"",user:c.user&&!c.user.useDefault?c.user.value:"",command:c.command&&!c.command.useDefault?c.command.value:"",entrypoint:c.entrypoint&&!c.entrypoint.useDefault?c.entrypoint.value:"",log:c.log,dns:c.dns,label:c.label,extraHosts:c.extraHosts,capAdd:c.capAdd,scheduling:c.scheduling,constraint:c.constraint,placement:c.placement,update:c.update},c.healthcheck&&c.healthcheck.cmd&&c.healthcheck.cmd!=""&&(_.healthcheck=c.healthcheck),_.scheduling&&((O=_.scheduling)===null||O===void 0?void 0:O.mode)=="global"&&_.ports&&(_.ports=(h=_.ports)===null||h===void 0?void 0:h.map(function(F){return F.mode="host",F})),w.next=5,(0,Re.P3)(_);case 5:return j.onFinish&&j.onFinish(),w.abrupt("return",!0);case 7:case"end":return w.stop()}},m)}));return function(m){return Y.apply(this,arguments)}}(),children:(0,s.jsxs)(R.Z,{direction:"column",gutter:[0,10],ghost:!0,children:[(0,s.jsxs)(R.Z,{children:[(0,s.jsx)(A.Z,{name:"id",hidden:!0}),(0,s.jsx)(me.Z,{name:"siteTitle",label:u.FD.format("listDescription"),placeholder:Ae.format("serviceCreateListDescriptionEmpty")}),(0,s.jsxs)(se.UW,{children:[(0,s.jsx)(me.Z,{width:"lg",name:"siteName",label:u.FD.format("listName"),required:!0,rules:[{required:!0}],placeholder:Ae.format("serviceCreateListNameEmpty")}),(0,s.jsx)(me.Z,{label:"Hostname",name:"hostname",width:"md"})]}),(0,s.jsx)(qe,{})]}),(0,s.jsx)(g.Z,{offsetTop:50,children:(0,s.jsx)(R.Z,{style:{marginBottom:-20},children:(0,s.jsx)(b.Z,{activeKey:ue,onChange:function(m){be(m),window.scrollTo(0,450)},items:Ne.option("createTabOption",["basic","scheduling","run-command","cap","other"]).map(function(Y){return{label:Y.label,key:Y.value}})})})}),(0,s.jsxs)(V.Z,{show:ue=="basic",children:[(0,s.jsx)(X.Z,{showIngress:!0}),(0,s.jsx)(o.Z,{showAddButton:!0,showImportButton:!0,showCodeMode:!0,ref:Q,drawerProps:{title:Ne.format("createEnvTitle")}}),(0,s.jsx)(B.Z,{showDefault:!0,ref:ze,showType:!0}),(0,s.jsx)(U.Z,{})]}),(0,s.jsxs)(V.Z,{show:ue=="scheduling",children:[(0,s.jsx)(Be,{}),(0,s.jsx)(M,{})]}),(0,s.jsxs)(V.Z,{show:ue=="run-command",children:[(0,s.jsx)(P,{}),(0,s.jsx)(p.Z,{showCommand:!0,showUser:!0,showWorkDir:!0}),(0,s.jsx)(Pe.Z,{}),(0,s.jsx)(Ke.Z,{}),(0,s.jsx)(l.Z,{}),(0,s.jsx)(Ye.Z,{})]}),(0,s.jsx)(V.Z,{show:ue=="other",children:(0,s.jsx)(E.Z,{})}),(0,s.jsx)(V.Z,{show:ue=="cap",children:(0,s.jsx)(J.Z,{})})]})})})}),k=N},94617:function(We,ie,e){e.d(ie,{Z:function(){return ke}});var oe=e(15009),a=e.n(oe),ve=e(99289),f=e.n(ve),x=e(97857),W=e.n(x),ne=e(5574),te=e.n(ne),A=e(24494),Z=e(5251),r=e(36146),U=e(86548),E=e(1883),J=e(74763),o=e(56729),X=e(42075),B=e(66309),V=e(25593),R=e(96074),me=e(83062),se=e(60940),g=e(37413),b=e(94359),u=e(67294),d=e(87662),re=e(78451),De=e(3616),Ge=e(33160),s=e(43425),qe=e(57132),Ze=e(71965),C=e(48689),q=e(45605),Oe=e(60433),ge=e(38345),Re=e(97269),Be=e(24739),Pe=e(31199),Ke=e(62370),p=e(64317),P=e(85265),M=e(86250),l=e(83622),Ye=e(84567),N=e(26412),k=e(80821),j=e(76428),n=e(85893);function Ce($){var Q,ae,de=new r.Uo("swarm"),Te=$.detail;if((Q=Te.Spec)!==null&&Q!==void 0&&(Q=Q.Mode)!==null&&Q!==void 0&&Q.Replicated){var pe;return(0,n.jsxs)(X.Z,{children:[(0,n.jsx)(B.Z,{children:de.format("listServiceMode.replicated")}),(0,n.jsx)(B.Z,{color:"success",bordered:!1,children:(pe=Te.ServiceStatus)===null||pe===void 0?void 0:pe.RunningTasks}),(0,n.jsx)(B.Z,{color:"gold",bordered:!1,children:Te.Spec.Mode.Replicated.Replicas})]})}else if((ae=Te.Spec)!==null&&ae!==void 0&&(ae=ae.Mode)!==null&&ae!==void 0&&ae.Global)return(0,n.jsx)(B.Z,{children:de.format("listServiceMode.global")})}var _e=e(81146);function ue($){var Q=(0,u.useState)(!1),ae=te()(Q,2),de=ae[0],Te=ae[1],pe=(0,u.useRef)();return(0,n.jsxs)(n.Fragment,{children:[$.trigger?u.cloneElement($.trigger,{onClick:function(){Te(!0)}}):null,(0,n.jsx)(P.Z,{title:"".concat(r.FD.format("listLog")," - ").concat($.detail.name),open:de,forceRender:!0,onClose:function(){Te(!1)},afterOpenChange:function(m){if(m)setTimeout(function(){var O,_;(O=pe.current)===null||O===void 0||O.start(),(_=pe.current)===null||_===void 0||_.fit()},1e3);else{var c;(c=pe.current)===null||c===void 0||c.close()}},width:De.FK,children:de&&(0,n.jsx)(_e.Z,{ref:pe,showInDrawer:!0,id:"swarm:log:".concat($.type,":").concat($.detail.id),request:function(){var Y=f()(a()().mark(function m(c){var O;return a()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,A.m8)({id:$.detail.id,type:$.type,lineTotal:c.lineTotal,download:(O=c.download)!==null&&O!==void 0?O:!1,showTime:c.showTime});case 2:case"end":return h.stop()}},m)}));return function(m){return Y.apply(this,arguments)}}(),download:function(){var Y=f()(a()().mark(function m(c){var O;return a()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,A.Id)({id:$.detail.id,type:$.type,lineTotal:c.lineTotal,showTime:c.showTime,download:!0});case 2:return O=h.sent,h.abrupt("return",{data:new Blob([O],{type:"text/plain"}),name:$.detail.name+"_"+new Date().toLocaleDateString()+".log"});case 4:case"end":return h.stop()}},m)}));return function(m){return Y.apply(this,arguments)}}()})})]})}var be=e(98093),Ne=e(67255),Ae=(0,u.forwardRef)(function($,Q){var ae,de,Te,pe,Y,m,c,O,_,h,K,w,F;(0,u.useImperativeHandle)(Q,function(){return{show:function(v){Ee(v),H(!0)}}});var D=(0,u.useState)(!1),T=te()(D,2),je=T[0],H=T[1],le=(0,u.useState)(),fe=te()(le,2),i=fe[0],Ee=fe[1],ce=new r.Uo("swarm"),Le=(0,u.useState)(""),xe=te()(Le,2),Xe=xe[0],we=xe[1],ye=(0,u.useRef)(),Ie=(0,u.useRef)(),Me=(0,u.useRef)();return(0,u.useEffect)(function(){(0,d.K3)().then(function(y){var v;we((v=y.data.serverUrl)!==null&&v!==void 0?v:"")})},[]),(0,n.jsxs)(P.Z,{title:ce.format("serviceDetailTitle",{name:i==null||(ae=i.Spec)===null||ae===void 0?void 0:ae.Name}),open:je,forceRender:!0,width:De.R_,onClose:function(){H(!1),Ee(void 0),$.onFinish&&$.onFinish()},extra:[i&&(0,n.jsx)(k.Z,{type:"link",tips:r.FD.format("listManageRefresh"),action:f()(a()().mark(function y(){var v,S;return a()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,(0,A.ig)({id:i.ID});case 2:S=I.sent,Ee(S.data.info),!((v=Me.current)===null||v===void 0)&&v.reloadAndRest&&Me.current.reloadAndRest();case 5:case"end":return I.stop()}},y)})),icon:(0,n.jsx)(Ge.Z,{})},"refresh")],children:[(0,n.jsx)(be.Z,{forceRender:!0,ref:Ie,onFinish:f()(a()().mark(function y(){var v,S;return a()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,(0,A.ig)({id:(v=i==null?void 0:i.ID)!==null&&v!==void 0?v:""});case 2:S=I.sent,Ee(S.data.info);case 4:case"end":return I.stop()}},y)}))}),(0,n.jsxs)(M.Z,{vertical:!0,gap:20,children:[(0,n.jsx)(ge.Z,{title:(0,n.jsx)(s.Z,{}),ghost:!0,subTitle:r.FD.format("listManage"),children:(0,n.jsxs)(X.Z,{wrap:!0,children:[i&&(0,n.jsx)(l.ZP,{type:"primary",icon:(0,n.jsx)(U.Z,{}),onClick:function(){var v;(v=Ie.current)===null||v===void 0||v.edit(i)},children:r.FD.format("listManageEdit")}),(0,n.jsx)(R.Z,{type:"vertical"}),i&&(0,n.jsx)(ue,{type:"service",detail:{id:(de=i.ID)!==null&&de!==void 0?de:"",name:(Te=(pe=i.Spec)===null||pe===void 0?void 0:pe.Name)!==null&&Te!==void 0?Te:""},trigger:(0,n.jsx)(l.ZP,{icon:(0,n.jsx)(E.Z,{}),children:r.FD.format("listManageLog")},"log")}),(i==null||(Y=i.Spec)===null||Y===void 0||(Y=Y.Mode)===null||Y===void 0?void 0:Y.Replicated)&&(0,n.jsx)(k.Z,{confirmProps:{forceRender:!0},action:f()(a()().mark(function y(){var v,S,G;return a()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.abrupt("return",(0,A.x$)({name:(v=i==null?void 0:i.ID)!==null&&v!==void 0?v:"",replicas:(S=ye.current)===null||S===void 0?void 0:S.getFieldValue("replicas"),force:(G=ye.current)===null||G===void 0?void 0:G.getFieldValue("force")}));case 1:case"end":return z.stop()}},y)})),confirmOnOpenChange:function(){var v,S;(v=ye.current)===null||v===void 0||v.setFieldsValue({replicas:(S=i.Spec)===null||S===void 0||(S=S.Mode)===null||S===void 0||(S=S.Replicated)===null||S===void 0?void 0:S.Replicas,force:!1})},confirm:(0,n.jsx)(Re.A,{layout:"inline",submitter:!1,formRef:ye,children:(0,n.jsxs)(X.Z,{direction:"vertical",size:[0,15],style:{width:600},children:[(0,n.jsx)(V.Z.Text,{children:ce.format("serviceManageScalingTip")}),(0,n.jsxs)(Be.UW,{children:[(0,n.jsx)(Pe.Z,{label:ce.format("serviceManageScalingReplicas"),width:"sm",name:"replicas"}),(0,n.jsx)(Ke.Z,{name:"force",valuePropName:"checked",children:(0,n.jsxs)(Ye.Z,{children:[r.FD.format("listManageDeployForce"),"\uFF1F"]})})]})]})}),onSuccess:function(){(0,A.ig)({id:i.ID}).then(function(v){Ee(v.data.info)})},icon:(0,n.jsx)(qe.Z,{}),children:r.FD.format("listManageScaling")}),i&&(0,n.jsx)(k.Z,{action:function(){return(0,A.x$)({name:i.ID,rollback:!0})},icon:(0,n.jsx)(Ze.Z,{}),confirm:"notification.confirm.title",children:r.FD.format("listManageRollback")}),(0,n.jsx)(k.Z,{showDivider:!0,action:function(){var v;return(0,A.tm)({name:[(v=i==null?void 0:i.ID)!==null&&v!==void 0?v:""]})},type:"primary",danger:!0,onSuccess:function(v){H(!1),$.onFinish&&$.onFinish()},confirm:"notification.confirm.title",icon:(0,n.jsx)(C.Z,{}),children:r.FD.format("listManageDelete")})]})}),i&&(0,n.jsx)(g.Z,{publicPort:((m=i.Endpoint)===null||m===void 0?void 0:m.Ports)&&((c=i.Endpoint)===null||c===void 0?void 0:c.Ports.map(function(y){var v,S,G;return{PrivatePort:(v=y.TargetPort)!==null&&v!==void 0?v:0,Type:(S=y.Protocol)!==null&&S!==void 0?S:"tcp",IP:"",PublicPort:(G=y.PublishedPort)!==null&&G!==void 0?G:0}})),serverIp:Xe,showInDetail:!0,ghost:!0,layout:"inline"}),(0,n.jsx)(ge.Z,{title:(0,n.jsx)(q.Z,{}),subTitle:r.FD.format("listManageDetail"),ghost:!0,children:(0,n.jsxs)(N.Z,{column:1,bordered:!0,styles:{label:{width:150}},children:[(0,n.jsxs)(N.Z.Item,{label:r.FD.format("listTitle"),children:[(0,n.jsx)(j.Z,{title:i==null?void 0:i.ID})," - ",i==null||(O=i.Spec)===null||O===void 0?void 0:O.Name,i&&((_=i.UpdateStatus)===null||_===void 0?void 0:_.State)&&(0,n.jsxs)(n.Fragment,{children:[" - ",(0,n.jsx)(b.Z,{status:"service.".concat((h=i.UpdateStatus)===null||h===void 0?void 0:h.State)})]})]}),(0,n.jsx)(N.Z.Item,{label:r.FD.format("listDescription"),children:(i==null||(K=i.Spec)===null||K===void 0?void 0:K.Labels)&&i.Spec.Labels[A.$m]}),(0,n.jsx)(N.Z.Item,{label:r.FD.format("listRunTask"),children:(0,n.jsx)(X.Z,{children:(i==null?void 0:i.ServiceStatus)&&Object.keys(i.ServiceStatus).map(function(y){var v=y;return(i==null?void 0:i.ServiceStatus)&&(0,n.jsx)(me.Z,{title:ce.format("listServiceStatusTip.".concat(v)),children:(0,n.jsxs)(B.Z,{color:ce.format("listServiceStatusColor.".concat(v)),bordered:!1,children:[ce.format("listServiceStatus.".concat(v))," ",i==null?void 0:i.ServiceStatus[v]]})},v)})})}),(0,n.jsx)(N.Z.Item,{label:r.FD.format("listServiceMode"),children:i&&(0,n.jsx)(Ce,{detail:i})}),(0,n.jsx)(N.Z.Item,{label:r.FD.format("listImageName"),children:i==null||(w=i.Spec)===null||w===void 0||(w=w.TaskTemplate)===null||w===void 0||(w=w.ContainerSpec)===null||w===void 0?void 0:w.Image}),(0,n.jsx)(N.Z.Item,{label:r.FD.format("listVersion"),children:i==null||(F=i.Version)===null||F===void 0?void 0:F.Index}),(0,n.jsx)(N.Z.Item,{label:r.FD.format("listCreatedAt"),children:(0,Z.NF)(i==null?void 0:i.CreatedAt)}),(0,n.jsx)(N.Z.Item,{label:r.FD.format("listUpdatedAt"),children:(0,Z.NF)(i==null?void 0:i.UpdatedAt)})]})}),i&&(0,n.jsx)(ge.Z,{title:(0,n.jsx)(Oe.Z,{}),subTitle:ce.format("listTaskTitle"),ghost:!0,children:(0,n.jsx)(o.Z,{scroll:{x:"max-content"},rowKey:"ID",search:{filterType:"light"},actionRef:Me,columns:[{search:!1,title:r.FD.format("listName"),render:function(v,S,G,I,z){return S.ID}},{search:!1,width:200,title:r.FD.format("listNodeName"),render:function(v,S,G,I,z){return S.NodeID}},{search:!1,width:50,title:r.FD.format("listSlot"),render:function(v,S,G,I,z){return S.Slot}},{key:"status",renderFormItem:function(v,S,G,I){return(0,n.jsx)(p.Z,{name:"status",valueEnum:Object.fromEntries(ce.option("listTaskStatusOption",["running","shutdown","accepted"]).map(function(z){return[z.value,z.label]}))})},width:120,title:r.FD.format("listRunStatus"),render:function(v,S,G){var I;if(S.Status.State!="running"){var z;return(0,n.jsx)(b.Z,{status:"task.".concat(S.Status.State),tip:(z=S.Status.Err)!==null&&z!==void 0?z:S.Status.Message})}return(0,n.jsx)(b.Z,{status:"task.".concat(S.DesiredState),tip:(I=S.Status.Err)!==null&&I!==void 0?I:S.Status.Message})}},{search:!1,width:180,title:r.FD.format("listUpdatedAt"),render:function(v,S,G,I,z){return(0,Z.NF)(S.UpdatedAt)}},{search:!1,width:100,title:r.FD.format("listManage"),fixed:"right",render:function(v,S,G,I,z){var Se,he;return(0,n.jsx)(X.Z,{children:(0,n.jsx)(ue,{type:"node",detail:{id:(Se=S.ID)!==null&&Se!==void 0?Se:"",name:(he=S.ID)!==null&&he!==void 0?he:""},trigger:(0,n.jsx)(V.Z.Link,{children:(0,n.jsx)(E.Z,{})})})})}}],request:function(){var y=f()(a()().mark(function v(S){var G,I;return a()().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return Se.next=2,(0,A.XX)({serviceName:i==null?void 0:i.ID,status:S.status});case 2:return G=Se.sent,Se.next=5,(0,A.HN)();case 5:return I=Se.sent,Se.abrupt("return",{data:G.data.list.map(function(he){var $e,en=I&&(($e=I.data.list.find(function(Je){return Je.ID==he.NodeID}))===null||$e===void 0||($e=$e.Description)===null||$e===void 0?void 0:$e.Hostname);return en&&(he.NodeID=en),he}),success:!0,total:G.data.list.length});case 7:case"end":return Se.stop()}},v)}));return function(v){return y.apply(this,arguments)}}(),pagination:(0,Ne.Oh)()})})]})]})}),Ue=Ae,ze=(0,u.forwardRef)(function($,Q){(0,u.useImperativeHandle)(Q,function(){return{reload:function(){var _;!((_=m.current)===null||_===void 0)&&_.reloadAndRest&&m.current.reloadAndRest()}}});var ae=(0,u.useState)(""),de=te()(ae,2),Te=de[0],pe=de[1],Y=(0,u.useRef)(),m=(0,u.useRef)();(0,u.useEffect)(function(){(0,d.K3)().then(function(O){var _;pe((_=O.data.serverUrl)!==null&&_!==void 0?_:"")})},[]);var c={};return $.showManage||(c=W()(W()({},c),{})),(0,J.k)($.showSearch)&&(c=W()(W()({},c),{search:!1})),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ue,{ref:Y,onFinish:function(){var _;!((_=m.current)===null||_===void 0)&&_.reloadAndRest&&m.current.reloadAndRest()}}),(0,n.jsx)(o.Z,W()(W()({},c),{},{ghost:!0,actionRef:m,scroll:{x:"max-content"},rowKey:"ID",columns:[{key:"serviceName",title:r.FD.format("listServiceName"),render:function(_,h,K,w,F){var D,T=0;return h.Task&&h.Task.forEach(function(je){je.Status.State=="running"&&(T+=1)}),(0,n.jsxs)(X.Z,{children:[h.Task&&(0,n.jsx)(B.Z,{color:"success",bordered:!1,children:T}),(0,n.jsx)(V.Z.Link,{onClick:function(){var H;(H=Y.current)===null||H===void 0||H.show(h)},children:(D=h.Spec)===null||D===void 0?void 0:D.Name})]})}},{width:150,search:!1,title:r.FD.format("listPort"),render:function(_,h,K,w,F){var D,T,je=[];return!((D=h.Endpoint)===null||D===void 0)&&D.Ports&&((T=h.Endpoint)===null||T===void 0||T.Ports.map(function(H){var le,fe,i;je.push({PrivatePort:(le=H.TargetPort)!==null&&le!==void 0?le:0,Type:(fe=H.Protocol)!==null&&fe!==void 0?fe:"tcp",IP:"0.0.0.0",PublicPort:(i=H.PublishedPort)!==null&&i!==void 0?i:0})})),(0,n.jsx)(g.Z,{ghost:!0,publicPort:je,serverIp:Te})}},{width:150,search:!1,title:r.FD.format("listServiceMode"),render:function(_,h,K,w,F){return(0,n.jsx)(Ce,{detail:h})}},{hidden:!$.showImageName,width:400,search:!1,title:r.FD.format("listImageName"),render:function(_,h,K,w,F){var D,T=((D=h.Spec)===null||D===void 0||(D=D.TaskTemplate)===null||D===void 0||(D=D.ContainerSpec)===null||D===void 0?void 0:D.Image)||"",je=T.includes("@")?T.split("@"):[T,null],H=te()(je,2),le=H[0],fe=H[1];return(0,n.jsx)(re.Z,{children:le})}},{search:!1,width:180,title:r.FD.format("listCreatedAt"),render:function(_,h,K,w,F){return(0,Z.NF)(h.CreatedAt)}},{search:!1,width:180,title:r.FD.format("listUpdatedAt"),render:function(_,h,K,w,F){return(0,Z.NF)(h.UpdatedAt)}},{hidden:!$.showManage,search:!1,title:r.FD.format("listManage"),width:100,fixed:"right",render:function(_,h,K,w,F){return(0,n.jsx)(X.Z,{split:(0,n.jsx)(R.Z,{type:"vertical"}),children:$.showManage&&$.showManage.onEdit&&(0,n.jsx)(V.Z.Link,{onClick:function(){var T;!((T=$.showManage)===null||T===void 0)&&T.onEdit&&$.showManage.onEdit(h)},children:(0,n.jsx)(me.Z,{title:r.FD.format("listManageEdit"),children:(0,n.jsx)(U.Z,{})})},"edit")})}}],request:function(){var O=f()(a()().mark(function _(h){var K,w,F;return a()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!$.showWithNodeId){T.next=7;break}return T.next=3,(0,A.rN)({nodeId:(K=$.showWithNodeId)!==null&&K!==void 0?K:""});case 3:return w=T.sent,T.abrupt("return",{data:w.data.list,total:w.data.list.length,success:!0});case 7:return T.next=9,(0,A.kM)({name:h.serviceName});case 9:return F=T.sent,T.abrupt("return",{data:F.data.list,total:F.data.list.length,success:!0});case 11:case"end":return T.stop()}},_)}));return function(_){return O.apply(this,arguments)}}(),expandable:$.showWithNodeId?{expandRowByClick:!0,rowExpandable:function(_){return _.Task&&_.Task.length>0&&_.Task.filter(function(h){return h.Status.State=="running"}).length>0},expandedRowRender:function(_){return(0,n.jsx)(se.Z,{rowKey:"ID",columns:[{title:r.FD.format("listName"),render:function(K,w,F){return w.ID}},{width:120,title:r.FD.format("listRunStatus"),render:function(K,w,F){var D;return(0,n.jsx)(b.Z,{status:"task.".concat(w.Status.State),tip:(D=w.Status.Err)!==null&&D!==void 0?D:w.Status.Message})}},{title:r.FD.format("listUpdatedAt"),width:180,render:function(K,w,F){return(0,Z.NF)(w.UpdatedAt)}},{width:100,title:r.FD.format("listManage"),fixed:"right",render:function(K,w,F){var D,T;return(0,n.jsx)(X.Z,{children:(0,n.jsx)(ue,{type:"node",detail:{id:(D=w.ID)!==null&&D!==void 0?D:"",name:(T=w.ID)!==null&&T!==void 0?T:""},trigger:(0,n.jsx)(V.Z.Link,{children:(0,n.jsx)(E.Z,{})})})})}}],pagination:!1,dataSource:_.Task.filter(function(h){return h.Status.State=="running"})})}}:void 0}))]})}),ke=ze},76428:function(We,ie,e){e.d(ie,{Z:function(){return f}});var oe=e(25593),a=e(67294),ve=e(85893);function f(x){return(0,ve.jsx)(oe.Z.Text,{copyable:!0,children:x.title})}},12323:function(We,ie,e){e.d(ie,{X:function(){return oe},n:function(){return a}});var oe={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},a=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},24494:function(We,ie,e){e.d(ie,{$m:function(){return W},HN:function(){return X},Id:function(){return J},JC:function(){return te},P3:function(){return Re},QB:function(){return g},UK:function(){return Z},XX:function(){return re},Zc:function(){return V},ev:function(){return ne},ig:function(){return Pe},kM:function(){return qe},kp:function(){return u},m8:function(){return U},rN:function(){return Ge},tm:function(){return Oe},vb:function(){return me},x$:function(){return C}});var oe=e(15009),a=e.n(oe),ve=e(99289),f=e.n(ve),x=e(82346),W="com.dpanel.swarm.service.description",ne="com.dpanel.swarm.service.registry";function te(){return A.apply(this,arguments)}function A(){return A=f()(a()().mark(function p(){return a()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.abrupt("return",(0,x.request)("/api/app/swarm/info",{method:"POST"}));case 1:case"end":return M.stop()}},p)})),A.apply(this,arguments)}function Z(p){return r.apply(this,arguments)}function r(){return r=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/init",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),r.apply(this,arguments)}function U(p){return E.apply(this,arguments)}function E(){return E=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return P.id=String(P.id),l.abrupt("return",(0,x.request)("/api/app/swarm/log",{method:"POST",data:P}));case 2:case"end":return l.stop()}},p)})),E.apply(this,arguments)}function J(p){return o.apply(this,arguments)}function o(){return o=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return P.download=!0,P.id=String(P.id),l.next=4,(0,x.request)("/api/app/swarm/log",{method:"POST",data:P,responseType:"blob"});case 4:return l.abrupt("return",l.sent);case 5:case"end":return l.stop()}},p)})),o.apply(this,arguments)}function X(p){return B.apply(this,arguments)}function B(){return B=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/node-list",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),B.apply(this,arguments)}function V(p){return R.apply(this,arguments)}function R(){return R=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/node-update",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),R.apply(this,arguments)}function me(p){return se.apply(this,arguments)}function se(){return se=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/info-join",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),se.apply(this,arguments)}function g(p){return b.apply(this,arguments)}function b(){return b=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/node-remove",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),b.apply(this,arguments)}function u(p){return d.apply(this,arguments)}function d(){return d=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/node-prune",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),d.apply(this,arguments)}function re(p){return De.apply(this,arguments)}function De(){return De=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/task-list",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),De.apply(this,arguments)}function Ge(p){return s.apply(this,arguments)}function s(){return s=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/task-list-in-node",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),s.apply(this,arguments)}function qe(p){return Ze.apply(this,arguments)}function Ze(){return Ze=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/service-list",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),Ze.apply(this,arguments)}function C(p){return q.apply(this,arguments)}function q(){return q=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/service-scaling",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),q.apply(this,arguments)}function Oe(p){return ge.apply(this,arguments)}function ge(){return ge=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/service-delete",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),ge.apply(this,arguments)}function Re(p){return Be.apply(this,arguments)}function Be(){return Be=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/service-create",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),Be.apply(this,arguments)}function Pe(p){return Ke.apply(this,arguments)}function Ke(){return Ke=f()(a()().mark(function p(P){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,x.request)("/api/app/swarm/service-detail",{method:"POST",data:P}));case 1:case"end":return l.stop()}},p)})),Ke.apply(this,arguments)}},3393:function(We,ie,e){e.d(ie,{Gb:function(){return te},Pn:function(){return U},Rb:function(){return J},YU:function(){return W},ZQ:function(){return V},_U:function(){return Z},cD:function(){return me},cd:function(){return X}});var oe=e(15009),a=e.n(oe),ve=e(99289),f=e.n(ve),x=e(82346);function W(g){return ne.apply(this,arguments)}function ne(){return ne=f()(a()().mark(function g(b){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,x.request)("/api/app/image/get-detail",{method:"POST",data:b}));case 1:case"end":return d.stop()}},g)})),ne.apply(this,arguments)}function te(g){return A.apply(this,arguments)}function A(){return A=f()(a()().mark(function g(b){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,x.request)("/api/app/image/tag-remote",{method:"POST",data:b}));case 1:case"end":return d.stop()}},g)})),A.apply(this,arguments)}function Z(g){return r.apply(this,arguments)}function r(){return r=f()(a()().mark(function g(b){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,x.request)("/api/app/image/tag-add",{method:"POST",data:b}));case 1:case"end":return d.stop()}},g)})),r.apply(this,arguments)}function U(g){return E.apply(this,arguments)}function E(){return E=f()(a()().mark(function g(b){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,x.request)("/api/app/image/tag-delete",{method:"POST",data:b}));case 1:case"end":return d.stop()}},g)})),E.apply(this,arguments)}function J(g){return o.apply(this,arguments)}function o(){return o=f()(a()().mark(function g(b){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,x.request)("/api/app/image/export",{method:"POST",data:b,responseType:"blob"}));case 1:case"end":return d.stop()}},g)})),o.apply(this,arguments)}function X(g){return B.apply(this,arguments)}function B(){return B=f()(a()().mark(function g(b){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,x.request)("/api/pro/image/get-remote-tag",{method:"POST",data:b}));case 1:case"end":return d.stop()}},g)})),B.apply(this,arguments)}function V(g){return R.apply(this,arguments)}function R(){return R=f()(a()().mark(function g(b){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,x.request)("/api/app/image/check-upgrade",{method:"POST",data:b}));case 1:case"end":return d.stop()}},g)})),R.apply(this,arguments)}function me(g){return se.apply(this,arguments)}function se(){return se=f()(a()().mark(function g(b){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,x.request)("/api/pro/image/get-rootfs",{method:"POST",data:b}));case 1:case"end":return d.stop()}},g)})),se.apply(this,arguments)}},67255:function(We,ie,e){e.d(ie,{G$:function(){return x},LX:function(){return A},MJ:function(){return f},Oh:function(){return ve},h5:function(){return ne},j_:function(){return W},rj:function(){return te}});var oe=e(5574),a=e.n(oe);function ve(Z){var r=localStorage.getItem("dpanel-pagesize");return r=="all"?!1:{defaultCurrent:Z==null?void 0:Z.page,showSizeChanger:!0,defaultPageSize:parseInt(r!=null?r:"20"),showQuickJumper:!0}}function f(Z,r){r?localStorage.setItem("dpanel-page-"+Z,"".concat(r)):localStorage.removeItem("dpanel-page-"+Z)}function x(Z,r){var U=r?Math.ceil((r==null?void 0:r.total)/(r==null?void 0:r.pageSize)):void 0,E=localStorage.getItem("dpanel-page-"+Z),J=1;return E&&(J=parseInt(E)),U&&J>U?1:J}function W(Z){return{persistenceKey:Z,persistenceType:"localStorage"}}var ne=["descend","ascend"];function te(Z,r){var U=localStorage.getItem("dpanel-table-sort-".concat(Z));if(U){var E=U.split("|"),J=a()(E,2),o=J[0],X=J[1];if(o==r)return X}}function A(Z,r,U){!r||!U?localStorage.removeItem("dpanel-table-sort-".concat(Z)):localStorage.setItem("dpanel-table-sort-".concat(Z),"".concat(r,"|").concat(U))}}}]);
