"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9244],{99922:function(De,ae,e){var se=e(97857),A=e.n(se),X=e(15009),t=e.n(X),ie=e(99289),h=e.n(ie),H=e(5574),B=e.n(H),o=e(67294),j=e(85265),ee=e(42075),T=e(83622),M=e(49610),F=e(3616),L=e(24905),ne=e(90581),fe=e(5251),de=e(36146),he=e(95591),k=e(85893),ve=new de.Uo("components.console"),_e=(0,o.forwardRef)(function(Oe,G){var g,ce,b,I=(0,o.useRef)(),R=(0,o.useRef)(),z=(0,o.useState)(!1),te=B()(z,2),Z=te[0],le=te[1],J=(0,o.useState)(),q=B()(J,2),p=q[0],be=q[1];return(0,o.useImperativeHandle)(G,function(){return{show:function(N){return h()(t()().mark(function Ce(){var Te;return t()().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:be(N),le(!0),(Te=I.current)===null||Te===void 0||Te.resetFields();case 3:case"end":return xe.stop()}},Ce)}))()}}}),(0,o.useEffect)(function(){return setTimeout(function(){var Q;p&&((Q=R.current)===null||Q===void 0||Q.start(p.url,{cmd:p&&p.cmd,workDir:p&&p.workDir}))},1e3),function(){var Q;(Q=R.current)===null||Q===void 0||Q.close()}},[p,Z]),(0,k.jsxs)(j.Z,{forceRender:!0,width:F.FK,open:Z,onClose:function(){return[le(!1)]},title:ve.format("drawerTitle",{name:(0,fe.fi)((g=p==null?void 0:p.title)!==null&&g!==void 0?g:"","/")}),children:[(0,k.jsxs)(ee.Z,{style:{marginBottom:20},children:[Oe.showFileExplorer&&(0,k.jsx)(L.Z,{trigger:(0,k.jsx)(T.ZP,{icon:(0,k.jsx)(he.Z,{}),type:"primary",children:de.FD.format("listManageFilePath")}),type:"container",title:(0,fe.fi)((ce=p==null?void 0:p.title)!==null&&ce!==void 0?ce:"","/"),name:p&&p.url&&(b=p.url.split("/").pop())!==null&&b!==void 0?b:""}),(0,k.jsx)(ne.Z,{onChangeShell:function(N){var Ce;if(!p)return!1;(Ce=R.current)===null||Ce===void 0||Ce.close(),be(A()(A()({},p),{cmd:N!=null?N:p==null?void 0:p.cmd}))},onOpenNewWindow:function(N){return p?(N.workDir=p&&p.workDir?p.workDir:"","".concat(p.url,"?").concat(Object.keys(N).map(function(Ce){return"".concat(Ce,"=").concat(encodeURIComponent(N[Ce]))}).join("&"))):""},onOpenNewWindowFinish:function(){var N;(N=R.current)===null||N===void 0||N.close(),le(!1)},onBatchCommandFinish:function(N){R.current&&R.current.run(N)}})]}),Z&&(0,k.jsx)(M.Z,{height:"80vh",ref:R})]})});ae.Z=_e},24905:function(De,ae,e){e.d(ae,{Z:function(){return vn}});var se=e(97857),A=e.n(se),X=e(15009),t=e.n(X),ie=e(99289),h=e.n(ie),H=e(5574),B=e.n(H),o=e(67294),j=e(82346);function ee(r,s){return T.apply(this,arguments)}function T(){return T=h()(t()().mark(function r(s,u){var l;return t()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return l="/api/".concat(s,"/explorer/get-path-list"),W.next=3,(0,j.request)(l,{data:u,method:"POST"});case 3:return W.abrupt("return",W.sent);case 4:case"end":return W.stop()}},r)})),T.apply(this,arguments)}function M(r,s){return F.apply(this,arguments)}function F(){return F=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/export"),{data:u,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),F.apply(this,arguments)}function L(r,s){return ne.apply(this,arguments)}function ne(){return ne=_asyncToGenerator(_regeneratorRuntime().mark(function r(s,u){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u.enableExportHost=!0,n.next=3,request("/api/".concat(s,"/explorer/export"),{data:u,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},r)})),ne.apply(this,arguments)}function fe(r,s){return de.apply(this,arguments)}function de(){return de=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/import"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),de.apply(this,arguments)}function he(r,s){return k.apply(this,arguments)}function k(){return k=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/delete"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),k.apply(this,arguments)}function ve(r,s){return _e.apply(this,arguments)}function _e(){return _e=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/unzip"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),_e.apply(this,arguments)}function Oe(r,s){return G.apply(this,arguments)}function G(){return G=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/get-content"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),G.apply(this,arguments)}function g(r,s){return ce.apply(this,arguments)}function ce(){return ce=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/import-file-content"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ce.apply(this,arguments)}function b(r,s){return I.apply(this,arguments)}function I(){return I=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/mkdir"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),I.apply(this,arguments)}function R(r,s){return z.apply(this,arguments)}function z(){return z=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/chmod"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),z.apply(this,arguments)}function te(r,s){return Z.apply(this,arguments)}function Z(){return Z=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/get-user-list"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),Z.apply(this,arguments)}function le(r,s){return J.apply(this,arguments)}function J(){return J=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/get-file-stat"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),J.apply(this,arguments)}function q(r,s){return p.apply(this,arguments)}function p(){return p=h()(t()().mark(function r(s,u){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.request)("/api/".concat(s,"/explorer/attach-volume"),{data:u,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),p.apply(this,arguments)}function be(r){return Q.apply(this,arguments)}function Q(){return Q=h()(t()().mark(function r(s){return t()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,j.request)("/api/".concat(s,"/explorer/destroy-proxy-container"),{data:{},method:"POST"});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},r)})),Q.apply(this,arguments)}var N=e(31112),Ce=e(51042),Te=e(82061),Ue=e(42075),xe=e(83622),Ae=e(80821),Ke=e(88484),Ze=e(37476),Ne=e(91604),we=e(3616),ge=e(36146),$e=e(4813),a=e(85893);function He(){var r=(0,o.useRef)(),s=(0,o.useContext)(N.Z),u=s.refresh,l=s.name,n=s.apiPrefix,W=s.currentPath,S=new ge.Uo("components.explorer");return(0,a.jsx)(Ze.Y,{modalProps:{width:we.ob},formRef:r,trigger:(0,a.jsx)(xe.ZP,{icon:(0,a.jsx)(Ke.Z,{}),children:S.format("toolbarUploadButton")}),title:S.format("toolbarUploadModalTitle"),onFinish:function(){var y=h()(t()().mark(function D(E){var K,P;return t()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return P=[],E.importFileList&&E.importFileList.map(function(oe){P.push({name:oe.name,path:oe.response.data.path})}),fe(n,{fileList:P,name:l,destPath:W}),(K=r.current)===null||K===void 0||K.resetFields(),u(),pe.abrupt("return",!0);case 6:case"end":return pe.stop()}},D)}));return function(D){return y.apply(this,arguments)}}(),children:(0,a.jsx)(Ne.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(D){return new Promise(function(E){var K;(0,$e._)({path:(K=D.response.data.path)!==null&&K!==void 0?K:""}).then(function(P){E(!0)})})}}})})}var ke=e(23430),ze=e(93162),Re=e(24963);function Ve(r){var s=(0,o.useContext)(N.Z),u=s.name,l=s.apiPrefix,n=(0,o.useContext)(Re.Z),W=n.message,S=new ge.Uo("components.explorer");return(0,a.jsx)(Ae.Z,{action:h()(t()().mark(function y(){return t()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(!r.selectFileList||r.selectFileList.length==0)){E.next=3;break}return W.info(S.format("commonMessageNoSelect")),E.abrupt("return",!1);case 3:return E.abrupt("return",M(l,{name:u,fileList:r.selectFileList}));case 4:case"end":return E.stop()}},y)})),onSuccess:function(D){var E=new Blob([D],{type:"application/zip"});(0,ze.saveAs)(E,"export.zip")},buttonProps:{icon:(0,a.jsx)(ke.Z,{})},children:S.format("toolbarExportButton")})}var Fe=e(38345),je=e(63434),Ge=e(24739),ye=e(5966),Se=e(12119);function Je(r){var s=(0,o.useContext)(Re.Z),u=s.notice,l=(0,o.useRef)(),n=(0,o.useContext)(N.Z),W=n.refresh,S=n.name,y=n.apiPrefix,D=(0,o.useState)(!1),E=B()(D,2),K=E[0],P=E[1],m=new ge.Uo("components.explorer"),pe=function(c){var d=c.split(""),_=0,f=0,$=0;return d[1]=="r"&&(_+=4),d[2]=="w"&&(_+=2),d[3]=="x"&&(_+=1),d[4]=="r"&&(f+=4),d[5]=="w"&&(f+=2),d[6]=="x"&&(f+=1),d[7]=="r"&&($+=4),d[8]=="w"&&($+=2),d[9]=="x"&&($+=1),"".concat(_).concat(f).concat($)},oe=function(c){var d;if((d=l.current)===null||d===void 0||d.setFieldValue("permission",c),c.length>=1){var _;(_=l.current)===null||_===void 0||_.setFieldsValue({ownerRead:Number(c[0])&4,ownerWrite:Number(c[0])&2,ownerExec:Number(c[0])&1})}if(c.length>=2){var f;(f=l.current)===null||f===void 0||f.setFieldsValue({groupRead:Number(c[1])&4,groupWrite:Number(c[1])&2,groupExec:Number(c[1])&1})}if(c.length>=3){var $;($=l.current)===null||$===void 0||$.setFieldsValue({everyoneRead:Number(c[2])&4,everyoneWrite:Number(c[2])&2,everyoneExec:Number(c[2])&1})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(xe.ZP,{icon:(0,a.jsx)(Se.Z,{}),onClick:h()(t()().mark(function me(){var c;return t()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(!r.selectFileObject||r.selectFileObject.length==0)){_.next=7;break}return(c=l.current)===null||c===void 0||c.resetFields(),u.error(m.format("commonMessageNoSelect")),P(!1),_.abrupt("return",!1);case 7:P(!0);case 8:case"end":return _.stop()}},me)})),children:m.format("toolbarPermissionButton")}),(0,a.jsxs)(Ze.Y,{modalProps:{forceRender:!0,width:we.ob},title:m.format("toolbarPermissionModalTitle"),layout:"horizontal",open:K,onOpenChange:function(c){P(c),r.selectFileObject.length==1&&oe(pe(r.selectFileObject[0].modStr))},formRef:l,onValuesChange:function(c,d){if(c.permission)oe(c.permission);else{var _=["-",d.ownerRead?"r":"-",d.ownerWrite?"w":"-",d.ownerExec?"x":"-",d.groupRead?"r":"-",d.groupWrite?"w":"-",d.groupExec?"x":"-",d.everyoneRead?"r":"-",d.everyoneWrite?"w":"-",d.everyoneExec?"x":"-"];oe(pe(_.join("")))}},onFinish:function(){var me=h()(t()().mark(function c(d){var _,f,$,O;return t()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return $=[],r.selectFileObject.map(function(i){$.push(i.path)}),v.next=4,R(y,{name:S,fileList:$,mod:(_=d.permission)!==null&&_!==void 0?_:"600",hasChildren:(f=d.hasChildren)!==null&&f!==void 0?f:!0,user:d.user});case 4:return O=v.sent,W(),v.abrupt("return",!0);case 7:case"end":return v.stop()}},c)}));return function(c){return me.apply(this,arguments)}}(),children:[(0,a.jsxs)(Fe.Z,{direction:"row",gutter:[20,10],children:[(0,a.jsxs)(Fe.Z,{bordered:!0,title:m.format("toolbarPermissionOwner"),headerBordered:!0,children:[(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionRead"),name:"ownerRead"}),(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionWrite"),name:"ownerWrite"}),(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionExec"),name:"ownerExec"})]}),(0,a.jsxs)(Fe.Z,{bordered:!0,title:m.format("toolbarPermissionGroup"),headerBordered:!0,children:[(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionRead"),name:"groupRead"}),(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionWrite"),name:"groupWrite"}),(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionExec"),name:"groupExec"})]}),(0,a.jsxs)(Fe.Z,{bordered:!0,title:m.format("toolbarPermissionEveryone"),headerBordered:!0,children:[(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionRead"),name:"everyoneRead"}),(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionWrite"),name:"everyoneWrite"}),(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionExec"),name:"everyoneExec"})]})]}),(0,a.jsx)(Fe.Z,{children:(0,a.jsxs)(Ge.UW,{children:[(0,a.jsx)(ye.Z,{label:m.format("toolbarPermissionButton"),name:"permission",fieldProps:{maxLength:3},width:"xs"}),(0,a.jsxs)(Ue.Z.Compact,{children:[(0,a.jsx)(ye.Z,{width:"sm",placeholder:m.format("toolbarPermissionOwnerEmpty"),label:m.format("toolbarPermissionOwner"),name:"user",fieldProps:{addonAfter:":"}}),(0,a.jsx)(ye.Z,{width:"sm",placeholder:m.format("toolbarPermissionGroupEmpty"),name:"group"})]}),(0,a.jsx)(je.Z,{label:m.format("toolbarPermissionHasChildren"),name:"hasChildren",initialValue:!0})]})})]})]})}var Qe=e(27461);function Ye(r){var s=(0,o.useContext)(N.Z),u=s.currentPath,l=s.refresh,n=s.name,W=s.apiPrefix,S=(0,o.useContext)(Re.Z),y=S.notice,D=new ge.Uo("components.explorer");return(0,a.jsx)(Ae.Z,{buttonProps:{icon:(0,a.jsx)(Qe.Z,{})},action:h()(t()().mark(function E(){return t()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(r.selectFileObject.length!=0){P.next=3;break}return y.error(D.format(["commonMessageNoSelect","toolbarUnzipMessageAllowFileExt"])),P.abrupt("return",!1);case 3:return P.abrupt("return",ve(W,{name:n,file:r.selectFileObject.map(function(m){return m.path}),path:u}));case 4:case"end":return P.stop()}},E)})),onSuccess:function(){l()},children:D.format("toolbarUnzipButton")})}function En(r){var s=useContext(FileExplorerContext),u=s.name,l=s.apiPrefix,n=useContext(AppContext),W=n.message,S=useRef(),y=new Lang("components.explorer");return _jsx(RequestButton,{buttonProps:{icon:_jsx(ExportOutlined,{})},confirmProps:{description:_jsx(Space,{children:_jsx(ProForm,{layout:"inline",submitter:!1,formRef:S,children:_jsx(ProFormText,{width:"md",label:y.format("toolbarExportHostHostPath"),name:"hostPath"})})})},action:_asyncToGenerator(_regeneratorRuntime().mark(function D(){var E;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(!(!r.selectFileList||r.selectFileList.length==0)){P.next=3;break}return W.info(y.format("commonMessageNoSelect")),P.abrupt("return",!1);case 3:return P.abrupt("return",exportFileList(l,{name:u,hostPath:(E=S.current)===null||E===void 0?void 0:E.getFieldValue("hostPath"),enableExportHost:!0,fileList:r.selectFileList}));case 4:case"end":return P.stop()}},D)})),children:y.format("toolbarExportHostButton")})}function Xe(r){var s=(0,o.useContext)(N.Z),u=s.refresh,l=s.name,n=s.apiPrefix,W=s.currentPath,S=s.newFile,y=new ge.Uo("components.explorer");return(0,a.jsxs)(Ue.Z,{size:16,wrap:!0,children:[(0,a.jsx)(Ve,{selectFileList:r.selectFileList}),!1,(0,a.jsx)(He,{}),(0,a.jsx)(Je,{selectFileObject:r.selectFileObject}),(0,a.jsx)(Ye,{selectFileObject:r.selectFileObject}),(0,a.jsx)(xe.ZP,{icon:(0,a.jsx)(Ce.Z,{}),onClick:function(){S()},type:"primary",children:y.format("toolbarNewButton")}),(0,a.jsx)(Ae.Z,{buttonProps:{danger:!0,type:"default",icon:(0,a.jsx)(Te.Z,{})},confirmProps:{showCommonConfirm:!0},action:function(){return he(n,{name:l,fileList:r.selectFileList})},onSuccess:function(){u()},children:y.format("toolbarDeleteButton")})]})}var qe=e(81366),en=e(97269),nn=e(86615),rn=e(97462),tn=e(62370),an=e(11106),Le=e(5251),sn=e(27166),Pe=new ge.Uo("components.explorer"),on=(0,o.forwardRef)(function(r,s){var u,l,n=(0,o.useContext)(Re.Z),W=n.message,S=n.notice,y=(0,o.useContext)(N.Z),D=y.currentPath,E=y.refresh,K=y.name,P=y.apiPrefix,m=(0,o.useRef)(),pe=(0,o.useState)(!1),oe=B()(pe,2),me=oe[0],c=oe[1];return(0,o.useImperativeHandle)(s,function(){return{newFile:function(){var _,f;c(!0),(_=m.current)===null||_===void 0||_.resetFields(),(f=m.current)===null||f===void 0||f.setFieldValue("type","newFile")},editFile:function(_,f,$){return h()(t()().mark(function O(){var x,v,i,C,V;return t()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return(x=m.current)===null||x===void 0||x.resetFields(),W.loading(Pe.format("editFileMessageLoading")),w.next=4,Oe(P,{name:K,file:f}).finally(function(){W.destroy()});case 4:if(V=w.sent,!(V.data.content==""&&$!="0")){w.next=9;break}return W.error(Pe.format("editFileMessageNotSupport")),c(!1),w.abrupt("return");case 9:return(v=m.current)===null||v===void 0||v.setFieldValue("newValue",V.data.content),(i=m.current)===null||i===void 0||i.setFieldValue("newName",_),(C=m.current)===null||C===void 0||C.setFieldValue("type","editFile"),c(!0),w.abrupt("return");case 14:case"end":return w.stop()}},O)}))()}}}),(0,a.jsx)(sn.Z,{drawerProps:{mask:!1,width:"50vw",destroyOnHidden:!0},title:"\u7F16\u8F91\u6587\u4EF6",open:me,onOpenChange:function(){var _;c(!1),(_=m.current)===null||_===void 0||_.resetFields()},children:(0,a.jsxs)(en.A,{formRef:m,onFinish:function(){var d=h()(t()().mark(function _(f){return t()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(f.type!="newDir"){O.next=13;break}return O.prev=1,O.next=4,b(P,{name:K,destPath:"".concat(D,"/").concat((0,Le.fi)(f.newPath,"/"))});case 4:return E(),c(!1),O.abrupt("return",!0);case 9:O.prev=9,O.t0=O.catch(1);case 11:O.next=23;break;case 13:return O.prev=13,O.next=16,g(P,{destPath:D,file:f.newName,content:f.newValue,name:K});case 16:return E(),c(!1),O.abrupt("return",!0);case 21:O.prev=21,O.t1=O.catch(13);case 23:return O.abrupt("return",!1);case 24:case"end":return O.stop()}},_,null,[[1,9],[13,21]])}));return function(_){return d.apply(this,arguments)}}(),children:[(0,a.jsx)(nn.Z.Group,{name:"type",options:[{label:Pe.format("editFileTypeEditFile"),value:"editFile",disabled:((u=m.current)===null||u===void 0?void 0:u.getFieldValue("type"))!="editFile"},{label:Pe.format("editFileTypeNewFile"),value:"newFile"},{label:Pe.format("editFileTypeNewDir"),value:"newDir"}],disabled:((l=m.current)===null||l===void 0?void 0:l.getFieldValue("type"))=="editFile"}),(0,a.jsx)(rn.Z,{name:["type"],children:function(_){var f=_.type;return f!="newDir"?[(0,a.jsx)(ye.Z,{label:Pe.format("editFileNewName"),tooltip:Pe.format("editFileNewNameTip"),name:"newName",fieldProps:{addonBefore:"".concat(D,"/")},placeholder:Pe.format("editFileNewNameEmpty"),disabled:f=="editFile"},"fileName"),(0,a.jsx)(tn.Z,{label:Pe.format("editFileNewValue"),name:"newValue",children:(0,a.jsx)(an.ZP,{theme:"dark",height:we.Ed,onChange:function(O){var x;(x=m.current)===null||x===void 0||x.setFieldValue("newValue",O)}})},"fileContent")]:(0,a.jsx)(ye.Z,{name:"newPath",label:Pe.format("editFileNewPath"),placeholder:Pe.format("editFileNewPathEmpty")})}})]})})}),ln=on,Be=e(68536),un=e(83062),dn=e(66309),Ie=e(59683),cn=e(86548),Pn=null,Ee=new ge.Uo("components.explorer"),_n=(0,o.forwardRef)(function(r,s){(0,o.useImperativeHandle)(s,function(){return{close:function(){m([]),D("")}}});var u=(0,o.useRef)(),l=(0,o.useRef)(),n=(0,o.useRef)(),W=(0,o.useState)(""),S=B()(W,2),y=S[0],D=S[1],E=(0,j.useSearchParams)(),K=B()(E,2),P=K[0],m=K[1],pe=(0,o.useState)(),oe=B()(pe,2),me=oe[0],c=oe[1],d=(0,o.useContext)(Re.Z),_=d.message,f=r.type=="host"?"common":"app";(0,o.useEffect)(function(){var x;_.info(Ee.format("commonMessageCreateExplorerPlugin")),D((x=r.workDir)!==null&&x!==void 0?x:"")},[]);function $(x,v){return O.apply(this,arguments)}function O(){return O=h()(t()().mark(function x(v,i){var C,V,ue;return t()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:(C=u.current)===null||C===void 0||C.addHistory(v,i),D(i),n.current&&(V=n.current)!==null&&V!==void 0&&V.reloadAndRest&&((ue=n.current)===null||ue===void 0||ue.reloadAndRest()),i=="/"?m([]):(P.set("path",i),m(P));case 4:case"end":return U.stop()}},x)})),O.apply(this,arguments)}return r&&(0,a.jsxs)(N.Z.Provider,{value:{apiPrefix:f,name:r.name,currentPath:y,showPath:$,redirectPath:function(v){var i;if(D(v),n.current&&(i=n.current)!==null&&i!==void 0&&i.reloadAndRest){var C;(C=n.current)===null||C===void 0||C.reloadAndRest()}v=="/"?m([]):(P.set("path",v),m(P))},refresh:function(){var v;if(n&&typeof((v=n.current)===null||v===void 0?void 0:v.reloadAndRest)=="function"){var i;(i=n.current)===null||i===void 0||i.reloadAndRest()}},editFile:function(v,i,C){l.current&&l.current.editFile(v,i,C)},newFile:function(){l.current&&l.current.newFile()}},children:[(0,a.jsx)(Ie.C,{sticky:!1,quickToolbarAffix:{offsetTop:10,target:function(){return document.querySelector(".file-explorer .ant-drawer-body")}},quickToolbarRender:function(v){var i=v.selectedRows,C=[];return i.map(function(V){C.push(V.path)}),[r.onConsole&&(0,a.jsx)(xe.ZP,{type:"dashed",onClick:function(){r.onConsole&&r.onConsole(y)},children:"Console"},"fileConsole"),(0,a.jsx)(Xe,{selectFileList:C,selectFileObject:i,enableExportHost:r.type=="container"},"1")]},contextMenu:function(v){var i=v.selectedRows,C=v.selectedRow,V=v.isMultiple;return{items:[{key:"edit",label:(0,a.jsx)(Ie.C.ContextMenuItem,{buttonProps:{icon:(0,a.jsx)(cn.Z,{}),disabled:V()||C&&C.isDir},action:h()(t()().mark(function ue(){var w,U;return t()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,le(f,{name:r.name,path:C.path});case 2:w=re.sent,w.data.info.isDir?$(C.name,w.data.info.target):(U=l.current)===null||U===void 0||U.editFile(w.data.info.name,w.data.info.target,C.size);case 4:case"end":return re.stop()}},ue)})),children:ge.FD.format("listManageEdit")})},{key:"permission",label:(0,a.jsx)(Ie.C.ContextMenuItem,{buttonProps:{icon:(0,a.jsx)(Se.Z,{})},action:h()(t()().mark(function ue(){var w,U;return t()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,le(f,{name:r.name,path:C.path});case 2:w=re.sent,w.data.info.isDir?$(C.name,w.data.info.target):(U=l.current)===null||U===void 0||U.editFile(w.data.info.name,w.data.info.target,C.size);case 4:case"end":return re.stop()}},ue)})),children:Ee.format("toolbarPermissionButton")})}]}},headerTitle:(0,a.jsx)(qe.Z,{ref:u}),actionRef:n,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:h()(t()().mark(function x(){var v,i,C,V,ue;return t()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,ee(f,{name:r.name,path:y});case 2:if(i=U.sent,y==""&&i.data.currentPath!=""&&D(i.data.currentPath),C=[],(v=u.current)===null||v===void 0||v.initHistory(i.data.currentPath.split("/").filter(function(Y){return Y!=""}).map(function(Y){return C.push(Y),{title:Y,path:"/".concat(C.join("/"))}}),i.data.rootDirs),V=me,V){U.next=13;break}return U.next=10,te(f,{name:r.name});case 10:ue=U.sent,c(ue.data),V=ue.data;case 13:return U.abrupt("return",{data:i.data.list.map(function(Y){if(V){var re,We;Y.group=(re=(We=V.group.find(function(Me){return Me.gid==Y.group}))===null||We===void 0?void 0:We.name)!==null&&re!==void 0?re:Y.group}return Y}),success:!0,total:i.data.list.length});case 14:case"end":return U.stop()}},x)})),columns:[{title:Ee.format("listName"),dataIndex:"name",key:"name",render:function(w,i,C,V,ue){var w;return i.isDir?w=(0,a.jsx)(Be.Z,{isDir:!0,onClick:function(){return $(i.name,i.path)},showName:i.name}):i.isSymlink?w=(0,a.jsx)(Be.Z,{isLink:!0,showName:"".concat(i.name," -> ").concat(i.linkName),onClick:h()(t()().mark(function U(){var Y,re;return t()().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return Me.next=2,le(f,{name:r.name,path:i.path});case 2:Y=Me.sent,Y.data.info.isDir?$(i.name,Y.data.info.target):(re=l.current)===null||re===void 0||re.editFile(Y.data.info.name,Y.data.info.target,i.size);case 4:case"end":return Me.stop()}},U)}))}):w=(0,a.jsx)(Be.Z,{showName:i.name,onClick:function(){var Y;(Y=l.current)===null||Y===void 0||Y.editFile(i.name,i.path,i.size)}}),w}},{title:Ee.format("listStatus"),key:"status",width:110,render:function(v,i,C,V,ue){return i.change>-1&&(0,a.jsx)(un.Z,{title:Ee.format("listStatusTipOption.".concat(i.change)),children:(0,a.jsx)(dn.Z,{color:Ee.format("listStatusColorOption.".concat(i.change)),children:Ee.format("listStatusOption.".concat(i.change))})})}},{title:Ee.format("listModStr"),dataIndex:"modStr",key:"mod"},{title:Ee.format("listUser"),dataIndex:"user"},{title:Ee.format("listGroup"),dataIndex:"group"},{title:Ee.format("listSize"),dataIndex:"size",key:"size",render:function(v,i,C,V,ue){return(0,Le.FI)(i.size)}},{title:Ee.format("listModTime"),dataIndex:"modTime",key:"modTime",sorter:function(v,i){return new Date(v.modTime).getTime()-new Date(i.modTime).getTime()},render:function(v,i,C,V,ue){return(0,Le.NF)(i.modTime)}}],cardProps:{ghost:!0}},"explorer-list"),(0,a.jsx)(ln,{ref:l})]})}),mn=_n,fn=e(85265),hn=e(99922),pn=(0,o.forwardRef)(function(r,s){var u,l=(0,o.useState)(!1),n=B()(l,2),W=n[0],S=n[1],y=(0,o.useState)(),D=B()(y,2),E=D[0],K=D[1],P=(0,o.useRef)(),m=new ge.Uo("components.explorer"),pe=(0,o.useContext)(Re.Z),oe=pe.loading,me=(0,o.useRef)();return(0,o.useImperativeHandle)(s,function(){return{showContainer:function(d,_){K({name:(0,Le.fi)(d,"/"),type:"container",workDir:_!=null?_:void 0}),S(!0)},showHost:function(d){K({name:d,type:"host"}),S(!0)},showVolume:function(d){return h()(t()().mark(function _(){var f;return t()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return oe.show(),O.next=3,q("app",{name:d}).finally(function(){oe.destroy()});case 3:f=O.sent,K({name:f.data.containerName,type:"container",workDir:f.data.path}),S(!0);case 6:case"end":return O.stop()}},_)}))()}}}),(0,a.jsxs)(a.Fragment,{children:[r.trigger?o.cloneElement(r.trigger,{onClick:function(){r.name&&r.type&&(K(r),S(!0))}}):null,(0,a.jsxs)(fn.Z,{destroyOnHidden:!0,width:we.R_,title:m.format("drawerTitle",{name:(u=r.title)!==null&&u!==void 0?u:E==null?void 0:E.name}),onClose:h()(t()().mark(function c(){var d;return t()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(oe.show(),S(!1),(d=P.current)===null||d===void 0||d.close(),K(void 0),!r.onCloseDestroy){f.next=7;break}return f.next=7,be("app");case 7:oe.destroy();case 8:case"end":return f.stop()}},c)})),rootClassName:"file-explorer",open:W,children:[r.showConsole&&(0,a.jsx)(hn.Z,{showFileExplorer:!1,ref:me}),W&&E&&(0,a.jsx)(mn,A()(A()({ref:P},E),{},{onConsole:r.showConsole?function(c){var d;(d=me.current)===null||d===void 0||d.show({url:"/console/container/".concat(E.name),title:E.name,workDir:c})}:void 0}))]})]})}),vn=pn},90581:function(De,ae,e){e.d(ae,{Z:function(){return ce}});var se=e(15009),A=e.n(se),X=e(99289),t=e.n(X),ie=e(5574),h=e.n(ie),H=e(3616),B=e(97269),o=e(38345),j=e(64317),ee=e(37476),T=e(62370),M=e(97462),F=e(11106),L=e(42075),ne=e(83622),fe=e(83062),de=e(67294),he=e(1883),k=e(33160),ve=e(58638),_e=e(82346),Oe=e(75520),G=e(36146),g=e(85893);function ce(b){var I=(0,de.useState)(!1),R=h()(I,2),z=R[0],te=R[1],Z=(0,de.useRef)(),le=new G.Uo("components.console");return(0,g.jsx)(B.A,{layout:"inline",submitter:!1,children:(0,g.jsx)(o.Z,{ghost:!0,children:(0,g.jsxs)(L.Z,{children:[(0,g.jsx)(j.Z,{width:"sm",name:"entryCmd",placeholder:le.format("toolbarEntryCmdEmpty"),valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(q){b.onChangeShell&&b.onChangeShell(q)}}),(0,g.jsx)(ee.Y,{modalProps:{width:H.ob,height:H.Ed},title:le.format("toolbarBatchCommandTitle"),name:"batchCommand",open:z,trigger:(0,g.jsx)(ne.ZP,{icon:(0,g.jsx)(he.Z,{}),children:le.format("toolbarBatchCommandTitle")}),formKey:"batchCommand",formRef:Z,isKeyPressSubmit:!0,onFinish:function(){var J=t()(A()().mark(function q(p){return A()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:b.onBatchCommandFinish&&b.onBatchCommandFinish(p.shell.split(`
`)),te(!1);case 2:case"end":return Q.stop()}},q)}));return function(q){return J.apply(this,arguments)}}(),onOpenChange:function(q){te(q),q&&Z.current&&Z.current.resetFields()},children:(0,g.jsx)(T.Z,{name:"shell",children:(0,g.jsx)(F.ZP,{theme:"dark",height:H.Ed})})}),(0,g.jsx)(ne.ZP,{onClick:function(){b.onChangeShell&&b.onChangeShell()},icon:(0,g.jsx)(k.Z,{}),type:"primary",children:G.FD.format("listManageRefresh")}),(0,g.jsx)(M.Z,{name:["entryCmd"],children:function(q){var p=q.entryCmd;return(!p||p=="")&&(p="/bin/sh"),b.onOpenNewWindow&&(0,g.jsx)(_e.Link,{onClick:function(){b.onOpenNewWindowFinish&&b.onOpenNewWindowFinish()},target:"_blank",to:b.onOpenNewWindow({cmd:p}),children:(0,g.jsx)(fe.Z,{title:le.format("toolbarOpenInNewWindowTip"),children:(0,g.jsx)(ne.ZP,{type:"dashed",icon:(0,g.jsx)(ve.Z,{})})})})}}),(0,g.jsx)(Oe.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})}},49610:function(De,ae,e){var se=e(5574),A=e.n(se),X=e(67294),t=e(52626),ie=e(78267),h=e.n(ie),H=e(12323),B=e(87662),o=e(4244),j=e.n(o),ee=e(24078),T=e(85893),M,F,L,ne,fe=(0,X.forwardRef)(function(de,he){var k,ve=(0,X.useState)(),_e=A()(ve,2),Oe=_e[0],G=_e[1],g=(0,X.useState)(""),ce=A()(g,2),b=ce[0],I=ce[1];(0,X.useImperativeHandle)(he,function(){return{start:function(te,Z){R(),F.fit(),Z.width=M.cols,Z.height=M.rows;var le=Z?Object.keys(Z).filter(function(J){return Z&&Z[J]}).map(function(J){if(Z&&Z[J])return"".concat(J,"=").concat(Z[J])}):[];L=new WebSocket((0,t.R)(te+"?"+le.join("&"))),L.addEventListener("message",function(J){var q=JSON.parse(J.data),p=q.type;if(p==te&&(M.write(q.data),q.data.indexOf("exec failed")!=-1)){R();return}}),ne=M.onData(function(J){var q={content:{command:J},type:te};L&&L.send(JSON.stringify(q))}),I(te),G(Z)},close:function(){R()},fit:function(){return F.fit(),{width:M.cols,height:M.rows}},run:function(te){Oe&&te&&te.forEach(function(Z){var le={content:{command:Z+`
`},type:b};L&&L.send(JSON.stringify(le))})}}}),(0,X.useEffect)(function(){return M=new o.Terminal(H.X),F=new ie.FitAddon,M.loadAddon(F),M.open(document.getElementById("terminal-container-console")),F.fit(),(0,B.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(z){z.data&&z.data.fontSize&&Object.assign(M.options,z.data)}),function(){R()}},[]),(0,X.useEffect)(function(){window.addEventListener("resize",function(){F.fit();var z={size:{width:M.cols,height:M.rows},type:b};b&&L&&L.send(JSON.stringify(z))})},[b]);function R(){ne&&(M.reset(),F.fit(),M.focus(),ne.dispose()),L&&(L.close(),L=null)}return(0,T.jsx)("div",{style:{height:(k=de.height)!==null&&k!==void 0?k:"100vh"},id:"terminal-container-console"})});ae.Z=fe},27166:function(De,ae,e){var se=e(97857),A=e.n(se),X=e(5574),t=e.n(X),ie=e(13769),h=e.n(ie),H=e(184),B=e(74330),o=e(67294),j=e(85893),ee=["requestLoading"],T=(0,o.forwardRef)(function(M,F){var L,ne=M.requestLoading,fe=h()(M,ee),de=(0,o.useState)(!1),he=t()(de,2),k=he[0],ve=he[1];return(0,o.useImperativeHandle)(F,function(){return{loading:function(){ve(!0)},finish:function(){ve(!1)}}}),(0,j.jsx)(H.a,A()(A()({},fe),{},{children:(0,j.jsx)(B.Z,{spinning:(L=M.requestLoading)!==null&&L!==void 0?L:k,size:"default",style:{marginTop:"30%"},children:M.children})}))});ae.Z=T},81366:function(De,ae,e){var se=e(97857),A=e.n(se),X=e(19632),t=e.n(X),ie=e(5574),h=e.n(ie),H=e(27254),B=e(42075),o=e(85418),j=e(25593),ee=e(83622),T=e(67294),M=e(31112),F=e(85893),L={title:"/",path:"/"},ne=(0,T.forwardRef)(function(fe,de){var he=(0,T.useContext)(M.Z),k=he.showPath,ve=he.redirectPath,_e=(0,T.useState)([L]),Oe=h()(_e,2),G=Oe[0],g=Oe[1];(0,T.useImperativeHandle)(de,function(){return{addHistory:function(I,R){R=="/"?g([L]):g([].concat(t()(G),[{title:I,path:R}]))},initHistory:function(I,R){g([A()(A()({},L),{},{children:R})].concat(t()(I)))}}});var ce=function(I){k?k(G[I].title,G[I].path):fe.showPath&&fe.showPath(G[I].title,G[I].path);var R=G.filter(function(z,te){return te<=I});g(t()(R))};return(0,F.jsxs)(B.Z,{children:[(0,F.jsx)(B.Z.Compact,{children:G.map(function(b,I){return b.children?(0,F.jsxs)(o.Z.Button,{menu:{items:b.children.map(function(R,z){return{key:z,label:(0,F.jsx)(j.Z.Link,{onClick:function(){ve(R)},children:R},z)}})},type:"dashed",onClick:function(z){ce(I)},children:[(0,F.jsx)(H.Z,{})," ",b.title]},I):(0,F.jsx)(ee.ZP,{icon:(0,F.jsx)(H.Z,{}),type:"dashed",onClick:function(){ce(I)},children:b.title},I)})}),G.length>=2&&(0,F.jsx)(j.Z.Text,{copyable:{text:G[G.length-1].path}})]})});ae.Z=ne},31112:function(De,ae,e){var se=e(67294),A=(0,se.createContext)({});ae.Z=A},68536:function(De,ae,e){e.d(ae,{Z:function(){return ee}});var se=e(24963),A=e(36146),X=e(93613),t=e(36693),ie=e(2741),h=e(25593),H=e(42075),B=e(67294),o=e(85893),j=0;function ee(T){var M=(0,B.useContext)(se.Z),F=M.message,L=new A.Uo("components.explorer");return T.isDir?(0,o.jsx)(h.Z.Link,{onClick:function(){T.onClick&&T.onClick()},children:(0,o.jsxs)(H.Z,{children:[(0,o.jsx)(X.Z,{}),T.showName]})}):T.isLink?(0,o.jsx)(h.Z.Link,{onClick:function(){T.onClick&&T.onClick()},children:(0,o.jsxs)(H.Z,{children:[(0,o.jsx)(t.Z,{}),T.showName]})}):(0,o.jsx)(h.Z.Text,{onClick:function(){if(j++,j==2){j=0,T.onClick&&T.onClick();return}setTimeout(function(){j==1&&F.info(L.format("fileNameMessageViewDetail")),j=0},400)},style:{cursor:"pointer"},children:(0,o.jsxs)(H.Z,{children:[(0,o.jsx)(ie.Z,{}),T.showName]})})}},4813:function(De,ae,e){e.d(ae,{_:function(){return h}});var se=e(15009),A=e.n(se),X=e(99289),t=e.n(X),ie=e(82346);function h(B){return H.apply(this,arguments)}function H(){return H=t()(A()().mark(function B(o){return A()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,(0,ie.request)("/api/common/attach/delete",{method:"POST",data:o});case 2:return ee.abrupt("return",ee.sent);case 3:case"end":return ee.stop()}},B)})),H.apply(this,arguments)}}}]);
