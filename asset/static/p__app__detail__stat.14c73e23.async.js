"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7745,5947],{60433:function(Z,E,e){var F=e(87462),o=e(67294),L=e(69782),p=e(84089),h=function(t,d){return o.createElement(p.Z,(0,F.Z)({},t,{ref:d,icon:L.Z}))},M=o.forwardRef(h);E.Z=M},27619:function(Z,E,e){e.d(E,{Z:function(){return C}});var F=e(97857),o=e.n(F),L=e(19632),p=e.n(L),h=e(5574),M=e.n(h),r=e(64183),t=e(82346),d=e(67294),c=e(85893);function C(u){var y,x=(0,d.useState)("academy"),k=M()(x,2),v=k[0],f=k[1],R=Math.max.apply(Math,p()(u.data.map(function(D){var a;return(a=D[u.yField])!==null&&a!==void 0?a:0}))),g=(0,t.useModel)("@@initialState"),T=g.initialState,_=g.loading,O=g.error,U=g.refresh,n=g.setInitialState,i={xField:u.xField,yField:u.yField,height:200,axis:{y:{line:!0},x:{line:!0,grid:{visable:!0},labelAutoRotate:!0}},style:{opacity:.4},tooltip:{channel:"y",valueFormatter:u.yLabelFormatter},scale:{y:{domainMin:(y=u.yDomainMin)!==null&&y!==void 0?y:0,domainMax:u.yDomainMax?u.yDomainMax:u.yDomainMaxCallback?u.yDomainMaxCallback(R):R}},data:u.data};return u.yLabelFormatter&&(i.axis.y.labelFormatter=u.yLabelFormatter),u.colorField&&(i.colorField=u.colorField),(0,d.useEffect)(function(){(T==null?void 0:T.theme.algorithm)=="dark"?f("classicDark"):f("academy")},[T]),(0,c.jsx)(r.Z,o()({theme:v},i))}},71890:function(Z,E,e){var F=e(15009),o=e.n(F),L=e(99289),p=e.n(L),h=e(67294);function M(r){var t=r.reqFunction,d=r.interval,c=r.maxPolling,C=r.pollingStatus,u=r.inPath,y=(0,h.useRef)(null),x=0,k=function f(){y.current=window.setTimeout(p()(o()().mark(function R(){var g;return o()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(x++>=c)){_.next=3;break}return v(),_.abrupt("return");case 3:if(_.prev=3,!(u&&window.location.href.indexOf(u)==-1)){_.next=7;break}return v(),_.abrupt("return");case 7:return _.next=9,t();case 9:g=_.sent,f(),_.next=17;break;case 13:_.prev=13,_.t0=_.catch(3),v(),console.error("\u8F6E\u8BE2\u53D1\u751F\u9519\u8BEF\uFF1A",_.t0);case 17:case"end":return _.stop()}},R,null,[[3,13]])})),d)},v=function(){console.log("end polling"),y.current&&window.clearTimeout(y.current)};return(0,h.useEffect)(function(){return console.log((C?"start":"waiting")+" polling, max "+c),C&&k(),function(){v()}},[d,c,C]),{endPolling:v}}E.Z=M},24963:function(Z,E,e){var F=e(67294),o=(0,F.createContext)({});E.Z=o},34548:function(Z,E,e){e.r(E),e.d(E,{AppDetailContext:function(){return T},default:function(){return _}});var F=e(15009),o=e.n(F),L=e(99289),p=e.n(L),h=e(5574),M=e.n(h),r=e(24963),t=e(60335),d=e(87462),c=e(67294),C=e(44805),u=e(84089),y=function(U,n){return c.createElement(u.Z,(0,d.Z)({},U,{ref:n,icon:C.Z}))},x=c.forwardRef(y),k=x,v=e(82346),f=e(25593),R=e(50136),g=e(85893),T=(0,c.createContext)({});function _(){var O,U=(0,c.useContext)(r.Z),n=U.lang,i=U.loading,D=U.message,a=(0,v.useParams)(),A=(0,v.useSearchParams)(),B=M()(A,2),K=B[0],S=B[1],X=(O=K.get("tab"))!==null&&O!==void 0?O:"edit",z=(0,c.useState)("edit"),m=M()(z,2),q=m[0],H=m[1],$=(0,v.useNavigate)(),ee=(0,c.useState)(1),Y=M()(ee,2),V=Y[0],J=Y[1],W=[{label:(0,g.jsx)(v.Link,{to:"/app/detail/edit/".concat(a.id,"?tab=edit"),children:"\u5BB9\u5668\u8BE6\u60C5"}),key:"edit"},{label:(0,g.jsx)(v.Link,{to:"/app/detail/network/".concat(a.id,"?tab=network"),children:"\u7F51\u7EDC\u7BA1\u7406"}),key:"network"},{label:(0,g.jsx)(f.Z.Link,{children:"\u6587\u4EF6\u7BA1\u7406"}),key:"file",onClick:function(){D.info(n("app.detail.createExplorerPlugin")),$("/app/detail/file/".concat(a.id,"?tab=file"))}},{label:(0,g.jsx)(f.Z.Link,{children:"\u8FD0\u884C\u65E5\u5FD7"}),key:"log",onClick:function(){$("/app/detail/log/".concat(a.id,"?tab=log"))}},{label:(0,g.jsx)(f.Z.Link,{children:"\u8FD0\u884C\u72B6\u6001"}),key:"stat",onClick:function(){$("/app/detail/stat/".concat(a.id,"?tab=stat"))}},{label:"",key:"containerName",icon:(0,g.jsx)(k,{}),disabled:!0}],te=(0,c.useState)(W),ae=M()(te,2),re=ae[0],j=ae[1];(0,c.useEffect)(function(){i.show(),H(X);var s=function(){var P=p()(o()().mark(function b(){var w,I,Q;return o()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return I=W,N.next=3,(0,t.jV)({md5:(w=a.id)!==null&&w!==void 0?w:""});case 3:Q=N.sent,I.map(function(G){return G.key=="containerName"&&(G.label=Q.data.info.Name),(!Q.data.info.State.Running||Q.data.info.State.Restarting)&&(G.key=="file"||G.key=="stat")&&(G.disabled=!0),G}),j(I),i.destroy();case 7:case"end":return N.stop()}},b)}));return function(){return P.apply(this,arguments)}}();s()},[V]);var l=function(P){H(P.key)};return(0,g.jsxs)(T.Provider,{value:{reload:function(){J(V+1)}},children:[(0,g.jsx)(R.Z,{mode:"horizontal",onClick:l,selectedKeys:[q],items:re}),(0,g.jsx)(v.Outlet,{})]})}},42223:function(Z,E,e){e.r(E),e.d(E,{default:function(){return a}});var F=e(15009),o=e.n(F),L=e(99289),p=e.n(L),h=e(5574),M=e.n(h),r=e(19632),t=e.n(r),d=e(27619),c=e(71890),C=e(24963),u=e(82346);function y(A){return x.apply(this,arguments)}function x(){return x=p()(o()().mark(function A(B){return o()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",(0,u.request)("/api/app/container/get-stat-info",{method:"POST",data:B}));case 1:case"end":return S.stop()}},A)})),x.apply(this,arguments)}function k(A){return v.apply(this,arguments)}function v(){return v=p()(o()().mark(function A(B){return o()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",(0,u.request)("/api/app/container/get-process-info",{method:"POST",data:B}));case 1:case"end":return S.stop()}},A)})),v.apply(this,arguments)}var f=e(5251),R=e(12122),g=e(60433),T=e(38345),_=e(63490),O=e(67294),U=e(34548),n=e(85893),i=new Date().toLocaleTimeString(),D={total:0,memory:[{date:i,usage:0,source:{usage:0,limit:0}}],cpu:[{date:i,usage:0}],network:[{usage:0,type:"rx",date:i,source:{usage:0}},{usage:0,type:"tx",date:i,source:{usage:0}}],io:[{usage:0,type:"read",date:i,source:{usage:0}},{usage:0,type:"write",date:i,source:{usage:0}}]};function a(){var A=function(l,s){switch(s.type){case"update":var P=new Date(s.payload.read).toLocaleTimeString(),b=s.payload.cpu_stats.cpu_usage.total_usage-s.payload.precpu_stats.cpu_usage.total_usage,w=s.payload.cpu_stats.system_cpu_usage-s.payload.precpu_stats.system_cpu_usage,I={total:l.total+1,memory:[],cpu:[].concat(t()(l.cpu),[{date:P,usage:b/w*s.payload.cpu_stats.online_cpus*100}]),io:[],network:[]};return s.payload.memory_stats&&s.payload.memory_stats.limit&&s.payload.memory_stats.usage&&(I.memory=[].concat(t()(l.memory),[{date:P,usage:Math.round(s.payload.memory_stats.usage),source:{usage:s.payload.memory_stats.usage,limit:s.payload.memory_stats.limit}}])),s.payload.networks&&(I.network=[].concat(t()(l.network),[{date:P,usage:parseFloat(s.payload.networks.eth0.rx_bytes.toFixed(2)),type:"rx",source:{usage:s.payload.networks.eth0.rx_bytes}},{date:P,usage:parseFloat(s.payload.networks.eth0.tx_bytes.toFixed(2)),type:"tx",source:{usage:s.payload.networks.eth0.tx_bytes}}])),s.payload.blkio_stats&&s.payload.blkio_stats.io_service_bytes_recursive&&s.payload.blkio_stats.io_service_bytes_recursive.length>0&&(I.io=[].concat(t()(l.io),[{date:P,usage:parseFloat(s.payload.blkio_stats.io_service_bytes_recursive[0].value.toFixed(2)),type:s.payload.blkio_stats.io_service_bytes_recursive[0].op,source:{usage:s.payload.blkio_stats.io_service_bytes_recursive[0].value}},{date:P,usage:parseFloat(s.payload.blkio_stats.io_service_bytes_recursive[1].value.toFixed(2)),type:s.payload.blkio_stats.io_service_bytes_recursive[1].op,source:{usage:s.payload.blkio_stats.io_service_bytes_recursive[1].value}}])),I}},B=(0,O.useContext)(C.Z),K=B.loading,S=(0,u.useParams)(),X=(0,O.useReducer)(A,D),z=M()(X,2),m=z[0],q=z[1],H=(0,O.useState)(0),$=M()(H,2),ee=$[0],Y=$[1],V=(0,O.useState)(),J=M()(V,2),W=J[0],te=J[1],ae=(0,c.Z)({reqFunction:function(){var j=p()(o()().mark(function s(){var P,b;return o()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,y({id:(P=S.id)!==null&&P!==void 0?P:""});case 2:b=I.sent,K.destroy(),q({type:"update",payload:b});case 5:case"end":return I.stop()}},s)}));function l(){return j.apply(this,arguments)}return l}(),interval:3e3,maxPolling:999,pollingStatus:ee!=0,inPath:"tab=stat"}),re=(0,O.useContext)(U.AppDetailContext);return(0,O.useEffect)(function(){re.reload()},[]),(0,O.useEffect)(function(){var j,l;K.show(),y({id:(j=S.id)!==null&&j!==void 0?j:""}).then(function(s){return Y(Math.round(s.memory_stats.limit)),!0}),k({id:(l=S.id)!==null&&l!==void 0?l:""}).then(function(s){var P={columns:[],data:[]};s.data.list.Titles.map(function(b){P.columns.push({title:b,label:b,dataIndex:b})}),s.data.list.Processes.map(function(b,w){P.data.push({UID:b[0],PID:b[1],PPID:b[2],C:b[3],STIME:b[4],TTY:b[5],TIME:b[6],CMD:b[7]})}),te(P)})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(T.Z,{direction:"row",wrap:!0,gutter:[20,20],children:[m.memory&&m.memory.length>0&&(0,n.jsx)(T.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"Memory usage: ".concat((0,f.FI)(m.memory[m.memory.length-1].source.usage)," / ").concat((0,f.FI)(m.memory[m.memory.length-1].source.limit)),headerBordered:!0,bordered:!0,children:(0,n.jsx)(d.Z,{yField:"usage",xField:"date",data:m.memory,yDomainMaxCallback:function(l){return l*2},yLabelFormatter:function(l){return(0,f.FI)(parseFloat(l))}})}),(0,n.jsx)(T.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"Cpu usage: ".concat(m.cpu[m.cpu.length-1].usage.toFixed(2),"%"),headerBordered:!0,bordered:!0,children:(0,n.jsx)(d.Z,{yField:"usage",xField:"date",data:m.cpu,yDomainMaxCallback:function(l){return l*1.5},yLabelFormatter:function(l){return"".concat(l,"%")}})}),m.io&&m.io.length>0&&(0,n.jsx)(T.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"I/O: ".concat((0,f.FI)(m.io[m.io.length-1].source.usage)," / ").concat((0,f.FI)(m.io[m.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,n.jsx)(d.Z,{yField:"usage",xField:"date",colorField:"type",data:m.io,yDomainMaxCallback:function(l){return l*2},yLabelFormatter:function(l){return(0,f.FI)(parseFloat(l))}})}),m.network&&m.network.length>0&&(0,n.jsx)(T.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"Network: ".concat((0,f.FI)(m.network[m.network.length-1].source.usage)," / ").concat((0,f.FI)(m.network[m.network.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,n.jsx)(d.Z,{yField:"usage",xField:"date",colorField:"type",data:m.network,yDomainMaxCallback:function(l){return l*2},yLabelFormatter:function(l){return(0,f.FI)(parseFloat(l))}})})]}),(0,n.jsx)(T.Z,{title:(0,n.jsx)(g.Z,{}),subTitle:"Progress",children:(0,n.jsx)(_.Z,{scroll:{x:"max-content"},rowKey:"PID",columns:W==null?void 0:W.columns,dataSource:W==null?void 0:W.data,pagination:{pageSize:10}})})]})}},60335:function(Z,E,e){e.d(E,{IE:function(){return t},IW:function(){return M},KK:function(){return x},LJ:function(){return v},RF:function(){return T},Re:function(){return R},aF:function(){return O},eE:function(){return u},jV:function(){return c}});var F=e(15009),o=e.n(F),L=e(99289),p=e.n(L),h=e(82346);function M(n){return r.apply(this,arguments)}function r(){return r=p()(o()().mark(function n(i){return o()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,h.request)("/api/app/container/status",{method:"POST",data:i}));case 1:case"end":return a.stop()}},n)})),r.apply(this,arguments)}function t(n){return d.apply(this,arguments)}function d(){return d=p()(o()().mark(function n(i){return o()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,h.request)("/api/app/container/get-list",{data:i,method:"POST"}));case 1:case"end":return a.stop()}},n)})),d.apply(this,arguments)}function c(n){return C.apply(this,arguments)}function C(){return C=p()(o()().mark(function n(i){return o()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,h.request)("/api/app/container/get-detail",{data:i,method:"POST"}));case 1:case"end":return a.stop()}},n)})),C.apply(this,arguments)}function u(n){return y.apply(this,arguments)}function y(){return y=p()(o()().mark(function n(i){return o()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,h.request)("/api/app/container/update",{data:i,method:"POST"}));case 1:case"end":return a.stop()}},n)})),y.apply(this,arguments)}function x(){return k.apply(this,arguments)}function k(){return k=p()(o()().mark(function n(){return o()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,h.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return D.stop()}},n)})),k.apply(this,arguments)}function v(n){return f.apply(this,arguments)}function f(){return f=p()(o()().mark(function n(i){return o()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,h.request)("/api/app/container/export",{method:"POST",data:i,responseType:"blob"}));case 1:case"end":return a.stop()}},n)})),f.apply(this,arguments)}function R(n){return g.apply(this,arguments)}function g(){return g=p()(o()().mark(function n(i){return o()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,h.request)("/api/app/container/commit",{method:"POST",data:i}));case 1:case"end":return a.stop()}},n)})),g.apply(this,arguments)}function T(n){return _.apply(this,arguments)}function _(){return _=p()(o()().mark(function n(i){return o()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,h.request)("/api/app/container/upgrade",{method:"POST",data:i}));case 1:case"end":return a.stop()}},n)})),_.apply(this,arguments)}function O(n){return U.apply(this,arguments)}function U(){return U=p()(o()().mark(function n(i){return o()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,h.request)("/api/app/container/copy",{method:"POST",data:i}));case 1:case"end":return a.stop()}},n)})),U.apply(this,arguments)}},5251:function(Z,E,e){e.d(E,{FI:function(){return o},NF:function(){return p},ZM:function(){return L},fi:function(){return h}});function F(r){return r.trim()}function o(r){var t="";r<.1*1024?t=r.toFixed(2)+"B":r<.1*1024*1024?t=(r/1024).toFixed(2)+"KB":r<1*1024*1024*1024?t=(r/(1024*1024)).toFixed(2)+"MB":t=(r/(1024*1024*1024)).toFixed(2)+"GB";var d=t+"",c=d.indexOf("."),C=d.substring(c+1,c+3);return C=="00"?d.substring(0,c)+d.substr(c+3,2):t}function L(r){if(r){var t=new Date(r),d=t.getFullYear()+"-",c=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",C=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",u=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",y=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",x=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return d+c+C+u+y+x}}function p(r){if(!r||r=="")return"-";var t=new Date(r),d=t.getUTCFullYear(),c=String(t.getUTCMonth()+1).padStart(2,"0"),C=String(t.getUTCDate()).padStart(2,"0"),u=String(t.getUTCHours()).padStart(2,"0"),y=String(t.getUTCMinutes()).padStart(2,"0"),x=String(t.getUTCSeconds()).padStart(2,"0");return"".concat(d,"-").concat(c,"-").concat(C," ").concat(u,":").concat(y,":").concat(x)}function h(r,t){if(!r||r.length===0)return"";if(t.length===0)return r;for(;r.startsWith(t);)r=r.slice(t.length);return r}function M(r,t){if(!r||r.length===0)return"";if(t.length===0)return r;for(;r.endsWith(t);)r=r.slice(0,r.length-t.length);return r}}}]);
