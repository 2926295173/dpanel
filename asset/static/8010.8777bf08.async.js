"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8010],{58010:function(Ze,le,n){n.d(le,{Z:function(){return un}});var oe=n(19632),ce=n.n(oe),de=n(5574),G=n.n(de),ye=n(15009),o=n.n(ye),je=n(99289),D=n.n(je),u=n(67294),Y=n(80821),R=n(90098),me=n(52209),U=n(86548),q=n(43425),H=n(74842),ue=n(48689),S=n(33160),fe=n(87784),ne=n(30159),ve=n(25035),Q=n(38345),te=n(97269),se=n(86615),A=n(62370),T=n(82346),Ce=n(85265),X=n(42075),he=n(96074),J=n(25593),re=n(83062),Re=n(40056),_=n(84567),Se=n(28036),Pe=n(99861),Le=n(91058),we=n(79245),Ae=n(60940),$e=n(55241),Ie=n(78451),Be=n(37413),Oe=n(94359),ge=n(24963),Te=n(91806),Me=n(60433),De=n(89035),Ue=n(99922),Ve=n(46357),Ke=n(87662),Ne=n(5251),e=n(85893);function Ge(r){var k=(0,u.useState)(""),V=G()(k,2),$=V[0],M=V[1],p=(0,u.useContext)(ge.Z),y=p.loading,W=p.lang,h=p.notice,x=p.message,t=(0,u.useRef)(),P=(0,u.useRef)(),Z=(0,u.useState)(!1),g=G()(Z,2),f=g[0],j=g[1];return(0,u.useEffect)(function(){(0,Ke.K3)().then(function(d){var L;M((L=d.data.serverUrl)!==null&&L!==void 0?L:"")}),j(!1)},[r.containerList]),r.containerList&&(0,e.jsxs)(Q.Z,{ghost:!0,title:(0,e.jsx)(Te.Z,{}),subTitle:"\u5BB9\u5668\u5217\u8868",extra:r.enableSelectService&&(0,e.jsx)(_.Z,{onChange:function(L){j(L.target.checked)},children:"\u81EA\u5B9A\u4E49\u90E8\u7F72\u5BB9\u5668\u670D\u52A1\uFF1F"},"selectService"),children:[(0,e.jsx)(Ue.Z,{ref:t}),(0,e.jsx)(Ve.Z,{ref:P}),(0,e.jsx)(Ae.Z,{scroll:{x:"max-content"},rowKey:"service",pagination:!1,columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"name",width:200,render:function(L,s,b){return(0,e.jsx)(re.Z,{title:s.service,children:(0,e.jsx)(Ie.Z,{content:s.name?(0,Ne.fi)(s.name,"/"):s.service})})}},{title:"\u7AEF\u53E3",render:function(L,s,b){var E=[],B=[];return s.publishers&&s.publishers.map(function(K){K.publishedPort?E.push({PrivatePort:K.targetPort,Type:K.protocol,IP:K.url,PublicPort:K.publishedPort}):K.publishedPort&&B.push({PrivatePort:K.targetPort,Type:K.protocol,IP:K.url,PublicPort:K.publishedPort})}),(0,e.jsx)(Be.Z,{publicPort:E,privatePort:B,domain:[],serverIp:$})}},{title:"\u72B6\u6001",render:function(L,s,b){return(0,e.jsx)(Oe.Z,{status:s.state,message:{content:W("container.status.".concat(s.state)),placement:"top",showInTag:!0}},s.name)}},{title:"\u64CD\u4F5C",fixed:"right",render:function(L,s,b){return(0,e.jsxs)(X.Z,{split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[s.name==""&&(0,e.jsx)($e.Z,{placement:"left",content:(0,e.jsx)(Q.Z,{ghost:!0,title:"\u5BB9\u5668\u5185\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(X.Z,{direction:"vertical",children:s.environment&&Object.keys(s.environment).map(function(E){if(s.environment&&s.environment[E])return(0,e.jsx)(J.Z.Text,{code:!0,children:"".concat(E,"=").concat(s.environment[E])},E)})})}),children:(0,e.jsx)(Me.Z,{})}),s.name!=""&&(0,e.jsx)(J.Z.Link,{onClick:function(){var B;(B=P.current)===null||B===void 0||B.show(s.name)},children:(0,e.jsx)(q.Z,{})},"container"),s.state=="running"&&(0,e.jsx)(J.Z.Link,{onClick:function(){var B;(B=t.current)===null||B===void 0||B.show({url:"/console/container/".concat(s.name),title:s.name})},children:(0,e.jsx)(De.Z,{})},"console")]})}}],dataSource:r.containerList,rowSelection:f&&r.containerList?{defaultSelectedRowKeys:r.containerList.map(function(d){return d.service}),onChange:function(L,s,b){r.selectServiceFinish&&r.selectServiceFinish(L)}}:void 0})]})}var We=n(81146),ze=n(45742),Fe=n(3616),Qe=(0,u.forwardRef)(function(r,k){(0,u.useImperativeHandle)(k,function(){return{show:function(Z){return D()(o()().mark(function g(){return o()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:x(r.composeItem),p(!0);case 2:case"end":return j.stop()}},g)}))()}}});var V=(0,u.useState)(!1),$=G()(V,2),M=$[0],p=$[1],y=(0,u.useState)(),W=G()(y,2),h=W[0],x=W[1],t=(0,u.useRef)();return(0,e.jsxs)(e.Fragment,{children:[r.showTriggerButton&&(0,e.jsx)(J.Z.Link,{onClick:D()(o()().mark(function P(){return o()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:x(r.composeItem),p(!0);case 2:case"end":return g.stop()}},P)})),children:(0,e.jsx)(re.Z,{title:"\u8FD0\u884C\u65E5\u5FD7",children:(0,e.jsx)(ze.Z,{})})},"log"),(0,e.jsx)(Ce.Z,{title:"\u4EFB\u52A1\u65E5\u5FD7",open:M,forceRender:!0,onClose:function(){p(!1)},afterOpenChange:function(Z){if(Z)setTimeout(function(){var f,j;(f=t.current)===null||f===void 0||f.start(),(j=t.current)===null||j===void 0||j.fit()},1e3);else{var g;(g=t.current)===null||g===void 0||g.close()}},width:Fe.FK,children:h&&M&&(0,e.jsx)(We.Z,{ref:t,showInDrawer:!0,id:"compose:log:".concat(String(h.id||h.name)),request:function(){var P=D()(o()().mark(function Z(g){var f;return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,R.Yz)({id:h.id||h.name,lineTotal:g.lineTotal,download:(f=g.download)!==null&&f!==void 0?f:!1,showTime:g.showTime});case 2:case"end":return d.stop()}},Z)}));return function(Z){return P.apply(this,arguments)}}(),download:function(){var P=D()(o()().mark(function Z(g){var f;return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,R.vf)({id:h.id||h.name,lineTotal:g.lineTotal,showTime:g.showTime,download:!0});case 2:return f=d.sent,d.abrupt("return",{data:new Blob([f],{type:"text/plain"}),name:r.composeItem.name+"_"+new Date().toLocaleDateString()+".log"});case 4:case"end":return d.stop()}},Z)}));return function(Z){return P.apply(this,arguments)}}()})})]})}),Ye=Qe,He=n(184),ke=n(95213),Xe=n(95089),Je=n(92398);function be(r){var k=(0,u.useContext)(ge.Z),V=k.message,$=(0,u.useRef)();return r.composeItem.yamlList&&(0,e.jsx)(He.a,{drawerProps:{width:Fe.R_},title:"\u7F16\u8F91\u4EFB\u52A1 Yaml",formRef:$,trigger:(0,e.jsx)(J.Z.Link,{children:(0,e.jsx)(re.Z,{title:"Yaml",children:"Yaml"})}),onFinish:function(){var M=D()(o()().mark(function p(y){return o()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,R.im)({id:String(r.composeItem.id?r.composeItem.id:r.composeItem.name),name:r.composeItem.name,type:r.composeItem.setting.type,yaml:y.yaml,yamlOverride:y.yamlOverride});case 2:return h.next=4,(0,R.xC)({yaml:[y.yaml,y.yamlOverride],environment:r.composeItem.setting.environment,id:r.composeItem.id||r.composeItem.name});case 4:return r.onFinish&&r.onFinish(),h.abrupt("return",!0);case 6:case"end":return h.stop()}},p)}));return function(p){return M.apply(this,arguments)}}(),children:(0,e.jsx)(Q.Z,{ghost:!0,children:(0,e.jsx)(Je.Z,{items:r.composeItem.yamlList.map(function(M,p){var y=[{label:"Yaml \u6587\u4EF6",key:"yaml"},{label:"\u8986\u76D6 Yaml \u6587\u4EF6",key:"yamlOverride"}];return{label:y[p].label,key:y[p].key,children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(A.Z,{hidden:!0,name:y[p].key}),(0,e.jsx)(A.Z,{shouldUpdate:!0,children:function(h){return(0,e.jsx)(Xe.ZP,{onFocus:function(){if(y[p].key=="yaml"&&r.composeItem.setting.type=="remoteUrl"){V.error("\u8FDC\u7A0Byaml\u6587\u4EF6\u65E0\u6CD5\u4FEE\u6539\uFF0C\u8BF7\u901A\u8FC7\u3010\u8986\u76D6 yaml \u6587\u4EF6\u3011\u7684\u65B9\u5F0F\u4FEE\u6539\u5185\u5BB9\u3002");return}},readOnly:y[p].key=="yaml"&&r.composeItem.setting.type=="remoteUrl",theme:"dark",minHeight:"550px",value:M,onChange:function(t){h.setFieldValue(y[p].key,t)},extensions:[ke.RI.yaml()]})}})]})}})})})})}var qe=n(65913),pe=n(1699),_e=n(28230),en=n(52756),nn=n(35887),tn=(0,u.forwardRef)(function(r,k){(0,u.useImperativeHandle)(k,function(){return{show:function(){return D()(o()().mark(function x(){var t;return o()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return W(!0),(t=$.current)===null||t===void 0||t.clear(),Z.next=4,new Promise(function(g){return setTimeout(function(){var f;(f=$.current)===null||f===void 0||f.fit(),g(!0)},1e3)});case 4:case"end":return Z.stop()}},x)}))()},close:function(){var x;W(!1),(x=$.current)===null||x===void 0||x.clear()}}});var V=(0,T.useModel)("subscriber"),$=(0,u.useRef)(),M=(0,u.useState)(!1),p=G()(M,2),y=p[0],W=p[1];return V.addDataHandler("compose:"+r.id,function(h){var x;(x=$.current)===null||x===void 0||x.write(h.data)}),(0,e.jsx)(Q.Z,{hidden:!y,ghost:!0,title:(0,e.jsx)(De.Z,{}),subTitle:"\u63A7\u5236\u53F0",extra:(0,e.jsx)(X.Z,{children:(0,e.jsx)(Y.Z,{action:function(){var x;return(x=$.current)===null||x===void 0||x.clear(),(0,R.U_)({})},icon:(0,e.jsx)(ue.Z,{}),danger:!0,onSuccess:function(){},children:"\u4E2D\u6B62\u6267\u884C"},"kill")}),children:(0,e.jsx)(nn.Z,{height:"200px",style:{fontSize:12},ref:$})})}),rn=tn,an=(0,u.forwardRef)(function(r,k){var V;(0,u.useImperativeHandle)(k,function(){return{show:function(a){return D()(o()().mark(function m(){var F;return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return(F=E.current)===null||F===void 0||F.close(),y(!0),l.prev=2,l.next=5,Ee(a);case 5:l.next=12;break;case 7:l.prev=7,l.t0=l.catch(2),y(!1),P(void 0),r.onClose&&r.onClose();case 12:case"end":return l.stop()}},m,null,[[2,7]])}))()}}});var $=(0,u.useState)(!1),M=G()($,2),p=M[0],y=M[1],W=(0,T.useNavigate)(),h=(0,u.useState)(),x=G()(h,2),t=x[0],P=x[1],Z=(0,u.useState)(0),g=G()(Z,2),f=g[0],j=g[1],d=(0,u.useRef)(),L=(0,u.useRef)(),s=(0,u.useRef)(),b=(0,u.useRef)(),E=(0,u.useRef)(),B=(0,u.useRef)(),K=(0,u.useContext)(ge.Z),sn=K.message,ae=(0,T.useAccess)(),ln=function(){var v=D()(o()().mark(function a(m){var F,w,l;return o()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(F=E.current)===null||F===void 0?void 0:F.show();case 2:if(!m.pullImageUseDPanel){c.next=6;break}return c.next=5,(w=b.current)===null||w===void 0?void 0:w.start();case 5:(l=b.current)===null||l===void 0||l.finish();case 6:return c.prev=6,c.next=9,(0,R.Oh)(m);case 9:r.onDeployFinish&&r.onDeployFinish(),c.next=15;break;case 12:c.prev=12,c.t0=c.catch(6),r.onDeployFailed&&r.onDeployFailed(t);case 15:j(f+1);case 16:case"end":return c.stop()}},a,null,[[6,12]])}));return function(m){return v.apply(this,arguments)}}(),Ee=function(){var v=D()(o()().mark(function a(m){var F,w,l,i,c,z,I;return o()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return(F=B.current)===null||F===void 0||F.show(),(w=d.current)===null||w===void 0||w.resetFields(),N.next=4,(0,R.Pn)({id:m}).finally(D()(o()().mark(function C(){var O;return o()().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:(O=B.current)===null||O===void 0||O.destroy();case 1:case"end":return xe.stop()}},C)}))).catch(function(C){throw C});case 4:l=N.sent,i=l.data.detail,i.setting.status&&i.setting.status.indexOf("running")>-1&&(i.isRunning=!0),i.setting.status&&i.setting.status.indexOf("paused")>-1&&(i.isPaused=!0),i.setting.status&&i.setting.status.indexOf("exited")>-1&&(i.isExited=!0),i.setting.status&&i.setting.status=="waiting"?i.isDeploy=!1:i.isDeploy=!0,i.setting.status&&i.setting.status.indexOf("created")>-1&&(i.isCreated=!0,i.isDeploy=!1),c=l.data.project,c&&(i.imageList=ce()(new Set(Object.keys(c.services).map(function(C){var O;return(O=c.services[C].image)!==null&&O!==void 0?O:""})))),i.containerList=l.data.containerList,(!i.containerList||i.containerList.length==0)&&c&&c.services&&(i.containerList=Object.keys(c.services).map(function(C){return{name:"",service:C,publishers:c.services[C].ports?c.services[C].ports.map(function(O){var ee;return{url:"",targetPort:O.target,publishedPort:parseInt(O.published),protocol:(ee=O.protocol)!==null&&ee!==void 0?ee:""}}):[],state:"waiting",status:"",environment:c.services[C].environment}})),i.containerList&&((z=d.current)===null||z===void 0||z.setFieldValue("deployServiceName",l.data.detail.setting.deployServiceName)),i.yamlList=l.data.yaml,P(i),l.data.yaml&&l.data.yaml.map(function(C){(0,we.m)(C).map(function(O){i.setting.environment&&!i.setting.environment.find(function(ee){return ee.name==O.name})&&i.setting.environment.push(O)})}),l.data.detail.setting.environment&&((I=d.current)===null||I===void 0||I.setFieldValue("environment",l.data.detail.setting.environment));case 20:case"end":return N.stop()}},a)}));return function(m){return v.apply(this,arguments)}}();return(0,u.useEffect)(function(){f>0&&t&&Ee(t.id||t.name).catch(function(v){y(!1)})},[f]),(0,e.jsx)(Ce.Z,{width:Fe.R_,forceRender:!0,extra:t&&t.setting.type!="dangling"&&(0,e.jsxs)(X.Z,{split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[t.isDeploy&&(0,e.jsx)(Ye,{composeItem:t,showTriggerButton:!0}),ae.canSeeComposeListManage&&(0,e.jsx)(_e.Z,{trigger:(0,e.jsx)(J.Z.Link,{children:(0,e.jsx)(me.Z,{})},"network")},"network-create"),ae.canSeeComposeListManage&&(0,e.jsx)(be,{composeItem:t,onFinish:D()(o()().mark(function v(){return o()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:sn.info("\u4FEE\u6539 Yaml \u540E\u8BF7\u66F4\u65B0\u8BE5\u4EFB\u52A1\uFF0C\u5982\u679C\u5305\u542B\u73AF\u5883\u53D8\u91CF\u6539\u52A8\uFF0C\u8BF7\u91CD\u65B0\u90E8\u7F72"),j(f+1);case 2:case"end":return m.stop()}},v)}))}),ae.canSeeComposeListManageCreate&&(0,e.jsx)(T.Link,{to:"/compose/create?id="+(t.id||t.name),children:(0,e.jsx)(re.Z,{title:"\u7F16\u8F91\u4EFB\u52A1",children:(0,e.jsx)(U.Z,{})})})]}),title:(0,e.jsxs)(X.Z,{children:["\u5FEB\u6377\u67E5\u770B\u4EFB\u52A1 - ",(V=t==null?void 0:t.name)!==null&&V!==void 0?V:""]}),open:p,onClose:function(){y(!1),P(void 0),r.onClose&&r.onClose()},children:(0,e.jsx)(qe.Z,{ref:B,children:(0,e.jsxs)(Q.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,e.jsxs)(Q.Z,{title:(0,e.jsx)(q.Z,{}),subTitle:"\u7BA1\u7406\u4EFB\u52A1",ghost:!0,extra:(0,e.jsx)(e.Fragment,{children:t&&t.imageList&&t.imageList.length>0&&(0,e.jsx)(Pe.Z,{ref:b,image:t.imageList})}),children:[t&&t.setting.type=="dangling"&&(0,e.jsx)(Re.Z,{type:"warning",showIcon:!0,description:(0,e.jsxs)("div",{children:["\u65E0\u6CD5\u627E\u5230\u8BE5\u4EFB\u52A1\u7684 yaml \u6587\u4EF6\uFF0C \u8BF7\u5728\u9762\u677F\u7684 /dpanel/compose \u76EE\u5F55\u4E2D\u6DFB\u52A0 ",t.name," \u76EE\u5F55, \u5728\u76EE\u5F55\u4E2D\u653E\u7F6E compose.yaml \u6587\u4EF6 ",(0,e.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/compose/external",target:"_blank",children:(0,en.getLang)("notification.help")})]})}),t&&t.setting.type!="dangling"&&(0,e.jsxs)(X.Z,{wrap:!0,split:(0,e.jsx)(he.Z,{type:"vertical"}),children:[(0,e.jsx)(pe.u,{access:"canSeeComposeList",children:(0,e.jsx)(Y.Z,{icon:(0,e.jsx)(H.Z,{}),type:"primary",confirmOnOpenChange:function(a){var m;a&&(!((m=s.current)===null||m===void 0)&&m.resetFields)&&s.current.resetFields()},confirm:(0,e.jsxs)(X.Z,{style:{width:300},direction:"vertical",children:[(0,e.jsx)(J.Z.Text,{children:"\u91CD\u65B0\u521B\u5EFA\u8BE5\u4EFB\u52A1\u4E0B\u7684\u5BB9\u5668\uFF1F"}),(0,e.jsxs)(te.A,{name:"createForm",formRef:s,layout:"inline",submitter:!1,children:[(0,e.jsx)(se.Z.Group,{name:"pullImageUse",layout:"vertical",fieldProps:{style:{display:"flex",flexDirection:"column",gap:8}},valueEnum:{useCommand:"\u4F7F\u7528\u547D\u4EE4\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u547D\u4EE4\u4EE3\u7406\uFF09\uFF1F",useDPanel:"\u4F7F\u7528\u9762\u677F\u62C9\u53D6\u955C\u50CF\uFF08\u9700\u914D\u7F6E\u4ED3\u5E93\u52A0\u901F\uFF09\uFF1F"}}),(0,e.jsx)(A.Z,{initialValue:!0,name:"createPath",valuePropName:"checked",children:(0,e.jsx)(_.Z,{defaultChecked:!0,children:"\u521B\u5EFA\u6302\u8F7D\u76EE\u5F55\uFF08\u4EC5\u9762\u677F\u975E\u5BB9\u5668\u90E8\u7F72\u751F\u6548\uFF09\uFF1F"})}),(0,e.jsx)(A.Z,{initialValue:!0,name:"removeOrphans",valuePropName:"checked",children:(0,e.jsx)(_.Z,{defaultChecked:!0,children:"\u6E05\u9664\u5DF2\u91CD\u547D\u540D\u6216\u662F\u88AB\u5220\u9664\u7684\u670D\u52A1\uFF1F"})})]})]}),action:D()(o()().mark(function v(){var a,m,F,w,l,i,c,z,I,ie;return o()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(I={id:t.id||t.name},(a=s.current)!==null&&a!==void 0&&a.getFieldValue&&((m=s.current)===null||m===void 0?void 0:m.getFieldValue("pullImageUse"))=="useDPanel"&&(I.pullImageUseDPanel=!0),I.environment=(F=d.current)===null||F===void 0?void 0:F.getFieldValue("environment"),I.deployServiceName=(w=d.current)===null||w===void 0?void 0:w.getFieldValue("deployServiceName"),I.createPath=(l=(i=s.current)===null||i===void 0?void 0:i.getFieldValue("createPath"))!==null&&l!==void 0?l:!0,I.removeOrphans=(c=(z=s.current)===null||z===void 0?void 0:z.getFieldValue("removeOrphans"))!==null&&c!==void 0?c:!0,!(t!=null&&t.isDeploy)){C.next=10;break}if(!((ie=s.current)!==null&&ie!==void 0&&ie.getFieldValue("pullImageUseCommand"))){C.next=10;break}return C.next=10,(0,R.GG)({id:t.id||t.name,op:"pull"});case 10:return C.abrupt("return",ln(I));case 11:case"end":return C.stop()}},v)})),children:t.isDeploy?"\u66F4\u65B0":"\u542F\u52A8"},"create")}),(t.isDeploy||t.isCreated)&&ae.canSeeComposeListManage&&(0,e.jsx)(Y.Z,{action:function(){var a;return(a=E.current)===null||a===void 0||a.show(),(0,R.mg)({id:t.id||t.name,deleteImage:!1,deleteData:!1,deleteVolume:!1,deletePath:!1})},onSuccess:function(){j(f+1)},type:"primary",danger:!0,confirm:"notification.confirm.title",icon:(0,e.jsx)(ue.Z,{}),children:"\u5220\u9664\u5BB9\u5668"}),t.isDeploy&&(0,e.jsxs)(pe.u,{access:"canSeeComposeList",space:{direction:"horizontal"},children:[(0,e.jsx)(Y.Z,{icon:(0,e.jsx)(S.Z,{}),action:D()(o()().mark(function v(){var a;return o()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return(a=E.current)===null||a===void 0||a.show(),F.abrupt("return",(0,R.GG)({id:t.id||t.name,op:"restart"}));case 2:case"end":return F.stop()}},v)})),onSuccess:function(){j(f+1)},children:"\u91CD\u542F"},"restart"),(0,e.jsx)(Y.Z,{action:function(){var a;return(a=E.current)===null||a===void 0||a.show(),(0,R.GG)({id:t.id||t.name,op:"stop"})},icon:(0,e.jsx)(fe.Z,{}),disabled:t.isExited,onSuccess:function(){j(f+1)},children:"\u505C\u6B62"}),t.isPaused&&(0,e.jsx)(Y.Z,{action:function(){var a;return(a=E.current)===null||a===void 0||a.show(),(0,R.GG)({id:t.id||t.name,op:"unpause"})},onSuccess:function(){j(f+1)},icon:(0,e.jsx)(H.Z,{}),children:"\u6062\u590D"}),!t.isPaused&&(0,e.jsx)(Y.Z,{action:function(){var a;return(a=E.current)===null||a===void 0||a.show(),(0,R.GG)({id:t.id||t.name,op:"pause"})},onSuccess:function(){j(f+1)},icon:(0,e.jsx)(ne.Z,{}),disabled:!t.isRunning,children:"\u6682\u505C"})]}),t.id>0&&ae.canSeeComposeListManageDelete&&(0,e.jsx)(Y.Z,{type:"primary",action:D()(o()().mark(function v(){var a,m,F,w,l,i,c,z,I;return o()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return(a=E.current)===null||a===void 0||a.show(),N.next=3,(0,R.mg)({id:(m=t==null?void 0:t.id)!==null&&m!==void 0?m:t.name,deleteImage:(F=(w=L.current)===null||w===void 0?void 0:w.getFieldValue("deleteImage"))!==null&&F!==void 0?F:!1,deleteVolume:(l=(i=L.current)===null||i===void 0?void 0:i.getFieldValue("deleteVolume"))!==null&&l!==void 0?l:!1,deletePath:(c=(z=L.current)===null||z===void 0?void 0:z.getFieldValue("deletePath"))!==null&&c!==void 0?c:!1});case 3:return N.next=5,(0,R.ik)({id:[(I=t.id)!==null&&I!==void 0?I:0]});case 5:j(f+1);case 6:case"end":return N.stop()}},v)})),danger:!0,onSuccess:function(){W("/compose/list")},confirm:(0,e.jsxs)(X.Z,{style:{width:240},direction:"vertical",children:[(0,e.jsx)(J.Z.Text,{children:"\u4F1A\u540C\u65F6\u5220\u9664\u5BB9\u5668\u53CA\u90E8\u7F72\u76F8\u5173\u6570\u636E\uFF0C\u672A\u52FE\u9009\u5220\u9664 compose \u6587\u4EF6\u65F6 yaml \u6587\u4EF6\u5C06\u4F1A\u4FDD\u7559\uFF0C\u786E\u8BA4\u5417\uFF1F"}),(0,e.jsxs)(te.A,{formRef:L,layout:"inline",submitter:!1,children:[(0,e.jsx)(A.Z,{initialValue:!1,name:"deleteImage",valuePropName:"checked",children:(0,e.jsx)(_.Z,{children:"\u5220\u9664\u955C\u50CF\uFF1F"})}),(0,e.jsx)(A.Z,{addonAfter:(0,e.jsx)(re.Z,{title:"\u672A\u6302\u8F7D\u955C\u50CF\u5185\u58F0\u660E\u7684\u76EE\u5F55\u5E76\u7531 docker \u81EA\u52A8\u521B\u5EFA\u7684\u5B58\u50A8\u5377",children:(0,e.jsx)(ve.Z,{})}),initialValue:!1,name:"deleteVolume",valuePropName:"checked",children:(0,e.jsx)(_.Z,{children:"\u5220\u9664\u533F\u540D\u5B58\u50A8\u5377\uFF1F"})}),(0,e.jsx)(A.Z,{initialValue:!1,name:"deletePath",valuePropName:"checked",children:(0,e.jsx)(_.Z,{children:"\u5220\u9664 Compose \u6587\u4EF6\u548C\u4EFB\u52A1\u76EE\u5F55\uFF1F"})})]})]}),children:"\u5220\u9664\u4EFB\u52A1"}),r.showBackListButton&&(0,e.jsx)(T.Link,{to:"/compose/list",children:(0,e.jsx)(Se.ZP,{children:"\u4EFB\u52A1\u5217\u8868"})})]})]},"operator"),t&&(0,e.jsx)(rn,{ref:E,id:t.id||t.name}),t&&(0,e.jsx)(Ge,{containerList:t.containerList,enableSelectService:!t.isDeploy,selectServiceFinish:function(a){var m;(m=d.current)===null||m===void 0||m.setFieldValue("deployServiceName",a)}}),(0,e.jsx)(pe.u,{access:"canSeeComposeList",children:(0,e.jsxs)(te.A,{submitter:!1,formRef:d,children:[(0,e.jsx)(A.Z,{name:"deployServiceName",hidden:!0}),t&&t.setting.type!="dangling"&&(0,e.jsx)(Q.Z,{title:"\u73AF\u5883\u53D8\u91CF",subTitle:"\u73AF\u5883\u53D8\u91CF\u4F1A\u8986\u76D6 .env \u6587\u4EF6",tooltip:"\u66B4\u9732\u73AF\u5883\u53D8\u91CF\u9700\u8981\u5728 yaml \u4E2D\u914D\u7F6E\u73AF\u5883\u53D8\u91CF",ghost:!0,children:(0,e.jsx)(Le.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,requireValue:!0,showDeleteButton:!1})})]})})]})})})}),un=an},35887:function(Ze,le,n){var oe=n(5574),ce=n.n(oe),de=n(12323),G=n(78267),ye=n.n(G),o=n(75458),je=n.n(o),D=n(67294),u=n(4244),Y=n.n(u),R=n(24078),me=n(85893),U,q,H,ue=(0,D.forwardRef)(function(S,fe){var ne,ve=(0,D.useState)(!0),Q=ce()(ve,2),te=Q[0],se=Q[1];return(0,D.useEffect)(function(){return U=new u.Terminal(de.X),q=new o.SearchAddon,H=new G.FitAddon,window.addEventListener("resize",function(){S.showInModal||H.fit()}),S.style&&S.style.fontSize&&(U.options.fontSize=S.style.fontSize),U.loadAddon(H),U.loadAddon(q),U.open(document.getElementById(S.id?S.id:"terminal-container")),S.showInModal||H.fit(),function(){U.reset(),se(!0)}},[]),(0,D.useImperativeHandle)(fe,function(){return{write:function(T){te&&(H.fit(),se(!1)),U.write(T)},clear:function(){U.clear()},getTerminal:function(){return U},findNext:function(T){q.findNext(T)},findPrev:function(T){q.findPrevious(T)},fit:function(){H.fit()},onData:function(T){return U.onData(T)}}}),(0,me.jsx)("div",{id:S.id?S.id:"terminal-container",style:{width:S.width?S.width:"100%",height:S.height?S.height:"500px",marginTop:(ne=S.style)===null||ne===void 0?void 0:ne.marginTop}})});le.Z=ue}}]);
