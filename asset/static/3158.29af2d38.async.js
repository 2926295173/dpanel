"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3158],{99922:function(de,Z,e){var K=e(97857),r=e.n(K),N=e(15009),_=e.n(N),x=e(99289),V=e.n(x),o=e(5574),f=e.n(o),M=e(67294),y=e(85265),A=e(42075),s=e(28036),R=e(49610),h=e(3616),D=e(93362),L=e(90581),g=e(5251),p=e(85893),k=(0,M.forwardRef)(function(m,le){var O,Q,v=(0,M.useRef)(),U=(0,M.useRef)(),_e=(0,M.useState)(!1),ne=f()(_e,2),B=ne[0],w=ne[1],S=(0,M.useState)(),$=f()(S,2),l=$[0],he=$[1];return(0,M.useImperativeHandle)(le,function(){return{show:function(G){return V()(_()().mark(function me(){var De;return _()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:he(G),w(!0),(De=v.current)===null||De===void 0||De.resetFields();case 3:case"end":return pe.stop()}},me)}))()}}}),(0,M.useEffect)(function(){return setTimeout(function(){var P;l&&((P=U.current)===null||P===void 0||P.start(l.url,{cmd:l&&l.cmd,workDir:l&&l.workDir}))},1e3),function(){var P;(P=U.current)===null||P===void 0||P.close()}},[l,B]),(0,p.jsxs)(y.Z,{forceRender:!0,width:h.FK,open:B,onClose:function(){return[w(!1)]},title:(l==null?void 0:l.title)+" - \u63A7\u5236\u53F0",children:[(0,p.jsxs)(A.Z,{style:{marginBottom:20},children:[(0,p.jsx)(D.Z,{trigger:(0,p.jsx)(s.ZP,{type:"primary",children:"\u6587\u4EF6\u7BA1\u7406"}),type:"container",title:(0,g.fi)((O=l==null?void 0:l.title)!==null&&O!==void 0?O:"","/"),name:l&&l.url&&(Q=l.url.split("/").pop())!==null&&Q!==void 0?Q:""}),(0,p.jsx)(L.Z,{onChangeShell:function(G){var me;if(!l)return!1;(me=U.current)===null||me===void 0||me.close(),G!=(l==null?void 0:l.cmd)&&he(r()(r()({},l),{cmd:G}))},onOpenNewWindow:function(G){return l?(G.workDir=l&&l.workDir?l.workDir:"","".concat(l.url,"?").concat(Object.keys(G).map(function(me){return"".concat(me,"=").concat(encodeURIComponent(G[me]))}).join("&"))):""},onOpenNewWindowFinish:function(){var G;(G=U.current)===null||G===void 0||G.close(),w(!1)},onBatchCommandFinish:function(G){U.current&&U.current.run(G)}})]}),B&&(0,p.jsx)(R.Z,{height:"80vh",ref:U})]})});Z.Z=k},93362:function(de,Z,e){var K=e(97857),r=e.n(K),N=e(5574),_=e.n(N),x=e(67294),V=e(4459),o=e(85265),f=e(3616),M=e(5251),y=e(85893),A=(0,x.forwardRef)(function(s,R){var h,D=(0,x.useState)(!1),L=_()(D,2),g=L[0],p=L[1],k=(0,x.useState)(),m=_()(k,2),le=m[0],O=m[1],Q=(0,x.useRef)();return(0,x.useImperativeHandle)(R,function(){return{showContainer:function(U){O({name:(0,M.fi)(U,"/"),type:"container"}),p(!0)},showHost:function(U){O({name:U,type:"host"}),p(!0)}}}),(0,y.jsxs)(y.Fragment,{children:[s.trigger?x.cloneElement(s.trigger,{onClick:function(){s.name&&s.type&&(O(s),p(!0))}}):null,(0,y.jsx)(o.Z,{width:f.R_,title:"".concat((h=s.title)!==null&&h!==void 0?h:le==null?void 0:le.name," \u6587\u4EF6\u7BA1\u7406"),onClose:function(){var U;(U=Q.current)===null||U===void 0||U.close(),p(!1)},open:g,children:g&&le&&(0,y.jsx)(V.Z,r()({ref:Q},le))})]})});Z.Z=A},80821:function(de,Z,e){e.d(Z,{Z:function(){return A}});var K=e(97857),r=e.n(K),N=e(5574),_=e.n(N),x=e(24963),V=e(86738),o=e(28036),f=e(83062),M=e(67294),y=e(85893);function A(s){var R=(0,M.useState)(!1),h=_()(R,2),D=h[0],L=h[1],g=(0,M.useContext)(x.Z),p=g.lang,k=g.message,m=function(){L(!0);var O=s.action();O instanceof Promise?O.then(function(Q){if(L(!1),Q){typeof s.onSuccess=="function"&&s.onSuccess(Q);var v="";s.messageSuccess?typeof s.messageSuccess=="function"?v=s.messageSuccess(Q):v=s.messageSuccess.indexOf("notification.")==0?p(s.messageSuccess):s.messageSuccess:v=p("notification.finish"),s.asynced?k.info(v):k.success(v)}}).catch(function(Q){L(!1),typeof s.onError=="function"&&s.onError(Q)}):L(!1)};return s.confirm?(0,y.jsx)(V.Z,r()(r()({style:{width:500},title:s.confirmTitle?s.confirmTitle:p("notification.title.tip"),description:typeof s.confirm=="string"&&s.confirm.indexOf("notification.")==0?p(s.confirm):s.confirm,onConfirm:m,okText:"Yes",cancelText:"No",onOpenChange:s.confirmOnOpenChange},s.confirmProps),{},{children:(0,y.jsx)(o.ZP,{block:s.block,disabled:s.disabled,icon:!s.children&&D?void 0:s.icon,loading:D,danger:s.danger,type:s.type,children:s.children})})):(0,y.jsx)(f.Z,{title:s.tips,children:(0,y.jsx)(o.ZP,{block:s.block,style:s.ghost?{padding:0,height:"auto",width:"auto"}:{},disabled:s.disabled,icon:!s.children&&D?void 0:s.icon,loading:D,onClick:m,danger:s.danger,type:s.type,children:s.children})})}},90581:function(de,Z,e){e.d(Z,{Z:function(){return Q}});var K=e(15009),r=e.n(K),N=e(99289),_=e.n(N),x=e(5574),V=e.n(x),o=e(3616),f=e(97269),M=e(38345),y=e(64317),A=e(37476),s=e(62370),R=e(97462),h=e(95089),D=e(42075),L=e(28036),g=e(83062),p=e(67294),k=e(58638),m=e(82346),le=e(69938),O=e(85893);function Q(v){var U=(0,p.useState)(!1),_e=V()(U,2),ne=_e[0],B=_e[1],w=(0,p.useRef)();return(0,O.jsx)(f.A,{layout:"inline",submitter:!1,children:(0,O.jsx)(M.Z,{ghost:!0,children:(0,O.jsxs)(D.Z,{children:[(0,O.jsx)(y.Z,{label:" ",width:"sm",name:"entryCmd",placeholder:"\u5207\u6362 shell \u73AF\u5883",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function($){v.onChangeShell&&v.onChangeShell($)}}),(0,O.jsx)(A.Y,{modalProps:{width:o.ob,height:o.Ed},title:"\u6279\u91CF\u6267\u884C\u811A\u672C",name:"batchCommand",open:ne,trigger:(0,O.jsx)(L.ZP,{children:"\u6279\u91CF\u6267\u884C"}),formKey:"batchCommand",formRef:w,isKeyPressSubmit:!0,onFinish:function(){var S=_()(r()().mark(function $(l){return r()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:v.onBatchCommandFinish&&v.onBatchCommandFinish(l.shell.split(`
`)),B(!1);case 2:case"end":return P.stop()}},$)}));return function($){return S.apply(this,arguments)}}(),onOpenChange:function($){B($),$&&w.current&&w.current.resetFields()},children:(0,O.jsx)(s.Z,{name:"shell",children:(0,O.jsx)(h.ZP,{theme:"dark",height:o.Ed})})}),(0,O.jsx)(R.Z,{name:["entryCmd"],children:function($){var l=$.entryCmd;return(!l||l=="")&&(l="/bin/sh"),v.onOpenNewWindow&&(0,O.jsx)(m.Link,{onClick:function(){v.onOpenNewWindowFinish&&v.onOpenNewWindowFinish()},target:"_blank",to:v.onOpenNewWindow({cmd:l}),children:(0,O.jsx)(g.Z,{title:"\u65B0\u7A97\u53E3\u6253\u5F00",children:(0,O.jsx)(L.ZP,{type:"dashed",icon:(0,O.jsx)(k.Z,{})})})})}}),(0,O.jsx)(le.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})}},49610:function(de,Z,e){var K=e(5574),r=e.n(K),N=e(67294),_=e(52626),x=e(78267),V=e.n(x),o=e(12323),f=e(87662),M=e(4244),y=e.n(M),A=e(24078),s=e(85893),R,h,D,L,g=(0,N.forwardRef)(function(p,k){var m,le=(0,N.useState)(),O=r()(le,2),Q=O[0],v=O[1],U=(0,N.useState)(""),_e=r()(U,2),ne=_e[0],B=_e[1];(0,N.useImperativeHandle)(k,function(){return{start:function($,l){w(),h.fit(),l.width=R.cols,l.height=R.rows;var he=l?Object.keys(l).filter(function(P){return l&&l[P]}).map(function(P){if(l&&l[P])return"".concat(P,"=").concat(l[P])}):[];D=new WebSocket((0,_.R)($+"?"+he.join("&"))),D.addEventListener("message",function(P){var G=JSON.parse(P.data),me=G.type;if(me==$&&(R.write(G.data),G.data.indexOf("exec failed")!=-1)){w();return}}),L=R.onData(function(P){var G={content:{command:P},type:$};D&&D.send(JSON.stringify(G))}),B($),v(l)},close:function(){w()},fit:function(){return h.fit(),{width:R.cols,height:R.rows}},run:function($){Q&&$&&$.forEach(function(l){var he={content:{command:l+`
`},type:ne};D&&D.send(JSON.stringify(he))})}}}),(0,N.useEffect)(function(){return R=new M.Terminal(o.X),h=new x.FitAddon,R.loadAddon(h),R.open(document.getElementById("terminal-container-console")),h.fit(),(0,f.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(S){S.data&&S.data.fontSize&&Object.assign(R.options,S.data)}),function(){w()}},[]),(0,N.useEffect)(function(){window.addEventListener("resize",function(){h.fit();var S={size:{width:R.cols,height:R.rows},type:ne};ne&&D&&D.send(JSON.stringify(S))})},[ne]);function w(){L&&(R.reset(),h.fit(),R.focus(),L.dispose()),D&&(D.close(),D=null)}return(0,s.jsx)("div",{style:{height:(m=p.height)!==null&&m!==void 0?m:"100vh"},id:"terminal-container-console"})});Z.Z=g},81366:function(de,Z,e){var K=e(97857),r=e.n(K),N=e(19632),_=e.n(N),x=e(5574),V=e.n(x),o=e(27254),f=e(42075),M=e(85418),y=e(25593),A=e(28036),s=e(67294),R=e(31112),h=e(85893),D={title:"ROOT",path:"/"},L=(0,s.forwardRef)(function(g,p){var k=(0,s.useContext)(R.Z),m=k.showPath,le=k.redirectPath,O=(0,s.useState)([D]),Q=V()(O,2),v=Q[0],U=Q[1];(0,s.useImperativeHandle)(p,function(){return{addHistory:function(B,w){w=="/"?U([D]):U([].concat(_()(v),[{title:B,path:w}]))},initHistory:function(B,w){U([r()(r()({},D),{},{children:w})].concat(_()(B)))}}});var _e=function(B){m?m(v[B].title,v[B].path):g.showPath&&g.showPath(v[B].title,v[B].path);var w=v.filter(function(S,$){return $<=B});U(_()(w))};return(0,h.jsxs)(f.Z,{children:[(0,h.jsx)(f.Z.Compact,{children:v.map(function(ne,B){return ne.children?(0,h.jsxs)(M.Z.Button,{menu:{items:ne.children.map(function(w,S){return{key:S,label:(0,h.jsx)(y.Z.Link,{onClick:function(){le(w)},children:w},S)}})},type:"dashed",onClick:function(S){_e(B)},children:[(0,h.jsx)(o.Z,{})," ",ne.title]},B):(0,h.jsx)(A.ZP,{icon:(0,h.jsx)(o.Z,{}),type:"dashed",onClick:function(){_e(B)},children:ne.title},B)})}),v.length>=2&&(0,h.jsx)(y.Z.Text,{copyable:{text:v[v.length-1].path}})]})});Z.Z=L},31112:function(de,Z,e){var K=e(67294),r=(0,K.createContext)({});Z.Z=r},4459:function(de,Z,e){e.d(Z,{Z:function(){return sn}});var K=e(15009),r=e.n(K),N=e(99289),_=e.n(N),x=e(5574),V=e.n(x),o=e(67294),f=e(82346);function M(t,u){return y.apply(this,arguments)}function y(){return y=_()(r()().mark(function t(u,c){var d;return r()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return d="/api/".concat(u,"/explorer/get-path-list"),X.next=3,(0,f.request)(d,{data:c,method:"POST"});case 3:return X.abrupt("return",X.sent);case 4:case"end":return X.stop()}},t)})),y.apply(this,arguments)}function A(t,u){return s.apply(this,arguments)}function s(){return s=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/export"),{data:c,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),s.apply(this,arguments)}function R(t,u){return h.apply(this,arguments)}function h(){return h=_asyncToGenerator(_regeneratorRuntime().mark(function t(u,c){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c.enableExportHost=!0,n.next=3,request("/api/".concat(u,"/explorer/export"),{data:c,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},t)})),h.apply(this,arguments)}function D(t,u){return L.apply(this,arguments)}function L(){return L=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/import"),{data:c,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),L.apply(this,arguments)}function g(t,u){return p.apply(this,arguments)}function p(){return p=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/delete"),{data:c,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),p.apply(this,arguments)}function k(t,u){return m.apply(this,arguments)}function m(){return m=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/unzip"),{data:c,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),m.apply(this,arguments)}function le(t,u){return O.apply(this,arguments)}function O(){return O=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/get-content"),{data:c,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),O.apply(this,arguments)}function Q(t,u){return v.apply(this,arguments)}function v(){return v=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/import-file-content"),{data:c,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),v.apply(this,arguments)}function U(t,u){return _e.apply(this,arguments)}function _e(){return _e=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/mkdir"),{data:c,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),_e.apply(this,arguments)}function ne(t,u){return B.apply(this,arguments)}function B(){return B=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/chmod"),{data:c,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),B.apply(this,arguments)}function w(t,u){return S.apply(this,arguments)}function S(){return S=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/get-user-list"),{data:c,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),S.apply(this,arguments)}function $(t,u){return l.apply(this,arguments)}function l(){return l=_()(r()().mark(function t(u,c){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,f.request)("/api/".concat(u,"/explorer/get-file-stat"),{data:c,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},t)})),l.apply(this,arguments)}var he=e(41482),P=e(31112),G=e(51042),me=e(48689),De=e(42075),ge=e(28036),pe=e(80821),Le=e(88484),Ae=e(37476),Ue=e(91604),we=e(97961),Fe=e(3616),a=e(85893);function Ie(){var t=(0,o.useRef)(),u=(0,o.useContext)(P.Z),c=u.refresh,d=u.name,n=u.apiPrefix,X=u.currentPath;return(0,a.jsx)(Ae.Y,{modalProps:{width:Fe.ob},formRef:t,trigger:(0,a.jsx)(ge.ZP,{icon:(0,a.jsx)(Le.Z,{}),children:"\u4E0A\u4F20"}),title:"\u4E0A\u4F20\u6587\u4EF6\u5230\u5BB9\u5668",onFinish:function(){var q=_()(r()().mark(function ee(I){var oe,te;return r()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return te=[],I.importFileList&&I.importFileList.map(function(H){te.push({name:H.name,path:H.response.data.path})}),D(n,{fileList:te,name:d,destPath:X}),(oe=t.current)===null||oe===void 0||oe.resetFields(),c(),se.abrupt("return",!0);case 6:case"end":return se.stop()}},ee)}));return function(ee){return q.apply(this,arguments)}}(),children:(0,a.jsx)(Ue.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(ee){return new Promise(function(I){var oe;(0,we._2)({path:(oe=ee.response.data.path)!==null&&oe!==void 0?oe:""}).then(function(te){I(!0)})})}}})})}var Ze=e(23430),Ke=e(93162),xe=e(24963);function Se(t){var u=(0,o.useContext)(P.Z),c=u.name,d=u.apiPrefix,n=(0,o.useContext)(xe.Z),X=n.message;return(0,a.jsx)(pe.Z,{action:function(){return!t.selectFileList||t.selectFileList.length==0?(X.info("\u8BF7\u9009\u62E9\u8981\u4E0B\u8F7D\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):A(d,{name:c,fileList:t.selectFileList})},onSuccess:function(ee){var I=new Blob([ee],{type:"application/zip"});(0,Ke.saveAs)(I,"export.zip")},icon:(0,a.jsx)(Ze.Z,{}),children:"\u4E0B\u8F7D"})}var Me=e(38345),ve=e(63434),$e=e(24739),Re=e(5966);function Ne(t){var u=(0,o.useContext)(xe.Z),c=u.notice,d=(0,o.useRef)(),n=(0,o.useContext)(P.Z),X=n.currentPath,q=n.refresh,ee=n.name,I=n.apiPrefix,oe=(0,o.useState)(!1),te=V()(oe,2),fe=te[0],se=te[1],H=function(C){var E=C.split(""),F=0,b=0,T=0;return E[1]=="r"&&(F+=4),E[2]=="w"&&(F+=2),E[3]=="x"&&(F+=1),E[4]=="r"&&(b+=4),E[5]=="w"&&(b+=2),E[6]=="x"&&(b+=1),E[7]=="r"&&(T+=4),E[8]=="w"&&(T+=2),E[9]=="x"&&(T+=1),"".concat(F).concat(b).concat(T)},Pe=function(C){var E;if((E=d.current)===null||E===void 0||E.setFieldValue("permission",C),C.length>=1){var F;(F=d.current)===null||F===void 0||F.setFieldsValue({ownerRead:Number(C[0])&4,ownerWrite:Number(C[0])&2,ownerExec:Number(C[0])&1})}if(C.length>=2){var b;(b=d.current)===null||b===void 0||b.setFieldsValue({groupRead:Number(C[1])&4,groupWrite:Number(C[1])&2,groupExec:Number(C[1])&1})}if(C.length>=3){var T;(T=d.current)===null||T===void 0||T.setFieldsValue({everyoneRead:Number(C[2])&4,everyoneWrite:Number(C[2])&2,everyoneExec:Number(C[2])&1})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ge.ZP,{onClick:_()(r()().mark(function ce(){var C;return r()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!(!t.selectFileObject||t.selectFileObject.length==0)){F.next=7;break}return(C=d.current)===null||C===void 0||C.resetFields(),c.error("\u8BF7\u5148\u9009\u62E9\u8981\u4FEE\u6539\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),se(!1),F.abrupt("return",!1);case 7:se(!0);case 8:case"end":return F.stop()}},ce)})),children:"\u6743\u9650"}),(0,a.jsxs)(Ae.Y,{modalProps:{forceRender:!0,width:Fe.ob},title:t.selectFileObject.length==1?"\u4FEE\u6539 ".concat(t.selectFileObject[0].name," \u6743\u9650"):"\u6279\u91CF\u6587\u4EF6\u4FEE\u6539\u6743\u9650",layout:"horizontal",open:fe,onOpenChange:function(C){se(C),t.selectFileObject.length==1&&Pe(H(t.selectFileObject[0].modStr))},formRef:d,onValuesChange:function(C,E){if(C.permission)Pe(C.permission);else{var F=["-",E.ownerRead?"r":"-",E.ownerWrite?"w":"-",E.ownerExec?"x":"-",E.groupRead?"r":"-",E.groupWrite?"w":"-",E.groupExec?"x":"-",E.everyoneRead?"r":"-",E.everyoneWrite?"w":"-",E.everyoneExec?"x":"-"];Pe(H(F.join("")))}},onFinish:function(){var ce=_()(r()().mark(function C(E){var F,b,T,Ee;return r()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return T=[],t.selectFileObject.map(function(J){T.push(J.path)}),ae.next=4,ne(I,{name:ee,fileList:T,mod:(F=E.permission)!==null&&F!==void 0?F:"600",hasChildren:(b=E.hasChildren)!==null&&b!==void 0?b:!0,user:E.user});case 4:return Ee=ae.sent,q(),ae.abrupt("return",!0);case 7:case"end":return ae.stop()}},C)}));return function(C){return ce.apply(this,arguments)}}(),children:[(0,a.jsxs)(Me.Z,{direction:"row",gutter:[20,10],children:[(0,a.jsxs)(Me.Z,{bordered:!0,title:"\u6240\u6709\u8005",headerBordered:!0,children:[(0,a.jsx)(ve.Z,{label:"\u8BFB\u53D6",name:"ownerRead"}),(0,a.jsx)(ve.Z,{label:"\u5199\u5165",name:"ownerWrite"}),(0,a.jsx)(ve.Z,{label:"\u6267\u884C",name:"ownerExec"})]}),(0,a.jsxs)(Me.Z,{bordered:!0,title:"\u7528\u6237\u7EC4",headerBordered:!0,children:[(0,a.jsx)(ve.Z,{label:"\u8BFB\u53D6",name:"groupRead"}),(0,a.jsx)(ve.Z,{label:"\u5199\u5165",name:"groupWrite"}),(0,a.jsx)(ve.Z,{label:"\u6267\u884C",name:"groupExec"})]}),(0,a.jsxs)(Me.Z,{bordered:!0,title:"\u516C\u5171",headerBordered:!0,children:[(0,a.jsx)(ve.Z,{label:"\u8BFB\u53D6",name:"everyoneRead"}),(0,a.jsx)(ve.Z,{label:"\u5199\u5165",name:"everyoneWrite"}),(0,a.jsx)(ve.Z,{label:"\u6267\u884C",name:"everyoneExec"})]})]}),(0,a.jsx)(Me.Z,{children:(0,a.jsxs)($e.UW,{children:[(0,a.jsx)(Re.Z,{label:"\u6743\u9650",name:"permission",fieldProps:{maxLength:3},width:"xs"}),(0,a.jsxs)(De.Z.Compact,{children:[(0,a.jsx)(Re.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237",label:"\u6240\u6709\u8005",name:"user",fieldProps:{addonAfter:":"}}),(0,a.jsx)(Re.Z,{width:"sm",placeholder:"\u6307\u5B9A\u6240\u5C5E\u7528\u6237\u7EC4",name:"group"})]}),(0,a.jsx)(ve.Z,{label:"\u5E94\u7528\u5230\u5B50\u76EE\u5F55",name:"hasChildren",initialValue:!0})]})})]})]})}var ke=e(27461);function He(t){var u=(0,o.useContext)(P.Z),c=u.currentPath,d=u.refresh,n=u.name,X=u.apiPrefix,q=(0,o.useContext)(xe.Z),ee=q.notice;return(0,a.jsx)(pe.Z,{icon:(0,a.jsx)(ke.Z,{}),action:_()(r()().mark(function I(){return r()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(t.selectFileObject.length!=0){te.next=3;break}return ee.error("\u8BF7\u5148\u9009\u62E9\u8981\u89E3\u538B\u7684 .zip .tar .tar.gz \u6587\u4EF6"),te.abrupt("return",!1);case 3:return te.abrupt("return",k(X,{name:n,file:t.selectFileObject.map(function(fe){return fe.path}),path:c}));case 4:case"end":return te.stop()}},I)})),onSuccess:function(){d()},children:"\u89E3\u538B"})}function un(t){var u=useContext(FileExplorerContext),c=u.name,d=u.apiPrefix,n=useContext(AppContext),X=n.message,q=useRef();return _jsx(RequestButton,{confirm:_jsx(Space,{children:_jsx(ProForm,{layout:"inline",submitter:!1,formRef:q,children:_jsx(ProFormText,{width:"md",label:"\u5BFC\u51FA\u5230\u4E3B\u673A\u76EE\u5F55",name:"hostPath"})})}),action:function(){var I;return!t.selectFileList||t.selectFileList.length==0?(X.info("\u8BF7\u9009\u62E9\u8981\u5BFC\u51FA\u7684\u6587\u4EF6\u6216\u662F\u76EE\u5F55"),!1):exportFileList(d,{name:c,hostPath:(I=q.current)===null||I===void 0?void 0:I.getFieldValue("hostPath"),enableExportHost:!0,fileList:t.selectFileList})},icon:_jsx(ExportOutlined,{}),children:"\u5BFC\u51FA\u5230\u4E3B\u673A"})}function ze(t){var u=(0,o.useContext)(P.Z),c=u.refresh,d=u.name,n=u.apiPrefix,X=u.currentPath,q=u.newFile;return(0,a.jsxs)(De.Z,{size:16,wrap:!0,children:[(0,a.jsx)(Se,{selectFileList:t.selectFileList}),!1,(0,a.jsx)(Ie,{}),(0,a.jsx)(Ne,{selectFileObject:t.selectFileObject}),(0,a.jsx)(He,{selectFileObject:t.selectFileObject}),(0,a.jsx)(ge.ZP,{icon:(0,a.jsx)(G.Z,{}),onClick:function(){q()},type:"primary",children:"\u65B0\u5EFA"}),(0,a.jsx)(pe.Z,{danger:!0,type:"default",icon:(0,a.jsx)(me.Z,{}),action:function(){return g(n,{name:d,fileList:t.selectFileList})},onSuccess:function(){c()},confirm:"notification.confirm.title",children:"\u5220\u9664"})]})}var be=e(83062),Te=e(66309);function Ve(t){return t.change==0?(0,a.jsx)(be.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u4FEE\u6539",children:(0,a.jsx)(Te.Z,{color:"blue",children:"MODIFIED"})}):t.change==1?(0,a.jsx)(be.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u65B0\u589E\u7684\u6587\u4EF6",children:(0,a.jsx)(Te.Z,{color:"green",children:"ADD"})}):t.change==2?(0,a.jsx)(be.Z,{title:"\u5728\u5BB9\u5668\u8FD0\u884C\u65F6\u88AB\u5220\u9664\u6587\u4EF6",children:(0,a.jsx)(Te.Z,{color:"error",children:"DELETED"})}):t.change==100?(0,a.jsx)(be.Z,{title:"\u6302\u8F7D\u7684\u6301\u4E45\u5316\u76EE\u5F55",children:(0,a.jsx)(Te.Z,{color:"cyan",children:"VOLUME"})}):(0,a.jsx)(a.Fragment,{})}var Ge=e(81366),Je=e(97269),Ye=e(86615),Qe=e(97462),Xe=e(62370),qe=e(85576),en=e(95089),Be=e(5251),nn=(0,o.forwardRef)(function(t,u){var c,d,n,X=(0,o.useContext)(xe.Z),q=X.message,ee=X.notice,I=(0,o.useContext)(P.Z),oe=I.currentPath,te=I.refresh,fe=I.name,se=I.apiPrefix,H=(0,o.useRef)(),Pe=(0,o.useState)(!1),ce=V()(Pe,2),C=ce[0],E=ce[1];return(0,o.useImperativeHandle)(u,function(){return{newFile:function(){var b,T;E(!0),(b=H.current)===null||b===void 0||b.resetFields(),(T=H.current)===null||T===void 0||T.setFieldValue("type","newFile")},editFile:function(b,T,Ee){return _()(r()().mark(function W(){var ae,J,j,i,z;return r()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return(ae=H.current)===null||ae===void 0||ae.resetFields(),q.loading("\u6B63\u5728\u83B7\u53D6\u6587\u4EF6\u5185\u5BB9"),Y.next=4,le(se,{name:fe,file:T}).finally(function(){q.destroy()});case 4:if(z=Y.sent,!(z.data.content==""&&Ee!="0")){Y.next=9;break}return q.error("\u4E0D\u652F\u6301\u7F16\u8F91\u7684\u6587\u4EF6\u7C7B\u578B"),E(!1),Y.abrupt("return");case 9:return(J=H.current)===null||J===void 0||J.setFieldValue("newValue",z.data.content),(j=H.current)===null||j===void 0||j.setFieldValue("newName",b),(i=H.current)===null||i===void 0||i.setFieldValue("type","editFile"),E(!0),Y.abrupt("return");case 14:case"end":return Y.stop()}},W)}))()}}}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(qe.Z,{width:Fe.ob,title:(c=H.current)!==null&&c!==void 0&&c.getFieldValue("newName")?"\u7F16\u8F91\u6587\u4EF6":"\u65B0\u5EFA\u6587\u4EF6",open:C,onCancel:function(){var b;E(!1),(b=H.current)===null||b===void 0||b.resetFields()},footer:!1,forceRender:!0,children:(0,a.jsxs)(Je.A,{formRef:H,onFinish:function(){var F=_()(r()().mark(function b(T){return r()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(T.type!="newDir"){W.next=13;break}return W.prev=1,W.next=4,U(se,{name:fe,destPath:"".concat(oe,"/").concat((0,Be.fi)(T.newPath,"/"))});case 4:return te(),E(!1),W.abrupt("return",!0);case 9:W.prev=9,W.t0=W.catch(1);case 11:W.next=23;break;case 13:return W.prev=13,W.next=16,Q(se,{destPath:oe,file:T.newName,content:T.newValue,name:fe});case 16:return te(),E(!1),W.abrupt("return",!0);case 21:W.prev=21,W.t1=W.catch(13);case 23:return W.abrupt("return",!1);case 24:case"end":return W.stop()}},b,null,[[1,9],[13,21]])}));return function(b){return F.apply(this,arguments)}}(),children:[(0,a.jsx)(Ye.Z.Group,{name:"type",options:[{label:"\u7F16\u8F91\u6587\u4EF6",value:"editFile",disabled:((d=H.current)===null||d===void 0?void 0:d.getFieldValue("type"))!="editFile"},{label:"\u65B0\u5EFA\u6587\u4EF6",value:"newFile"},{label:"\u65B0\u5EFA\u76EE\u5F55",value:"newDir"}],disabled:((n=H.current)===null||n===void 0?void 0:n.getFieldValue("type"))=="editFile"}),(0,a.jsx)(Qe.Z,{name:["type"],children:function(b){var T=b.type;return T!="newDir"?[(0,a.jsx)(Re.Z,{label:"\u6587\u4EF6\u540D",tooltip:"\u7F16\u8F91\u6587\u4EF6\u65F6\u4FEE\u6539\u6587\u4EF6\u540D\u53EF\u5B9E\u73B0\u590D\u5236\u529F\u80FD",name:"newName",fieldProps:{addonBefore:"".concat(oe,"/")},placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D",disabled:T=="editFile"},"fileName"),(0,a.jsx)(Xe.Z,{label:"\u5185\u5BB9",name:"newValue",children:(0,a.jsx)(en.ZP,{theme:"dark",height:Fe.Ed,onChange:function(W){var ae;(ae=H.current)===null||ae===void 0||ae.setFieldValue("newValue",W)}})},"fileContent")]:(0,a.jsx)(Re.Z,{name:"newPath",label:"\u76EE\u5F55\u540D",placeholder:"\u8F93\u5165\u76EE\u5F55\u540D\u79F0\uFF0C\u652F\u6301\u591A\u7EA7"})}})]})})})}),tn=nn,rn=e(99922),We=e(68536),ln=null,an=(0,o.forwardRef)(function(t,u){(0,o.useImperativeHandle)(u,function(){return{close:function(){H([]),I("")}}});var c=(0,o.useRef)(),d=(0,o.useRef)(),n=(0,o.useRef)(),X=(0,o.useState)(""),q=V()(X,2),ee=q[0],I=q[1],oe=(0,o.useRef)(),te=(0,f.useSearchParams)(),fe=V()(te,2),se=fe[0],H=fe[1],Pe=(0,o.useState)(),ce=V()(Pe,2),C=ce[0],E=ce[1],F=(0,o.useContext)(xe.Z),b=F.lang,T=F.message,Ee=t.type=="host"?"common":"app";(0,o.useEffect)(function(){T.info(b("app.detail.createExplorerPlugin")),I("")},[]);function W(J,j){return ae.apply(this,arguments)}function ae(){return ae=_()(r()().mark(function J(j,i){var z,ue,Y;return r()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:(z=c.current)===null||z===void 0||z.addHistory(j,i),I(i),n.current&&(ue=n.current)!==null&&ue!==void 0&&ue.reloadAndRest&&((Y=n.current)===null||Y===void 0||Y.reloadAndRest()),i=="/"?H([]):(se.set("path",i),H(se));case 4:case"end":return ie.stop()}},J)})),ae.apply(this,arguments)}return t&&(0,a.jsxs)(P.Z.Provider,{value:{apiPrefix:Ee,name:t.name,currentPath:ee,showPath:W,redirectPath:function(j){var i;if(I(j),n.current&&(i=n.current)!==null&&i!==void 0&&i.reloadAndRest){var z;(z=n.current)===null||z===void 0||z.reloadAndRest()}j=="/"?H([]):(se.set("path",j),H(se))},refresh:function(){var j;if(n&&typeof((j=n.current)===null||j===void 0?void 0:j.reloadAndRest)=="function"){var i;(i=n.current)===null||i===void 0||i.reloadAndRest()}},editFile:function(j,i,z){d.current&&d.current.editFile(j,i,z)},newFile:function(){d.current&&d.current.newFile()}},children:[(0,a.jsx)(he.Z,{scroll:{x:"max-content"},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},toolBarRender:function(){var j=[];return t.onConsole&&j.push((0,a.jsx)(ge.ZP,{type:"dashed",onClick:function(){t.onConsole&&t.onConsole(ee)},children:"Console"},"fileConsole")),[].concat(j)},tableAlertOptionRender:function(j){var i=j.selectedRowKeys,z=j.selectedRows,ue=[];return z.map(function(Y){ue.push(Y.path)}),[(0,a.jsx)(ze,{selectFileList:ue,selectFileObject:z,enableExportHost:t.type=="container"},"1")]},headerTitle:(0,a.jsx)(Ge.Z,{ref:c}),actionRef:n,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:_()(r()().mark(function J(){var j,i,z,ue,Y;return r()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,M(Ee,{name:t.name,path:ee});case 2:if(i=ie.sent,ee==""&&i.data.currentPath!=""&&I(i.data.currentPath),z=[],(j=c.current)===null||j===void 0||j.initHistory(i.data.currentPath.split("/").filter(function(re){return re!=""}).map(function(re){return z.push(re),{title:re,path:"/".concat(z.join("/"))}}),i.data.rootDirs),ue=C,ue){ie.next=13;break}return ie.next=10,w(Ee,{name:t.name});case 10:Y=ie.sent,E(Y.data),ue=Y.data;case 13:return ie.abrupt("return",{data:i.data.list.map(function(re){if(ue){var Ce,ye;re.group=(Ce=(ye=ue.group.find(function(je){return je.gid==re.group}))===null||ye===void 0?void 0:ye.name)!==null&&Ce!==void 0?Ce:re.group}return re}),success:!0,total:i.data.list.length});case 14:case"end":return ie.stop()}},J)})),columns:[{title:"\u540D\u79F0",dataIndex:"name",key:"name",render:function(Oe,i,z,ue,Y){var Oe;return i.isDir?Oe=(0,a.jsx)(We.Z,{isDir:!0,onClick:function(){return W(i.name,i.path)},showName:i.name}):i.isSymlink?Oe=(0,a.jsx)(We.Z,{isLink:!0,showName:"".concat(i.name," -> ").concat(i.linkName),onClick:_()(r()().mark(function ie(){var re,Ce;return r()().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:return je.next=2,$(Ee,{name:t.name,path:i.path});case 2:re=je.sent,re.data.info.isDir?W(i.name,re.data.info.target):(Ce=d.current)===null||Ce===void 0||Ce.editFile(re.data.info.name,re.data.info.target,i.size);case 4:case"end":return je.stop()}},ie)}))}):Oe=(0,a.jsx)(We.Z,{showName:i.name,onClick:function(){var re;(re=d.current)===null||re===void 0||re.editFile(i.name,i.path,i.size)}}),Oe}},{title:"\u72B6\u6001",key:"status",width:110,render:function(j,i,z,ue,Y){return(0,a.jsx)(Ve,{change:i.change})}},{title:"\u6743\u9650",dataIndex:"modStr",key:"mod"},{title:"\u7528\u6237",dataIndex:"user"},{title:"\u7528\u6237\u7EC4",dataIndex:"group"},{title:"\u5927\u5C0F",dataIndex:"size",key:"size",render:function(j,i,z,ue,Y){return(0,Be.FI)(i.size)}},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"modTime",key:"modTime",sorter:function(j,i){return new Date(j.modTime).getTime()-new Date(i.modTime).getTime()},render:function(j,i,z,ue,Y){return(0,Be.NF)(i.modTime)}}],cardProps:{ghost:!0}}),(0,a.jsx)(tn,{ref:d}),(0,a.jsx)(rn.Z,{ref:oe})]})}),sn=an},68536:function(de,Z,e){e.d(Z,{Z:function(){return y}});var K=e(24963),r=e(93613),N=e(36693),_=e(2741),x=e(25593),V=e(42075),o=e(67294),f=e(85893),M=0;function y(A){var s=(0,o.useContext)(K.Z),R=s.message;return A.isDir?(0,f.jsx)(x.Z.Link,{onClick:function(){A.onClick&&A.onClick()},children:(0,f.jsxs)(V.Z,{children:[(0,f.jsx)(r.Z,{}),A.showName]})}):A.isLink?(0,f.jsx)(x.Z.Link,{onClick:function(){A.onClick&&A.onClick()},children:(0,f.jsxs)(V.Z,{children:[(0,f.jsx)(N.Z,{}),A.showName]})}):(0,f.jsx)(x.Z.Text,{onClick:function(){if(M++,M==2){M=0,A.onClick&&A.onClick();return}setTimeout(function(){M==1&&R.info("\u53CC\u51FB\u67E5\u770B\u6587\u4EF6\u5185\u5BB9"),M=0},400)},style:{cursor:"pointer"},children:(0,f.jsxs)(V.Z,{children:[(0,f.jsx)(_.Z,{}),A.showName]})})}},3616:function(de,Z,e){e.d(Z,{Ed:function(){return _},FK:function(){return r},R_:function(){return K},ob:function(){return N}});var K=window.innerWidth<=1024?"90vw":"65vw",r="90vw",N="60vw",_="50vh"},12323:function(de,Z,e){e.d(Z,{X:function(){return K},n:function(){return r}});var K={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},r=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},24963:function(de,Z,e){var K=e(67294),r=(0,K.createContext)({});Z.Z=r},97961:function(de,Z,e){e.d(Z,{GH:function(){return A},MF:function(){return D},_2:function(){return R},fN:function(){return o},ii:function(){return V},vC:function(){return M}});var K=e(15009),r=e.n(K),N=e(99289),_=e.n(N),x=e(82346),V=[{name:"amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"i386",arch:"386",search:[]},{name:"arm/v6",arch:"arm",search:[]},{name:"arm/v7",arch:"arm",search:[]},{name:"arm/v8",arch:"arm64",search:[]},{name:"ppc64le",arch:"ppc64le",search:[]},{name:"riscv64",arch:"riscv64",search:[]}];function o(g){return f.apply(this,arguments)}function f(){return f=_()(r()().mark(function g(p){return r()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,x.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:p}));case 1:case"end":return m.stop()}},g)})),f.apply(this,arguments)}function M(g){return y.apply(this,arguments)}function y(){return y=_()(r()().mark(function g(p){return r()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,x.request)("/api/app/image/import-by-container-tar",{method:"POST",data:p}));case 1:case"end":return m.stop()}},g)})),y.apply(this,arguments)}function A(g){return s.apply(this,arguments)}function s(){return s=_()(r()().mark(function g(p){return r()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,x.request)("/api/app/image/import-by-image-tar",{method:"POST",data:p}));case 1:case"end":return m.stop()}},g)})),s.apply(this,arguments)}function R(g){return h.apply(this,arguments)}function h(){return h=_()(r()().mark(function g(p){return r()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,x.request)("/api/common/attach/delete",{method:"POST",data:p});case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},g)})),h.apply(this,arguments)}function D(){return L.apply(this,arguments)}function L(){return L=_()(r()().mark(function g(){return r()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.abrupt("return",(0,x.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return k.stop()}},g)})),L.apply(this,arguments)}}}]);
