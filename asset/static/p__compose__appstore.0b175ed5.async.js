"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7499],{80821:function(re,Z,t){t.d(Z,{Z:function(){return x}});var L=t(5574),r=t.n(L),$=t(24963),p=t(86738),m=t(28036),z=t(83062),O=t(67294),w=t(85893);function x(u){var j=(0,O.useState)(!1),K=r()(j,2),E=K[0],D=K[1],y=(0,O.useContext)($.Z),P=y.lang,b=y.notice,o=y.message,h=function(){D(!0);var i=u.action();i instanceof Promise?i.then(function(I){if(D(!1),I){typeof u.onSuccess=="function"&&u.onSuccess(I);var A="";u.messageSuccess?typeof u.messageSuccess=="function"?A=u.messageSuccess(I):A=u.messageSuccess.indexOf("notification.")==0?P(u.messageSuccess):u.messageSuccess:A=P("notification.finish"),u.asynced?o.info(A):o.success(A)}}).catch(function(I){D(!1),typeof u.onError=="function"&&u.onError(I)}):D(!1)};return u.confirm?(0,w.jsx)(p.Z,{style:{width:500},title:u.confirmTitle?u.confirmTitle:P("notification.title.tip"),description:typeof u.confirm=="string"&&u.confirm.indexOf("notification.")==0?P(u.confirm):u.confirm,onConfirm:h,okText:"Yes",cancelText:"No",children:(0,w.jsx)(m.ZP,{disabled:u.disabled,icon:u.icon,loading:E,danger:u.danger,type:u.type,children:u.children})}):(0,w.jsx)(z.Z,{title:u.tips,children:(0,w.jsx)(m.ZP,{style:u.ghost?{padding:0,height:"auto"}:{},disabled:u.disabled,icon:u.icon,loading:E,onClick:h,danger:u.danger,type:u.type,children:u.children})})}},24963:function(re,Z,t){var L=t(67294),r=(0,L.createContext)({});Z.Z=r},43774:function(re,Z,t){t.r(Z),t.d(Z,{default:function(){return me}});var L=t(5574),r=t.n(L),$=t(24963),p=t(15078),m=t(90078),z=t(97269),O=t(62370),w=t(97462),x=t(38345),u=t(45360),j=t(42075),K=t(65233),E=t(28036),D=t(92398),y=t(2487),P=t(32983),b=t(4393),o=t(67294),h=t(15009),T=t.n(h),i=t(99289),I=t.n(i),A=t(184),Q=t(51652),F=t(71230),M=t(15746),X=t(34041),ie=t(36693),q=t(74842),ee=t(25593),ne=t(83062),ae=t(66309),n=t(85893);function a(l){var N=(0,o.useState)(),R=r()(N,2),g=R[0],U=R[1];return(0,o.useEffect)(function(){var G=l.url.substring(0,l.url.indexOf("://"));switch(G){case"image":U((0,n.jsx)("img",{width:l.imageSize?l.imageSize.width:"auto",height:l.imageSize?l.imageSize.height:"auto",src:l.url.replace("image://","/dpanel/static/store/file/")}));break;case"http":case"https":U((0,n.jsx)("img",{width:l.imageSize?l.imageSize.width:"auto",height:l.imageSize?l.imageSize.height:"auto",src:l.url}));break;case"markdown-file":(0,p.yL)({path:l.url.replace("markdown-file://","/dpanel/static/store/file/")}).then(function(H){U((0,n.jsx)(Q.Z,{source:H,style:{padding:5}},"content"))});break;case"markdown":U((0,n.jsx)(Q.Z,{source:l.url.replace("markdown://",""),style:{padding:5}},"content"));break;default:U("")}},[l.url]),(0,n.jsx)(n.Fragment,{children:g})}function s(l){return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(F.Z,{gutter:[10,10],children:[(0,n.jsx)(M.Z,{span:6,children:(0,n.jsx)(a,{url:l.app.logo,imageSize:l.logoSize})}),(0,n.jsxs)(M.Z,{span:l.extra?12:18,children:[(0,n.jsx)(F.Z,{children:(0,n.jsx)(M.Z,{span:24,children:(0,n.jsxs)(j.Z,{direction:"horizontal",children:[(0,n.jsx)(ee.Z.Title,{level:5,children:l.app.title}),(0,n.jsx)(ee.Z.Text,{children:l.app.name})]})})}),(0,n.jsx)(F.Z,{style:{height:"60px"},children:(0,n.jsx)(M.Z,{children:(0,n.jsx)(ne.Z,{title:l.app.description,children:(0,n.jsx)(ee.Z.Paragraph,{ellipsis:{rows:2},children:l.app.description})})})}),(0,n.jsx)(F.Z,{style:{height:"35px"},children:(0,n.jsx)(M.Z,{children:(0,n.jsxs)(j.Z,{wrap:!0,children:[l.app.storeName?(0,n.jsx)(ae.Z,{color:"blue-inverse",children:l.app.storeName}):"",l.app.tag&&l.app.tag.map(function(N,R){return(0,n.jsx)(ae.Z,{children:N},R)})]})})})]}),(0,n.jsx)(M.Z,{span:l.extra?6:0,children:l.extra})]})})}var C=t(80821),e=t(90098),ce=t(82346),de=(0,o.forwardRef)(function(l,N){var R=(0,o.useState)(!1),g=r()(R,2),U=g[0],G=g[1],H=(0,o.useState)(),ue=r()(H,2),f=ue[0],se=ue[1],W=(0,o.useState)(""),k=r()(W,2),V=k[0],te=k[1],oe=(0,ce.useNavigate)();return(0,o.useImperativeHandle)(N,function(){return{show:function(_){G(!0),se(_),te(Object.keys(_.version)[0])}}}),(0,n.jsx)(A.a,{submitter:!1,open:U,onOpenChange:function(_){G(_)},title:"".concat(f==null?void 0:f.name," \u8BE6\u60C5\u4ECB\u7ECD"),children:f&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.Z,{ghost:!0,style:{marginBottom:"20px",paddingBottom:"20px",borderBottom:"#eeeeee solid 1px"},children:(0,n.jsx)(s,{app:f,logoSize:{width:"130",height:"130"},extra:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(F.Z,{gutter:[10,10],children:[(0,n.jsx)(M.Z,{children:(0,n.jsxs)(j.Z,{wrap:!0,children:[(0,n.jsx)(E.ZP,{href:f.website,target:"_blank",icon:(0,n.jsx)(ie.Z,{}),children:"\u5B98\u7F51"},"website"),(0,n.jsx)(C.Z,{action:I()(T()().mark(function v(){var _,d;return T()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,e.iE)({storeId:(_=f.storeId)!==null&&_!==void 0?_:0,name:f.name,title:f.title,composeFile:f.version[V].composeFile,environment:f.version[V].environment});case 2:d=S.sent,d&&d.data.id&&oe("/compose/create?id="+d.data.id);case 4:case"end":return S.stop()}},v)})),type:"primary",icon:(0,n.jsx)(q.Z,{}),children:"\u5B89\u88C5"},"install")]})}),(0,n.jsx)(M.Z,{span:24,children:f.version&&(0,n.jsx)(X.Z,{style:{width:"100%"},value:V,onChange:function(_){te(_)},options:Object.keys(f.version).map(function(v){return{value:v,label:v}})})})]})})})}),Object.keys(f.version).map(function(v){if(!(V!=v||!f.version[v].environment||f.version[v].environment.length==0)){var _=[{name:"%CONTAINER_DEFAULT_NAME%",value:"-",label:"\u4F7F\u7528 Compose \u9ED8\u8BA4\u5BB9\u5668\u540D\u79F0"}],d=`## DPanel \u9762\u677F\u5185\u7F6E\u53D8\u91CF 
 |\u53D8\u91CF\u540D|\u9ED8\u8BA4\u503C|\u8BF4\u660E| 
 |---|---|---|
`;return _.map(function(c){d+="|".concat(c.name,"|").concat(c.value,"|").concat(c.label,`| 
`)}),d+="## \u7248\u672C\u4FE1\u606F <sup>".concat(v,`</sup> 
 |\u53D8\u91CF\u540D|\u9ED8\u8BA4\u503C|\u8BF4\u660E| 
 |---|---|---|
`),f.version[v].environment.map(function(c){d+="|".concat(c.name,"|").concat(c.value,"|").concat(c.label,`| 
`)}),d+="<br />",(0,n.jsx)(Q.Z,{source:d,style:{padding:5}},v)}}),(0,n.jsx)(a,{url:f==null?void 0:f.content})]})})}),pe=de,J="dpanel-search-result";function me(){var l=(0,o.useRef)(),N=(0,o.useState)(),R=r()(N,2),g=R[0],U=R[1],G=(0,o.useContext)($.Z),H=G.loading,ue=G.lang,f=(0,o.useState)(""),se=r()(f,2),W=se[0],k=se[1],V=(0,o.useState)([]),te=r()(V,2),oe=te[0],v=te[1];(0,o.useEffect)(function(){H.show(),(0,p.eO)().then(function(d){d&&d.data&&d.data.list&&d.data.list.push({id:-1,name:J,title:"\u641C\u7D22\u7ED3\u679C",setting:{apps:[]}}),U(Object.fromEntries(d.data.list.map(function(c){return[c.name,c]}))),d.data.list.length>0&&k(d.data.list[0].name)}).finally(function(){H.destroy()})},[]);var _=function(c){var S=[];c=c.toLowerCase(),g&&(Object.keys(g).map(function(Y){Y!=J&&g[Y].setting.apps.map(function(B){if(c&&(B.name.toLowerCase().indexOf(c)!==-1||B.title&&B.title.toLowerCase().indexOf(c)!==-1||B.description&&B.description.toLocaleLowerCase().indexOf(c)!==-1)){var le=JSON.parse(JSON.stringify(B));le.storeName="".concat(g[Y].title),le.storeId=g[Y].id,S.push(le)}})}),S.length>0?(v(S),k(J)):(u.ZP.error("\u672A\u80FD\u627E\u5230\u5305\u542B\u5173\u952E\u5B57\u7684\u5E94\u7528"),k(Object.keys(g)[0]),v([])))};return(0,n.jsxs)(m._z,{extra:[(0,n.jsx)(z.A,{isKeyPressSubmit:!0,submitter:!1,onFinish:function(c){_(c.search)},children:(0,n.jsxs)(j.Z.Compact,{children:[(0,n.jsx)(O.Z,{style:{margin:0},name:"search",children:(0,n.jsx)(K.Z,{allowClear:!0,addonBefore:"\u5168\u5546\u5E97\u67E5\u8BE2",placeholder:"\u6309\u56DE\u8F66\u67E5\u8BE2\u5E94\u7528",onClear:function(){_("")}})}),(0,n.jsx)(w.Z,{name:["search"],children:function(c){var S=c.search;return(0,n.jsx)(E.ZP,{onClick:function(){_(S)},children:"\u641C\u7D22"})}})]})},"form")],children:[(0,n.jsx)(pe,{ref:l}),(0,n.jsxs)(x.Z,{children:[W!=""&&g&&(0,n.jsx)(D.Z,{activeKey:W,onChange:function(c){v([]),k(c)},items:Object.keys(g).map(function(d){return{label:g[d].title,key:d,disabled:W!=J&&d==J}})}),(0,n.jsx)(y.Z,{locale:{emptyText:(0,n.jsx)(P.Z,{image:P.Z.PRESENTED_IMAGE_SIMPLE,description:(0,n.jsxs)(n.Fragment,{children:["\u9762\u677F\u652F\u6301\u591A\u79CD\u7C7B\u578B\u7684\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\uFF0C",(0,n.jsx)(ce.Link,{to:"/system/appstore?op=create",children:"\u8BF7\u5148\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5546\u5E97"})]})})},pagination:{pageSize:36},rowKey:function(c){return"".concat(c.name).concat(c.storeName)},grid:{gutter:10,xs:1,sm:2,md:2,lg:2,xl:2,xxl:3},dataSource:W==J?oe:g&&g[W]&&g[W].setting.apps,renderItem:function(c,S){return(0,n.jsx)(y.Z.Item,{children:(0,n.jsx)(b.Z,{onClick:function(){if(g){var B;c.storeId||(c.storeId=g[W].id),(B=l.current)===null||B===void 0||B.show(c)}},hoverable:!0,children:(0,n.jsx)(s,{app:c,logoSize:{width:"50",height:"50"}})})},S)}})]})]})}},15078:function(re,Z,t){t.d(Z,{$c:function(){return z},Me:function(){return D},eO:function(){return K},ks:function(){return w},yL:function(){return P}});var L=t(15009),r=t.n(L),$=t(99289),p=t.n($),m=t(82346);function z(o){return O.apply(this,arguments)}function O(){return O=p()(r()().mark(function o(h){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,m.request)("/api/common/store/create",{method:"POST",data:h}));case 1:case"end":return i.stop()}},o)})),O.apply(this,arguments)}function w(o){return x.apply(this,arguments)}function x(){return x=p()(r()().mark(function o(h){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,m.request)("/api/common/store/sync",{method:"POST",data:h}));case 1:case"end":return i.stop()}},o)})),x.apply(this,arguments)}function u(o){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function o(h){return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:h}));case 1:case"end":return i.stop()}},o)})),j.apply(this,arguments)}function K(o){return E.apply(this,arguments)}function E(){return E=p()(r()().mark(function o(h){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,m.request)("/api/common/store/get-list",{method:"POST",data:h}));case 1:case"end":return i.stop()}},o)})),E.apply(this,arguments)}function D(o){return y.apply(this,arguments)}function y(){return y=p()(r()().mark(function o(h){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,m.request)("/api/common/store/delete",{method:"POST",data:h});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},o)})),y.apply(this,arguments)}function P(o){return b.apply(this,arguments)}function b(){return b=p()(r()().mark(function o(h){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,m.request)(h==null?void 0:h.path,{method:"GET"}));case 1:case"end":return i.stop()}},o)})),b.apply(this,arguments)}},90098:function(re,Z,t){t.d(Z,{CT:function(){return K},GG:function(){return T},MG:function(){return M},Oh:function(){return P},Pn:function(){return u},U_:function(){return Q},VN:function(){return I},iE:function(){return ee},ik:function(){return D},im:function(){return z},mg:function(){return o},pm:function(){return w},tw:function(){return ae},xC:function(){return ie}});var L=t(15009),r=t.n(L),$=t(99289),p=t.n($),m=t(82346);function z(a){return O.apply(this,arguments)}function O(){return O=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/app/compose/create",{method:"POST",data:s}));case 1:case"end":return e.stop()}},a)})),O.apply(this,arguments)}function w(a){return x.apply(this,arguments)}function x(){return x=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/app/compose/get-list",{method:"POST",data:s}));case 1:case"end":return e.stop()}},a)})),x.apply(this,arguments)}function u(a){return j.apply(this,arguments)}function j(){return j=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.id=String(s.id),e.abrupt("return",(0,m.request)("/api/app/compose/get-task",{method:"POST",data:s}));case 2:case"end":return e.stop()}},a)})),j.apply(this,arguments)}function K(a){return E.apply(this,arguments)}function E(){return E=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.id=String(s.id),e.abrupt("return",(0,m.request)("/api/app/compose/get-detail",{method:"POST",data:s}));case 2:case"end":return e.stop()}},a)})),E.apply(this,arguments)}function D(a){return y.apply(this,arguments)}function y(){return y=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/app/compose/delete",{method:"POST",data:s}));case 1:case"end":return e.stop()}},a)})),y.apply(this,arguments)}function P(a){return b.apply(this,arguments)}function b(){return b=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.id=String(s.id),e.abrupt("return",(0,m.request)("/api/app/compose/container-deploy",{method:"POST",data:s}));case 2:case"end":return e.stop()}},a)})),b.apply(this,arguments)}function o(a){return h.apply(this,arguments)}function h(){return h=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.id=String(s.id),e.abrupt("return",(0,m.request)("/api/app/compose/container-destroy",{method:"POST",data:s}));case 2:case"end":return e.stop()}},a)})),h.apply(this,arguments)}function T(a){return i.apply(this,arguments)}function i(){return i=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.id=String(s.id),e.abrupt("return",(0,m.request)("/api/app/compose/container-ctrl",{method:"POST",data:s}));case 2:case"end":return e.stop()}},a)})),i.apply(this,arguments)}function I(a){return A.apply(this,arguments)}function A(){return A=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.id=String(s.id),e.abrupt("return",(0,m.request)("/api/app/compose/container-log",{method:"POST",data:s}));case 2:case"end":return e.stop()}},a)})),A.apply(this,arguments)}function Q(a){return F.apply(this,arguments)}function F(){return F=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/app/compose/container-process-kill",{method:"POST",data:s}));case 1:case"end":return e.stop()}},a)})),F.apply(this,arguments)}function M(a){return X.apply(this,arguments)}function X(){return X=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/app/compose/get-from-uri",{method:"POST",data:s}));case 1:case"end":return e.stop()}},a)})),X.apply(this,arguments)}function ie(a){return q.apply(this,arguments)}function q(){return q=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/app/compose/parse",{method:"POST",data:s}));case 1:case"end":return e.stop()}},a)})),q.apply(this,arguments)}function ee(a){return ne.apply(this,arguments)}function ne(){return ne=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,m.request)("/api/common/store/deploy",{method:"POST",data:s}));case 1:case"end":return e.stop()}},a)})),ne.apply(this,arguments)}function ae(a){return n.apply(this,arguments)}function n(){return n=p()(r()().mark(function a(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.id=String(s.id),e.abrupt("return",(0,m.request)("/api/app/compose/download",{method:"POST",data:s,responseType:"blob"}));case 2:case"end":return e.stop()}},a)})),n.apply(this,arguments)}}}]);
