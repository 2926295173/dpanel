"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{91058:function(Ce,z,n){var te=n(5574),i=n.n(te),ue=n(89035),g=n(38345),f=n(17186),R=n(24739),Z=n(5966),I=n(42075),j=n(28036),G=n(85576),s=n(67294),w=n(95089),ae=n(89063),C=n(85893),X="docker-image",o=(0,s.forwardRef)(function(t,V){var y=(0,s.useState)(X),D=i()(y,2),$=D[0],ie=D[1],k=(0,s.useRef)(),re=(0,s.useState)(""),J=i()(re,2),B=J[0],b=J[1],F=function(){$!="code"?ie("code"):ie(X)};(0,s.useImperativeHandle)(V,function(){return{addEnvItem:function(S,Q){var oe,q=(oe=k.current)===null||oe===void 0?void 0:oe.getList(),_e=!1;if(q==null||q.map(function(Ie){if(Ie.name==S){_e=!0;return}}),!_e){var e;(e=k.current)===null||e===void 0||e.add({name:S,value:Q})}},clear:function(){var S;(S=k.current)===null||S===void 0||(S=S.getList())===null||S===void 0||S.map(function(Q,oe){var q;(q=k.current)===null||q===void 0||q.remove(oe)})}}});function a(W){try{var S,Q;W==""&&(W=Fe());for(var oe=(S=(Q=k.current)===null||Q===void 0||(Q=Q.getList())===null||Q===void 0?void 0:Q.length)!==null&&S!==void 0?S:0,q=oe;q>=0;q--){var _e;(_e=k.current)===null||_e===void 0||_e.remove(q)}var e=W.split(`
`),Ie=0;e.map(function(je){var Te,me=je.split("=");me.length<2||((Te=k.current)===null||Te===void 0||Te.add({name:me[0],value:me.slice(1).join("=")},Ie),Ie++)})}catch(je){console.log(je)}}function Fe(){if(k&&k.current&&k.current.getList){var W,S=(W=k.current)===null||W===void 0?void 0:W.getList();if(S){var Q=[];return S.map(function(oe){Q.push("".concat(oe.name,"=").concat(oe.value))}),Q.join(`
`)}else return""}else return""}return(0,C.jsxs)(g.Z,{ghost:t.showCardGhost,title:t.label?t.label:null,headerBordered:!0,extra:(t.showCodeMode||t.showImportButton)&&(0,C.jsxs)(I.Z,{children:[t.showImportButton&&(0,C.jsx)("div",{style:{marginBottom:"-25px"},children:(0,C.jsx)(ae.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(S){return a(S),!0},onLoad:function(S){if(S.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),t.showCodeMode?(0,C.jsx)(j.ZP,{icon:(0,C.jsx)(ue.Z,{}),type:$=="code"?"primary":"default",onClick:F,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,C.jsx)(f.u,{name:t.name?t.name:"environment",actionRef:k,creatorButtonProps:t.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,min:100,label:t.listLabel,children:function(S,Q,oe){var q=oe.getCurrentRowData();return(0,C.jsxs)(R.UW,{children:[(0,C.jsx)(Z.Z,{width:t.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:t.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),(0,C.jsx)(Z.Z,{width:t.showInDrawer?"sm":"md",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:!!t.requireValue}],disabled:t.showDisableValue,placeholder:q&&q.label?q.label:"\u8F93\u5165\u53D8\u91CF\u503C"})]})}}),(0,C.jsx)(G.Z,{width:"800px",open:$=="code",onCancel:function(){return ie("docker-image")},onOk:function(){a(B),ie("docker-image")},children:(0,C.jsx)(w.ZP,{onChange:function(S){return b(S)},value:Fe(),height:"680px",theme:"light"})})]})});z.Z=o},28307:function(Ce,z,n){var te=n(5574),i=n.n(te),ue=n(38345),g=n(97269),f=n(5966),R=n(64317),Z=n(62370),I=n(28036),j=n(85265),G=n(42075),s=n(67294),w=n(80821),ae=n(3393),C=n(97961),X=n(92754),o=n(63713),t=n(85893),V=(0,s.forwardRef)(function(y,D){var $=(0,s.useState)(!1),ie=i()($,2),k=ie[0],re=ie[1],J=(0,s.useRef)(),B=(0,s.useRef)();return(0,s.useImperativeHandle)(D,function(){return{upgradeImage:function(F){var a;return re(!0),(a=J.current)===null||a===void 0||a.setFieldValue("imageUrl",F),(0,ae.Gb)({tag:F,type:"pull"})},setImageName:function(F){var a;re(!0),(a=J.current)===null||a===void 0||a.setFieldValue("imageUrl",F)}}}),[(0,t.jsx)(I.ZP,{type:y.buttonType?y.buttonType:"default",onClick:function(){var F,a;y.onClick&&y.onClick(),re(!0),(F=J.current)===null||F===void 0||F.resetFields(),(a=B.current)===null||a===void 0||a.setStart("")},children:"\u62C9\u53D6\u955C\u50CF"},"remoteBtn"),(0,t.jsxs)(j.Z,{forceRender:!0,open:k,title:"\u62C9\u53D6\u8FDC\u7A0B\u955C\u50CF",width:800,onClose:function(){return re(!1)},footer:!1,children:[(0,t.jsx)(ue.Z,{children:(0,t.jsxs)(G.Z,{direction:"vertical",size:"middle",children:[(0,t.jsxs)("div",{children:["1\u3001\u955C\u50CF\u540D\u79F0\u4E2D\u4E0D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C \u9ED8\u8BA4\u4ECE ",(0,t.jsx)("a",{href:"https://hub.docker.com/",target:"_blank",children:"docker hub"})," \u4E2D\u4E0B\u8F7D\uFF0C \u4F60\u53EF\u4EE5\u5728\u4E0A\u9762",(0,t.jsx)("a",{href:"https://hub.docker.com/search?q=",target:"_blank",children:"\u3010\u67E5\u627E\u3011"}),"\u9700\u8981\u7684\u955C\u50CF"]}),(0,t.jsxs)("div",{children:["2\u3001\u955C\u50CF\u4E2D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C\u8BF7\u786E",(0,t.jsx)(o.Link,{to:"/image/registry",children:"\u3010\u6DFB\u52A0\u3011"}),"\u8FC7\u8BE5\u4ED3\u5E93\uFF0C\u5E76\u6709 Pull \u6743\u9650"]}),(0,t.jsxs)("div",{children:["3\u3001\u53EF\u5728",(0,t.jsx)(o.Link,{to:"/image/registry",children:"\u3010\u4ED3\u5E93\u7BA1\u7406\u3011"}),"\u4E2D\u914D\u7F6E\u955C\u50CF\u7684\u52A0\u901F\u5730\u5740"]})]})}),(0,t.jsx)(ue.Z,{title:"\u62C9\u53D6\u955C\u50CF",headerBordered:!0,children:(0,t.jsxs)(g.A,{submitter:!1,formRef:J,children:[(0,t.jsxs)(G.Z.Compact,{children:[(0,t.jsx)(f.Z,{width:400,name:"imageUrl",placeholder:"\u8BF7\u8F93\u5165\u955C\u50CF\u5730\u5740"}),(0,t.jsx)(R.Z,{name:"platform",style:{width:150},placeholder:"\u9ED8\u8BA4\u5F53\u524D\u67B6\u6784",options:C.ii.map(function(b){return{label:b.name,value:b.name}})}),(0,t.jsx)(w.Z,{action:function(){var F,a,Fe,W,S,Q=(F=(a=J.current)===null||a===void 0?void 0:a.getFieldValue("imageUrl"))!==null&&F!==void 0?F:"";return(Fe=B.current)===null||Fe===void 0||Fe.setStart(Q),(0,ae.Gb)({tag:Q,type:"pull",platform:(W=(S=J.current)===null||S===void 0?void 0:S.getFieldValue("platform"))!==null&&W!==void 0?W:""})},onSuccess:function(F){var a;(a=B.current)===null||a===void 0||a.setFinish(),re(!1),y.onFinish&&(console.log(F),y.onFinish(F.data.tag))},messageSuccess:"imagePull",children:"\u62C9\u53D6\u955C\u50CF"})]}),(0,t.jsx)(Z.Z,{label:"\u62C9\u53D6\u8FDB\u5EA6",children:(0,t.jsx)(X.Z,{ref:B})})]})})]},"remoteDrawer")]});z.Z=V},44349:function(Ce,z,n){var te=n(97857),i=n.n(te),ue=n(17186),g=n(5966),f=n(86250),R=n(67294),Z=n(85893),I=(0,R.forwardRef)(function(j,G){var s=(0,R.useRef)();(0,R.useImperativeHandle)(G,function(){return{addItem:function(C,X){var o,t=(o=s.current)===null||o===void 0?void 0:o.getList(),V=!1;if(t==null||t.map(function(D){if(D.name==C){V=!0;return}}),!V){var y;(y=s.current)===null||y===void 0||y.add({name:C,value:X})}},clear:function(){var C;(C=s.current)===null||C===void 0||(C=C.getList())===null||C===void 0||C.map(function(X,o){var t;(t=s.current)===null||t===void 0||t.remove(o)})}}});var w={};return j.hideCopyButton===!0&&(w.copyIconProps=!1),j.hideDeleteButton===!0&&(w.deleteIconProps=!1),(0,Z.jsx)(ue.u,i()(i()({initialValue:j.initialValue,label:j.label,name:j.name,actionRef:s,creatorButtonProps:j.showAddButton?{creatorButtonText:"\u6DFB\u52A0"+(j.label?j.label:j.name)}:!1,min:j.min?j.min:0},w),{},{children:function(C,X,o){return(0,Z.jsx)(f.Z,{justify:j.justify,gap:j.gap,children:j.items.map(function(t){return t.render?(0,Z.jsx)("div",{children:t.render&&t.render(C,X,o)},"".concat(j.name,"-").concat(t.name,"-").concat(C.key)):(0,Z.jsx)(g.Z,{width:t.width,name:t.name,label:t.label,required:t.required,rules:[{required:t.required}],disabled:t.disabled,placeholder:t.placeholder},"".concat(j.name,"-").concat(t.name,"-").concat(C.key))})})}}))});z.Z=I},89063:function(Ce,z,n){n.d(z,{Z:function(){return I}});var te=n(24963),i=n(88484),ue=n(62370),g=n(31418),f=n(28036),R=n(67294),Z=n(85893);function I(j){var G=(0,R.useContext)(te.Z),s=G.message,w=G.notice,ae=G.lang,C=(0,R.useRef)(null),X=g.Z.useApp(),o=function(){C.current&&(C.current.click(),C.current.onchange=function(V){if(!V||!V.target)return"";var y=new FileReader;y.onload=function($){var ie,k,re=(ie=$.target)===null||ie===void 0?void 0:ie.result;if(j.onLoad)try{j.onLoad&&j.onLoad(re)}catch(J){w.error(J);return}typeof j.onImport=="function"&&(s.success("\u6210\u529F\u5BFC\u5165 ".concat(j.title)),j.onImport(re)),(k=C.current)!==null&&k!==void 0&&k.value&&(C.current.value="")};var D=V.target;if(D.files)try{y.readAsText(D.files[0])}catch($){w.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(ue.Z,{children:(0,Z.jsx)(f.ZP,{icon:(0,Z.jsx)(i.Z,{}),block:!0,onClick:o,children:j.title})}),(0,Z.jsx)("input",{style:{display:"none"},type:"file",ref:C,name:"importFileInput"})]})}},35880:function(Ce,z,n){var te=n(67294),i=(0,te.createContext)({});z.Z=i},21965:function(Ce,z,n){n.r(z),n.d(z,{default:function(){return Dn}});var te=n(15009),i=n.n(te),ue=n(99289),g=n.n(ue),f=n(5574),R=n.n(f),Z=n(90078),I=n(38345),j=n(97269),G=n(2236),s=n(5966),w=n(97462),ae=n(64218),C=n(92398),X=n(38925),o=n(67294),t=n(35880),V=n(10641),y=n(62370),D=n(85576),$=n(42075),ie=n(96074),k=n(25593),re=n(83062),J=n(71230),B=n(15746),b=n(28036),F=n(3393),a=n(18148),Fe=n(5251),W=n(64789),S=n(75162),Q=n(85060),oe=n(28307),q=n(78451),_e=n(99861),e=n(85893);function Ie(d){var O=(0,o.useState)(!1),x=R()(O,2),v=x[0],c=x[1],_=(0,o.useRef)(),l=(0,o.useContext)(t.Z),p=l.createFormRef,T=l.volumeListRef,A=l.createEnvRef,m=l.domainRef,h=(0,o.useRef)(),U=function(){var P=g()(i()().mark(function M(E){var L,Y,le,N,se,fe,ee,Ae,ve,he,xe,ce;return i()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return c(!1),r.next=3,(0,F.YU)({md5:E});case 3:N=r.sent,d.redeploy||(Ae=(se=p.current)===null||se===void 0?void 0:se.getFieldsValue(),(fe=p.current)===null||fe===void 0||fe.resetFields(),(ee=p.current)===null||ee===void 0||ee.setFieldsValue({siteName:Ae.siteName,siteTitle:Ae.siteTitle})),N.data.info.Config.Env&&N.data.info.Config.Env.map(function(u){var de,pe=u.split("=");(de=A.current)===null||de===void 0||de.addEnvItem(pe[0],pe.slice(1).join("="))}),(L=p.current)===null||L===void 0||L.setFieldValue("imageName",E),(Y=p.current)===null||Y===void 0||Y.setFieldValue("workDir",N.data.info.Config.WorkingDir),(le=m.current)===null||le===void 0||le.setExposePort(N.data.info.Config.ExposedPorts),d.redeploy||(N.data.info.Config.Volumes?(xe=[],Object.keys(N.data.info.Config.Volumes).map(function(u,de){xe.push(u)}),(he=T.current)===null||he===void 0||he.setDefaultDestPath(xe)):(ce=T.current)===null||ce===void 0||ce.setDefaultDestPath([]),(ve=p.current)===null||ve===void 0||ve.setFieldsValue({workDir:{value:"",useDefault:!0,default:N.data.info.Config.WorkingDir},user:{value:"",useDefault:!0,default:N.data.info.Config.User},command:{value:"",useDefault:!0,default:N.data.info.Config.Cmd&&N.data.info.Config.Cmd.join(" ")},entrypoint:{value:"",useDefault:!0,default:N.data.info.Config.Entrypoint&&N.data.info.Config.Entrypoint.join(" ")}}));case 10:case"end":return r.stop()}},M)}));return function(E){return P.apply(this,arguments)}}();return(0,o.useEffect)(function(){d.fromImageId&&U(d.fromImageId)},[d.fromImageId]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(D.Z,{open:v,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return c(!1)},children:(0,e.jsx)(V.Z,{scroll:{x:"max-content"},columns:[{title:"Id",dataIndex:"Id",search:!1,width:200,render:function(M,E,L,Y,le){return(0,e.jsx)(q.Z,{content:E.Id})}},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",width:200,render:function(M,E,L,Y){return(0,e.jsx)(q.Z,{content:E.RepoTags[0]})}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(M,E,L,Y){return(0,e.jsx)("div",{children:(0,Fe.ZM)(E.Created*1e3)},E.Id)},sorter:function(M,E){return M.Created-E.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:80,render:function(M,E,L,Y){return(0,e.jsxs)($.Z,{split:(0,e.jsx)(ie.Z,{type:"vertical"}),children:[(0,e.jsx)(k.Z.Link,{onClick:g()(i()().mark(function le(){return i()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.abrupt("return",U(E.RepoTags[0]));case 1:case"end":return se.stop()}},le)})),children:(0,e.jsx)(re.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(W.Z,{})})},"addImage"),(0,e.jsx)(k.Z.Link,{onClick:g()(i()().mark(function le(){var N;return i()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:E.RepoTags[0]&&((N=h.current)===null||N===void 0||N.setImageName(E.RepoTags[0]));case 1:case"end":return fe.stop()}},le)})),children:(0,e.jsx)(re.Z,{title:"\u66F4\u65B0\u955C\u50CF",children:(0,e.jsx)(S.Z,{})})},"updateImage")]})}}],request:function(){var P=g()(i()().mark(function M(E,L,Y){var le,N,se,fe,ee;return i()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return d.redeploy&&(N=(le=p.current)===null||le===void 0?void 0:le.getFieldValue("imageName"),E.tag=N?N.split(":")[0]:E.tag),ve.next=3,(0,a.KG)({tag:E.tag});case 3:return se=ve.sent,fe=0,ee=[],se.data.list&&(ee=se.data.list.flatMap(function(he){return he.RepoTags.map(function(xe){return{Key:fe++,Id:he.Id,Created:he.Created,RepoTags:[xe]}})})),ve.abrupt("return",{data:ee,success:!0,total:ee.length});case 8:case"end":return ve.stop()}},M)}));return function(M,E,L){return P.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(oe.Z,{onClick:function(){c(!1)},buttonType:"primary",ref:h,onFinish:function(E){U(E)}},"remote")]},formRef:_,rowKey:"Key",pagination:{pageSize:5}})},"imageTableList"),(0,e.jsxs)(J.Z,{children:[(0,e.jsx)(B.Z,{span:14,children:(0,e.jsx)(s.Z,{label:"\u955C\u50CF",tooltip:d.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0})}),(0,e.jsx)(B.Z,{children:(0,e.jsx)(y.Z,{label:" ",children:(0,e.jsxs)($.Z.Compact,{children:[(0,e.jsx)(b.ZP,{type:"primary",onClick:function(){return c(!0)},children:d.redeploy?"\u66F4\u6362\u955C\u50CF":"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(w.Z,{name:["imageName"],children:function(M){var E=M.imageName;return d.redeploy?(0,e.jsx)(_e.Z,{image:[E],trigger:(0,e.jsx)(re.Z,{title:"\u91CD\u65B0\u62C9\u53D6\u5F53\u524D\u955C\u50CF",children:(0,e.jsx)(b.ZP,{icon:(0,e.jsx)(Q.Z,{}),children:"\u5347\u7EA7\u5F53\u524D\u955C\u50CF"})})}):(0,e.jsx)(oe.Z,{onClick:function(){c(!1)},ref:h,onFinish:function(Y){U(Y)}},"remote")}})]})})})]})]})}var je=n(60335),Te=n(51042),me=n(24739),Ye=n(63434),be=n(17186),ze=n(27496),Xe=n(66309);function Je(d){return(0,e.jsx)(V.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"names",render:function(x,v,c,_){return(0,e.jsx)($.Z,{direction:"vertical",style:{textAlign:"left"},children:v==null?void 0:v.Names.map(function(l){return l})},v.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(x,v,c,_){return v!=null&&v.Ports?(0,e.jsx)($.Z,{direction:"vertical",style:{textAlign:"left"},children:v==null?void 0:v.Ports.map(function(l,p){return(0,e.jsx)(Xe.Z,{color:"#2db7f5",icon:l.PublicPort?(0,e.jsx)(ze.Z,{}):"",children:"".concat(l.PublicPort?l.IP+":"+l.PublicPort+"->":"").concat(l.PrivatePort,"/").concat(l.Type)},p)})},v.Id):(0,e.jsx)(e.Fragment,{})}},{title:"\u8FD0\u884C\u5BB9\u5668",search:!1,render:function(x,v,c,_){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(k.Z.Text,{ellipsis:{tooltip:v.Image},children:v.Image},v.Id)})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(x,v,c,_){return[(0,e.jsx)(b.ZP,{type:"link",onClick:function(){(0,je.jV)({md5:v.Id}).then(function(p){return d.onSelect&&d.onSelect(p.data.info),!0})},children:(0,e.jsx)(W.Z,{})},v.Id)]}}],rowKey:"Id",request:function(){var O=g()(i()().mark(function x(v,c,_){return i()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",new Promise(function(T,A){(0,je.IE)({tag:v.names}).then(function(m){var h={data:m.data.list,success:!0,total:m.data.list.length};T(h)})}));case 1:case"end":return p.stop()}},x)}));return function(x,v,c){return O.apply(this,arguments)}}(),pagination:{pageSize:5}})}var Qe=(0,o.forwardRef)(function(d,O){var x=(0,o.useState)(!1),v=R()(x,2),c=v[0],_=v[1],l=(0,o.useRef)(),p=function(m){var h=(0,o.useState)([]),U=R()(h,2),P=U[0],M=U[1];return(0,o.useEffect)(function(){(0,je.jV)({md5:m.name}).then(function(E){var L;return M((L=E.data.info.Config.Env)!==null&&L!==void 0?L:[]),!0})},[]),(0,e.jsxs)(I.Z,{bordered:!0,extra:m.action,style:{marginBottom:10},children:[(0,e.jsx)(I.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(me.UW,{children:[(0,e.jsx)(s.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(s.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(Ye.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(I.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)($.Z,{direction:"vertical",children:P&&P.map(function(E,L){return(0,e.jsx)(k.Z.Text,{copyable:{icon:(0,e.jsx)(Te.Z,{}),onCopy:function(){var le=E.split("=");d.onAddEnv(le[0],le[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:E},style:{width:300},children:E},L)})},"linkEnv")})]})},T=function(m){var h,U,P=!1,M=(h=(U=l.current)===null||U===void 0?void 0:U.getList())!==null&&h!==void 0?h:[];if(M.map(function(L){L.name==m.name&&(P=!0)}),!P){var E;(E=l.current)===null||E===void 0||E.add(m)}};return(0,o.useImperativeHandle)(O,function(){return{setDefaultLink:function(m){m&&m.map(function(h){h.name!=""&&T(h)})}}}),(0,e.jsxs)(I.Z,{title:"\u5173\u8054\u5BB9\u5668",headerBordered:!0,children:[(0,e.jsx)(be.u,{name:"links",actionRef:l,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(m,h){return _(!0),!1}},copyIconProps:!1,min:0,itemRender:function(m,h){return(0,e.jsx)(p,{action:m.action,name:h.record.name})}}),(0,e.jsx)(D.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:1024,footer:!1,open:c,onCancel:function(){return _(!1)},children:(0,e.jsx)(Je,{onSelect:function(m){T({name:m.Name,alise:m.Config.Hostname,volume:!1}),_(!1)}})})]})}),qe=Qe,en=n(91058),Re=n(64317),nn=(0,o.forwardRef)(function(d,O){var x=(0,o.useRef)();return(0,o.useImperativeHandle)(O,function(){return{setDefaultDestPath:function(c){var _,l,p=(_=(l=x.current)===null||l===void 0?void 0:l.getList())!==null&&_!==void 0?_:[];c.length!=0&&c.filter(function(T){return T!=""}).map(function(T){var A=!1;if(p.map(function(h){if(h.dest==T){A=!0;return}}),!A){var m;(m=x.current)===null||m===void 0||m.add({dest:T,permission:"write",inImage:!0})}})},addUserVolumeItem:function(c,_){var l,p=(l=x.current)===null||l===void 0?void 0:l.getList(),T=!1;if(p==null||p.map(function(m){if(m.dest==_){T=!0;return}}),!T){var A;(A=x.current)===null||A===void 0||A.add({host:c,dest:_})}}}}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(I.Z,{title:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u6216\u662F\u5B58\u50A8\u5377",tooltip:"\u6302\u8F7D\u53EF\u4EE5\u662F\u5BBF\u4E3B\u673A\u7684\u76EE\u5F55\u6216\u662F\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u5B58\u50A8\u5377\u540D\uFF08\u81EA\u52A8\u65B0\u5EFA\uFF09\u3002",headerBordered:!0,direction:"column",children:(0,e.jsx)(be.u,{actionRef:x,name:"volumes",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u6620\u5C04\u76EE\u5F55"},copyIconProps:!1,min:0,children:function(c,_,l){var p=l.getCurrentRowData();return(0,e.jsxs)(me.UW,{children:[(0,e.jsxs)($.Z.Compact,{children:[(0,e.jsx)(s.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u3001\u76EE\u5F55\u6216\u5B58\u50A8\u5377",name:"host",width:d.showInDrawer?"sm":"md"}),(0,e.jsx)(Re.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(s.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:d.showInDrawer?"sm":"md",required:!0,rules:[{required:!0}],disabled:d.disabledUserVolumeDest||p.inImage})]})}})})})}),tn=nn,un=n(2831),Ee=n(52688),We=n(86125),an=n(44349);function rn(d){var O,x=(0,o.useState)(),v=R()(x,2),c=v[0],_=v[1];return(0,o.useEffect)(function(){(0,un.aF)().then(function(l){return _(l.data.info)})},[]),(0,e.jsxs)(I.Z,{children:[(0,e.jsx)(s.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:"64M",tooltip:"0 \u4E3A\u4F7F\u7528\u9ED8\u8BA464M"}),(0,e.jsx)(y.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(We.Z,{step:.1,max:c==null?void 0:c.NCPU,marks:{0:"0",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(y.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(We.Z,{step:256,max:Math.round(((O=c==null?void 0:c.MemTotal)!==null&&O!==void 0?O:0)/1024/1024),marks:{0:"0",1024:"1G",2048:"2G",3072:"3G",4096:"4G"}})}),(0,e.jsx)(Re.Z,{label:"\u65E5\u5FD7\u7C7B\u578B",name:["log","driver"],tooltip:"\u9ED8\u8BA4\u4F7F\u7528 json-file \u9A71\u52A8\u7531 docker \u7EDF\u4E00\u7BA1\u7406\u3002\u91C7\u7528 journal \u65F6\u65E5\u5FD7\u5C06\u6765\u5BBF\u4E3B\u673A\u7BA1\u7406",initialValue:"json-file",valueEnum:{"json-file":"json-file",journald:"journal (\u5BBF\u4E3B\u9700\u8981\u5B89\u88C5journal\u670D\u52A1)"}}),(0,e.jsx)(w.Z,{name:["log"],children:function(p){var T=p.log;if(T.driver=="json-file")return(0,e.jsxs)(me.UW,{children:[(0,e.jsx)(s.Z,{label:"\u65E5\u5FD7\u5207\u5272\u5C3A\u5BF8",name:["log","maxSize"],placeholder:"\u4F8B\u5982\uFF1A10k,5M",tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u5207\u5272\u65E5\u5FD7"}),(0,e.jsx)(s.Z,{tooltip:"\u9ED8\u8BA4 Docker \u5E76\u4E0D\u4F1A\u81EA\u52A8\u6E05\u7406\u65E5\u5FD7\u6587\u4EF6",label:"\u4FDD\u7559\u65E5\u5FD7\u6587\u4EF6\u6570",name:["log","maxFile"],placeholder:"\u4F8B\u5982\uFF1A10"})]})}}),(0,e.jsx)(an.Z,{name:"device",label:"\u5173\u8054\u8BBE\u5907",hideCopyButton:!0,showAddButton:!0,items:[{label:"\u5BBF\u4E3B\u673A\u8DEF\u5F84",name:"host",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"},{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md",placeholder:"\u4F8B\u5982\uFF1A/dev/tty0"}]}),(0,e.jsxs)(J.Z,{children:[(0,e.jsx)(B.Z,{span:4,children:(0,e.jsx)(Ee.Z,{label:"\u4F7F\u7528 Gpu",name:["gpus","enable"]})}),(0,e.jsx)(B.Z,{span:20,children:(0,e.jsx)(w.Z,{name:["gpus"],children:function(p){var T=p.gpus;if(T&&T.enable)return(0,e.jsx)(Re.Z,{mode:"tags",label:"\u8BBE\u5907\u5217\u8868",name:["gpus","device"],placeholder:"\u914D\u7F6E\u4F7F\u7528\u8BBE\u5907id\u6216\u662Fuuid\uFF0C\u4E0D\u586B\u6240\u4E3A\u6240\u6709\u8BBE\u5907"})}})})]}),(0,e.jsx)(w.Z,{name:["gpus"],children:function(p){var T=p.gpus;if(T&&T.enable)return(0,e.jsx)(Re.Z,{label:"\u8BA1\u7B97\u80FD\u529B",name:["gpus","capabilities"],mode:"multiple",fieldProps:{allowClear:!0},options:[{label:"compute - \u8BA1\u7B97\u80FD\u529B",value:"compute"},{label:"compat32 - \u517C\u5BB932\u4F4D",value:"compat32"},{label:"graphics - \u56FE\u5F62\u5904\u7406\u80FD\u529B",value:"graphics"},{label:"utility - \u76D1\u63A7\u548C\u7BA1\u7406\u80FD\u529B",value:"utility"},{label:"video - \u89C6\u9891\u5904\u7406\u80FD\u529B",value:"video"},{label:"display - \u663E\u793A\u56FE\u5F62\u754C\u9762\u80FD\u529B",value:"display"}]})}})]})}function ln(){return(0,e.jsx)(I.Z,{title:"\u5BB9\u5668\u6807\u7B7E",children:(0,e.jsx)(be.u,{name:"label",label:"",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(me.UW,{children:[(0,e.jsx)(s.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(s.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var on=n(44771),sn=n(86615),Pn="default",In="user";function dn(d){return(0,e.jsx)(y.Z,{label:d.label,tooltip:d.tooltip,children:(0,e.jsxs)($.Z.Compact,{block:!0,children:[(0,e.jsx)(sn.Z.Group,{radioType:"button",name:[d.name,"useDefault"],options:[{label:"\u4F7F\u7528\u9ED8\u8BA4",value:!0},{label:"\u81EA\u5B9A\u4E49",value:!1}]}),(0,e.jsx)(w.Z,{name:[d.name],children:function(x){return x[d.name]&&x[d.name].useDefault?(0,e.jsx)(s.Z,{name:[d.name,"default"],disabled:!0,placeholder:"\u672A\u8BBE\u7F6E"}):(0,e.jsx)(s.Z,{name:[d.name,"value"]})}})]})})}var we=dn,Me=n(24963);function cn(){var d=(0,o.useContext)(Me.Z),O=d.notice,x=d.lang;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(I.Z,{children:[(0,e.jsx)(on.Z,{label:"\u91CD\u542F\u7B56\u7565"}),(0,e.jsxs)(me.UW,{children:[(0,e.jsx)(Ee.Z,{fieldProps:{onChange:function(c){c&&O.warning(x("app.create.privilegedNotice"))}},name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(Ee.Z,{name:"autoRemove",label:"\u505C\u6B62\u540E\u81EA\u52A8\u5220\u9664",initialValue:!1}),(0,e.jsx)(Ee.Z,{fieldProps:{onChange:function(c){c&&O.warning(x("app.create.hostPidNotice"))}},name:"hostPid",label:"\u5173\u8054\u5BBF\u4E3B\u673APid",initialValue:!1})]}),(0,e.jsx)(we,{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55",name:"workDir"}),(0,e.jsx)(we,{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237",name:"user"}),(0,e.jsx)(we,{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command"}),(0,e.jsx)(we,{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4",name:"entrypoint"})]})})}var mn=n(91845),Ke=n(62597),He=n(63713),fn=n(4798),vn=(0,o.forwardRef)(function(d,O){var x=(0,o.useState)(""),v=R()(x,2),c=v[0],_=v[1],l=(0,o.useRef)(),p=(0,o.useContext)(t.Z),T=p.createFormRef;return(0,o.useImperativeHandle)(O,function(){return{setExposePort:function(m){if(m){var h,U,P=(h=(U=l.current)===null||U===void 0?void 0:U.getList())!==null&&h!==void 0?h:[];Object.keys(m).map(function(M){var E=!1;if(P.map(function(Y){Y.dest==M&&(E=!0)}),!E){var L;(L=l.current)===null||L===void 0||L.add({host:"",dest:M})}})}},setHostname:function(m){_(m)},addPortItem:function(m,h){var U,P=(U=l.current)===null||U===void 0?void 0:U.getList(),M=!1;if(P==null||P.map(function(L){if(L.host==m){M=!0;return}}),!M){var E;(E=l.current)===null||E===void 0||E.add({host:String(m),dest:String(h)})}}}}),(0,e.jsx)(I.Z,{title:"\u7ED1\u5B9A\u7AEF\u53E3",tooltip:"\u8BBF\u95EE\u7AEF\u53E3\u7559\u7A7A\u65F6\u968F\u673A\u751F\u6210\u7AEF\u53E3\uFF0C\u5168\u90E8\u5220\u9664\u5219\u8868\u793A\u4E0D\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,extra:(0,e.jsxs)($.Z,{children:[d.showBindHost&&(0,e.jsx)(Ee.Z,{name:"useHostNetwork",fieldProps:{checkedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",unCheckedChildren:"\u7ED1\u5B9AHost\u7F51\u7EDC",onChange:function(m){if(m){var h;(h=T.current)===null||h===void 0||h.setFieldsValue({bindIpV6:!1,publishAllPorts:!1})}}}}),d.showBindIpV6&&(0,e.jsx)(w.Z,{name:["siteName","useHostNetwork"],children:function(m){var h=m.useHostNetwork;return(0,e.jsx)(Ee.Z,{name:"publishAllPorts",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3",unCheckedChildren:"\u7ED1\u5B9A\u5168\u90E8\u7AEF\u53E3"},disabled:h},"publishAllPorts")}}),d.showBindIpV6&&(0,e.jsx)(w.Z,{name:["siteName","useHostNetwork"],children:function(m){var h=m.useHostNetwork;return(0,e.jsx)(Ee.Z,{name:"bindIpV6",fieldProps:{checkedChildren:"IpV6",unCheckedChildren:"IpV6"},disabled:h},"bindIpV6")}})]}),children:(0,e.jsx)(w.Z,{name:["useHostNetwork","bindIpV6","publishAllPorts"],children:function(m){var h=m.useHostNetwork,U=m.bindIpV6,P=m.publishAllPorts;if(!h&&!P)return(0,e.jsx)(be.u,{name:"ports",actionRef:l,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(me.UW,{children:[(0,e.jsx)(s.Z,{width:d.showInDrawer?"sm":"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u6DFB\u52A0\u8BBF\u95EE\u7AEF\u53E3\u6216\u662F\u521B\u5EFA\u5B8C\u6210\u540E\u5BF9\u5BB9\u5668\u7ED1\u5B9A\u57DF\u540D",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3\uFF0C\u7ED1\u5B9AIpV6\u5FC5\u586B",required:U,rules:[{required:U}]}),(0,e.jsx)(s.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:d.showInDrawer?"sm":"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3",required:!0,rules:[{required:!0}]})]})})}})})}),hn=vn;function Be(d){return(0,e.jsx)("div",{style:{display:d.show?"block":"none"},children:d.children})}function pn(){var d=(0,o.useRef)(),O=function(c){var _,l,p=!1,T=(_=(l=d.current)===null||l===void 0?void 0:l.getList())!==null&&_!==void 0?_:[];if(T.map(function(m){m.name==c.name&&(p=!0)}),!p){var A;(A=d.current)===null||A===void 0||A.add(c)}},x=function(c){var _,l,p=!1,T=(_=(l=d.current)===null||l===void 0?void 0:l.getList())!==null&&_!==void 0?_:[];T.map(function(A,m){if(A.name==c){var h;(h=d.current)===null||h===void 0||h.remove(m)}})};return(0,e.jsx)(I.Z,{title:"\u5173\u8054\u5BBF\u4E3B\u7F51\u7EDC\u4E3B\u673A",tooltip:"\u5BB9\u5668\u5185\u5982\u679C\u9700\u8981\u8BF7\u6C42\u5BBF\u4E3B\u673A\u6240\u5728\u7684\u7F51\u7EDC\u4E2D\u7684\u4E3B\u673A\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6B64\u914D\u7F6E\u5C06Ip\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D",extra:(0,e.jsx)($.Z,{children:(0,e.jsx)(Ee.Z,{name:"enableBindHost",fieldProps:{checkedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",unCheckedChildren:"\u7ED1\u5B9A\u5BBF\u4E3B\u673AIp",onChange:function(c){c?O({name:"host.dpanel.local",value:"host-gateway"}):x("host.dpanel.local")}}})}),children:(0,e.jsx)(be.u,{name:"extraHosts",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BBF\u4E3B\u673A\u7F51\u7EDC\u5173\u8054"},actionRef:d,copyIconProps:!1,min:0,children:(0,e.jsxs)(me.UW,{children:[(0,e.jsx)(s.Z,{width:"md",name:"name",label:"Hostname",placeholder:""}),(0,e.jsx)(s.Z,{width:"md",name:"value",label:"ip",placeholder:""})]})})})}var Se=n(90672),En=(0,o.forwardRef)(function(d,O){return(0,o.useImperativeHandle)(O,function(){return{}}),(0,e.jsxs)(I.Z,{title:"\u7F51\u7EDC\u914D\u7F6E",children:[(0,e.jsxs)(me.UW,{children:[(0,e.jsx)(s.Z,{label:"\u914D\u7F6E ipV4 \u5730\u5740",name:["ipV4","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u5730\u5740\uFF0C\u4F8B\u5982 192.168.1.5",placeholder:"192.168.1.5"}),(0,e.jsx)(w.Z,{name:["ipV4"],children:function(v){var c=v.ipV4;return(0,e.jsx)(s.Z,{label:"\u914D\u7F6E ipV4 \u5B50\u7F51",name:["ipV4","subnet"],width:"md",required:c&&c.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 192.168.1.0/24",placeholder:"192.168.1.0/24",rules:[{required:c&&c.address}]})}}),(0,e.jsx)(s.Z,{label:"\u914D\u7F6E ipV4 \u7F51\u5173",name:["ipV4","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 192.168.1.1",placeholder:"192.168.1.1"}),(0,e.jsx)(Ee.Z,{label:"\u81EA\u5B9A\u4E49ipV6",name:"enableIpV6Address"})]}),(0,e.jsx)(w.Z,{name:["enableIpV6Address"],children:function(v){var c=v.enableIpV6Address;if(c)return(0,e.jsxs)(me.UW,{children:[(0,e.jsx)(s.Z,{label:"\u914D\u7F6E ipV6 \u5730\u5740",name:["ipV6","address"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u5730\u5740\uFF0C\u4F8B\u5982 2001:db8::5",placeholder:"2001:db8::5"}),(0,e.jsx)(w.Z,{name:["ipV6"],children:function(l){var p=l.ipV6;return(0,e.jsx)(s.Z,{label:"\u914D\u7F6E ipV6 \u5B50\u7F51",name:["ipV6","subnet"],width:"md",required:p&&p.address,tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipv4\u6240\u5728\u7684\u5B50\u7F51\uFF0C\u4F8B\u5982 2001:db8::/48",placeholder:"2001:db8::/48",rules:[{required:p&&p.address}]})}}),(0,e.jsx)(s.Z,{label:"\u914D\u7F6E ipV6 \u7F51\u5173",name:["ipV6","gateway"],width:"md",tooltip:"\u6307\u5B9A\u5BB9\u5668\u7684ipV6\u7684\u7F51\u5173\uFF0C\u4F8B\u5982 2001:db8::1",placeholder:"2001:db8::1"})]})}}),(0,e.jsx)(Se.Z,{label:"DNS\u914D\u7F6E",name:"dns",placeholder:"\u8BF7\u6307\u5B9Adns\u5730\u5740\uFF0C\u4F8B\u5982\uFF1A8.8.8.8\uFF0C\u4E00\u884C\u6DFB\u4E00\u6761dns\u5730\u5740"})]})}),gn=En,Le=n(31199),Cn=n(86250);function Fn(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.Z,{title:"\u9644\u52A0\u6267\u884C\u811A\u672C",headerBordered:!0,subTitle:"",children:(0,e.jsx)(Se.Z,{label:"\u5BB9\u5668\u521B\u5EFA\u540E\u6267\u884C\u811A\u672C",name:["hook","containerCreate"],placeholder:"\u5BB9\u5668\u5728\u521B\u5EFA\u540E\u6267\u884C\u7684\u811A\u672C\uFF0C\u6B64\u811A\u672C\u5E76\u4E0D\u4F1A\u5F71\u54CD entrypoint \u53CA command\u3002\u4F8B\u5982\uFF1Als -al && touch abc.txt && apt update"})}),(0,e.jsxs)(I.Z,{title:"\u5065\u5EB7\u68C0\u67E5",headerBordered:!0,children:[(0,e.jsxs)(Cn.Z,{gap:20,justify:"start",children:[(0,e.jsx)(Le.Z,{label:"\u91CD\u590D\u95F4\u9694\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","interval"],initialValue:30}),(0,e.jsx)(Le.Z,{label:"\u8D85\u65F6\u5931\u8D25\u65F6\u95F4\uFF08\u79D2\uFF09",name:["healthcheck","timeout"],initialValue:10}),(0,e.jsx)(Le.Z,{label:"\u5931\u8D25\u91CD\u590D\u6B21\u6570",name:["healthcheck","retries"],initialValue:3}),(0,e.jsx)(Re.Z,{width:"sm",label:"\u811A\u672C\u6267\u884C\u73AF\u5883",initialValue:"CMD",name:["healthcheck","shellType"],valueEnum:{CMD:"\u5728 Docker \u73AF\u5883\u6267\u884C","CMD-SHELL":"\u5728\u5BB9\u5668\u5185\u6267\u884C"}})]}),(0,e.jsx)(Se.Z,{label:"\u6267\u884C\u811A\u672C",name:["healthcheck","cmd"],placeholder:"\u914D\u7F6E\u5BB9\u5668\u5065\u5EB7\u68C0\u67E5\u811A\u672C\uFF0C\u4F8B\u5982\uFF1Acurl -f http://localhost:8080/ || exit 1"})]})]})}var _n=n(74763),$e=n(2487),Bn=[{name:"ALL"},{name:"AUDIT_CONTROL"},{name:"AUDIT_WRITE",default:!0},{name:"BLOCK_SUSPEND"},{name:"CHOWN",default:!0},{name:"DAC_OVERRIDE",default:!0},{name:"DAC_READ_SEARCH"},{name:"FOWNER",default:!0},{name:"FSETID",default:!0},{name:"IPC_LOCK"},{name:"IPC_OWNER"},{name:"KILL",default:!0},{name:"LEASE"},{name:"LINUX_IMMUTABLE"},{name:"MAC_ADMIN"},{name:"MAC_OVERRIDE"},{name:"MKNOD",default:!0},{name:"NET_ADMIN"},{name:"NET_BIND_SERVICE",default:!0},{name:"NET_BROADCAST"},{name:"NET_RAW",default:!0},{name:"SETFCAP",default:!0},{name:"SETGID",default:!0},{name:"SETPCAP",default:!0},{name:"SETUID",default:!0},{name:"SYSLOG"},{name:"SYS_ADMIN"},{name:"SYS_BOOT"},{name:"SYS_CHROOT",default:!0},{name:"SYS_MODULE"},{name:"SYS_NICE"},{name:"SYS_PACCT"},{name:"SYS_PTRACE"},{name:"SYS_RAWIO"},{name:"SYS_RESOURCE"},{name:"SYS_TIME"},{name:"SYS_TTY_CONFIG"}],jn=(0,o.forwardRef)(function(d,O){var x=(0,o.useContext)(Me.Z),v=x.lang,c=(0,o.useState)(null),_=R()(c,2),l=_[0],p=_[1],T=(0,o.useContext)(t.Z),A=T.createFormRef;return(0,o.useImperativeHandle)(O,function(){return{}}),(0,e.jsx)(I.Z,{children:(0,e.jsx)($e.Z,{grid:{gutter:10,xs:3,sm:3,md:4,lg:4,xl:4,xxl:6},dataSource:Bn,renderItem:function(h,U){var P;return(0,e.jsx)($e.Z.Item,{children:(0,e.jsx)(Ee.Z,{fieldProps:{onChange:function(E){h.name=="ALL"&&p(E)}},disabled:h.name!="ALL"&&((0,_n.k)(l)?(P=A.current)===null||P===void 0?void 0:P.getFieldValue(["capAdd","ALL"]):l),initialValue:h.default,name:["capAdd",h.name],tooltip:v("app.create.cap."+h.name.toLocaleLowerCase()),label:h.name})},U)}})})}),xn=jn,Ze="update",Ge="copy",ke="new";function Dn(){var d,O,x,v=(0,o.useContext)(Me.Z),c=v.loading,_=(0,o.useContext)(t.Z),l=_.createFormRef,p=_.volumeListRef,T=_.domainRef,A=_.createEnvRef,m=_.createLinkRef,h=(0,o.useState)(ke),U=R()(h,2),P=U[0],M=U[1],E=(0,He.useSearchParams)(),L=R()(E,2),Y=L[0],le=L[1],N=(0,He.useNavigate)(),se=(0,o.useState)("basic"),fe=R()(se,2),ee=fe[0],Ae=fe[1],ve=parseInt((d=Y.get("id"))!==null&&d!==void 0?d:""),he=(O=Y.get("containerId"))!==null&&O!==void 0?O:"",xe=(x=Y.get("imageId"))!==null&&x!==void 0?x:"";return(0,o.useEffect)(function(){if(he||ve)c.show(),(0,Ke.iE)({md5:he,id:ve}).then(function(){var ne=g()(i()().mark(function r(u){var de,pe,K,De,ge,Oe,Ue,Ve,Ne;return i()().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(K={info:{},layer:[]},!u.data.env.imageName){ye.next=6;break}return ye.next=4,(0,F.YU)({md5:u.data.env.imageName});case 4:De=ye.sent,K=De.data;case 6:Y.get("op")==Ge?M(Ge):M(Ze),u.data.env.network&&u.data.env.network.map(function(H){return!H.alise&&H.name!="bridge"&&(H.alise=[u.data.siteName+".pod.dpanel.local"]),H}),u.data.env.ports&&u.data.env.ports.map(function(H){return H.host=="0"&&(H.host=""),H}),ge=u.data.env.bindIpV6,u.data.containerInfo.Info&&u.data.containerInfo.Info.NetworkSettings.Networks&&Object.keys(u.data.containerInfo.Info.NetworkSettings.Networks).map(function(H){u.data.env.network&&(u.data.env.network=u.data.env.network.map(function(Pe){return H==Pe.name&&(Pe.subnet=u.data.containerInfo.Info.NetworkSettings.Networks[H].IPAddress+"/"+u.data.containerInfo.Info.NetworkSettings.Networks[H].IPPrefixLen),Pe})),u.data.containerInfo.Info.NetworkSettings.Networks[H].IPv6Gateway!=""&&(ge=!0)}),u.data.env.extraHosts&&u.data.env.extraHosts.map(function(H){if(H.value=="host-gateway"){var Pe;(Pe=l.current)===null||Pe===void 0||Pe.setFieldValue("enableBindHost",!0)}}),Oe=u.data.env.ports,u.data.env.ports&&(Oe=u.data.env.ports.map(function(H){return H.host=(H.hostIp?H.hostIp+":":"")+H.host,H})),(de=l.current)===null||de===void 0||de.setFieldsValue({imageName:u.data.env.imageName,privileged:u.data.env.privileged,bindIpV6:u.data.env.useHostNetwork?!1:ge,useHostNetwork:u.data.env.useHostNetwork,publishAllPorts:u.data.env.useHostNetwork?!1:u.data.env.publishAllPorts,workDir:{value:u.data.env.workDir,useDefault:!u.data.env.workDir,default:K&&K.info.Config&&K.info.Config.WorkingDir},user:{value:u.data.env.user,useDefault:!u.data.env.user,default:K&&K.info.Config&&K.info.Config.User},command:{value:u.data.env.command,useDefault:!u.data.env.command,default:K&&K.info.Config&&K.info.Config.Cmd&&K.info.Config.Cmd.join(" ")},entrypoint:{value:u.data.env.entrypoint,useDefault:!u.data.env.entrypoint,default:K&&K.info.Config&&K.info.Config.Entrypoint&&K.info.Config.Entrypoint.join(" ")},shmsize:(pe=u.data.env.shmsize)!==null&&pe!==void 0?pe:"64M",cpus:u.data.env.cpus,memory:u.data.env.memory,environment:u.data.env.environment,label:u.data.env.label,volumes:u.data.env.volumes,ports:Oe,links:u.data.env.links,network:u.data.env.network,restart:u.data.env.restart,extraHosts:u.data.env.extraHosts,autoRemove:u.data.env.autoRemove,log:u.data.env.log,dns:u.data.env.dns&&u.data.env.dns.join(`
`),ipV4:u.data.env.ipV4,ipV6:u.data.env.ipV6,gpus:u.data.env.gpus,device:u.data.env.device,hook:u.data.env.hook,hostPid:u.data.env.hostPid,capAdd:u.data.env.capAdd&&Object.fromEntries(u.data.env.capAdd.map(function(H){return[H,!0]}))}),u.data.env.ipV6&&((Ue=l.current)===null||Ue===void 0||Ue.setFieldValue("enableIpV6Address",!0)),u.data.env.healthcheck&&u.data.env.healthcheck.cmd&&u.data.env.healthcheck.cmd!=""&&((Ve=l.current)===null||Ve===void 0||Ve.setFieldsValue({healthcheck:u.data.env.healthcheck})),Y.get("op")==Ze&&((Ne=l.current)===null||Ne===void 0||Ne.setFieldsValue({siteTitle:u.data.siteTitle,siteName:u.data.siteName}));case 18:case"end":return ye.stop()}},r)}));return function(r){return ne.apply(this,arguments)}}()).finally(function(){c.destroy()});else{var ce;M(ke),(ce=l.current)===null||ce===void 0||ce.resetFields()}},[Y]),(0,e.jsx)(Z._z,{children:(0,e.jsx)(I.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(j.A,{submitter:{render:function(ne,r){return(0,e.jsx)(G.S,{children:r})}},formRef:l,onFinish:function(){var ce=g()(i()().mark(function ne(r){var u,de,pe,K;return i()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return K={siteTitle:r.siteTitle,siteName:r.siteName,imageName:r.imageName,environment:r.environment,links:r.links,ports:r.ports,volumes:r.volumes,network:r.network,privileged:(u=r.privileged)!==null&&u!==void 0?u:!1,autoRemove:(de=r.autoRemove)!==null&&de!==void 0?de:!1,restart:r.restart,cpus:r.cpus,memory:r.memory,shmsize:(pe=r.shmsize)!==null&&pe!==void 0?pe:0,workDir:r.workDir&&!r.workDir.useDefault?r.workDir.value:"",user:r.user&&!r.user.useDefault?r.user.value:"",command:r.command&&!r.command.useDefault?r.command.value:"",entrypoint:r.entrypoint&&!r.entrypoint.useDefault?r.entrypoint.value:"",useHostNetwork:r.useHostNetwork,bindIpV6:r.bindIpV6,log:r.log,dns:r.dns&&r.dns!=""?r.dns.split(`
`):[],label:r.label,publishAllPorts:r.publishAllPorts,extraHosts:r.extraHosts,ipV4:r.ipV4,ipV6:r.ipV6,device:r.device,gpus:r.gpus,hook:r.hook,hostPid:r.hostPid,capAdd:r.capAdd?Object.keys(r.capAdd).map(function(Oe){return Oe}):[]},r.healthcheck&&r.healthcheck.cmd&&r.healthcheck.cmd!=""&&(K.healthcheck=r.healthcheck),he&&P==Ze&&(K.containerId=he),ge.next=5,(0,Ke.$G)(K);case 5:return N("/app/list"),ge.abrupt("return",!0);case 7:case"end":return ge.stop()}},ne)}));return function(ne){return ce.apply(this,arguments)}}(),children:[(0,e.jsxs)(I.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(s.Z,{name:"siteTitle",label:"\u5BB9\u5668\u63CF\u8FF0",fieldProps:{onChange:function(ne){var r="";if(ne.target.value&&P!=Ze){var u,de=(0,mn.N9)(ne.target.value.trim(),{toneType:"none",type:"array"});r=de.join(""),(u=l.current)===null||u===void 0||u.setFieldValue("siteName",r)}}},placeholder:"\u8BF7\u8F93\u5165\u5BB9\u5668\u63CF\u8FF0\u540D\u79F0"}),(0,e.jsx)(s.Z,{name:"siteName",label:"\u5BB9\u5668\u6807\u8BC6",tooltip:"\u5BB9\u5668\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u5BB9\u5668\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:P==Ze,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u5BB9\u5668\u6807\u8BC6\u540D\u79F0"}),(0,e.jsx)(Ie,{redeploy:P!=ke,fromImageId:xe})]}),(0,e.jsx)(ae.Z,{offsetTop:50,children:(0,e.jsx)(I.Z,{style:{marginBottom:-20},children:(0,e.jsx)(C.Z,{activeKey:ee,onChange:function(ne){Ae(ne),window.scrollTo(0,450)},items:[{label:"\u57FA\u672C\u914D\u7F6E",key:"basic"},{label:"\u5173\u8054\u914D\u7F6E",key:"link"},{label:"\u5B58\u50A8\u914D\u7F6E",key:"storage"},{label:"\u8FD0\u884C\u914D\u7F6E",key:"run-command"},{label:"\u8D44\u6E90\u914D\u7F6E",key:"resource"},{label:"Hook",key:"hook"},{label:"\u80FD\u529B\u914D\u7F6E",key:"cap"},{label:"\u5176\u5B83",key:"other"}]})})}),(0,e.jsxs)(Be,{show:ee=="basic",children:[(0,e.jsx)(hn,{ref:T,showBindHost:!0,showBindIpV6:!0}),(0,e.jsx)(en.Z,{showAddButton:!0,showImportButton:!0,showCodeMode:!0,label:"\u73AF\u5883\u53D8\u91CF",ref:A}),(0,e.jsx)(w.Z,{name:["siteName","useHostNetwork"],children:function(ne){var r=ne.siteName,u=ne.useHostNetwork;if(!u)return(0,e.jsx)(gn,{})}})]}),(0,e.jsx)(Be,{show:ee=="link",children:(0,e.jsx)(w.Z,{name:["siteName","useHostNetwork"],children:function(ne){var r=ne.siteName,u=ne.useHostNetwork;return u?(0,e.jsx)(X.Z,{showIcon:!0,description:"\u7ED1\u5B9A\u5230\u5BBF\u4E3B\u673A\u7F51\u7EDC\u65F6\uFF0C\u65E0\u6CD5\u901A\u8FC7 Docker \u5173\u8054\u5176\u5B83\u5BB9\u5668\u3002\u8BF7\u4F7F\u7528\u5BBF\u4E3B\u673A\u5185\u7F51IP\u6216\u662F127.0.0.1\u4E92\u8054\u5BB9\u5668\u66B4\u9732\u7AEF\u53E3\u3002"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qe,{onAddEnv:function(pe,K){var De;(De=A.current)===null||De===void 0||De.addEnvItem(pe,K)},ref:m}),(0,e.jsx)(fn.Z,{siteName:r}),(0,e.jsx)(pn,{})]})}})}),(0,e.jsx)(Be,{show:ee=="storage",children:(0,e.jsx)(tn,{showDefault:!0,ref:p})}),(0,e.jsx)(Be,{show:ee=="run-command",children:(0,e.jsx)(cn,{})}),(0,e.jsx)(Be,{show:ee=="resource",children:(0,e.jsx)(rn,{})}),(0,e.jsx)(Be,{show:ee=="hook",children:(0,e.jsx)(Fn,{})}),(0,e.jsx)(Be,{show:ee=="other",children:(0,e.jsx)(ln,{})}),(0,e.jsx)(Be,{show:ee=="cap",children:(0,e.jsx)(xn,{})})]},"form")})})}},97961:function(Ce,z,n){n.d(z,{GH:function(){return s},MF:function(){return X},_2:function(){return ae},fN:function(){return Z},ii:function(){return R},vC:function(){return j}});var te=n(15009),i=n.n(te),ue=n(99289),g=n.n(ue),f=n(63713),R=[{name:"linux/amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"linux/arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"linux/i386",arch:"386",search:[]},{name:"linux/arm/v6",arch:"arm",search:[]},{name:"linux/arm/v7",arch:"arm",search:[]},{name:"linux/arm/v8",arch:"arm64",search:[]},{name:"linux/ppc64le",arch:"ppc64le",search:[]},{name:"linux/riscv64",arch:"riscv64",search:[]}];function Z(t){return I.apply(this,arguments)}function I(){return I=g()(i()().mark(function t(V){return i()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,f.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:V}));case 1:case"end":return D.stop()}},t)})),I.apply(this,arguments)}function j(t){return G.apply(this,arguments)}function G(){return G=g()(i()().mark(function t(V){return i()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,f.request)("/api/app/image/import-by-container-tar",{method:"POST",data:V}));case 1:case"end":return D.stop()}},t)})),G.apply(this,arguments)}function s(t){return w.apply(this,arguments)}function w(){return w=g()(i()().mark(function t(V){return i()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,f.request)("/api/app/image/import-by-image-tar",{method:"POST",data:V}));case 1:case"end":return D.stop()}},t)})),w.apply(this,arguments)}function ae(t){return C.apply(this,arguments)}function C(){return C=g()(i()().mark(function t(V){return i()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,f.request)("/api/common/attach/delete",{method:"POST",data:V});case 2:return D.abrupt("return",D.sent);case 3:case"end":return D.stop()}},t)})),C.apply(this,arguments)}function X(){return o.apply(this,arguments)}function o(){return o=g()(i()().mark(function t(){return i()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,f.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return y.stop()}},t)})),o.apply(this,arguments)}},18148:function(Ce,z,n){n.d(z,{$q:function(){return C},Fj:function(){return ie},KG:function(){return R},KX:function(){return re},T8:function(){return w},Xn:function(){return G},ao:function(){return o},c5:function(){return D},c7:function(){return V}});var te=n(15009),i=n.n(te),ue=n(99289),g=n.n(ue),f=n(63713);function R(B){return Z.apply(this,arguments)}function Z(){return Z=g()(i()().mark(function B(b){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,f.request)("/api/app/image/get-list",{method:"POST",data:b}));case 1:case"end":return a.stop()}},B)})),Z.apply(this,arguments)}function I(B){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function B(b){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,request("/api/app/log/image-build",{method:"POST",data:b});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},B)})),j.apply(this,arguments)}function G(B){return s.apply(this,arguments)}function s(){return s=g()(i()().mark(function B(b){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,f.request)("/api/app/image/get-list-build",{method:"POST",data:b}));case 1:case"end":return a.stop()}},B)})),s.apply(this,arguments)}function w(B){return ae.apply(this,arguments)}function ae(){return ae=g()(i()().mark(function B(b){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,f.request)("/api/app/image/get-build-task",{method:"POST",data:b});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},B)})),ae.apply(this,arguments)}function C(B){return X.apply(this,arguments)}function X(){return X=g()(i()().mark(function B(b){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,f.request)("/api/app/image/delete-build-task",{method:"POST",data:b});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},B)})),X.apply(this,arguments)}function o(B){return t.apply(this,arguments)}function t(){return t=g()(i()().mark(function B(b){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,f.request)("/api/app/image/image-delete",{method:"POST",data:b});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},B)})),t.apply(this,arguments)}function V(){return y.apply(this,arguments)}function y(){return y=g()(i()().mark(function B(){return i()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,f.request)("/api/app/image/image-prune",{method:"POST"});case 2:return F.abrupt("return",F.sent);case 3:case"end":return F.stop()}},B)})),y.apply(this,arguments)}function D(){return $.apply(this,arguments)}function $(){return $=g()(i()().mark(function B(){return i()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,f.request)("/api/app/image/build-prune",{method:"POST"});case 2:return F.abrupt("return",F.sent);case 3:case"end":return F.stop()}},B)})),$.apply(this,arguments)}function ie(B){return k.apply(this,arguments)}function k(){return k=g()(i()().mark(function B(b){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,f.request)("/api/app/image/update-title",{method:"POST",data:b});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},B)})),k.apply(this,arguments)}function re(B){return J.apply(this,arguments)}function J(){return J=g()(i()().mark(function B(b){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,f.request)("/api/app/image/tag-sync",{method:"POST",data:b}));case 1:case"end":return a.stop()}},B)})),J.apply(this,arguments)}},5251:function(Ce,z,n){n.d(z,{FI:function(){return i},ZM:function(){return ue}});function te(g){return g.trim()}function i(g){var f="";g<.1*1024?f=g.toFixed(2)+"B":g<.1*1024*1024?f=(g/1024).toFixed(2)+"KB":g<1*1024*1024*1024?f=(g/(1024*1024)).toFixed(2)+"MB":f=(g/(1024*1024*1024)).toFixed(2)+"GB";var R=f+"",Z=R.indexOf("."),I=R.substring(Z+1,Z+3);return I=="00"?R.substring(0,Z)+R.substr(Z+3,2):f}function ue(g){if(g){var f=new Date(g),R=f.getFullYear()+"-",Z=(f.getMonth()+1<10?"0"+(f.getMonth()+1):f.getMonth()+1)+"-",I=(f.getDate()<10?"0"+f.getDate():f.getDate())+" ",j=(f.getHours()<10?"0"+f.getHours():f.getHours())+":",G=(f.getMinutes()<10?"0"+f.getMinutes():f.getMinutes())+":",s=f.getSeconds()<10?"0"+f.getSeconds():f.getSeconds();return R+Z+I+j+G+s}}}}]);
