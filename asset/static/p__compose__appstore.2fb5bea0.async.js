"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7499],{80821:function(te,A,t){t.d(A,{Z:function(){return O}});var B=t(5574),r=t.n(B),K=t(24963),d=t(86738),p=t(28036),$=t(83062),S=t(67294),Z=t(85893);function O(i){var C=(0,S.useState)(!1),W=r()(C,2),y=W[0],D=W[1],j=(0,S.useContext)(K.Z),x=j.lang,w=j.notice,u=j.message,m=function(){D(!0);var s=i.action();s instanceof Promise?s.then(function(L){if(D(!1),L){typeof i.onSuccess=="function"&&i.onSuccess(L);var T="";i.messageSuccess?typeof i.messageSuccess=="function"?T=i.messageSuccess(L):T=i.messageSuccess.indexOf("notification.")==0?x(i.messageSuccess):i.messageSuccess:T=x("notification.finish"),i.asynced?u.info(T):u.success(T)}}).catch(function(L){D(!1),typeof i.onError=="function"&&i.onError(L)}):D(!1)};return i.confirm?(0,Z.jsx)(d.Z,{style:{width:500},title:i.confirmTitle?i.confirmTitle:x("notification.title.tip"),description:typeof i.confirm=="string"&&i.confirm.indexOf("notification.")==0?x(i.confirm):i.confirm,onConfirm:m,okText:"Yes",cancelText:"No",children:(0,Z.jsx)(p.ZP,{disabled:i.disabled,icon:i.icon,loading:y,danger:i.danger,type:i.type,children:i.children})}):(0,Z.jsx)($.Z,{title:i.tips,children:(0,Z.jsx)(p.ZP,{style:i.ghost?{padding:0,height:"auto"}:{},disabled:i.disabled,icon:i.icon,loading:y,onClick:m,danger:i.danger,type:i.type,children:i.children})})}},24963:function(te,A,t){var B=t(67294),r=(0,B.createContext)({});A.Z=r},43774:function(te,A,t){t.r(A),t.d(A,{default:function(){return me}});var B=t(5574),r=t.n(B),K=t(24963),d=t(15078),p=t(90078),$=t(97269),S=t(62370),Z=t(97462),O=t(38345),i=t(45360),C=t(42075),W=t(65233),y=t(28036),D=t(92398),j=t(2487),x=t(32983),w=t(4393),u=t(67294),m=t(15009),P=t.n(m),s=t(99289),L=t.n(s),T=t(184),Y=t(51652),I=t(71230),b=t(15746),Q=t(34041),ae=t(36693),X=t(74842),q=t(25593),ee=t(83062),a=t(66309),e=t(85893);function _(o){var z=(0,u.useState)(),F=r()(z,2),f=F[0],R=F[1];return(0,u.useEffect)(function(){var N=o.url.substring(0,o.url.indexOf("://"));switch(N){case"image":R((0,e.jsx)("img",{width:o.imageSize?o.imageSize.width:"auto",height:o.imageSize?o.imageSize.height:"auto",src:o.url.replace("image://","/dpanel/static/store/file/")}));break;case"http":case"https":R((0,e.jsx)("img",{width:o.imageSize?o.imageSize.width:"auto",height:o.imageSize?o.imageSize.height:"auto",src:o.url}));break;case"markdown-file":(0,d.yL)({path:o.url.replace("markdown-file://","/dpanel/static/store/file/")}).then(function(J){R((0,e.jsx)(Y.Z,{source:J,style:{padding:5}},"content"))});break;case"markdown":R((0,e.jsx)(Y.Z,{source:o.url.replace("markdown://",""),style:{padding:5}},"content"));break;default:R("")}},[o.url]),(0,e.jsx)(e.Fragment,{children:f})}function n(o){return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(I.Z,{gutter:[10,10],children:[(0,e.jsx)(b.Z,{span:6,children:(0,e.jsx)(_,{url:o.app.logo,imageSize:o.logoSize})}),(0,e.jsxs)(b.Z,{span:o.extra?12:18,children:[(0,e.jsx)(I.Z,{children:(0,e.jsx)(b.Z,{span:24,children:(0,e.jsxs)(C.Z,{direction:"horizontal",children:[(0,e.jsx)(q.Z.Title,{level:5,children:o.app.title}),(0,e.jsx)(q.Z.Text,{children:o.app.name})]})})}),(0,e.jsx)(I.Z,{style:{height:"60px"},children:(0,e.jsx)(b.Z,{children:(0,e.jsx)(ee.Z,{title:o.app.description,children:(0,e.jsx)(q.Z.Paragraph,{ellipsis:{rows:2},children:o.app.description})})})}),(0,e.jsx)(I.Z,{style:{height:"35px"},children:(0,e.jsx)(b.Z,{children:(0,e.jsxs)(C.Z,{wrap:!0,children:[o.app.storeName?(0,e.jsx)(a.Z,{color:"blue-inverse",children:o.app.storeName}):"",o.app.tag&&o.app.tag.map(function(z,F){return(0,e.jsx)(a.Z,{children:z},F)})]})})})]}),(0,e.jsx)(b.Z,{span:o.extra?6:0,children:o.extra})]})})}var le=t(80821),ce=t(90098),oe=t(82346),de=(0,u.forwardRef)(function(o,z){var F=(0,u.useState)(!1),f=r()(F,2),R=f[0],N=f[1],J=(0,u.useState)(),se=r()(J,2),h=se[0],re=se[1],U=(0,u.useState)(""),G=r()(U,2),H=G[0],ne=G[1],ie=(0,oe.useNavigate)();return(0,u.useImperativeHandle)(z,function(){return{show:function(v){N(!0),re(v),ne(Object.keys(v.version)[0])}}}),(0,e.jsx)(T.a,{submitter:!1,open:R,onOpenChange:function(v){N(v)},title:"".concat(h==null?void 0:h.name," \u8BE6\u60C5\u4ECB\u7ECD"),children:h&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(O.Z,{ghost:!0,style:{marginBottom:"20px",paddingBottom:"20px",borderBottom:"#eeeeee solid 1px"},children:(0,e.jsx)(n,{app:h,logoSize:{width:"130",height:"130"},extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(I.Z,{gutter:[10,10],children:[(0,e.jsx)(b.Z,{children:(0,e.jsxs)(C.Z,{wrap:!0,children:[(0,e.jsx)(y.ZP,{href:h.website,target:"_blank",icon:(0,e.jsx)(ae.Z,{}),children:"\u5B98\u7F51"},"website"),(0,e.jsx)(le.Z,{action:L()(P()().mark(function g(){var v,c;return P()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,ce.iE)({storeId:(v=h.storeId)!==null&&v!==void 0?v:0,name:h.name,title:h.title,composeFile:h.version[H].composeFile,environment:h.version[H].environment});case 2:c=E.sent,c&&c.data.id&&ie("/compose/create?id="+c.data.id);case 4:case"end":return E.stop()}},g)})),type:"primary",icon:(0,e.jsx)(X.Z,{}),children:"\u5B89\u88C5"},"install")]})}),(0,e.jsx)(b.Z,{span:24,children:h.version&&(0,e.jsx)(Q.Z,{style:{width:"100%"},value:H,onChange:function(v){ne(v)},options:Object.keys(h.version).map(function(g){return{value:g,label:g}})})})]})})})}),Object.keys(h.version).map(function(g){if(!(H!=g||!h.version[g].environment||h.version[g].environment.length==0)){var v=[{name:"%CONTAINER_DEFAULT_NAME%",value:"-",label:"\u4F7F\u7528 Compose \u9ED8\u8BA4\u5BB9\u5668\u540D\u79F0"}],c=`## DPanel \u9762\u677F\u5185\u7F6E\u53D8\u91CF 
 |\u53D8\u91CF\u540D|\u9ED8\u8BA4\u503C|\u8BF4\u660E| 
 |---|---|---|
`;return v.map(function(l){c+="|".concat(l.name,"|").concat(l.value,"|").concat(l.label,`| 
`)}),c+="## \u7248\u672C\u4FE1\u606F <sup>".concat(g,`</sup> 
 |\u53D8\u91CF\u540D|\u9ED8\u8BA4\u503C|\u8BF4\u660E| 
 |---|---|---|
`),h.version[g].environment.map(function(l){c+="|".concat(l.name,"|").concat(l.value,"|").concat(l.label,`| 
`)}),c+="<br />",(0,e.jsx)(Y.Z,{source:c,style:{padding:5}},g)}}),(0,e.jsx)(_,{url:h==null?void 0:h.content})]})})}),pe=de,k="dpanel-search-result";function me(){var o=(0,u.useRef)(),z=(0,u.useState)(),F=r()(z,2),f=F[0],R=F[1],N=(0,u.useContext)(K.Z),J=N.loading,se=N.lang,h=(0,u.useState)(""),re=r()(h,2),U=re[0],G=re[1],H=(0,u.useState)([]),ne=r()(H,2),ie=ne[0],g=ne[1];(0,u.useEffect)(function(){J.show(),(0,d.eO)().then(function(c){c&&c.data&&c.data.list&&c.data.list.push({id:-1,name:k,title:"\u641C\u7D22\u7ED3\u679C",setting:{apps:[]}}),R(Object.fromEntries(c.data.list.map(function(l){return[l.name,l]}))),c.data.list.length>0&&G(c.data.list[0].name)}).finally(function(){J.destroy()})},[]);var v=function(l){var E=[];l=l.toLowerCase(),f&&(Object.keys(f).map(function(V){V!=k&&f[V].setting.apps.map(function(M){if(l&&(M.name.toLowerCase().indexOf(l)!==-1||M.title&&M.title.toLowerCase().indexOf(l)!==-1||M.description&&M.description.toLocaleLowerCase().indexOf(l)!==-1)){var ue=JSON.parse(JSON.stringify(M));ue.storeName="".concat(f[V].title),ue.storeId=f[V].id,E.push(ue)}})}),E.length>0?(g(E),G(k)):(i.ZP.error("\u672A\u80FD\u627E\u5230\u5305\u542B\u5173\u952E\u5B57\u7684\u5E94\u7528"),G(Object.keys(f)[0]),g([])))};return(0,e.jsxs)(p._z,{extra:[(0,e.jsx)($.A,{isKeyPressSubmit:!0,submitter:!1,onFinish:function(l){v(l.search)},children:(0,e.jsxs)(C.Z.Compact,{children:[(0,e.jsx)(S.Z,{style:{margin:0},name:"search",children:(0,e.jsx)(W.Z,{allowClear:!0,addonBefore:"\u5168\u5546\u5E97\u67E5\u8BE2",placeholder:"\u6309\u56DE\u8F66\u67E5\u8BE2\u5E94\u7528",onClear:function(){v("")}})}),(0,e.jsx)(Z.Z,{name:["search"],children:function(l){var E=l.search;return(0,e.jsx)(y.ZP,{onClick:function(){v(E)},children:"\u641C\u7D22"})}})]})},"form")],children:[(0,e.jsx)(pe,{ref:o}),(0,e.jsxs)(O.Z,{children:[U!=""&&f&&(0,e.jsx)(D.Z,{activeKey:U,onChange:function(l){g([]),G(l)},items:Object.keys(f).map(function(c){return{label:f[c].title,key:c,disabled:U!=k&&c==k}})}),(0,e.jsx)(j.Z,{locale:{emptyText:(0,e.jsx)(x.Z,{image:x.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(e.Fragment,{children:["\u9762\u677F\u652F\u6301\u591A\u79CD\u7C7B\u578B\u7684\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\uFF0C",(0,e.jsx)(oe.Link,{to:"/system/appstore?op=create",children:"\u8BF7\u5148\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5546\u5E97"})]})})},pagination:{pageSize:36},rowKey:function(l){return"".concat(l.name).concat(l.storeName)},grid:{gutter:10,xs:1,sm:2,md:2,lg:2,xl:2,xxl:3},dataSource:U==k?ie:f&&f[U]&&f[U].setting.apps,renderItem:function(l,E){return(0,e.jsx)(j.Z.Item,{children:(0,e.jsx)(w.Z,{onClick:function(){if(f){var M;l.storeId||(l.storeId=f[U].id),(M=o.current)===null||M===void 0||M.show(l)}},hoverable:!0,children:(0,e.jsx)(n,{app:l,logoSize:{width:"50",height:"50"}})})},E)}})]})]})}},15078:function(te,A,t){t.d(A,{$c:function(){return $},Me:function(){return D},eO:function(){return W},ks:function(){return Z},yL:function(){return x}});var B=t(15009),r=t.n(B),K=t(99289),d=t.n(K),p=t(82346);function $(u){return S.apply(this,arguments)}function S(){return S=d()(r()().mark(function u(m){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,p.request)("/api/common/store/create",{method:"POST",data:m}));case 1:case"end":return s.stop()}},u)})),S.apply(this,arguments)}function Z(u){return O.apply(this,arguments)}function O(){return O=d()(r()().mark(function u(m){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,p.request)("/api/common/store/sync",{method:"POST",data:m}));case 1:case"end":return s.stop()}},u)})),O.apply(this,arguments)}function i(u){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function u(m){return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:m}));case 1:case"end":return s.stop()}},u)})),C.apply(this,arguments)}function W(u){return y.apply(this,arguments)}function y(){return y=d()(r()().mark(function u(m){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,p.request)("/api/common/store/get-list",{method:"POST",data:m}));case 1:case"end":return s.stop()}},u)})),y.apply(this,arguments)}function D(u){return j.apply(this,arguments)}function j(){return j=d()(r()().mark(function u(m){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,p.request)("/api/common/store/delete",{method:"POST",data:m});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},u)})),j.apply(this,arguments)}function x(u){return w.apply(this,arguments)}function w(){return w=d()(r()().mark(function u(m){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,p.request)(m==null?void 0:m.path,{method:"GET"}));case 1:case"end":return s.stop()}},u)})),w.apply(this,arguments)}},90098:function(te,A,t){t.d(A,{GG:function(){return u},MG:function(){return Y},Oh:function(){return D},Pn:function(){return i},U_:function(){return L},VN:function(){return P},iE:function(){return ae},ik:function(){return W},im:function(){return $},mg:function(){return x},pm:function(){return Z},tw:function(){return q},xC:function(){return b}});var B=t(15009),r=t.n(B),K=t(99289),d=t.n(K),p=t(82346);function $(a){return S.apply(this,arguments)}function S(){return S=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/app/compose/create",{method:"POST",data:e}));case 1:case"end":return n.stop()}},a)})),S.apply(this,arguments)}function Z(a){return O.apply(this,arguments)}function O(){return O=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/app/compose/get-list",{method:"POST",data:e}));case 1:case"end":return n.stop()}},a)})),O.apply(this,arguments)}function i(a){return C.apply(this,arguments)}function C(){return C=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.id=String(e.id),n.abrupt("return",(0,p.request)("/api/app/compose/get-task",{method:"POST",data:e}));case 2:case"end":return n.stop()}},a)})),C.apply(this,arguments)}function W(a){return y.apply(this,arguments)}function y(){return y=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/app/compose/delete",{method:"POST",data:e}));case 1:case"end":return n.stop()}},a)})),y.apply(this,arguments)}function D(a){return j.apply(this,arguments)}function j(){return j=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.id=String(e.id),n.abrupt("return",(0,p.request)("/api/app/compose/container-deploy",{method:"POST",data:e}));case 2:case"end":return n.stop()}},a)})),j.apply(this,arguments)}function x(a){return w.apply(this,arguments)}function w(){return w=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.id=String(e.id),n.abrupt("return",(0,p.request)("/api/app/compose/container-destroy",{method:"POST",data:e}));case 2:case"end":return n.stop()}},a)})),w.apply(this,arguments)}function u(a){return m.apply(this,arguments)}function m(){return m=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.id=String(e.id),n.abrupt("return",(0,p.request)("/api/app/compose/container-ctrl",{method:"POST",data:e}));case 2:case"end":return n.stop()}},a)})),m.apply(this,arguments)}function P(a){return s.apply(this,arguments)}function s(){return s=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.id=String(e.id),n.abrupt("return",(0,p.request)("/api/app/compose/container-log",{method:"POST",data:e}));case 2:case"end":return n.stop()}},a)})),s.apply(this,arguments)}function L(a){return T.apply(this,arguments)}function T(){return T=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/app/compose/container-process-kill",{method:"POST",data:e}));case 1:case"end":return n.stop()}},a)})),T.apply(this,arguments)}function Y(a){return I.apply(this,arguments)}function I(){return I=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/app/compose/get-from-uri",{method:"POST",data:e}));case 1:case"end":return n.stop()}},a)})),I.apply(this,arguments)}function b(a){return Q.apply(this,arguments)}function Q(){return Q=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/app/compose/parse",{method:"POST",data:e}));case 1:case"end":return n.stop()}},a)})),Q.apply(this,arguments)}function ae(a){return X.apply(this,arguments)}function X(){return X=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,p.request)("/api/common/store/deploy",{method:"POST",data:e}));case 1:case"end":return n.stop()}},a)})),X.apply(this,arguments)}function q(a){return ee.apply(this,arguments)}function ee(){return ee=d()(r()().mark(function a(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.id=String(e.id),n.abrupt("return",(0,p.request)("/api/app/compose/download",{method:"POST",data:e,responseType:"blob"}));case 2:case"end":return n.stop()}},a)})),ee.apply(this,arguments)}}}]);
