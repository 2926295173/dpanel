"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1147],{99922:function(N,U,e){var A=e(97857),O=e.n(A),v=e(15009),p=e.n(v),L=e(99289),K=e.n(L),B=e(5574),g=e.n(B),r=e(67294),Z=e(85265),F=e(42075),y=e(83622),i=e(49610),D=e(3616),d=e(93362),j=e(90581),x=e(5251),M=e(36146),C=e(85893),u=new M.Uo("components.appDetail.appDetailQuickConsole"),S=(0,r.forwardRef)(function(R,w){var o,T,a=(0,r.useRef)(),f=(0,r.useRef)(),I=(0,r.useState)(!1),E=g()(I,2),s=E[0],m=E[1],l=(0,r.useState)(),h=g()(l,2),_=h[0],c=h[1];return(0,r.useImperativeHandle)(w,function(){return{show:function(n){return K()(p()().mark(function W(){var P;return p()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:c(n),m(!0),(P=a.current)===null||P===void 0||P.resetFields();case 3:case"end":return b.stop()}},W)}))()}}}),(0,r.useEffect)(function(){return setTimeout(function(){var t;_&&((t=f.current)===null||t===void 0||t.start(_.url,{cmd:_&&_.cmd,workDir:_&&_.workDir}))},1e3),function(){var t;(t=f.current)===null||t===void 0||t.close()}},[_,s]),(0,C.jsxs)(Z.Z,{forceRender:!0,width:D.FK,open:s,onClose:function(){return[m(!1)]},title:u.format("drawerTitle",{name:_==null?void 0:_.title}),children:[(0,C.jsxs)(F.Z,{style:{marginBottom:20},children:[R.showFileExplorer&&(0,C.jsx)(d.Z,{trigger:(0,C.jsx)(y.ZP,{type:"primary",children:u.format("fileExplorerButton")}),type:"container",title:(0,x.fi)((o=_==null?void 0:_.title)!==null&&o!==void 0?o:"","/"),name:_&&_.url&&(T=_.url.split("/").pop())!==null&&T!==void 0?T:""}),(0,C.jsx)(j.Z,{onChangeShell:function(n){var W;if(!_)return!1;(W=f.current)===null||W===void 0||W.close(),c(O()(O()({},_),{cmd:n!=null?n:_==null?void 0:_.cmd}))},onOpenNewWindow:function(n){return _?(n.workDir=_&&_.workDir?_.workDir:"","".concat(_.url,"?").concat(Object.keys(n).map(function(W){return"".concat(W,"=").concat(encodeURIComponent(n[W]))}).join("&"))):""},onOpenNewWindowFinish:function(){var n;(n=f.current)===null||n===void 0||n.close(),m(!1)},onBatchCommandFinish:function(n){f.current&&f.current.run(n)}})]}),s&&(0,C.jsx)(i.Z,{height:"80vh",ref:f})]})});U.Z=S},93362:function(N,U,e){var A=e(97857),O=e.n(A),v=e(15009),p=e.n(v),L=e(99289),K=e.n(L),B=e(5574),g=e.n(B),r=e(67294),Z=e(57221),F=e(85265),y=e(3616),i=e(5251),D=e(36146),d=e(28031),j=e(24963),x=e(99922),M=e(85893),C=(0,r.forwardRef)(function(u,S){var R,w=(0,r.useState)(!1),o=g()(w,2),T=o[0],a=o[1],f=(0,r.useState)(),I=g()(f,2),E=I[0],s=I[1],m=(0,r.useRef)(),l=new D.Uo("components.appDetail.appDetailQuickFile"),h=(0,r.useContext)(j.Z),_=h.loading,c=(0,r.useRef)();return(0,r.useImperativeHandle)(S,function(){return{showContainer:function(n){s({name:(0,i.fi)(n,"/"),type:"container"}),a(!0)},showHost:function(n){s({name:n,type:"host"}),a(!0)},showVolume:function(n){return K()(p()().mark(function W(){var P;return p()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return _.show(),b.next=3,(0,d.Ak)("app",{name:n}).finally(function(){_.destroy()});case 3:P=b.sent,s({name:P.data.containerName,type:"container",workDir:P.data.path}),a(!0);case 6:case"end":return b.stop()}},W)}))()}}}),(0,M.jsxs)(M.Fragment,{children:[u.trigger?r.cloneElement(u.trigger,{onClick:function(){u.name&&u.type&&(s(u),a(!0))}}):null,(0,M.jsxs)(F.Z,{destroyOnHidden:!0,width:y.R_,title:l.format("drawerTitle",{name:(R=u.title)!==null&&R!==void 0?R:E==null?void 0:E.name}),onClose:K()(p()().mark(function t(){var n;return p()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(_.show(),a(!1),(n=m.current)===null||n===void 0||n.close(),s(void 0),!u.onCloseDestroy){P.next=7;break}return P.next=7,(0,d.nC)("app");case 7:_.destroy();case 8:case"end":return P.stop()}},t)})),open:T,children:[u.showConsole&&(0,M.jsx)(x.Z,{showFileExplorer:!1,ref:c}),T&&E&&(0,M.jsx)(Z.Z,O()(O()({ref:m},E),{},{onConsole:u.showConsole?function(t){var n;(n=c.current)===null||n===void 0||n.show({url:"/console/container/".concat(E.name),title:E.name,workDir:t})}:void 0}))]})]})});U.Z=C},90581:function(N,U,e){e.d(U,{Z:function(){return T}});var A=e(15009),O=e.n(A),v=e(99289),p=e.n(v),L=e(5574),K=e.n(L),B=e(3616),g=e(97269),r=e(38345),Z=e(64317),F=e(37476),y=e(62370),i=e(97462),D=e(11106),d=e(42075),j=e(83622),x=e(83062),M=e(67294),C=e(33160),u=e(58638),S=e(82346),R=e(75520),w=e(36146),o=e(85893);function T(a){var f=(0,M.useState)(!1),I=K()(f,2),E=I[0],s=I[1],m=(0,M.useRef)(),l=new w.Uo("components.console");return(0,o.jsx)(g.A,{layout:"inline",submitter:!1,children:(0,o.jsx)(r.Z,{ghost:!0,children:(0,o.jsxs)(d.Z,{children:[(0,o.jsx)(Z.Z,{width:"sm",name:"entryCmd",placeholder:l.format("toolbarEntryCmdEmpty"),valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(_){a.onChangeShell&&a.onChangeShell(_)}}),(0,o.jsx)(F.Y,{modalProps:{width:B.ob,height:B.Ed},title:l.format("toolbarBatchCommandTitle"),name:"batchCommand",open:E,trigger:(0,o.jsx)(j.ZP,{children:l.format("toolbarBatchCommandTitle")}),formKey:"batchCommand",formRef:m,isKeyPressSubmit:!0,onFinish:function(){var h=p()(O()().mark(function _(c){return O()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a.onBatchCommandFinish&&a.onBatchCommandFinish(c.shell.split(`
`)),s(!1);case 2:case"end":return n.stop()}},_)}));return function(_){return h.apply(this,arguments)}}(),onOpenChange:function(_){s(_),_&&m.current&&m.current.resetFields()},children:(0,o.jsx)(y.Z,{name:"shell",children:(0,o.jsx)(D.ZP,{theme:"dark",height:B.Ed})})}),(0,o.jsx)(j.ZP,{onClick:function(){a.onChangeShell&&a.onChangeShell()},icon:(0,o.jsx)(C.Z,{}),type:"primary"}),(0,o.jsx)(i.Z,{name:["entryCmd"],children:function(_){var c=_.entryCmd;return(!c||c=="")&&(c="/bin/sh"),a.onOpenNewWindow&&(0,o.jsx)(S.Link,{onClick:function(){a.onOpenNewWindowFinish&&a.onOpenNewWindowFinish()},target:"_blank",to:a.onOpenNewWindow({cmd:c}),children:(0,o.jsx)(x.Z,{title:l.format("toolbarOpenInNewWindowTip"),children:(0,o.jsx)(j.ZP,{type:"dashed",icon:(0,o.jsx)(u.Z,{})})})})}}),(0,o.jsx)(R.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})}},49610:function(N,U,e){var A=e(5574),O=e.n(A),v=e(67294),p=e(52626),L=e(78267),K=e.n(L),B=e(12323),g=e(87662),r=e(4244),Z=e.n(r),F=e(24078),y=e(85893),i,D,d,j,x=(0,v.forwardRef)(function(M,C){var u,S=(0,v.useState)(),R=O()(S,2),w=R[0],o=R[1],T=(0,v.useState)(""),a=O()(T,2),f=a[0],I=a[1];(0,v.useImperativeHandle)(C,function(){return{start:function(m,l){E(),D.fit(),l.width=i.cols,l.height=i.rows;var h=l?Object.keys(l).filter(function(_){return l&&l[_]}).map(function(_){if(l&&l[_])return"".concat(_,"=").concat(l[_])}):[];d=new WebSocket((0,p.R)(m+"?"+h.join("&"))),d.addEventListener("message",function(_){var c=JSON.parse(_.data),t=c.type;if(t==m&&(i.write(c.data),c.data.indexOf("exec failed")!=-1)){E();return}}),j=i.onData(function(_){var c={content:{command:_},type:m};d&&d.send(JSON.stringify(c))}),I(m),o(l)},close:function(){E()},fit:function(){return D.fit(),{width:i.cols,height:i.rows}},run:function(m){w&&m&&m.forEach(function(l){var h={content:{command:l+`
`},type:f};d&&d.send(JSON.stringify(h))})}}}),(0,v.useEffect)(function(){return i=new r.Terminal(B.X),D=new L.FitAddon,i.loadAddon(D),i.open(document.getElementById("terminal-container-console")),D.fit(),(0,g.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(s){s.data&&s.data.fontSize&&Object.assign(i.options,s.data)}),function(){E()}},[]),(0,v.useEffect)(function(){window.addEventListener("resize",function(){D.fit();var s={size:{width:i.cols,height:i.rows},type:f};f&&d&&d.send(JSON.stringify(s))})},[f]);function E(){j&&(i.reset(),D.fit(),i.focus(),j.dispose()),d&&(d.close(),d=null)}return(0,y.jsx)("div",{style:{height:(u=M.height)!==null&&u!==void 0?u:"100vh"},id:"terminal-container-console"})});U.Z=x},12323:function(N,U,e){e.d(U,{X:function(){return A},n:function(){return O}});var A={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},O=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]}}]);
