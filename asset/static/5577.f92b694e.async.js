"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5577],{57716:function(H,W,n){n.d(W,{Z:function(){return O}});var R=n(5574),r=n.n(R),j=n(15009),o=n.n(j),p=n(99289),S=n.n(p),l=n(67294),b=n(184),h=n(38345),g=n(64317),D=n(5966),U=n(62370),c=n(97462),I=n(42075),f=n(89035),L=n(82346),i=n(28036),u=n(85893);function v(s){var t=(0,l.useState)({height:800,width:1024}),a=r()(t,2),d=a[0],e=a[1],x=function(){var N=window.innerWidth,z=window.innerHeight;e({height:z,width:N})};(0,l.useEffect)(function(){window.addEventListener("resize",function(){x()}),x()},[s]);var K=s.query?Object.keys(s.query).map(function(B){if(s.query)return"".concat(B,"=").concat(s.query[B])}):[];return(0,u.jsx)(L.Link,{target:"_blank",to:"/console/"+s.container+"?width=".concat(d.width,"&height=").concat(d.height,"&").concat(K.join("&")),children:(0,u.jsx)(i.ZP,{type:"primary",icon:(0,u.jsx)(f.Z,{}),children:s.content})})}var _=n(60335),T=n(5251),P=n(49610),y=(0,l.forwardRef)(function(s,t){(0,l.useImperativeHandle)(t,function(){return{show:function(M,m){return S()(o()().mark(function A(){var F,Z,C;return o()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,_.jV)({md5:M});case 2:C=$.sent,m&&m!=""&&(C.data.info.Config.WorkingDir=m),V(C.data.info),B(!0),(F=a.current)===null||F===void 0||F.resetFields(),(Z=a.current)===null||Z===void 0||Z.setFieldsValue({workDir:C.data.info.Config.WorkingDir});case 8:case"end":return $.stop()}},A)}))()}}});var a=(0,l.useRef)(),d=(0,l.useRef)(),e=(0,l.useState)(!1),x=r()(e,2),K=x[0],B=x[1],N=(0,l.useState)(),z=r()(N,2),w=z[0],V=z[1];return(0,l.useEffect)(function(){return w&&setTimeout(function(){var E;(E=d.current)===null||E===void 0||E.start(w.Id,{width:"800",height:"".concat(window.innerHeight),cmd:"/bin/sh",workDir:w.Config.WorkingDir})},1e3),function(){var E;(E=d.current)===null||E===void 0||E.close()}},[w,K]),(0,u.jsxs)(b.a,{drawerProps:{forceRender:!0},onFinish:function(){var E=S()(o()().mark(function M(m){var A,F;return o()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(w){C.next=2;break}return C.abrupt("return",!1);case 2:return(A=d.current)===null||A===void 0||A.close(),(F=d.current)===null||F===void 0||F.start(w.Id,{width:"800",height:"".concat(window.innerHeight),cmd:m.entryCmd,workDir:m.workDir}),C.abrupt("return",!1);case 5:case"end":return C.stop()}},M)}));return function(M){return E.apply(this,arguments)}}(),onValuesChange:function(M,m){if(m.entryCmd){var A;(A=a.current)===null||A===void 0||A.submit()}},isKeyPressSubmit:!0,open:K,formRef:a,onOpenChange:function(M){if(B(M),M){var m;(m=d.current)===null||m===void 0||m.fit()}},submitter:!1,title:(0,T.fi)(w?w.Name:"","/")+" \u63A7\u5236\u53F0",children:[(0,u.jsx)(h.Z,{ghost:!0,children:(0,u.jsxs)(I.Z.Compact,{children:[(0,u.jsx)(g.Z,{label:"shell",width:"sm",name:"entryCmd",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,u.jsx)(D.Z,{width:"sm",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",disabled:!0}),(0,u.jsx)(U.Z,{label:" ",children:(0,u.jsx)(c.Z,{name:["entryCmd","workDir"],children:function(M){var m=M.entryCmd;return(!m||m=="")&&(m="/bin/sh"),w&&(0,u.jsx)(v,{container:w.Id,query:{cmd:encodeURIComponent(m),workDir:encodeURIComponent(w.Config.WorkingDir)},content:"\u65B0\u7A97\u53E3\u6253\u5F00"})}})})]})}),K&&(0,u.jsx)(P.Z,{showInDrawer:!0,ref:d})]})}),O=y},49610:function(H,W,n){var R=n(67294),r=n(54964),j=n(52626),o=n(12320),p=n.n(o),S=n(78267),l=n.n(S),b=n(85893),h,g=new o.Terminal(r.a),D=new S.FitAddon,U=(0,R.forwardRef)(function(c,I){var f,L=function(){g.reset(),f&&f.dispose(),h&&(h.close(),h=null)},i=function(){g.reset(),D.fit(),g.focus(),f&&f.dispose(),f=g.onData(function(v){var _={content:{command:v},type:"console"};h&&h.send(JSON.stringify(_))})};return(0,R.useImperativeHandle)(I,function(){return{start:function(v,_){var T=_?Object.keys(_).map(function(P){if(_&&_[P])return"".concat(P,"=").concat(_[P])}):[];h=new WebSocket((0,j.R)("/console/"+v+"?"+T.join("&"))),h.addEventListener("message",function(P){var y=JSON.parse(P.data),O=y.type;if(O=="console:"+v&&(g.write(y.data),y.data.indexOf("exec failed")!=-1)){L();return}}),i()},close:function(){L()},fit:function(){D.fit()}}}),(0,R.useEffect)(function(){return g.loadAddon(D),g.open(document.getElementById("terminal-container-console")),D.fit(),function(){L()}},[]),(0,b.jsx)("div",{style:{height:c.showInDrawer?"75vh":"100vh"},id:"terminal-container-console"})});W.Z=U},54964:function(H,W,n){n.d(W,{a:function(){return U}});var R=n(5574),r=n.n(R),j=n(78267),o=n.n(j),p=n(75458),S=n.n(p),l=n(67294),b=n(12320),h=n.n(b),g=n(89629),D=n(85893),U={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},c=new b.Terminal(U),I=new p.SearchAddon,f=new j.FitAddon,L=(0,l.forwardRef)(function(i,u){var v,_=(0,l.useState)(!0),T=r()(_,2),P=T[0],y=T[1];return(0,l.useEffect)(function(){return window.addEventListener("resize",function(){i.showInModal||f.fit()}),i.style&&i.style.fontSize&&(c.options.fontSize=i.style.fontSize),c.loadAddon(f),c.loadAddon(I),c.open(document.getElementById(i.id?i.id:"terminal-container")),i.showInModal||f.fit(),function(){c.reset(),y(!0)}},[]),(0,l.useImperativeHandle)(u,function(){return{write:function(s){P&&(f.fit(),y(!1)),c.write(s)},clear:function(){c.clear()},getTerminal:function(){return c},findNext:function(s){I.findNext(s)},findPrev:function(s){I.findPrevious(s)},fit:function(){f.fit()},onData:function(s){return c.onData(s)}}}),(0,D.jsx)("div",{id:i.id?i.id:"terminal-container",style:{width:i.width?i.width:"100%",height:i.height?i.height:"500px",marginTop:(v=i.style)===null||v===void 0?void 0:v.marginTop}})});W.Z=L},28031:function(H,W,n){n.d(W,{C4:function(){return u},LK:function(){return L},OQ:function(){return _},V9:function(){return S},Yx:function(){return U},ZU:function(){return g},_U:function(){return b},gb:function(){return I},lE:function(){return O},vp:function(){return P}});var R=n(15009),r=n.n(R),j=n(99289),o=n.n(j),p=n(82346);function S(t){return l.apply(this,arguments)}function l(){return l=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/explorer/get-path-list",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),l.apply(this,arguments)}function b(t){return h.apply(this,arguments)}function h(){return h=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/explorer/export",{data:a,method:"POST",responseType:"blob"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),h.apply(this,arguments)}function g(t){return D.apply(this,arguments)}function D(){return D=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/explorer/import",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),D.apply(this,arguments)}function U(t){return c.apply(this,arguments)}function c(){return c=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/explorer/delete",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),c.apply(this,arguments)}function I(t){return f.apply(this,arguments)}function f(){return f=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/explorer/unzip",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),f.apply(this,arguments)}function L(t){return i.apply(this,arguments)}function i(){return i=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/explorer/get-content",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),i.apply(this,arguments)}function u(t){return v.apply(this,arguments)}function v(){return v=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/explorer/import-file-content",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),v.apply(this,arguments)}function _(t){return T.apply(this,arguments)}function T(){return T=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/explorer/chmod",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),T.apply(this,arguments)}function P(t){return y.apply(this,arguments)}function y(){return y=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/volume/backup",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),y.apply(this,arguments)}function O(t){return s.apply(this,arguments)}function s(){return s=o()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.request)("/api/app/explorer/get-passwd",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),s.apply(this,arguments)}}}]);
