"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1058],{91058:function(X,j,e){var I=e(9783),_=e.n(I),W=e(19632),E=e.n(W),i=e(97857),d=e.n(i),w=e(5574),T=e.n(w),L=e(89035),C=e(45605),b=e(64317),S=e(5966),y=e(38345),h=e(17186),x=e(24739),f=e(42075),U=e(83622),H=e(83062),B=e(85576),M=e(67294),F=e(11106),$=e(12491),P=e(62597),D=e(79245),A=e(3616),o=e(36146),r=e(85893),g="docker-image",n=(0,M.forwardRef)(function(u,Z){var q=(0,M.useState)(g),V=T()(q,2),Y=V[0],k=V[1],v=(0,M.useRef)(),J=(0,M.useState)(""),G=T()(J,2),ee=G[0],ae=G[1],K=new o.Uo("components.appForm");(0,M.useImperativeHandle)(Z,function(){return{addEnvItem:function(a,c){var s,l=(s=v.current)===null||s===void 0?void 0:s.getList(),m=!1;if(l==null||l.map(function(O){if(O.name==a){m=!0;return}}),!m){var p;(p=v.current)===null||p===void 0||p.add({name:a,value:c})}},clear:function(){var a;(a=v.current)===null||a===void 0||(a=a.getList())===null||a===void 0||a.map(function(c,s){var l;(l=v.current)===null||l===void 0||l.remove(s)})}}});function re(t){try{var a,c;t==""&&(t=te());for(var s=(a=(c=v.current)===null||c===void 0||(c=c.getList())===null||c===void 0?void 0:c.length)!==null&&a!==void 0?a:0,l=s;l>=0;l--){var m,p,O=(m=v.current)===null||m===void 0?void 0:m.get(l);O&&O.rule&&(0,D.y)(O.rule.kind,P.fp.EnvValueRuleRWOnly)||(s-=1,(p=v.current)===null||p===void 0||p.remove(l))}var Q=t.split(`
`),z=s+1;Q.map(function(R){var N,ne=R.split("=");ne.length<2||((N=v.current)===null||N===void 0||N.add({name:ne[0],value:ne.slice(1).join("=")},z),z++)})}catch(R){console.log(R)}}function oe(){Y!="code"?k("code"):k(g)}function te(){if(v&&v.current&&v.current.getList){var t,a=(t=v.current)===null||t===void 0?void 0:t.getList();if(a){var c=[];return a.forEach(function(s){s&&s.rule&&(0,D.y)(s.rule.kind,P.fp.EnvValueRuleRWOnly)||c.push("".concat(s.name,"=").concat(s.value))}),c.join(`
`)}else return""}else return""}function _e(t){var a,c,s,l,m,p={},O={help:t&&t.label?t.label:"",name:"value",label:K.format("createEnvFormValue"),rules:[{required:u.requireValue?!0:(0,D.y)((a=t.rule)===null||a===void 0?void 0:a.kind,P.fp.EnvValueRuleRequired)}],disabled:u.showDisableValue||(0,D.y)((c=t.rule)===null||c===void 0?void 0:c.kind,P.fp.EnvValueRuleDisabled)};if((0,D.y)((s=t.rule)===null||s===void 0?void 0:s.kind,P.fp.EnvValueTypeSelect)){var Q;return(0,r.jsx)(b.Z,d()(d()({fieldProps:p},O),{},{initialValue:t.value,width:u.showInDrawer?"sm":"md",options:((Q=t.rule)===null||Q===void 0?void 0:Q.option)&&t.rule.option.map(function(R){return{label:R.name,value:R.value}})}))}else if((0,D.y)((l=t.rule)===null||l===void 0?void 0:l.kind,P.fp.EnvValueTypeSelectMultiple)){var z;return(0,r.jsx)(b.Z,d()(d()({mode:"tags"},O),{},{fieldProps:p,convertValue:function(N){return Array.isArray(N)?N:N.split(",")},width:u.showInDrawer?"sm":"md",options:((z=t.rule)===null||z===void 0?void 0:z.option)&&t.rule.option.map(function(R){return{label:R.name,value:R.value}})}))}else return(0,D.y)((m=t.rule)===null||m===void 0?void 0:m.kind,P.fp.EnvValueTypeNumber)?(0,r.jsx)(S.Z,d()(d()({fieldProps:p},O),{},{width:u.showInDrawer?"sm":"md",rules:[].concat(E()(O.rules),[{pattern:new RegExp("^[0-9]*$")}]),help:K.format("createEnvFormNumberTip",{name:O.help})})):(0,r.jsx)(S.Z,d()(d()({fieldProps:p},O),{},{width:u.showInDrawer?"sm":"md"}))}return(0,r.jsxs)(y.Z,d()(d()({headerBordered:!0},u.drawerProps),{},{extra:(u.showCodeMode||u.showImportButton)&&(0,r.jsxs)(f.Z,{children:[u.showImportButton&&(0,r.jsx)("div",{style:{marginBottom:"-25px"},children:(0,r.jsx)($.Z,{title:K.format("createEnvFormEnvImport"),onImport:function(a){return re(a),!0},onLoad:function(a){if(a.indexOf("=")<0)throw new Error(o.FD.format("commonFileIncorrectFormat",{name:"env"}));return!0}})}),u.showCodeMode?(0,r.jsx)(U.ZP,{icon:(0,r.jsx)(L.Z,{}),type:Y=="code"?"primary":"default",onClick:oe,children:K.format("createEnvFormEnvCode")},"code"):""]}),children:[(0,r.jsx)(h.u,{name:u.name?u.name:"environment",actionRef:v,creatorButtonProps:u.showAddButton?{creatorButtonText:u.addButtonLabel?u.addButtonLabel:K.format("createEnvFormListAddButton")}:!1,copyIconProps:!1,deleteIconProps:u.showDeleteButton,actionRender:function(a,c,s,l){var m,p,O=(m=v.current)===null||m===void 0?void 0:m.get(a.key);return O&&(0,D.y)((p=O.rule)===null||p===void 0?void 0:p.kind,P.fp.EnvValueRuleRWOnly)?[(0,r.jsx)(H.Z,{title:K.format("createEnvFormListInEnvFile"),children:(0,r.jsx)(U.ZP,{type:"text",icon:(0,r.jsx)(C.Z,{})})})]:[s[0]]},min:100,label:u.listLabel,transform:function(a,c,s){return _()({},c,a.map(function(l){return Array.isArray(l.value)&&(l.value=l.value.filter(function(m){return m!=""}).join(",")),l}))},children:function(a,c,s){var l,m=s.getCurrentRowData();return(0,r.jsxs)(x.UW,{style:{marginBottom:"5px"},children:[(0,r.jsx)(S.Z,{width:u.showInDrawer?"sm":"md",name:"name",label:K.format("createEnvFormName"),required:!0,rules:[{required:!0}],disabled:u.showDisableName||(0,D.y)((l=m.rule)===null||l===void 0?void 0:l.kind,P.fp.EnvValueRuleRWOnly),placeholder:K.format("createEnvFormNameEmpty")}),_e(m)]})}}),u.showCodeMode&&(0,r.jsx)(B.Z,{width:A.ob,open:Y=="code",onCancel:function(){return k("docker-image")},onOk:function(){re(ee),k("docker-image")},children:(0,r.jsx)(F.ZP,{onChange:function(a){return ae(a)},value:te(),height:A.Ed,theme:"dark"})})]}))});j.Z=n},12491:function(X,j,e){e.d(j,{Z:function(){return x}});var I=e(5574),_=e.n(I),W=e(3616),E=e(24963),i=e(36146),d=e(88484),w=e(57546),T=e(62370),L=e(11106),C=e(42075),b=e(83622),S=e(85576),y=e(67294),h=e(85893);function x(f){var U=(0,y.useContext)(E.Z),H=U.message,B=U.notice,M=(0,y.useRef)(null),F=(0,y.useState)(!1),$=_()(F,2),P=$[0],D=$[1],A=(0,y.useState)(""),o=_()(A,2),r=o[0],g=o[1];(0,y.useEffect)(function(){f.data&&g(f.data)},[f.data]);var n=function(){M.current&&(M.current.click(),M.current.onchange=function(Z){if(!Z||!Z.target)return"";var q=new FileReader;q.onload=function(k){var v,J,G=(v=k.target)===null||v===void 0?void 0:v.result;if(f.onLoad)try{f.onLoad&&f.onLoad(G)}catch(ee){B.error(ee);return}g(G),typeof f.onImport=="function"&&(H.success(i.FD.format("finish")),f.onImport(G)),(J=M.current)!==null&&J!==void 0&&J.value&&(M.current.value="")};var V=Z.target;if(V.files&&V.files[0]){var Y=V.files[0];try{q.readAsText(Y)}catch(k){B.error(i.FD.format("commonContentIncorrectFormat",{name:V.files[0].name}))}}})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(T.Z,{children:(0,h.jsxs)(C.Z.Compact,{block:!0,children:[(0,h.jsx)(b.ZP,{icon:(0,h.jsx)(d.Z,{}),block:!0,onClick:n,children:f.title}),f.showPaset&&(0,h.jsx)(b.ZP,{icon:(0,h.jsx)(w.Z,{}),onClick:function(){D(!0)}})]})}),(0,h.jsx)("input",{style:{display:"none"},type:"file",ref:M,name:"importFileInput"}),(0,h.jsx)(S.Z,{width:W.ob,open:P,onCancel:function(){D(!1)},onOk:function(){typeof f.onImport=="function"&&(H.success(i.FD.format("finish")),f.onImport(r)),D(!1)},children:(0,h.jsx)(L.ZP,{height:W.Ed,theme:"dark",value:r,onChange:function(Z){g(Z)}})})]})}},3616:function(X,j,e){e.d(j,{Ed:function(){return E},FK:function(){return _},R_:function(){return I},ob:function(){return W}});var I=window.innerWidth<=1024?"90vw":"65vw",_="90vw",W="60vw",E="50vh"},24963:function(X,j,e){var I=e(67294),_=(0,I.createContext)({});j.Z=_},62597:function(X,j,e){e.d(j,{$G:function(){return L},Ct:function(){return M},Tb:function(){return h},XH:function(){return f},cl:function(){return S},fp:function(){return b},fu:function(){return w},iE:function(){return H},nL:function(){return T},xb:function(){return $},ze:function(){return D}});var I=e(15009),_=e.n(I),W=e(99289),E=e.n(W),i=e(82346),d="com.dpanel.container.description",w="com.dpanel.container.title",T={Nanosecond:1,Microsecond:1e3,Millisecond:1e3*1e3,Second:1e3*1e3*1e3,Minute:60*1e3*1e3*1e3,Hour:3600*1e3*1e3*1e3};function L(o){return C.apply(this,arguments)}function C(){return C=E()(_()().mark(function o(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/site/create-by-image",{method:"POST",data:r}));case 1:case"end":return n.stop()}},o)})),C.apply(this,arguments)}var b={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueRuleRWOnly:4,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192};function S(o){return y.apply(this,arguments)}function y(){return y=E()(_()().mark(function o(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/site/get-list",{method:"POST",data:r}));case 1:case"end":return n.stop()}},o)})),y.apply(this,arguments)}function h(o){return x.apply(this,arguments)}function x(){return x=E()(_()().mark(function o(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.download=!1,n.next=3,(0,i.request)("/api/app/log/run",{method:"POST",data:r});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),x.apply(this,arguments)}function f(o){return U.apply(this,arguments)}function U(){return U=E()(_()().mark(function o(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.download=!0,n.next=3,(0,i.request)("/api/app/log/run",{method:"POST",data:r,responseType:"blob"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),U.apply(this,arguments)}function H(o){return B.apply(this,arguments)}function B(){return B=E()(_()().mark(function o(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.id=String(r.id),n.next=3,(0,i.request)("/api/app/site/get-detail",{data:r,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),B.apply(this,arguments)}function M(o){return F.apply(this,arguments)}function F(){return F=E()(_()().mark(function o(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/container/delete",{method:"POST",data:r}));case 1:case"end":return n.stop()}},o)})),F.apply(this,arguments)}function $(o){return P.apply(this,arguments)}function P(){return P=E()(_()().mark(function o(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/site/delete",{method:"POST",data:r}));case 1:case"end":return n.stop()}},o)})),P.apply(this,arguments)}function D(o){return A.apply(this,arguments)}function A(){return A=E()(_()().mark(function o(r){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/container/ignore",{method:"POST",data:r}));case 1:case"end":return n.stop()}},o)})),A.apply(this,arguments)}},79245:function(X,j,e){e.d(j,{m:function(){return W},y:function(){return E}});var I=e(64599),_=e.n(I);function W(i){var d=[];if(!i||i=="")return d;var w=i.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),T=_()(w),L;try{for(T.s();!(L=T.n()).done;){var C=L.value;d.push({name:C[1],value:C[2]?C[2].indexOf("-")==0?C[2].substring(1):C[2]:""})}}catch(b){T.e(b)}finally{T.f()}return d}function E(i,d){return!i||!d?!1:(i&d)!==0}}}]);
