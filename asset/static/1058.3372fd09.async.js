"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1058],{91058:function(G,g,e){var C=e(9783),_=e.n(C),T=e(19632),p=e.n(T),i=e(97857),d=e.n(i),y=e(5574),j=e.n(y),R=e(89035),E=e(64317),b=e(5966),S=e(38345),K=e(17186),m=e(24739),$=e(42075),f=e(28036),V=e(85576),P=e(67294),k=e(95089),D=e(12491),B=e(62597),O=e(79245),a=e(3616),o=e(36146),s=e(85893),n="docker-image",Y=(0,P.forwardRef)(function(u,Q){var x=(0,P.useState)(n),w=j()(x,2),N=w[0],A=w[1],h=(0,P.useRef)(),J=(0,P.useState)(""),H=j()(J,2),z=H[0],X=H[1],L=new o.Uo("components.appForm");(0,P.useImperativeHandle)(Q,function(){return{addEnvItem:function(t,c){var v,l=(v=h.current)===null||v===void 0?void 0:v.getList(),M=!1;if(l==null||l.map(function(I){if(I.name==t){M=!0;return}}),!M){var W;(W=h.current)===null||W===void 0||W.add({name:t,value:c})}},clear:function(){var t;(t=h.current)===null||t===void 0||(t=t.getList())===null||t===void 0||t.map(function(c,v){var l;(l=h.current)===null||l===void 0||l.remove(v)})}}});function ee(r){try{var t,c;r==""&&(r=ne());for(var v=(t=(c=h.current)===null||c===void 0||(c=c.getList())===null||c===void 0?void 0:c.length)!==null&&t!==void 0?t:0,l=v;l>=0;l--){var M;(M=h.current)===null||M===void 0||M.remove(l)}var W=r.split(`
`),I=0;W.map(function(F){var Z,U=F.split("=");U.length<2||((Z=h.current)===null||Z===void 0||Z.add({name:U[0],value:U.slice(1).join("=")},I),I++)})}catch(F){console.log(F)}}function re(){N!="code"?A("code"):A(n)}function ne(){if(h&&h.current&&h.current.getList){var r,t=(r=h.current)===null||r===void 0?void 0:r.getList();if(t){var c=[];return t.map(function(v){c.push("".concat(v.name,"=").concat(v.value))}),c.join(`
`)}else return""}else return""}function te(r){var t,c,v,l,M,W={},I={help:r&&r.label?r.label:"",name:"value",label:L.format("createEnvFormValue"),rules:[{required:u.requireValue?!0:(0,O.y)((t=r.rule)===null||t===void 0?void 0:t.kind,B.fp.EnvValueRuleRequired)}],disabled:u.showDisableValue||(0,O.y)((c=r.rule)===null||c===void 0?void 0:c.kind,B.fp.EnvValueRuleDisabled)};if((0,O.y)((v=r.rule)===null||v===void 0?void 0:v.kind,B.fp.EnvValueTypeSelect)){var F;return(0,s.jsx)(E.Z,d()(d()({fieldProps:W},I),{},{initialValue:r.value,width:u.showInDrawer?"sm":"md",options:((F=r.rule)===null||F===void 0?void 0:F.option)&&r.rule.option.map(function(U){return{label:U.name,value:U.value}})}))}else if((0,O.y)((l=r.rule)===null||l===void 0?void 0:l.kind,B.fp.EnvValueTypeSelectMultiple)){var Z;return(0,s.jsx)(E.Z,d()(d()({mode:"tags"},I),{},{fieldProps:W,convertValue:function(q){return Array.isArray(q)?q:q.split(",")},width:u.showInDrawer?"sm":"md",options:((Z=r.rule)===null||Z===void 0?void 0:Z.option)&&r.rule.option.map(function(U){return{label:U.name,value:U.value}})}))}else return(0,O.y)((M=r.rule)===null||M===void 0?void 0:M.kind,B.fp.EnvValueTypeNumber)?(0,s.jsx)(b.Z,d()(d()({fieldProps:W},I),{},{width:u.showInDrawer?"sm":"md",rules:[].concat(p()(I.rules),[{pattern:new RegExp("^[0-9]*$")}]),help:L.format("createEnvFormNumberTip",{name:I.help})})):(0,s.jsx)(b.Z,d()(d()({fieldProps:W},I),{},{width:u.showInDrawer?"sm":"md"}))}return(0,s.jsxs)(S.Z,{ghost:u.showCardGhost,title:u.label?u.label:null,headerBordered:!0,extra:(u.showCodeMode||u.showImportButton)&&(0,s.jsxs)($.Z,{children:[u.showImportButton&&(0,s.jsx)("div",{style:{marginBottom:"-25px"},children:(0,s.jsx)(D.Z,{title:L.format("createEnvFormEnvImport"),onImport:function(t){return ee(t),!0},onLoad:function(t){if(t.indexOf("=")<0)throw new Error(o.FD.format("commonFileIncorrectFormat",{name:"env"}));return!0}})}),u.showCodeMode?(0,s.jsx)(f.ZP,{icon:(0,s.jsx)(R.Z,{}),type:N=="code"?"primary":"default",onClick:re,children:L.format("createEnvFormEnvCode")},"code"):""]}),children:[(0,s.jsx)(K.u,{name:u.name?u.name:"environment",actionRef:h,creatorButtonProps:u.showAddButton?{creatorButtonText:u.addButtonLabel?u.addButtonLabel:L.format("createEnvFormListAddButton")}:!1,copyIconProps:!1,deleteIconProps:u.showDeleteButton,min:100,label:u.listLabel,transform:function(t,c,v){return _()({},c,t.map(function(l){return Array.isArray(l.value)&&(l.value=l.value.filter(function(M){return M!=""}).join(",")),l}))},children:function(t,c,v){var l=v.getCurrentRowData();return(0,s.jsxs)(m.UW,{style:{marginBottom:"5px"},children:[(0,s.jsx)(b.Z,{width:u.showInDrawer?"sm":"md",name:"name",label:L.format("createEnvFormName"),required:!0,rules:[{required:!0}],disabled:u.showDisableName,placeholder:L.format("createEnvFormNameEmpty")}),te(l)]})}}),u.showCodeMode&&(0,s.jsx)(V.Z,{width:a.ob,open:N=="code",onCancel:function(){return A("docker-image")},onOk:function(){ee(z),A("docker-image")},children:(0,s.jsx)(k.ZP,{onChange:function(t){return X(t)},value:ne(),height:a.Ed,theme:"dark"})})]})});g.Z=Y},12491:function(G,g,e){e.d(g,{Z:function(){return $}});var C=e(5574),_=e.n(C),T=e(3616),p=e(24963),i=e(36146),d=e(88484),y=e(57546),j=e(62370),R=e(95089),E=e(42075),b=e(28036),S=e(85576),K=e(67294),m=e(85893);function $(f){var V=(0,K.useContext)(p.Z),P=V.message,k=V.notice,D=(0,K.useRef)(null),B=(0,K.useState)(!1),O=_()(B,2),a=O[0],o=O[1],s=(0,K.useState)(""),n=_()(s,2),Y=n[0],u=n[1],Q=function(){D.current&&(D.current.click(),D.current.onchange=function(w){if(!w||!w.target)return"";var N=new FileReader;N.onload=function(J){var H,z,X=(H=J.target)===null||H===void 0?void 0:H.result;if(f.onLoad)try{f.onLoad&&f.onLoad(X)}catch(L){k.error(L);return}u(X),typeof f.onImport=="function"&&(P.success(i.FD.format("finish")),f.onImport(X)),(z=D.current)!==null&&z!==void 0&&z.value&&(D.current.value="")};var A=w.target;if(A.files&&A.files[0]){var h=A.files[0];try{N.readAsText(h)}catch(J){k.error(i.FD.format("commonContentIncorrectFormat",{name:A.files[0].name}))}}})};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(j.Z,{children:(0,m.jsxs)(E.Z.Compact,{block:!0,children:[(0,m.jsx)(b.ZP,{icon:(0,m.jsx)(d.Z,{}),block:!0,onClick:Q,children:f.title}),f.showPaset&&(0,m.jsx)(b.ZP,{icon:(0,m.jsx)(y.Z,{}),onClick:function(){o(!0)}})]})}),(0,m.jsx)("input",{style:{display:"none"},type:"file",ref:D,name:"importFileInput"}),(0,m.jsx)(S.Z,{width:T.ob,open:a,onClose:function(){o(!1)},onCancel:function(){o(!1)},onOk:function(){typeof f.onImport=="function"&&(P.success(i.FD.format("finish")),f.onImport(Y)),o(!1)},children:(0,m.jsx)(R.ZP,{height:T.Ed,theme:"dark",value:Y,onChange:function(w){u(w)}})})]})}},3616:function(G,g,e){e.d(g,{Ed:function(){return p},FK:function(){return _},R_:function(){return C},ob:function(){return T}});var C=window.innerWidth<=1024?"90vw":"65vw",_="90vw",T="60vw",p="50vh"},24963:function(G,g,e){var C=e(67294),_=(0,C.createContext)({});g.Z=_},62597:function(G,g,e){e.d(g,{$G:function(){return d},Ct:function(){return V},Tb:function(){return b},XH:function(){return K},cl:function(){return R},fp:function(){return j},iE:function(){return $},xb:function(){return k},ze:function(){return B}});var C=e(15009),_=e.n(C),T=e(99289),p=e.n(T),i=e(82346);function d(a){return y.apply(this,arguments)}function y(){return y=p()(_()().mark(function a(o){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/site/create-by-image",{method:"POST",data:o}));case 1:case"end":return n.stop()}},a)})),y.apply(this,arguments)}var j={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192};function R(a){return E.apply(this,arguments)}function E(){return E=p()(_()().mark(function a(o){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/site/get-list",{method:"POST",data:o}));case 1:case"end":return n.stop()}},a)})),E.apply(this,arguments)}function b(a){return S.apply(this,arguments)}function S(){return S=p()(_()().mark(function a(o){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o.download=!1,n.next=3,(0,i.request)("/api/app/log/run",{method:"POST",data:o});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},a)})),S.apply(this,arguments)}function K(a){return m.apply(this,arguments)}function m(){return m=p()(_()().mark(function a(o){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o.download=!0,n.next=3,(0,i.request)("/api/app/log/run",{method:"POST",data:o,responseType:"blob"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},a)})),m.apply(this,arguments)}function $(a){return f.apply(this,arguments)}function f(){return f=p()(_()().mark(function a(o){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o.id=String(o.id),n.next=3,(0,i.request)("/api/app/site/get-detail",{data:o,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},a)})),f.apply(this,arguments)}function V(a){return P.apply(this,arguments)}function P(){return P=p()(_()().mark(function a(o){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/container/delete",{method:"POST",data:o}));case 1:case"end":return n.stop()}},a)})),P.apply(this,arguments)}function k(a){return D.apply(this,arguments)}function D(){return D=p()(_()().mark(function a(o){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/site/delete",{method:"POST",data:o}));case 1:case"end":return n.stop()}},a)})),D.apply(this,arguments)}function B(a){return O.apply(this,arguments)}function O(){return O=p()(_()().mark(function a(o){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/api/app/container/ignore",{method:"POST",data:o}));case 1:case"end":return n.stop()}},a)})),O.apply(this,arguments)}},79245:function(G,g,e){e.d(g,{m:function(){return T},y:function(){return p}});var C=e(64599),_=e.n(C);function T(i){var d=[];if(!i||i=="")return d;var y=i.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),j=_()(y),R;try{for(j.s();!(R=j.n()).done;){var E=R.value;d.push({name:E[1],value:E[2]?E[2].indexOf("-")==0?E[2].substring(1):E[2]:""})}}catch(b){j.e(b)}finally{j.f()}return d}function p(i,d){return!i||!d?!1:(i&d)!==0}}}]);
