"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2628],{54958:function(X,Z,e){e.r(Z),e.d(Z,{default:function(){return Q}});var O=e(15009),F=e.n(O),$=e(99289),I=e.n($),L=e(22191),j=e(24963),s=e(67294);function B(u){var v=(0,s.useContext)(j.Z),f=v.lang;return u.expression.unit=="preWeek"?"".concat(f("cron.week.".concat(u.expression.dayOfWeek),u.expression)).concat(f("cron.".concat(u.expression.unit),u.expression)):f("cron.".concat(u.expression.unit),u.expression)}var D=e(5574),S=e.n(D),p=e(83727),K=e(184),E=e(14726),z=e(63490),x=e(42075),m=e(25593),N=e(55241),n=e(85893),P=(0,s.forwardRef)(function(u,v){var f=(0,s.useState)(!1),g=S()(f,2),C=g[0],R=g[1],l=(0,s.useState)([]),o=S()(l,2),t=o[0],c=o[1],d=(0,s.useContext)(j.Z),i=d.lang;return(0,s.useImperativeHandle)(v,function(){return{}}),(0,s.useEffect)(function(){(0,p.VB)().then(function(a){c(a.data.list)})},[]),(0,n.jsx)(K.a,{name:"templte",title:"\u8BA1\u5212\u4EFB\u52A1\u811A\u672C\u6A21\u677F",open:C,onOpenChange:function(r){R(r)},submitter:!1,trigger:(0,n.jsx)(E.ZP,{children:"\u811A\u672C\u6A21\u677F"}),children:(0,n.jsx)(z.Z,{rowKey:function(r){return"".concat(r.project,"-").concat(r.name)},columns:[{title:"\u540D\u79F0",dataIndex:"name"},{title:"\u5206\u7C7B",dataIndex:"project"},{title:"\u63CF\u8FF0",width:350,dataIndex:"description",render:function(r,h,U){return"".concat(h.description," ").concat(h.tag.indexOf("run-in-dpanel")?"(".concat(i("cron.runInDPanel"),")"):"")}},{title:"\u64CD\u4F5C",width:100,render:function(r,h,U){return(0,n.jsxs)(x.Z,{children:[(0,n.jsx)(m.Z.Link,{onClick:function(){R(!1),u.onFinish&&u.onFinish(h)},children:"\u4F7F\u7528"},"use"),(0,n.jsx)(N.Z,{placement:"left",content:(0,n.jsx)("pre",{children:h.script}),children:(0,n.jsx)(m.Z.Link,{children:"\u9884\u89C8"},"preview")})]})}}],dataSource:t})})}),w=P,G=e(80821),W=e(67255),H=e(86548),J=e(43425),V=e(90078),Y=e(10641),A=e(54006),y=e(66309),M=e(96074),T=e(83062);function Q(){var u=(0,s.useRef)(),v=(0,s.useRef)(),f=(0,s.useRef)(),g=(0,s.useContext)(j.Z),C=g.lang,R=(0,A.useNavigate)();return(0,n.jsx)(V._z,{header:{extra:[(0,n.jsx)(L.Z,{ref:v,onFinish:function(){var o,t;!((o=u.current)===null||o===void 0)&&o.reloadAndRest&&((t=u.current)===null||t===void 0||t.reloadAndRest())},showTriggerButton:!0},"create"),(0,n.jsx)(w,{ref:f,onFinish:function(o){var t;(t=v.current)===null||t===void 0||t.edit({title:"",setting:{script:o.script,environment:o.environment,enableRunBlock:!0,disable:!1,keepLogTotal:10}})}},"template")]},children:(0,n.jsx)(Y.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,W.O)(),columns:[{title:"\u540D\u79F0",dataIndex:"title",render:function(o,t,c,d,i){return(0,n.jsx)(A.Link,{to:"/app/cron/log/"+t.id,children:t.title})}},{title:"\u6267\u884C\u5BB9\u5668",dataIndex:["setting","containerName"],search:!1},{title:"\u6267\u884C\u8BA1\u5212",search:!1,width:300,render:function(o,t,c,d,i){return(0,n.jsx)(x.Z,{direction:"vertical",children:t.setting.expression&&t.setting.expression.map(function(a,r){return(0,n.jsx)(B,{expression:a},"runCron-".concat(r))})})}},{title:"\u4E0B\u6B21\u6267\u884C\u65F6\u95F4",search:!1,width:200,render:function(o,t,c,d,i){return(0,n.jsx)(x.Z,{direction:"vertical",children:t.setting.nextRunTime?t.setting.nextRunTime.map(function(a,r){return(0,n.jsx)(y.Z,{children:new Date(a).toLocaleString()},"runNextTime-".concat(r))}):(0,n.jsx)(y.Z,{color:"error",children:C("cron.error")},"runNextTime-".concat(c))})}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(o,t,c,d,i){return(0,n.jsxs)(x.Z,{split:(0,n.jsx)(M.Z,{type:"vertical"}),children:[(0,n.jsx)(m.Z.Link,{onClick:function(){var r;(r=v.current)===null||r===void 0||r.edit(t)},children:(0,n.jsx)(T.Z,{title:"\u7F16\u8F91",children:(0,n.jsx)(H.Z,{})})},"manage"),(0,n.jsx)(m.Z.Link,{onClick:function(){R("/app/cron/log/"+t.id)},children:(0,n.jsx)(T.Z,{title:"\u8BF4\u60C5",children:(0,n.jsx)(J.Z,{})})},"log")]})}}],request:function(){var l=I()(F()().mark(function o(t,c,d){var i;return F()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,p.SY)({title:t.title,page:t.current,pageSize:t.pageSize});case 2:return i=r.sent,r.abrupt("return",{data:i.data.list,success:!0,total:i.data.total});case 4:case"end":return r.stop()}},o)}));return function(o,t,c){return l.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:u,tableAlertOptionRender:function(o){var t=o.selectedRowKeys,c=o.selectedRows;return(0,n.jsx)(x.Z,{size:16,children:(0,n.jsx)(G.Z,{danger:!0,type:"primary",action:function(){return(0,p.Ji)({id:c.map(function(i){return i.id})})},onSuccess:function(){var i,a;return!((i=u.current)===null||i===void 0)&&i.reloadAndRest&&((a=u.current)===null||a===void 0||a.reloadAndRest()),!0},onError:function(){var i,a;return!((i=u.current)===null||i===void 0)&&i.reset&&((a=u.current)===null||a===void 0||a.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"},"delete")})}})})}}}]);
