"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4202],{45742:function(y,M,e){e.d(M,{Z:function(){return P}});var C=e(87462),i=e(67294),v={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656zM492 400h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 144h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H492c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zM340 368a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0zm0 144a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"profile",theme:"outlined"},d=v,m=e(84089),T=function(r,L){return i.createElement(m.Z,(0,C.Z)({},r,{ref:L,icon:d}))},j=i.forwardRef(T),P=j},80821:function(y,M,e){e.d(M,{Z:function(){return D}});var C=e(5574),i=e.n(C),v=e(24963),d=e(86738),m=e(28036),T=e(83062),j=e(67294),P=e(85893);function D(r){var L=(0,j.useState)(!1),u=i()(L,2),O=u[0],a=u[1],s=(0,j.useContext)(v.Z),A=s.lang,g=s.notice,x=s.message,R=function(){a(!0),r.action().then(function(f){if(a(!1),f){typeof r.onSuccess=="function"&&r.onSuccess(f);var h="";r.messageSuccess?typeof r.messageSuccess=="function"?h=r.messageSuccess(f):h=r.messageSuccess.indexOf("notification.")==0?A(r.messageSuccess):r.messageSuccess:h=A("notification.finish"),r.asynced?x.info(h):x.success(h)}}).catch(function(f){a(!1),typeof r.onError=="function"&&r.onError(f)})};return r.confirm?(0,P.jsx)(d.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:A("notification.title.tip"),description:typeof r.confirm=="string"&&r.confirm.indexOf("notification.")==0?A(r.confirm):r.confirm,onConfirm:R,okText:"Yes",cancelText:"No",children:(0,P.jsx)(m.ZP,{disabled:r.disabled,icon:r.icon,loading:O,danger:r.danger,type:r.type,children:r.children})}):(0,P.jsx)(T.Z,{title:r.tips,children:(0,P.jsx)(m.ZP,{style:r.ghost?{padding:0,height:"auto"}:{},disabled:r.disabled,icon:r.icon,loading:O,onClick:R,danger:r.danger,type:r.type,children:r.children})})}},94359:function(y,M,e){e.d(M,{Z:function(){return O}});var C=e(67294),i=e(3089),v=e(98165),d=e(18429),m=e(8751),T=e(14313),j=e(30159),P=e(87740),D=e(66309),r=e(83062),L=e(63713),u=e(85893);function O(a){var s=(0,u.jsx)(u.Fragment,{});if(a.status=="0"&&(s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(i.Z,{}),color:"default",children:"waiting"})),a.status=="10"&&(s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(v.Z,{spin:!0}),color:"processing",children:"processing"})),a.status=="20"&&(s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(d.Z,{}),color:"error",children:"error"})),a.status=="30"&&(s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(m.Z,{}),color:"success",children:"success"})),a.status=="running"||a.status=="healthy"){var A,g;s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(T.Z,{}),color:"success",children:(A=a.message)!==null&&A!==void 0&&A.showInTag?(g=a.message)===null||g===void 0?void 0:g.content:a.status})}if(a.status=="paused"){var x,R;s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(j.Z,{}),children:(x=a.message)!==null&&x!==void 0&&x.showInTag?(R=a.message)===null||R===void 0?void 0:R.content:a.status})}if(a.status=="waiting"||a.status=="starting"){var W,f;s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(P.Z,{}),children:(W=a.message)!==null&&W!==void 0&&W.showInTag?(f=a.message)===null||f===void 0?void 0:f.content:a.status})}if(a.status=="exited"||a.status=="dead"||a.status=="removing"||a.status=="restarting"||a.status=="unhealthy"||a.status=="created"){var h,c;s=(0,u.jsx)(D.Z,{icon:(0,u.jsx)(d.Z,{}),color:"warning",children:(h=a.message)!==null&&h!==void 0&&h.showInTag?(c=a.message)===null||c===void 0?void 0:c.content:a.status})}if(a.link&&(s=(0,u.jsx)(L.Link,{to:a.link,children:s})),a.message){var t;s=(0,u.jsx)(r.Z,{placement:(t=a.message.placement)!==null&&t!==void 0?t:"top",title:a.message.content,children:s})}return(0,u.jsx)(u.Fragment,{children:s})}},74344:function(y,M,e){var C=e(5574),i=e.n(C),v=e(37476),d=e(38345),m=e(63713),T=e(67294),j=e(54964),P=e(85893),D=(0,T.forwardRef)(function(r,L){(0,T.useImperativeHandle)(L,function(){return{start:function(){for(var c=arguments.length,t=new Array(c),E=0;E<c;E++)t[E]=arguments[E];R(t.join(":")),s(!0)},reset:function(){var c;(c=f.current)===null||c===void 0||c.clear(),s(!1)},show:function(c){var t,E;(t=f.current)===null||t===void 0||t.clear(),(E=f.current)===null||E===void 0||E.write(c),s(!0)}}});var u=(0,T.useState)(!1),O=i()(u,2),a=O[0],s=O[1],A=(0,T.useState)(""),g=i()(A,2),x=g[0],R=g[1],W=(0,m.useModel)("subscriber"),f=(0,T.useRef)();return W.addDataHandler("image:"+x,function(h){var c;(c=f.current)===null||c===void 0||c.write(h.data)}),(0,T.useEffect)(function(){var h;(h=f.current)===null||h===void 0||h.fit()},[]),(0,P.jsx)(v.Y,{modalProps:{forceRender:!0},title:"\u6784\u5EFA\u65E5\u5FD7",submitter:!1,width:1e3,onOpenChange:function(c){if(s(c),c){var t,E;(t=f.current)===null||t===void 0||t.clear(),(E=f.current)===null||E===void 0||E.fit()}},open:a,children:(0,P.jsx)(d.Z,{ghost:!0,children:(0,P.jsx)(j.Z,{showInModal:!0,width:"960px",height:"500px",ref:f})})})});M.Z=D},78451:function(y,M,e){e.d(M,{Z:function(){return v}});var C=e(67294),i=e(85893);function v(d){return(0,i.jsx)("span",{style:{width:d.width?d.width:"auto",wordBreak:"break-word"},children:d.content})}},54964:function(y,M,e){e.d(M,{a:function(){return u}});var C=e(5574),i=e.n(C),v=e(78267),d=e.n(v),m=e(75458),T=e.n(m),j=e(67294),P=e(12320),D=e.n(P),r=e(89629),L=e(85893),u={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},O=new P.Terminal(u),a=new m.SearchAddon,s=new v.FitAddon,A=(0,j.forwardRef)(function(g,x){var R,W=(0,j.useState)(!0),f=i()(W,2),h=f[0],c=f[1];return(0,j.useEffect)(function(){return window.addEventListener("resize",function(){g.showInModal||s.fit()}),g.style&&g.style.fontSize&&(O.options.fontSize=g.style.fontSize),O.loadAddon(s),O.loadAddon(a),O.open(document.getElementById("terminal-container")),g.showInModal||s.fit(),function(){O.clear(),c(!0)}},[]),(0,j.useImperativeHandle)(x,function(){return{write:function(E){h&&(s.fit(),c(!1)),O.write(E)},clear:function(){O.clear()},getTerminal:function(){return O},findNext:function(E){a.findNext(E)},findPrev:function(E){a.findPrevious(E)},fit:function(){s.fit()},onData:function(E){O.onData(E)}}}),(0,L.jsx)("div",{id:"terminal-container",style:{width:g.width?g.width:"100%",height:g.height?g.height:"500px",marginTop:(R=g.style)===null||R===void 0?void 0:R.marginTop}})});M.Z=A},24963:function(y,M,e){var C=e(67294),i=(0,C.createContext)({});M.Z=i},52548:function(y,M,e){e.r(M),e.d(M,{default:function(){return E}});var C=e(15009),i=e.n(C),v=e(99289),d=e.n(v),m=e(90078),T=e(10641),j=e(28036),P=e(42075),D=e(83062),r=e(66309),L=e(96074),u=e(25593),O=e(50136),a=e(63713),s=e(18148),A=e(94359),g=e(43425),x=e(45742),R=e(80821),W=e(67294),f=e(67255),h=e(78451),c=e(74344),t=e(85893);function E(){var _=(0,W.useRef)(),I=(0,W.useRef)();return(0,t.jsxs)(m._z,{header:{extra:[(0,t.jsx)(j.ZP,{type:"primary",children:(0,t.jsx)(a.Link,{to:"/image/create",children:"\u521B\u5EFA\u955C\u50CF"})},"create"),(0,t.jsx)(j.ZP,{children:"\u62C9\u53D6\u955C\u50CF"},"pull")]},children:[(0,t.jsx)(T.Z,{scroll:{x:"max-content"},actionRef:_,rowKey:"id",columns:[{title:"\u540D\u79F0",render:function(n,o,K,U){return(0,t.jsx)(P.Z,{direction:"vertical",style:{textAlign:"left"},children:o.imageInfo&&o.imageInfo.info.Id?(0,t.jsx)(a.Link,{to:"/image/detail/".concat(o.imageInfo.info.Id),children:(0,t.jsxs)(D.Z,{title:"\u67E5\u770B\u955C\u50CF",children:[" ",o.title]})},"detail"):o.title},o.id)}},{title:"\u6700\u65B0Tag",dataIndex:"tag",search:!1,render:function(n,o,K,U){return o.imageInfo?o.imageInfo.info.Id==""?(0,t.jsx)(r.Z,{children:"none"},"none"):(0,t.jsx)(P.Z,{direction:"vertical",style:{textAlign:"left"},children:o.imageInfo.info.RepoTags.map(function(B,S){return(0,t.jsx)(r.Z,{color:"#2db7f5",children:B},S)})},o.id):(0,t.jsx)(r.Z,{color:"#2db7f5",children:o.tag},o.id)}},{title:"\u955C\u50CFId",search:!1,copyable:!0,width:300,render:function(n,o,K,U,B){return(0,t.jsx)(h.Z,{content:o.imageInfo&&o.imageInfo.info.Id})}},{title:"\u6784\u5EFA\u72B6\u6001",width:150,ellipsis:!0,search:!1,render:function(n,o,K,U){return[(0,t.jsx)("div",{children:(0,t.jsx)(A.Z,{status:o.status},o.id)},o.id)]}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:150,render:function(n,o,K,U){return(0,t.jsxs)(P.Z,{split:(0,t.jsx)(L.Z,{type:"vertical"}),children:[(0,t.jsx)(a.Link,{to:"/image/create?id="+o.id,type:"link",children:(0,t.jsx)(D.Z,{title:"\u518D\u6B21\u6784\u5EFA",children:(0,t.jsx)(g.Z,{})})},"rebuild"),(0,t.jsx)(u.Z.Link,{onClick:function(){var S;(S=I.current)===null||S===void 0||S.show(o.message)},children:(0,t.jsx)(D.Z,{title:"\u6784\u5EFA\u65E5\u5FD7",children:(0,t.jsx)(x.Z,{})})},"logs")]})}}],request:function(){var l=d()(i()().mark(function n(o,K,U){var B,S,b;return i()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,s.Xn)({page:(B=o.current)!==null&&B!==void 0?B:1,pageSize:(S=o.pageSize)!==null&&S!==void 0?S:10});case 2:return b=Z.sent,Z.abrupt("return",{data:b.data.list,success:!0,total:b.data.total});case 4:case"end":return Z.stop()}},n)}));return function(n,o,K){return l.apply(this,arguments)}}(),pagination:(0,f.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(n){var o=n.selectedRowKeys;return(0,t.jsx)(P.Z,{size:16,children:(0,t.jsx)(R.Z,{danger:!0,type:"primary",action:function(){return(0,s.$q)({id:o})},onSuccess:function(){var U,B;return!((U=_.current)===null||U===void 0)&&U.reloadAndRest&&((B=_.current)===null||B===void 0||B.reloadAndRest()),!0},onError:function(){var U,B;return!((U=_.current)===null||U===void 0)&&U.reset&&((B=_.current)===null||B===void 0||B.reset()),!0},confirm:"notification.confirm.title",children:"\u6279\u91CF\u5220\u9664"})})},tableExtraRender:function(){return(0,t.jsx)(O.Z,{mode:"horizontal",selectedKeys:["build"],items:[{label:(0,t.jsx)(a.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,t.jsx)(a.Link,{to:"/image/list/build",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})}}),(0,t.jsx)(c.Z,{ref:I})]})}},18148:function(y,M,e){e.d(M,{$q:function(){return a},Fj:function(){return h},KG:function(){return T},KX:function(){return t},T8:function(){return u},Xn:function(){return r},ao:function(){return A},c5:function(){return W},c7:function(){return x}});var C=e(15009),i=e.n(C),v=e(99289),d=e.n(v),m=e(63713);function T(_){return j.apply(this,arguments)}function j(){return j=d()(i()().mark(function _(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/app/image/get-list",{method:"POST",data:I}));case 1:case"end":return n.stop()}},_)})),j.apply(this,arguments)}function P(_){return D.apply(this,arguments)}function D(){return D=_asyncToGenerator(_regeneratorRuntime().mark(function _(I){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,request("/api/app/log/image-build",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},_)})),D.apply(this,arguments)}function r(_){return L.apply(this,arguments)}function L(){return L=d()(i()().mark(function _(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/app/image/get-list-build",{method:"POST",data:I}));case 1:case"end":return n.stop()}},_)})),L.apply(this,arguments)}function u(_){return O.apply(this,arguments)}function O(){return O=d()(i()().mark(function _(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,m.request)("/api/app/image/get-build-task",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},_)})),O.apply(this,arguments)}function a(_){return s.apply(this,arguments)}function s(){return s=d()(i()().mark(function _(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,m.request)("/api/app/image/delete-build-task",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},_)})),s.apply(this,arguments)}function A(_){return g.apply(this,arguments)}function g(){return g=d()(i()().mark(function _(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,m.request)("/api/app/image/image-delete",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},_)})),g.apply(this,arguments)}function x(){return R.apply(this,arguments)}function R(){return R=d()(i()().mark(function _(){return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,m.request)("/api/app/image/image-prune",{method:"POST"});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},_)})),R.apply(this,arguments)}function W(){return f.apply(this,arguments)}function f(){return f=d()(i()().mark(function _(){return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,m.request)("/api/app/image/build-prune",{method:"POST"});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},_)})),f.apply(this,arguments)}function h(_){return c.apply(this,arguments)}function c(){return c=d()(i()().mark(function _(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,m.request)("/api/app/image/update-title",{method:"POST",data:I});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},_)})),c.apply(this,arguments)}function t(_){return E.apply(this,arguments)}function E(){return E=d()(i()().mark(function _(I){return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/app/image/tag-sync",{method:"POST",data:I}));case 1:case"end":return n.stop()}},_)})),E.apply(this,arguments)}},67255:function(y,M,e){e.d(M,{O:function(){return C},j:function(){return i}});function C(){var v=localStorage.getItem("dpanel-pagesize");return v=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(v!=null?v:"20")}}function i(v){var d="dpanel-table-column-".concat(v),m={};if(localStorage.getItem(d)){var T;m=JSON.parse((T=localStorage.getItem(d))!==null&&T!==void 0?T:"{}")}return{defaultValue:m,onChange:function(P){localStorage.setItem("dpanel-table-column-".concat(v),JSON.stringify(P))}}}}}]);
