(self.webpackChunk=self.webpackChunk||[]).push([[4214],{80821:function(Z,I,e){"use strict";e.d(I,{Z:function(){return B}});var b=e(5574),d=e.n(b),v=e(24963),m=e(86738),h=e(28036),A=e(83062),T=e(67294),p=e(85893);function B(a){var u=(0,T.useState)(!1),s=d()(u,2),R=s[0],o=s[1],f=(0,T.useContext)(v.Z),O=f.lang,y=f.notice,_=f.message,j=function(){o(!0);var g=a.action();g instanceof Promise?g.then(function(P){if(o(!1),P){typeof a.onSuccess=="function"&&a.onSuccess(P);var t="";a.messageSuccess?typeof a.messageSuccess=="function"?t=a.messageSuccess(P):t=a.messageSuccess.indexOf("notification.")==0?O(a.messageSuccess):a.messageSuccess:t=O("notification.finish"),a.asynced?_.info(t):_.success(t)}}).catch(function(P){o(!1),typeof a.onError=="function"&&a.onError(P)}):o(!1)};return a.confirm?(0,p.jsx)(m.Z,{style:{width:500},title:a.confirmTitle?a.confirmTitle:O("notification.title.tip"),description:typeof a.confirm=="string"&&a.confirm.indexOf("notification.")==0?O(a.confirm):a.confirm,onConfirm:j,okText:"Yes",cancelText:"No",onOpenChange:a.confirmOnOpenChange,children:(0,p.jsx)(h.ZP,{block:a.block,disabled:a.disabled,icon:a.icon,loading:R,danger:a.danger,type:a.type,children:a.children})}):(0,p.jsx)(A.Z,{title:a.tips,children:(0,p.jsx)(h.ZP,{block:a.block,style:a.ghost?{padding:0,height:"auto"}:{},disabled:a.disabled,icon:a.icon,loading:R,onClick:j,danger:a.danger,type:a.type,children:a.children})})}},92754:function(Z,I,e){"use strict";var b=e(5574),d=e.n(b),v=e(67294),m=e(82346),h=e(38703),A=e(85893),T=(0,v.forwardRef)(function(p,B){var a=(0,v.useState)(""),u=d()(a,2),s=u[0],R=u[1];(0,v.useImperativeHandle)(B,function(){return{setFinish:function(){_({finish:{downloading:100,extracting:100}})},setStart:function(l){l&&R(l),_({start:{downloading:0,extracting:0}})},close:function(){o.progress.close("image:pull:"+s),_({start:{downloading:0,extracting:0}})}}});var o=(0,m.useModel)("subscriber");o.addDataHandler("image:pull:"+s,function(j){_(j.data)});var f=(0,v.useState)(),O=d()(f,2),y=O[0],_=O[1];return(0,v.useEffect)(function(){return _({start:{downloading:0,extracting:0}}),function(){o.progress.close("image:pull:"+s)}},[]),(0,A.jsx)(A.Fragment,{children:y&&Object.keys(y).map(function(j){return(0,A.jsx)(h.Z,{percent:y[j].downloading,success:{percent:y[j].extracting}},j)})})});I.Z=T},31810:function(Z,I,e){"use strict";e.r(I),e.d(I,{default:function(){return me}});var b=e(19632),d=e.n(b),v=e(15009),m=e.n(v),h=e(99289),A=e.n(h),T=e(5574),p=e.n(T),B=e(90078),a=e(78099),u=e(37476),s=e(62370),R=e(5966),o=e(31418),f=e(28036),O=e(25593),y=e(42075),_=e(66309),j=e(96074),l=e(83062),g=e(84567),P=e(50136),t=e(67294),w=e(82346),K=e(18148),H=e(5251),N=e(80821),q=e(43425),ee=e(87462),te=e(3803),ne=e(84089),ae=function(G,V){return t.createElement(ne.Z,(0,ee.Z)({},G,{ref:V,icon:te.Z}))},re=t.forwardRef(ae),ue=re,se=e(58638),oe=e(1912),ie=e(28307),le=e(96042),Y=e(67255),ce=e(24963),de=e(3393),fe=e(93162),r=e(85893);function me(){var z=(0,t.useContext)(ce.Z),G=z.message,V=z.notice,ge=z.lang,F=(0,t.useRef)(),ve=(0,t.useState)({force:!1}),X=p()(ve,2),he=X[0],pe=X[1],je=o.Z.useApp(),Ee=(0,t.useState)(1),J=p()(Ee,2),Q=J[0],Re=J[1],k=(0,t.useRef)();return(0,t.useEffect)(function(){var C;(C=F.current)===null||C===void 0||C.reload()},[Q]),(0,r.jsx)(B._z,{header:{extra:[(0,r.jsx)(w.Link,{to:"/image/create",children:(0,r.jsx)(f.ZP,{type:"primary",children:"\u521B\u5EFA&\u5BFC\u5165\u955C\u50CF"},"create")},"create"),(0,r.jsx)(ie.Z,{onFinish:function(){var E,n;!((E=F.current)===null||E===void 0)&&E.reloadAndRest&&((n=F.current)===null||n===void 0||n.reloadAndRest())}},"remote")]},children:(0,r.jsx)(a.Z,{scroll:{x:"max-content"},rowKey:"Id",columns:[{title:"\u540D\u79F0",dataIndex:"title",render:function(E,n,x,S,i){var c=n.Id.substring(7,19);return n.Title&&(c=n.Title),(0,r.jsx)(O.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u955C\u50CF\u5907\u6CE8\u540D\u79F0",onChange:function(){var D=A()(m()().mark(function U(W){var L;return m()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,K.Fj)({tag:n.RepoTags[0],title:W});case 2:L=$.sent,Re(Q+1),G.success("\u4FEE\u6539\u955C\u50CF\u540D\u79F0\u6210\u529F");case 5:case"end":return $.stop()}},U)}));function M(U){return D.apply(this,arguments)}return M}()},children:(0,r.jsx)(w.Link,{to:"/image/detail/"+n.Id,children:c},"edit")},"title-".concat(x))}},{title:"Tag",dataIndex:"tag",render:function(E,n,x,S){return(0,r.jsx)(y.Z,{direction:"vertical",style:{textAlign:"left"},children:n.RepoTags.map(function(i,c){return(0,r.jsxs)(y.Z,{children:[(0,r.jsx)(_.Z,{color:"#2db7f5",children:(0,r.jsx)(O.Z.Text,{copyable:!0,title:i,style:{color:"#ffffff"},children:i},"tag-"+c)},"tag-".concat(c)),n.Containers>0&&(0,r.jsx)(_.Z,{color:"cyan",children:"\u4F7F\u7528\u4E2D"},"use-".concat(c))]},c)})},n.Id)}},{title:"\u67B6\u6784",width:80,search:!1,render:function(E,n,x,S,i){if(n.Labels&&n.Labels["com.dpanel.image.arch"])return(0,r.jsx)(_.Z,{children:n.Labels["com.dpanel.image.arch"]},"arch"+n.Id)}},{title:"\u5927\u5C0F",dataIndex:"size",ellipsis:!0,width:"120px",search:!1,sorter:function(E,n){return parseFloat(E.Size)-parseFloat(n.Size)},render:function(E,n,x,S){return(0,r.jsx)("div",{children:(0,H.FI)(parseFloat(n.Size))},n.Id)}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(E,n,x,S){return(0,r.jsx)("div",{children:(0,H.ZM)(n.Created*1e3)},n.Id)},sorter:function(E,n){return E.Created-n.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,fixed:"right",render:function(E,n,x,S){return(0,r.jsxs)(y.Z,{split:(0,r.jsx)(j.Z,{type:"vertical"}),children:[(0,r.jsx)(w.Link,{to:"/image/detail/"+n.Id,children:(0,r.jsx)(l.Z,{title:"\u7BA1\u7406",children:(0,r.jsx)(q.Z,{})})},"edit"),(0,r.jsx)(w.Link,{to:"/app/create/image?imageId="+n.RepoTags[0],children:(0,r.jsx)(l.Z,{title:"\u521B\u5EFA\u5BB9\u5668",children:(0,r.jsx)(ue,{})})},"create")]})}}],request:function(){var C=A()(m()().mark(function E(n,x,S){var i;return m()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,K.KG)({tag:n.tag,title:n.title});case 2:if(i=D.sent,!(!i||!i.data||!i.data.list)){D.next=5;break}return D.abrupt("return",{data:[],success:!0,total:0});case 5:return i.data.list.map(function(M){var U="";M.RepoTags.map(function(W){i.data.title[W]&&(U=i.data.title[W])}),M.Title=U}),D.abrupt("return",{data:i.data.list,success:!0,total:i.data.list.length});case 7:case"end":return D.stop()}},E)}));return function(E,n,x){return C.apply(this,arguments)}}(),pagination:(0,Y.O)(),search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:F,tableAlertOptionRender:function(E){var n=E.selectedRowKeys,x=E.selectedRows;return(0,r.jsxs)(y.Z,{size:16,children:[(0,r.jsx)(N.Z,{icon:(0,r.jsx)(se.Z,{}),action:function(){var i=[];return x.map(function(c){i.push.apply(i,d()(c.RepoTags))}),(0,de.Rb)({md5:i})},onSuccess:function(i){var c=x.map(function(M){return M.RepoTags[0]}),D=new Blob([i],{type:"application/tar"});(0,fe.saveAs)(D,c.join("-")+".tar")},children:"\u5BFC\u51FA"}),(0,r.jsxs)(u.Y,{formRef:k,title:"\u6279\u91CF\u63A8\u9001\u955C\u50CF",trigger:(0,r.jsx)(f.ZP,{icon:(0,r.jsx)(oe.Z,{}),children:"\u540C\u6B65\u81F3\u5176\u5B83\u4ED3\u5E93"}),onFinish:function(){var S=A()(m()().mark(function i(c){var D,M,U;return m()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,K.KX)({md5:n,registryId:c.registryId,newNamespace:c.newNamespace});case 2:return U=L.sent,(D=F.current)===null||D===void 0||D.reload(),!((M=F.current)===null||M===void 0)&&M.clearSelected&&F.current.clearSelected(),L.abrupt("return",!0);case 6:case"end":return L.stop()}},i)}));return function(i){return S.apply(this,arguments)}}(),children:[(0,r.jsx)(s.Z,{name:"registryId",hidden:!0}),(0,r.jsx)(s.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,r.jsxs)(r.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,r.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,r.jsx)(le.Z,{multiple:!0,top:!0,onChangeList:function(i){var c;(c=k.current)===null||c===void 0||c.setFieldValue("registryId",i.map(function(D){return D.id}))}})}),(0,r.jsx)(R.Z,{tooltip:"\u53EF\u4EE5\u901A\u8FC7\u6B64\u9879\u91CD\u65B0\u5B9A\u4E49\u547D\u540D\u7A7A\u95F4\uFF0Cdocker hub \u4E0D\u53D7\u8BE5\u914D\u7F6E\u7684\u5F71\u54CD\u3002 \u914D\u7F6E\u6B64\u9879\u540E mysql:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/mysql:latest\uFF0C dpanel/dpanel:latest \u4F1A\u63A8\u9001\u81F3 {\u547D\u540D\u7A7A\u95F4}/dpanel:latest",label:"\u91CD\u5199\u4ED3\u5E93\u547D\u540D\u7A7A\u95F4",name:"newNamespace"})]}),(0,r.jsx)(N.Z,{danger:!0,type:"primary",action:function(){return(0,K.ao)({md5:n,force:he.force})},onSuccess:function(){var i,c;return!((i=F.current)===null||i===void 0)&&i.reloadAndRest&&((c=F.current)===null||c===void 0||c.reloadAndRest()),!0},onError:function(){var i,c;return!((i=F.current)===null||i===void 0)&&i.reset&&((c=F.current)===null||c===void 0||c.reset()),!0},confirm:(0,r.jsxs)(y.Z,{style:{width:280},direction:"vertical",children:[(0,r.jsx)(O.Z.Text,{children:ge("notification.confirm.title")}),(0,r.jsx)(g.Z,{name:"deleteVolume",onChange:function(i){return pe({force:i.target.checked})},children:"\u5F3A\u5236\u5220\u9664\uFF1F"})]}),children:"\u6279\u91CF\u5220\u9664"})]})},tableExtraRender:function(){return(0,r.jsx)(P.Z,{mode:"horizontal",selectedKeys:["all"],items:[{label:(0,r.jsx)(w.Link,{to:"/image/list",replace:!0,children:"\u5168\u90E8\u955C\u50CF"}),key:"all"},{label:(0,r.jsx)(w.Link,{to:"/image/list/recycle",replace:!0,children:"\u6784\u5EFA\u4EFB\u52A1"}),key:"build"}]})},toolBarRender:function(){return[(0,r.jsx)(N.Z,{action:function(){return(0,K.c7)()},onSuccess:function(){var n,x;return!((n=F.current)===null||n===void 0)&&n.reloadAndRest&&((x=F.current)===null||x===void 0||x.reloadAndRest()),!0},onError:function(){var n,x;return!((n=F.current)===null||n===void 0)&&n.reset&&((x=F.current)===null||x===void 0||x.reset()),!0},confirm:"notification.confirm.title",children:"\u6E05\u7406\u672A\u4F7F\u7528\u955C\u50CF"})]},columnsState:(0,Y.j)("image-list")})})}},3393:function(Z,I,e){"use strict";e.d(I,{Gb:function(){return p},Pn:function(){return s},Rb:function(){return o},YU:function(){return A},ZQ:function(){return _},_U:function(){return a},cd:function(){return O}});var b=e(15009),d=e.n(b),v=e(99289),m=e.n(v),h=e(82346);function A(l){return T.apply(this,arguments)}function T(){return T=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.request)("/api/app/image/get-detail",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),T.apply(this,arguments)}function p(l){return B.apply(this,arguments)}function B(){return B=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.request)("/api/app/image/tag-remote",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),B.apply(this,arguments)}function a(l){return u.apply(this,arguments)}function u(){return u=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.request)("/api/app/image/tag-add",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),u.apply(this,arguments)}function s(l){return R.apply(this,arguments)}function R(){return R=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.request)("/api/app/image/tag-delete",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),R.apply(this,arguments)}function o(l){return f.apply(this,arguments)}function f(){return f=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.request)("/api/app/image/export",{method:"POST",data:g,responseType:"blob"}));case 1:case"end":return t.stop()}},l)})),f.apply(this,arguments)}function O(l){return y.apply(this,arguments)}function y(){return y=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.request)("/api/pro/image/get-remote-tag",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),y.apply(this,arguments)}function _(l){return j.apply(this,arguments)}function j(){return j=m()(d()().mark(function l(g){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.request)("/api/app/image/check-upgrade",{method:"POST",data:g}));case 1:case"end":return t.stop()}},l)})),j.apply(this,arguments)}},67255:function(Z,I,e){"use strict";e.d(I,{O:function(){return b},j:function(){return d}});function b(){var v=localStorage.getItem("dpanel-pagesize");return v=="all"?!1:{showSizeChanger:!0,defaultPageSize:parseInt(v!=null?v:"20")}}function d(v){var m="dpanel-table-column-".concat(v),h={};if(localStorage.getItem(m)){var A;h=JSON.parse((A=localStorage.getItem(m))!==null&&A!==void 0?A:"{}")}return{defaultValue:h,onChange:function(p){localStorage.setItem("dpanel-table-column-".concat(v),JSON.stringify(p))}}}},93162:function(Z,I,e){var b,d,v;(function(m,h){d=[],b=h,v=typeof b=="function"?b.apply(I,d):b,v!==void 0&&(Z.exports=v)})(this,function(){"use strict";function m(u,s){return typeof s=="undefined"?s={autoBom:!1}:typeof s!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function h(u,s,R){var o=new XMLHttpRequest;o.open("GET",u),o.responseType="blob",o.onload=function(){a(o.response,s,R)},o.onerror=function(){console.error("could not download file")},o.send()}function A(u){var s=new XMLHttpRequest;s.open("HEAD",u,!1);try{s.send()}catch(R){}return 200<=s.status&&299>=s.status}function T(u){try{u.dispatchEvent(new MouseEvent("click"))}catch(R){var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(s)}}var p=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof e.g=="object"&&e.g.global===e.g?e.g:void 0,B=p.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=p.saveAs||(typeof window!="object"||window!==p?function(){}:"download"in HTMLAnchorElement.prototype&&!B?function(u,s,R){var o=p.URL||p.webkitURL,f=document.createElement("a");s=s||u.name||"download",f.download=s,f.rel="noopener",typeof u=="string"?(f.href=u,f.origin===location.origin?T(f):A(f.href)?h(u,s,R):T(f,f.target="_blank")):(f.href=o.createObjectURL(u),setTimeout(function(){o.revokeObjectURL(f.href)},4e4),setTimeout(function(){T(f)},0))}:"msSaveOrOpenBlob"in navigator?function(u,s,R){if(s=s||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(m(u,R),s);else if(A(u))h(u,s,R);else{var o=document.createElement("a");o.href=u,o.target="_blank",setTimeout(function(){T(o)})}}:function(u,s,R,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof u=="string")return h(u,s,R);var f=u.type==="application/octet-stream",O=/constructor/i.test(p.HTMLElement)||p.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||f&&O||B)&&typeof FileReader!="undefined"){var _=new FileReader;_.onloadend=function(){var g=_.result;g=y?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=g:location=g,o=null},_.readAsDataURL(u)}else{var j=p.URL||p.webkitURL,l=j.createObjectURL(u);o?o.location=l:location.href=l,o=null,setTimeout(function(){j.revokeObjectURL(l)},4e4)}});p.saveAs=a.saveAs=a,Z.exports=a})}}]);
