"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7667],{35995:function(K,I,e){e.d(I,{Z:function(){return T}});var A=e(87462),a=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M508 624a112 112 0 00112-112c0-3.28-.15-6.53-.43-9.74L498.26 623.57c3.21.28 6.45.43 9.74.43zm370.72-458.44L836 122.88a8 8 0 00-11.31 0L715.37 232.23Q624.91 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.7 119.43 136.55 191.45L112.56 835a8 8 0 000 11.31L155.25 889a8 8 0 0011.31 0l712.16-712.12a8 8 0 000-11.32zM332 512a176 176 0 01258.88-155.28l-48.62 48.62a112.08 112.08 0 00-140.92 140.92l-48.62 48.62A175.09 175.09 0 01332 512z"}},{tag:"path",attrs:{d:"M942.2 486.2Q889.4 375 816.51 304.85L672.37 449A176.08 176.08 0 01445 676.37L322.74 798.63Q407.82 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5z"}}]},name:"eye-invisible",theme:"filled"},h=j,f=e(84089),p=function(u,E){return a.createElement(f.Z,(0,A.Z)({},u,{ref:E,icon:h}))},v=a.forwardRef(p),T=v},29158:function(K,I,e){e.d(I,{Z:function(){return T}});var A=e(87462),a=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"}}]},name:"link",theme:"outlined"},h=j,f=e(84089),p=function(u,E){return a.createElement(f.Z,(0,A.Z)({},u,{ref:E,icon:h}))},v=a.forwardRef(p),T=v},74842:function(K,I,e){e.d(I,{Z:function(){return T}});var A=e(87462),a=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},h=j,f=e(84089),p=function(u,E){return a.createElement(f.Z,(0,A.Z)({},u,{ref:E,icon:h}))},v=a.forwardRef(p),T=v},87784:function(K,I,e){e.d(I,{Z:function(){return T}});var A=e(87462),a=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},h=j,f=e(84089),p=function(u,E){return a.createElement(f.Z,(0,A.Z)({},u,{ref:E,icon:h}))},v=a.forwardRef(p),T=v},88484:function(K,I,e){e.d(I,{Z:function(){return T}});var A=e(87462),a=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},h=j,f=e(84089),p=function(u,E){return a.createElement(f.Z,(0,A.Z)({},u,{ref:E,icon:h}))},v=a.forwardRef(p),T=v},99861:function(K,I,e){var A=e(15009),a=e.n(A),j=e(64599),h=e.n(j),f=e(99289),p=e.n(f),v=e(5574),T=e.n(v),_=e(42119),u=e(67294),E=e(92754),l=e(3393),B=e(184),n=e(38345),i=e(85893),D=(0,u.forwardRef)(function(o,x){(0,u.useImperativeHandle)(x,function(){return{start:function(){Q(!0)}}});var m=(0,u.useState)(0),L=T()(m,2),F=L[0],Z=L[1],M=(0,u.useRef)(),b=(0,u.useState)(!1),N=T()(b,2),Y=N[0],Q=N[1];return(0,i.jsxs)(B.a,{trigger:o.trigger,width:800,open:Y,submitter:!1,title:"\u4E00\u952E\u62C9\u53D6\u955C\u50CF",onOpenChange:function(){var $=p()(a()().mark(function w(k){var R,s,g,O,t,H,q;return a()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(Q(k),!k){S.next=26;break}s=0,g=h()(o.image),S.prev=4,g.s();case 6:if((O=g.n()).done){S.next=16;break}return H=O.value,Z(s),(t=M.current)===null||t===void 0||t.setStart(H),S.next=12,(0,l.Gb)({tag:H,type:"pull"});case 12:q=S.sent,s++;case 14:S.next=6;break;case 16:S.next=21;break;case 18:S.prev=18,S.t0=S.catch(4),g.e(S.t0);case 21:return S.prev=21,g.f(),S.finish(21);case 24:(R=M.current)===null||R===void 0||R.setFinish(),Z(s);case 26:case"end":return S.stop()}},w,null,[[4,18,21,24]])}));return function(w){return $.apply(this,arguments)}}(),children:[(0,i.jsx)(n.Z,{children:(0,i.jsx)(_.Z,{current:F,items:o.image.map(function($,w){return{title:$,key:w}})})}),(0,i.jsx)(n.Z,{children:(0,i.jsx)(E.Z,{ref:M})})]})});I.Z=D},91058:function(K,I,e){var A=e(5574),a=e.n(A),j=e(89035),h=e(38345),f=e(17186),p=e(24739),v=e(5966),T=e(42075),_=e(14726),u=e(85576),E=e(67294),l=e(95089),B=e(89063),n=e(85893),i="docker-image",D=(0,E.forwardRef)(function(o,x){var m=(0,E.useState)(i),L=a()(m,2),F=L[0],Z=L[1],M=(0,E.useRef)(),b=(0,E.useState)(""),N=a()(b,2),Y=N[0],Q=N[1],$=function(){F!="code"?Z("code"):Z(i)};(0,E.useImperativeHandle)(x,function(){return{addEnvItem:function(s,g){var O,t=(O=M.current)===null||O===void 0?void 0:O.getList(),H=!1;if(t==null||t.map(function(ae){if(ae.name==s){H=!0;return}}),!H){var q;(q=M.current)===null||q===void 0||q.add({name:s,value:g})}},clear:function(){var s;(s=M.current)===null||s===void 0||(s=s.getList())===null||s===void 0||s.map(function(g,O){var t;(t=M.current)===null||t===void 0||t.remove(O)})}}});function w(R){try{var s,g;R==""&&(R=k());for(var O=(s=(g=M.current)===null||g===void 0||(g=g.getList())===null||g===void 0?void 0:g.length)!==null&&s!==void 0?s:0,t=O;t>=0;t--){var H;(H=M.current)===null||H===void 0||H.remove(t)}var q=R.split(`
`),ae=0;q.map(function(S){var ie,ce=S.split("=");ce.length<2||((ie=M.current)===null||ie===void 0||ie.add({name:ce[0],value:ce.slice(1).join("=")},ae),ae++)})}catch(S){console.log(S)}}function k(){if(M&&M.current&&M.current.getList){var R,s=(R=M.current)===null||R===void 0?void 0:R.getList();if(s){var g=[];return s.map(function(O){g.push("".concat(O.name,"=").concat(O.value))}),g.join(`
`)}else return""}else return""}return(0,n.jsxs)(h.Z,{ghost:o.showCardGhost,title:o.label?o.label:null,headerBordered:!0,extra:(o.showCodeMode||o.showImportButton)&&(0,n.jsxs)(T.Z,{children:[o.showImportButton&&(0,n.jsx)("div",{style:{marginBottom:"-25px"},children:(0,n.jsx)(B.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(s){return w(s),!0},onLoad:function(s){if(s.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),o.showCodeMode?(0,n.jsx)(_.ZP,{icon:(0,n.jsx)(j.Z,{}),type:F=="code"?"primary":"default",onClick:$,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,n.jsx)(f.u,{name:o.name?o.name:"environment",actionRef:M,creatorButtonProps:o.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,min:100,children:(0,n.jsxs)(p.UW,{children:[(0,n.jsx)(v.Z,{width:o.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:o.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),(0,n.jsx)(v.Z,{width:o.showInDrawer?"sm":"md",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:!!o.requireValue}],disabled:o.showDisableValue,placeholder:"\u8F93\u5165\u53D8\u91CF\u503C\uFF0C\u53EF\u4EE5\u4E3A\u7A7A"})]})}),(0,n.jsx)(u.Z,{width:"800px",open:F=="code",onCancel:function(){return Z("docker-image")},onOk:function(){w(Y),Z("docker-image")},children:(0,n.jsx)(l.ZP,{onChange:function(s){return Q(s)},value:k(),height:"680px",theme:"light"})})]})});I.Z=D},80821:function(K,I,e){e.d(I,{Z:function(){return _}});var A=e(5574),a=e.n(A),j=e(24963),h=e(86738),f=e(14726),p=e(83062),v=e(67294),T=e(85893);function _(u){var E=(0,v.useState)(!1),l=a()(E,2),B=l[0],n=l[1],i=(0,v.useContext)(j.Z),D=i.lang,o=i.notice,x=i.message,m=function(){n(!0),u.action().then(function(F){if(n(!1),typeof u.onSuccess=="function"&&u.onSuccess(F),u.messageSuccess){var Z="";typeof u.messageSuccess=="function"?Z=u.messageSuccess(F):Z=u.messageSuccess,Z.indexOf(".")>-1&&(Z=D(Z)),u.asynced?x.info(Z):x.success(Z)}}).catch(function(F){n(!1),typeof u.onError=="function"&&u.onError(F)})};return u.confirm?(0,T.jsx)(h.Z,{style:{width:500},title:u.confirmTitle?u.confirmTitle:D("notification.title.tip"),description:u.confirm,onConfirm:m,okText:"Yes",cancelText:"No",children:(0,T.jsx)(f.ZP,{disabled:u.disabled,icon:u.icon,loading:B,danger:u.danger,type:u.type,children:u.children})}):(0,T.jsx)(p.Z,{title:u.tips,children:(0,T.jsx)(f.ZP,{disabled:u.disabled,icon:u.icon,loading:B,onClick:m,danger:u.danger,type:u.type,children:u.children})})}},37413:function(K,I,e){e.d(I,{Z:function(){return B}});var A=e(19632),a=e.n(A),j=e(27496),h=e(35995),f=e(99611),p=e(29158),v=e(38345),T=e(55241),_=e(42075),u=e(66309),E=e(67294),l=e(85893);function B(n){return(0,l.jsx)(T.Z,{placement:"right",content:(0,l.jsxs)(v.Z,{direction:"column",style:{width:500},ghost:!0,children:[(0,l.jsx)(v.Z,{title:"\u7AEF\u53E3",children:[].concat(a()(n.publicPort),a()(n.privatePort)).map(function(i,D){var o=n.serverIp;return o!=""&&o.indexOf(":")>-1&&(o="[".concat(o,"]")),o==""&&i.IP=="::"&&(o="[::1]"),o==""&&i.IP=="0.0.0.0"&&(o="127.0.0.1"),o==""&&(o=i.IP),(0,l.jsx)(_.Z,{size:"large",wrap:!0,children:(0,l.jsx)(u.Z,{color:i.PublicPort?"#2db7f5":"warning",icon:i.PublicPort?(0,l.jsx)(j.Z,{}):"",style:{marginBottom:5,width:210},children:i.PublicPort?(0,l.jsx)("a",{href:"http://".concat(o,":").concat(i.PublicPort),target:"_blank",children:"".concat(i.PublicPort?i.IP+":"+i.PublicPort+" -> ":"").concat(i.PrivatePort,"/").concat(i.Type)},"link".concat(D)):"".concat(i.PrivatePort,"/").concat(i.Type)})},"space".concat(D))})}),n.domain.length>0&&(0,l.jsx)(v.Z,{title:"\u57DF\u540D",children:(0,l.jsx)(_.Z,{direction:"vertical",style:{textAlign:"left"},children:n.domain.map(function(i,D){return(0,l.jsx)(u.Z,{color:"blue",icon:(0,l.jsx)(j.Z,{}),children:(0,l.jsx)("a",{href:i,target:"_blank",children:i})},"domain".concat(D))})})})]}),children:(0,l.jsxs)(_.Z,{direction:"vertical",children:[n.privatePort.length>0&&(0,l.jsxs)(u.Z,{color:"warning",icon:(0,l.jsx)(h.Z,{}),children:["\u5185\u90E8\u7AEF\u53E3: ",n.privatePort.length]}),n.publicPort.length>0&&(0,l.jsxs)(u.Z,{color:"#2db7f5",icon:(0,l.jsx)(f.Z,{}),children:["\u5BF9\u5916\u7AEF\u53E3: ",n.publicPort.length]}),n.domain.length>0&&(0,l.jsxs)(u.Z,{color:"blue",icon:(0,l.jsx)(p.Z,{}),children:["\u7ED1\u5B9A\u57DF\u540D: ",n.domain.length]})]})})}},94359:function(K,I,e){e.d(I,{Z:function(){return B}});var A=e(67294),a=e(3089),j=e(98165),h=e(18429),f=e(8751),p=e(14313),v=e(30159),T=e(87740),_=e(66309),u=e(83062),E=e(54006),l=e(85893);function B(n){var i=(0,l.jsx)(l.Fragment,{});if(n.status=="0"&&(i=(0,l.jsx)(_.Z,{icon:(0,l.jsx)(a.Z,{}),color:"default",children:"waiting"})),n.status=="10"&&(i=(0,l.jsx)(_.Z,{icon:(0,l.jsx)(j.Z,{spin:!0}),color:"processing",children:"processing"})),n.status=="20"&&(i=(0,l.jsx)(_.Z,{icon:(0,l.jsx)(h.Z,{}),color:"error",children:"error"})),n.status=="30"&&(i=(0,l.jsx)(_.Z,{icon:(0,l.jsx)(f.Z,{}),color:"success",children:"success"})),n.status=="running"||n.status=="healthy"){var D,o;i=(0,l.jsx)(_.Z,{icon:(0,l.jsx)(p.Z,{}),color:"success",children:(D=n.message)!==null&&D!==void 0&&D.showInTag?(o=n.message)===null||o===void 0?void 0:o.content:n.status})}if(n.status=="paused"){var x,m;i=(0,l.jsx)(_.Z,{icon:(0,l.jsx)(v.Z,{}),children:(x=n.message)!==null&&x!==void 0&&x.showInTag?(m=n.message)===null||m===void 0?void 0:m.content:n.status})}if(n.status=="waiting"||n.status=="starting"){var L,F;i=(0,l.jsx)(_.Z,{icon:(0,l.jsx)(T.Z,{}),children:(L=n.message)!==null&&L!==void 0&&L.showInTag?(F=n.message)===null||F===void 0?void 0:F.content:n.status})}if(n.status=="exited"||n.status=="dead"||n.status=="removing"||n.status=="restarting"||n.status=="unhealthy"||n.status=="created"){var Z,M;i=(0,l.jsx)(_.Z,{icon:(0,l.jsx)(h.Z,{}),color:"warning",children:(Z=n.message)!==null&&Z!==void 0&&Z.showInTag?(M=n.message)===null||M===void 0?void 0:M.content:n.status})}if(n.link&&(i=(0,l.jsx)(E.Link,{to:n.link,children:i})),n.message){var b;i=(0,l.jsx)(u.Z,{placement:(b=n.message.placement)!==null&&b!==void 0?b:"top",title:n.message.content,children:i})}return(0,l.jsx)(l.Fragment,{children:i})}},89063:function(K,I,e){e.d(I,{Z:function(){return T}});var A=e(24963),a=e(88484),j=e(31418),h=e(72723),f=e(14726),p=e(67294),v=e(85893);function T(_){var u=(0,p.useContext)(A.Z),E=u.message,l=u.notice,B=u.lang,n=(0,p.useRef)(null),i=j.Z.useApp(),D=function(){n.current&&(n.current.click(),n.current.onchange=function(x){if(!x||!x.target)return"";var m=new FileReader;m.onload=function(F){var Z,M,b=(Z=F.target)===null||Z===void 0?void 0:Z.result;if(_.onLoad)try{_.onLoad&&_.onLoad(b)}catch(N){l.error(N);return}typeof _.onImport=="function"&&_.onImport(b),(M=n.current)!==null&&M!==void 0&&M.value&&(n.current.value="")};var L=x.target;if(L.files)try{m.readAsText(L.files[0])}catch(F){l.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.Z.Item,{name:"importFile",label:_.label,children:(0,v.jsx)(f.ZP,{icon:(0,v.jsx)(a.Z,{}),block:!0,onClick:D,children:_.title})}),(0,v.jsx)("input",{style:{display:"none"},type:"file",ref:n,name:"importFileInput"})]})}},92754:function(K,I,e){var A=e(5574),a=e.n(A),j=e(67294),h=e(54006),f=e(38703),p=e(85893),v=(0,j.forwardRef)(function(T,_){var u=(0,j.useState)(""),E=a()(u,2),l=E[0],B=E[1];(0,j.useImperativeHandle)(_,function(){return{setFinish:function(){x({finish:{downloading:100,extracting:100}})},setStart:function(L){L&&B(L),x({start:{downloading:0,extracting:0}})}}});var n=(0,h.useModel)("subscriber");n.addDataHandler("image:pull:"+l,function(m){x(m.data)});var i=(0,j.useState)(),D=a()(i,2),o=D[0],x=D[1];return(0,j.useEffect)(function(){x({start:{downloading:0,extracting:0}})},[]),(0,p.jsx)(p.Fragment,{children:o&&Object.keys(o).map(function(m){return(0,p.jsx)(f.Z,{percent:o[m].downloading,success:{percent:o[m].extracting}},m)})})});I.Z=v},54964:function(K,I,e){e.d(I,{a:function(){return u}});var A=e(78267),a=e.n(A),j=e(75458),h=e.n(j),f=e(67294),p=e(12320),v=e.n(p),T=e(89629),_=e(85893),u={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},E=new p.Terminal(u),l=new j.SearchAddon,B=new A.FitAddon,n=(0,f.forwardRef)(function(i,D){return(0,f.useEffect)(function(){window.addEventListener("resize",function(){i.showInModal||B.fit()}),i.style&&i.style.fontSize&&(E.options.fontSize=i.style.fontSize),E.loadAddon(B),E.loadAddon(l),E.open(document.getElementById("terminal-container")),B.fit()},[]),(0,f.useImperativeHandle)(D,function(){return{write:function(x){E.write(x)},clear:function(){E.clear()},getTerminal:function(){return E},findNext:function(x){l.findNext(x)},findPrev:function(x){l.findPrevious(x)},fit:function(){B.fit()},onData:function(x){E.onData(x)}}}),(0,_.jsx)("div",{id:"terminal-container",style:{width:i.width?i.width:"100%",height:i.height?i.height:"500px"}})});I.Z=n},24963:function(K,I,e){var A=e(67294),a=(0,A.createContext)({});I.Z=a},9740:function(K,I,e){e.r(I),e.d(I,{default:function(){return Ue}});var A=e(15009),a=e.n(A),j=e(99289),h=e.n(j),f=e(5574),p=e.n(f),v=e(80821),T=e(54964),_=e(90098),u=e(43425),E=e(74842),l=e(48689),B=e(33160),n=e(87784),i=e(30159),D=e(86548),o=e(89035),x=e(45742),m=e(90078),L=e(38345),F=e(97269),Z=e(62370),M=e(54006),b=e(14726),N=e(72269),Y=e(42075),Q=e(25593),$=e(84567),w=e(96074),k=e(38925),R=e(63490),s=e(83062),g=e(92398),O=e(67294),t=e(99861),H=e(95089),q=e(95213),ae=e(24963),S=e(91058),ie=e(12320),ce=e(89629),Ae=e(78267),r=e(85893),oe=new ie.Terminal(T.a),_e=new Ae.FitAddon;function Le(re){var ue=(0,M.useModel)("subscriber");return ue.addDataHandler("compose:log:"+re.id,function(le){oe.write(le.data)}),(0,O.useEffect)(function(){return window.addEventListener("resize",function(){_e.fit()}),oe.options.fontSize=12,oe.loadAddon(_e),oe.open(document.getElementById("terminal-log")),_e.fit(),oe.clear(),function(){ue.progress.close("compose:log:"+re.id)}},[re.id]),(0,r.jsx)("div",{id:"terminal-log",style:{width:"100%",height:"500px"}})}var Be=e(37413),Ze=e(87662),Re=e(94359);function Ue(){var re,ue,le,ve=(0,O.useContext)(ae.Z),he=ve.loading,Fe=ve.lang,de=(0,M.useParams)(),Se=(0,M.useNavigate)(),We=(0,O.useState)(),ge=p()(We,2),c=ge[0],Ke=ge[1],be=(0,O.useState)({deleteVolume:!1,deleteImage:!1,deleteData:!1,deletePath:!1}),Ee=p()(be,2),J=Ee[0],me=Ee[1],ee=(0,O.useRef)(),we=(0,O.useState)(0),Pe=p()(we,2),te=Pe[0],ne=Pe[1],Ve=(0,O.useState)("default"),pe=p()(Ve,2),ze=pe[0],se=pe[1],X=(0,O.useRef)(),De=(0,M.useModel)("subscriber"),Ge=(0,O.useState)(""),Oe=p()(Ge,2),Ne=Oe[0],$e=Oe[1],He=(0,O.useState)("default"),Ce=p()(He,2),je=Ce[0],Me=Ce[1],Ye=(0,O.useState)({pullImage:!0}),ye=p()(Ye,2),xe=ye[0],Ie=ye[1];return De.addDataHandler("compose:"+de.id,function(C){var d;(d=ee.current)===null||d===void 0||d.write(C.data)}),(0,O.useEffect)(function(){var C;return he.show(),Ie({pullImage:!0}),(0,_.Pn)({id:parseInt((C=de.id)!==null&&C!==void 0?C:"")}).then(function(d){var P,y=d.data.detail;if(y.setting.status&&y.setting.status.indexOf("running")>-1&&(y.isRunning=!0),y.setting.status&&y.setting.status.indexOf("paused")>-1&&(y.isPaused=!0),y.setting.status&&y.setting.status.indexOf("exited")>-1&&(y.isExited=!0),y.setting.status&&y.setting.status=="waiting"?y.isDeploy=!1:y.isDeploy=!0,y.setting.status&&y.setting.status.indexOf("created")>-1&&(y.isCreated=!0,y.isDeploy=!1),d.data.project&&(y.imageList=Object.keys(d.data.project.services).map(function(G){var z;return(z=d.data.project.services[G].image)!==null&&z!==void 0?z:""})),d.data.containerList){var V;(0,Ze.pe)({groupName:"setting",name:"server"}).then(function(G){G.data.setting.value.serverIp&&$e(G.data.setting.value.serverIp)}),y.containerList=d.data.containerList,(V=X.current)===null||V===void 0||V.setFieldValue("deployServiceName",d.data.containerList.map(function(G){return G.name}))}y.yamlList=d.data.yaml,Ke(y);var U=d.data.project;if(U!=null&&U.services&&Object.keys(U.services).map(function(G){var z=[];if(U.services&&U.services[G]&&(U.services[G].environment&&Object.keys(U.services[G].environment).map(function(Te){U.services[G].environment&&z.push({name:Te,value:U.services[G].environment[Te]})}),z.length!=0)){var fe;(fe=X.current)===null||fe===void 0||fe.setFieldValue(["environmentService",G],z)}}),(P=X.current)===null||P===void 0||P.setFieldValue("environment",d.data.detail.setting.environment),y.isDeploy){var W;(0,_.VN)({id:parseInt((W=de.id)!==null&&W!==void 0?W:"")})}}).catch(function(){Se("/compose/list")}).finally(function(){he.destroy()}),function(){De.progress.close("compose:log:"+de.id)}},[te]),(0,r.jsx)(m._z,{header:{extra:[(0,r.jsx)(M.Link,{to:"/compose/create",reloadDocument:location.search.length>0,children:(0,r.jsx)(b.ZP,{type:"primary",children:"\u521B\u5EFA\u4EFB\u52A1"},"createCompose")},"create")]},children:(0,r.jsxs)(L.Z,{direction:"column",ghost:!0,gutter:[10,10],children:[(0,r.jsx)(L.Z,{title:(0,r.jsx)(u.Z,{}),subTitle:"\u64CD\u4F5C - "+(c==null?void 0:c.name),bordered:!0,extra:(0,r.jsx)(r.Fragment,{children:c&&c.imageList&&c.imageList.length>0&&(0,r.jsx)(t.Z,{image:c.imageList,trigger:(0,r.jsx)(N.Z,{checkedChildren:"\u4F7F\u7528\u9762\u677F\u62C9\u53D6\u955C\u50CF",unCheckedChildren:"\u4F7F\u7528\u9762\u677F\u62C9\u53D6\u955C\u50CF",value:je!="default",onChange:function(d){Me(d?"dpanel":"default")}})})}),headerBordered:!0,children:c!=null&&c.yamlList&&c.yamlList[0]!=""?(0,r.jsxs)(Y.Z,{wrap:!0,children:[(0,r.jsx)(v.Z,{icon:(0,r.jsx)(E.Z,{}),type:"primary",confirm:(0,r.jsxs)(Y.Z,{style:{width:280},direction:"vertical",children:[(0,r.jsx)(Q.Z.Text,{children:"\u91CD\u65B0\u521B\u5EFA\u8BE5\u4EFB\u52A1\u4E0B\u7684\u5BB9\u5668\uFF1F"}),(0,r.jsx)($.Z,{name:"deleteImage",checked:xe.pullImage,onChange:function(d){return Ie({pullImage:d.target.checked})},children:"\u91CD\u65B0\u62C9\u53D6\u955C\u50CF\uFF1F"})]}),action:h()(a()().mark(function C(){var d,P,y,V,U,W;return a()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(se("deploy"),(d=ee.current)===null||d===void 0||d.clear(),U={id:(P=c==null?void 0:c.id)!==null&&P!==void 0?P:0},U.environment=(y=X.current)===null||y===void 0?void 0:y.getFieldValue("environment"),U.deployServiceName=(V=X.current)===null||V===void 0?void 0:V.getFieldValue("deployServiceName"),!(c!=null&&c.isDeploy)){z.next=9;break}if(!(je=="default"&&xe.pullImage)){z.next=9;break}return z.next=9,(0,_.GG)({id:(W=c==null?void 0:c.id)!==null&&W!==void 0?W:0,op:"pull"});case 9:return z.next=11,(0,_.Oh)(U);case 11:ne(te+1);case 12:case"end":return z.stop()}},C)})),children:c.isDeploy?"\u66F4\u65B0":"\u542F\u52A8"},"create"),c.isDeploy&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.Z,{action:function(){var d,P;return(d=ee.current)===null||d===void 0||d.clear(),se("destory"),(0,_.mg)({id:(P=c==null?void 0:c.id)!==null&&P!==void 0?P:0,deleteImage:!1,deleteData:!1,deleteVolume:!1})},onSuccess:function(){ne(te+1)},confirm:"\u662F\u5426\u8981\u9500\u6BC1\u5BB9\u5668\uFF1F",type:"primary",danger:!0,messageSuccess:"\u9500\u6BC1\u6210\u529F",icon:(0,r.jsx)(l.Z,{}),children:"\u5220\u9664\u5E76\u505C\u6B62"}),(0,r.jsx)(w.Z,{type:"vertical"}),(0,r.jsx)(v.Z,{icon:(0,r.jsx)(B.Z,{}),action:h()(a()().mark(function C(){var d;return a()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return se("crtl"),y.next=3,(0,_.GG)({id:(d=c==null?void 0:c.id)!==null&&d!==void 0?d:0,op:"restart"});case 3:ne(te+1);case 4:case"end":return y.stop()}},C)})),children:"\u91CD\u542F"},"restart"),(0,r.jsx)(v.Z,{action:function(){var d,P;return(d=ee.current)===null||d===void 0||d.clear(),se("crtl"),(0,_.GG)({id:(P=c==null?void 0:c.id)!==null&&P!==void 0?P:0,op:"stop"})},messageSuccess:"\u505C\u6B62\u6210\u529F",icon:(0,r.jsx)(n.Z,{}),disabled:c.isExited,onSuccess:function(){ne(te+1)},children:"\u505C\u6B62"}),c.isPaused&&(0,r.jsx)(v.Z,{action:function(){var d,P;return se("crtl"),(d=ee.current)===null||d===void 0||d.clear(),(0,_.GG)({id:(P=c==null?void 0:c.id)!==null&&P!==void 0?P:0,op:"unpause"})},messageSuccess:"\u6062\u590D\u6210\u529F",onSuccess:function(){ne(te+1)},icon:(0,r.jsx)(E.Z,{}),children:"\u6062\u590D"}),!c.isPaused&&(0,r.jsx)(v.Z,{action:function(){var d,P;return se("crtl"),(d=ee.current)===null||d===void 0||d.clear(),(0,_.GG)({id:(P=c==null?void 0:c.id)!==null&&P!==void 0?P:0,op:"pause"})},onSuccess:function(){ne(te+1)},messageSuccess:"\u6682\u505C\u6210\u529F",icon:(0,r.jsx)(i.Z,{}),disabled:!c.isRunning,children:"\u6682\u505C"})]}),(0,r.jsx)(w.Z,{type:"vertical"}),c.id>0&&(0,r.jsx)(M.Link,{to:"/compose/create?id="+c.id,children:(0,r.jsx)(b.ZP,{icon:(0,r.jsx)(D.Z,{}),children:"\u7F16\u8F91\u4EFB\u52A1"})}),c.isDeploy&&(0,r.jsx)(v.Z,{type:"primary",action:h()(a()().mark(function C(){var d,P,y;return a()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return(d=ee.current)===null||d===void 0||d.clear(),se("destory"),U.next=4,(0,_.mg)({id:(P=c==null?void 0:c.id)!==null&&P!==void 0?P:0,deleteImage:J.deleteImage,deleteData:!0,deleteVolume:J.deleteVolume});case 4:y=U.sent,ne(te+1);case 6:case"end":return U.stop()}},C)})),danger:!0,confirm:(0,r.jsxs)(Y.Z,{style:{width:280},direction:"vertical",children:[(0,r.jsx)(Q.Z.Text,{children:"\u5220\u9664\u5BB9\u5668\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"}),(0,r.jsx)($.Z,{name:"deleteImage",onChange:function(d){return me({deleteImage:d.target.checked,deleteData:J.deleteData,deleteVolume:J.deleteVolume,deletePath:J.deletePath})},children:"\u5220\u9664\u955C\u50CF\uFF1F"}),(0,r.jsx)($.Z,{name:"deleteVolume",onChange:function(d){return me({deleteData:J.deleteImage,deleteImage:J.deleteImage,deleteVolume:d.target.checked,deletePath:J.deletePath})},children:"\u5220\u9664\u5B58\u50A8\u5377\uFF1F"}),(0,r.jsx)($.Z,{name:"deleteVolume",onChange:function(d){return me({deleteData:J.deleteImage,deleteImage:J.deleteImage,deleteVolume:J.deleteVolume,deletePath:d.target.checked})},children:"\u5220\u9664\u4EFB\u52A1\u5B58\u653E\u76EE\u5F55\uFF1F"})]}),children:"\u5220\u9664\u4EFB\u52A1"})]}):(0,r.jsx)(k.Z,{showIcon:!0,type:"info",message:(0,r.jsxs)(r.Fragment,{children:["\u65E0\u6CD5\u83B7\u53D6\u8BE5\u4EFB\u52A1\u7684 compose.yaml \u6587\u4EF6\uFF0C\u65E0\u7BA1\u7406\u6743\u9650\u3002",(0,r.jsx)("a",{target:"_blank",href:"https://dpanel.cc/#/zh-cn/manual/compose/external",children:"\u5982\u4F55\u7BA1\u7406\u5916\u90E8\u4EFB\u52A1\uFF1F"})]})})},"operator"),(0,r.jsxs)(L.Z,{split:"vertical",children:[(0,r.jsxs)(L.Z,{colSpan:"45%",direction:"column",split:"horizontal",title:"\u542F\u52A8\u914D\u7F6E",subTitle:"\u7F16\u8F91\u540E\u53EA\u5F71\u54CD\u672C\u6B21\u90E8\u7F72",children:[ze!="default"&&(0,r.jsx)(L.Z,{title:(0,r.jsx)(o.Z,{}),subTitle:"\u63A7\u5236\u53F0",extra:(0,r.jsx)(Y.Z,{children:(0,r.jsx)(v.Z,{action:function(){var d;return(d=ee.current)===null||d===void 0||d.clear(),(0,_.U_)({})},icon:(0,r.jsx)(l.Z,{}),danger:!0,onSuccess:function(){ne(te+1)},children:"\u4E2D\u6B62\u6267\u884C"},"kill")}),children:(0,r.jsx)(T.Z,{width:"100%",height:"300px",showInModal:!0,style:{fontSize:12},ref:ee})}),c&&(0,r.jsx)(L.Z,{children:(0,r.jsx)(R.Z,{rowKey:"name",pagination:!1,columns:[{title:"\u540D\u79F0",dataIndex:"name"},{title:"\u7AEF\u53E3",render:function(d,P,y){var V=[],U=[];return P.publishers&&P.publishers.map(function(W){W.publishedPort?V.push({PrivatePort:W.targetPort,Type:W.protocol,IP:W.url,PublicPort:W.publishedPort}):W.publishedPort&&U.push({PrivatePort:W.targetPort,Type:W.protocol,IP:W.url,PublicPort:W.publishedPort})}),(0,r.jsx)(Be.Z,{publicPort:V,privatePort:U,domain:[],serverIp:Ne})}},{title:"\u72B6\u6001",render:function(d,P,y){return(0,r.jsx)(Re.Z,{status:P.state,message:{content:Fe("container.".concat(P.state)),placement:"top",showInTag:!0}},P.name)}},{title:"\u64CD\u4F5C",render:function(d,P,y){return(0,r.jsxs)(Y.Z,{split:(0,r.jsx)(w.Z,{type:"vertical"}),children:[(0,r.jsx)(M.Link,{to:"/app/detail/edit/"+P.name,target:"_blank",children:(0,r.jsx)(s.Z,{title:"\u7BA1\u7406\u5BB9\u5668",children:(0,r.jsx)(u.Z,{})})},"edit"),P.state=="running"&&(0,r.jsx)(M.Link,{target:"_blank",to:"/console/"+P.name,children:(0,r.jsx)(s.Z,{title:"\u7EC8\u7AEF",children:(0,r.jsx)(o.Z,{})})},"console")]})}}],dataSource:c.containerList,rowSelection:c.isDeploy?null:{defaultSelectedRowKeys:c.containerList.map(function(C){return C.name}),onChange:function(d,P,y){var V;(V=X.current)===null||V===void 0||V.setFieldValue("deployServiceName",d)}}})}),(0,r.jsxs)(F.A,{formRef:X,submitter:!1,children:[(0,r.jsx)(Z.Z,{name:"deployServiceName",hidden:!0}),!(c!=null&&c.isDeploy)&&(0,r.jsx)(L.Z,{title:"\u73AF\u5883\u53D8\u91CF",subTitle:".dpanel.env \u6587\u4EF6",children:(0,r.jsx)(S.Z,{showCardGhost:!0,name:"environment",showDisableName:!0,showInDrawer:!0,requireValue:!0})}),!(c!=null&&c.isDeploy)&&(0,r.jsx)(L.Z,{title:"\u670D\u52A1\u73AF\u5883\u53D8\u91CF",tooltip:"\u4FEE\u6539\u670D\u52A1\u4E2D\u7684\u73AF\u5883\u53D8\u91CF\u65F6\uFF0C\u8BF7\u5728 yaml \u4E2D\u5C06\u503C\u5148\u6620\u5C04\u6210\u81EA\u5B9A\u4E49\u7684\u53D8\u91CF\u540D",children:(0,r.jsx)(g.Z,{indicator:{align:"center"},items:X&&X.current&&((re=X.current)===null||re===void 0?void 0:re.getFieldValue("environmentService"))&&Object.keys((ue=X.current)===null||ue===void 0?void 0:ue.getFieldValue("environmentService")).map(function(C){return{label:C,key:C,children:(0,r.jsx)(S.Z,{showCardGhost:!0,name:["environmentService",C],showDisableName:!0,showDisableValue:!0,showInDrawer:!0,requireValue:!0})}})})})]})]}),c&&!c.isDeploy&&(0,r.jsx)(L.Z,{colSpan:"55%",children:(0,r.jsx)(g.Z,{items:c.yamlList.map(function(C,d){var P=[{label:"Yaml \u6587\u4EF6",key:"yaml"},{label:"\u8986\u76D6 Yaml \u6587\u4EF6",key:"yamlOverride"}];return{label:P[d].label,key:P[d].key,disabled:C=="",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(H.ZP,{theme:"dark",minHeight:"550px",value:C,readOnly:!0,extensions:[q.RI.yaml()]})})}})})}),c&&c.isDeploy&&(0,r.jsx)(L.Z,{title:(0,r.jsx)(x.Z,{}),subTitle:"\u65E5\u5FD7",colSpan:"55%",children:(0,r.jsx)(Le,{id:(le=de.id)!==null&&le!==void 0?le:""})})]})]})})}},90098:function(K,I,e){e.d(I,{CT:function(){return l},GG:function(){return L},MG:function(){return Y},Oh:function(){return D},Pn:function(){return u},U_:function(){return b},VN:function(){return Z},iE:function(){return k},ik:function(){return n},im:function(){return p},mg:function(){return x},pm:function(){return T},xC:function(){return $}});var A=e(15009),a=e.n(A),j=e(99289),h=e.n(j),f=e(54006);function p(s){return v.apply(this,arguments)}function v(){return v=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/create",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),v.apply(this,arguments)}function T(s){return _.apply(this,arguments)}function _(){return _=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/get-list",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),_.apply(this,arguments)}function u(s){return E.apply(this,arguments)}function E(){return E=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/get-task",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),E.apply(this,arguments)}function l(s){return B.apply(this,arguments)}function B(){return B=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/get-detail",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),B.apply(this,arguments)}function n(s){return i.apply(this,arguments)}function i(){return i=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/delete",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),i.apply(this,arguments)}function D(s){return o.apply(this,arguments)}function o(){return o=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/container-deploy",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),o.apply(this,arguments)}function x(s){return m.apply(this,arguments)}function m(){return m=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/container-destroy",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),m.apply(this,arguments)}function L(s){return F.apply(this,arguments)}function F(){return F=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/container-ctrl",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),F.apply(this,arguments)}function Z(s){return M.apply(this,arguments)}function M(){return M=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/container-log",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),M.apply(this,arguments)}function b(s){return N.apply(this,arguments)}function N(){return N=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/container-process-kill",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),N.apply(this,arguments)}function Y(s){return Q.apply(this,arguments)}function Q(){return Q=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/get-from-uri",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),Q.apply(this,arguments)}function $(s){return w.apply(this,arguments)}function w(){return w=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/app/compose/parse",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),w.apply(this,arguments)}function k(s){return R.apply(this,arguments)}function R(){return R=h()(a()().mark(function s(g){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,f.request)("/api/common/store/deploy",{method:"POST",data:g}));case 1:case"end":return t.stop()}},s)})),R.apply(this,arguments)}},3393:function(K,I,e){e.d(I,{Gb:function(){return T},Pn:function(){return l},Rb:function(){return n},YU:function(){return p},_U:function(){return u}});var A=e(15009),a=e.n(A),j=e(99289),h=e.n(j),f=e(54006);function p(D){return v.apply(this,arguments)}function v(){return v=h()(a()().mark(function D(o){return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,f.request)("/api/app/image/get-detail",{method:"POST",data:o}));case 1:case"end":return m.stop()}},D)})),v.apply(this,arguments)}function T(D){return _.apply(this,arguments)}function _(){return _=h()(a()().mark(function D(o){return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,f.request)("/api/app/image/tag-remote",{method:"POST",data:o}));case 1:case"end":return m.stop()}},D)})),_.apply(this,arguments)}function u(D){return E.apply(this,arguments)}function E(){return E=h()(a()().mark(function D(o){return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,f.request)("/api/app/image/tag-add",{method:"POST",data:o}));case 1:case"end":return m.stop()}},D)})),E.apply(this,arguments)}function l(D){return B.apply(this,arguments)}function B(){return B=h()(a()().mark(function D(o){return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,f.request)("/api/app/image/tag-delete",{method:"POST",data:o}));case 1:case"end":return m.stop()}},D)})),B.apply(this,arguments)}function n(D){return i.apply(this,arguments)}function i(){return i=h()(a()().mark(function D(o){return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,f.request)("/api/app/image/export",{method:"POST",data:o,responseType:"blob"}));case 1:case"end":return m.stop()}},D)})),i.apply(this,arguments)}}}]);
