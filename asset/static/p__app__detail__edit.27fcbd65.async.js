"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8878],{76428:function(De,U,n){n.d(U,{Z:function(){return j}});var z=n(25593),c=n(67294),Y=n(85893);function j(W){return(0,Y.jsx)(z.Z.Text,{copyable:!0,children:W.title})}},78498:function(De,U,n){n.d(U,{Z:function(){return Z}});var z=n(25035),c=n(42075),Y=n(83062),j=n(67294),W=n(85893);function Z(V){return(0,W.jsxs)(c.Z,{children:[V.title,(0,W.jsx)(Y.Z,{title:V.help,children:(0,W.jsx)(z.Z,{})})]})}},50479:function(De,U,n){n.r(U),n.d(U,{default:function(){return st}});var z=n(15009),c=n.n(z),Y=n(99289),j=n.n(Y),W=n(5574),Z=n.n(W),V=n(14946),me=n(29158),Se=n(48689),k=n(38345),H=n(10641),x=n(42075),A=n(25593),ye=n(83062),m=n(67294),v=n(80821),F=n(60335),ve=n(78498),t=n(85893),fe=(0,m.forwardRef)(function(S,T){var B=(0,m.useRef)();return(0,m.useImperativeHandle)(T,function(){return{reload:function(){var g;!((g=B.current)===null||g===void 0)&&g.reloadAndRest&&B.current.reloadAndRest()}}}),(0,t.jsx)(k.Z,{title:(0,t.jsx)(me.Z,{}),subTitle:"\u5BB9\u5668\u5173\u8054\u4FE1\u606F",ghost:!0,children:(0,t.jsx)(H.Z,{scroll:{x:"max-content"},rowKey:"key",actionRef:B,pagination:!1,options:!1,columns:[{title:"\u6240\u5C5E\u7F51\u7EDC",key:"name",dataIndex:"networkName",width:300},{title:"\u5BB9\u5668\u540D\u79F0",key:"containerName",dataIndex:"containerName"},{title:(0,t.jsx)(ve.Z,{title:"hostname",help:"\u63D0\u4F9B\u5BB9\u5668\u5185\u90E8\u8BBF\u95EE"}),key:"hostName",render:function(g,f,E){return f.hostName?(0,t.jsx)(x.Z,{direction:"vertical",children:f.hostName.map(function(h){if(h)return(0,t.jsx)(A.Z.Text,{copyable:!0,keyboard:!0,children:h},h)})}):(0,t.jsx)(t.Fragment,{})}},{title:"Ip",key:"ip",render:function(g,f,E,h,y){return(0,t.jsxs)(x.Z,{direction:"vertical",children:[(0,t.jsx)("span",{children:f.networkInfo.IPv4Address}),f.networkInfo.IPv6Address&&(0,t.jsx)("span",{children:f.networkInfo.IPv6Address})]})}},{title:"\u64CD\u4F5C",key:"option",width:100,render:function(g,f,E,h,y){return(0,t.jsx)(x.Z,{children:f.key!="bridge"&&f.key!="none"&&f.key!="host"&&f.networkName!=""&&(0,t.jsx)(ye.Z,{title:"\u9000\u51FA\u7F51\u7EDC",children:(0,t.jsx)(v.Z,{confirm:"\u786E\u8BA4\u9000\u51FA\u8BE5\u7F51\u7EDC\uFF1F",type:"link",action:function(){var D;return(0,V.t9)({name:f.networkName,containerName:(D=S.containerName)!==null&&D!==void 0?D:""})},messageSuccess:"leave",onSuccess:function(){var D,i;!((D=B.current)===null||D===void 0)&&D.reloadAndRest&&((i=B.current)===null||i===void 0||i.reloadAndRest())},children:(0,t.jsx)(Se.Z,{})})})})}}],request:function(){var C=j()(c()().mark(function g(f,E,h){var y,R;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,F.jV)({md5:S.containerName});case 2:return y=i.sent,i.next=5,(0,V._3)({name:Object.keys(y.data.info.NetworkSettings.Networks)});case 5:return R=i.sent,i.abrupt("return",{data:R.data.list,success:!0,total:R.data.list.length});case 7:case"end":return i.stop()}},g)}));return function(g,f,E){return C.apply(this,arguments)}}(),search:!1,expandable:{defaultExpandAllRows:!0,expandRowByClick:!1,defaultExpandedRowKeys:["bridge"]}})})}),he=fe,pe=n(44771),b=n(76428),X=n(62597),re=n(43425),ge=n(74842),Pe=n(87784),Ae=n(33160),Re=n(30159),je=n(58638),xe=n(60219),ie=n(86548),q=n(57132),be=n(50888),Fe=n(16596),Ee=n(45605),Te=n(31574),Oe=n(32319),le=n(60433),_=n(97269),ee=n(62370),w=n(63713),Q=n(96074),te=n(84567),N=n(65233),L=n(28036),Ie=n(85418),se=n(40411),s=n(26412),oe=n(66309),ne=n(93162),ke=n(87662),K=n(75516),I=n(28031),we=n(85576),Ge=n(63490),ze=n(37476),Ye=n(86615),Qe=n(97462),Je=n(5966),Xe=n(2831);function qe(S){var T=we.Z.useModal(),B=Z()(T,2),C=B[0],g=B[1],f=(0,m.useState)(),E=Z()(f,2),h=E[0],y=E[1],R=(0,m.useRef)(),D="";return(0,m.useEffect)(function(){var i,e;(0,Xe.aF)().then(function(O){y(O.data.dpanel.containerInfo)}),D=(i=localStorage.getItem("backupPath"))!==null&&i!==void 0?i:"",(e=R.current)===null||e===void 0||e.setFieldValue("backupPath",D)},[]),(0,t.jsxs)(t.Fragment,{children:[g,(0,t.jsxs)(ze.Y,{modalProps:{forceRender:!0},formRef:R,title:"\u5907\u4EFD\u5BB9\u5668\u5B58\u50A8\u5377",trigger:(0,t.jsxs)(L.ZP,{children:[(0,t.jsx)(xe.Z,{})," \u5907\u4EFD\u5B58\u50A8"]}),onFinish:function(){var i=j()(c()().mark(function e(O){var ae,ue;return c()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return O.backupPath&&localStorage.setItem("backupPath",O.backupPath),ae={containerMd5:S.container.Id,backupTargetType:O.backupTargetType,backupPath:O.backupPath},O.backupTargetType=="dpanel"&&h&&h.Mounts&&h.Mounts.map(function(M){M.Destination=="/dpanel"&&(ae.backupPath=M.Type=="volume"?M.Name:ae.backupPath=M.Source)}),P.next=5,(0,I.vp)(ae);case 5:return ue=P.sent,C.info({title:"\u6B63\u5728\u5907\u4EFD\u5B58\u50A8\u4E2D",content:(0,t.jsx)(k.Z,{ghost:!0,style:{paddingTop:30},children:(0,t.jsx)(Ge.Z,{columns:[{title:"\u5907\u4EFD\u6587\u4EF6",key:"backup",dataIndex:"backup",width:300,render:function(Ce,de,Ze){return(0,t.jsx)(A.Z.Paragraph,{ellipsis:{rows:5,expandable:!0},children:de.backupTar})}},{title:"\u5907\u4EFD\u76EE\u5F55",key:"pathList",dataIndex:"pathList",render:function(Ce,de,Ze){return de.pathList.map(function($,ce){return(0,t.jsx)("div",{children:$},ce)})}}],dataSource:[{key:1,backupTar:ue.data.backupTar,pathList:ue.data.pathList}],rowKey:"key",pagination:!1})}),closable:!0,width:800}),P.abrupt("return",!0);case 8:case"end":return P.stop()}},e)}));return function(e){return i.apply(this,arguments)}}(),children:[(0,t.jsx)(Ye.Z.Group,{label:"\u5907\u4EFD\u76EE\u6807\u4F4D\u7F6E",name:"backupTargetType",initialValue:"dpanel",fieldProps:{defaultValue:"dpanel"},options:[{label:"DPanel \u5907\u4EFD\u76EE\u5F55\u4E2D",value:"dpanel"},{label:"\u5BBF\u4E3B\u673A\u76EE\u5F55\u4E2D",value:"host"}]}),(0,t.jsx)(Qe.Z,{name:["backupTargetType"],children:function(e){var O=e.backupTargetType;return O=="host"?(0,t.jsx)(Je.Z,{label:"\u6307\u5B9A\u5BBF\u4E3B\u673A\u76EE\u5F55",tooltip:"\u8BF7\u586B\u5199\u5BBF\u4E3B\u673A\u76EE\u5F55\uFF0C\u4E0D\u5B58\u65F6\u4F1A\u65B0\u5EFA",name:"backupPath",placeholder:"/home/backup",initialValue:"/home/backup"}):(0,t.jsxs)(t.Fragment,{children:["\u5907\u4EFD\u4F4D\u4E8E DPanel \u5BB9\u5668\u4E2D\u7684 /dpanel/backup \u8DEF\u5F84 ",(0,t.jsx)(w.Link,{target:"_blank",to:"/app/detail/file/".concat(h==null?void 0:h.Id,"?tab=file&path=").concat(encodeURIComponent("/dpanel/backup")),children:"\u67E5\u770B"})]})}})]})]})}var Ne=n(78451),_e=n(24963),et=n(50070),tt=n(64599),nt=n.n(tt),at=n(40717),ut=n(184),rt=n(4798);function it(S){var T=(0,m.useRef)();return[(0,t.jsx)(ut.a,{trigger:(0,t.jsx)(L.ZP,{icon:(0,t.jsx)(at.Z,{}),children:"\u52A0\u5165\u5DF2\u6709\u7F51\u7EDC"},"button"),width:800,formRef:T,title:"\u914D\u7F6E\u7F51\u7EDC",onFinish:function(){var B=j()(c()().mark(function C(g){var f,E,h,y,R;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!g.network){i.next=19;break}E=nt()(g.network),i.prev=2,E.s();case 4:if((h=E.n()).done){i.next=11;break}return y=h.value,i.next=8,(0,V.HY)({name:y.name,containerName:S.containerName,containerAlise:y.alise,ipV4:y.ipV4});case 8:R=i.sent;case 9:i.next=4;break;case 11:i.next=16;break;case 13:i.prev=13,i.t0=i.catch(2),E.e(i.t0);case 16:return i.prev=16,E.f(),i.finish(16);case 19:return!((f=T.current)===null||f===void 0)&&f.resetFields&&T.current.resetFields(),S.onSuccess&&S.onSuccess(),i.abrupt("return",!0);case 22:case"end":return i.stop()}},C,null,[[2,13,16,19]])}));return function(C){return B.apply(this,arguments)}}(),children:(0,t.jsx)(rt.Z,{siteName:S.containerName})},"form")]}var lt=n(99861),Le=n(3393);function st(){var S,T,B,C=(0,m.useContext)(_e.Z),g=C.message,f=C.notice,E=C.loading,h=C.lang,y=(0,m.useContext)(et.AppDetailContext),R=(0,w.useParams)(),D=(0,m.useState)(),i=Z()(D,2),e=i[0],O=i[1],ae=(0,m.useState)(1),ue=Z()(ae,2),G=ue[0],P=ue[1],M=(0,w.useNavigate)(),Ce=(0,m.useRef)(),de=(0,m.useState)({deleteImage:!1,deleteVolume:!1,deleteLink:!1}),Ze=Z()(de,2),$=Ze[0],ce=Ze[1],ot=(0,m.useState)(""),Me=Z()(ot,2),dt=Me[0],ct=Me[1],$e=(0,m.useRef)(),Ue=(0,m.useRef)(),We=(0,m.useRef)(),He=(0,m.useRef)(),Ke=(0,m.useRef)(),mt=(0,m.useState)(0),Ve=Z()(mt,2),Be=Ve[0],J=Ve[1];return(0,m.useEffect)(function(){var u;E.show(),y.reload(),(0,F.jV)({md5:(u=R.id)!==null&&u!==void 0?u:""}).then(function(a){var l;if(a.data){var r;if(a.data.info.HostConfig.NetworkMode=="host"&&a.data.info.Config.ExposedPorts&&Object.keys(a.data.info.Config.ExposedPorts).map(function(o){a.data.info.NetworkSettings.Ports[o]=[{HostIp:"0.0.0.0",HostPort:o.substring(0,o.indexOf("/"))}]}),O(a.data.info),a.data.ignore){if(a.data.ignore.indexOf("".concat(a.data.info.Name,"@*"))>-1){J(-2);return}if(a.data.ignore.indexOf("".concat(a.data.info.Name,"@").concat(a.data.info.Image))>-1){J(-2);return}}(0,Le.ZQ)({tag:(r=a.data.info.Config.Image)!==null&&r!==void 0?r:"",md5:a.data.info.Image,cacheTime:3600}).then(function(o){J(o.data.upgrade?1:2)}).catch(function(o){J(-1)})}(l=Ce.current)===null||l===void 0||l.setFieldValue("restart",a.data.info.HostConfig.RestartPolicy.Name)}).finally(function(){E.destroy()}),(0,ke.EH)().then(function(a){ct(a.data.ip)})},[G]),(0,t.jsxs)(t.Fragment,{children:[e&&(0,t.jsx)(lt.Z,{image:[e.Config.Image],ref:Ke}),(0,t.jsxs)(k.Z,{direction:"column",gutter:[0,10],children:[(0,t.jsx)(k.Z,{title:(0,t.jsx)(re.Z,{}),subTitle:"\u72B6\u6001\u7BA1\u7406",ghost:!0,children:(0,t.jsxs)(x.Z,{wrap:!0,children:[(0,t.jsx)(v.Z,{icon:(0,t.jsx)(ge.Z,{}),action:function(){var a;return(0,F.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"start"})},messageSuccess:"start",onSuccess:function(){return P(G+1)},disabled:e&&e.State.Running||e&&e.State.Paused,children:"\u542F\u52A8"}),(0,t.jsx)(v.Z,{action:function(){var a;return(0,F.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"stop"})},messageSuccess:"stop",icon:(0,t.jsx)(Pe.Z,{}),onSuccess:function(){return P(G+1)},disabled:e&&e.State.Dead,children:"\u505C\u6B62"}),(0,t.jsx)(v.Z,{action:function(){var a;return(0,F.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"restart"})},messageSuccess:"restart",onSuccess:function(){return P(G+1)},icon:(0,t.jsx)(Ae.Z,{}),children:"\u91CD\u542F"}),(0,t.jsx)(v.Z,{action:function(){var a;return(0,F.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"pause"})},messageSuccess:"pause",onSuccess:function(){return P(G+1)},icon:(0,t.jsx)(Re.Z,{}),disabled:e&&!e.State.Running,children:"\u6682\u505C"}),(0,t.jsx)(v.Z,{action:function(){var a;return(0,F.IW)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",operate:"unpause"})},messageSuccess:"resume",onSuccess:function(){return P(G+1)},icon:(0,t.jsx)(ge.Z,{}),disabled:e&&!e.State.Paused,children:"\u6062\u590D"}),(0,t.jsx)(Q.Z,{type:"vertical"}),e&&(0,t.jsx)(K.Z,{container:e}),(0,t.jsx)(Q.Z,{type:"vertical"}),e&&(!e.Config.Labels||!e.Config.Labels["com.docker.compose.project"])&&(0,t.jsx)(v.Z,{action:function(){var a;return(0,X.Ct)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",deleteImage:$.deleteImage,deleteVolume:$.deleteVolume})},messageSuccess:"delete",danger:!0,type:"primary",icon:(0,t.jsx)(Pe.Z,{}),onSuccess:function(){return M("/app/list")},confirm:(0,t.jsxs)(x.Z,{style:{width:280},direction:"vertical",children:[(0,t.jsx)(A.Z.Text,{children:"\u5220\u9664\u5BB9\u5668\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"}),(0,t.jsx)(te.Z,{name:"deleteVolume",onChange:function(a){return ce({deleteImage:$.deleteImage,deleteVolume:a.target.checked,deleteLink:$.deleteLink})},children:"\u5220\u9664\u5B58\u50A8\uFF1F"}),(0,t.jsx)(te.Z,{name:"deleteImage",onChange:function(a){return ce({deleteImage:a.target.checked,deleteVolume:$.deleteVolume,deleteLink:$.deleteLink})},children:"\u5220\u9664\u955C\u50CF\uFF1F"}),(0,t.jsx)(te.Z,{name:"deleteLink",onChange:function(a){return ce({deleteImage:$.deleteVolume,deleteVolume:$.deleteVolume,deleteLink:a.target.checked})},children:"\u5220\u9664\u5173\u8054\u5BB9\u5668\uFF1F"})]}),children:"\u5220\u9664"})]})}),(0,t.jsx)(k.Z,{title:(0,t.jsx)(re.Z,{}),subTitle:"\u5BB9\u5668\u7BA1\u7406",ghost:!0,children:(0,t.jsxs)(x.Z,{wrap:!0,children:[(0,t.jsx)(v.Z,{icon:(0,t.jsx)(je.Z,{}),action:function(){var a;return(0,F.LJ)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:""})},confirm:"\u5BFC\u51FA\u5BB9\u5668 Tar \u5305\u4E0D\u5305\u542B\u6302\u8F7D\u76EE\u5F55\u7684\u6570\u636E\uFF0C\u786E\u5B9A\u5417\uFF1F",onSuccess:function(a){var l=new Blob([a],{type:"application/tar"});(0,ne.saveAs)(l,(e==null?void 0:e.Id)+".tar")},messageSuccess:"export",children:"\u5BFC\u51FA\u5BB9\u5668"}),(0,t.jsx)(v.Z,{icon:(0,t.jsx)(xe.Z,{}),action:j()(c()().mark(function u(){var a,l,r;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,F.Re)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",name:(l=(r=$e.current)===null||r===void 0?void 0:r.getFieldValue("saveImageName"))!==null&&l!==void 0?l:e==null?void 0:e.Name});case 2:case"end":return d.stop()}},u)})),confirmTitle:"\u5C06\u5F53\u524D\u5BB9\u5668\u4FDD\u5B58\u4E3A\u955C\u50CF",confirm:(0,t.jsx)(x.Z,{style:{width:400,marginTop:"10px",paddingRight:"10px"},direction:"vertical",children:(0,t.jsx)(_.A,{formRef:$e,submitter:!1,children:(0,t.jsx)(ee.Z,{name:"saveImageName",children:(0,t.jsx)(N.Z,{addonBefore:"\u955C\u50CF\u540D\u79F0"})})})}),messageSuccess:"save",children:"\u53E6\u5B58\u4E3A\u955C\u50CF"}),e&&(0,t.jsx)(qe,{container:e}),(0,t.jsx)(Q.Z,{type:"vertical"}),(0,t.jsx)(w.Link,{to:"/app/create/image?containerId=".concat(e==null?void 0:e.Id,"&op=update"),children:(0,t.jsx)(L.ZP,{type:"primary",icon:(0,t.jsx)(ie.Z,{}),children:"\u7F16\u8F91\u5BB9\u5668"})}),(0,t.jsx)(v.Z,{icon:(0,t.jsx)(q.Z,{}),action:j()(c()().mark(function u(){var a,l,r;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,F.aF)({md5:(a=e==null?void 0:e.Id)!==null&&a!==void 0?a:"",copyName:(l=(r=Ue.current)===null||r===void 0?void 0:r.getFieldValue("copyName"))!==null&&l!==void 0?l:""});case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},u)})),confirm:(0,t.jsxs)(x.Z,{style:{width:400,paddingRight:"10px"},direction:"vertical",children:[(0,t.jsx)(A.Z.Text,{children:"\u590D\u5236\u51FA\u7684\u5BB9\u5668\u4E0E\u5F53\u524D\u5BB9\u5668\u5177\u6709\u76F8\u540C\u7684\u914D\u7F6E\uFF0C\u8BF7\u4E8C\u6B21\u7F16\u8F91\u540E\u542F\u52A8\u5BB9\u5668\u3002\u786E\u5B9A\u5417\uFF1F"}),(0,t.jsx)(_.A,{formRef:Ue,submitter:!1,children:(0,t.jsx)(ee.Z,{name:"copyName",children:(0,t.jsx)(N.Z,{addonBefore:"\u590D\u5236\u5BB9\u5668\u540D\u79F0"})})})]}),onSuccess:function(a){M("/app/list")},messageSuccess:"copy",children:"\u590D\u5236\u5BB9\u5668"}),(0,t.jsx)(Ie.Z,{placement:"bottomLeft",menu:{items:[{key:"1",label:(0,t.jsx)(v.Z,{action:j()(c()().mark(function u(){var a,l,r;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,X.ze)({md5:(a=e==null?void 0:e.Name)!==null&&a!==void 0?a:"",imageId:""});case 2:return J(0),d.next=5,(0,Le.ZQ)({tag:(l=e==null?void 0:e.Config.Image)!==null&&l!==void 0?l:"",md5:(r=e==null?void 0:e.Image)!==null&&r!==void 0?r:"",cacheTime:0}).then(function(p){J(p.data.upgrade?1:2)}).catch(function(p){J(-1)});case 5:return d.abrupt("return",d.sent);case 6:case"end":return d.stop()}},u)})),type:"link",children:"\u81EA\u52A8\u68C0\u6D4B"})},{key:"2",label:(0,t.jsx)(v.Z,{action:j()(c()().mark(function u(){var a,l;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,X.ze)({md5:(a=e==null?void 0:e.Name)!==null&&a!==void 0?a:"",imageId:(l=e==null?void 0:e.Image)!==null&&l!==void 0?l:""});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},u)})),type:"link",messageSuccess:"ignore",children:"\u5FFD\u7565\u672C\u6B21"})},{key:"3",label:(0,t.jsx)(v.Z,{action:j()(c()().mark(function u(){var a;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,X.ze)({md5:(a=e==null?void 0:e.Name)!==null&&a!==void 0?a:"",imageId:"*"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},u)})),type:"link",messageSuccess:"ignore",children:"\u6C38\u4E45\u5FFD\u7565"})}]},children:(0,t.jsx)(se.Z,{count:h("app.detail.checkImageUpgrade."+Be),color:h("app.detail.checkImageUpgradeColor."+Be),children:(0,t.jsx)(v.Z,{disabled:Be===0,icon:Be===0?(0,t.jsx)(be.Z,{}):(0,t.jsx)(Fe.Z,{}),action:j()(c()().mark(function u(){var a,l,r,o;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(a=Ke.current)===null||a===void 0?void 0:a.start();case 2:return p.next=4,(0,F.RF)({md5:(l=e==null?void 0:e.Id)!==null&&l!==void 0?l:"",imageTag:"",enableBak:(r=(o=We.current)===null||o===void 0?void 0:o.getFieldValue("enableBak"))!==null&&r!==void 0?r:!0});case 4:return p.abrupt("return",p.sent);case 5:case"end":return p.stop()}},u)})),confirm:(0,t.jsxs)(x.Z,{style:{width:280,paddingRight:"10px"},direction:"vertical",children:[(0,t.jsx)(A.Z.Text,{children:"\u66F4\u65B0\u5BB9\u5668\u524D\u8BF7\u786E\u4FDD\u8FDC\u7A0B Docker \u7248\u672C\u4E0E\u9762\u677F\u73AF\u5883\u4E00\u81F4\u3002\u6B64\u64CD\u4F5C\u5C06\u4F1A\u91CD\u65B0\u62C9\u53D6\u955C\u50CF\u5E76\u91CD\u5EFA\u5BB9\u5668\u3002\u786E\u5B9A\u5417\uFF1F"}),(0,t.jsx)(_.A,{formRef:We,submitter:!1,layout:"inline",children:(0,t.jsx)(ee.Z,{name:"enableBak",initialValue:!0,valuePropName:"checked",children:(0,t.jsx)(te.Z,{children:"\u5907\u4EFD\u65E7\u5BB9\u5668\uFF1F"})})})]}),onSuccess:function(a){M("/app/list")},messageSuccess:"upgrade",children:"\u5FEB\u901F\u5347\u7EA7\u5BB9\u5668"})})}),(0,t.jsx)(Q.Z,{type:"vertical"}),e&&(0,t.jsx)(it,{onSuccess:function(){var a;(a=He.current)===null||a===void 0||a.reload()},containerName:e.Name})]})}),(0,t.jsx)(k.Z,{title:(0,t.jsx)(Ee.Z,{}),subTitle:"\u5BB9\u5668\u72B6\u6001",ghost:!0,children:(0,t.jsxs)(s.Z,{column:1,bordered:!0,children:[(0,t.jsx)(s.Z.Item,{label:"ID",children:(0,t.jsx)(b.Z,{title:e==null?void 0:e.Id})}),(0,t.jsx)(s.Z.Item,{label:"\u5BB9\u5668\u540D\u79F0",children:(0,t.jsx)(A.Z.Text,{editable:{tooltip:"\u4FEE\u6539\u5BB9\u5668\u540D\u79F0",onChange:function(){var u=j()(c()().mark(function l(r){var o;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(e!=null&&e.Id){p.next=2;break}return p.abrupt("return");case 2:return p.next=4,(0,F.eE)({md5:e.Id,name:r});case 4:o=p.sent,P(G+1),g.success("\u4FEE\u6539\u5BB9\u5668\u540D\u79F0");case 7:case"end":return p.stop()}},l)}));function a(l){return u.apply(this,arguments)}return a}()},children:e&&e.Name})}),(0,t.jsx)(s.Z.Item,{label:(0,t.jsx)(ve.Z,{title:"\u7F51\u7EDC",help:"\u9ED8\u8BA4\u7F51\u7EDC\u53EA\u652F\u6301\u901A\u8FC7ip\u8BBF\u95EE,ip\u4F1A\u968F\u7740\u5BB9\u5668\u542F\u52A8\u505C\u6B62\u6539\u53D8.\u5982\u679C\u9700\u8981\u5728\u5BB9\u5668\u5185\u4E92\u8054,\u8BF7\u901A\u8FC7\u3010\u7F16\u8F91\u7AD9\u70B9\u3011-\u3010\u6DFB\u52A0\u5173\u8054\u3011"}),children:(e==null?void 0:e.State.Running)&&(0,t.jsxs)(s.Z,{column:1,bordered:!0,children:[e.NetworkSettings.Networks&&Object.keys(e.NetworkSettings.Networks).map(function(u,a){return(0,t.jsx)(s.Z.Item,{label:u,children:u=="host"?" Host \u7F51\u7EDC\uFF0C\u4E0E\u5BBF\u4E3B\u673A\u5171\u7528\u540C\u4E00\u7F51\u7EDC":(0,t.jsxs)(x.Z,{direction:"vertical",children:[(0,t.jsx)(b.Z,{title:e==null?void 0:e.NetworkSettings.Networks[u].IPAddress}),e==null?void 0:e.NetworkSettings.Networks[u].Gateway,e==null?void 0:e.NetworkSettings.Networks[u].MacAddress]})},"1")}),e.HostConfig.ExtraHosts&&(0,t.jsx)(s.Z.Item,{label:"\u5BBF\u4E3B\u673A\u7F51\u7EDC",children:(0,t.jsx)(x.Z,{direction:"vertical",children:e.HostConfig.ExtraHosts.map(function(u){if(u.indexOf(":")>-1){var a=u.split(":");return(0,t.jsxs)(x.Z,{children:[(0,t.jsx)(b.Z,{title:a[0]})," - ",a[1]]})}})})},"1")]})}),(0,t.jsx)(s.Z.Item,{label:"\u72B6\u6001",children:e==null?void 0:e.State.Status}),(0,t.jsx)(s.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:new Date((S=e==null?void 0:e.Created)!==null&&S!==void 0?S:"").toLocaleString()}),(0,t.jsx)(s.Z.Item,{label:"\u542F\u52A8\u65F6\u95F4",children:new Date((T=e==null?void 0:e.State.StartedAt)!==null&&T!==void 0?T:"").toLocaleString()}),(0,t.jsx)(s.Z.Item,{label:"\u91CD\u542F\u7B56\u7565",children:(0,t.jsx)(_.A,{onFinish:function(){var u=j()(c()().mark(function a(l){var r;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(e!=null&&e.Id){d.next=2;break}return d.abrupt("return");case 2:return d.next=4,(0,F.eE)({md5:e.Id,restart:l.restart});case 4:return r=d.sent,g.success("\u4FEE\u6539\u91CD\u542F\u7B56\u7565\u6210\u529F"),d.abrupt("return");case 7:case"end":return d.stop()}},a)}));return function(a){return u.apply(this,arguments)}}(),formRef:Ce,children:(0,t.jsx)(pe.Z,{defaultValue:e==null?void 0:e.HostConfig.RestartPolicy.Name})})})]})}),e&&e.Mounts&&e.Mounts.length>0&&(0,t.jsx)(k.Z,{title:(0,t.jsx)(Te.Z,{}),subTitle:"\u6301\u4E45\u5B58\u50A8\u8BE6\u60C5",ghost:!0,children:(0,t.jsx)(s.Z,{column:1,bordered:!0,children:e==null?void 0:e.Mounts.map(function(u,a){return(0,t.jsx)(s.Z.Item,{labelStyle:{width:"30%"},label:u.Type=="volume"?(0,t.jsx)(Ne.Z,{content:u.Name}):u.Source,children:(0,t.jsxs)(w.Link,{target:"_blank",to:"/app/detail/file/".concat(e.Id,"?tab=file&path=").concat(encodeURIComponent(u.Destination)),children:[u.Destination," ",(0,t.jsx)(Oe.Z,{})]})},a)})})}),(0,t.jsx)(k.Z,{title:(0,t.jsx)(le.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",ghost:!0,children:(0,t.jsxs)(s.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,t.jsx)(s.Z.Item,{label:"Image Tag",children:(0,t.jsx)(w.Link,{target:"_blank",to:"/image/detail/"+(e==null?void 0:e.Image),children:e==null?void 0:e.Config.Image})}),(0,t.jsx)(s.Z.Item,{label:"Image",children:e==null?void 0:e.Image}),(0,t.jsx)(s.Z.Item,{label:"Port",children:(0,t.jsx)(x.Z,{direction:"vertical",children:(e==null?void 0:e.NetworkSettings.Ports)&&Object.keys(e.NetworkSettings.Ports).map(function(u){var a,l=(a=e==null?void 0:e.NetworkSettings.Ports[u])!==null&&a!==void 0?a:[{HostPort:null,HostIp:""}];return l.map(function(r){var o=dt;return o!=""&&o.indexOf(":")>-1&&(o="[".concat(o,"]")),o==""&&r.HostIp=="::"&&(o="[::1]"),o==""&&r.HostIp=="0.0.0.0"&&(o="127.0.0.1"),o==""&&(o=r.HostIp),(0,t.jsxs)(x.Z.Compact,{children:[(0,t.jsxs)(oe.Z,{color:r.HostPort?"success":"",children:[r.HostPort?"".concat(r.HostIp,":").concat(r.HostPort," ->"):"",u]},u),r.HostPort?(0,t.jsx)("a",{href:"http://".concat(o,":").concat(r.HostPort),target:"_blank",children:(0,t.jsx)(me.Z,{})}):""]})})})})}),(0,t.jsx)(s.Z.Item,{label:"CMD",children:(e==null?void 0:e.Config.Cmd)&&(e==null?void 0:e.Config.Cmd.join(" "))}),(0,t.jsx)(s.Z.Item,{label:"ENTRYPOINT",children:e==null?void 0:e.Config.Entrypoint}),(0,t.jsx)(s.Z.Item,{label:"ENV",children:(0,t.jsx)(s.Z,{column:1,bordered:!0,children:(e==null?void 0:e.Config.Env)&&e.Config.Env.map(function(u,a){var l=u.split("=");return(0,t.jsx)(s.Z.Item,{label:l[0],children:(0,t.jsx)(Ne.Z,{content:l.slice(1).join("=")})},a)})})}),(0,t.jsx)(s.Z.Item,{label:"Labels",children:(0,t.jsx)(s.Z,{column:1,bordered:!0,children:e&&Object.keys(e.Config.Labels).map(function(u){return(0,t.jsx)(s.Z.Item,{label:u,children:(0,t.jsx)(A.Z.Text,{style:{width:"400px"},ellipsis:{tooltip:e.Config.Labels[u]},children:e.Config.Labels[u]})},u)})})})]})}),(e==null?void 0:e.Name)&&(0,t.jsx)(he,{containerName:(B=e==null?void 0:e.Name)!==null&&B!==void 0?B:"",ref:He})]})]})}},50070:function(De,U,n){n.r(U),n.d(U,{AppDetailContext:function(){return F},default:function(){return ve}});var z=n(15009),c=n.n(z),Y=n(99289),j=n.n(Y),W=n(5574),Z=n.n(W),V=n(24963),me=n(2831),Se=n(60335),k=n(55809),H=n(63713),x=n(86738),A=n(25593),ye=n(50136),m=n(67294),v=n(85893),F=(0,m.createContext)({});function ve(){var t,fe=(0,m.useContext)(V.Z),he=fe.lang,pe=fe.loading,b=(0,H.useParams)(),X=(0,H.useSearchParams)(),re=Z()(X,2),ge=re[0],Pe=re[1],Ae=(t=ge.get("tab"))!==null&&t!==void 0?t:"edit",Re=(0,m.useState)("edit"),je=Z()(Re,2),xe=je[0],ie=je[1],q=(0,H.useNavigate)(),be=(0,m.useState)(1),Fe=Z()(be,2),Ee=Fe[0],Te=Fe[1],Oe=(0,H.useAccess)(),le=[{label:(0,v.jsx)(H.Link,{to:"/app/detail/edit/".concat(b.id,"?tab=edit"),children:"\u5BB9\u5668\u8BE6\u60C5"}),key:"edit"},{label:(0,v.jsx)(H.Link,{to:"/app/detail/domain/".concat(b.id,"?tab=domain"),children:"\u57DF\u540D\u7BA1\u7406"}),key:"domain"},{label:(0,v.jsx)(x.Z,{style:{width:500},title:he("notification.title.tip"),description:he("app.detail.createExplorerPlugin"),onConfirm:function(){q("/app/detail/file/".concat(b.id,"?tab=file")),Q(le.filter(function(L){return L.key!="fileConfirm"})),ie("file")},okText:"Yes",cancelText:"No",children:(0,v.jsx)(A.Z.Link,{children:"\u6587\u4EF6\u7BA1\u7406"})}),key:"fileConfirm"},{label:(0,v.jsx)(A.Z.Link,{children:"\u6587\u4EF6\u7BA1\u7406"}),key:"file",onClick:function(){q("/app/detail/file/".concat(b.id,"?tab=file"))}},{label:(0,v.jsx)(A.Z.Link,{children:"\u8FD0\u884C\u65E5\u5FD7"}),key:"log",onClick:function(){q("/app/detail/log/".concat(b.id,"?tab=log"))}},{label:(0,v.jsx)(A.Z.Link,{children:"\u8FD0\u884C\u72B6\u6001"}),key:"stat",onClick:function(){q("/app/detail/stat/".concat(b.id,"?tab=stat"))}},{label:"",key:"containerName",icon:(0,v.jsx)(k.Z,{}),disabled:!0}],_=(0,m.useState)(le),ee=Z()(_,2),w=ee[0],Q=ee[1];(0,m.useEffect)(function(){pe.show(),ie(Ae);var N=function(){var L=j()(c()().mark(function Ie(){var se,s,oe,ne;return c()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return s=le,K.next=3,(0,me.aF)();case 3:return oe=K.sent,Oe.canSeeContainerDomain||(s=s.filter(function(I){return I.key!="domain"})),oe.data.plugin.explorer.isCreated||(s=s.filter(function(I){return I.key!="file"})),oe.data.plugin.explorer.isCreated&&(s=s.filter(function(I){return I.key!="fileConfirm"})),K.next=9,(0,Se.jV)({md5:(se=b.id)!==null&&se!==void 0?se:""});case 9:ne=K.sent,s.map(function(I){return I.key=="containerName"&&(I.label=ne.data.info.Name),(!ne.data.info.State.Running||ne.data.info.State.Restarting)&&(I.key=="file"||I.key=="fileConfirm"||I.key=="stat")&&(I.disabled=!0),I}),Q(s),pe.destroy();case 13:case"end":return K.stop()}},Ie)}));return function(){return L.apply(this,arguments)}}();N()},[Ee]);var te=function(L){L.key!="fileConfirm"&&ie(L.key)};return(0,v.jsxs)(F.Provider,{value:{reload:function(){Te(Ee+1)}},children:[(0,v.jsx)(ye.Z,{mode:"horizontal",onClick:te,selectedKeys:[xe],items:w}),(0,v.jsx)(H.Outlet,{})]})}}}]);
