"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6856],{49610:function(j,u,e){var M=e(5574),O=e.n(M),r=e(67294),U=e(54964),c=e(52626),D=e(12320),E=e.n(D),m=e(78267),I=e.n(m),R=e(85893),n,t=new D.Terminal(U.a),_=new m.FitAddon,i,d=(0,r.forwardRef)(function(v,o){var h,T=(0,r.useState)(),y=O()(T,2),C=y[0],B=y[1],g=(0,r.useState)(""),l=O()(g,2),a=l[0],S=l[1];(0,r.useImperativeHandle)(o,function(){return{start:function(P,s){L(),s.width=t.cols,s.height=t.rows;var K=s?Object.keys(s).filter(function(f){return s&&s[f]}).map(function(f){if(s&&s[f])return"".concat(f,"=").concat(s[f])}):[];n=new WebSocket((0,c.R)(P+"?"+K.join("&"))),n.addEventListener("message",function(f){var W=JSON.parse(f.data),x=W.type;if(x==P&&(t.write(W.data),W.data.indexOf("exec failed")!=-1)){L();return}}),i=t.onData(function(f){var W={content:{command:f},type:P};n&&n.send(JSON.stringify(W))}),S(P),B(s)},close:function(){L()},fit:function(){return _.fit(),{width:t.cols,height:t.rows}},run:function(P){C&&P&&P.forEach(function(s){var K={content:{command:s+`
`},type:a};n&&n.send(JSON.stringify(K))})}}}),(0,r.useEffect)(function(){return t.loadAddon(_),t.open(document.getElementById("terminal-container-console")),_.fit(),function(){L()}},[]),(0,r.useEffect)(function(){window.addEventListener("resize",function(){_.fit();var A={size:{width:t.cols,height:t.rows},type:a};a&&n&&n.send(JSON.stringify(A))})},[a]);function L(){t.reset(),_.fit(),t.focus(),i&&i.dispose(),n&&(n.close(),n=null)}return(0,R.jsx)("div",{style:{height:(h=v.height)!==null&&h!==void 0?h:"100vh"},id:"terminal-container-console"})});u.Z=d},54964:function(j,u,e){e.d(u,{a:function(){return t}});var M=e(5574),O=e.n(M),r=e(78267),U=e.n(r),c=e(75458),D=e.n(c),E=e(67294),m=e(12320),I=e.n(m),R=e(89629),n=e(85893),t={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},_=new m.Terminal(t),i=new c.SearchAddon,d=new r.FitAddon,v=(0,E.forwardRef)(function(o,h){var T,y=(0,E.useState)(!0),C=O()(y,2),B=C[0],g=C[1];return(0,E.useEffect)(function(){return window.addEventListener("resize",function(){o.showInModal||d.fit()}),o.style&&o.style.fontSize&&(_.options.fontSize=o.style.fontSize),_.loadAddon(d),_.loadAddon(i),_.open(document.getElementById(o.id?o.id:"terminal-container")),o.showInModal||d.fit(),function(){_.reset(),g(!0)}},[]),(0,E.useImperativeHandle)(h,function(){return{write:function(a){B&&(d.fit(),g(!1)),_.write(a)},clear:function(){_.clear()},getTerminal:function(){return _},findNext:function(a){i.findNext(a)},findPrev:function(a){i.findPrevious(a)},fit:function(){d.fit()},onData:function(a){return _.onData(a)}}}),(0,n.jsx)("div",{id:o.id?o.id:"terminal-container",style:{width:o.width?o.width:"100%",height:o.height?o.height:"500px",marginTop:(T=o.style)===null||T===void 0?void 0:T.marginTop}})});u.Z=v},67359:function(j,u,e){e.r(u),e.d(u,{default:function(){return m}});var M=e(5574),O=e.n(M),r=e(49610),U=e(87662),c=e(82346),D=e(67294),E=e(85893);function m(){var I=(0,c.useParams)(),R=(0,c.useSearchParams)(),n=O()(R,2),t=n[0],_=n[1],i=(0,D.useRef)();return(0,D.useEffect)(function(){I.id&&(0,U.K3)({name:I.id}).then(function(d){var v;window.document.title="console - ".concat(d.data.name),(v=i.current)===null||v===void 0||v.start("/console/host/".concat(d.data.name),{cmd:t.get("cmd"),workDir:t.get("workDir")})}),document.body.style.overflow="hidden"},[]),(0,E.jsx)(r.Z,{ref:i})}}}]);
