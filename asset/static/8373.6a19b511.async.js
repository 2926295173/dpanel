"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8373],{91058:function(N,W,t){var A=t(19632),a=t.n(A),L=t(97857),s=t.n(L),l=t(5574),f=t.n(l),v=t(89035),O=t(64317),p=t(5966),g=t(38345),y=t(17186),S=t(24739),K=t(42075),D=t(28036),x=t(85576),T=t(67294),k=t(95089),R=t(12491),C=t(62597),b=t(79245),_=t(85893),w="docker-image",I=(0,T.forwardRef)(function(i,U){var Y=(0,T.useState)(w),F=f()(Y,2),V=F[0],j=F[1],E=(0,T.useRef)(),$=(0,T.useState)(""),H=f()($,2),G=H[0],r=H[1],n=function(){V!="code"?j("code"):j(w)};(0,T.useImperativeHandle)(U,function(){return{addEnvItem:function(u,d){var h,c=(h=E.current)===null||h===void 0?void 0:h.getList(),M=!1;if(c==null||c.map(function(B){if(B.name==u){M=!0;return}}),!M){var P;(P=E.current)===null||P===void 0||P.add({name:u,value:d})}},clear:function(){var u;(u=E.current)===null||u===void 0||(u=u.getList())===null||u===void 0||u.map(function(d,h){var c;(c=E.current)===null||c===void 0||c.remove(h)})}}});function m(o){try{var u,d;o==""&&(o=e());for(var h=(u=(d=E.current)===null||d===void 0||(d=d.getList())===null||d===void 0?void 0:d.length)!==null&&u!==void 0?u:0,c=h;c>=0;c--){var M;(M=E.current)===null||M===void 0||M.remove(c)}var P=o.split(`
`),B=0;P.map(function(Z){var z,J=Z.split("=");J.length<2||((z=E.current)===null||z===void 0||z.add({name:J[0],value:J.slice(1).join("=")},B),B++)})}catch(Z){console.log(Z)}}function e(){if(E&&E.current&&E.current.getList){var o,u=(o=E.current)===null||o===void 0?void 0:o.getList();if(u){var d=[];return u.map(function(h){d.push("".concat(h.name,"=").concat(h.value))}),d.join(`
`)}else return""}else return""}function Q(o){var u,d,h,c,M={},P={help:o&&o.label?o.label:"",name:"value",label:"\u53D8\u91CF\u503C",rules:[{required:i.requireValue?!0:(0,b.y)((u=o.rule)===null||u===void 0?void 0:u.kind,C.fp.EnvValueRuleRequired)}],disabled:i.showDisableValue||(0,b.y)((d=o.rule)===null||d===void 0?void 0:d.kind,C.fp.EnvValueRuleDisabled)};if((0,b.y)((h=o.rule)===null||h===void 0?void 0:h.kind,C.fp.EnvValueTypeSelect)){var B;return(0,_.jsx)(O.Z,s()(s()({fieldProps:M},P),{},{width:i.showInDrawer?"sm":"md",options:((B=o.rule)===null||B===void 0?void 0:B.option)&&o.rule.option.map(function(Z){return{label:Z.name,value:Z.value}}),initialValue:o.value}))}else return(0,b.y)((c=o.rule)===null||c===void 0?void 0:c.kind,C.fp.EnvValueTypeNumber)?(0,_.jsx)(p.Z,s()(s()({fieldProps:M},P),{},{width:i.showInDrawer?"sm":"md",rules:[].concat(a()(P.rules),[{pattern:new RegExp("^[0-9]*$")}]),help:P.help+",\u6570\u503C\u7C7B\u578B"})):(0,_.jsx)(p.Z,s()(s()({fieldProps:M},P),{},{width:i.showInDrawer?"sm":"md"}))}return(0,_.jsxs)(g.Z,{ghost:i.showCardGhost,title:i.label?i.label:null,headerBordered:!0,extra:(i.showCodeMode||i.showImportButton)&&(0,_.jsxs)(K.Z,{children:[i.showImportButton&&(0,_.jsx)("div",{style:{marginBottom:"-25px"},children:(0,_.jsx)(R.Z,{title:"\u5BFC\u5165 env \u6587\u4EF6",onImport:function(u){return m(u),!0},onLoad:function(u){if(u.indexOf("=")<0)throw new Error("\u5BFC\u5165env\u6587\u4EF6\u9519\u8BEF");return!0}})}),i.showCodeMode?(0,_.jsx)(D.ZP,{icon:(0,_.jsx)(v.Z,{}),type:V=="code"?"primary":"default",onClick:n,children:"\u4EE3\u7801\u6A21\u5F0F"},"code"):""]}),children:[(0,_.jsx)(y.u,{name:i.name?i.name:"environment",actionRef:E,creatorButtonProps:i.showAddButton?{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"}:!1,copyIconProps:!1,deleteIconProps:i.showDeleteButton,min:100,label:i.listLabel,children:function(u,d,h){var c=h.getCurrentRowData();return(0,_.jsxs)(S.UW,{style:{marginBottom:"5px"},children:[(0,_.jsx)(p.Z,{width:i.showInDrawer?"sm":"md",name:"name",label:"\u53D8\u91CF\u540D",required:!0,rules:[{required:!0}],disabled:i.showDisableName,placeholder:"\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}),Q(c)]})}}),i.showCodeMode&&(0,_.jsx)(x.Z,{width:"800px",open:V=="code",onCancel:function(){return j("docker-image")},onOk:function(){m(G),j("docker-image")},children:(0,_.jsx)(k.ZP,{onChange:function(u){return r(u)},value:e(),height:"680px",theme:"light"})})]})});W.Z=I},12491:function(N,W,t){t.d(W,{Z:function(){return O}});var A=t(24963),a=t(88484),L=t(62370),s=t(31418),l=t(28036),f=t(67294),v=t(85893);function O(p){var g=(0,f.useContext)(A.Z),y=g.message,S=g.notice,K=g.lang,D=(0,f.useRef)(null),x=s.Z.useApp(),T=function(){D.current&&(D.current.click(),D.current.onchange=function(R){if(!R||!R.target)return"";var C=new FileReader;C.onload=function(_){var w,I,i=(w=_.target)===null||w===void 0?void 0:w.result;if(p.onLoad)try{p.onLoad&&p.onLoad(i)}catch(U){S.error(U);return}typeof p.onImport=="function"&&(y.success("\u6210\u529F\u5BFC\u5165 ".concat(p.title)),p.onImport(i)),(I=D.current)!==null&&I!==void 0&&I.value&&(D.current.value="")};var b=R.target;if(b.files)try{C.readAsText(b.files[0])}catch(_){S.error("\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(L.Z,{children:(0,v.jsx)(l.ZP,{icon:(0,v.jsx)(a.Z,{}),block:!0,onClick:T,children:p.title})}),(0,v.jsx)("input",{style:{display:"none"},type:"file",ref:D,name:"importFileInput"})]})}},90098:function(N,W,t){t.d(W,{GG:function(){return R},MG:function(){return Y},Oh:function(){return D},Pn:function(){return g},U_:function(){return i},Yz:function(){return b},iE:function(){return E},ik:function(){return S},im:function(){return f},mg:function(){return T},pm:function(){return O},tw:function(){return H},vf:function(){return w},xC:function(){return V}});var A=t(15009),a=t.n(A),L=t(99289),s=t.n(L),l=t(82346);function f(r){return v.apply(this,arguments)}function v(){return v=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/app/compose/create",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),v.apply(this,arguments)}function O(r){return p.apply(this,arguments)}function p(){return p=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/app/compose/get-list",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),p.apply(this,arguments)}function g(r){return y.apply(this,arguments)}function y(){return y=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,l.request)("/api/app/compose/get-task",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),y.apply(this,arguments)}function S(r){return K.apply(this,arguments)}function K(){return K=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/app/compose/delete",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),K.apply(this,arguments)}function D(r){return x.apply(this,arguments)}function x(){return x=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,l.request)("/api/app/compose/container-deploy",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),x.apply(this,arguments)}function T(r){return k.apply(this,arguments)}function k(){return k=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,l.request)("/api/app/compose/container-destroy",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),k.apply(this,arguments)}function R(r){return C.apply(this,arguments)}function C(){return C=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,l.request)("/api/app/compose/container-ctrl",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),C.apply(this,arguments)}function b(r){return _.apply(this,arguments)}function _(){return _=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,l.request)("/api/app/compose/container-log",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),_.apply(this,arguments)}function w(r){return I.apply(this,arguments)}function I(){return I=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.download=!0,n.id=String(n.id),e.next=4,(0,l.request)("/api/app/compose/container-log",{method:"POST",data:n,responseType:"blob"});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},r)})),I.apply(this,arguments)}function i(r){return U.apply(this,arguments)}function U(){return U=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/app/compose/container-process-kill",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),U.apply(this,arguments)}function Y(r){return F.apply(this,arguments)}function F(){return F=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/app/compose/get-from-uri",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),F.apply(this,arguments)}function V(r){return j.apply(this,arguments)}function j(){return j=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,l.request)("/api/app/compose/parse",{method:"POST",data:n}));case 2:case"end":return e.stop()}},r)})),j.apply(this,arguments)}function E(r){return $.apply(this,arguments)}function $(){return $=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/api/common/store/deploy",{method:"POST",data:n}));case 1:case"end":return e.stop()}},r)})),$.apply(this,arguments)}function H(r){return G.apply(this,arguments)}function G(){return G=s()(a()().mark(function r(n){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.id=String(n.id),e.abrupt("return",(0,l.request)("/api/app/compose/download",{method:"POST",data:n,responseType:"blob"}));case 2:case"end":return e.stop()}},r)})),G.apply(this,arguments)}},79245:function(N,W,t){t.d(W,{m:function(){return L},y:function(){return s}});var A=t(64599),a=t.n(A);function L(l){var f=[];if(!l||l=="")return f;var v=l.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),O=a()(v),p;try{for(O.s();!(p=O.n()).done;){var g=p.value;f.push({name:g[1],value:g[2]?g[2].indexOf("-")==0?g[2].substring(1):g[2]:""})}}catch(y){O.e(y)}finally{O.f()}return f}function s(l,f){return!l||!f?!1:(l&f)!==0}}}]);
