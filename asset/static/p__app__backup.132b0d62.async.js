"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[550],{94359:function(F,R,e){e.d(R,{Z:function(){return G}});var M=e(5574),s=e.n(M),I=e(3089),d=e(98165),g=e(18429),o=e(8751),b=e(66212),C=e(14313),y=e(30159),m=e(87740),E=e(50888),h=e(66309),W=e(83062),k=e(36146),a=e(85893);function G(u){var t,O,L=new k.Uo("components.containerStatus"),r=u.status.split("."),K=s()(r,2),ne=K[0],_=K[1],v="";v=L.format(u.status,(t=u.statusValue)!==null&&t!==void 0?t:{});var f=(0,a.jsx)(a.Fragment,{});return _=="0"&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(I.Z,{}),color:"default",children:v})),_=="10"&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(d.Z,{spin:!0}),color:"processing",children:v})),_=="20"&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(g.Z,{}),color:"error",children:v})),_=="30"&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(o.Z,{}),color:"success",children:v})),_=="new"&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(b.Z,{}),children:v})),(_=="running"||_=="healthy"||_=="active"||_=="ready")&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(C.Z,{}),color:"success",children:v})),(_=="paused"||_=="pause"||_=="rollback_paused")&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(y.Z,{}),color:"warning",children:v})),(_=="waiting"||_=="starting"||_=="accepted")&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(m.Z,{}),children:v})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(_)&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(E.Z,{}),color:"processing",children:v})),(_=="error"||_=="down"||_=="failed")&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(g.Z,{}),color:"error",children:v})),["complete","completed","rollback_completed"].includes(_)&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(o.Z,{}),color:"success",children:v})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(_)&&(f=(0,a.jsx)(h.Z,{icon:(0,a.jsx)(g.Z,{}),color:"warning",children:v})),(0,a.jsx)(W.Z,{placement:"top",title:(O=u.tip)!==null&&O!==void 0?O:"",children:f})}},76428:function(F,R,e){e.d(R,{Z:function(){return d}});var M=e(25593),s=e(67294),I=e(85893);function d(g){return(0,I.jsx)(M.Z.Text,{copyable:!0,children:g.title})}},51100:function(F,R,e){e.d(R,{Z:function(){return g}});var M=e(4813),s=e(91604),I=e(1677),d=e(85893);function g(o){return o.showDragger?(0,d.jsx)(s.Z,{max:o.max?o.max:1,title:o.title,label:o.label,required:o.required,rules:[{required:o.required}],fieldProps:{multiple:!!(o.max&&o.max>1),name:"file",accept:o.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(C){return new Promise(function(y){var m;(0,M._)({path:(m=C.response.data.path)!==null&&m!==void 0?m:""}).then(function(E){y(!0)})})}},name:o.name}):(0,d.jsx)(I.Z,{max:o.max?o.max:1,title:o.title,label:o.label,required:o.required,rules:[{required:o.required}],fieldProps:{multiple:!!(o.max&&o.max>1),name:"file",accept:o.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(C){return new Promise(function(y){var m;(0,M._)({path:(m=C.response.data.path)!==null&&m!==void 0?m:""}).then(function(E){y(!0)})})}},name:o.name})}},3616:function(F,R,e){e.d(R,{Ed:function(){return d},FK:function(){return s},R_:function(){return M},ob:function(){return I}});var M=window.innerWidth<=1024?"90vw":"65vw",s="90vw",I="60vw",d="50vh"},65913:function(F,R,e){var M=e(5574),s=e.n(M),I=e(74330),d=e(67294),g=e(85893),o=(0,d.forwardRef)(function(b,C){(0,d.useImperativeHandle)(C,function(){return{show:function(){h(!0)},destroy:function(){h(!1)}}});var y=(0,d.useState)(!1),m=s()(y,2),E=m[0],h=m[1];return(0,g.jsx)(I.Z,{spinning:E,size:"default",children:b.children})});R.Z=o},6091:function(F,R,e){e.r(R),e.d(R,{default:function(){return ge}});var M=e(15009),s=e.n(M),I=e(99289),d=e.n(I),g=e(37476),o=e(86615),b=e(97462),C=e(5966),y=e(83622),m=e(67294),E=e(1699),h=e(82346);function W(Z){return k.apply(this,arguments)}function k(){return k=d()(s()().mark(function Z($){return s()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,h.request)("/api/pro/container-backup/import",{data:$,method:"POST"});case 2:return D.abrupt("return",D.sent);case 3:case"end":return D.stop()}},Z)})),k.apply(this,arguments)}var a=e(3616),G=e(51100),u=e(36146),t=e(85893),O=(0,m.forwardRef)(function(Z,$){(0,m.useImperativeHandle)($,function(){return{}});var N=(0,m.useRef)(),D=new u.Uo("components.appDetail");return(0,t.jsx)(E.u,{showProTips:!0,access:["canSeeEnableCe","canSeeEnableDockerEnvLocal"],children:function(T){var j=T.canSeeEnableCe,i=T.canSeeEnableDockerEnvLocal;return i&&(0,t.jsxs)(g.Y,{modalProps:{width:a.ob},onFinish:function(){var x=d()(s()().mark(function c(l){var P,n,B;return s()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return P=l.tarFilePath,l.tarFileUpload&&l.tarFileUpload.length>0&&(P=(n=l.tarFileUpload[0].response.data.path)!==null&&n!==void 0?n:""),U.next=4,W({type:l.type,tarFilePath:P});case 4:return B=U.sent,Z.onFinish&&Z.onFinish(),U.abrupt("return",!0);case 7:case"end":return U.stop()}},c)}));return function(c){return x.apply(this,arguments)}}(),title:D.format("backupImportTitle"),formRef:N,trigger:(0,t.jsx)(y.ZP,{disabled:j,type:"primary",children:D.format("backupImportTitle")}),onOpenChange:function(){var c;(c=N.current)===null||c===void 0||c.resetFields()},children:[(0,t.jsx)(o.Z.Group,{label:D.format("backupImportType"),name:"type",initialValue:"upload",options:D.option("backupImportTypeOption",["upload"])}),(0,t.jsx)(b.Z,{name:["type"],children:function(c){var l=c.type;if(l=="upload")return(0,t.jsx)(G.Z,{required:!0,label:D.format("backupImportTarFileUpload"),name:"tarFileUpload",accept:".snapshot"});if(l=="serverPath")return(0,t.jsx)(C.Z,{required:!0,rules:[{required:!0}],name:"tarFilePath",label:D.format("backupImportTarFilePath")})}})]})}})}),L=O,r=e(5574),K=e.n(r),ne=e(65913),_=e(85265),v=e(26412),f=e(42075),Y=e(96074),w=e(25593),re=e(66309),V=e(2487),Q=e(70146),J=e(5251),ie=e(45605),le=e(58638),ue=e(38345),ce=e(76428),de=(0,m.forwardRef)(function(Z,$){(0,m.useImperativeHandle)($,function(){return{show:function(B){return d()(s()().mark(function S(){var U;return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,Q.iD)({id:B});case 2:U=p.sent,j(U.data.detail),l(!0);case 5:case"end":return p.stop()}},S)}))()}}});var N=(0,m.useRef)(),D=(0,m.useState)(),H=K()(D,2),T=H[0],j=H[1],i=(0,m.useState)(!1),x=K()(i,2),c=x[0],l=x[1],P=new u.Uo("components.appDetail");return(0,t.jsx)(_.Z,{title:P.format("titleBackup"),open:c,onClose:function(){l(!1)},width:a.R_,children:(0,t.jsx)(ne.Z,{ref:N,children:T&&T.map(function(n){var B,S,U=[],q=[];return n.NetworkSettings&&n.NetworkSettings.Ports&&Object.entries(n.NetworkSettings.Ports).map(function(p){var A=K()(p,2),z=A[0],ee=A[1],je=ee!=null?ee:[{HostPort:null,HostIp:""}],Ee=z.split("/"),ae=K()(Ee,2),se=ae[0],oe=ae[1];je.map(function(te){te.HostPort?U.push({PrivatePort:se,Type:oe,IP:te.HostIp,PublicPort:te.HostPort}):q.push({PrivatePort:se,Type:oe,IP:"",PublicPort:""})})}),(0,t.jsx)(ue.Z,{title:(0,t.jsx)(ie.Z,{}),subTitle:P.format("titleBasic"),ghost:!0,children:(0,t.jsxs)(v.Z,{column:1,bordered:!0,children:[(0,t.jsx)(v.Z.Item,{label:u.FD.format("listName"),children:(0,t.jsx)(f.Z,{split:(0,t.jsx)(Y.Z,{type:"vertical"}),children:(0,t.jsx)(w.Z.Text,{children:(0,J.fi)(n.Name,"/")})})}),(0,t.jsx)(v.Z.Item,{label:u.FD.format("listImageName"),children:(0,t.jsxs)(f.Z,{split:(0,t.jsx)(Y.Z,{type:"vertical"}),children:[(0,t.jsx)(w.Z.Text,{copyable:!0,children:n.Config.Image}),(0,t.jsx)(re.Z,{color:"blue",children:n.EnableImage?u.FD.format("listHas"):u.FD.format("listHasNot")})]})}),(0,t.jsx)(v.Z.Item,{label:u.FD.format("listPort"),children:(0,t.jsx)(f.Z,{size:"large",wrap:!0,children:[].concat(U,q).map(function(p,A){return(0,t.jsx)(re.Z,{color:p.PublicPort?"#2db7f5":"warning",icon:p.PublicPort?(0,t.jsx)(le.Z,{}):"",style:{marginBottom:10,marginRight:15,width:210},children:p.PublicPort?"".concat(p.PublicPort?p.IP+":"+p.PublicPort+" -> ":"").concat(p.PrivatePort,"/").concat(p.Type):"".concat(p.PrivatePort,"/").concat(p.Type)},A)})},"space")}),n.State.Running&&n.NetworkSettings.Networks&&Object.keys(n.NetworkSettings.Networks).map(function(p,A){return(0,t.jsx)(v.Z.Item,{label:p,children:p=="host"?u.FD.format("listNetworkUseHost"):(0,t.jsxs)(f.Z,{direction:"vertical",children:[(0,t.jsx)(ce.Z,{title:n.NetworkSettings.Networks[p].IPAddress}),n.NetworkSettings.Networks[p].Gateway,n.NetworkSettings.Networks[p].MacAddress]})},A)}),(0,t.jsx)(v.Z.Item,{label:u.FD.format("listEnv"),children:(0,t.jsx)(V.Z,{dataSource:(B=n.Config.Env)!==null&&B!==void 0?B:[],renderItem:function(A){var z=A.split("=");return(0,t.jsxs)(V.Z.Item,{children:[(0,t.jsx)(w.Z.Text,{code:!0,children:z[0]})," = ",(0,t.jsx)(w.Z.Text,{copyable:!0,children:z.slice(1).join("=")})]},z[0])}})}),n.Mounts&&n.Mounts.length>0&&(0,t.jsx)(v.Z.Item,{label:u.FD.format("listHostPath"),children:(0,t.jsx)(V.Z,{dataSource:(S=n.Mounts)!==null&&S!==void 0?S:[],renderItem:function(A){return(0,t.jsxs)(V.Z.Item,{children:[(0,t.jsx)(w.Z.Text,{code:!0,children:A.Source})," : ",(0,t.jsx)(w.Z.Text,{children:A.Destination})]},A.Source)}})})]})},n.Name)})})})}),me=de,X=e(80821),pe=e(94359),_e=e(59683),fe=e(87740),he=e(87784),ve=e(82061),Pe=e(74453);function ge(){var Z=(0,m.useRef)(),$=(0,h.useAccess)(),N=(0,h.useModel)("subscriber"),D=(0,m.useRef)(),H=new u.Uo("app");return(0,t.jsxs)(Pe._z,{header:{extra:[(0,t.jsx)(L,{onFinish:function(){var j;!((j=Z.current)===null||j===void 0)&&j.reloadAndRest&&Z.current.reloadAndRest()}},"backup-import")]},children:[(0,t.jsx)(me,{ref:D}),(0,t.jsx)(_e.C,{rowKey:"id",columns:[{title:u.FD.format("listContainerName"),dataIndex:"containerId",width:150,render:function(j,i,x,c,l){return(0,t.jsx)(w.Z.Link,{onClick:function(){var n;(n=D.current)===null||n===void 0||n.show(i.id)},children:(0,J.fi)(i.containerId,"/")})}},{title:u.FD.format("listFilePath"),search:!1,width:300,render:function(j,i,x,c,l){var P=i.setting.backupTar;return(0,t.jsx)("span",{style:{wordBreak:"break-word"},children:P.substring(P.lastIndexOf("/",P.lastIndexOf("/")-1))})}},{title:u.FD.format("listSize"),search:!1,width:100,render:function(j,i,x,c,l){return i.setting.size?(0,t.jsx)(w.Z.Text,{children:(0,J.FI)(i.setting.size)}):"-"}},{title:u.FD.format("listContainerVolume"),search:!1,minWidth:100,render:function(j,i,x,c,l){return(0,t.jsx)(f.Z,{wrap:!0,children:i.setting.volumePathList.map(function(P){return P})})}},{title:u.FD.format("listStatus"),search:!1,width:80,render:function(j,i,x,c,l){var P,n;return(0,t.jsx)(pe.Z,{tip:(P=i.setting.error)!==null&&P!==void 0?P:"",status:"status.".concat((n=i.setting.status)!==null&&n!==void 0?n:"30")},i.id)}},{title:u.FD.format("listCreatedAt"),search:!1,width:200,render:function(j,i,x,c,l){return new Date(i.createdAt).toLocaleString()}},{title:u.FD.format("listManage"),search:!1,width:100,fixed:"right",hidden:!$.canSeeContainerBackupManage,render:function(j,i,x,c,l){return(0,t.jsxs)(f.Z,{split:(0,t.jsx)(Y.Z,{}),children:[i.setting.status=="30"&&(0,t.jsx)(X.Z,{buttonProps:{ghost:!0,type:"link",icon:(0,t.jsx)(fe.Z,{})},confirmProps:{description:(0,t.jsx)(f.Z,{style:{width:300},children:H.format("backupRestoreConfirm")})},tips:u.FD.format("listManageUnpause"),action:function(){return(0,Q.SR)({id:i.id,enableForce:!1})}}),i.setting.status=="10"&&(0,t.jsx)(X.Z,{buttonProps:{danger:!0,ghost:!0,type:"link",icon:(0,t.jsx)(he.Z,{})},action:d()(s()().mark(function P(){return s()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return N.progress.close("container:backup:".concat(i.id)),setTimeout(function(){var S;!((S=Z.current)===null||S===void 0)&&S.reloadAndRest&&Z.current.reloadAndRest()},500),B.abrupt("return",!1);case 3:case"end":return B.stop()}},P)}))})]})}}],request:function(){var T=d()(s()().mark(function j(i,x,c){var l;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,Q.Zy)({containerId:i.containerId,page:i.current,pageSize:i.pageSize});case 2:return l=n.sent,n.abrupt("return",{data:l.data.list,success:!0,total:l.data.total});case 4:case"end":return n.stop()}},j)}));return function(j,i,x){return T.apply(this,arguments)}}(),rowSelection:$.canSeeContainerBackupManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:Z,quickToolbarRender:function(j){var i=j.selectedRows;return(0,t.jsx)(f.Z,{size:16,children:(0,t.jsx)(X.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,t.jsx)(ve.Z,{})},confirmProps:{showCommonConfirm:!0},action:function(){return(0,Q.VE)({id:i.map(function(c){return c.id})})},onSuccess:function(){var c,l;return!((c=Z.current)===null||c===void 0)&&c.reloadAndRest&&((l=Z.current)===null||l===void 0||l.reloadAndRest()),!0},onError:function(){var c,l;return!((c=Z.current)===null||c===void 0)&&c.reset&&((l=Z.current)===null||l===void 0||l.reset()),!0},children:u.FD.format("listManageDeleteBatch")},"batchDelete")})}})]})}},70146:function(F,R,e){e.d(R,{SR:function(){return h},VE:function(){return m},Zy:function(){return C},iD:function(){return k},yB:function(){return o}});var M=e(15009),s=e.n(M),I=e(99289),d=e.n(I),g=e(82346);function o(t){return b.apply(this,arguments)}function b(){return b=d()(s()().mark(function t(O){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,g.request)("/api/app/container-backup/create",{data:O,method:"POST"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},t)})),b.apply(this,arguments)}function C(t){return y.apply(this,arguments)}function y(){return y=d()(s()().mark(function t(O){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,g.request)("/api/app/container-backup/get-list",{method:"POST",data:O}));case 1:case"end":return r.stop()}},t)})),y.apply(this,arguments)}function m(t){return E.apply(this,arguments)}function E(){return E=d()(s()().mark(function t(O){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,g.request)("/api/app/container-backup/delete",{method:"POST",data:O}));case 1:case"end":return r.stop()}},t)})),E.apply(this,arguments)}function h(t){return W.apply(this,arguments)}function W(){return W=d()(s()().mark(function t(O){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,g.request)("/api/app/container-backup/restore",{method:"POST",data:O}));case 1:case"end":return r.stop()}},t)})),W.apply(this,arguments)}function k(t){return a.apply(this,arguments)}function a(){return a=d()(s()().mark(function t(O){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,g.request)("/api/app/container-backup/get-detail",{method:"POST",data:O}));case 1:case"end":return r.stop()}},t)})),a.apply(this,arguments)}function G(t){return u.apply(this,arguments)}function u(){return u=_asyncToGenerator(_regeneratorRuntime().mark(function t(O){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,request("/api/app/site/restore",{data:O,method:"POST"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},t)})),u.apply(this,arguments)}},4813:function(F,R,e){e.d(R,{_:function(){return o}});var M=e(15009),s=e.n(M),I=e(99289),d=e.n(I),g=e(82346);function o(C){return b.apply(this,arguments)}function b(){return b=d()(s()().mark(function C(y){return s()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,g.request)("/api/common/attach/delete",{method:"POST",data:y});case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},C)})),b.apply(this,arguments)}}}]);
